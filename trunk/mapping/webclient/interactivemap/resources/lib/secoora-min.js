window.undefined=window.undefined;Ext={version:"3.3.0",versionDetail:{major:3,minor:3,patch:0}};Ext.apply=function(h,g,c){if(c){Ext.apply(h,c)}if(h&&g&&typeof g=="object"){for(var f in g){h[f]=g[f]}}return h};(function(){var Y=0,I=Object.prototype.toString,H=navigator.userAgent.toLowerCase(),e=function(a){return a.test(H)},W=document,R=W.documentMode,T=W.compatMode=="CSS1Compat",M=e(/opera/),X=e(/\bchrome\b/),G=e(/webkit/),D=!X&&e(/safari/),Z=D&&e(/applewebkit\/4/),ac=D&&e(/version\/3/),L=D&&e(/version\/4/),J=!M&&e(/msie/),N=J&&(e(/msie 7/)||R==7),P=J&&(e(/msie 8/)&&R!=7),K=J&&!N&&!P,Q=!G&&e(/gecko/),aa=Q&&e(/rv:1\.8/),ad=Q&&e(/rv:1\.9/),F=J&&!T,O=e(/windows|win32/),U=e(/macintosh|mac os x/),V=e(/adobeair/),S=e(/linux/),ab=/^https/i.test(window.location.protocol);if(K){try{W.execCommand("BackgroundImageCache",false,true)}catch(E){}}Ext.apply(Ext,{SSL_SECURE_URL:ab&&J?'javascript:""':"about:blank",isStrict:T,isSecure:ab,isReady:false,enableForcedBoxModel:false,enableGarbageCollector:true,enableListenerCollection:false,enableNestedListenerRemoval:false,USE_NATIVE_JSON:false,applyIf:function(c,a){if(c){for(var b in a){if(!Ext.isDefined(c[b])){c[b]=a[b]}}}return c},id:function(b,a){b=Ext.getDom(b,true)||{};if(!b.id){b.id=(a||"ext-gen")+(++Y)}return b.id},extend:function(){var b=function(c){for(var d in c){this[d]=c[d]}};var a=Object.prototype.constructor;return function(c,g,d){if(typeof g=="object"){d=g;g=c;c=d.constructor!=a?d.constructor:function(){g.apply(this,arguments)}}var h=function(){},f,i=g.prototype;h.prototype=i;f=c.prototype=new h();f.constructor=c;c.superclass=i;if(i.constructor==a){i.constructor=g}c.override=function(j){Ext.override(c,j)};f.superclass=f.supr=(function(){return i});f.override=b;Ext.override(c,d);c.extend=function(j){return Ext.extend(c,j)};return c}}(),override:function(c,a){if(a){var b=c.prototype;Ext.apply(b,a);if(Ext.isIE&&a.hasOwnProperty("toString")){b.toString=a.toString}}},namespace:function(){var b,a;Ext.each(arguments,function(c){a=c.split(".");b=window[a[0]]=window[a[0]]||{};Ext.each(a.slice(1),function(d){b=b[d]=b[d]||{}})});return b},urlEncode:function(a,b){var d,f=[],c=encodeURIComponent;Ext.iterate(a,function(h,g){d=Ext.isEmpty(g);Ext.each(d?h:g,function(i){f.push("&",c(h),"=",(!Ext.isEmpty(i)&&(i!=h||!d))?(Ext.isDate(i)?Ext.encode(i).replace(/"/g,""):c(i)):"")})});if(!b){f.shift();b=""}return b+f.join("")},urlDecode:function(f,h){if(Ext.isEmpty(f)){return{}}var b={},c=f.split("&"),a=decodeURIComponent,g,d;Ext.each(c,function(i){i=i.split("=");g=a(i[0]);d=a(i[1]);b[g]=h||!b[g]?d:[].concat(b[g]).concat(d)});return b},urlAppend:function(b,a){if(!Ext.isEmpty(a)){return b+(b.indexOf("?")===-1?"?":"&")+a}return b},toArray:function(){return J?function(d,a,c,b){b=[];for(var g=0,f=d.length;g<f;g++){b.push(d[g])}return b.slice(a||0,c||b.length)}:function(c,a,b){return Array.prototype.slice.call(c,a||0,b||c.length)}}(),isIterable:function(a){if(Ext.isArray(a)||a.callee){return true}if(/NodeList|HTMLCollection/.test(I.call(a))){return true}return((typeof a.nextNode!="undefined"||a.item)&&Ext.isNumber(a.length))},each:function(a,b,c){if(Ext.isEmpty(a,true)){return}if(!Ext.isIterable(a)||Ext.isPrimitive(a)){a=[a]}for(var f=0,d=a.length;f<d;f++){if(b.call(c||a[f],a[f],f,a)===false){return f}}},iterate:function(b,d,c){if(Ext.isEmpty(b)){return}if(Ext.isIterable(b)){Ext.each(b,d,c);return}else{if(typeof b=="object"){for(var a in b){if(b.hasOwnProperty(a)){if(d.call(c||b,a,b[a],b)===false){return}}}}}},getDom:function(b,c){if(!b||!W){return null}if(b.dom){return b.dom}else{if(typeof b=="string"){var a=W.getElementById(b);if(a&&J&&c){if(b==a.getAttribute("id")){return a}else{return null}}return a}else{return b}}},getBody:function(){return Ext.get(W.body||W.documentElement)},getHead:function(){var a;return function(){if(a==undefined){a=Ext.get(W.getElementsByTagName("head")[0])}return a}}(),removeNode:J&&!P?function(){var a;return function(b){if(b&&b.tagName!="BODY"){(Ext.enableNestedListenerRemoval)?Ext.EventManager.purgeElement(b,true):Ext.EventManager.removeAll(b);
a=a||W.createElement("div");a.appendChild(b);a.innerHTML="";delete Ext.elCache[b.id]}}}():function(a){if(a&&a.parentNode&&a.tagName!="BODY"){(Ext.enableNestedListenerRemoval)?Ext.EventManager.purgeElement(a,true):Ext.EventManager.removeAll(a);a.parentNode.removeChild(a);delete Ext.elCache[a.id]}},isEmpty:function(b,a){return b===null||b===undefined||((Ext.isArray(b)&&!b.length))||(!a?b==="":false)},isArray:function(a){return I.apply(a)==="[object Array]"},isDate:function(a){return I.apply(a)==="[object Date]"},isObject:function(a){return !!a&&Object.prototype.toString.call(a)==="[object Object]"},isPrimitive:function(a){return Ext.isString(a)||Ext.isNumber(a)||Ext.isBoolean(a)},isFunction:function(a){return I.apply(a)==="[object Function]"},isNumber:function(a){return typeof a==="number"&&isFinite(a)},isString:function(a){return typeof a==="string"},isBoolean:function(a){return typeof a==="boolean"},isElement:function(a){return a?!!a.tagName:false},isDefined:function(a){return typeof a!=="undefined"},isOpera:M,isWebKit:G,isChrome:X,isSafari:D,isSafari3:ac,isSafari4:L,isSafari2:Z,isIE:J,isIE6:K,isIE7:N,isIE8:P,isGecko:Q,isGecko2:aa,isGecko3:ad,isBorderBox:F,isLinux:S,isWindows:O,isMac:U,isAir:V});Ext.ns=Ext.namespace})();Ext.ns("Ext.util","Ext.lib","Ext.data","Ext.supports");Ext.elCache={};Ext.apply(Function.prototype,{createInterceptor:function(d,e){var f=this;return !Ext.isFunction(d)?this:function(){var a=this,b=arguments;d.target=a;d.method=f;return(d.apply(e||a||window,b)!==false)?f.apply(a||window,b):null}},createCallback:function(){var d=arguments,c=this;return function(){return c.apply(window,d)}},createDelegate:function(h,e,f){var g=this;return function(){var a=e||arguments;if(f===true){a=Array.prototype.slice.call(arguments,0);a=a.concat(e)}else{if(Ext.isNumber(f)){a=Array.prototype.slice.call(arguments,0);var b=[f,0].concat(e);Array.prototype.splice.apply(a,b)}}return g.apply(h||window,a)}},defer:function(j,h,f,g){var i=this.createDelegate(h,f,g);if(j>0){return setTimeout(i,j)}i();return 0}});Ext.applyIf(String,{format:function(c){var d=Ext.toArray(arguments,1);return c.replace(/\{(\d+)\}/g,function(b,a){return d[a]})}});Ext.applyIf(Array.prototype,{indexOf:function(d,f){var e=this.length;f=f||0;f+=(f<0)?e:0;for(;f<e;++f){if(this[f]===d){return f}}return -1},remove:function(c){var d=this.indexOf(c);if(d!=-1){this.splice(d,1)}return this}});Ext.util.TaskRunner=function(n){n=n||10;var m=[],r=[],q=0,l=false,o=function(){l=false;clearInterval(q);q=0},k=function(){if(!l){l=true;q=setInterval(j,n)}},p=function(a){r.push(a);if(a.onStop){a.onStop.apply(a.scope||a)}},j=function(){var b=r.length,g=new Date().getTime();if(b>0){for(var e=0;e<b;e++){m.remove(r[e])}r=[];if(m.length<1){o();return}}for(var e=0,f,c,a,d=m.length;e<d;++e){f=m[e];c=g-f.taskRunTime;if(f.interval<=c){a=f.run.apply(f.scope||f,f.args||[++f.taskRunCount]);f.taskRunTime=g;if(a===false||f.taskRunCount===f.repeat){p(f);return}}if(f.duration&&f.duration<=(g-f.taskStartTime)){p(f)}}};this.start=function(a){m.push(a);a.taskStartTime=new Date().getTime();a.taskRunTime=0;a.taskRunCount=0;k();return a};this.stop=function(a){p(a);return a};this.stopAll=function(){o();for(var a=0,b=m.length;a<b;a++){if(m[a].onStop){m[a].onStop()}}m=[];r=[]}};Ext.TaskMgr=new Ext.util.TaskRunner();(function(){var d;function f(a){if(!d){d=new Ext.Element.Flyweight()}d.dom=a;return d}(function(){var b=document,i=b.compatMode=="CSS1Compat",c=Math.max,j=Math.round,a=parseInt;Ext.lib.Dom={isAncestor:function(h,g){var l=false;h=Ext.getDom(h);g=Ext.getDom(g);if(h&&g){if(h.contains){return h.contains(g)}else{if(h.compareDocumentPosition){return !!(h.compareDocumentPosition(g)&16)}else{while(g=g.parentNode){l=g==h||l}}}}return l},getViewWidth:function(g){return g?this.getDocumentWidth():this.getViewportWidth()},getViewHeight:function(g){return g?this.getDocumentHeight():this.getViewportHeight()},getDocumentHeight:function(){return c(!i?b.body.scrollHeight:b.documentElement.scrollHeight,this.getViewportHeight())
},getDocumentWidth:function(){return c(!i?b.body.scrollWidth:b.documentElement.scrollWidth,this.getViewportWidth())},getViewportHeight:function(){return Ext.isIE?(Ext.isStrict?b.documentElement.clientHeight:b.body.clientHeight):self.innerHeight},getViewportWidth:function(){return !Ext.isStrict&&!Ext.isOpera?b.body.clientWidth:Ext.isIE?b.documentElement.clientWidth:self.innerWidth},getY:function(g){return this.getXY(g)[1]},getX:function(g){return this.getXY(g)[0]},getXY:function(z){var A,h,F,C,y,x,D=0,g=0,E,B,w=(b.body||b.documentElement),p=[0,0];z=Ext.getDom(z);if(z!=w){if(z.getBoundingClientRect){F=z.getBoundingClientRect();E=f(document).getScroll();p=[j(F.left+E.left),j(F.top+E.top)]}else{A=z;B=f(z).isStyle("position","absolute");while(A){h=f(A);D+=A.offsetLeft;g+=A.offsetTop;B=B||h.isStyle("position","absolute");if(Ext.isGecko){g+=C=a(h.getStyle("borderTopWidth"),10)||0;D+=y=a(h.getStyle("borderLeftWidth"),10)||0;if(A!=z&&!h.isStyle("overflow","visible")){D+=y;g+=C}}A=A.offsetParent}if(Ext.isSafari&&B){D-=w.offsetLeft;g-=w.offsetTop}if(Ext.isGecko&&!B){x=f(w);D+=a(x.getStyle("borderLeftWidth"),10)||0;g+=a(x.getStyle("borderTopWidth"),10)||0}A=z.parentNode;while(A&&A!=w){if(!Ext.isOpera||(A.tagName!="TR"&&!f(A).isStyle("display","inline"))){D-=A.scrollLeft;g-=A.scrollTop}A=A.parentNode}p=[D,g]}}return p},setXY:function(o,n){(o=Ext.fly(o,"_setXY")).position();var h=o.translatePoints(n),p=o.dom.style,g;for(g in h){if(!isNaN(h[g])){p[g]=h[g]+"px"}}},setX:function(g,h){this.setXY(g,[h,false])},setY:function(h,g){this.setXY(h,[false,g])}}})();Ext.lib.Event=function(){var G=false,ab={},a=0,S=[],ad,Q=false,W=window,I=document,V=200,N=20,R=0,Y=1,L=2,F=3,J="scrollLeft",P="scrollTop",aa="unload",b="mouseover",K="mouseout",ac=function(){var g;if(W.addEventListener){g=function(h,j,i,k){if(j=="mouseenter"){i=i.createInterceptor(T);h.addEventListener(b,i,(k))}else{if(j=="mouseleave"){i=i.createInterceptor(T);h.addEventListener(K,i,(k))}else{h.addEventListener(j,i,(k))}}return i}}else{if(W.attachEvent){g=function(h,j,i,k){h.attachEvent("on"+j,i);return i}}else{g=function(){}}}return g}(),Z=function(){var g;if(W.removeEventListener){g=function(h,j,i,k){if(j=="mouseenter"){j=b}else{if(j=="mouseleave"){j=K}}h.removeEventListener(j,i,(k))}}else{if(W.detachEvent){g=function(h,j,i){h.detachEvent("on"+j,i)}}else{g=function(){}}}return g}();function T(g){return !H(g.currentTarget,c.getRelatedTarget(g))}function H(h,g){if(h&&h.firstChild){while(g){if(g===h){return true}g=g.parentNode;if(g&&(g.nodeType!=1)){g=null}}}return false}function O(){var l=false,g=[],i,j,m,k,h=!G||(a>0);if(!Q){Q=true;for(j=0;j<S.length;++j){m=S[j];if(m&&(i=I.getElementById(m.id))){if(!m.checkReady||G||i.nextSibling||(I&&I.body)){k=m.override;i=k?(k===true?m.obj:k):i;m.fn.call(i,m.obj);S.remove(m);--j}else{g.push(m)}}}a=(g.length===0)?0:a-1;if(h){U()}else{clearInterval(ad);ad=null}l=!(Q=false)}return l}function U(){if(!ad){var g=function(){O()};ad=setInterval(g,N)}}function M(){var h=I.documentElement,g=I.body;if(h&&(h[P]||h[J])){return[h[J],h[P]]}else{if(g){return[g[J],g[P]]}else{return[0,0]}}}function X(i,h){i=i.browserEvent||i;var g=i["page"+h];if(!g&&g!==0){g=i["client"+h]||0;if(Ext.isIE){g+=M()[h=="X"?0:1]}}return g}var c={extAdapter:true,onAvailable:function(h,j,g,i){S.push({id:h,fn:j,obj:g,override:i,checkReady:false});a=V;U()},addListener:function(g,i,h){g=Ext.getDom(g);if(g&&h){if(i==aa){if(ab[g.id]===undefined){ab[g.id]=[]}ab[g.id].push([i,h]);return h}return ac(g,i,h,false)}return false},removeListener:function(g,k,h){g=Ext.getDom(g);var i,l,m,j;if(g&&h){if(k==aa){if((j=ab[g.id])!==undefined){for(i=0,l=j.length;i<l;i++){if((m=j[i])&&m[R]==k&&m[Y]==h){ab[g.id].splice(i,1)}}}return}Z(g,k,h,false)}},getTarget:function(g){g=g.browserEvent||g;return this.resolveTextNode(g.target||g.srcElement)},resolveTextNode:Ext.isGecko?function(g){if(!g){return}var h=HTMLElement.prototype.toString.call(g);if(h=="[xpconnect wrapped native prototype]"||h=="[object XULElement]"){return}return g.nodeType==3?g.parentNode:g
}:function(g){return g&&g.nodeType==3?g.parentNode:g},getRelatedTarget:function(g){g=g.browserEvent||g;return this.resolveTextNode(g.relatedTarget||(/(mouseout|mouseleave)/.test(g.type)?g.toElement:/(mouseover|mouseenter)/.test(g.type)?g.fromElement:null))},getPageX:function(g){return X(g,"X")},getPageY:function(g){return X(g,"Y")},getXY:function(g){return[this.getPageX(g),this.getPageY(g)]},stopEvent:function(g){this.stopPropagation(g);this.preventDefault(g)},stopPropagation:function(g){g=g.browserEvent||g;if(g.stopPropagation){g.stopPropagation()}else{g.cancelBubble=true}},preventDefault:function(g){g=g.browserEvent||g;if(g.preventDefault){g.preventDefault()}else{g.returnValue=false}},getEvent:function(h){h=h||W.event;if(!h){var g=this.getEvent.caller;while(g){h=g.arguments[0];if(h&&Event==h.constructor){break}g=g.caller}}return h},getCharCode:function(g){g=g.browserEvent||g;return g.charCode||g.keyCode||0},getListeners:function(g,h){Ext.EventManager.getListeners(g,h)},purgeElement:function(h,g,i){Ext.EventManager.purgeElement(h,g,i)},_load:function(g){G=true;if(Ext.isIE&&g!==true){Z(W,"load",arguments.callee)}},_unload:function(k){var n=Ext.lib.Event,m,h,j,o,l,g;for(o in ab){j=ab[o];for(m=0,l=j.length;m<l;m++){h=j[m];if(h){try{g=h[F]?(h[F]===true?h[L]:h[F]):W;h[Y].call(g,n.getEvent(k),h[L])}catch(i){}}}}Ext.EventManager._unload();Z(W,aa,n._unload)}};c.on=c.addListener;c.un=c.removeListener;if(I&&I.body){c._load(true)}else{ac(W,"load",c._load)}ac(W,aa,c._unload);O();return c}();Ext.lib.Ajax=function(){var A=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP"],D="Content-Type";function z(h){var j=h.conn,g,i={};function k(l,m){for(g in m){if(m.hasOwnProperty(g)){l.setRequestHeader(g,m[g])}}}Ext.apply(i,w.headers,w.defaultHeaders);k(j,i);delete w.headers}function C(g,h,i,j){return{tId:g,status:i?-1:0,statusText:i?"transaction aborted":"communication failure",isAbort:i,isTimeout:j,argument:h}}function x(h,g){(w.headers=w.headers||{})[h]=g}function c(o,k){var g={},l,m=o.conn,i,h,n=m.status==1223;try{l=o.conn.getAllResponseHeaders();Ext.each(l.replace(/\r\n/g,"\n").split("\n"),function(p){i=p.indexOf(":");if(i>=0){h=p.substr(0,i).toLowerCase();if(p.charAt(i+1)==" "){++i}g[h]=p.substr(i+1)}})}catch(j){}return{tId:o.tId,status:n?204:m.status,statusText:n?"No Content":m.statusText,getResponseHeader:function(p){return g[p.toLowerCase()]},getAllResponseHeaders:function(){return l},responseText:m.responseText,responseXML:m.responseXML,argument:k}}function s(g){if(g.tId){w.conn[g.tId]=null}g.conn=null;g=null}function B(g,m,k,l){if(!m){s(g);return}var i,j;try{if(g.conn.status!==undefined&&g.conn.status!=0){i=g.conn.status}else{i=13030}}catch(h){i=13030}if((i>=200&&i<300)||(Ext.isIE&&i==1223)){j=c(g,m.argument);if(m.success){if(!m.scope){m.success(j)}else{m.success.apply(m.scope,[j])}}}else{switch(i){case 12002:case 12029:case 12030:case 12031:case 12152:case 13030:j=C(g.tId,m.argument,(k?k:false),l);if(m.failure){if(!m.scope){m.failure(j)}else{m.failure.apply(m.scope,[j])}}break;default:j=c(g,m.argument);if(m.failure){if(!m.scope){m.failure(j)}else{m.failure.apply(m.scope,[j])}}}}s(g);j=null}function u(j,g,l,h,k,i){if(l&&l.readyState==4){clearInterval(k[h]);k[h]=null;if(i){clearTimeout(w.timeout[h]);w.timeout[h]=null}B(j,g)}}function a(h,g){w.abort(h,g,true)}function t(j,g){g=g||{};var l=j.conn,h=j.tId,k=w.poll,i=g.timeout||null;if(i){w.conn[h]=l;w.timeout[h]=setTimeout(a.createCallback(j,g),i)}k[h]=setInterval(u.createCallback(j,g,l,h,k,i),w.pollInterval)}function y(g,j,h,k){var i=v()||null;if(i){i.conn.open(g,j,true);if(w.useDefaultXhrHeader){x("X-Requested-With",w.defaultXhrHeader)}if(k&&w.useDefaultHeader&&(!w.headers||!w.headers[D])){x(D,w.defaultPostHeader)}if(w.defaultHeaders||w.headers){z(i)}t(i,h);i.conn.send(k||null)}return i}function v(){var g;try{if(g=b(w.transactionId)){w.transactionId++}}catch(h){}finally{return g}}function b(g){var j;try{j=new XMLHttpRequest()}catch(h){for(var i=0;i<A.length;++i){try{j=new ActiveXObject(A[i]);
break}catch(h){}}}finally{return{conn:j,tId:g}}}var w={request:function(o,m,l,k,g){if(g){var j=this,n=g.xmlData,i=g.jsonData,h;Ext.applyIf(j,g);if(n||i){h=j.headers;if(!h||!h[D]){x(D,n?"text/xml":"application/json")}k=n||(!Ext.isPrimitive(i)?Ext.encode(i):i)}}return y(o||g.method||"POST",m,l,k)},serializeForm:function(n){var g=n.elements||(document.forms[n]||Ext.getDom(n)).elements,l=false,h=encodeURIComponent,k,m="",i,j;Ext.each(g,function(o){k=o.name;i=o.type;if(!o.disabled&&k){if(/select-(one|multiple)/i.test(i)){Ext.each(o.options,function(p){if(p.selected){j=p.hasAttribute?p.hasAttribute("value"):p.getAttributeNode("value").specified;m+=String.format("{0}={1}&",h(k),h(j?p.value:p.text))}})}else{if(!(/file|undefined|reset|button/i.test(i))){if(!(/radio|checkbox/i.test(i)&&!o.checked)&&!(i=="submit"&&l)){m+=h(k)+"="+h(o.value)+"&";l=/submit/i.test(i)}}}}});return m.substr(0,m.length-1)},useDefaultHeader:true,defaultPostHeader:"application/x-www-form-urlencoded; charset=UTF-8",useDefaultXhrHeader:true,defaultXhrHeader:"XMLHttpRequest",poll:{},timeout:{},conn:{},pollInterval:50,transactionId:0,abort:function(i,g,l){var j=this,h=i.tId,k=false;if(j.isCallInProgress(i)){i.conn.abort();clearInterval(j.poll[h]);j.poll[h]=null;clearTimeout(w.timeout[h]);j.timeout[h]=null;B(i,g,(k=true),l)}return k},isCallInProgress:function(g){return g.conn&&!{0:true,4:true}[g.conn.readyState]}};return w}();(function(){var k=Ext.lib,b=/width|height|opacity|padding/i,l=/^((width|height)|(top|left))$/,n=/width|height|top$|bottom$|left$|right$/i,c=/\d+(em|%|en|ex|pt|in|cm|mm|pc)$/i,a=function(g){return typeof g!=="undefined"},m=function(){return new Date()};k.Anim={motion:function(r,h,q,j,i,g){return this.run(r,h,q,j,i,g,Ext.lib.Motion)},run:function(u,h,s,j,i,v,g){g=g||Ext.lib.AnimBase;if(typeof j=="string"){j=Ext.lib.Easing[j]}var t=new g(u,h,s,j);t.animateX(function(){if(Ext.isFunction(i)){i.call(v)}});return t}};k.AnimBase=function(h,i,g,j){if(h){this.init(h,i,g,j)}};k.AnimBase.prototype={doMethod:function(i,j,h){var g=this;return g.method(g.curFrame,j,h-j,g.totalFrames)},setAttr:function(i,g,h){if(b.test(i)&&g<0){g=0}Ext.fly(this.el,"_anim").setStyle(i,g+h)},getAttr:function(i){var g=Ext.fly(this.el),j=g.getStyle(i),h=l.exec(i)||[];if(j!=="auto"&&!c.test(j)){return parseFloat(j)}return(!!(h[2])||(g.getStyle("position")=="absolute"&&!!(h[3])))?g.dom["offset"+h[0].charAt(0).toUpperCase()+h[0].substr(1)]:0},getDefaultUnit:function(g){return n.test(g)?"px":""},animateX:function(j,i){var h=this,g=function(){h.onComplete.removeListener(g);if(Ext.isFunction(j)){j.call(i||h,h)}};h.onComplete.addListener(g,h);h.animate()},setRunAttr:function(i){var g=this,D=this.attributes[i],C=D.to,h=D.by,B=D.from,A=D.unit,y=(this.runAttrs[i]={}),x;if(!a(C)&&!a(h)){return false}var z=a(B)?B:g.getAttr(i);if(a(C)){x=C}else{if(a(h)){if(Ext.isArray(z)){x=[];for(var w=0,j=z.length;w<j;w++){x[w]=z[w]+h[w]}}else{x=z+h}}}Ext.apply(y,{start:z,end:x,unit:a(A)?A:g.getDefaultUnit(i)})},init:function(w,i,j,x){var g=this,u=0,z=k.AnimMgr;Ext.apply(g,{isAnimated:false,startTime:null,el:Ext.getDom(w),attributes:i||{},duration:j||1,method:x||k.Easing.easeNone,useSec:true,curFrame:0,totalFrames:z.fps,runAttrs:{},animate:function(){var p=this,o=p.duration;if(p.isAnimated){return false}p.curFrame=0;p.totalFrames=p.useSec?Math.ceil(z.fps*o):o;z.registerElement(p)},stop:function(p){var o=this;if(p){o.curFrame=o.totalFrames;o._onTween.fire()}z.stop(o)}});var y=function(){var o=this,p;o.onStart.fire();o.runAttrs={};for(p in this.attributes){this.setRunAttr(p)}o.isAnimated=true;o.startTime=m();u=0};var h=function(){var p=this;p.onTween.fire({duration:m()-p.startTime,curFrame:p.curFrame});var o=p.runAttrs;for(var q in o){this.setAttr(q,p.doMethod(q,o[q].start,o[q].end),o[q].unit)}++u};var v=function(){var q=this,o=(m()-q.startTime)/1000,p={duration:o,frames:u,fps:u/o};q.isAnimated=false;u=0;q.onComplete.fire(p)};g.onStart=new Ext.util.Event(g);g.onTween=new Ext.util.Event(g);g.onComplete=new Ext.util.Event(g);
(g._onStart=new Ext.util.Event(g)).addListener(y);(g._onTween=new Ext.util.Event(g)).addListener(h);(g._onComplete=new Ext.util.Event(g)).addListener(v)}};Ext.lib.AnimMgr=new function(){var q=this,g=null,h=[],i=0;Ext.apply(q,{fps:1000,delay:1,registerElement:function(o){h.push(o);++i;o._onStart.fire();q.start()},unRegister:function(o,p){o._onComplete.fire();p=p||j(o);if(p!=-1){h.splice(p,1)}if(--i<=0){q.stop()}},start:function(){if(g===null){g=setInterval(q.run,q.delay)}},stop:function(o){if(!o){clearInterval(g);for(var p=0,t=h.length;p<t;++p){if(h[0].isAnimated){q.unRegister(h[0],0)}}h=[];g=null;i=0}else{q.unRegister(o)}},run:function(){var o,p,v,u;for(p=0,v=h.length;p<v;p++){u=h[p];if(u&&u.isAnimated){o=u.totalFrames;if(u.curFrame<o||o===null){++u.curFrame;if(u.useSec){r(u)}u._onTween.fire()}else{q.stop(u)}}}}});var j=function(o){var p,t;for(p=0,t=h.length;p<t;p++){if(h[p]===o){return p}}return -1};var r=function(A){var p=A.totalFrames,x=A.curFrame,y=A.duration,z=(x*y*1000/p),B=(m()-A.startTime),o=0;if(B<y*1000){o=Math.round((B/z-1)*x)}else{o=p-(x+1)}if(o>0&&isFinite(o)){if(A.curFrame+o>=p){o=p-(x+1)}A.curFrame+=o}}};k.Bezier=new function(){this.getPosition=function(t,u){var j=t.length,g=[],s=1-u,h,i;for(h=0;h<j;++h){g[h]=[t[h][0],t[h][1]]}for(i=1;i<j;++i){for(h=0;h<j-i;++h){g[h][0]=s*g[h][0]+u*g[parseInt(h+1,10)][0];g[h][1]=s*g[h][1]+u*g[parseInt(h+1,10)][1]}}return[g[0][0],g[0][1]]}};k.Easing={easeNone:function(h,i,j,g){return j*h/g+i},easeIn:function(h,i,j,g){return j*(h/=g)*h+i},easeOut:function(h,i,j,g){return -j*(h/=g)*(h-2)+i}};(function(){k.Motion=function(s,t,r,j){if(s){k.Motion.superclass.constructor.call(this,s,t,r,j)}};Ext.extend(k.Motion,Ext.lib.AnimBase);var g=k.Motion.superclass,h=/^points$/i;Ext.apply(k.Motion.prototype,{setAttr:function(v,j,s){var t=this,u=g.setAttr;if(h.test(v)){s=s||"px";u.call(t,"left",j[0],s);u.call(t,"top",j[1],s)}else{u.call(t,v,j,s)}},getAttr:function(r){var j=this,q=g.getAttr;return h.test(r)?[q.call(j,"left"),q.call(j,"top")]:q.call(j,r)},doMethod:function(t,j,s){var r=this;return h.test(t)?k.Bezier.getPosition(r.runAttrs[t],r.method(r.curFrame,0,100,r.totalFrames)/100):g.doMethod.call(r,t,j,s)},setRunAttr:function(L){if(h.test(L)){var J=this,C=this.el,G=this.attributes.points,N=G.control||[],I=G.from,H=G.to,K=G.by,E=k.Dom,D,j,B,M,F;if(N.length>0&&!Ext.isArray(N[0])){N=[N]}else{}Ext.fly(C,"_anim").position();E.setXY(C,a(I)?I:E.getXY(C));D=J.getAttr("points");if(a(H)){B=i.call(J,H,D);for(j=0,M=N.length;j<M;++j){N[j]=i.call(J,N[j],D)}}else{if(a(K)){B=[D[0]+K[0],D[1]+K[1]];for(j=0,M=N.length;j<M;++j){N[j]=[D[0]+N[j][0],D[1]+N[j][1]]}}}F=this.runAttrs[L]=[D];if(N.length>0){F=F.concat(N)}F[F.length]=B}else{g.setRunAttr.call(this,L)}}});var i=function(r,j){var q=k.Dom.getXY(this.el);return[r[0]-q[0]+j[0],r[1]-q[1]+j[1]]}})()})();(function(){var l=Math.abs,a=Math.PI,b=Math.asin,c=Math.pow,k=Math.sin,j=Ext.lib;Ext.apply(j.Easing,{easeBoth:function(i,n,g,h){return((i/=h/2)<1)?g/2*i*i+n:-g/2*((--i)*(i-2)-1)+n},easeInStrong:function(i,n,g,h){return g*(i/=h)*i*i*i+n},easeOutStrong:function(i,n,g,h){return -g*((i=i/h-1)*i*i*i-1)+n},easeBothStrong:function(i,n,g,h){return((i/=h/2)<1)?g/2*i*i*i*i+n:-g/2*((i-=2)*i*i*i-2)+n},elasticIn:function(h,p,r,s,i,t){if(h==0||(h/=s)==1){return h==0?p:p+r}t=t||(s*0.3);var g;if(i>=l(r)){g=t/(2*a)*b(r/i)}else{i=r;g=t/4}return -(i*c(2,10*(h-=1))*k((h*s-g)*(2*a)/t))+p},elasticOut:function(h,p,r,s,i,t){if(h==0||(h/=s)==1){return h==0?p:p+r}t=t||(s*0.3);var g;if(i>=l(r)){g=t/(2*a)*b(r/i)}else{i=r;g=t/4}return i*c(2,-10*h)*k((h*s-g)*(2*a)/t)+r+p},elasticBoth:function(h,p,r,s,i,t){if(h==0||(h/=s/2)==2){return h==0?p:p+r}t=t||(s*(0.3*1.5));var g;if(i>=l(r)){g=t/(2*a)*b(r/i)}else{i=r;g=t/4}return h<1?-0.5*(i*c(2,10*(h-=1))*k((h*s-g)*(2*a)/t))+p:i*c(2,-10*(h-=1))*k((h*s-g)*(2*a)/t)*0.5+r+p},backIn:function(i,o,p,g,h){h=h||1.70158;return p*(i/=g)*i*((h+1)*i-h)+o},backOut:function(i,o,p,g,h){if(!h){h=1.70158}return p*((i=i/g-1)*i*((h+1)*i+h)+1)+o},backBoth:function(i,o,p,g,h){h=h||1.70158;
return((i/=g/2)<1)?p/2*(i*i*(((h*=(1.525))+1)*i-h))+o:p/2*((i-=2)*i*(((h*=(1.525))+1)*i+h)+2)+o},bounceIn:function(i,n,g,h){return g-j.Easing.bounceOut(h-i,0,g,h)+n},bounceOut:function(i,n,g,h){if((i/=h)<(1/2.75)){return g*(7.5625*i*i)+n}else{if(i<(2/2.75)){return g*(7.5625*(i-=(1.5/2.75))*i+0.75)+n}else{if(i<(2.5/2.75)){return g*(7.5625*(i-=(2.25/2.75))*i+0.9375)+n}}}return g*(7.5625*(i-=(2.625/2.75))*i+0.984375)+n},bounceBoth:function(i,n,g,h){return(i<h/2)?j.Easing.bounceIn(i*2,0,g,h)*0.5+n:j.Easing.bounceOut(i*2-h,0,g,h)*0.5+g*0.5+n}})})();(function(){var n=Ext.lib;n.Anim.color=function(j,l,i,h,g,k){return n.Anim.run(j,l,i,h,g,k,n.ColorAnim)};n.ColorAnim=function(j,g,i,h){n.ColorAnim.superclass.constructor.call(this,j,g,i,h)};Ext.extend(n.ColorAnim,n.AnimBase);var c=n.ColorAnim.superclass,m=/color$/i,p=/^transparent|rgba\(0, 0, 0, 0\)$/,a=/^rgb\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\)$/i,r=/^#?([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})$/i,q=/^#?([0-9A-F]{1})([0-9A-F]{1})([0-9A-F]{1})$/i,o=function(g){return typeof g!=="undefined"};function b(k){var i=parseInt,j,g=null,h;if(k.length==3){return k}Ext.each([r,a,q],function(l,t){j=(t%2==0)?16:10;h=l.exec(k);if(h&&h.length==4){g=[i(h[1],j),i(h[2],j),i(h[3],j)];return false}});return g}Ext.apply(n.ColorAnim.prototype,{getAttr:function(g){var i=this,j=i.el,h;if(m.test(g)){while(j&&p.test(h=Ext.fly(j).getStyle(g))){j=j.parentNode;h="fff"}}else{h=c.getAttr.call(i,g)}return h},doMethod:function(x,l,j){var w=this,k,h=Math.floor,i,g,v;if(m.test(x)){k=[];j=j||[];for(i=0,g=l.length;i<g;i++){v=l[i];k[i]=c.doMethod.call(w,x,v,j[i])}k="rgb("+h(k[0])+","+h(k[1])+","+h(k[2])+")"}else{k=c.doMethod.call(w,x,l,j)}return k},setRunAttr:function(g){var y=this,x=y.attributes[g],w=x.to,z=x.by,k;c.setRunAttr.call(y,g);k=y.runAttrs[g];if(m.test(g)){var l=b(k.start),j=b(k.end);if(!o(w)&&o(z)){j=b(z);for(var i=0,h=l.length;i<h;i++){j[i]=l[i]+j[i]}}k.start=l;k.end=j}}})})();(function(){var c=Ext.lib;c.Anim.scroll=function(o,q,n,m,r,p){return c.Anim.run(o,q,n,m,r,p,c.Scroll)};c.Scroll=function(m,n,l,k){if(m){c.Scroll.superclass.constructor.call(this,m,n,l,k)}};Ext.extend(c.Scroll,c.ColorAnim);var a=c.Scroll.superclass,b="scroll";Ext.apply(c.Scroll.prototype,{doMethod:function(t,n,s){var p,q=this,o=q.curFrame,r=q.totalFrames;if(t==b){p=[q.method(o,n[0],s[0]-n[0],r),q.method(o,n[1],s[1]-n[1],r)]}else{p=a.doMethod.call(q,t,n,s)}return p},getAttr:function(j){var i=this;if(j==b){return[i.el.scrollLeft,i.el.scrollTop]}else{return a.getAttr.call(i,j)}},setAttr:function(n,k,l){var m=this;if(n==b){m.el.scrollLeft=k[0];m.el.scrollTop=k[1]}else{a.setAttr.call(m,n,k,l)}}})})();if(Ext.isIE){function e(){var a=Function.prototype;delete a.createSequence;delete a.defer;delete a.createDelegate;delete a.createCallback;delete a.createInterceptor;window.detachEvent("onunload",e)}window.attachEvent("onunload",e)}})();(function(){var n=Ext.util,l=Ext.each,o=true,m=false;n.Observable=function(){var b=this,a=b.events;if(b.listeners){b.on(b.listeners);delete b.listeners}b.events=a||{}};n.Observable.prototype={filterOptRe:/^(?:scope|delay|buffer|single)$/,fireEvent:function(){var b=Array.prototype.slice.call(arguments,0),i=b[0].toLowerCase(),h=this,a=o,e=h.events[i],c,g,d;if(h.eventsSuspended===o){if(g=h.eventQueue){g.push(b)}}else{if(typeof e=="object"){if(e.bubble){if(e.fire.apply(e,b.slice(1))===m){return m}d=h.getBubbleTarget&&h.getBubbleTarget();if(d&&d.enableBubble){c=d.events[i];if(!c||typeof c!="object"||!c.bubble){d.enableBubble(i)}return d.fireEvent.apply(d,b)}}else{b.shift();a=e.fire.apply(e,b)}}}return a},addListener:function(b,i,a,d){var h=this,e,c,g;if(typeof b=="object"){d=b;for(e in d){c=d[e];if(!h.filterOptRe.test(e)){h.addListener(e,c.fn||c,c.scope||d.scope,c.fn?c:d)}}}else{b=b.toLowerCase();g=h.events[b]||o;if(typeof g=="boolean"){h.events[b]=g=new n.Event(h,b)}g.addListener(i,a,typeof d=="object"?d:{})}},removeListener:function(b,d,a){var c=this.events[b.toLowerCase()];if(typeof c=="object"){c.removeListener(d,a)}},purgeListeners:function(){var c=this.events,b,a;for(a in c){b=c[a];if(typeof b=="object"){b.clearListeners()}}},addEvents:function(c){var d=this;d.events=d.events||{};if(typeof c=="string"){var b=arguments,a=b.length;while(a--){d.events[b[a]]=d.events[b[a]]||o}}else{Ext.applyIf(d.events,c)}},hasListener:function(b){var a=this.events[b.toLowerCase()];return typeof a=="object"&&a.listeners.length>0},suspendEvents:function(a){this.eventsSuspended=o;if(a&&!this.eventQueue){this.eventQueue=[]}},resumeEvents:function(){var b=this,a=b.eventQueue||[];b.eventsSuspended=m;delete b.eventQueue;l(a,function(c){b.fireEvent.apply(b,c)})}};var q=n.Observable.prototype;q.on=q.addListener;q.un=q.removeListener;n.Observable.releaseCapture=function(a){a.fireEvent=q.fireEvent};function p(a,c,b){return function(){if(c.target==arguments[0]){a.apply(b,Array.prototype.slice.call(arguments,0))}}}function t(c,b,a,d){a.task=new n.DelayedTask();return function(){a.task.delay(b.buffer,c,d,Array.prototype.slice.call(arguments,0))}}function s(d,c,a,b){return function(){c.removeListener(a,b);return d.apply(b,arguments)}}function u(c,b,a,d){return function(){var e=new n.DelayedTask(),g=Array.prototype.slice.call(arguments,0);if(!a.tasks){a.tasks=[]}a.tasks.push(e);e.delay(b.delay||10,function(){a.tasks.remove(e);c.apply(d,g)},d)}}n.Event=function(a,b){this.name=b;this.obj=a;this.listeners=[]};n.Event.prototype={addListener:function(c,d,e){var b=this,a;d=d||b.obj;if(!b.isListening(c,d)){a=b.createListener(c,d,e);if(b.firing){b.listeners=b.listeners.slice(0)}b.listeners.push(a)}},createListener:function(c,d,b){b=b||{};d=d||this.obj;var a={fn:c,scope:d,options:b},e=c;if(b.target){e=p(e,b,d)}if(b.delay){e=u(e,b,a,d)}if(b.single){e=s(e,this,c,d)}if(b.buffer){e=t(e,b,a,d)}a.fireFn=e;return a},findListener:function(c,d){var b=this.listeners,e=b.length,a;d=d||this.obj;while(e--){a=b[e];if(a){if(a.fn==c&&a.scope==d){return e}}}return -1},isListening:function(a,b){return this.findListener(a,b)!=-1},removeListener:function(c,d){var e,a,h,b=this,g=m;if((e=b.findListener(c,d))!=-1){if(b.firing){b.listeners=b.listeners.slice(0)}a=b.listeners[e];if(a.task){a.task.cancel();delete a.task}h=a.tasks&&a.tasks.length;if(h){while(h--){a.tasks[h].cancel()}delete a.tasks}b.listeners.splice(e,1);g=o}return g},clearListeners:function(){var b=this,a=b.listeners,c=a.length;while(c--){b.removeListener(a[c].fn,a[c].scope)}},fire:function(){var b=this,c=b.listeners,a=c.length,d=0,g;if(a>0){b.firing=o;var e=Array.prototype.slice.call(arguments,0);for(;d<a;d++){g=c[d];if(g&&g.fireFn.apply(g.scope||b.obj||window,e)===m){return(b.firing=m)}}}b.firing=m;return o}}})();Ext.DomHelper=function(){var z=null,L=/^(?:br|frame|hr|img|input|link|meta|range|spacer|wbr|area|param|col)$/i,J=/^table|tbody|tr|td$/i,R=/tag|children|cn|html$/i,D=/td|tr|tbody/i,H=/([a-z0-9-]+)\s*:\s*([^;\s]+(?:\s*[^;\s]+)*);?/gi,B=/end/i,E,I="afterbegin",G="afterend",S="beforebegin",F="beforeend",U="<table>",N="</table>",T=U+"<tbody>",M="</tbody>"+N,K=T+"<tr>",A="</tr>"+M;
function O(g,c,d,b,h,e){var a=E.insertHtml(b,Ext.getDom(g),C(c));return d?Ext.get(a,true):a}function C(c){var a="",g,d,e,b;if(typeof c=="string"){a=c}else{if(Ext.isArray(c)){for(var h=0;h<c.length;h++){if(c[h]){a+=C(c[h])}}}else{a+="<"+(c.tag=c.tag||"div");for(g in c){d=c[g];if(!R.test(g)){if(typeof d=="object"){a+=" "+g+'="';for(e in d){a+=e+":"+d[e]+";"}a+='"'}else{a+=" "+({cls:"class",htmlFor:"for"}[g]||g)+'="'+d+'"'}}}if(L.test(c.tag)){a+="/>"}else{a+=">";if((b=c.children||c.cn)){a+=C(b)}else{if(c.html){a+=c.html}}a+="</"+c.tag+">"}}}return a}function P(b,e,h,d){z.innerHTML=[e,h,d].join("");var g=-1,i=z,a;while(++g<b){i=i.firstChild}if(a=i.nextSibling){var c=document.createDocumentFragment();while(i){a=i.nextSibling;c.appendChild(i);i=a}i=c}return i}function Q(e,a,d,g){var c,b;z=z||document.createElement("div");if(e=="td"&&(a==I||a==F)||!D.test(e)&&(a==S||a==G)){return}b=a==S?d:a==G?d.nextSibling:a==I?d.firstChild:null;if(a==S||a==G){d=d.parentNode}if(e=="td"||(e=="tr"&&(a==F||a==I))){c=P(4,K,g,A)}else{if((e=="tbody"&&(a==F||a==I))||(e=="tr"&&(a==S||a==G))){c=P(3,T,g,M)}else{c=P(2,U,g,N)}}d.insertBefore(c,b);return c}E={markup:function(a){return C(a)},applyStyles:function(b,a){if(a){var c;b=Ext.fly(b);if(typeof a=="function"){a=a.call()}if(typeof a=="string"){H.lastIndex=0;while((c=H.exec(a))){b.setStyle(c[1],c[2])}}else{if(typeof a=="object"){b.setStyle(a)}}}},insertHtml:function(l,e,k){var a={},c,h,i,g,b,d;l=l.toLowerCase();a[S]=["BeforeBegin","previousSibling"];a[G]=["AfterEnd","nextSibling"];if(e.insertAdjacentHTML){if(J.test(e.tagName)&&(d=Q(e.tagName.toLowerCase(),l,e,k))){return d}a[I]=["AfterBegin","firstChild"];a[F]=["BeforeEnd","lastChild"];if((c=a[l])){e.insertAdjacentHTML(c[0],k);return e[c[1]]}}else{i=e.ownerDocument.createRange();h="setStart"+(B.test(l)?"After":"Before");if(a[l]){i[h](e);g=i.createContextualFragment(k);e.parentNode.insertBefore(g,l==S?e:e.nextSibling);return e[(l==S?"previous":"next")+"Sibling"]}else{b=(l==I?"first":"last")+"Child";if(e.firstChild){i[h](e[b]);g=i.createContextualFragment(k);if(l==I){e.insertBefore(g,e.firstChild)}else{e.appendChild(g)}}else{e.innerHTML=k}return e[b]}}throw'Illegal insertion point -> "'+l+'"'},insertBefore:function(b,c,a){return O(b,c,a,S)},insertAfter:function(b,c,a){return O(b,c,a,G,"nextSibling")},insertFirst:function(b,c,a){return O(b,c,a,I,"firstChild")},append:function(b,c,a){return O(b,c,a,F,"",true)},overwrite:function(b,c,a){b=Ext.getDom(b);b.innerHTML=C(c);return a?Ext.get(b.firstChild):b.firstChild},createHtml:C};return E}();Ext.Template=function(l){var i=this,p=arguments,n=[],o;if(Ext.isArray(l)){l=l.join("")}else{if(p.length>1){for(var m=0,a=p.length;m<a;m++){o=p[m];if(typeof o=="object"){Ext.apply(i,o)}else{n.push(o)}}l=n.join("")}}i.html=l;if(i.compiled){i.compile()}};Ext.Template.prototype={re:/\{([\w-]+)\}/g,applyTemplate:function(d){var c=this;return c.compiled?c.compiled(d):c.html.replace(c.re,function(b,a){return d[a]!==undefined?d[a]:""})},set:function(e,g){var d=this;d.html=e;d.compiled=null;return g?d.compile():d},compile:function(){var me=this,sep=Ext.isGecko?"+":",";function fn(m,name){name="values['"+name+"']";return"'"+sep+"("+name+" == undefined ? '' : "+name+")"+sep+"'"}eval("this.compiled = function(values){ return "+(Ext.isGecko?"'":"['")+me.html.replace(/\\/g,"\\\\").replace(/(\r\n|\n)/g,"\\n").replace(/'/g,"\\'").replace(this.re,fn)+(Ext.isGecko?"';};":"'].join('');};"));return me},insertFirst:function(d,e,g){return this.doInsert("afterBegin",d,e,g)},insertBefore:function(d,e,g){return this.doInsert("beforeBegin",d,e,g)},insertAfter:function(d,e,g){return this.doInsert("afterEnd",d,e,g)},append:function(d,e,g){return this.doInsert("beforeEnd",d,e,g)},doInsert:function(l,i,g,h){i=Ext.getDom(i);var k=Ext.DomHelper.insertHtml(l,i,this.applyTemplate(g));return h?Ext.get(k,true):k},overwrite:function(d,e,g){d=Ext.getDom(d);d.innerHTML=this.applyTemplate(e);return g?Ext.get(d.firstChild,true):d.firstChild}};Ext.Template.prototype.apply=Ext.Template.prototype.applyTemplate;
Ext.Template.from=function(c,d){c=Ext.getDom(c);return new Ext.Template(c.value||c.innerHTML,d||"")};Ext.DomQuery=function(){var cache={},simpleCache={},valueCache={},nonSpace=/\S/,trimRe=/^\s+|\s+$/g,tplRe=/\{(\d+)\}/g,modeRe=/^(\s?[\/>+~]\s?|\s|$)/,tagTokenRe=/^(#)?([\w-\*]+)/,nthRe=/(\d*)n\+?(\d*)/,nthRe2=/\D/,isIE=window.ActiveXObject?true:false,key=30803;eval("var batch = 30803;");function child(parent,index){var i=0,n=parent.firstChild;while(n){if(n.nodeType==1){if(++i==index){return n}}n=n.nextSibling}return null}function next(n){while((n=n.nextSibling)&&n.nodeType!=1){}return n}function prev(n){while((n=n.previousSibling)&&n.nodeType!=1){}return n}function children(parent){var n=parent.firstChild,nodeIndex=-1,nextNode;while(n){nextNode=n.nextSibling;if(n.nodeType==3&&!nonSpace.test(n.nodeValue)){parent.removeChild(n)}else{n.nodeIndex=++nodeIndex}n=nextNode}return this}function byClassName(nodeSet,cls){if(!cls){return nodeSet}var result=[],ri=-1;for(var i=0,ci;ci=nodeSet[i];i++){if((" "+ci.className+" ").indexOf(cls)!=-1){result[++ri]=ci}}return result}function attrValue(n,attr){if(!n.tagName&&typeof n.length!="undefined"){n=n[0]}if(!n){return null}if(attr=="for"){return n.htmlFor}if(attr=="class"||attr=="className"){return n.className}return n.getAttribute(attr)||n[attr]}function getNodes(ns,mode,tagName){var result=[],ri=-1,cs;if(!ns){return result}tagName=tagName||"*";if(typeof ns.getElementsByTagName!="undefined"){ns=[ns]}if(!mode){for(var i=0,ni;ni=ns[i];i++){cs=ni.getElementsByTagName(tagName);for(var j=0,ci;ci=cs[j];j++){result[++ri]=ci}}}else{if(mode=="/"||mode==">"){var utag=tagName.toUpperCase();for(var i=0,ni,cn;ni=ns[i];i++){cn=ni.childNodes;for(var j=0,cj;cj=cn[j];j++){if(cj.nodeName==utag||cj.nodeName==tagName||tagName=="*"){result[++ri]=cj}}}}else{if(mode=="+"){var utag=tagName.toUpperCase();for(var i=0,n;n=ns[i];i++){while((n=n.nextSibling)&&n.nodeType!=1){}if(n&&(n.nodeName==utag||n.nodeName==tagName||tagName=="*")){result[++ri]=n}}}else{if(mode=="~"){var utag=tagName.toUpperCase();for(var i=0,n;n=ns[i];i++){while((n=n.nextSibling)){if(n.nodeName==utag||n.nodeName==tagName||tagName=="*"){result[++ri]=n}}}}}}}return result}function concat(a,b){if(b.slice){return a.concat(b)}for(var i=0,l=b.length;i<l;i++){a[a.length]=b[i]}return a}function byTag(cs,tagName){if(cs.tagName||cs==document){cs=[cs]}if(!tagName){return cs}var result=[],ri=-1;tagName=tagName.toLowerCase();for(var i=0,ci;ci=cs[i];i++){if(ci.nodeType==1&&ci.tagName.toLowerCase()==tagName){result[++ri]=ci}}return result}function byId(cs,id){if(cs.tagName||cs==document){cs=[cs]}if(!id){return cs}var result=[],ri=-1;for(var i=0,ci;ci=cs[i];i++){if(ci&&ci.id==id){result[++ri]=ci;return result}}return result}function byAttribute(cs,attr,value,op,custom){var result=[],ri=-1,useGetStyle=custom=="{",fn=Ext.DomQuery.operators[op],a,xml,hasXml;for(var i=0,ci;ci=cs[i];i++){if(ci.nodeType!=1){continue}if(!hasXml){xml=Ext.DomQuery.isXml(ci);hasXml=true}if(!xml){if(useGetStyle){a=Ext.DomQuery.getStyle(ci,attr)}else{if(attr=="class"||attr=="className"){a=ci.className}else{if(attr=="for"){a=ci.htmlFor}else{if(attr=="href"){a=ci.getAttribute("href",2)}else{a=ci.getAttribute(attr)}}}}}else{a=ci.getAttribute(attr)}if((fn&&fn(a,value))||(!fn&&a)){result[++ri]=ci}}return result}function byPseudo(cs,name,value){return Ext.DomQuery.pseudos[name](cs,value)}function nodupIEXml(cs){var d=++key,r;cs[0].setAttribute("_nodup",d);r=[cs[0]];for(var i=1,len=cs.length;i<len;i++){var c=cs[i];if(!c.getAttribute("_nodup")!=d){c.setAttribute("_nodup",d);r[r.length]=c}}for(var i=0,len=cs.length;i<len;i++){cs[i].removeAttribute("_nodup")}return r}function nodup(cs){if(!cs){return[]}var len=cs.length,c,i,r=cs,cj,ri=-1;if(!len||typeof cs.nodeType!="undefined"||len==1){return cs}if(isIE&&typeof cs[0].selectSingleNode!="undefined"){return nodupIEXml(cs)}var d=++key;cs[0]._nodup=d;for(i=1;c=cs[i];i++){if(c._nodup!=d){c._nodup=d}else{r=[];for(var j=0;j<i;j++){r[++ri]=cs[j]}for(j=i+1;cj=cs[j];
j++){if(cj._nodup!=d){cj._nodup=d;r[++ri]=cj}}return r}}return r}function quickDiffIEXml(c1,c2){var d=++key,r=[];for(var i=0,len=c1.length;i<len;i++){c1[i].setAttribute("_qdiff",d)}for(var i=0,len=c2.length;i<len;i++){if(c2[i].getAttribute("_qdiff")!=d){r[r.length]=c2[i]}}for(var i=0,len=c1.length;i<len;i++){c1[i].removeAttribute("_qdiff")}return r}function quickDiff(c1,c2){var len1=c1.length,d=++key,r=[];if(!len1){return c2}if(isIE&&typeof c1[0].selectSingleNode!="undefined"){return quickDiffIEXml(c1,c2)}for(var i=0;i<len1;i++){c1[i]._qdiff=d}for(var i=0,len=c2.length;i<len;i++){if(c2[i]._qdiff!=d){r[r.length]=c2[i]}}return r}function quickId(ns,mode,root,id){if(ns==root){var d=root.ownerDocument||root;return d.getElementById(id)}ns=getNodes(ns,mode,"*");return byId(ns,id)}return{getStyle:function(el,name){return Ext.fly(el).getStyle(name)},compile:function(path,type){type=type||"select";var fn=["var f = function(root){\n var mode; ++batch; var n = root || document;\n"],mode,lastPath,matchers=Ext.DomQuery.matchers,matchersLn=matchers.length,modeMatch,lmode=path.match(modeRe);if(lmode&&lmode[1]){fn[fn.length]='mode="'+lmode[1].replace(trimRe,"")+'";';path=path.replace(lmode[1],"")}while(path.substr(0,1)=="/"){path=path.substr(1)}while(path&&lastPath!=path){lastPath=path;var tokenMatch=path.match(tagTokenRe);if(type=="select"){if(tokenMatch){if(tokenMatch[1]=="#"){fn[fn.length]='n = quickId(n, mode, root, "'+tokenMatch[2]+'");'}else{fn[fn.length]='n = getNodes(n, mode, "'+tokenMatch[2]+'");'}path=path.replace(tokenMatch[0],"")}else{if(path.substr(0,1)!="@"){fn[fn.length]='n = getNodes(n, mode, "*");'}}}else{if(tokenMatch){if(tokenMatch[1]=="#"){fn[fn.length]='n = byId(n, "'+tokenMatch[2]+'");'}else{fn[fn.length]='n = byTag(n, "'+tokenMatch[2]+'");'}path=path.replace(tokenMatch[0],"")}}while(!(modeMatch=path.match(modeRe))){var matched=false;for(var j=0;j<matchersLn;j++){var t=matchers[j];var m=path.match(t.re);if(m){fn[fn.length]=t.select.replace(tplRe,function(x,i){return m[i]});path=path.replace(m[0],"");matched=true;break}}if(!matched){throw'Error parsing selector, parsing failed at "'+path+'"'}}if(modeMatch[1]){fn[fn.length]='mode="'+modeMatch[1].replace(trimRe,"")+'";';path=path.replace(modeMatch[1],"")}}fn[fn.length]="return nodup(n);\n}";eval(fn.join(""));return f},jsSelect:function(path,root,type){root=root||document;if(typeof root=="string"){root=document.getElementById(root)}var paths=path.split(","),results=[];for(var i=0,len=paths.length;i<len;i++){var subPath=paths[i].replace(trimRe,"");if(!cache[subPath]){cache[subPath]=Ext.DomQuery.compile(subPath);if(!cache[subPath]){throw subPath+" is not a valid selector"}}var result=cache[subPath](root);if(result&&result!=document){results=results.concat(result)}}if(paths.length>1){return nodup(results)}return results},isXml:function(el){var docEl=(el?el.ownerDocument||el:0).documentElement;return docEl?docEl.nodeName!=="HTML":false},select:document.querySelectorAll?function(path,root,type){root=root||document;if(!Ext.DomQuery.isXml(root)){try{var cs=root.querySelectorAll(path);return Ext.toArray(cs)}catch(ex){}}return Ext.DomQuery.jsSelect.call(this,path,root,type)}:function(path,root,type){return Ext.DomQuery.jsSelect.call(this,path,root,type)},selectNode:function(path,root){return Ext.DomQuery.select(path,root)[0]},selectValue:function(path,root,defaultValue){path=path.replace(trimRe,"");if(!valueCache[path]){valueCache[path]=Ext.DomQuery.compile(path,"select")}var n=valueCache[path](root),v;n=n[0]?n[0]:n;if(typeof n.normalize=="function"){n.normalize()}v=(n&&n.firstChild?n.firstChild.nodeValue:null);return((v===null||v===undefined||v==="")?defaultValue:v)},selectNumber:function(path,root,defaultValue){var v=Ext.DomQuery.selectValue(path,root,defaultValue||0);return parseFloat(v)},is:function(el,ss){if(typeof el=="string"){el=document.getElementById(el)}var isArray=Ext.isArray(el),result=Ext.DomQuery.filter(isArray?el:[el],ss);return isArray?(result.length==el.length):(result.length>0)
},filter:function(els,ss,nonMatches){ss=ss.replace(trimRe,"");if(!simpleCache[ss]){simpleCache[ss]=Ext.DomQuery.compile(ss,"simple")}var result=simpleCache[ss](els);return nonMatches?quickDiff(result,els):result},matchers:[{re:/^\.([\w-]+)/,select:'n = byClassName(n, " {1} ");'},{re:/^\:([\w-]+)(?:\(((?:[^\s>\/]*|.*?))\))?/,select:'n = byPseudo(n, "{1}", "{2}");'},{re:/^(?:([\[\{])(?:@)?([\w-]+)\s?(?:(=|.=)\s?['"]?(.*?)["']?)?[\]\}])/,select:'n = byAttribute(n, "{2}", "{4}", "{3}", "{1}");'},{re:/^#([\w-]+)/,select:'n = byId(n, "{1}");'},{re:/^@([\w-]+)/,select:'return {firstChild:{nodeValue:attrValue(n, "{1}")}};'}],operators:{"=":function(a,v){return a==v},"!=":function(a,v){return a!=v},"^=":function(a,v){return a&&a.substr(0,v.length)==v},"$=":function(a,v){return a&&a.substr(a.length-v.length)==v},"*=":function(a,v){return a&&a.indexOf(v)!==-1},"%=":function(a,v){return(a%v)==0},"|=":function(a,v){return a&&(a==v||a.substr(0,v.length+1)==v+"-")},"~=":function(a,v){return a&&(" "+a+" ").indexOf(" "+v+" ")!=-1}},pseudos:{"first-child":function(c){var r=[],ri=-1,n;for(var i=0,ci;ci=n=c[i];i++){while((n=n.previousSibling)&&n.nodeType!=1){}if(!n){r[++ri]=ci}}return r},"last-child":function(c){var r=[],ri=-1,n;for(var i=0,ci;ci=n=c[i];i++){while((n=n.nextSibling)&&n.nodeType!=1){}if(!n){r[++ri]=ci}}return r},"nth-child":function(c,a){var r=[],ri=-1,m=nthRe.exec(a=="even"&&"2n"||a=="odd"&&"2n+1"||!nthRe2.test(a)&&"n+"+a||a),f=(m[1]||1)-0,l=m[2]-0;for(var i=0,n;n=c[i];i++){var pn=n.parentNode;if(batch!=pn._batch){var j=0;for(var cn=pn.firstChild;cn;cn=cn.nextSibling){if(cn.nodeType==1){cn.nodeIndex=++j}}pn._batch=batch}if(f==1){if(l==0||n.nodeIndex==l){r[++ri]=n}}else{if((n.nodeIndex+l)%f==0){r[++ri]=n}}}return r},"only-child":function(c){var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){if(!prev(ci)&&!next(ci)){r[++ri]=ci}}return r},empty:function(c){var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){var cns=ci.childNodes,j=0,cn,empty=true;while(cn=cns[j]){++j;if(cn.nodeType==1||cn.nodeType==3){empty=false;break}}if(empty){r[++ri]=ci}}return r},contains:function(c,v){var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){if((ci.textContent||ci.innerText||"").indexOf(v)!=-1){r[++ri]=ci}}return r},nodeValue:function(c,v){var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){if(ci.firstChild&&ci.firstChild.nodeValue==v){r[++ri]=ci}}return r},checked:function(c){var r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){if(ci.checked==true){r[++ri]=ci}}return r},not:function(c,ss){return Ext.DomQuery.filter(c,ss,true)},any:function(c,selectors){var ss=selectors.split("|"),r=[],ri=-1,s;for(var i=0,ci;ci=c[i];i++){for(var j=0;s=ss[j];j++){if(Ext.DomQuery.is(ci,s)){r[++ri]=ci;break}}}return r},odd:function(c){return this["nth-child"](c,"odd")},even:function(c){return this["nth-child"](c,"even")},nth:function(c,a){return c[a-1]||[]},first:function(c){return c[0]||[]},last:function(c){return c[c.length-1]||[]},has:function(c,ss){var s=Ext.DomQuery.select,r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){if(s(ss,ci).length>0){r[++ri]=ci}}return r},next:function(c,ss){var is=Ext.DomQuery.is,r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){var n=next(ci);if(n&&is(n,ss)){r[++ri]=ci}}return r},prev:function(c,ss){var is=Ext.DomQuery.is,r=[],ri=-1;for(var i=0,ci;ci=c[i];i++){var n=prev(ci);if(n&&is(n,ss)){r[++ri]=ci}}return r}}}}();Ext.query=Ext.DomQuery.select;Ext.util.DelayedTask=function(m,n,i){var l=this,k,h=function(){clearInterval(k);k=null;m.apply(n,i||[])};l.delay=function(c,a,b,d){l.cancel();m=a||m;n=b||n;i=d||i;k=setInterval(h,c)};l.cancel=function(){if(k){clearInterval(k);k=null}}};(function(){var p=document;Ext.Element=function(a,d){var c=typeof a=="string"?p.getElementById(a):a,b;if(!c){return null}b=c.id;if(!d&&b&&Ext.elCache[b]){return Ext.elCache[b].el}this.dom=c;this.id=b||Ext.id(c)};var t=Ext.DomHelper,s=Ext.Element,w=Ext.elCache;s.prototype={set:function(b,e){var d=this.dom,a,c,e=(e!==false)&&!!d.setAttribute;for(a in b){if(b.hasOwnProperty(a)){c=b[a];if(a=="style"){t.applyStyles(d,c)}else{if(a=="cls"){d.className=c
}else{if(e){d.setAttribute(a,c)}else{d[a]=c}}}}}return this},defaultUnit:"px",is:function(a){return Ext.DomQuery.is(this.dom,a)},focus:function(b,c){var a=this,c=c||a.dom;try{if(Number(b)){a.focus.defer(b,null,[null,c])}else{c.focus()}}catch(d){}return a},blur:function(){try{this.dom.blur()}catch(a){}return this},getValue:function(a){var b=this.dom.value;return a?parseInt(b,10):b},addListener:function(a,b,c,d){Ext.EventManager.on(this.dom,a,b,c||this,d);return this},removeListener:function(a,b,c){Ext.EventManager.removeListener(this.dom,a,b,c||this);return this},removeAllListeners:function(){Ext.EventManager.removeAll(this.dom);return this},purgeAllListeners:function(){Ext.EventManager.purgeElement(this,true);return this},addUnits:function(a){if(a===""||a=="auto"||a===undefined){a=a||""}else{if(!isNaN(a)||!o.test(a)){a=a+(this.defaultUnit||"px")}}return a},load:function(c,b,a){Ext.Ajax.request(Ext.apply({params:b,url:c.url||c,callback:a,el:this.dom,indicatorText:c.indicatorText||""},Ext.isObject(c)?c:{}));return this},isBorderBox:function(){return Ext.isBorderBox||Ext.isForcedBorderBox||q[(this.dom.tagName||"").toLowerCase()]},remove:function(){var a=this,b=a.dom;if(b){delete a.dom;Ext.removeNode(b)}},hover:function(e,a,c,d){var b=this;b.on("mouseenter",e,c||b.dom,d);b.on("mouseleave",a,c||b.dom,d);return b},contains:function(a){return !a?false:Ext.lib.Dom.isAncestor(this.dom,a.dom?a.dom:a)},getAttributeNS:function(b,a){return this.getAttribute(a,b)},getAttribute:Ext.isIE?function(a,c){var b=this.dom,d=typeof b[c+":"+a];if(["undefined","unknown"].indexOf(d)==-1){return b[c+":"+a]}return b[a]}:function(a,c){var b=this.dom;return b.getAttributeNS(c,a)||b.getAttribute(c+":"+a)||b.getAttribute(a)||b[a]},update:function(a){if(this.dom){this.dom.innerHTML=a}return this}};var m=s.prototype;s.addMethods=function(a){Ext.apply(m,a)};m.on=m.addListener;m.un=m.removeListener;m.autoBoxAdjust=true;var o=/\d+(px|em|%|en|ex|pt|in|cm|mm|pc)$/i,u;s.get=function(e){var a,b,c;if(!e){return null}if(typeof e=="string"){if(!(b=p.getElementById(e))){return null}if(w[e]&&w[e].el){a=w[e].el;a.dom=b}else{a=s.addToCache(new s(b))}return a}else{if(e.tagName){if(!(c=e.id)){c=Ext.id(e)}if(w[c]&&w[c].el){a=w[c].el;a.dom=e}else{a=s.addToCache(new s(e))}return a}else{if(e instanceof s){if(e!=u){if(Ext.isIE&&(e.id==undefined||e.id=="")){e.dom=e.dom}else{e.dom=p.getElementById(e.id)||e.dom}}return e}else{if(e.isComposite){return e}else{if(Ext.isArray(e)){return s.select(e)}else{if(e==p){if(!u){var d=function(){};d.prototype=s.prototype;u=new d();u.dom=p}return u}}}}}}return null};s.addToCache=function(a,b){b=b||a.id;w[b]={el:a,data:{},events:{}};return a};s.data=function(d,a,c){d=s.get(d);if(!d){return null}var b=w[d.id].data;if(arguments.length==2){return b[a]}else{return(b[a]=c)}};function n(){if(!Ext.enableGarbageCollector){clearInterval(s.collectorThreadId)}else{var a,d,b,c;for(a in w){c=w[a];if(c.skipGC){continue}d=c.el;b=d.dom;if(!b||!b.parentNode||(!b.offsetParent&&!p.getElementById(a))){if(Ext.enableListenerCollection){Ext.EventManager.removeAll(b)}delete w[a]}}if(Ext.isIE){var e={};for(a in w){e[a]=w[a]}w=Ext.elCache=e}}}s.collectorThreadId=setInterval(n,30000);var v=function(){};v.prototype=s.prototype;s.Flyweight=function(a){this.dom=a};s.Flyweight.prototype=new v();s.Flyweight.prototype.isFlyweight=true;s._flyweights={};s.fly=function(b,a){var c=null;a=a||"_global";if(b=Ext.getDom(b)){(s._flyweights[a]=s._flyweights[a]||new s.Flyweight()).dom=b;c=s._flyweights[a]}return c};Ext.get=s.get;Ext.fly=s.fly;var q=Ext.isStrict?{select:1}:{input:1,select:1,textarea:1};if(Ext.isIE||Ext.isGecko){q.button=1}})();Ext.Element.addMethods(function(){var k="parentNode",g="nextSibling",l="previousSibling",i=Ext.DomQuery,h=Ext.get;return{findParent:function(p,a,e){var c=this.dom,o=document.body,b=0,d;if(Ext.isGecko&&Object.prototype.toString.call(c)=="[object XULElement]"){return null}a=a||50;if(isNaN(a)){d=Ext.getDom(a);a=Number.MAX_VALUE}while(c&&c.nodeType==1&&b<a&&c!=o&&c!=d){if(i.is(c,p)){return e?h(c):c
}b++;c=c.parentNode}return null},findParentNode:function(a,b,d){var c=Ext.fly(this.dom.parentNode,"_internal");return c?c.findParent(a,b,d):null},up:function(a,b){return this.findParentNode(a,b,true)},select:function(a){return Ext.Element.select(a,this.dom)},query:function(a){return i.select(a,this.dom)},child:function(c,b){var a=i.selectNode(c,this.dom);return b?a:h(a)},down:function(c,b){var a=i.selectNode(" > "+c,this.dom);return b?a:h(a)},parent:function(b,a){return this.matchNode(k,k,b,a)},next:function(b,a){return this.matchNode(g,g,b,a)},prev:function(b,a){return this.matchNode(l,l,b,a)},first:function(b,a){return this.matchNode(g,"firstChild",b,a)},last:function(b,a){return this.matchNode(l,"lastChild",b,a)},matchNode:function(d,a,e,c){var b=this.dom[a];while(b){if(b.nodeType==1&&(!e||i.is(b,e))){return !c?h(b):b}b=b[d]}return null}}}());Ext.Element.addMethods(function(){var g=Ext.getDom,e=Ext.get,d=Ext.DomHelper;return{appendChild:function(a){return e(a).appendTo(this)},appendTo:function(a){g(a).appendChild(this.dom);return this},insertBefore:function(a){(a=g(a)).parentNode.insertBefore(this.dom,a);return this},insertAfter:function(a){(a=g(a)).parentNode.insertBefore(this.dom,a.nextSibling);return this},insertFirst:function(a,b){a=a||{};if(a.nodeType||a.dom||typeof a=="string"){a=g(a);this.dom.insertBefore(a,this.dom.firstChild);return !b?e(a):a}else{return this.createChild(a,this.dom.firstChild,b)}},replace:function(a){a=e(a);this.insertBefore(a);a.remove();return this},replaceWith:function(b){var a=this;if(b.nodeType||b.dom||typeof b=="string"){b=g(b);a.dom.parentNode.insertBefore(b,a.dom)}else{b=d.insertBefore(a.dom,b)}delete Ext.elCache[a.id];Ext.removeNode(a.dom);a.id=Ext.id(a.dom=b);Ext.Element.addToCache(a.isFlyweight?new Ext.Element(a.dom):a);return a},createChild:function(b,c,a){b=b||{tag:"div"};return c?d.insertBefore(c,b,a!==true):d[!this.dom.firstChild?"overwrite":"append"](this.dom,b,a!==true)},wrap:function(c,b){var a=d.insertBefore(this.dom,c||{tag:"div"},!b);a.dom?a.dom.appendChild(this.dom):a.appendChild(this.dom);return a},insertHtml:function(c,b,i){var a=d.insertHtml(c,this.dom,b);return i?Ext.get(a):a}}}());Ext.Element.addMethods(function(){var T=Ext.supports,ae={},H=/(-[a-z])/gi,O=document.defaultView,N=/alpha\(opacity=(.*)\)/i,aa=/^\s+|\s+$/g,S=Ext.Element,K=/\s+/,aj=/\w/g,ah="padding",ai="margin",W="border",M="-left",R="-right",I="-top",X="-bottom",ac="-width",Q=Math,V="hidden",ag="isClipped",ab="overflow",Y="overflow-x",Z="overflow-y",P="originalClip",ad={l:W+M+ac,r:W+R+ac,t:W+I+ac,b:W+X+ac},af={l:ah+M,r:ah+R,t:ah+I,b:ah+X},ak={l:ai+M,r:ai+R,t:ai+I,b:ai+X},L=Ext.Element.data;function U(b,a){return a.charAt(1).toUpperCase()}function J(a){return ae[a]||(ae[a]=a=="float"?(T.cssFloat?"cssFloat":"styleFloat"):a.replace(H,U))}return{adjustWidth:function(c){var b=this;var a=(typeof c=="number");if(a&&b.autoBoxAdjust&&!b.isBorderBox()){c-=(b.getBorderWidth("lr")+b.getPadding("lr"))}return(a&&c<0)?0:c},adjustHeight:function(c){var b=this;var a=(typeof c=="number");if(a&&b.autoBoxAdjust&&!b.isBorderBox()){c-=(b.getBorderWidth("tb")+b.getPadding("tb"))}return(a&&c<0)?0:c},addClass:function(a){var g=this,b,e,c,d=[];if(!Ext.isArray(a)){if(typeof a=="string"&&!this.hasClass(a)){g.dom.className+=" "+a}}else{for(b=0,e=a.length;b<e;b++){c=a[b];if(typeof c=="string"&&(" "+g.dom.className+" ").indexOf(" "+c+" ")==-1){d.push(c)}}if(d.length){g.dom.className+=" "+d.join(" ")}}return g},removeClass:function(h){var g=this,a,d,e,b,c;if(!Ext.isArray(h)){h=[h]}if(g.dom&&g.dom.className){c=g.dom.className.replace(aa,"").split(K);for(a=0,e=h.length;a<e;a++){b=h[a];if(typeof b=="string"){b=b.replace(aa,"");d=c.indexOf(b);if(d!=-1){c.splice(d,1)}}}g.dom.className=c.join(" ")}return g},radioClass:function(b){var a=this.dom.parentNode.childNodes,d,c,e;b=Ext.isArray(b)?b:[b];for(c=0,e=a.length;c<e;c++){d=a[c];if(d&&d.nodeType==1){Ext.fly(d,"_internal").removeClass(b)}}return this.addClass(b)},toggleClass:function(a){return this.hasClass(a)?this.removeClass(a):this.addClass(a)
},hasClass:function(a){return a&&(" "+this.dom.className+" ").indexOf(" "+a+" ")!=-1},replaceClass:function(a,b){return this.removeClass(a).addClass(b)},isStyle:function(b,a){return this.getStyle(b)==a},getStyle:function(){return O&&O.getComputedStyle?function(g){var b=this.dom,e,c,d,a;if(b==document){return null}g=J(g);d=(e=b.style[g])?e:(c=O.getComputedStyle(b,""))?c[g]:null;if(g=="marginRight"&&d!="0px"&&!T.correctRightMargin){a=b.style.display;b.style.display="inline-block";d=O.getComputedStyle(b,"").marginRight;b.style.display=a}if(g=="backgroundColor"&&d=="rgba(0, 0, 0, 0)"&&!T.correctTransparentColor){d="transparent"}return d}:function(a){var c=this.dom,e,d;if(c==document){return null}if(a=="opacity"){if(c.style.filter.match){if(e=c.style.filter.match(N)){var b=parseFloat(e[1]);if(!isNaN(b)){return b?b/100:0}}}return 1}a=J(a);return c.style[a]||((d=c.currentStyle)?d[a]:null)}}(),getColor:function(e,d,g){var b=this.getStyle(e),c=(typeof g!="undefined")?g:"#",a;if(!b||(/transparent|inherit/.test(b))){return d}if(/^r/.test(b)){Ext.each(b.slice(4,b.length-1).split(","),function(h){a=parseInt(h,10);c+=(a<16?"0":"")+a.toString(16)})}else{b=b.replace("#","");c+=b.length==3?b.replace(/^(\w)(\w)(\w)$/,"$1$1$2$2$3$3"):b}return(c.length>5?c.toLowerCase():d)},setStyle:function(a,b){var d,c;if(typeof a!="object"){d={};d[a]=b;a=d}for(c in a){b=a[c];c=="opacity"?this.setOpacity(b):this.dom.style[J(c)]=b}return this},setOpacity:function(d,e){var a=this,c=a.dom.style;if(!e||!a.anim){if(Ext.isIE){var b=d<1?"alpha(opacity="+d*100+")":"",g=c.filter.replace(N,"").replace(aa,"");c.zoom=1;c.filter=g+(g.length>0?" ":"")+b}else{c.opacity=d}}else{a.anim({opacity:{to:d}},a.preanim(arguments,1),null,0.35,"easeIn")}return a},clearOpacity:function(){var a=this.dom.style;if(Ext.isIE){if(!Ext.isEmpty(a.filter)){a.filter=a.filter.replace(N,"").replace(aa,"")}}else{a.opacity=a["-moz-opacity"]=a["-khtml-opacity"]=""}return this},getHeight:function(c){var d=this,a=d.dom,b=Ext.isIE&&d.isStyle("display","none"),e=Q.max(a.offsetHeight,b?0:a.clientHeight)||0;e=!c?e:e-d.getBorderWidth("tb")-d.getPadding("tb");return e<0?0:e},getWidth:function(d){var c=this,a=c.dom,b=Ext.isIE&&c.isStyle("display","none"),e=Q.max(a.offsetWidth,b?0:a.clientWidth)||0;e=!d?e:e-c.getBorderWidth("lr")-c.getPadding("lr");return e<0?0:e},setWidth:function(b,c){var a=this;b=a.adjustWidth(b);!c||!a.anim?a.dom.style.width=a.addUnits(b):a.anim({width:{to:b}},a.preanim(arguments,1));return a},setHeight:function(c,b){var a=this;c=a.adjustHeight(c);!b||!a.anim?a.dom.style.height=a.addUnits(c):a.anim({height:{to:c}},a.preanim(arguments,1));return a},getBorderWidth:function(a){return this.addStyles(a,ad)},getPadding:function(a){return this.addStyles(a,af)},clip:function(){var b=this,a=b.dom;if(!L(a,ag)){L(a,ag,true);L(a,P,{o:b.getStyle(ab),x:b.getStyle(Y),y:b.getStyle(Z)});b.setStyle(ab,V);b.setStyle(Y,V);b.setStyle(Z,V)}return b},unclip:function(){var c=this,a=c.dom;if(L(a,ag)){L(a,ag,false);var b=L(a,P);if(b.o){c.setStyle(ab,b.o)}if(b.x){c.setStyle(Y,b.x)}if(b.y){c.setStyle(Z,b.y)}}return c},addStyles:function(g,h){var a=0,i=g.match(aj),b,c,d,e=i.length;for(d=0;d<e;d++){b=i[d];c=b&&parseInt(this.getStyle(h[b]),10);if(c){a+=Q.abs(c)}}return a},margins:ak}}());(function(){var w=Ext.lib.Dom,v="left",q="right",t="top",o="bottom",p="position",u="static",s="relative",n="auto",m="z-index";Ext.Element.addMethods({getX:function(){return w.getX(this.dom)},getY:function(){return w.getY(this.dom)},getXY:function(){return w.getXY(this.dom)},getOffsetsTo:function(a){var b=this.getXY(),c=Ext.fly(a,"_internal").getXY();return[b[0]-c[0],b[1]-c[1]]},setX:function(a,b){return this.setXY([a,this.getY()],this.animTest(arguments,b,1))},setY:function(b,a){return this.setXY([this.getX(),b],this.animTest(arguments,a,1))},setLeft:function(a){this.setStyle(v,this.addUnits(a));return this},setTop:function(a){this.setStyle(t,this.addUnits(a));return this},setRight:function(a){this.setStyle(q,this.addUnits(a));return this},setBottom:function(a){this.setStyle(o,this.addUnits(a));
return this},setXY:function(b,a){var c=this;if(!a||!c.anim){w.setXY(c.dom,b)}else{c.anim({points:{to:b}},c.preanim(arguments,1),"motion")}return c},setLocation:function(a,b,c){return this.setXY([a,b],this.animTest(arguments,c,2))},moveTo:function(a,b,c){return this.setXY([a,b],this.animTest(arguments,c,2))},getLeft:function(a){return !a?this.getX():parseInt(this.getStyle(v),10)||0},getRight:function(a){var b=this;return !a?b.getX()+b.getWidth():(b.getLeft(true)+b.getWidth())||0},getTop:function(a){return !a?this.getY():parseInt(this.getStyle(t),10)||0},getBottom:function(a){var b=this;return !a?b.getY()+b.getHeight():(b.getTop(true)+b.getHeight())||0},position:function(b,c,a,d){var e=this;if(!b&&e.isStyle(p,u)){e.setStyle(p,s)}else{if(b){e.setStyle(p,b)}}if(c){e.setStyle(m,c)}if(a||d){e.setXY([a||false,d||false])}},clearPositioning:function(a){a=a||"";this.setStyle({left:a,right:a,top:a,bottom:a,"z-index":"",position:u});return this},getPositioning:function(){var a=this.getStyle(v);var b=this.getStyle(t);return{position:this.getStyle(p),left:a,right:a?"":this.getStyle(q),top:b,bottom:b?"":this.getStyle(o),"z-index":this.getStyle(m)}},setPositioning:function(a){var b=this,c=b.dom.style;b.setStyle(a);if(a.right==n){c.right=""}if(a.bottom==n){c.bottom=""}return b},translatePoints:function(a,b){b=isNaN(a[1])?b:a[1];a=isNaN(a[0])?a:a[0];var e=this,d=e.isStyle(p,s),c=e.getXY(),h=parseInt(e.getStyle(v),10),g=parseInt(e.getStyle(t),10);h=!isNaN(h)?h:(d?0:e.dom.offsetLeft);g=!isNaN(g)?g:(d?0:e.dom.offsetTop);return{left:(a-c[0]+h),top:(b-c[1]+g)}},animTest:function(c,a,b){return !!a&&this.preanim?this.preanim(c,b):false}})})();Ext.Element.addMethods({isScrollable:function(){var b=this.dom;return b.scrollHeight>b.clientHeight||b.scrollWidth>b.clientWidth},scrollTo:function(d,c){this.dom["scroll"+(/top/i.test(d)?"Top":"Left")]=c;return this},getScroll:function(){var l=this.dom,m=document,k=m.body,p=m.documentElement,d,n,o;if(l==m||l==k){if(Ext.isIE&&Ext.isStrict){d=p.scrollLeft;n=p.scrollTop}else{d=window.pageXOffset;n=window.pageYOffset}o={left:d||(k?k.scrollLeft:0),top:n||(k?k.scrollTop:0)}}else{o={left:l.scrollLeft,top:l.scrollTop}}return o}});Ext.Element.VISIBILITY=1;Ext.Element.DISPLAY=2;Ext.Element.OFFSETS=3;Ext.Element.ASCLASS=4;Ext.Element.visibilityCls="x-hide-nosize";Ext.Element.addMethods(function(){var C=Ext.Element,s="opacity",y="visibility",B="display",D="hidden",u="offsets",x="asclass",v="none",G="nosize",F="originalDisplay",E="visibilityMode",A="isVisible",z=C.data,w=function(a){var b=z(a,F);if(b===undefined){z(a,F,b="")}return b},t=function(a){var b=z(a,E);if(b===undefined){z(a,E,b=1)}return b};return{originalDisplay:"",visibilityMode:1,setVisibilityMode:function(a){z(this.dom,E,a);return this},animate:function(d,b,c,a,e){this.anim(d,{duration:b,callback:c,easing:a},e);return this},anim:function(c,b,e,i,d,g){e=e||"run";b=b||{};var a=this,h=Ext.lib.Anim[e](a.dom,c,(b.duration||i)||0.35,(b.easing||d)||"easeOut",function(){if(g){g.call(a)}if(b.callback){b.callback.call(b.scope||a,a,b)}},a);b.anim=h;return h},preanim:function(b,a){return !b[a]?false:(typeof b[a]=="object"?b[a]:{duration:b[a+1],callback:b[a+2],easing:b[a+3]})},isVisible:function(){var c=this,a=c.dom,b=z(a,A);if(typeof b=="boolean"){return b}b=!c.isStyle(y,D)&&!c.isStyle(B,v)&&!((t(a)==C.ASCLASS)&&c.hasClass(c.visibilityCls||C.visibilityCls));z(a,A,b);return b},setVisible:function(g,k){var c=this,i,a,b,d,e=c.dom,h=t(e);if(typeof k=="string"){switch(k){case B:h=C.DISPLAY;break;case y:h=C.VISIBILITY;break;case u:h=C.OFFSETS;break;case G:case x:h=C.ASCLASS;break}c.setVisibilityMode(h);k=false}if(!k||!c.anim){if(h==C.ASCLASS){c[g?"removeClass":"addClass"](c.visibilityCls||C.visibilityCls)}else{if(h==C.DISPLAY){return c.setDisplayed(g)}else{if(h==C.OFFSETS){if(!g){c.hideModeStyles={position:c.getStyle("position"),top:c.getStyle("top"),left:c.getStyle("left")};c.applyStyles({position:"absolute",top:"-10000px",left:"-10000px"})}else{c.applyStyles(c.hideModeStyles||{position:"",top:"",left:""});
delete c.hideModeStyles}}else{c.fixDisplay();e.style.visibility=g?"visible":D}}}}else{if(g){c.setOpacity(0.01);c.setVisible(true)}c.anim({opacity:{to:(g?1:0)}},c.preanim(arguments,1),null,0.35,"easeIn",function(){g||c.setVisible(false).setOpacity(1)})}z(e,A,g);return c},hasMetrics:function(){var a=this.dom;return this.isVisible()||(t(a)==C.VISIBILITY)},toggle:function(b){var a=this;a.setVisible(!a.isVisible(),a.preanim(arguments,0));return a},setDisplayed:function(a){if(typeof a=="boolean"){a=a?w(this.dom):v}this.setStyle(B,a);return this},fixDisplay:function(){var a=this;if(a.isStyle(B,v)){a.setStyle(y,D);a.setStyle(B,w(this.dom));if(a.isStyle(B,v)){a.setStyle(B,"block")}}},hide:function(a){if(typeof a=="string"){this.setVisible(false,a);return this}this.setVisible(false,this.preanim(arguments,0));return this},show:function(a){if(typeof a=="string"){this.setVisible(true,a);return this}this.setVisible(true,this.preanim(arguments,0));return this}}}());(function(){var P=null,L=undefined,T=true,H=false,U="setX",W="setY",ac="setXY",Q="left",S="bottom",I="top",R="right",K="height",X="width",V="points",E="hidden",N="absolute",G="visible",Y="motion",O="position",J="easeOut",Z=new Ext.Element.Flyweight(),F={},D=function(a){return a||{}},M=function(a){Z.dom=a;Z.id=Ext.id(a);return Z},aa=function(a){if(!F[a]){F[a]=[]}return F[a]},ab=function(a,b){F[a]=b};Ext.enableFx=T;Ext.Fx={switchStatements:function(b,a,c){return a.apply(this,c[b])},slideIn:function(k,n){n=D(n);var h=this,l=h.dom,d=l.style,b,a,e,o,p,d,i,c,g,m;k=k||"t";h.queueFx(n,function(){b=M(l).getXY();M(l).fixDisplay();a=M(l).getFxRestore();e={x:b[0],y:b[1],0:b[0],1:b[1],width:l.offsetWidth,height:l.offsetHeight};e.right=e.x+e.width;e.bottom=e.y+e.height;M(l).setWidth(e.width).setHeight(e.height);o=M(l).fxWrap(a.pos,n,E);d.visibility=G;d.position=N;function s(){M(l).fxUnwrap(o,a.pos,n);d.width=a.width;d.height=a.height;M(l).afterFx(n)}c={to:[e.x,e.y]};g={to:e.width};m={to:e.height};function q(x,A,w,z,u,ae,B,C,ad,v,y){var t={};M(x).setWidth(w).setHeight(z);if(M(x)[u]){M(x)[u](ae)}A[B]=A[C]="0";if(ad){t.width=ad}if(v){t.height=v}if(y){t.points=y}return t}i=M(l).switchStatements(k.toLowerCase(),q,{t:[o,d,e.width,0,P,P,Q,S,P,m,P],l:[o,d,0,e.height,P,P,R,I,g,P,P],r:[o,d,e.width,e.height,U,e.right,Q,I,P,P,c],b:[o,d,e.width,e.height,W,e.bottom,Q,I,P,m,c],tl:[o,d,0,0,P,P,R,S,g,m,c],bl:[o,d,0,0,W,e.y+e.height,R,I,g,m,c],br:[o,d,0,0,ac,[e.right,e.bottom],Q,I,g,m,c],tr:[o,d,0,0,U,e.x+e.width,Q,S,g,m,c]});d.visibility=G;M(o).show();arguments.callee.anim=M(o).fxanim(i,n,Y,0.5,J,s)});return h},slideOut:function(i,l){l=D(l);var g=this,k=g.dom,c=k.style,b=g.getXY(),m,a,e,d,h={to:0};i=i||"t";g.queueFx(l,function(){a=M(k).getFxRestore();e={x:b[0],y:b[1],0:b[0],1:b[1],width:k.offsetWidth,height:k.offsetHeight};e.right=e.x+e.width;e.bottom=e.y+e.height;M(k).setWidth(e.width).setHeight(e.height);m=M(k).fxWrap(a.pos,l,G);c.visibility=G;c.position=N;M(m).setWidth(e.width).setHeight(e.height);function o(){l.useDisplay?M(k).setDisplayed(H):M(k).hide();M(k).fxUnwrap(m,a.pos,l);c.width=a.width;c.height=a.height;M(k).afterFx(l)}function n(z,q,t,p,v,s,w,u,x){var y={};z[q]=z[t]="0";y[p]=v;if(s){y[s]=w}if(u){y[u]=x}return y}d=M(k).switchStatements(i.toLowerCase(),n,{t:[c,Q,S,K,h],l:[c,R,I,X,h],r:[c,Q,I,X,h,V,{to:[e.right,e.y]}],b:[c,Q,I,K,h,V,{to:[e.x,e.bottom]}],tl:[c,R,S,X,h,K,h],bl:[c,R,I,X,h,K,h,V,{to:[e.x,e.bottom]}],br:[c,Q,I,X,h,K,h,V,{to:[e.x+e.width,e.bottom]}],tr:[c,Q,S,X,h,K,h,V,{to:[e.right,e.y]}]});arguments.callee.anim=M(m).fxanim(d,l,Y,0.5,J,o)});return g},puff:function(a){a=D(a);var c=this,b=c.dom,g=b.style,e,h,d;c.queueFx(a,function(){e=M(b).getWidth();h=M(b).getHeight();M(b).clearOpacity();M(b).show();d=M(b).getFxRestore();function i(){a.useDisplay?M(b).setDisplayed(H):M(b).hide();M(b).clearOpacity();M(b).setPositioning(d.pos);g.width=d.width;g.height=d.height;g.fontSize="";M(b).afterFx(a)}arguments.callee.anim=M(b).fxanim({width:{to:M(b).adjustWidth(e*2)},height:{to:M(b).adjustHeight(h*2)},points:{by:[-e*0.5,-h*0.5]},opacity:{to:0},fontSize:{to:200,unit:"%"}},a,Y,0.5,J,i)
});return c},switchOff:function(a){a=D(a);var c=this,b=c.dom,e=b.style,d;c.queueFx(a,function(){M(b).clearOpacity();M(b).clip();d=M(b).getFxRestore();function g(){a.useDisplay?M(b).setDisplayed(H):M(b).hide();M(b).clearOpacity();M(b).setPositioning(d.pos);e.width=d.width;e.height=d.height;M(b).afterFx(a)}M(b).fxanim({opacity:{to:0.3}},P,P,0.1,P,function(){M(b).clearOpacity();(function(){M(b).fxanim({height:{to:1},points:{by:[0,M(b).getHeight()*0.5]}},a,Y,0.3,"easeIn",g)}).defer(100)})});return c},highlight:function(e,a){a=D(a);var c=this,b=c.dom,h=a.attr||"backgroundColor",g={},d;c.queueFx(a,function(){M(b).clearOpacity();M(b).show();function i(){b.style[h]=d;M(b).afterFx(a)}d=b.style[h];g[h]={from:e||"ffff9c",to:a.endColor||M(b).getColor(h)||"ffffff"};arguments.callee.anim=M(b).fxanim(g,a,"color",1,"easeIn",i)});return c},frame:function(h,d,a){a=D(a);var e=this,b=e.dom,g,c;e.queueFx(a,function(){h=h||"#C3DAF9";if(h.length==6){h="#"+h}d=d||1;M(b).show();var l=M(b).getXY(),i={x:l[0],y:l[1],0:l[0],1:l[1],width:b.offsetWidth,height:b.offsetHeight},k=function(){g=M(document.body||document.documentElement).createChild({style:{position:N,"z-index":35000,border:"0px solid "+h}});return g.queueFx({},m)};arguments.callee.anim={isAnimated:true,stop:function(){d=0;g.stopFx()}};function m(){var n=Ext.isBorderBox?2:1;c=g.anim({top:{from:i.y,to:i.y-20},left:{from:i.x,to:i.x-20},borderWidth:{from:0,to:10},opacity:{from:1,to:0},height:{from:i.height,to:i.height+20*n},width:{from:i.width,to:i.width+20*n}},{duration:a.duration||1,callback:function(){g.remove();--d>0?k():M(b).afterFx(a)}});arguments.callee.anim={isAnimated:true,stop:function(){c.stop()}}}k()});return e},pause:function(a){var b=this.dom,c;this.queueFx({},function(){c=setTimeout(function(){M(b).afterFx({})},a*1000);arguments.callee.anim={isAnimated:true,stop:function(){clearTimeout(c);M(b).afterFx({})}}});return this},fadeIn:function(b){b=D(b);var d=this,c=d.dom,a=b.endOpacity||1;d.queueFx(b,function(){M(c).setOpacity(0);M(c).fixDisplay();c.style.visibility=G;arguments.callee.anim=M(c).fxanim({opacity:{to:a}},b,P,0.5,J,function(){if(a==1){M(c).clearOpacity()}M(c).afterFx(b)})});return d},fadeOut:function(b){b=D(b);var d=this,c=d.dom,e=c.style,a=b.endOpacity||0;d.queueFx(b,function(){arguments.callee.anim=M(c).fxanim({opacity:{to:a}},b,P,0.5,J,function(){if(a==0){Ext.Element.data(c,"visibilityMode")==Ext.Element.DISPLAY||b.useDisplay?e.display="none":e.visibility=E;M(c).clearOpacity()}M(c).afterFx(b)})});return d},scale:function(c,b,a){this.shift(Ext.apply({},a,{width:c,height:b}));return this},shift:function(a){a=D(a);var b=this.dom,c={};this.queueFx(a,function(){for(var d in a){if(a[d]!=L){c[d]={to:a[d]}}}c.width?c.width.to=M(b).adjustWidth(a.width):c;c.height?c.height.to=M(b).adjustWidth(a.height):c;if(c.x||c.y||c.xy){c.points=c.xy||{to:[c.x?c.x.to:M(b).getX(),c.y?c.y.to:M(b).getY()]}}arguments.callee.anim=M(b).fxanim(c,a,Y,0.35,J,function(){M(b).afterFx(a)})});return this},ghost:function(i,l){l=D(l);var g=this,k=g.dom,c=k.style,e={opacity:{to:0},points:{}},b=e.points,a,d,h;i=i||"b";g.queueFx(l,function(){a=M(k).getFxRestore();d=M(k).getWidth();h=M(k).getHeight();function m(){l.useDisplay?M(k).setDisplayed(H):M(k).hide();M(k).clearOpacity();M(k).setPositioning(a.pos);c.width=a.width;c.height=a.height;M(k).afterFx(l)}b.by=M(k).switchStatements(i.toLowerCase(),function(n,o){return[n,o]},{t:[0,-h],l:[-d,0],r:[d,0],b:[0,h],tl:[-d,-h],bl:[-d,h],br:[d,h],tr:[d,-h]});arguments.callee.anim=M(k).fxanim(e,l,Y,0.5,J,m)});return g},syncFx:function(){var a=this;a.fxDefaults=Ext.apply(a.fxDefaults||{},{block:H,concurrent:T,stopFx:H});return a},sequenceFx:function(){var a=this;a.fxDefaults=Ext.apply(a.fxDefaults||{},{block:H,concurrent:H,stopFx:H});return a},nextFx:function(){var a=aa(this.dom.id)[0];if(a){a.call(this)}},hasActiveFx:function(){return aa(this.dom.id)[0]},stopFx:function(d){var c=this,a=c.dom.id;if(c.hasActiveFx()){var b=aa(a)[0];if(b&&b.anim){if(b.anim.isAnimated){ab(a,[b]);b.anim.stop(d!==undefined?d:T)
}else{ab(a,[])}}}return c},beforeFx:function(a){if(this.hasActiveFx()&&!a.concurrent){if(a.stopFx){this.stopFx();return T}return H}return T},hasFxBlock:function(){var a=aa(this.dom.id);return a&&a[0]&&a[0].block},queueFx:function(a,d){var c=M(this.dom);if(!c.hasFxBlock()){Ext.applyIf(a,c.fxDefaults);if(!a.concurrent){var b=c.beforeFx(a);d.block=a.block;aa(c.dom.id).push(d);if(b){c.nextFx()}}else{d.call(c)}}return c},fxWrap:function(a,c,e){var d=this.dom,g,h;if(!c.wrap||!(g=Ext.getDom(c.wrap))){if(c.fixPosition){h=M(d).getXY()}var b=document.createElement("div");b.style.visibility=e;g=d.parentNode.insertBefore(b,d);M(g).setPositioning(a);if(M(g).isStyle(O,"static")){M(g).position("relative")}M(d).clearPositioning("auto");M(g).clip();g.appendChild(d);if(h){M(g).setXY(h)}}return g},fxUnwrap:function(d,a,b){var c=this.dom;M(c).clearPositioning();M(c).setPositioning(a);if(!b.wrap){var e=M(d).dom.parentNode;e.insertBefore(c,d);M(d).remove()}},getFxRestore:function(){var a=this.dom.style;return{pos:this.getPositioning(),width:a.width,height:a.height}},afterFx:function(b){var c=this.dom,a=c.id;if(b.afterStyle){M(c).setStyle(b.afterStyle)}if(b.afterCls){M(c).addClass(b.afterCls)}if(b.remove==T){M(c).remove()}if(b.callback){b.callback.call(b.scope,M(c))}if(!b.concurrent){aa(a).shift();M(c).nextFx()}},fxanim:function(d,c,g,b,e,h){g=g||"run";c=c||{};var a=Ext.lib.Anim[g](this.dom,d,(c.duration||b)||0.35,(c.easing||e)||J,h,this);c.anim=a;return a}};Ext.Fx.resize=Ext.Fx.scale;Ext.Element.addMethods(Ext.Fx)})();Ext.CompositeElementLite=function(c,d){this.elements=[];this.add(c,d);this.el=new Ext.Element.Flyweight()};Ext.CompositeElementLite.prototype={isComposite:true,getElement:function(d){var c=this.el;c.dom=d;c.id=d.id;return c},transformElement:function(b){return Ext.getDom(b)},getCount:function(){return this.elements.length},add:function(m,h){var l=this,k=l.elements;if(!m){return this}if(typeof m=="string"){m=Ext.Element.selectorFunction(m,h)}else{if(m.isComposite){m=m.elements}else{if(!Ext.isIterable(m)){m=[m]}}}for(var n=0,i=m.length;n<i;++n){k.push(l.transformElement(m[n]))}return l},invoke:function(n,e){var m=this,o=m.elements,i=o.length,l,p;for(p=0;p<i;p++){l=o[p];if(l){Ext.Element.prototype[n].apply(m.getElement(l),e)}}return m},item:function(e){var h=this,i=h.elements[e],g=null;if(i){g=h.getElement(i)}return g},addListener:function(e,n,o,p){var q=this.elements,m=q.length,s,i;for(s=0;s<m;s++){i=q[s];if(i){Ext.EventManager.on(i,e,n,o||i,p)}}return this},each:function(n,o){var m=this,p=m.elements,i=p.length,e,l;for(e=0;e<i;e++){l=p[e];if(l){l=this.getElement(l);if(n.call(o||l,l,m,e)===false){break}}}return m},fill:function(d){var c=this;c.elements=[];c.add(d);return c},filter:function(g){var e=[],h=this,i=Ext.isFunction(g)?g:function(a){return a.is(g)};h.each(function(a,c,b){if(i(a,b)!==false){e[e.length]=h.transformElement(a)}});h.elements=e;return h},indexOf:function(b){return this.elements.indexOf(this.transformElement(b))},replaceElement:function(k,l,h){var d=!isNaN(k)?k:this.indexOf(k),i;if(d>-1){l=Ext.getDom(l);if(h){i=this.elements[d];i.parentNode.insertBefore(l,i);Ext.removeNode(i)}this.elements.splice(d,1,l)}return this},clear:function(){this.elements=[]}};Ext.CompositeElementLite.prototype.on=Ext.CompositeElementLite.prototype.addListener;Ext.CompositeElementLite.importElementMethods=function(){var g,d=Ext.Element.prototype,e=Ext.CompositeElementLite.prototype;for(g in d){if(typeof d[g]=="function"){(function(a){e[a]=e[a]||function(){return this.invoke(a,arguments)}}).call(e,g)}}};Ext.CompositeElementLite.importElementMethods();if(Ext.DomQuery){Ext.Element.selectorFunction=Ext.DomQuery.select}Ext.Element.select=function(e,d){var g;if(typeof e=="string"){g=Ext.Element.selectorFunction(e,d)}else{if(e.length!==undefined){g=e}else{throw"Invalid selector"}}return new Ext.CompositeElementLite(g)};Ext.select=Ext.Element.select;(function(){var k="beforerequest",p="requestcomplete",q="requestexception",n=undefined,s="load",m="POST",l="GET",o=window;
Ext.data.Connection=function(a){Ext.apply(this,a);this.addEvents(k,p,q);Ext.data.Connection.superclass.constructor.call(this)};Ext.extend(Ext.data.Connection,Ext.util.Observable,{timeout:30000,autoAbort:false,disableCaching:true,disableCachingParam:"_dc",request:function(a){var h=this;if(h.fireEvent(k,h,a)){if(a.el){if(!Ext.isEmpty(a.indicatorText)){h.indicatorText='<div class="loading-indicator">'+a.indicatorText+"</div>"}if(h.indicatorText){Ext.getDom(a.el).innerHTML=h.indicatorText}a.success=(Ext.isFunction(a.success)?a.success:function(){}).createInterceptor(function(t){Ext.getDom(a.el).innerHTML=t.responseText})}var c=a.params,d=a.url||h.url,e,w={success:h.handleResponse,failure:h.handleFailure,scope:h,argument:{options:a},timeout:Ext.num(a.timeout,h.timeout)},b,g;if(Ext.isFunction(c)){c=c.call(a.scope||o,a)}c=Ext.urlEncode(h.extraParams,Ext.isObject(c)?Ext.urlEncode(c):c);if(Ext.isFunction(d)){d=d.call(a.scope||o,a)}if((b=Ext.getDom(a.form))){d=d||b.action;if(a.isUpload||(/multipart\/form-data/i.test(b.getAttribute("enctype")))){return h.doFormUpload.call(h,a,c,d)}g=Ext.lib.Ajax.serializeForm(b);c=c?(c+"&"+g):g}e=a.method||h.method||((c||a.xmlData||a.jsonData)?m:l);if(e===l&&(h.disableCaching&&a.disableCaching!==false)||a.disableCaching===true){var i=a.disableCachingParam||h.disableCachingParam;d=Ext.urlAppend(d,i+"="+(new Date().getTime()))}a.headers=Ext.apply(a.headers||{},h.defaultHeaders||{});if(a.autoAbort===true||h.autoAbort){h.abort()}if((e==l||a.xmlData||a.jsonData)&&c){d=Ext.urlAppend(d,c);c=""}return(h.transId=Ext.lib.Ajax.request(e,d,w,c,a))}else{return a.callback?a.callback.apply(a.scope,[a,n,n]):null}},isLoading:function(a){return a?Ext.lib.Ajax.isCallInProgress(a):!!this.transId},abort:function(a){if(a||this.isLoading()){Ext.lib.Ajax.abort(a||this.transId)}},handleResponse:function(b){this.transId=false;var a=b.argument.options;b.argument=a?a.argument:null;this.fireEvent(p,this,b,a);if(a.success){a.success.call(a.scope,b,a)}if(a.callback){a.callback.call(a.scope,a,true,b)}},handleFailure:function(c,a){this.transId=false;var b=c.argument.options;c.argument=b?b.argument:null;this.fireEvent(q,this,c,b,a);if(b.failure){b.failure.call(b.scope,c,b)}if(b.callback){b.callback.call(b.scope,b,false,c)}},doFormUpload:function(B,g,e){var d=Ext.id(),h=document,A=h.createElement("iframe"),c=Ext.getDom(B.form),i=[],y,a="multipart/form-data",b={target:c.target,method:c.method,encoding:c.encoding,enctype:c.enctype,action:c.action};Ext.fly(A).set({id:d,name:d,cls:"x-hidden",src:Ext.SSL_SECURE_URL});h.body.appendChild(A);if(Ext.isIE){document.frames[d].name=d}Ext.fly(c).set({target:d,method:m,enctype:a,encoding:a,action:e||b.action});Ext.iterate(Ext.urlDecode(g,false),function(u,t){y=h.createElement("input");Ext.fly(y).set({type:"hidden",value:t,name:u});c.appendChild(y);i.push(y)});function z(){var w=this,D={responseText:"",responseXML:null,argument:B.argument},v,x;try{v=A.contentWindow.document||A.contentDocument||o.frames[d].document;if(v){if(v.body){if(/textarea/i.test((x=v.body.firstChild||{}).tagName)){D.responseText=x.value}else{D.responseText=v.body.innerHTML}}D.responseXML=v.XMLDocument||v}}catch(t){}Ext.EventManager.removeListener(A,s,z,w);w.fireEvent(p,w,D,B);function u(C,G,H){if(Ext.isFunction(C)){C.apply(G,H)}}u(B.success,B.scope,[D,B]);u(B.callback,B.scope,[B,true,D]);if(!w.debugUploads){setTimeout(function(){Ext.removeNode(A)},100)}}Ext.EventManager.on(A,s,z,this);c.submit();Ext.fly(c).set(b);Ext.each(i,function(t){Ext.removeNode(t)})}})})();Ext.Ajax=new Ext.data.Connection({autoAbort:false,serializeForm:function(b){return Ext.lib.Ajax.serializeForm(b)}});Ext.util.JSON=new (function(){var useHasOwn=!!{}.hasOwnProperty,isNative=function(){var useNative=null;return function(){if(useNative===null){useNative=Ext.USE_NATIVE_JSON&&window.JSON&&JSON.toString()=="[object JSON]"}return useNative}}(),pad=function(n){return n<10?"0"+n:n},doDecode=function(json){return eval("("+json+")")},doEncode=function(o){if(!Ext.isDefined(o)||o===null){return"null"
}else{if(Ext.isArray(o)){return encodeArray(o)}else{if(Ext.isDate(o)){return Ext.util.JSON.encodeDate(o)}else{if(Ext.isString(o)){return encodeString(o)}else{if(typeof o=="number"){return isFinite(o)?String(o):"null"}else{if(Ext.isBoolean(o)){return String(o)}else{var a=["{"],b,i,v;for(i in o){if(!o.getElementsByTagName){if(!useHasOwn||o.hasOwnProperty(i)){v=o[i];switch(typeof v){case"undefined":case"function":case"unknown":break;default:if(b){a.push(",")}a.push(doEncode(i),":",v===null?"null":doEncode(v));b=true}}}}a.push("}");return a.join("")}}}}}}},m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},encodeString=function(s){if(/["\\\x00-\x1f]/.test(s)){return'"'+s.replace(/([\x00-\x1f\\"])/g,function(a,b){var c=m[b];if(c){return c}c=b.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"'}return'"'+s+'"'},encodeArray=function(o){var a=["["],b,i,l=o.length,v;for(i=0;i<l;i+=1){v=o[i];switch(typeof v){case"undefined":case"function":case"unknown":break;default:if(b){a.push(",")}a.push(v===null?"null":Ext.util.JSON.encode(v));b=true}}a.push("]");return a.join("")};this.encodeDate=function(o){return'"'+o.getFullYear()+"-"+pad(o.getMonth()+1)+"-"+pad(o.getDate())+"T"+pad(o.getHours())+":"+pad(o.getMinutes())+":"+pad(o.getSeconds())+'"'};this.encode=function(){var ec;return function(o){if(!ec){ec=isNative()?JSON.stringify:doEncode}return ec(o)}}();this.decode=function(){var dc;return function(json){if(!dc){dc=isNative()?JSON.parse:doDecode}return dc(json)}}()})();Ext.encode=Ext.util.JSON.encode;Ext.decode=Ext.util.JSON.decode;Ext.EventManager=function(){var O,P,W=false,U=Ext.isGecko||Ext.isWebKit||Ext.isSafari,R=Ext.lib.Event,M=Ext.lib.Dom,ac=document,N=window,L="DOMContentLoaded",I="complete",Z=/^(?:scope|delay|buffer|single|stopEvent|preventDefault|stopPropagation|normalized|args|delegate)$/,H=[];function S(d){var a=false,e=0,g=H.length,c=false,b;if(d){if(d.getElementById||d.navigator){for(;e<g;++e){b=H[e];if(b.el===d){a=b.id;break}}if(!a){a=Ext.id(d);H.push({id:a,el:d});c=true}}else{a=Ext.id(d)}if(!Ext.elCache[a]){Ext.Element.addToCache(new Ext.Element(d),a);if(c){Ext.elCache[a].skipGC=true}}}return a}function T(k,h,d,i,l,b){k=Ext.getDom(k);var a=S(k),c=Ext.elCache[a].events,g;g=R.on(k,h,l);c[h]=c[h]||[];c[h].push([d,l,b,g,i]);if(k.addEventListener&&h=="mousewheel"){var e=["DOMMouseScroll",l,false];k.addEventListener.apply(k,e);Ext.EventManager.addListener(N,"unload",function(){k.removeEventListener.apply(k,e)})}if(k==ac&&h=="mousedown"){Ext.EventManager.stoppedMouseDownEvent.addListener(l)}}function ab(){if(window!=top){return false}try{ac.documentElement.doScroll("left")}catch(a){return false}ad();return true}function K(a){if(Ext.isIE&&ab()){return true}if(ac.readyState==I){ad();return true}W||(P=setTimeout(arguments.callee,2));return false}var V;function X(a){V||(V=Ext.query("style, link[rel=stylesheet]"));if(V.length==ac.styleSheets.length){ad();return true}W||(P=setTimeout(arguments.callee,2));return false}function Q(a){ac.removeEventListener(L,arguments.callee,false);X()}function ad(a){if(!W){W=true;if(P){clearTimeout(P)}if(U){ac.removeEventListener(L,ad,false)}if(Ext.isIE&&K.bindIE){ac.detachEvent("onreadystatechange",K)}R.un(N,"load",arguments.callee)}if(O&&!Ext.isReady){Ext.isReady=true;O.fire();O.listeners=[]}}function ae(){O||(O=new Ext.util.Event());if(U){ac.addEventListener(L,ad,false)}if(Ext.isIE){if(!K()){K.bindIE=true;ac.attachEvent("onreadystatechange",K)}}else{if(Ext.isOpera){(ac.readyState==I&&X())||ac.addEventListener(L,Q,false)}else{if(Ext.isWebKit){K()}}}R.on(N,"load",ad)}function D(b,a){return function(){var c=Ext.toArray(arguments);if(a.target==Ext.EventObject.setEvent(c[0]).target){b.apply(this,c)}}}function E(b,a,c){return function(d){c.delay(a.buffer,b,null,[new Ext.EventObjectImpl(d)])}}function J(a,b,e,c,d){return function(g){Ext.EventManager.removeListener(b,e,c,d);a(g)}}function aa(b,a,c){return function(d){var e=new Ext.util.DelayedTask(b);if(!c.tasks){c.tasks=[]
}c.tasks.push(e);e.delay(a.delay||10,b,null,[new Ext.EventObjectImpl(d)])}}function Y(e,g,a,c,b){var k=(!a||typeof a=="boolean")?{}:a,i=Ext.getDom(e),h;c=c||k.fn;b=b||k.scope;if(!i){throw'Error listening for "'+g+'". Element "'+e+"\" doesn't exist."}function d(l){if(!Ext){return}l=Ext.EventObject.setEvent(l);var m;if(k.delegate){if(!(m=l.getTarget(k.delegate,i))){return}}else{m=l.target}if(k.stopEvent){l.stopEvent()}if(k.preventDefault){l.preventDefault()}if(k.stopPropagation){l.stopPropagation()}if(k.normalized===false){l=l.browserEvent}c.call(b||i,l,m,k)}if(k.target){d=D(d,k)}if(k.delay){d=aa(d,k,c)}if(k.single){d=J(d,i,g,c,b)}if(k.buffer){h=new Ext.util.DelayedTask(d);d=E(d,k,h)}T(i,g,c,h,d,b);return d}var G={addListener:function(g,i,d,e,h){if(typeof i=="object"){var a=i,c,b;for(c in a){b=a[c];if(!Z.test(c)){if(Ext.isFunction(b)){Y(g,c,a,b,a.scope)}else{Y(g,c,b)}}}}else{Y(g,i,h,d,e)}},removeListener:function(m,h,c,b){m=Ext.getDom(m);var a=S(m),e=m&&(Ext.elCache[a].events)[h]||[],n,i,l,k,g,d;for(i=0,g=e.length;i<g;i++){if(Ext.isArray(d=e[i])&&d[0]==c&&(!b||d[2]==b)){if(d[4]){d[4].cancel()}k=c.tasks&&c.tasks.length;if(k){while(k--){c.tasks[k].cancel()}delete c.tasks}n=d[1];R.un(m,h,R.extAdapter?d[3]:n);if(n&&m.addEventListener&&h=="mousewheel"){m.removeEventListener("DOMMouseScroll",n,false)}if(n&&m==ac&&h=="mousedown"){Ext.EventManager.stoppedMouseDownEvent.removeListener(n)}e.splice(i,1);if(e.length===0){delete Ext.elCache[a].events[h]}for(k in Ext.elCache[a].events){return false}Ext.elCache[a].events={};return false}}},removeAll:function(l){l=Ext.getDom(l);var m=S(l),e=Ext.elCache[m]||{},b=e.events||{},g,h,d,k,c,i,a;for(k in b){if(b.hasOwnProperty(k)){g=b[k];for(h=0,d=g.length;h<d;h++){c=g[h];if(c[4]){c[4].cancel()}if(c[0].tasks&&(i=c[0].tasks.length)){while(i--){c[0].tasks[i].cancel()}delete c.tasks}a=c[1];R.un(l,k,R.extAdapter?c[3]:a);if(l.addEventListener&&a&&k=="mousewheel"){l.removeEventListener("DOMMouseScroll",a,false)}if(a&&l==ac&&k=="mousedown"){Ext.EventManager.stoppedMouseDownEvent.removeListener(a)}}}}if(Ext.elCache[m]){Ext.elCache[m].events={}}},getListeners:function(c,g){c=Ext.getDom(c);var a=S(c),e=Ext.elCache[a]||{},b=e.events||{},d=[];if(b&&b[g]){return b[g]}else{return null}},purgeElement:function(i,a,g){i=Ext.getDom(i);var k=S(i),c=Ext.elCache[k]||{},b=c.events||{},h,d,e;if(g){if(b&&b.hasOwnProperty(g)){d=b[g];for(h=0,e=d.length;h<e;h++){Ext.EventManager.removeListener(i,g,d[h][0])}}}else{Ext.EventManager.removeAll(i)}if(a&&i&&i.childNodes){for(h=0,e=i.childNodes.length;h<e;h++){Ext.EventManager.purgeElement(i.childNodes[h],a,g)}}},_unload:function(){var e;for(e in Ext.elCache){Ext.EventManager.removeAll(e)}delete Ext.elCache;delete Ext.Element._flyweights;var a,d,b,c=Ext.lib.Ajax;(typeof c.conn=="object")?d=c.conn:d={};for(b in d){a=d[b];if(a){c.abort({conn:a,tId:b})}}},onDocumentReady:function(a,b,c){if(Ext.isReady){O||(O=new Ext.util.Event());O.addListener(a,b,c);O.fire();O.listeners=[]}else{if(!O){ae()}c=c||{};c.delay=c.delay||1;O.addListener(a,b,c)}},fireDocReady:ad};G.on=G.addListener;G.un=G.removeListener;G.stoppedMouseDownEvent=new Ext.util.Event();return G}();Ext.onReady=Ext.EventManager.onDocumentReady;(function(){var b=function(){var g=document.body||document.getElementsByTagName("body")[0];if(!g){return false}var a=[" ",Ext.isIE?"ext-ie "+(Ext.isIE6?"ext-ie6":(Ext.isIE7?"ext-ie7":"ext-ie8")):Ext.isGecko?"ext-gecko "+(Ext.isGecko2?"ext-gecko2":"ext-gecko3"):Ext.isOpera?"ext-opera":Ext.isWebKit?"ext-webkit":""];if(Ext.isSafari){a.push("ext-safari "+(Ext.isSafari2?"ext-safari2":(Ext.isSafari3?"ext-safari3":"ext-safari4")))}else{if(Ext.isChrome){a.push("ext-chrome")}}if(Ext.isMac){a.push("ext-mac")}if(Ext.isLinux){a.push("ext-linux")}if(Ext.isStrict||Ext.isBorderBox){var e=g.parentNode;if(e){Ext.fly(e,"_internal").addClass(((Ext.isStrict&&Ext.isIE)||(!Ext.enableForcedBoxModel&&!Ext.isIE))?" ext-strict":" ext-border-box")}}if(Ext.enableForcedBoxModel&&!Ext.isIE){Ext.isForcedBorderBox=true;a.push("ext-forced-border-box")
}Ext.fly(g,"_internal").addClass(a);return true};Ext.isReady=b();if(!Ext.isReady){Ext.onReady(b)}})();(function(){var c=Ext.apply(Ext.supports,{correctRightMargin:true,correctTransparentColor:true,cssFloat:true});var d=function(){var a=document.createElement("div"),b=document,i,h;a.innerHTML='<div style="height:30px;width:50px;"><div style="height:20px;width:20px;"></div></div><div style="float:left;background-color:transparent;">';b.body.appendChild(a);h=a.lastChild;if((i=b.defaultView)){if(i.getComputedStyle(a.firstChild.firstChild,null).marginRight!="0px"){c.correctRightMargin=false}if(i.getComputedStyle(h,null).backgroundColor!="transparent"){c.correctTransparentColor=false}}c.cssFloat=!!h.style.cssFloat;b.body.removeChild(a)};if(Ext.isReady){d()}else{Ext.onReady(d)}})();Ext.EventObject=function(){var e=Ext.lib.Event,i=/(dbl)?click/,g={3:13,63234:37,63235:39,63232:38,63233:40,63276:33,63277:34,63272:46,63273:36,63275:35},h=Ext.isIE?{1:0,4:1,2:2}:{0:0,1:1,2:2};Ext.EventObjectImpl=function(a){if(a){this.setEvent(a.browserEvent||a)}};Ext.EventObjectImpl.prototype={setEvent:function(a){var b=this;if(a==b||(a&&a.browserEvent)){return a}b.browserEvent=a;if(a){b.button=a.button?h[a.button]:(a.which?a.which-1:-1);if(i.test(a.type)&&b.button==-1){b.button=0}b.type=a.type;b.shiftKey=a.shiftKey;b.ctrlKey=a.ctrlKey||a.metaKey||false;b.altKey=a.altKey;b.keyCode=a.keyCode;b.charCode=a.charCode;b.target=e.getTarget(a);b.xy=e.getXY(a)}else{b.button=-1;b.shiftKey=false;b.ctrlKey=false;b.altKey=false;b.keyCode=0;b.charCode=0;b.target=null;b.xy=[0,0]}return b},stopEvent:function(){var a=this;if(a.browserEvent){if(a.browserEvent.type=="mousedown"){Ext.EventManager.stoppedMouseDownEvent.fire(a)}e.stopEvent(a.browserEvent)}},preventDefault:function(){if(this.browserEvent){e.preventDefault(this.browserEvent)}},stopPropagation:function(){var a=this;if(a.browserEvent){if(a.browserEvent.type=="mousedown"){Ext.EventManager.stoppedMouseDownEvent.fire(a)}e.stopPropagation(a.browserEvent)}},getCharCode:function(){return this.charCode||this.keyCode},getKey:function(){return this.normalizeKey(this.keyCode||this.charCode)},normalizeKey:function(a){return Ext.isSafari?(g[a]||a):a},getPageX:function(){return this.xy[0]},getPageY:function(){return this.xy[1]},getXY:function(){return this.xy},getTarget:function(b,a,c){return b?Ext.fly(this.target).findParent(b,a,c):(c?Ext.get(this.target):this.target)},getRelatedTarget:function(){return this.browserEvent?e.getRelatedTarget(this.browserEvent):null},getWheelDelta:function(){var b=this.browserEvent;var a=0;if(b.wheelDelta){a=b.wheelDelta/120}else{if(b.detail){a=-b.detail/3}}return a},within:function(b,a,d){if(b){var c=this[a?"getRelatedTarget":"getTarget"]();return c&&((d?(c==Ext.getDom(b)):false)||Ext.fly(b).contains(c))}return false}};return new Ext.EventObjectImpl()}();Ext.ns("Ext.grid","Ext.list","Ext.dd","Ext.tree","Ext.form","Ext.menu","Ext.state","Ext.layout","Ext.app","Ext.ux","Ext.chart","Ext.direct");Ext.apply(Ext,function(){var g=Ext,e=0,d=null;return{emptyFn:function(){},BLANK_IMAGE_URL:Ext.isIE6||Ext.isIE7||Ext.isAir?"http://www.extjs.com/s.gif":"data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",extendX:function(b,a){return Ext.extend(b,a(b.prototype))},getDoc:function(){return Ext.get(document)},num:function(a,b){a=Number(Ext.isEmpty(a)||Ext.isArray(a)||typeof a=="boolean"||(typeof a=="string"&&a.trim().length==0)?NaN:a);return isNaN(a)?b:a},value:function(a,c,b){return Ext.isEmpty(a,b)?c:a},escapeRe:function(a){return a.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")},sequence:function(a,i,b,c){a[i]=a[i].createSequence(b,c)},addBehaviors:function(a){if(!Ext.isReady){Ext.onReady(function(){Ext.addBehaviors(a)})}else{var k={},b,l,c;for(l in a){if((b=l.split("@"))[1]){c=b[0];if(!k[c]){k[c]=Ext.select(c)}k[c].on(b[1],a[l])}}k=null}},getScrollBarWidth:function(c){if(!Ext.isReady){return 0}if(c===true||d===null){var a=Ext.getBody().createChild('<div class="x-hide-offsets" style="width:100px;height:50px;overflow:hidden;"><div style="height:200px;"></div></div>'),b=a.child("div",true);
var k=b.offsetWidth;a.setStyle("overflow",(Ext.isWebKit||Ext.isGecko)?"auto":"scroll");var l=b.offsetWidth;a.remove();d=k-l+2}return d},combine:function(){var c=arguments,i=c.length,a=[];for(var b=0;b<i;b++){var l=c[b];if(Ext.isArray(l)){a=a.concat(l)}else{if(l.length!==undefined&&!l.substr){a=a.concat(Array.prototype.slice.call(l,0))}else{a.push(l)}}}return a},copyTo:function(c,b,a){if(typeof a=="string"){a=a.split(/[,;\s]/)}Ext.each(a,function(i){if(b.hasOwnProperty(i)){c[i]=b[i]}},this);return c},destroy:function(){Ext.each(arguments,function(a){if(a){if(Ext.isArray(a)){this.destroy.apply(this,a)}else{if(typeof a.destroy=="function"){a.destroy()}else{if(a.dom){a.remove()}}}}},this)},destroyMembers:function(a,c,n,i){for(var b=1,o=arguments,p=o.length;b<p;b++){Ext.destroy(a[o[b]]);delete a[o[b]]}},clean:function(b){var a=[];Ext.each(b,function(c){if(!!c){a.push(c)}});return a},unique:function(c){var b=[],a={};Ext.each(c,function(i){if(!a[i]){b.push(i)}a[i]=true});return b},flatten:function(c){var a=[];function b(i){Ext.each(i,function(h){if(Ext.isArray(h)){b(h)}else{a.push(h)}});return a}return b(c)},min:function(c,b){var a=c[0];b=b||function(k,l){return k<l?-1:1};Ext.each(c,function(i){a=b(a,i)==-1?a:i});return a},max:function(c,b){var a=c[0];b=b||function(k,l){return k>l?1:-1};Ext.each(c,function(i){a=b(a,i)==1?a:i});return a},mean:function(a){return a.length>0?Ext.sum(a)/a.length:undefined},sum:function(b){var a=0;Ext.each(b,function(c){a+=c});return a},partition:function(c,b){var a=[[],[]];Ext.each(c,function(m,i,n){a[(b&&b(m,i,n))||(!b&&m)?0:1].push(m)});return a},invoke:function(i,c){var a=[],b=Array.prototype.slice.call(arguments,2);Ext.each(i,function(m,h){if(m&&typeof m[c]=="function"){a.push(m[c].apply(m,b))}else{a.push(undefined)}});return a},pluck:function(c,a){var b=[];Ext.each(c,function(i){b.push(i[a])});return b},zip:function(){var s=Ext.partition(arguments,function(h){return typeof h!="function"}),c=s[0],a=s[1][0],q=Ext.max(Ext.pluck(c,"length")),i=[];for(var b=0;b<q;b++){i[b]=[];if(a){i[b]=a.apply(a,Ext.pluck(c,b))}else{for(var o=0,p=c.length;o<p;o++){i[b].push(c[o][b])}}}return i},getCmp:function(a){return Ext.ComponentMgr.get(a)},useShims:g.isIE6||(g.isMac&&g.isGecko2),type:function(a){if(a===undefined||a===null){return false}if(a.htmlElement){return"element"}var b=typeof a;if(b=="object"&&a.nodeName){switch(a.nodeType){case 1:return"element";case 3:return(/\S/).test(a.nodeValue)?"textnode":"whitespace"}}if(b=="object"||b=="function"){switch(a.constructor){case Array:return"array";case RegExp:return"regexp";case Date:return"date"}if(typeof a.length=="number"&&typeof a.item=="function"){return"nodelist"}}return b},intercept:function(a,i,b,c){a[i]=a[i].createInterceptor(b,c)},callback:function(i,a,b,c){if(typeof i=="function"){if(c){i.defer(c,a,b||[])}else{i.apply(a,b||[])}}}}}());Ext.apply(Function.prototype,{createSequence:function(d,e){var g=this;return(typeof d!="function")?this:function(){var a=g.apply(this||window,arguments);d.apply(e||this||window,arguments);return a}}});Ext.applyIf(String,{escape:function(b){return b.replace(/('|\\)/g,"\\$1")},leftPad:function(h,e,i){var g=String(h);if(!i){i=" "}while(g.length<e){g=i+g}return g}});String.prototype.toggle=function(c,d){return this==c?d:c};String.prototype.trim=function(){var b=/^\s+|\s+$/g;return function(){return this.replace(b,"")}}();Date.prototype.getElapsed=function(b){return Math.abs((b||new Date()).getTime()-this.getTime())};Ext.applyIf(Number.prototype,{constrain:function(c,d){return Math.min(Math.max(this,c),d)}});Ext.lib.Dom.getRegion=function(b){return Ext.lib.Region.getRegion(b)};Ext.lib.Region=function(k,h,b,l){var i=this;i.top=k;i[1]=k;i.right=h;i.bottom=b;i.left=l;i[0]=l};Ext.lib.Region.prototype={contains:function(c){var d=this;return(c.left>=d.left&&c.right<=d.right&&c.top>=d.top&&c.bottom<=d.bottom)},getArea:function(){var b=this;return((b.bottom-b.top)*(b.right-b.left))},intersect:function(i){var k=this,m=Math.max(k.top,i.top),l=Math.min(k.right,i.right),b=Math.min(k.bottom,i.bottom),n=Math.max(k.left,i.left);
if(b>=m&&l>=n){return new Ext.lib.Region(m,l,b,n)}},union:function(i){var k=this,m=Math.min(k.top,i.top),l=Math.max(k.right,i.right),b=Math.max(k.bottom,i.bottom),n=Math.min(k.left,i.left);return new Ext.lib.Region(m,l,b,n)},constrainTo:function(c){var d=this;d.top=d.top.constrain(c.top,c.bottom);d.bottom=d.bottom.constrain(c.top,c.bottom);d.left=d.left.constrain(c.left,c.right);d.right=d.right.constrain(c.left,c.right);return d},adjust:function(k,l,b,h){var i=this;i.top+=k;i.left+=l;i.right+=h;i.bottom+=b;return i}};Ext.lib.Region.getRegion=function(l){var i=Ext.lib.Dom.getXY(l),m=i[1],k=i[0]+l.offsetWidth,b=i[1]+l.offsetHeight,n=i[0];return new Ext.lib.Region(m,k,b,n)};Ext.lib.Point=function(e,g){if(Ext.isArray(e)){g=e[1];e=e[0]}var d=this;d.x=d.right=d.left=d[0]=e;d.y=d.top=d.bottom=d[1]=g};Ext.lib.Point.prototype=new Ext.lib.Region();Ext.apply(Ext.DomHelper,function(){var p,l="afterbegin",n="afterend",m="beforebegin",q="beforeend",k=/tag|children|cn|html$/i;function o(h,e,g,d,a,c){h=Ext.getDom(h);var b;if(p.useDom){b=s(e,null);if(c){h.appendChild(b)}else{(a=="firstChild"?h:h.parentNode).insertBefore(b,h[a]||h)}}else{b=Ext.DomHelper.insertHtml(d,h,Ext.DomHelper.createHtml(e))}return g?Ext.get(b,true):b}function s(e,x){var d,g=document,a,i,c,h;if(Ext.isArray(e)){d=g.createDocumentFragment();for(var y=0,b=e.length;y<b;y++){s(e[y],d)}}else{if(typeof e=="string"){d=g.createTextNode(e)}else{d=g.createElement(e.tag||"div");a=!!d.setAttribute;for(var i in e){if(!k.test(i)){c=e[i];if(i=="cls"){d.className=c}else{if(a){d.setAttribute(i,c)}else{d[i]=c}}}}Ext.DomHelper.applyStyles(d,e.style);if((h=e.children||e.cn)){s(h,d)}else{if(e.html){d.innerHTML=e.html}}}}if(x){x.appendChild(d)}return d}p={createTemplate:function(a){var b=Ext.DomHelper.createHtml(a);return new Ext.Template(b)},useDom:false,insertBefore:function(c,a,b){return o(c,a,b,m)},insertAfter:function(c,a,b){return o(c,a,b,n,"nextSibling")},insertFirst:function(c,a,b){return o(c,a,b,l,"firstChild")},append:function(c,a,b){return o(c,a,b,q,"",true)},createDom:s};return p}());Ext.apply(Ext.Template.prototype,{disableFormats:false,re:/\{([\w-]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?\}/g,argsRe:/^\s*['"](.*)["']\s*$/,compileARe:/\\/g,compileBRe:/(\r\n|\n)/g,compileCRe:/'/g,applyTemplate:function(h){var k=this,i=k.disableFormats!==true,l=Ext.util.Format,n=k;if(k.compiled){return k.compiled(h)}function m(b,s,d,a){if(d&&i){if(d.substr(0,5)=="this."){return n.call(d.substr(5),h[s],h)}else{if(a){var e=k.argsRe;a=a.split(",");for(var g=0,c=a.length;g<c;g++){a[g]=a[g].replace(e,"$1")}a=[h[s]].concat(a)}else{a=[h[s]]}return l[d].apply(l,a)}}else{return h[s]!==undefined?h[s]:""}}return k.html.replace(k.re,m)},compile:function(){var me=this,fm=Ext.util.Format,useF=me.disableFormats!==true,sep=Ext.isGecko?"+":",",body;function fn(m,name,format,args){if(format&&useF){args=args?","+args:"";if(format.substr(0,5)!="this."){format="fm."+format+"("}else{format='this.call("'+format.substr(5)+'", ';args=", values"}}else{args="";format="(values['"+name+"'] == undefined ? '' : "}return"'"+sep+format+"values['"+name+"']"+args+")"+sep+"'"}if(Ext.isGecko){body="this.compiled = function(values){ return '"+me.html.replace(me.compileARe,"\\\\").replace(me.compileBRe,"\\n").replace(me.compileCRe,"\\'").replace(me.re,fn)+"';};"}else{body=["this.compiled = function(values){ return ['"];body.push(me.html.replace(me.compileARe,"\\\\").replace(me.compileBRe,"\\n").replace(me.compileCRe,"\\'").replace(me.re,fn));body.push("'].join('');};");body=body.join("")}eval(body);return me},call:function(g,d,e){return this[g](d,e)}});Ext.Template.prototype.apply=Ext.Template.prototype.applyTemplate;Ext.util.Functions={createInterceptor:function(i,e,g){var h=i;if(!Ext.isFunction(e)){return i}else{return function(){var a=this,b=arguments;e.target=a;e.method=i;return(e.apply(g||a||window,b)!==false)?i.apply(a||window,b):null}}},createDelegate:function(i,h,e,g){if(!Ext.isFunction(i)){return i}return function(){var a=e||arguments;if(g===true){a=Array.prototype.slice.call(arguments,0);
a=a.concat(e)}else{if(Ext.isNumber(g)){a=Array.prototype.slice.call(arguments,0);var b=[g,0].concat(e);Array.prototype.splice.apply(a,b)}}return i.apply(h||window,a)}},defer:function(k,l,i,g,h){k=Ext.util.Functions.createDelegate(k,i,g,h);if(l>0){return setTimeout(k,l)}k();return 0},createSequence:function(g,d,e){if(!Ext.isFunction(d)){return g}else{return function(){var a=g.apply(this||window,arguments);d.apply(e||this||window,arguments);return a}}}};Ext.defer=Ext.util.Functions.defer;Ext.createInterceptor=Ext.util.Functions.createInterceptor;Ext.createSequence=Ext.util.Functions.createSequence;Ext.createDelegate=Ext.util.Functions.createDelegate;Ext.apply(Ext.util.Observable.prototype,function(){function b(e){var l=(this.methodEvents=this.methodEvents||{})[e],o,p,n,m=this;if(!l){this.methodEvents[e]=l={};l.originalFn=this[e];l.methodName=e;l.before=[];l.after=[];var a=function(c,d,g){if((p=c.apply(d||m,g))!==undefined){if(typeof p=="object"){if(p.returnValue!==undefined){o=p.returnValue}else{o=p}n=!!p.cancel}else{if(p===false){n=true}else{o=p}}}};this[e]=function(){var c=Array.prototype.slice.call(arguments,0),d;o=p=undefined;n=false;for(var h=0,g=l.before.length;h<g;h++){d=l.before[h];a(d.fn,d.scope,c);if(n){return o}}if((p=l.originalFn.apply(m,c))!==undefined){o=p}for(var h=0,g=l.after.length;h<g;h++){d=l.after[h];a(d.fn,d.scope,c);if(n){return o}}return o}}return l}return{beforeMethod:function(e,g,a){b.call(this,e).before.push({fn:g,scope:a})},afterMethod:function(e,g,a){b.call(this,e).after.push({fn:g,scope:a})},removeMethodListener:function(e,l,m){var i=this.getMethodEvent(e);for(var n=0,a=i.before.length;n<a;n++){if(i.before[n].fn==l&&i.before[n].scope==m){i.before.splice(n,1);return}}for(var n=0,a=i.after.length;n<a;n++){if(i.after[n].fn==l&&i.after[n].scope==m){i.after.splice(n,1);return}}},relayEvents:function(i,n){var l=this;function m(c){return function(){return l.fireEvent.apply(l,[c].concat(Array.prototype.slice.call(arguments,0)))}}for(var o=0,a=n.length;o<a;o++){var p=n[o];l.events[p]=l.events[p]||true;i.on(p,m(p),l)}},enableBubble:function(l){var k=this;if(!Ext.isEmpty(l)){l=Ext.isArray(l)?l:Array.prototype.slice.call(arguments,0);for(var m=0,a=l.length;m<a;m++){var n=l[m];n=n.toLowerCase();var i=k.events[n]||true;if(typeof i=="boolean"){i=new Ext.util.Event(k,n);k.events[n]=i}i.bubble=true}}}}}());Ext.util.Observable.capture=function(g,d,e){g.fireEvent=g.fireEvent.createInterceptor(d,e)};Ext.util.Observable.observeClass=function(c,d){if(c){if(!c.fireEvent){Ext.apply(c,new Ext.util.Observable());Ext.util.Observable.capture(c.prototype,c.fireEvent,c)}if(typeof d=="object"){c.on(d)}return c}};Ext.apply(Ext.EventManager,function(){var s,l,p,t,u=Ext.lib.Dom,m=/^(?:scope|delay|buffer|single|stopEvent|preventDefault|stopPropagation|normalized|args|delegate)$/,n=0,o=0,q=Ext.isWebKit?Ext.num(navigator.userAgent.match(/AppleWebKit\/(\d+)/)[1])>=525:!((Ext.isGecko&&!Ext.isWindows)||Ext.isOpera);return{doResizeEvent:function(){var a=u.getViewHeight(),b=u.getViewWidth();if(o!=a||n!=b){s.fire(n=b,o=a)}},onWindowResize:function(c,a,b){if(!s){s=new Ext.util.Event();l=new Ext.util.DelayedTask(this.doResizeEvent);Ext.EventManager.on(window,"resize",this.fireWindowResize,this)}s.addListener(c,a,b)},fireWindowResize:function(){if(s){l.delay(100)}},onTextResize:function(c,d,b){if(!p){p=new Ext.util.Event();var a=new Ext.Element(document.createElement("div"));a.dom.className="x-text-resize";a.dom.innerHTML="X";a.appendTo(document.body);t=a.dom.offsetHeight;setInterval(function(){if(a.dom.offsetHeight!=t){p.fire(t,t=a.dom.offsetHeight)}},this.textResizeInterval)}p.addListener(c,d,b)},removeResizeListener:function(a,b){if(s){s.removeListener(a,b)}},fireResize:function(){if(s){s.fire(u.getViewWidth(),u.getViewHeight())}},textResizeInterval:50,ieDeferSrc:false,getKeyEvent:function(){return q?"keydown":"keypress"},useKeydown:q}}());Ext.EventManager.on=Ext.EventManager.addListener;Ext.apply(Ext.EventObjectImpl.prototype,{BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,RETURN:13,SHIFT:16,CTRL:17,CONTROL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGEUP:33,PAGE_DOWN:34,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,isNavKeyPress:function(){var c=this,d=this.normalizeKey(c.keyCode);
return(d>=33&&d<=40)||d==c.RETURN||d==c.TAB||d==c.ESC},isSpecialKey:function(){var b=this.normalizeKey(this.keyCode);return(this.type=="keypress"&&this.ctrlKey)||this.isNavKeyPress()||(b==this.BACKSPACE)||(b>=16&&b<=20)||(b>=44&&b<=46)},getPoint:function(){return new Ext.lib.Point(this.xy[0],this.xy[1])},hasModifier:function(){return((this.ctrlKey||this.altKey)||this.shiftKey)}});Ext.Element.addMethods({swallowEvent:function(g,e){var h=this;function i(a){a.stopPropagation();if(e){a.preventDefault()}}if(Ext.isArray(g)){Ext.each(g,function(a){h.on(a,i)});return h}h.on(g,i);return h},relayEvent:function(d,c){this.on(d,function(a){c.fireEvent(d,a)})},clean:function(h){var m=this,l=m.dom,k=l.firstChild,n=-1;if(Ext.Element.data(l,"isCleaned")&&h!==true){return m}while(k){var i=k.nextSibling;if(k.nodeType==3&&!(/\S/.test(k.nodeValue))){l.removeChild(k)}else{k.nodeIndex=++n}k=i}Ext.Element.data(l,"isCleaned",true);return m},load:function(){var b=this.getUpdater();b.update.apply(b,arguments);return this},getUpdater:function(){return this.updateManager||(this.updateManager=new Ext.Updater(this))},update:function(html,loadScripts,callback){if(!this.dom){return this}html=html||"";if(loadScripts!==true){this.dom.innerHTML=html;if(typeof callback=="function"){callback()}return this}var id=Ext.id(),dom=this.dom;html+='<span id="'+id+'"></span>';Ext.lib.Event.onAvailable(id,function(){var DOC=document,hd=DOC.getElementsByTagName("head")[0],re=/(?:<script([^>]*)?>)((\n|\r|.)*?)(?:<\/script>)/ig,srcRe=/\ssrc=([\'\"])(.*?)\1/i,typeRe=/\stype=([\'\"])(.*?)\1/i,match,attrs,srcMatch,typeMatch,el,s;while((match=re.exec(html))){attrs=match[1];srcMatch=attrs?attrs.match(srcRe):false;if(srcMatch&&srcMatch[2]){s=DOC.createElement("script");s.src=srcMatch[2];typeMatch=attrs.match(typeRe);if(typeMatch&&typeMatch[2]){s.type=typeMatch[2]}hd.appendChild(s)}else{if(match[2]&&match[2].length>0){if(window.execScript){window.execScript(match[2])}else{window.eval(match[2])}}}}el=DOC.getElementById(id);if(el){Ext.removeNode(el)}if(typeof callback=="function"){callback()}});dom.innerHTML=html.replace(/(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)/ig,"");return this},removeAllListeners:function(){this.removeAnchor();Ext.EventManager.removeAll(this.dom);return this},createProxy:function(h,i,k){h=(typeof h=="object")?h:{tag:"div",cls:h};var l=this,g=i?Ext.DomHelper.append(i,h,true):Ext.DomHelper.insertBefore(l.dom,h,true);if(k&&l.setBox&&l.getBox){g.setBox(l.getBox())}return g}});Ext.Element.prototype.getUpdateManager=Ext.Element.prototype.getUpdater;Ext.Element.addMethods({getAnchorXY:function(z,u,E){z=(z||"tl").toLowerCase();E=E||{};var v=this,C=v.dom==document.body||v.dom==document,o=E.width||C?Ext.lib.Dom.getViewWidth():v.getWidth(),x=E.height||C?Ext.lib.Dom.getViewHeight():v.getHeight(),h,D=Math.round,B=v.getXY(),s=v.getScroll(),w=C?s.left:!u?B[0]:0,y=C?s.top:!u?B[1]:0,A={c:[D(o*0.5),D(x*0.5)],t:[D(o*0.5),0],l:[0,D(x*0.5)],r:[o,D(x*0.5)],b:[D(o*0.5),x],tl:[0,0],bl:[0,x],br:[o,x],tr:[o,0]};h=A[z];return[h[0]+w,h[1]+y]},anchorTo:function(x,s,w,y,o,n){var q=this,u=q.dom,p=!Ext.isEmpty(o),v=function(){Ext.fly(u).alignTo(x,s,w,y);Ext.callback(n,Ext.fly(u))},t=this.getAnchor();this.removeAnchor();Ext.apply(t,{fn:v,scroll:p});Ext.EventManager.onWindowResize(v,null);if(p){Ext.EventManager.on(window,"scroll",v,null,{buffer:!isNaN(o)?o:50})}v.call(q);return q},removeAnchor:function(){var c=this,d=this.getAnchor();if(d&&d.fn){Ext.EventManager.removeResizeListener(d.fn);if(d.scroll){Ext.EventManager.un(window,"scroll",d.fn)}delete d.fn}return c},getAnchor:function(){var d=Ext.Element.data,g=this.dom;if(!g){return}var e=d(g,"_anchor");if(!e){e=d(g,"_anchor",{})}return e},getAlignToXY:function(af,Y,X){af=Ext.get(af);if(!af||!af.dom){throw"Element.alignToXY with an element that doesn't exist"}X=X||[0,0];Y=(!Y||Y=="?"?"tl-bl?":(!(/-/).test(Y)&&Y!==""?"tl-"+Y:Y||"tl-bl")).toLowerCase();var m=this,x=m.dom,d,h,Z,ab,U,Q,p,S=Ext.lib.Dom.getViewWidth()-10,y=Ext.lib.Dom.getViewHeight()-10,ah,ae,ad,ac,P,aa,c=document,o=c.documentElement,W=c.body,R=(o.scrollLeft||W.scrollLeft||0)+5,T=(o.scrollTop||W.scrollTop||0)+5,w=false,ag="",ai="",V=Y.match(/^([a-z]+)-([a-z]+)(\?)?$/);
if(!V){throw"Element.alignTo with an invalid alignment "+Y}ag=V[1];ai=V[2];w=!!V[3];d=m.getAnchorXY(ag,true);h=af.getAnchorXY(ai,false);Z=h[0]-d[0]+X[0];ab=h[1]-d[1]+X[1];if(w){U=m.getWidth();Q=m.getHeight();p=af.getRegion();ah=ag.charAt(0);ae=ag.charAt(ag.length-1);ad=ai.charAt(0);ac=ai.charAt(ai.length-1);P=((ah=="t"&&ad=="b")||(ah=="b"&&ad=="t"));aa=((ae=="r"&&ac=="l")||(ae=="l"&&ac=="r"));if(Z+U>S+R){Z=aa?p.left-U:S+R-U}if(Z<R){Z=aa?p.right:R}if(ab+Q>y+T){ab=P?p.top-Q:y+T-Q}if(ab<T){ab=P?p.bottom:T}}return[Z,ab]},alignTo:function(l,h,i,g){var k=this;return k.setXY(k.getAlignToXY(l,h,i),k.preanim&&!!g?k.preanim(arguments,3):false)},adjustForConstraints:function(g,e,d){return this.getConstrainToXY(e||document,false,d,g)||g},getConstrainToXY:function(g,h,l,i){var k={top:0,left:0,bottom:0,right:0};return function(O,x,L,J){O=Ext.get(O);L=L?Ext.applyIf(L,k):k;var y,c,H=0,a=0;if(O.dom==document.body||O.dom==document){y=Ext.lib.Dom.getViewWidth();c=Ext.lib.Dom.getViewHeight()}else{y=O.dom.clientWidth;c=O.dom.clientHeight;if(!x){var b=O.getXY();H=b[0];a=b[1]}}var d=O.getScroll();H+=L.left+d.left;a+=L.top+d.top;y-=L.right;c-=L.bottom;var w=H+y,P=a+c,N=J||(!x?this.getXY():[this.getLeft(true),this.getTop(true)]),G=N[0],I=N[1],M=this.getConstrainOffset(),s=this.dom.offsetWidth+M,e=this.dom.offsetHeight+M;var K=false;if((G+s)>w){G=w-s;K=true}if((I+e)>P){I=P-e;K=true}if(G<H){G=H;K=true}if(I<a){I=a;K=true}return K?[G,I]:false}}(),getConstrainOffset:function(){return 0},getCenterXY:function(){return this.getAlignToXY(document,"c-c")},center:function(b){return this.alignTo(b||document,"c-c")}});Ext.Element.addMethods({select:function(d,c){return Ext.Element.select(d,c,this.dom)}});Ext.apply(Ext.Element.prototype,function(){var g=Ext.getDom,e=Ext.get,d=Ext.DomHelper;return{insertSibling:function(c,n,m){var b=this,o,p=(n||"before").toLowerCase()=="after",a;if(Ext.isArray(c)){a=b;Ext.each(c,function(h){o=Ext.fly(a,"_internal").insertSibling(h,n,m);if(p){a=o}});return o}c=c||{};if(c.nodeType||c.dom){o=b.dom.parentNode.insertBefore(g(c),p?b.dom.nextSibling:b.dom);if(!m){o=e(o)}}else{if(p&&!b.dom.nextSibling){o=d.append(b.dom.parentNode,c,!m)}else{o=d[p?"insertAfter":"insertBefore"](b.dom,c,!m)}}return o}}}());Ext.Element.boxMarkup='<div class="{0}-tl"><div class="{0}-tr"><div class="{0}-tc"></div></div></div><div class="{0}-ml"><div class="{0}-mr"><div class="{0}-mc"></div></div></div><div class="{0}-bl"><div class="{0}-br"><div class="{0}-bc"></div></div></div>';Ext.Element.addMethods(function(){var d="_internal",c=/(\d+\.?\d+)px/;return{applyStyles:function(a){Ext.DomHelper.applyStyles(this.dom,a);return this},getStyles:function(){var a={};Ext.each(arguments,function(b){a[b]=this.getStyle(b)},this);return a},setOverflow:function(b){var a=this.dom;if(b=="auto"&&Ext.isMac&&Ext.isGecko2){a.style.overflow="hidden";(function(){a.style.overflow="auto"}).defer(1)}else{a.style.overflow=b}},boxWrap:function(b){b=b||"x-box";var a=Ext.get(this.insertHtml("beforeBegin","<div class='"+b+"'>"+String.format(Ext.Element.boxMarkup,b)+"</div>"));Ext.DomQuery.selectNode("."+b+"-mc",a.dom).appendChild(this.dom);return a},setSize:function(b,i,h){var a=this;if(typeof b=="object"){i=b.height;b=b.width}b=a.adjustWidth(b);i=a.adjustHeight(i);if(!h||!a.anim){a.dom.style.width=a.addUnits(b);a.dom.style.height=a.addUnits(i)}else{a.anim({width:{to:b},height:{to:i}},a.preanim(arguments,2))}return a},getComputedHeight:function(){var a=this,b=Math.max(a.dom.offsetHeight,a.dom.clientHeight);if(!b){b=parseFloat(a.getStyle("height"))||0;if(!a.isBorderBox()){b+=a.getFrameWidth("tb")}}return b},getComputedWidth:function(){var a=Math.max(this.dom.offsetWidth,this.dom.clientWidth);if(!a){a=parseFloat(this.getStyle("width"))||0;if(!this.isBorderBox()){a+=this.getFrameWidth("lr")}}return a},getFrameWidth:function(a,b){return b&&this.isBorderBox()?0:(this.getPadding(a)+this.getBorderWidth(a))},addClassOnOver:function(a){this.hover(function(){Ext.fly(this,d).addClass(a)},function(){Ext.fly(this,d).removeClass(a)
});return this},addClassOnFocus:function(a){this.on("focus",function(){Ext.fly(this,d).addClass(a)},this.dom);this.on("blur",function(){Ext.fly(this,d).removeClass(a)},this.dom);return this},addClassOnClick:function(b){var a=this.dom;this.on("mousedown",function(){Ext.fly(a,d).addClass(b);var h=Ext.getDoc(),i=function(){Ext.fly(a,d).removeClass(b);h.removeListener("mouseup",i)};h.on("mouseup",i)});return this},getViewSize:function(){var b=document,a=this.dom,k=(a==b||a==b.body);if(k){var i=Ext.lib.Dom;return{width:i.getViewWidth(),height:i.getViewHeight()}}else{return{width:a.clientWidth,height:a.clientHeight}}},getStyleSize:function(){var h=this,t,o,a=document,s=this.dom,q=(s==a||s==a.body),p=s.style;if(q){var b=Ext.lib.Dom;return{width:b.getViewWidth(),height:b.getViewHeight()}}if(p.width&&p.width!="auto"){t=parseFloat(p.width);if(h.isBorderBox()){t-=h.getFrameWidth("lr")}}if(p.height&&p.height!="auto"){o=parseFloat(p.height);if(h.isBorderBox()){o-=h.getFrameWidth("tb")}}return{width:t||h.getWidth(true),height:o||h.getHeight(true)}},getSize:function(a){return{width:this.getWidth(a),height:this.getHeight(a)}},repaint:function(){var a=this.dom;this.addClass("x-repaint");setTimeout(function(){Ext.fly(a).removeClass("x-repaint")},1);return this},unselectable:function(){this.dom.unselectable="on";return this.swallowEvent("selectstart",true).applyStyles("-moz-user-select:none;-khtml-user-select:none;").addClass("x-unselectable")},getMargins:function(k){var i=this,l,b={t:"top",l:"left",r:"right",b:"bottom"},a={};if(!k){for(l in i.margins){a[b[l]]=parseFloat(i.getStyle(i.margins[l]))||0}return a}else{return i.addStyles.call(i,k,i.margins)}}}}());Ext.Element.addMethods({setBox:function(l,k,h){var m=this,i=l.width,n=l.height;if((k&&!m.autoBoxAdjust)&&!m.isBorderBox()){i-=(m.getBorderWidth("lr")+m.getPadding("lr"));n-=(m.getBorderWidth("tb")+m.getPadding("tb"))}m.setBounds(l.x,l.y,i,n,m.animTest.call(m,arguments,h,2));return m},getBox:function(y,b){var t=this,F,B,h,C=t.getBorderWidth,I=t.getPadding,A,E,G,l;if(!b){F=t.getXY()}else{B=parseInt(t.getStyle("left"),10)||0;h=parseInt(t.getStyle("top"),10)||0;F=[B,h]}var D=t.dom,H=D.offsetWidth,z=D.offsetHeight,w;if(!y){w={x:F[0],y:F[1],0:F[0],1:F[1],width:H,height:z}}else{A=C.call(t,"l")+I.call(t,"l");E=C.call(t,"r")+I.call(t,"r");G=C.call(t,"t")+I.call(t,"t");l=C.call(t,"b")+I.call(t,"b");w={x:F[0]+A,y:F[1]+G,0:F[0]+A,1:F[1]+G,width:H-(A+E),height:z-(G+l)}}w.right=w.x+w.width;w.bottom=w.y+w.height;return w},move:function(s,z,y){var v=this,o=v.getXY(),q=o[0],t=o[1],x=[q-z,t],p=[q+z,t],u=[q,t-z],A=[q,t+z],w={l:x,left:x,r:p,right:p,t:u,top:u,up:u,b:A,bottom:A,down:A};s=s.toLowerCase();v.moveTo(w[s][0],w[s][1],v.animTest.call(v,arguments,y,2))},setLeftTop:function(h,i){var e=this,g=e.dom.style;g.left=e.addUnits(h);g.top=e.addUnits(i);return e},getRegion:function(){return Ext.lib.Dom.getRegion(this.dom)},setBounds:function(h,k,m,i,n){var l=this;if(!n||!l.anim){l.setSize(m,i);l.setLocation(h,k)}else{l.anim({points:{to:[h,k]},width:{to:l.adjustWidth(m)},height:{to:l.adjustHeight(i)}},l.preanim(arguments,4),"motion")}return l},setRegion:function(c,d){return this.setBounds(c.left,c.top,c.right-c.left,c.bottom-c.top,this.animTest.call(this,arguments,d,1))}});Ext.Element.addMethods({scrollTo:function(i,o,k){var n=/top/i.test(i),p=this,m=p.dom,l;if(!k||!p.anim){l="scroll"+(n?"Top":"Left");m[l]=o}else{l="scroll"+(n?"Left":"Top");p.anim({scroll:{to:n?[m[l],o]:[o,m[l]]}},p.preanim(arguments,2),"scroll")}return p},scrollIntoView:function(z,w){var b=Ext.getDom(z)||Ext.getBody().dom,x=this.dom,y=this.getOffsetsTo(b),o=y[0]+b.scrollLeft,C=y[1]+b.scrollTop,E=C+x.offsetHeight,A=o+x.offsetWidth,B=b.clientHeight,l=parseInt(b.scrollTop,10),D=parseInt(b.scrollLeft,10),t=l+B,c=D+b.clientWidth;if(x.offsetHeight>B||C<l){b.scrollTop=C}else{if(E>t){b.scrollTop=E-B}}b.scrollTop=b.scrollTop;if(w!==false){if(x.offsetWidth>b.clientWidth||o<D){b.scrollLeft=o}else{if(A>c){b.scrollLeft=A-b.clientWidth}}b.scrollLeft=b.scrollLeft}return this
},scrollChildIntoView:function(c,d){Ext.fly(c,"_scrollChildIntoView").scrollIntoView(this,d)},scroll:function(t,B,z){if(!this.isScrollable()){return false}var y=this.dom,x=y.scrollLeft,h=y.scrollTop,s=y.scrollWidth,u=y.scrollHeight,w=y.clientWidth,C=y.clientHeight,A=false,l,v={l:Math.min(x+B,s-w),r:l=Math.max(x-B,0),t:Math.max(h-B,0),b:Math.min(h+B,u-C)};v.d=v.b;v.u=v.t;t=t.substr(0,1);if((l=v[t])>-1){A=true;this.scrollTo(t=="l"||t=="r"?"left":"top",l,this.preanim(arguments,2))}return A}});Ext.Element.addMethods(function(){var o="visibility",i="display",k="hidden",l="none",p="x-masked",m="x-masked-relative",n=Ext.Element.data;return{isVisible:function(c){var b=!this.isStyle(o,k)&&!this.isStyle(i,l),a=this.dom.parentNode;if(c!==true||!b){return b}while(a&&!(/^body/i.test(a.tagName))){if(!Ext.fly(a,"_isVisible").isVisible()){return false}a=a.parentNode}return true},isDisplayed:function(){return !this.isStyle(i,l)},enableDisplayMode:function(a){this.setVisibilityMode(Ext.Element.DISPLAY);if(!Ext.isEmpty(a)){n(this.dom,"originalDisplay",a)}return this},mask:function(h,c){var a=this,e=a.dom,b=Ext.DomHelper,d="ext-el-mask-msg",t,u;if(!(/^body/i.test(e.tagName)&&a.getStyle("position")=="static")){a.addClass(m)}if(t=n(e,"maskMsg")){t.remove()}if(t=n(e,"mask")){t.remove()}u=b.append(e,{cls:"ext-el-mask"},true);n(e,"mask",u);a.addClass(p);u.setDisplayed(true);if(typeof h=="string"){var g=b.append(e,{cls:d,cn:{tag:"div"}},true);n(e,"maskMsg",g);g.dom.className=c?d+" "+c:d;g.dom.firstChild.innerHTML=h;g.setDisplayed(true);g.center(a)}if(Ext.isIE&&!(Ext.isIE7&&Ext.isStrict)&&a.getStyle("height")=="auto"){u.setSize(undefined,a.getHeight())}return u},unmask:function(){var b=this,a=b.dom,d=n(a,"mask"),c=n(a,"maskMsg");if(d){if(c){c.remove();n(a,"maskMsg",undefined)}d.remove();n(a,"mask",undefined);b.removeClass([p,m])}},isMasked:function(){var a=n(this.dom,"mask");return a&&a.isVisible()},createShim:function(){var b=document.createElement("iframe"),a;b.frameBorder="0";b.className="ext-shim";b.src=Ext.SSL_SECURE_URL;a=Ext.get(this.dom.parentNode.insertBefore(b,this.dom));a.autoBoxAdjust=false;return a}}}());Ext.Element.addMethods({addKeyListener:function(e,h,i){var g;if(typeof e!="object"||Ext.isArray(e)){g={key:e,fn:h,scope:i}}else{g={key:e.key,shift:e.shift,ctrl:e.ctrl,alt:e.alt,fn:h,scope:i}}return new Ext.KeyMap(this,g)},addKeyMap:function(b){return new Ext.KeyMap(this,b)}});Ext.CompositeElementLite.importElementMethods();Ext.apply(Ext.CompositeElementLite.prototype,{addElements:function(g,e){if(!g){return this}if(typeof g=="string"){g=Ext.Element.selectorFunction(g,e)}var d=this.elements;Ext.each(g,function(a){d.push(Ext.get(a))});return this},first:function(){return this.item(0)},last:function(){return this.item(this.getCount()-1)},contains:function(b){return this.indexOf(b)!=-1},removeElement:function(k,i){var l=this,h=this.elements,g;Ext.each(k,function(a){if((g=(h[a]||h[a=l.indexOf(a)]))){if(i){if(g.dom){g.remove()}else{Ext.removeNode(g)}}h.splice(a,1)}});return this}});Ext.CompositeElement=Ext.extend(Ext.CompositeElementLite,{constructor:function(c,d){this.elements=[];this.add(c,d)},getElement:function(b){return b},transformElement:function(b){return Ext.get(b)}});Ext.Element.select=function(g,h,e){var i;if(typeof g=="string"){i=Ext.Element.selectorFunction(g,e)}else{if(g.length!==undefined){i=g}else{throw"Invalid selector"}}return(h===true)?new Ext.CompositeElement(i):new Ext.CompositeElementLite(i)};Ext.select=Ext.Element.select;Ext.UpdateManager=Ext.Updater=Ext.extend(Ext.util.Observable,function(){var h="beforeupdate",m="update",n="failure";function i(c){var b=this;b.transaction=null;if(c.argument.form&&c.argument.reset){try{c.argument.form.reset()}catch(a){}}if(b.loadScripts){b.renderer.render(b.el,c,b,k.createDelegate(b,[c]))}else{b.renderer.render(b.el,c,b);k.call(b,c)}}function k(c,b,a){this.fireEvent(b||m,this.el,c);if(Ext.isFunction(c.argument.callback)){c.argument.callback.call(c.argument.scope,this.el,Ext.isEmpty(a)?true:false,c,c.argument.options)
}}function l(a){k.call(this,a,n,!!(this.transaction=null))}return{constructor:function(b,c){var a=this;b=Ext.get(b);if(!c&&b.updateManager){return b.updateManager}a.el=b;a.defaultUrl=null;a.addEvents(h,m,n);Ext.apply(a,Ext.Updater.defaults);a.transaction=null;a.refreshDelegate=a.refresh.createDelegate(a);a.updateDelegate=a.update.createDelegate(a);a.formUpdateDelegate=(a.formUpdate||function(){}).createDelegate(a);a.renderer=a.renderer||a.getDefaultRenderer();Ext.Updater.superclass.constructor.call(a)},setRenderer:function(a){this.renderer=a},getRenderer:function(){return this.renderer},getDefaultRenderer:function(){return new Ext.Updater.BasicRenderer()},setDefaultUrl:function(a){this.defaultUrl=a},getEl:function(){return this.el},update:function(d,o,g,a){var b=this,e,c;if(b.fireEvent(h,b.el,d,o)!==false){if(Ext.isObject(d)){e=d;d=e.url;o=o||e.params;g=g||e.callback;a=a||e.discardUrl;c=e.scope;if(!Ext.isEmpty(e.nocache)){b.disableCaching=e.nocache}if(!Ext.isEmpty(e.text)){b.indicatorText='<div class="loading-indicator">'+e.text+"</div>"}if(!Ext.isEmpty(e.scripts)){b.loadScripts=e.scripts}if(!Ext.isEmpty(e.timeout)){b.timeout=e.timeout}}b.showLoading();if(!a){b.defaultUrl=d}if(Ext.isFunction(d)){d=d.call(b)}var s=Ext.apply({},{url:d,params:(Ext.isFunction(o)&&c)?o.createDelegate(c):o,success:i,failure:l,scope:b,callback:undefined,timeout:(b.timeout*1000),disableCaching:b.disableCaching,argument:{options:e,url:d,form:null,callback:g,scope:c||window,params:o}},e);b.transaction=Ext.Ajax.request(s)}},formUpdate:function(b,e,c,a){var d=this;if(d.fireEvent(h,d.el,b,e)!==false){if(Ext.isFunction(e)){e=e.call(d)}b=Ext.getDom(b);d.transaction=Ext.Ajax.request({form:b,url:e,success:i,failure:l,scope:d,timeout:(d.timeout*1000),argument:{url:e,form:b,callback:a,reset:c}});d.showLoading.defer(1,d)}},startAutoRefresh:function(d,c,a,g,e){var b=this;if(e){b.update(c||b.defaultUrl,a,g,true)}if(b.autoRefreshProcId){clearInterval(b.autoRefreshProcId)}b.autoRefreshProcId=setInterval(b.update.createDelegate(b,[c||b.defaultUrl,a,g,true]),d*1000)},stopAutoRefresh:function(){if(this.autoRefreshProcId){clearInterval(this.autoRefreshProcId);delete this.autoRefreshProcId}},isAutoRefreshing:function(){return !!this.autoRefreshProcId},showLoading:function(){if(this.showLoadIndicator){this.el.dom.innerHTML=this.indicatorText}},abort:function(){if(this.transaction){Ext.Ajax.abort(this.transaction)}},isUpdating:function(){return this.transaction?Ext.Ajax.isLoading(this.transaction):false},refresh:function(a){if(this.defaultUrl){this.update(this.defaultUrl,null,a,true)}}}}());Ext.Updater.defaults={timeout:30,disableCaching:false,showLoadIndicator:true,indicatorText:'<div class="loading-indicator">Loading...</div>',loadScripts:false,sslBlankUrl:Ext.SSL_SECURE_URL};Ext.Updater.updateElement=function(k,l,i,g){var h=Ext.get(k).getUpdater();Ext.apply(h,g);h.update(l,i,g?g.callback:null)};Ext.Updater.BasicRenderer=function(){};Ext.Updater.BasicRenderer.prototype={render:function(i,g,e,h){i.update(g.responseText,e.loadScripts,h)}};(function(){Date.useStrict=false;function c(a){var b=Array.prototype.slice.call(arguments,1);return a.replace(/\{(\d+)\}/g,function(i,h){return b[h]})}Date.formatCodeToRegex=function(b,g){var a=Date.parseCodes[b];if(a){a=typeof a=="function"?a():a;Date.parseCodes[b]=a}return a?Ext.applyIf({c:a.c?c(a.c,g||"{0}"):a.c},a):{g:0,c:null,s:Ext.escapeRe(b)}};var d=Date.formatCodeToRegex;Ext.apply(Date,{parseFunctions:{"M$":function(h,i){var b=new RegExp("\\/Date\\(([-+])?(\\d+)(?:[+-]\\d{4})?\\)\\/");var a=(h||"").match(b);return a?new Date(((a[1]||"")+a[2])*1):null}},parseRegexes:[],formatFunctions:{"M$":function(){return"\\/Date("+this.getTime()+")\\/"}},y2kYear:50,MILLI:"ms",SECOND:"s",MINUTE:"mi",HOUR:"h",DAY:"d",MONTH:"mo",YEAR:"y",defaults:{},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNumbers:{Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11},getShortMonthName:function(a){return Date.monthNames[a].substring(0,3)
},getShortDayName:function(a){return Date.dayNames[a].substring(0,3)},getMonthNumber:function(a){return Date.monthNumbers[a.substring(0,1).toUpperCase()+a.substring(1,3).toLowerCase()]},formatCodes:{d:"String.leftPad(this.getDate(), 2, '0')",D:"Date.getShortDayName(this.getDay())",j:"this.getDate()",l:"Date.dayNames[this.getDay()]",N:"(this.getDay() ? this.getDay() : 7)",S:"this.getSuffix()",w:"this.getDay()",z:"this.getDayOfYear()",W:"String.leftPad(this.getWeekOfYear(), 2, '0')",F:"Date.monthNames[this.getMonth()]",m:"String.leftPad(this.getMonth() + 1, 2, '0')",M:"Date.getShortMonthName(this.getMonth())",n:"(this.getMonth() + 1)",t:"this.getDaysInMonth()",L:"(this.isLeapYear() ? 1 : 0)",o:"(this.getFullYear() + (this.getWeekOfYear() == 1 && this.getMonth() > 0 ? +1 : (this.getWeekOfYear() >= 52 && this.getMonth() < 11 ? -1 : 0)))",Y:"String.leftPad(this.getFullYear(), 4, '0')",y:"('' + this.getFullYear()).substring(2, 4)",a:"(this.getHours() < 12 ? 'am' : 'pm')",A:"(this.getHours() < 12 ? 'AM' : 'PM')",g:"((this.getHours() % 12) ? this.getHours() % 12 : 12)",G:"this.getHours()",h:"String.leftPad((this.getHours() % 12) ? this.getHours() % 12 : 12, 2, '0')",H:"String.leftPad(this.getHours(), 2, '0')",i:"String.leftPad(this.getMinutes(), 2, '0')",s:"String.leftPad(this.getSeconds(), 2, '0')",u:"String.leftPad(this.getMilliseconds(), 3, '0')",O:"this.getGMTOffset()",P:"this.getGMTOffset(true)",T:"this.getTimezone()",Z:"(this.getTimezoneOffset() * -60)",c:function(){for(var a="Y-m-dTH:i:sP",e=[],i=0,l=a.length;i<l;++i){var b=a.charAt(i);e.push(b=="T"?"'T'":Date.getFormatCode(b))}return e.join(" + ")},U:"Math.round(this.getTime() / 1000)"},isValid:function(m,t,q,a,h,b,i){a=a||0;h=h||0;b=b||0;i=i||0;var s=new Date(m<100?100:m,t-1,q,a,h,b,i).add(Date.YEAR,m<100?m-100:0);return m==s.getFullYear()&&t==s.getMonth()+1&&q==s.getDate()&&a==s.getHours()&&h==s.getMinutes()&&b==s.getSeconds()&&i==s.getMilliseconds()},parseDate:function(h,a,i){var b=Date.parseFunctions;if(b[a]==null){Date.createParser(a)}return b[a](h,Ext.isDefined(i)?i:Date.useStrict)},getFormatCode:function(a){var b=Date.formatCodes[a];if(b){b=typeof b=="function"?b():b;Date.formatCodes[a]=b}return b||("'"+String.escape(a)+"'")},createFormat:function(a){var b=[],l=false,i="";for(var k=0;k<a.length;++k){i=a.charAt(k);if(!l&&i=="\\"){l=true}else{if(l){l=false;b.push("'"+String.escape(i)+"'")}else{b.push(Date.getFormatCode(i))}}}Date.formatFunctions[a]=new Function("return "+b.join("+"))},createParser:function(){var a=["var dt, y, m, d, h, i, s, ms, o, z, zz, u, v,","def = Date.defaults,","results = String(input).match(Date.parseRegexes[{0}]);","if(results){","{1}","if(u != null){","v = new Date(u * 1000);","}else{","dt = (new Date()).clearTime();","y = Ext.num(y, Ext.num(def.y, dt.getFullYear()));","m = Ext.num(m, Ext.num(def.m - 1, dt.getMonth()));","d = Ext.num(d, Ext.num(def.d, dt.getDate()));","h  = Ext.num(h, Ext.num(def.h, dt.getHours()));","i  = Ext.num(i, Ext.num(def.i, dt.getMinutes()));","s  = Ext.num(s, Ext.num(def.s, dt.getSeconds()));","ms = Ext.num(ms, Ext.num(def.ms, dt.getMilliseconds()));","if(z >= 0 && y >= 0){","v = new Date(y < 100 ? 100 : y, 0, 1, h, i, s, ms).add(Date.YEAR, y < 100 ? y - 100 : 0);","v = !strict? v : (strict === true && (z <= 364 || (v.isLeapYear() && z <= 365))? v.add(Date.DAY, z) : null);","}else if(strict === true && !Date.isValid(y, m + 1, d, h, i, s, ms)){","v = null;","}else{","v = new Date(y < 100 ? 100 : y, m, d, h, i, s, ms).add(Date.YEAR, y < 100 ? y - 100 : 0);","}","}","}","if(v){","if(zz != null){","v = v.add(Date.SECOND, -v.getTimezoneOffset() * 60 - zz);","}else if(o){","v = v.add(Date.MINUTE, -v.getTimezoneOffset() + (sn == '+'? -1 : 1) * (hr * 60 + mn));","}","}","return v;"].join("\n");return function(i){var v=Date.parseRegexes.length,b=1,u=[],p=[],q=false,w="";for(var s=0;s<i.length;++s){w=i.charAt(s);if(!q&&w=="\\"){q=true}else{if(q){q=false;p.push(String.escape(w))}else{var t=d(w,b);b+=t.g;p.push(t.s);if(t.g&&t.c){u.push(t.c)
}}}}Date.parseRegexes[v]=new RegExp("^"+p.join("")+"$","i");Date.parseFunctions[i]=new Function("input","strict",c(a,v,u.join("")))}}(),parseCodes:{d:{g:1,c:"d = parseInt(results[{0}], 10);\n",s:"(\\d{2})"},j:{g:1,c:"d = parseInt(results[{0}], 10);\n",s:"(\\d{1,2})"},D:function(){for(var b=[],a=0;a<7;b.push(Date.getShortDayName(a)),++a){}return{g:0,c:null,s:"(?:"+b.join("|")+")"}},l:function(){return{g:0,c:null,s:"(?:"+Date.dayNames.join("|")+")"}},N:{g:0,c:null,s:"[1-7]"},S:{g:0,c:null,s:"(?:st|nd|rd|th)"},w:{g:0,c:null,s:"[0-6]"},z:{g:1,c:"z = parseInt(results[{0}], 10);\n",s:"(\\d{1,3})"},W:{g:0,c:null,s:"(?:\\d{2})"},F:function(){return{g:1,c:"m = parseInt(Date.getMonthNumber(results[{0}]), 10);\n",s:"("+Date.monthNames.join("|")+")"}},M:function(){for(var b=[],a=0;a<12;b.push(Date.getShortMonthName(a)),++a){}return Ext.applyIf({s:"("+b.join("|")+")"},d("F"))},m:{g:1,c:"m = parseInt(results[{0}], 10) - 1;\n",s:"(\\d{2})"},n:{g:1,c:"m = parseInt(results[{0}], 10) - 1;\n",s:"(\\d{1,2})"},t:{g:0,c:null,s:"(?:\\d{2})"},L:{g:0,c:null,s:"(?:1|0)"},o:function(){return d("Y")},Y:{g:1,c:"y = parseInt(results[{0}], 10);\n",s:"(\\d{4})"},y:{g:1,c:"var ty = parseInt(results[{0}], 10);\ny = ty > Date.y2kYear ? 1900 + ty : 2000 + ty;\n",s:"(\\d{1,2})"},a:{g:1,c:"if (/(am)/i.test(results[{0}])) {\nif (!h || h == 12) { h = 0; }\n} else { if (!h || h < 12) { h = (h || 0) + 12; }}",s:"(am|pm|AM|PM)"},A:{g:1,c:"if (/(am)/i.test(results[{0}])) {\nif (!h || h == 12) { h = 0; }\n} else { if (!h || h < 12) { h = (h || 0) + 12; }}",s:"(AM|PM|am|pm)"},g:function(){return d("G")},G:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(\\d{1,2})"},h:function(){return d("H")},H:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(\\d{2})"},i:{g:1,c:"i = parseInt(results[{0}], 10);\n",s:"(\\d{2})"},s:{g:1,c:"s = parseInt(results[{0}], 10);\n",s:"(\\d{2})"},u:{g:1,c:"ms = results[{0}]; ms = parseInt(ms, 10)/Math.pow(10, ms.length - 3);\n",s:"(\\d+)"},O:{g:1,c:["o = results[{0}];","var sn = o.substring(0,1),","hr = o.substring(1,3)*1 + Math.floor(o.substring(3,5) / 60),","mn = o.substring(3,5) % 60;","o = ((-12 <= (hr*60 + mn)/60) && ((hr*60 + mn)/60 <= 14))? (sn + String.leftPad(hr, 2, '0') + String.leftPad(mn, 2, '0')) : null;\n"].join("\n"),s:"([+-]\\d{4})"},P:{g:1,c:["o = results[{0}];","var sn = o.substring(0,1),","hr = o.substring(1,3)*1 + Math.floor(o.substring(4,6) / 60),","mn = o.substring(4,6) % 60;","o = ((-12 <= (hr*60 + mn)/60) && ((hr*60 + mn)/60 <= 14))? (sn + String.leftPad(hr, 2, '0') + String.leftPad(mn, 2, '0')) : null;\n"].join("\n"),s:"([+-]\\d{2}:\\d{2})"},T:{g:0,c:null,s:"[A-Z]{1,4}"},Z:{g:1,c:"zz = results[{0}] * 1;\nzz = (-43200 <= zz && zz <= 50400)? zz : null;\n",s:"([+-]?\\d{1,5})"},c:function(){var b=[],i=[d("Y",1),d("m",2),d("d",3),d("h",4),d("i",5),d("s",6),{c:"ms = results[7] || '0'; ms = parseInt(ms, 10)/Math.pow(10, ms.length - 3);\n"},{c:["if(results[8]) {","if(results[8] == 'Z'){","zz = 0;","}else if (results[8].indexOf(':') > -1){",d("P",8).c,"}else{",d("O",8).c,"}","}"].join("\n")}];for(var a=0,h=i.length;a<h;++a){b.push(i[a].c)}return{g:1,c:b.join(""),s:[i[0].s,"(?:","-",i[1].s,"(?:","-",i[2].s,"(?:","(?:T| )?",i[3].s,":",i[4].s,"(?::",i[5].s,")?","(?:(?:\\.|,)(\\d+))?","(Z|(?:[-+]\\d{2}(?::)?\\d{2}))?",")?",")?",")?"].join("")}},U:{g:1,c:"u = parseInt(results[{0}], 10);\n",s:"(-?\\d+)"}}})}());Ext.apply(Date.prototype,{dateFormat:function(b){if(Date.formatFunctions[b]==null){Date.createFormat(b)}return Date.formatFunctions[b].call(this)},getTimezone:function(){return this.toString().replace(/^.* (?:\((.*)\)|([A-Z]{1,4})(?:[\-+][0-9]{4})?(?: -?\d+)?)$/,"$1$2").replace(/[^A-Z]/g,"")},getGMTOffset:function(b){return(this.getTimezoneOffset()>0?"-":"+")+String.leftPad(Math.floor(Math.abs(this.getTimezoneOffset())/60),2,"0")+(b?":":"")+String.leftPad(Math.abs(this.getTimezoneOffset()%60),2,"0")},getDayOfYear:function(){var d=0,h=this.clone(),g=this.getMonth(),i;for(i=0,h.setDate(1),h.setMonth(0);i<g;h.setMonth(++i)){d+=h.getDaysInMonth()
}return d+this.getDate()-1},getWeekOfYear:function(){var d=86400000,c=7*d;return function(){var b=Date.UTC(this.getFullYear(),this.getMonth(),this.getDate()+3)/d,g=Math.floor(b/7),a=new Date(g*c).getUTCFullYear();return g-Math.floor(Date.UTC(a,0,7)/c)+1}}(),isLeapYear:function(){var b=this.getFullYear();return !!((b&3)==0&&(b%100||(b%400==0&&b)))},getFirstDayOfMonth:function(){var b=(this.getDay()-(this.getDate()-1))%7;return(b<0)?(b+7):b},getLastDayOfMonth:function(){return this.getLastDateOfMonth().getDay()},getFirstDateOfMonth:function(){return new Date(this.getFullYear(),this.getMonth(),1)},getLastDateOfMonth:function(){return new Date(this.getFullYear(),this.getMonth(),this.getDaysInMonth())},getDaysInMonth:function(){var b=[31,28,31,30,31,30,31,31,30,31,30,31];return function(){var a=this.getMonth();return a==1&&this.isLeapYear()?29:b[a]}}(),getSuffix:function(){switch(this.getDate()){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}},clone:function(){return new Date(this.getTime())},isDST:function(){return new Date(this.getFullYear(),0,1).getTimezoneOffset()!=this.getTimezoneOffset()},clearTime:function(h){if(h){return this.clone().clearTime()}var c=this.getDate();this.setHours(0);this.setMinutes(0);this.setSeconds(0);this.setMilliseconds(0);if(this.getDate()!=c){for(var d=1,i=this.add(Date.HOUR,d);i.getDate()!=c;d++,i=this.add(Date.HOUR,d)){}this.setDate(c);this.setHours(i.getHours())}return this},add:function(d,i){var h=this.clone();if(!d||i===0){return h}switch(d.toLowerCase()){case Date.MILLI:h.setMilliseconds(this.getMilliseconds()+i);break;case Date.SECOND:h.setSeconds(this.getSeconds()+i);break;case Date.MINUTE:h.setMinutes(this.getMinutes()+i);break;case Date.HOUR:h.setHours(this.getHours()+i);break;case Date.DAY:h.setDate(this.getDate()+i);break;case Date.MONTH:var g=this.getDate();if(g>28){g=Math.min(g,this.getFirstDateOfMonth().add("mo",i).getLastDateOfMonth().getDate())}h.setDate(g);h.setMonth(this.getMonth()+i);break;case Date.YEAR:h.setFullYear(this.getFullYear()+i);break}return h},between:function(g,e){var d=this.getTime();return g.getTime()<=d&&d<=e.getTime()}});Date.prototype.format=Date.prototype.dateFormat;if(Ext.isSafari&&(navigator.userAgent.match(/WebKit\/(\d+)/)[1]||NaN)<420){Ext.apply(Date.prototype,{_xMonth:Date.prototype.setMonth,_xDate:Date.prototype.setDate,setMonth:function(g){if(g<=-1){var h=Math.ceil(-g),i=Math.ceil(h/12),e=(h%12)?12-h%12:0;this.setFullYear(this.getFullYear()-i);return this._xMonth(e)}else{return this._xMonth(g)}},setDate:function(b){return this.setTime(this.getTime()-(this.getDate()-b)*86400000)}})}Ext.util.MixedCollection=function(c,d){this.items=[];this.map={};this.keys=[];this.length=0;this.addEvents("clear","add","replace","remove","sort");this.allowFunctions=c===true;if(d){this.getKey=d}Ext.util.MixedCollection.superclass.constructor.call(this)};Ext.extend(Ext.util.MixedCollection,Ext.util.Observable,{allowFunctions:false,add:function(d,g){if(arguments.length==1){g=arguments[0];d=this.getKey(g)}if(typeof d!="undefined"&&d!==null){var e=this.map[d];if(typeof e!="undefined"){return this.replace(d,g)}this.map[d]=g}this.length++;this.items.push(g);this.keys.push(d);this.fireEvent("add",this.length-1,g,d);return g},getKey:function(b){return b.id},replace:function(i,h){if(arguments.length==1){h=arguments[0];i=this.getKey(h)}var g=this.map[i];if(typeof i=="undefined"||i===null||typeof g=="undefined"){return this.add(i,h)}var e=this.indexOfKey(i);this.items[e]=h;this.map[i]=h;this.fireEvent("replace",i,g,h);return h},addAll:function(i){if(arguments.length>1||Ext.isArray(i)){var g=arguments.length>1?arguments:i;for(var k=0,h=g.length;k<h;k++){this.add(g[k])}}else{for(var l in i){if(this.allowFunctions||typeof i[l]!="function"){this.add(l,i[l])}}}},each:function(i,k){var g=[].concat(this.items);for(var l=0,h=g.length;l<h;l++){if(i.call(k||g[l],g[l],l,h)===false){break}}},eachKey:function(h,i){for(var e=0,g=this.keys.length;
e<g;e++){h.call(i||window,this.keys[e],this.items[e],e,g)}},find:function(h,i){for(var e=0,g=this.items.length;e<g;e++){if(h.call(i||window,this.items[e],this.keys[e])){return this.items[e]}}return null},insert:function(e,d,g){if(arguments.length==2){g=arguments[1];d=this.getKey(g)}if(this.containsKey(d)){this.suspendEvents();this.removeKey(d);this.resumeEvents()}if(e>=this.length){return this.add(d,g)}this.length++;this.items.splice(e,0,g);if(typeof d!="undefined"&&d!==null){this.map[d]=g}this.keys.splice(e,0,d);this.fireEvent("add",e,g,d);return g},remove:function(b){return this.removeAt(this.indexOf(b))},removeAt:function(e){if(e<this.length&&e>=0){this.length--;var g=this.items[e];this.items.splice(e,1);var d=this.keys[e];if(typeof d!="undefined"){delete this.map[d]}this.keys.splice(e,1);this.fireEvent("remove",g,d);return g}return false},removeKey:function(b){return this.removeAt(this.indexOfKey(b))},getCount:function(){return this.length},indexOf:function(b){return this.items.indexOf(b)},indexOfKey:function(b){return this.keys.indexOf(b)},item:function(d){var e=this.map[d],g=e!==undefined?e:(typeof d=="number")?this.items[d]:undefined;return typeof g!="function"||this.allowFunctions?g:null},itemAt:function(b){return this.items[b]},key:function(b){return this.map[b]},contains:function(b){return this.indexOf(b)!=-1},containsKey:function(b){return typeof this.map[b]!="undefined"},clear:function(){this.length=0;this.items=[];this.keys=[];this.map={};this.fireEvent("clear")},first:function(){return this.items[0]},last:function(){return this.items[this.length-1]},_sort:function(i,u,n){var s,q,t=String(u).toUpperCase()=="DESC"?-1:1,o=[],c=this.keys,p=this.items;n=n||function(a,b){return a-b};for(s=0,q=p.length;s<q;s++){o[o.length]={key:c[s],value:p[s],index:s}}o.sort(function(a,d){var b=n(a[i],d[i])*t;if(b===0){b=(a.index<d.index?-1:1)}return b});for(s=0,q=o.length;s<q;s++){p[s]=o[s].value;c[s]=o[s].key}this.fireEvent("sort",this)},sort:function(d,c){this._sort("value",d,c)},reorder:function(o){this.suspendEvents();var i=this.items,p=0,m=i.length,k=[],n=[],l;for(l in o){k[o[l]]=i[l]}for(p=0;p<m;p++){if(o[p]==undefined){n.push(i[p])}}for(p=0;p<m;p++){if(k[p]==undefined){k[p]=n.shift()}}this.clear();this.addAll(k);this.resumeEvents();this.fireEvent("sort",this)},keySort:function(d,c){this._sort("key",d,c||function(h,i){var a=String(h).toUpperCase(),b=String(i).toUpperCase();return a>b?1:(a<b?-1:0)})},getRange:function(i,h){var g=this.items;if(g.length<1){return[]}i=i||0;h=Math.min(typeof h=="undefined"?this.length-1:h,this.length-1);var l,k=[];if(i<=h){for(l=i;l<=h;l++){k[k.length]=g[l]}}else{for(l=i;l>=h;l--){k[k.length]=g[l]}}return k},filter:function(i,e,h,g){if(Ext.isEmpty(e,false)){return this.clone()}e=this.createValueMatcher(e,h,g);return this.filterBy(function(a){return a&&e.test(a[i])})},filterBy:function(m,n){var l=new Ext.util.MixedCollection();l.getKey=this.getKey;var i=this.keys,o=this.items;for(var p=0,k=o.length;p<k;p++){if(m.call(n||this,o[p],i[p])){l.add(i[p],o[p])}}return l},findIndex:function(l,g,i,k,h){if(Ext.isEmpty(g,false)){return -1}g=this.createValueMatcher(g,k,h);return this.findIndexBy(function(a){return a&&g.test(a[l])},null,i)},findIndexBy:function(m,n,l){var i=this.keys,o=this.items;for(var p=(l||0),k=o.length;p<k;p++){if(m.call(n||this,o[p],i[p])){return p}}return -1},createValueMatcher:function(l,i,h,g){if(!l.exec){var k=Ext.escapeRe;l=String(l);if(i===true){l=k(l)}else{l="^"+k(l);if(g===true){l+="$"}}l=new RegExp(l,h?"":"i")}return l},clone:function(){var i=new Ext.util.MixedCollection();var g=this.keys,k=this.items;for(var l=0,h=k.length;l<h;l++){i.add(g[l],k[l])}i.getKey=this.getKey;return i}});Ext.util.MixedCollection.prototype.get=Ext.util.MixedCollection.prototype.item;Ext.AbstractManager=Ext.extend(Object,{typeName:"type",constructor:function(b){Ext.apply(this,b||{});this.all=new Ext.util.MixedCollection();this.types={}},get:function(b){return this.all.get(b)},register:function(b){this.all.add(b)
},unregister:function(b){this.all.remove(b)},registerType:function(c,d){this.types[c]=d;d[this.typeName]=c},isRegistered:function(b){return this.types[b]!==undefined},create:function(g,h){var e=g[this.typeName]||g.type||h,i=this.types[e];if(i==undefined){throw new Error(String.format("The '{0}' type has not been registered with this manager",e))}return new i(g)},onAvailable:function(h,i,e){var g=this.all;g.on("add",function(b,a){if(a.id==h){i.call(e||a,a);g.un("add",i,e)}})}});Ext.util.Format=function(){var trimRe=/^\s+|\s+$/g,stripTagsRE=/<\/?[^>]+>/gi,stripScriptsRe=/(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)/ig,nl2brRe=/\r?\n/g;return{ellipsis:function(value,len,word){if(value&&value.length>len){if(word){var vs=value.substr(0,len-2),index=Math.max(vs.lastIndexOf(" "),vs.lastIndexOf("."),vs.lastIndexOf("!"),vs.lastIndexOf("?"));if(index==-1||index<(len-15)){return value.substr(0,len-3)+"..."}else{return vs.substr(0,index)+"..."}}else{return value.substr(0,len-3)+"..."}}return value},undef:function(value){return value!==undefined?value:""},defaultValue:function(value,defaultValue){return value!==undefined&&value!==""?value:defaultValue},htmlEncode:function(value){return !value?value:String(value).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")},htmlDecode:function(value){return !value?value:String(value).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;/g,"&")},trim:function(value){return String(value).replace(trimRe,"")},substr:function(value,start,length){return String(value).substr(start,length)},lowercase:function(value){return String(value).toLowerCase()},uppercase:function(value){return String(value).toUpperCase()},capitalize:function(value){return !value?value:value.charAt(0).toUpperCase()+value.substr(1).toLowerCase()},call:function(value,fn){if(arguments.length>2){var args=Array.prototype.slice.call(arguments,2);args.unshift(value);return eval(fn).apply(window,args)}else{return eval(fn).call(window,value)}},usMoney:function(v){v=(Math.round((v-0)*100))/100;v=(v==Math.floor(v))?v+".00":((v*10==Math.floor(v*10))?v+"0":v);v=String(v);var ps=v.split("."),whole=ps[0],sub=ps[1]?"."+ps[1]:".00",r=/(\d+)(\d{3})/;while(r.test(whole)){whole=whole.replace(r,"$1,$2")}v=whole+sub;if(v.charAt(0)=="-"){return"-$"+v.substr(1)}return"$"+v},date:function(v,format){if(!v){return""}if(!Ext.isDate(v)){v=new Date(Date.parse(v))}return v.dateFormat(format||"m/d/Y")},dateRenderer:function(format){return function(v){return Ext.util.Format.date(v,format)}},stripTags:function(v){return !v?v:String(v).replace(stripTagsRE,"")},stripScripts:function(v){return !v?v:String(v).replace(stripScriptsRe,"")},fileSize:function(size){if(size<1024){return size+" bytes"}else{if(size<1048576){return(Math.round(((size*10)/1024))/10)+" KB"}else{return(Math.round(((size*10)/1048576))/10)+" MB"}}},math:function(){var fns={};return function(v,a){if(!fns[a]){fns[a]=new Function("v","return v "+a+";")}return fns[a](v)}}(),round:function(value,precision){var result=Number(value);if(typeof precision=="number"){precision=Math.pow(10,precision);result=Math.round(value*precision)/precision}return result},number:function(v,format){if(!format){return v}v=Ext.num(v,NaN);if(isNaN(v)){return""}var comma=",",dec=".",i18n=false,neg=v<0;v=Math.abs(v);if(format.substr(format.length-2)=="/i"){format=format.substr(0,format.length-2);i18n=true;comma=".";dec=","}var hasComma=format.indexOf(comma)!=-1,psplit=(i18n?format.replace(/[^\d\,]/g,""):format.replace(/[^\d\.]/g,"")).split(dec);if(1<psplit.length){v=v.toFixed(psplit[1].length)}else{if(2<psplit.length){throw ("NumberFormatException: invalid format, formats should have no more than 1 period: "+format)}else{v=v.toFixed(0)}}var fnum=v.toString();psplit=fnum.split(".");if(hasComma){var cnum=psplit[0],parr=[],j=cnum.length,m=Math.floor(j/3),n=cnum.length%3||3,i;for(i=0;i<j;i+=n){if(i!=0){n=3}parr[parr.length]=cnum.substr(i,n);m-=1}fnum=parr.join(comma);if(psplit[1]){fnum+=dec+psplit[1]
}}else{if(psplit[1]){fnum=psplit[0]+dec+psplit[1]}}return(neg?"-":"")+format.replace(/[\d,?\.?]+/,fnum)},numberRenderer:function(format){return function(v){return Ext.util.Format.number(v,format)}},plural:function(v,s,p){return v+" "+(v==1?s:(p?p:s+"s"))},nl2br:function(v){return Ext.isEmpty(v)?"":v.replace(nl2brRe,"<br/>")}}}();Ext.XTemplate=function(){Ext.XTemplate.superclass.constructor.apply(this,arguments);var K=this,P=K.html,G=/<tpl\b[^>]*>((?:(?=([^<]+))\2|<(?!tpl\b[^>]*>))*?)<\/tpl>/,T=/^<tpl\b[^>]*?for="(.*?)"/,s=/^<tpl\b[^>]*?if="(.*?)"/,i=/^<tpl\b[^>]*?exec="(.*?)"/,F,J=0,O=[],L="values",m="parent",N="xindex",M="xcount",S="return ",U="with(values){ ";P=["<tpl>",P,"</tpl>"].join("");while((F=P.match(G))){var V=F[0].match(T),W=F[0].match(s),H=F[0].match(i),R=null,Q=null,E=null,I=V&&V[1]?V[1]:"";if(W){R=W&&W[1]?W[1]:null;if(R){Q=new Function(L,m,N,M,U+S+(Ext.util.Format.htmlDecode(R))+"; }")}}if(H){R=H&&H[1]?H[1]:null;if(R){E=new Function(L,m,N,M,U+(Ext.util.Format.htmlDecode(R))+"; }")}}if(I){switch(I){case".":I=new Function(L,m,U+S+L+"; }");break;case"..":I=new Function(L,m,U+S+m+"; }");break;default:I=new Function(L,m,U+S+I+"; }")}}O.push({id:J,target:I,exec:E,test:Q,body:F[1]||""});P=P.replace(F[0],"{xtpl"+J+"}");++J}for(var D=O.length-1;D>=0;--D){K.compileTpl(O[D])}K.master=O[O.length-1];K.tpls=O};Ext.extend(Ext.XTemplate,Ext.Template,{re:/\{([\w-\.\#]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?(\s?[\+\-\*\\]\s?[\d\.\+\-\*\\\(\)]+)?\}/g,codeRe:/\{\[((?:\\\]|.|\n)*?)\]\}/g,applySubTemplate:function(y,p,q,v,w){var s=this,t,i=s.tpls[y],o,x=[];if((i.test&&!i.test.call(s,p,q,v,w))||(i.exec&&i.exec.call(s,p,q,v,w))){return""}o=i.target?i.target.call(s,p,q):p;t=o.length;q=i.target?p:q;if(i.target&&Ext.isArray(o)){for(var u=0,t=o.length;u<t;u++){x[x.length]=i.compiled.call(s,o[u],q,u+1,t)}return x.join("")}return i.compiled.call(s,o,q,v,w)},compileTpl:function(tpl){var fm=Ext.util.Format,useF=this.disableFormats!==true,sep=Ext.isGecko?"+":",",body;function fn(m,name,format,args,math){if(name.substr(0,4)=="xtpl"){return"'"+sep+"this.applySubTemplate("+name.substr(4)+", values, parent, xindex, xcount)"+sep+"'"}var v;if(name==="."){v="values"}else{if(name==="#"){v="xindex"}else{if(name.indexOf(".")!=-1){v=name}else{v="values['"+name+"']"}}}if(math){v="("+v+math+")"}if(format&&useF){args=args?","+args:"";if(format.substr(0,5)!="this."){format="fm."+format+"("}else{format='this.call("'+format.substr(5)+'", ';args=", values"}}else{args="";format="("+v+" === undefined ? '' : "}return"'"+sep+format+v+args+")"+sep+"'"}function codeFn(m,code){return"'"+sep+"("+code.replace(/\\'/g,"'")+")"+sep+"'"}if(Ext.isGecko){body="tpl.compiled = function(values, parent, xindex, xcount){ return '"+tpl.body.replace(/(\r\n|\n)/g,"\\n").replace(/'/g,"\\'").replace(this.re,fn).replace(this.codeRe,codeFn)+"';};"}else{body=["tpl.compiled = function(values, parent, xindex, xcount){ return ['"];body.push(tpl.body.replace(/(\r\n|\n)/g,"\\n").replace(/'/g,"\\'").replace(this.re,fn).replace(this.codeRe,codeFn));body.push("'].join('');};");body=body.join("")}eval(body);return this},applyTemplate:function(b){return this.master.compiled.call(this,b,{},1,1)},compile:function(){return this}});Ext.XTemplate.prototype.apply=Ext.XTemplate.prototype.applyTemplate;Ext.XTemplate.from=function(b){b=Ext.getDom(b);return new Ext.XTemplate(b.value||b.innerHTML)};Ext.util.CSS=function(){var h=null;var i=document;var e=/(-[a-z])/gi;var g=function(b,a){return a.charAt(1).toUpperCase()};return{createStyleSheet:function(d,a){var n;var o=i.getElementsByTagName("head")[0];var b=i.createElement("style");b.setAttribute("type","text/css");if(a){b.setAttribute("id",a)}if(Ext.isIE){o.appendChild(b);n=b.styleSheet;n.cssText=d}else{try{b.appendChild(i.createTextNode(d))}catch(c){b.cssText=d}o.appendChild(b);n=b.styleSheet?b.styleSheet:(b.sheet||i.styleSheets[i.styleSheets.length-1])}this.cacheStyleSheet(n);return n},removeStyleSheet:function(a){var b=i.getElementById(a);if(b){b.parentNode.removeChild(b)
}},swapStyleSheet:function(a,c){this.removeStyleSheet(a);var b=i.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("id",a);b.setAttribute("href",c);i.getElementsByTagName("head")[0].appendChild(b)},refreshCache:function(){return this.getRules(true)},cacheStyleSheet:function(c){if(!h){h={}}try{var a=c.cssRules||c.rules;for(var d=a.length-1;d>=0;--d){h[a[d].selectorText.toLowerCase()]=a[d]}}catch(b){}},getRules:function(d){if(h===null||d){h={};var b=i.styleSheets;for(var c=0,n=b.length;c<n;c++){try{this.cacheStyleSheet(b[c])}catch(a){}}}return h},getRule:function(d,b){var c=this.getRules(b);if(!Ext.isArray(d)){return c[d.toLowerCase()]}for(var a=0;a<d.length;a++){if(c[d[a]]){return c[d[a].toLowerCase()]}}return null},updateRule:function(m,b,c){if(!Ext.isArray(m)){var a=this.getRule(m);if(a){a.style[b.replace(e,g)]=c;return true}}else{for(var d=0;d<m.length;d++){if(this.updateRule(m[d],b,c)){return true}}}return false}}}();Ext.util.ClickRepeater=Ext.extend(Ext.util.Observable,{constructor:function(c,d){this.el=Ext.get(c);this.el.unselectable();Ext.apply(this,d);this.addEvents("mousedown","click","mouseup");if(!this.disabled){this.disabled=true;this.enable()}if(this.handler){this.on("click",this.handler,this.scope||this)}Ext.util.ClickRepeater.superclass.constructor.call(this)},interval:20,delay:250,preventDefault:true,stopDefault:false,timer:0,enable:function(){if(this.disabled){this.el.on("mousedown",this.handleMouseDown,this);if(Ext.isIE){this.el.on("dblclick",this.handleDblClick,this)}if(this.preventDefault||this.stopDefault){this.el.on("click",this.eventOptions,this)}}this.disabled=false},disable:function(b){if(b||!this.disabled){clearTimeout(this.timer);if(this.pressClass){this.el.removeClass(this.pressClass)}Ext.getDoc().un("mouseup",this.handleMouseUp,this);this.el.removeAllListeners()}this.disabled=true},setDisabled:function(b){this[b?"disable":"enable"]()},eventOptions:function(b){if(this.preventDefault){b.preventDefault()}if(this.stopDefault){b.stopEvent()}},destroy:function(){this.disable(true);Ext.destroy(this.el);this.purgeListeners()},handleDblClick:function(b){clearTimeout(this.timer);this.el.blur();this.fireEvent("mousedown",this,b);this.fireEvent("click",this,b)},handleMouseDown:function(b){clearTimeout(this.timer);this.el.blur();if(this.pressClass){this.el.addClass(this.pressClass)}this.mousedownTime=new Date();Ext.getDoc().on("mouseup",this.handleMouseUp,this);this.el.on("mouseout",this.handleMouseOut,this);this.fireEvent("mousedown",this,b);this.fireEvent("click",this,b);if(this.accelerate){this.delay=400}this.timer=this.click.defer(this.delay||this.interval,this,[b])},click:function(b){this.fireEvent("click",this,b);this.timer=this.click.defer(this.accelerate?this.easeOutExpo(this.mousedownTime.getElapsed(),400,-390,12000):this.interval,this,[b])},easeOutExpo:function(i,b,c,d){return(i==d)?b+c:c*(-Math.pow(2,-10*i/d)+1)+b},handleMouseOut:function(){clearTimeout(this.timer);if(this.pressClass){this.el.removeClass(this.pressClass)}this.el.on("mouseover",this.handleMouseReturn,this)},handleMouseReturn:function(){this.el.un("mouseover",this.handleMouseReturn,this);if(this.pressClass){this.el.addClass(this.pressClass)}this.click()},handleMouseUp:function(b){clearTimeout(this.timer);this.el.un("mouseover",this.handleMouseReturn,this);this.el.un("mouseout",this.handleMouseOut,this);Ext.getDoc().un("mouseup",this.handleMouseUp,this);this.el.removeClass(this.pressClass);this.fireEvent("mouseup",this,b)}});Ext.KeyNav=function(c,d){this.el=Ext.get(c);Ext.apply(this,d);if(!this.disabled){this.disabled=true;this.enable()}};Ext.KeyNav.prototype={disabled:false,defaultEventAction:"stopEvent",forceKeyDown:false,relay:function(g){var e=g.getKey(),d=this.keyToHandler[e];if(d&&this[d]){if(this.doRelay(g,this[d],d)!==true){g[this.defaultEventAction]()}}},doRelay:function(g,d,e){return d.call(this.scope||this,g,e)},enter:false,left:false,right:false,up:false,down:false,tab:false,esc:false,pageUp:false,pageDown:false,del:false,home:false,end:false,keyToHandler:{37:"left",39:"right",38:"up",40:"down",33:"pageUp",34:"pageDown",46:"del",36:"home",35:"end",13:"enter",27:"esc",9:"tab"},stopKeyUp:function(c){var d=c.getKey();
if(d>=37&&d<=40){c.stopEvent()}},destroy:function(){this.disable()},enable:function(){if(this.disabled){if(Ext.isSafari2){this.el.on("keyup",this.stopKeyUp,this)}this.el.on(this.isKeydown()?"keydown":"keypress",this.relay,this);this.disabled=false}},disable:function(){if(!this.disabled){if(Ext.isSafari2){this.el.un("keyup",this.stopKeyUp,this)}this.el.un(this.isKeydown()?"keydown":"keypress",this.relay,this);this.disabled=true}},setDisabled:function(b){this[b?"disable":"enable"]()},isKeydown:function(){return this.forceKeyDown||Ext.EventManager.useKeydown}};Ext.KeyMap=function(g,d,e){this.el=Ext.get(g);this.eventName=e||"keydown";this.bindings=[];if(d){this.addBinding(d)}this.enable()};Ext.KeyMap.prototype={stopEvent:false,addBinding:function(v){if(Ext.isArray(v)){Ext.each(v,function(a){this.addBinding(a)},this);return}var n=v.key,q=v.fn||v.handler,m=v.scope;if(v.stopEvent){this.stopEvent=v.stopEvent}if(typeof n=="string"){var p=[];var s=n.toUpperCase();for(var u=0,t=s.length;u<t;u++){p.push(s.charCodeAt(u))}n=p}var w=Ext.isArray(n);var o=function(b){if(this.checkModifiers(v,b)){var d=b.getKey();if(w){for(var c=0,a=n.length;c<a;c++){if(n[c]==d){if(this.stopEvent){b.stopEvent()}q.call(m||window,d,b);return}}}else{if(d==n){if(this.stopEvent){b.stopEvent()}q.call(m||window,d,b)}}}};this.bindings.push(o)},checkModifiers:function(e,m){var l,o,n=["shift","ctrl","alt"];for(var p=0,i=n.length;p<i;++p){o=n[p];l=e[o];if(!(l===undefined||(l===m[o+"Key"]))){return false}}return true},on:function(i,o,p){var l,k,n,m;if(typeof i=="object"&&!Ext.isArray(i)){l=i.key;k=i.shift;n=i.ctrl;m=i.alt}else{l=i}this.addBinding({key:l,shift:k,ctrl:n,alt:m,fn:o,scope:p})},handleKeyDown:function(e){if(this.enabled){var i=this.bindings;for(var h=0,b=i.length;h<b;h++){i[h].call(this,e)}}},isEnabled:function(){return this.enabled},enable:function(){if(!this.enabled){this.el.on(this.eventName,this.handleKeyDown,this);this.enabled=true}},disable:function(){if(this.enabled){this.el.removeListener(this.eventName,this.handleKeyDown,this);this.enabled=false}},setDisabled:function(b){this[b?"disable":"enable"]()}};Ext.util.TextMetrics=function(){var b;return{measure:function(a,g,e){if(!b){b=Ext.util.TextMetrics.Instance(a,e)}b.bind(a);b.setFixedWidth(e||"auto");return b.getSize(g)},createInstance:function(a,d){return Ext.util.TextMetrics.Instance(a,d)}}}();Ext.util.TextMetrics.Instance=function(e,h){var i=new Ext.Element(document.createElement("div"));document.body.appendChild(i.dom);i.position("absolute");i.setLeftTop(-1000,-1000);i.hide();if(h){i.setWidth(h)}var g={getSize:function(a){i.update(a);var b=i.getSize();i.update("");return b},bind:function(a){i.setStyle(Ext.fly(a).getStyles("font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"))},setFixedWidth:function(a){i.setWidth(a)},getWidth:function(a){i.dom.style.width="auto";return this.getSize(a).width},getHeight:function(a){return this.getSize(a).height}};g.bind(e);return g};Ext.Element.addMethods({getTextWidth:function(g,d,e){return(Ext.util.TextMetrics.measure(this.dom,Ext.value(g,this.dom.innerHTML,true)).width).constrain(d||0,e||1000000)}});Ext.util.Cookies={set:function(s,p){var l=arguments;var m=arguments.length;var k=(m>2)?l[2]:null;var n=(m>3)?l[3]:"/";var q=(m>4)?l[4]:null;var o=(m>5)?l[5]:false;document.cookie=s+"="+escape(p)+((k===null)?"":("; expires="+k.toGMTString()))+((n===null)?"":("; path="+n))+((q===null)?"":("; domain="+q))+((o===true)?"; secure":"")},get:function(m){var h=m+"=";var k=h.length;var i=document.cookie.length;var l=0;var n=0;while(l<i){n=l+k;if(document.cookie.substring(l,n)==h){return Ext.util.Cookies.getCookieVal(n)}l=document.cookie.indexOf(" ",l)+1;if(l===0){break}}return null},clear:function(b){if(Ext.util.Cookies.get(b)){document.cookie=b+"=; expires=Thu, 01-Jan-70 00:00:01 GMT"}},getCookieVal:function(c){var d=document.cookie.indexOf(";",c);if(d==-1){d=document.cookie.length}return unescape(document.cookie.substring(c,d))}};Ext.handleError=function(b){throw b
};Ext.Error=function(b){this.message=(this.lang[b])?this.lang[b]:b};Ext.Error.prototype=new Error();Ext.apply(Ext.Error.prototype,{lang:{},name:"Ext.Error",getName:function(){return this.name},getMessage:function(){return this.message},toJson:function(){return Ext.encode(this)}});Ext.ComponentMgr=function(){var g=new Ext.util.MixedCollection();var d={};var e={};return{register:function(a){g.add(a)},unregister:function(a){g.remove(a)},get:function(a){return g.get(a)},onAvailable:function(a,b,c){g.on("add",function(l,k){if(k.id==a){b.call(c||k,k);g.un("add",b,c)}})},all:g,types:d,ptypes:e,isRegistered:function(a){return d[a]!==undefined},isPluginRegistered:function(a){return e[a]!==undefined},registerType:function(a,b){d[a]=b;b.xtype=a},create:function(b,a){return b.render?b:new d[b.xtype||a](b)},registerPlugin:function(a,b){e[a]=b;b.ptype=a},createPlugin:function(b,a){var c=e[b.ptype||a];if(c.init){return c}else{return new c(b)}}}}();Ext.reg=Ext.ComponentMgr.registerType;Ext.preg=Ext.ComponentMgr.registerPlugin;Ext.create=Ext.ComponentMgr.create;Ext.Component=function(d){d=d||{};if(d.initialConfig){if(d.isAction){this.baseAction=d}d=d.initialConfig}else{if(d.tagName||d.dom||Ext.isString(d)){d={applyTo:d,id:d.id||d}}}this.initialConfig=d;Ext.apply(this,d);this.addEvents("added","disable","enable","beforeshow","show","beforehide","hide","removed","beforerender","render","afterrender","beforedestroy","destroy","beforestaterestore","staterestore","beforestatesave","statesave");this.getId();Ext.ComponentMgr.register(this);Ext.Component.superclass.constructor.call(this);if(this.baseAction){this.baseAction.addComponent(this)}this.initComponent();if(this.plugins){if(Ext.isArray(this.plugins)){for(var g=0,e=this.plugins.length;g<e;g++){this.plugins[g]=this.initPlugin(this.plugins[g])}}else{this.plugins=this.initPlugin(this.plugins)}}if(this.stateful!==false){this.initState()}if(this.applyTo){this.applyToMarkup(this.applyTo);delete this.applyTo}else{if(this.renderTo){this.render(this.renderTo);delete this.renderTo}}};Ext.Component.AUTO_ID=1000;Ext.extend(Ext.Component,Ext.util.Observable,{disabled:false,hidden:false,autoEl:"div",disabledClass:"x-item-disabled",allowDomMove:true,autoShow:false,hideMode:"display",hideParent:false,rendered:false,tplWriteMode:"overwrite",bubbleEvents:[],ctype:"Ext.Component",actionMode:"el",getActionEl:function(){return this[this.actionMode]},initPlugin:function(b){if(b.ptype&&!Ext.isFunction(b.init)){b=Ext.ComponentMgr.createPlugin(b)}else{if(Ext.isString(b)){b=Ext.ComponentMgr.createPlugin({ptype:b})}}b.init(this);return b},initComponent:function(){if(this.listeners){this.on(this.listeners);delete this.listeners}this.enableBubble(this.bubbleEvents)},render:function(e,g){if(!this.rendered&&this.fireEvent("beforerender",this)!==false){if(!e&&this.el){this.el=Ext.get(this.el);e=this.el.dom.parentNode;this.allowDomMove=false}this.container=Ext.get(e);if(this.ctCls){this.container.addClass(this.ctCls)}this.rendered=true;if(g!==undefined){if(Ext.isNumber(g)){g=this.container.dom.childNodes[g]}else{g=Ext.getDom(g)}}this.onRender(this.container,g||null);if(this.autoShow){this.el.removeClass(["x-hidden","x-hide-"+this.hideMode])}if(this.cls){this.el.addClass(this.cls);delete this.cls}if(this.style){this.el.applyStyles(this.style);delete this.style}if(this.overCls){this.el.addClassOnOver(this.overCls)}this.fireEvent("render",this);var i=this.getContentTarget();if(this.html){i.update(Ext.DomHelper.markup(this.html));delete this.html}if(this.contentEl){var h=Ext.getDom(this.contentEl);Ext.fly(h).removeClass(["x-hidden","x-hide-display"]);i.appendChild(h)}if(this.tpl){if(!this.tpl.compile){this.tpl=new Ext.XTemplate(this.tpl)}if(this.data){this.tpl[this.tplWriteMode](i,this.data);delete this.data}}this.afterRender(this.container);if(this.hidden){this.doHide()}if(this.disabled){this.disable(true)}if(this.stateful!==false){this.initStateEvents()}this.fireEvent("afterrender",this)}return this},update:function(g,k,h){var l=this.getContentTarget();
if(this.tpl&&typeof g!=="string"){this.tpl[this.tplWriteMode](l,g||{})}else{var i=Ext.isObject(g)?Ext.DomHelper.markup(g):g;l.update(i,k,h)}},onAdded:function(d,c){this.ownerCt=d;this.initRef();this.fireEvent("added",this,d,c)},onRemoved:function(){this.removeRef();this.fireEvent("removed",this,this.ownerCt);delete this.ownerCt},initRef:function(){if(this.ref&&!this.refOwner){var h=this.ref.split("/"),i=h.length,e=0,g=this;while(g&&e<i){g=g.ownerCt;++e}if(g){g[this.refName=h[--e]]=this;this.refOwner=g}}},removeRef:function(){if(this.refOwner&&this.refName){delete this.refOwner[this.refName];delete this.refOwner}},initState:function(){if(Ext.state.Manager){var c=this.getStateId();if(c){var d=Ext.state.Manager.get(c);if(d){if(this.fireEvent("beforestaterestore",this,d)!==false){this.applyState(Ext.apply({},d));this.fireEvent("staterestore",this,d)}}}}},getStateId:function(){return this.stateId||((/^(ext-comp-|ext-gen)/).test(String(this.id))?null:this.id)},initStateEvents:function(){if(this.stateEvents){for(var d=0,c;c=this.stateEvents[d];d++){this.on(c,this.saveState,this,{delay:100})}}},applyState:function(b){if(b){Ext.apply(this,b)}},getState:function(){return null},saveState:function(){if(Ext.state.Manager&&this.stateful!==false){var c=this.getStateId();if(c){var d=this.getState();if(this.fireEvent("beforestatesave",this,d)!==false){Ext.state.Manager.set(c,d);this.fireEvent("statesave",this,d)}}}},applyToMarkup:function(b){this.allowDomMove=false;this.el=Ext.get(b);this.render(this.el.dom.parentNode)},addClass:function(b){if(this.el){this.el.addClass(b)}else{this.cls=this.cls?this.cls+" "+b:b}return this},removeClass:function(b){if(this.el){this.el.removeClass(b)}else{if(this.cls){this.cls=this.cls.split(" ").remove(b).join(" ")}}return this},onRender:function(d,e){if(!this.el&&this.autoEl){if(Ext.isString(this.autoEl)){this.el=document.createElement(this.autoEl)}else{var g=document.createElement("div");Ext.DomHelper.overwrite(g,this.autoEl);this.el=g.firstChild}if(!this.el.id){this.el.id=this.getId()}}if(this.el){this.el=Ext.get(this.el);if(this.allowDomMove!==false){d.dom.insertBefore(this.el.dom,e);if(g){Ext.removeNode(g);g=null}}}},getAutoCreate:function(){var b=Ext.isObject(this.autoCreate)?this.autoCreate:Ext.apply({},this.defaultAutoCreate);if(this.id&&!b.id){b.id=this.id}return b},afterRender:Ext.emptyFn,destroy:function(){if(!this.isDestroyed){if(this.fireEvent("beforedestroy",this)!==false){this.destroying=true;this.beforeDestroy();if(this.ownerCt&&this.ownerCt.remove){this.ownerCt.remove(this,false)}if(this.rendered){this.el.remove();if(this.actionMode=="container"||this.removeMode=="container"){this.container.remove()}}if(this.focusTask&&this.focusTask.cancel){this.focusTask.cancel()}this.onDestroy();Ext.ComponentMgr.unregister(this);this.fireEvent("destroy",this);this.purgeListeners();this.destroying=false;this.isDestroyed=true}}},deleteMembers:function(){var d=arguments;for(var g=0,e=d.length;g<e;++g){delete this[d[g]]}},beforeDestroy:Ext.emptyFn,onDestroy:Ext.emptyFn,getEl:function(){return this.el},getContentTarget:function(){return this.el},getId:function(){return this.id||(this.id="ext-comp-"+(++Ext.Component.AUTO_ID))},getItemId:function(){return this.itemId||this.getId()},focus:function(c,d){if(d){this.focusTask=new Ext.util.DelayedTask(this.focus,this,[c,false]);this.focusTask.delay(Ext.isNumber(d)?d:10);return this}if(this.rendered&&!this.isDestroyed){this.el.focus();if(c===true){this.el.dom.select()}}return this},blur:function(){if(this.rendered){this.el.blur()}return this},disable:function(b){if(this.rendered){this.onDisable()}this.disabled=true;if(b!==true){this.fireEvent("disable",this)}return this},onDisable:function(){this.getActionEl().addClass(this.disabledClass);this.el.dom.disabled=true},enable:function(){if(this.rendered){this.onEnable()}this.disabled=false;this.fireEvent("enable",this);return this},onEnable:function(){this.getActionEl().removeClass(this.disabledClass);this.el.dom.disabled=false
},setDisabled:function(b){return this[b?"disable":"enable"]()},show:function(){if(this.fireEvent("beforeshow",this)!==false){this.hidden=false;if(this.autoRender){this.render(Ext.isBoolean(this.autoRender)?Ext.getBody():this.autoRender)}if(this.rendered){this.onShow()}this.fireEvent("show",this)}return this},onShow:function(){this.getVisibilityEl().removeClass("x-hide-"+this.hideMode)},hide:function(){if(this.fireEvent("beforehide",this)!==false){this.doHide();this.fireEvent("hide",this)}return this},doHide:function(){this.hidden=true;if(this.rendered){this.onHide()}},onHide:function(){this.getVisibilityEl().addClass("x-hide-"+this.hideMode)},getVisibilityEl:function(){return this.hideParent?this.container:this.getActionEl()},setVisible:function(b){return this[b?"show":"hide"]()},isVisible:function(){return this.rendered&&this.getVisibilityEl().isVisible()},cloneConfig:function(d){d=d||{};var g=d.id||Ext.id();var e=Ext.applyIf(d,this.initialConfig);e.id=g;return new this.constructor(e)},getXType:function(){return this.constructor.xtype},isXType:function(c,d){if(Ext.isFunction(c)){c=c.xtype}else{if(Ext.isObject(c)){c=c.constructor.xtype}}return !d?("/"+this.getXTypes()+"/").indexOf("/"+c+"/")!=-1:this.constructor.xtype==c},getXTypes:function(){var e=this.constructor;if(!e.xtypes){var g=[],c=this;while(c&&c.constructor.xtype){g.unshift(c.constructor.xtype);c=c.constructor.superclass}e.xtypeChain=g;e.xtypes=g.join("/")}return e.xtypes},findParentBy:function(d){for(var c=this.ownerCt;(c!=null)&&!d(c,this);c=c.ownerCt){}return c||null},findParentByType:function(c,d){return this.findParentBy(function(a){return a.isXType(c,d)})},bubble:function(i,e,g){var h=this;while(h){if(i.apply(e||h,g||[h])===false){break}h=h.ownerCt}return this},getPositionEl:function(){return this.positionEl||this.el},purgeListeners:function(){Ext.Component.superclass.purgeListeners.call(this);if(this.mons){this.on("beforedestroy",this.clearMons,this,{single:true})}},clearMons:function(){Ext.each(this.mons,function(b){b.item.un(b.ename,b.fn,b.scope)},this);this.mons=[]},createMons:function(){if(!this.mons){this.mons=[];this.on("beforedestroy",this.clearMons,this,{single:true})}},mon:function(p,e,q,s,l){this.createMons();if(Ext.isObject(e)){var m=/^(?:scope|delay|buffer|single|stopEvent|preventDefault|stopPropagation|normalized|args|delegate)$/;var n=e;for(var o in n){if(m.test(o)){continue}if(Ext.isFunction(n[o])){this.mons.push({item:p,ename:o,fn:n[o],scope:n.scope});p.on(o,n[o],n.scope,n)}else{this.mons.push({item:p,ename:o,fn:n[o],scope:n.scope});p.on(o,n[o])}}return}this.mons.push({item:p,ename:e,fn:q,scope:s});p.on(e,q,s,l)},mun:function(n,s,o,p){var m,q;this.createMons();for(var i=0,l=this.mons.length;i<l;++i){q=this.mons[i];if(n===q.item&&s==q.ename&&o===q.fn&&p===q.scope){this.mons.splice(i,1);n.un(s,o,p);m=true;break}}return m},nextSibling:function(){if(this.ownerCt){var b=this.ownerCt.items.indexOf(this);if(b!=-1&&b+1<this.ownerCt.items.getCount()){return this.ownerCt.items.itemAt(b+1)}}return null},previousSibling:function(){if(this.ownerCt){var b=this.ownerCt.items.indexOf(this);if(b>0){return this.ownerCt.items.itemAt(b-1)}}return null},getBubbleTarget:function(){return this.ownerCt}});Ext.reg("component",Ext.Component);Ext.Action=Ext.extend(Object,{constructor:function(b){this.initialConfig=b;this.itemId=b.itemId=(b.itemId||b.id||Ext.id());this.items=[]},isAction:true,setText:function(b){this.initialConfig.text=b;this.callEach("setText",[b])},getText:function(){return this.initialConfig.text},setIconClass:function(b){this.initialConfig.iconCls=b;this.callEach("setIconClass",[b])},getIconClass:function(){return this.initialConfig.iconCls},setDisabled:function(b){this.initialConfig.disabled=b;this.callEach("setDisabled",[b])},enable:function(){this.setDisabled(false)},disable:function(){this.setDisabled(true)},isDisabled:function(){return this.initialConfig.disabled},setHidden:function(b){this.initialConfig.hidden=b;this.callEach("setVisible",[!b])},show:function(){this.setHidden(false)
},hide:function(){this.setHidden(true)},isHidden:function(){return this.initialConfig.hidden},setHandler:function(c,d){this.initialConfig.handler=c;this.initialConfig.scope=d;this.callEach("setHandler",[c,d])},each:function(c,d){Ext.each(this.items,c,d)},callEach:function(i,g){var k=this.items;for(var l=0,h=k.length;l<h;l++){k[l][i].apply(k[l],g)}},addComponent:function(b){this.items.push(b);b.on("destroy",this.removeComponent,this)},removeComponent:function(b){this.items.remove(b)},execute:function(){this.initialConfig.handler.apply(this.initialConfig.scope||window,arguments)}});(function(){Ext.Layer=function(m,n){m=m||{};var l=Ext.DomHelper,b=m.parentEl,k=b?Ext.getDom(b):document.body;if(n){this.dom=Ext.getDom(n)}if(!this.dom){var a=m.dh||{tag:"div",cls:"x-layer"};this.dom=l.append(k,a)}if(m.cls){this.addClass(m.cls)}this.constrain=m.constrain!==false;this.setVisibilityMode(Ext.Element.VISIBILITY);if(m.id){this.id=this.dom.id=m.id}else{this.id=Ext.id(this.dom)}this.zindex=m.zindex||this.getZIndex();this.position("absolute",this.zindex);if(m.shadow){this.shadowOffset=m.shadowOffset||4;this.shadow=new Ext.Shadow({offset:this.shadowOffset,mode:m.shadow})}else{this.shadowOffset=0}this.useShim=m.shim!==false&&Ext.useShims;this.useDisplay=m.useDisplay;this.hide()};var d=Ext.Element.prototype;var c=[];Ext.extend(Ext.Layer,Ext.Element,{getZIndex:function(){return this.zindex||parseInt((this.getShim()||this).getStyle("z-index"),10)||11000},getShim:function(){if(!this.useShim){return null}if(this.shim){return this.shim}var a=c.shift();if(!a){a=this.createShim();a.enableDisplayMode("block");a.dom.style.display="none";a.dom.style.visibility="visible"}var b=this.dom.parentNode;if(a.dom.parentNode!=b){b.insertBefore(a.dom,this.dom)}a.setStyle("z-index",this.getZIndex()-2);this.shim=a;return a},hideShim:function(){if(this.shim){this.shim.setDisplayed(false);c.push(this.shim);delete this.shim}},disableShadow:function(){if(this.shadow){this.shadowDisabled=true;this.shadow.hide();this.lastShadowOffset=this.shadowOffset;this.shadowOffset=0}},enableShadow:function(a){if(this.shadow){this.shadowDisabled=false;this.shadowOffset=this.lastShadowOffset;delete this.lastShadowOffset;if(a){this.sync(true)}}},sync:function(v){var b=this.shadow;if(!this.updating&&this.isVisible()&&(b||this.useShim)){var s=this.getShim(),h=this.getWidth(),q=this.getHeight(),u=this.getLeft(true),a=this.getTop(true);if(b&&!this.shadowDisabled){if(v&&!b.isVisible()){b.show(this)}else{b.realign(u,a,h,q)}if(s){if(v){s.show()}var l=b.el.getXY(),t=s.dom.style,w=b.el.getSize();t.left=(l[0])+"px";t.top=(l[1])+"px";t.width=(w.width)+"px";t.height=(w.height)+"px"}}else{if(s){if(v){s.show()}s.setSize(h,q);s.setLeftTop(u,a)}}}},destroy:function(){this.hideShim();if(this.shadow){this.shadow.hide()}this.removeAllListeners();Ext.removeNode(this.dom);delete this.dom},remove:function(){this.destroy()},beginUpdate:function(){this.updating=true},endUpdate:function(){this.updating=false;this.sync(true)},hideUnders:function(a){if(this.shadow){this.shadow.hide()}this.hideShim()},constrainXY:function(){if(this.constrain){var t=Ext.lib.Dom.getViewWidth(),x=Ext.lib.Dom.getViewHeight();var a=Ext.getDoc().getScroll();var b=this.getXY();var s=b[0],u=b[1];var y=this.shadowOffset;var q=this.dom.offsetWidth+y,w=this.dom.offsetHeight+y;var v=false;if((s+q)>t+a.left){s=t-q-y;v=true}if((u+w)>x+a.top){u=x-w-y;v=true}if(s<a.left){s=a.left;v=true}if(u<a.top){u=a.top;v=true}if(v){if(this.avoidY){var h=this.avoidY;if(u<=h&&(u+w)>=h){u=h-w-5}}b=[s,u];this.storeXY(b);d.setXY.call(this,b);this.sync()}}return this},getConstrainOffset:function(){return this.shadowOffset},isVisible:function(){return this.visible},showAction:function(){this.visible=true;if(this.useDisplay===true){this.setDisplayed("")}else{if(this.lastXY){d.setXY.call(this,this.lastXY)}else{if(this.lastLT){d.setLeftTop.call(this,this.lastLT[0],this.lastLT[1])}}}},hideAction:function(){this.visible=false;if(this.useDisplay===true){this.setDisplayed(false)
}else{this.setLeftTop(-10000,-10000)}},setVisible:function(n,o,b,a,e){if(n){this.showAction()}if(o&&n){var p=function(){this.sync(true);if(a){a()}}.createDelegate(this);d.setVisible.call(this,true,true,b,p,e)}else{if(!n){this.hideUnders(true)}var p=a;if(o){p=function(){this.hideAction();if(a){a()}}.createDelegate(this)}d.setVisible.call(this,n,o,b,p,e);if(n){this.sync(true)}else{if(!o){this.hideAction()}}}return this},storeXY:function(a){delete this.lastLT;this.lastXY=a},storeLeftTop:function(a,b){delete this.lastXY;this.lastLT=[a,b]},beforeFx:function(){this.beforeAction();return Ext.Layer.superclass.beforeFx.apply(this,arguments)},afterFx:function(){Ext.Layer.superclass.afterFx.apply(this,arguments);this.sync(this.isVisible())},beforeAction:function(){if(!this.updating&&this.shadow){this.shadow.hide()}},setLeft:function(a){this.storeLeftTop(a,this.getTop(true));d.setLeft.apply(this,arguments);this.sync();return this},setTop:function(a){this.storeLeftTop(this.getLeft(true),a);d.setTop.apply(this,arguments);this.sync();return this},setLeftTop:function(a,b){this.storeLeftTop(a,b);d.setLeftTop.apply(this,arguments);this.sync();return this},setXY:function(e,o,b,a,n){this.fixDisplay();this.beforeAction();this.storeXY(e);var p=this.createCB(a);d.setXY.call(this,e,o,b,p,n);if(!o){p()}return this},createCB:function(a){var b=this;return function(){b.constrainXY();b.sync(true);if(a){a()}}},setX:function(n,m,b,a,e){this.setXY([n,this.getY()],m,b,a,e);return this},setY:function(a,n,e,b,m){this.setXY([this.getX(),a],n,e,b,m);return this},setSize:function(e,b,h,s,q,a){this.beforeAction();var p=this.createCB(q);d.setSize.call(this,e,b,h,s,p,a);if(!h){p()}return this},setWidth:function(n,o,b,a,e){this.beforeAction();var p=this.createCB(a);d.setWidth.call(this,n,o,b,p,e);if(!o){p()}return this},setHeight:function(e,h,a,p,b){this.beforeAction();var o=this.createCB(p);d.setHeight.call(this,e,h,a,o,b);if(!h){o()}return this},setBounds:function(b,h,a,v,e,t,s,u){this.beforeAction();var w=this.createCB(s);if(!e){this.storeXY([b,h]);d.setXY.call(this,[b,h]);d.setSize.call(this,a,v,e,t,w,u);w()}else{d.setBounds.call(this,b,h,a,v,e,t,w,u)}return this},setZIndex:function(a){this.zindex=a;this.setStyle("z-index",a+2);if(this.shadow){this.shadow.setZIndex(a+1)}if(this.shim){this.shim.setStyle("z-index",a)}return this}})})();Ext.Shadow=function(h){Ext.apply(this,h);if(typeof this.mode!="string"){this.mode=this.defaultMode}var g=this.offset,i={h:0},a=Math.floor(this.offset/2);switch(this.mode.toLowerCase()){case"drop":i.w=0;i.l=i.t=g;i.t-=1;if(Ext.isIE){i.l-=this.offset+a;i.t-=this.offset+a;i.w-=a;i.h-=a;i.t+=1}break;case"sides":i.w=(g*2);i.l=-g;i.t=g-1;if(Ext.isIE){i.l-=(this.offset-a);i.t-=this.offset+a;i.l+=1;i.w-=(this.offset-a)*2;i.w-=a+1;i.h-=1}break;case"frame":i.w=i.h=(g*2);i.l=i.t=-g;i.t+=1;i.h-=2;if(Ext.isIE){i.l-=(this.offset-a);i.t-=(this.offset-a);i.l+=1;i.w-=(this.offset+a+1);i.h-=(this.offset+a);i.h+=1}break}this.adjusts=i};Ext.Shadow.prototype={offset:4,defaultMode:"drop",show:function(b){b=Ext.get(b);if(!this.el){this.el=Ext.Shadow.Pool.pull();if(this.el.dom.nextSibling!=b.dom){this.el.insertBefore(b)}}this.el.setStyle("z-index",this.zIndex||parseInt(b.getStyle("z-index"),10)-1);if(Ext.isIE){this.el.dom.style.filter="progid:DXImageTransform.Microsoft.alpha(opacity=50) progid:DXImageTransform.Microsoft.Blur(pixelradius="+(this.offset)+")"}this.realign(b.getLeft(true),b.getTop(true),b.getWidth(),b.getHeight());this.el.dom.style.display="block"},isVisible:function(){return this.el?true:false},realign:function(B,D,E,y){if(!this.el){return}var h=this.adjusts,s=this.el.dom,C=s.style,w=0,a=(E+h.w),z=(y+h.h),t=a+"px",d=z+"px",l,A;C.left=(B+h.l)+"px";C.top=(D+h.t)+"px";if(C.width!=t||C.height!=d){C.width=t;C.height=d;if(!Ext.isIE){l=s.childNodes;A=Math.max(0,(a-12))+"px";l[0].childNodes[1].style.width=A;l[1].childNodes[1].style.width=A;l[2].childNodes[1].style.width=A;l[1].style.height=Math.max(0,(z-12))+"px"}}},hide:function(){if(this.el){this.el.dom.style.display="none";
Ext.Shadow.Pool.push(this.el);delete this.el}},setZIndex:function(b){this.zIndex=b;if(this.el){this.el.setStyle("z-index",b)}}};Ext.Shadow.Pool=function(){var c=[],d=Ext.isIE?'<div class="x-ie-shadow"></div>':'<div class="x-shadow"><div class="xst"><div class="xstl"></div><div class="xstc"></div><div class="xstr"></div></div><div class="xsc"><div class="xsml"></div><div class="xsmc"></div><div class="xsmr"></div></div><div class="xsb"><div class="xsbl"></div><div class="xsbc"></div><div class="xsbr"></div></div></div>';return{pull:function(){var a=c.shift();if(!a){a=Ext.get(Ext.DomHelper.insertHtml("beforeBegin",document.body.firstChild,d));a.autoBoxAdjust=false}return a},push:function(a){c.push(a)}}}();Ext.BoxComponent=Ext.extend(Ext.Component,{initComponent:function(){Ext.BoxComponent.superclass.initComponent.call(this);this.addEvents("resize","move")},boxReady:false,deferHeight:false,setSize:function(h,m){if(typeof h=="object"){m=h.height;h=h.width}if(Ext.isDefined(h)&&Ext.isDefined(this.boxMinWidth)&&(h<this.boxMinWidth)){h=this.boxMinWidth}if(Ext.isDefined(m)&&Ext.isDefined(this.boxMinHeight)&&(m<this.boxMinHeight)){m=this.boxMinHeight}if(Ext.isDefined(h)&&Ext.isDefined(this.boxMaxWidth)&&(h>this.boxMaxWidth)){h=this.boxMaxWidth}if(Ext.isDefined(m)&&Ext.isDefined(this.boxMaxHeight)&&(m>this.boxMaxHeight)){m=this.boxMaxHeight}if(!this.boxReady){this.width=h;this.height=m;return this}if(this.cacheSizes!==false&&this.lastSize&&this.lastSize.width==h&&this.lastSize.height==m){return this}this.lastSize={width:h,height:m};var n=this.adjustSize(h,m),k=n.width,i=n.height,l;if(k!==undefined||i!==undefined){l=this.getResizeEl();if(!this.deferHeight&&k!==undefined&&i!==undefined){l.setSize(k,i)}else{if(!this.deferHeight&&i!==undefined){l.setHeight(i)}else{if(k!==undefined){l.setWidth(k)}}}this.onResize(k,i,h,m);this.fireEvent("resize",this,k,i,h,m)}return this},setWidth:function(b){return this.setSize(b)},setHeight:function(b){return this.setSize(undefined,b)},getSize:function(){return this.getResizeEl().getSize()},getWidth:function(){return this.getResizeEl().getWidth()},getHeight:function(){return this.getResizeEl().getHeight()},getOuterSize:function(){var b=this.getResizeEl();return{width:b.getWidth()+b.getMargins("lr"),height:b.getHeight()+b.getMargins("tb")}},getPosition:function(d){var c=this.getPositionEl();if(d===true){return[c.getLeft(true),c.getTop(true)]}return this.xy||c.getXY()},getBox:function(e){var g=this.getPosition(e);var d=this.getSize();d.x=g[0];d.y=g[1];return d},updateBox:function(b){this.setSize(b.width,b.height);this.setPagePosition(b.x,b.y);return this},getResizeEl:function(){return this.resizeEl||this.el},setAutoScroll:function(b){if(this.rendered){this.getContentTarget().setOverflow(b?"auto":"")}this.autoScroll=b;return this},setPosition:function(i,k){if(i&&typeof i[1]=="number"){k=i[1];i=i[0]}this.x=i;this.y=k;if(!this.boxReady){return this}var h=this.adjustPosition(i,k);var l=h.x,m=h.y;var n=this.getPositionEl();if(l!==undefined||m!==undefined){if(l!==undefined&&m!==undefined){n.setLeftTop(l,m)}else{if(l!==undefined){n.setLeft(l)}else{if(m!==undefined){n.setTop(m)}}}this.onPosition(l,m);this.fireEvent("move",this,l,m)}return this},setPagePosition:function(e,g){if(e&&typeof e[1]=="number"){g=e[1];e=e[0]}this.pageX=e;this.pageY=g;if(!this.boxReady){return}if(e===undefined||g===undefined){return}var d=this.getPositionEl().translatePoints(e,g);this.setPosition(d.left,d.top);return this},afterRender:function(){Ext.BoxComponent.superclass.afterRender.call(this);if(this.resizeEl){this.resizeEl=Ext.get(this.resizeEl)}if(this.positionEl){this.positionEl=Ext.get(this.positionEl)}this.boxReady=true;Ext.isDefined(this.autoScroll)&&this.setAutoScroll(this.autoScroll);this.setSize(this.width,this.height);if(this.x||this.y){this.setPosition(this.x,this.y)}else{if(this.pageX||this.pageY){this.setPagePosition(this.pageX,this.pageY)}}},syncSize:function(){delete this.lastSize;this.setSize(this.autoWidth?undefined:this.getResizeEl().getWidth(),this.autoHeight?undefined:this.getResizeEl().getHeight());
return this},onResize:function(h,e,g,i){},onPosition:function(d,c){},adjustSize:function(d,c){if(this.autoWidth){d="auto"}if(this.autoHeight){c="auto"}return{width:d,height:c}},adjustPosition:function(d,c){return{x:d,y:c}}});Ext.reg("box",Ext.BoxComponent);Ext.Spacer=Ext.extend(Ext.BoxComponent,{autoEl:"div"});Ext.reg("spacer",Ext.Spacer);Ext.SplitBar=function(l,i,g,k,h){this.el=Ext.get(l,true);this.el.dom.unselectable="on";this.resizingEl=Ext.get(i,true);this.orientation=g||Ext.SplitBar.HORIZONTAL;this.minSize=0;this.maxSize=2000;this.animate=false;this.useShim=false;this.shim=null;if(!h){this.proxy=Ext.SplitBar.createProxy(this.orientation)}else{this.proxy=Ext.get(h).dom}this.dd=new Ext.dd.DDProxy(this.el.dom.id,"XSplitBars",{dragElId:this.proxy.id});this.dd.b4StartDrag=this.onStartProxyDrag.createDelegate(this);this.dd.endDrag=this.onEndProxyDrag.createDelegate(this);this.dragSpecs={};this.adapter=new Ext.SplitBar.BasicLayoutAdapter();this.adapter.init(this);if(this.orientation==Ext.SplitBar.HORIZONTAL){this.placement=k||(this.el.getX()>this.resizingEl.getX()?Ext.SplitBar.LEFT:Ext.SplitBar.RIGHT);this.el.addClass("x-splitbar-h")}else{this.placement=k||(this.el.getY()>this.resizingEl.getY()?Ext.SplitBar.TOP:Ext.SplitBar.BOTTOM);this.el.addClass("x-splitbar-v")}this.addEvents("resize","moved","beforeresize","beforeapply");Ext.SplitBar.superclass.constructor.call(this)};Ext.extend(Ext.SplitBar,Ext.util.Observable,{onStartProxyDrag:function(h,i){this.fireEvent("beforeresize",this);this.overlay=Ext.DomHelper.append(document.body,{cls:"x-drag-overlay",html:"&#160;"},true);this.overlay.unselectable();this.overlay.setSize(Ext.lib.Dom.getViewWidth(true),Ext.lib.Dom.getViewHeight(true));this.overlay.show();Ext.get(this.proxy).setDisplayed("block");var l=this.adapter.getElementSize(this);this.activeMinSize=this.getMinimumSize();this.activeMaxSize=this.getMaximumSize();var k=l-this.activeMinSize;var g=Math.max(this.activeMaxSize-l,0);if(this.orientation==Ext.SplitBar.HORIZONTAL){this.dd.resetConstraints();this.dd.setXConstraint(this.placement==Ext.SplitBar.LEFT?k:g,this.placement==Ext.SplitBar.LEFT?g:k,this.tickSize);this.dd.setYConstraint(0,0)}else{this.dd.resetConstraints();this.dd.setXConstraint(0,0);this.dd.setYConstraint(this.placement==Ext.SplitBar.TOP?k:g,this.placement==Ext.SplitBar.TOP?g:k,this.tickSize)}this.dragSpecs.startSize=l;this.dragSpecs.startPoint=[h,i];Ext.dd.DDProxy.prototype.b4StartDrag.call(this.dd,h,i)},onEndProxyDrag:function(g){Ext.get(this.proxy).setDisplayed(false);var d=Ext.lib.Event.getXY(g);if(this.overlay){Ext.destroy(this.overlay);delete this.overlay}var e;if(this.orientation==Ext.SplitBar.HORIZONTAL){e=this.dragSpecs.startSize+(this.placement==Ext.SplitBar.LEFT?d[0]-this.dragSpecs.startPoint[0]:this.dragSpecs.startPoint[0]-d[0])}else{e=this.dragSpecs.startSize+(this.placement==Ext.SplitBar.TOP?d[1]-this.dragSpecs.startPoint[1]:this.dragSpecs.startPoint[1]-d[1])}e=Math.min(Math.max(e,this.activeMinSize),this.activeMaxSize);if(e!=this.dragSpecs.startSize){if(this.fireEvent("beforeapply",this,e)!==false){this.adapter.setElementSize(this,e);this.fireEvent("moved",this,e);this.fireEvent("resize",this,e)}}},getAdapter:function(){return this.adapter},setAdapter:function(b){this.adapter=b;this.adapter.init(this)},getMinimumSize:function(){return this.minSize},setMinimumSize:function(b){this.minSize=b},getMaximumSize:function(){return this.maxSize},setMaximumSize:function(b){this.maxSize=b},setCurrentSize:function(c){var d=this.animate;this.animate=false;this.adapter.setElementSize(this,c);this.animate=d},destroy:function(b){Ext.destroy(this.shim,Ext.get(this.proxy));this.dd.unreg();if(b){this.el.remove()}this.purgeListeners()}});Ext.SplitBar.createProxy=function(d){var g=new Ext.Element(document.createElement("div"));document.body.appendChild(g.dom);g.unselectable();var e="x-splitbar-proxy";g.addClass(e+" "+(d==Ext.SplitBar.HORIZONTAL?e+"-h":e+"-v"));return g.dom};Ext.SplitBar.BasicLayoutAdapter=function(){};Ext.SplitBar.BasicLayoutAdapter.prototype={init:function(b){},getElementSize:function(b){if(b.orientation==Ext.SplitBar.HORIZONTAL){return b.resizingEl.getWidth()
}else{return b.resizingEl.getHeight()}},setElementSize:function(d,e,g){if(d.orientation==Ext.SplitBar.HORIZONTAL){if(!d.animate){d.resizingEl.setWidth(e);if(g){g(d,e)}}else{d.resizingEl.setWidth(e,true,0.1,g,"easeOut")}}else{if(!d.animate){d.resizingEl.setHeight(e);if(g){g(d,e)}}else{d.resizingEl.setHeight(e,true,0.1,g,"easeOut")}}}};Ext.SplitBar.AbsoluteLayoutAdapter=function(b){this.basic=new Ext.SplitBar.BasicLayoutAdapter();this.container=Ext.get(b)};Ext.SplitBar.AbsoluteLayoutAdapter.prototype={init:function(b){this.basic.init(b)},getElementSize:function(b){return this.basic.getElementSize(b)},setElementSize:function(d,e,g){this.basic.setElementSize(d,e,this.moveSplitter.createDelegate(this,[d]))},moveSplitter:function(d){var c=Ext.SplitBar;switch(d.placement){case c.LEFT:d.el.setX(d.resizingEl.getRight());break;case c.RIGHT:d.el.setStyle("right",(this.container.getWidth()-d.resizingEl.getLeft())+"px");break;case c.TOP:d.el.setY(d.resizingEl.getBottom());break;case c.BOTTOM:d.el.setY(d.resizingEl.getTop()-d.el.getHeight());break}}};Ext.SplitBar.VERTICAL=1;Ext.SplitBar.HORIZONTAL=2;Ext.SplitBar.LEFT=1;Ext.SplitBar.RIGHT=2;Ext.SplitBar.TOP=3;Ext.SplitBar.BOTTOM=4;Ext.Container=Ext.extend(Ext.BoxComponent,{bufferResize:50,autoDestroy:true,forceLayout:false,defaultType:"panel",resizeEvent:"resize",bubbleEvents:["add","remove"],initComponent:function(){Ext.Container.superclass.initComponent.call(this);this.addEvents("afterlayout","beforeadd","beforeremove","add","remove");var b=this.items;if(b){delete this.items;this.add(b)}},initItems:function(){if(!this.items){this.items=new Ext.util.MixedCollection(false,this.getComponentId);this.getLayout()}},setLayout:function(b){if(this.layout&&this.layout!=b){this.layout.setContainer(null)}this.layout=b;this.initItems();b.setContainer(this)},afterRender:function(){Ext.Container.superclass.afterRender.call(this);if(!this.layout){this.layout="auto"}if(Ext.isObject(this.layout)&&!this.layout.layout){this.layoutConfig=this.layout;this.layout=this.layoutConfig.type}if(Ext.isString(this.layout)){this.layout=new Ext.Container.LAYOUTS[this.layout.toLowerCase()](this.layoutConfig)}this.setLayout(this.layout);if(this.activeItem!==undefined&&this.layout.setActiveItem){var b=this.activeItem;delete this.activeItem;this.layout.setActiveItem(b)}if(!this.ownerCt){this.doLayout(false,true)}if(this.monitorResize===true){Ext.EventManager.onWindowResize(this.doLayout,this,[false])}},getLayoutTarget:function(){return this.el},getComponentId:function(b){return b.getItemId()},add:function(c){this.initItems();var k=arguments.length>1;if(k||Ext.isArray(c)){var h=[];Ext.each(k?arguments:c,function(a){h.push(this.add(a))},this);return h}var i=this.lookupComponent(this.applyDefaults(c));var l=this.items.length;if(this.fireEvent("beforeadd",this,i,l)!==false&&this.onBeforeAdd(i)!==false){this.items.add(i);i.onAdded(this,l);this.onAdd(i);this.fireEvent("add",this,i,l)}return i},onAdd:function(b){},onAdded:function(d,c){this.ownerCt=d;this.initRef();this.cascade(function(a){a.initRef()});this.fireEvent("added",this,d,c)},insert:function(o,c){var p=arguments,m=p.length,i=[],n,l;this.initItems();if(m>2){for(n=m-1;n>=1;--n){i.push(this.insert(o,p[n]))}return i}l=this.lookupComponent(this.applyDefaults(c));o=Math.min(o,this.items.length);if(this.fireEvent("beforeadd",this,l,o)!==false&&this.onBeforeAdd(l)!==false){if(l.ownerCt==this){this.items.remove(l)}this.items.insert(o,l);l.onAdded(this,o);this.onAdd(l);this.fireEvent("add",this,l,o)}return l},applyDefaults:function(c){var d=this.defaults;if(d){if(Ext.isFunction(d)){d=d.call(this,c)}if(Ext.isString(c)){c=Ext.ComponentMgr.get(c);Ext.apply(c,d)}else{if(!c.events){Ext.applyIf(c,d)}else{Ext.apply(c,d)}}}return c},onBeforeAdd:function(b){if(b.ownerCt){b.ownerCt.remove(b,false)}if(this.hideBorders===true){b.border=(b.border===true)}},remove:function(e,c){this.initItems();var g=this.getComponent(e);if(g&&this.fireEvent("beforeremove",this,g)!==false){this.doRemove(g,c);this.fireEvent("remove",this,g)
}return g},onRemove:function(b){},doRemove:function(h,i){var c=this.layout,g=c&&this.rendered;if(g){c.onRemove(h)}this.items.remove(h);h.onRemoved();this.onRemove(h);if(i===true||(i!==false&&this.autoDestroy)){h.destroy()}if(g){c.afterRemove(h)}},removeAll:function(n){this.initItems();var l,k=[],h=[];this.items.each(function(a){k.push(a)});for(var m=0,i=k.length;m<i;++m){l=k[m];this.remove(l,n);if(l.ownerCt!==this){h.push(l)}}return h},getComponent:function(b){if(Ext.isObject(b)){b=b.getItemId()}return this.items.get(b)},lookupComponent:function(b){if(Ext.isString(b)){return Ext.ComponentMgr.get(b)}else{if(!b.events){return this.createComponent(b)}}return b},createComponent:function(e,g){if(e.render){return e}var c=Ext.create(Ext.apply({ownerCt:this},e),g||this.defaultType);delete c.initialConfig.ownerCt;delete c.ownerCt;return c},canLayout:function(){var b=this.getVisibilityEl();return b&&b.dom&&!b.isStyle("display","none")},doLayout:function(p,q){var m=this.rendered,n=q||this.forceLayout;if(this.collapsed||!this.canLayout()){this.deferLayout=this.deferLayout||!p;if(!n){return}p=p&&!this.deferLayout}else{delete this.deferLayout}if(m&&this.layout){this.layout.layout()}if(p!==true&&this.items){var s=this.items.items;for(var c=0,i=s.length;c<i;c++){var o=s[c];if(o.doLayout){o.doLayout(false,n)}}}if(m){this.onLayout(p,n)}this.hasLayout=true;delete this.forceLayout},onLayout:Ext.emptyFn,shouldBufferLayout:function(){var b=this.hasLayout;if(this.ownerCt){return b?!this.hasLayoutPending():false}return b},hasLayoutPending:function(){var b=false;this.ownerCt.bubble(function(a){if(a.layoutPending){b=true;return false}});return b},onShow:function(){Ext.Container.superclass.onShow.call(this);if(Ext.isDefined(this.deferLayout)){delete this.deferLayout;this.doLayout(true)}},getLayout:function(){if(!this.layout){var b=new Ext.layout.AutoLayout(this.layoutConfig);this.setLayout(b)}return this.layout},beforeDestroy:function(){var b;if(this.items){while(b=this.items.first()){this.doRemove(b,true)}}if(this.monitorResize){Ext.EventManager.removeResizeListener(this.doLayout,this)}Ext.destroy(this.layout);Ext.Container.superclass.beforeDestroy.call(this)},cascade:function(k,l,h){if(k.apply(l||this,h||[this])!==false){if(this.items){var m=this.items.items;for(var n=0,i=m.length;n<i;n++){if(m[n].cascade){m[n].cascade(k,l,h)}else{k.apply(l||m[n],h||[m[n]])}}}}return this},findById:function(g){var e=null,d=this;this.cascade(function(a){if(d!=a&&a.id===g){e=a;return false}});return e},findByType:function(c,d){return this.findBy(function(a){return a.isXType(c,d)})},find:function(c,d){return this.findBy(function(a){return a[c]===d})},findBy:function(h,i){var g=[],e=this;this.cascade(function(a){if(e!=a&&h.call(i||a,a,e)===true){g.push(a)}});return g},get:function(b){return this.getComponent(b)}});Ext.Container.LAYOUTS={};Ext.reg("container",Ext.Container);Ext.layout.ContainerLayout=Ext.extend(Object,{monitorResize:false,activeItem:null,constructor:function(b){this.id=Ext.id(null,"ext-layout-");Ext.apply(this,b)},type:"container",IEMeasureHack:function(i,s){var u=i.dom.childNodes,t=u.length,c,d=[],e,q,p;for(q=0;q<t;q++){c=u[q];e=Ext.get(c);if(e){d[q]=e.getStyle("display");e.setStyle({display:"none"})}}p=i?i.getViewSize(s):{};for(q=0;q<t;q++){c=u[q];e=Ext.get(c);if(e){e.setStyle({display:d[q]})}}return p},getLayoutTargetSize:Ext.EmptyFn,layout:function(){var d=this.container,c=d.getLayoutTarget();if(!(this.hasLayout||Ext.isEmpty(this.targetCls))){c.addClass(this.targetCls)}this.onLayout(d,c);d.fireEvent("afterlayout",d,this)},onLayout:function(d,c){this.renderAll(d,c)},isValidParent:function(c,d){return d&&c.getPositionEl().dom.parentNode==(d.dom||d)},renderAll:function(m,l){var c=m.items.items,n,k,i=c.length;for(n=0;n<i;n++){k=c[n];if(k&&(!k.rendered||!this.isValidParent(k,l))){this.renderItem(k,n,l)}}},renderItem:function(g,e,c){if(g){if(!g.rendered){g.render(c,e);this.configureItem(g)}else{if(!this.isValidParent(g,c)){if(Ext.isNumber(e)){e=c.dom.childNodes[e]
}c.dom.insertBefore(g.getPositionEl().dom,e||null);g.container=c;this.configureItem(g)}}}},getRenderedItems:function(n){var o=n.getLayoutTarget(),m=n.items.items,i=m.length,p,l,c=[];for(p=0;p<i;p++){if((l=m[p]).rendered&&this.isValidParent(l,o)&&l.shouldLayout!==false){c.push(l)}}return c},configureItem:function(c){if(this.extraCls){var d=c.getPositionEl?c.getPositionEl():c;d.addClass(this.extraCls)}if(c.doLayout&&this.forceLayout){c.doLayout()}if(this.renderHidden&&c!=this.activeItem){c.hide()}},onRemove:function(c){if(this.activeItem==c){delete this.activeItem}if(c.rendered&&this.extraCls){var d=c.getPositionEl?c.getPositionEl():c;d.removeClass(this.extraCls)}},afterRemove:function(b){if(b.removeRestore){b.removeMode="container";delete b.removeRestore}},onResize:function(){var d=this.container,b;if(d.collapsed){return}if(b=d.bufferResize&&d.shouldBufferLayout()){if(!this.resizeTask){this.resizeTask=new Ext.util.DelayedTask(this.runLayout,this);this.resizeBuffer=Ext.isNumber(b)?b:50}d.layoutPending=true;this.resizeTask.delay(this.resizeBuffer)}else{this.runLayout()}},runLayout:function(){var b=this.container;this.layout();b.onLayout();delete b.layoutPending},setContainer:function(c){if(this.monitorResize&&c!=this.container){var d=this.container;if(d){d.un(d.resizeEvent,this.onResize,this)}if(c){c.on(c.resizeEvent,this.onResize,this)}}this.container=c},parseMargins:function(d){if(Ext.isNumber(d)){d=d.toString()}var g=d.split(" "),e=g.length;if(e==1){g[1]=g[2]=g[3]=g[0]}else{if(e==2){g[2]=g[0];g[3]=g[1]}else{if(e==3){g[3]=g[1]}}}return{top:parseInt(g[0],10)||0,right:parseInt(g[1],10)||0,bottom:parseInt(g[2],10)||0,left:parseInt(g[3],10)||0}},fieldTpl:(function(){var b=new Ext.Template('<div class="x-form-item {itemCls}" tabIndex="-1">','<label for="{id}" style="{labelStyle}" class="x-form-item-label">{label}{labelSeparator}</label>','<div class="x-form-element" id="x-form-el-{id}" style="{elementStyle}">','</div><div class="{clearCls}"></div>',"</div>");b.disableFormats=true;return b.compile()})(),destroy:function(){if(this.resizeTask&&this.resizeTask.cancel){this.resizeTask.cancel()}if(!Ext.isEmpty(this.targetCls)){var b=this.container.getLayoutTarget();if(b){b.removeClass(this.targetCls)}}}});Ext.layout.AutoLayout=Ext.extend(Ext.layout.ContainerLayout,{type:"auto",monitorResize:true,onLayout:function(n,l){Ext.layout.AutoLayout.superclass.onLayout.call(this,n,l);var m=this.getRenderedItems(n),i=m.length,c,k;for(c=0;c<i;c++){k=m[c];if(k.doLayout){k.doLayout(true)}}}});Ext.Container.LAYOUTS.auto=Ext.layout.AutoLayout;Ext.layout.FitLayout=Ext.extend(Ext.layout.ContainerLayout,{monitorResize:true,type:"fit",getLayoutTargetSize:function(){var b=this.container.getLayoutTarget();if(!b){return{}}return b.getStyleSize()},onLayout:function(d,c){Ext.layout.FitLayout.superclass.onLayout.call(this,d,c);if(!d.collapsed){this.setItemSize(this.activeItem||d.items.itemAt(0),this.getLayoutTargetSize())}},setItemSize:function(c,d){if(c&&d.height>0){c.setSize(d)}}});Ext.Container.LAYOUTS.fit=Ext.layout.FitLayout;Ext.layout.CardLayout=Ext.extend(Ext.layout.FitLayout,{deferredRender:false,layoutOnCardChange:false,renderHidden:true,type:"card",setActiveItem:function(h){var g=this.activeItem,e=this.container;h=e.getComponent(h);if(h&&g!=h){if(g){g.hide();if(g.hidden!==true){return false}g.fireEvent("deactivate",g)}var i=h.doLayout&&(this.layoutOnCardChange||!h.rendered);this.activeItem=h;delete h.deferLayout;h.show();this.layout();if(i){h.doLayout()}h.fireEvent("activate",h)}},renderAll:function(d,c){if(this.deferredRender){this.renderItem(this.activeItem,undefined,c)}else{Ext.layout.CardLayout.superclass.renderAll.call(this,d,c)}}});Ext.Container.LAYOUTS.card=Ext.layout.CardLayout;Ext.layout.AnchorLayout=Ext.extend(Ext.layout.ContainerLayout,{monitorResize:true,type:"anchor",defaultAnchor:"100%",parseAnchorRE:/^(r|right|b|bottom)$/i,getLayoutTargetSize:function(){var c=this.container.getLayoutTarget(),d={};if(c){d=c.getViewSize();if(Ext.isIE&&Ext.isStrict&&d.width==0){d=c.getStyleSize()
}d.width-=c.getPadding("lr");d.height-=c.getPadding("tb")}return d},onLayout:function(I,i){Ext.layout.AnchorLayout.superclass.onLayout.call(this,I,i);var F=this.getLayoutTargetSize(),K=F.width,G=F.height,E=i.getStyle("overflow"),H=this.getRenderedItems(I),B=H.length,N=[],L,S,z,J,M,Q,O,P,A=0,C,R;if(K<20&&G<20){return}if(I.anchorSize){if(typeof I.anchorSize=="number"){S=I.anchorSize}else{S=I.anchorSize.width;z=I.anchorSize.height}}else{S=I.initialConfig.width;z=I.initialConfig.height}for(C=0;C<B;C++){J=H[C];R=J.getPositionEl();if(!J.anchor&&J.items&&!Ext.isNumber(J.width)&&!(Ext.isIE6&&Ext.isStrict)){J.anchor=this.defaultAnchor}if(J.anchor){M=J.anchorSpec;if(!M){P=J.anchor.split(" ");J.anchorSpec=M={right:this.parseAnchor(P[0],J.initialConfig.width,S),bottom:this.parseAnchor(P[1],J.initialConfig.height,z)}}Q=M.right?this.adjustWidthAnchor(M.right(K)-R.getMargins("lr"),J):undefined;O=M.bottom?this.adjustHeightAnchor(M.bottom(G)-R.getMargins("tb"),J):undefined;if(Q||O){N.push({component:J,width:Q||undefined,height:O||undefined})}}}for(C=0,B=N.length;C<B;C++){L=N[C];L.component.setSize(L.width,L.height)}if(E&&E!="hidden"&&!this.adjustmentPass){var D=this.getLayoutTargetSize();if(D.width!=F.width||D.height!=F.height){this.adjustmentPass=true;this.onLayout(I,i)}}delete this.adjustmentPass},parseAnchor:function(n,i,a){if(n&&n!="none"){var l;if(this.parseAnchorRE.test(n)){var k=a-i;return function(b){if(b!==l){l=b;return b-k}}}else{if(n.indexOf("%")!=-1){var m=parseFloat(n.replace("%",""))*0.01;return function(b){if(b!==l){l=b;return Math.floor(b*m)}}}else{n=parseInt(n,10);if(!isNaN(n)){return function(b){if(b!==l){l=b;return b+n}}}}}}return false},adjustWidthAnchor:function(c,d){return c},adjustHeightAnchor:function(c,d){return c}});Ext.Container.LAYOUTS.anchor=Ext.layout.AnchorLayout;Ext.layout.ColumnLayout=Ext.extend(Ext.layout.ContainerLayout,{monitorResize:true,type:"column",extraCls:"x-column",scrollOffset:0,targetCls:"x-column-layout-ct",isValidParent:function(c,d){return this.innerCt&&c.getPositionEl().dom.parentNode==this.innerCt.dom},getLayoutTargetSize:function(){var c=this.container.getLayoutTarget(),d;if(c){d=c.getViewSize();if(Ext.isIE&&Ext.isStrict&&d.width==0){d=c.getStyleSize()}d.width-=c.getPadding("lr");d.height-=c.getPadding("tb")}return d},renderAll:function(d,c){if(!this.innerCt){this.innerCt=c.createChild({cls:"x-column-inner"});this.innerCt.createChild({cls:"x-clear"})}Ext.layout.ColumnLayout.superclass.renderAll.call(this,d,this.innerCt)},onLayout:function(x,u){var w=x.items.items,v=w.length,i,z,A,h=[];this.renderAll(x,u);var B=this.getLayoutTargetSize();if(B.width<1&&B.height<1){return}var c=B.width-this.scrollOffset,y=B.height,C=c;this.innerCt.setWidth(c);for(z=0;z<v;z++){i=w[z];A=i.getPositionEl().getMargins("lr");h[z]=A;if(!i.columnWidth){C-=(i.getWidth()+A)}}C=C<0?0:C;for(z=0;z<v;z++){i=w[z];A=h[z];if(i.columnWidth){i.setSize(Math.floor(i.columnWidth*C)-A)}}if(Ext.isIE){if(z=u.getStyle("overflow")&&z!="hidden"&&!this.adjustmentPass){var m=this.getLayoutTargetSize();if(m.width!=B.width){this.adjustmentPass=true;this.onLayout(x,u)}}}delete this.adjustmentPass}});Ext.Container.LAYOUTS.column=Ext.layout.ColumnLayout;Ext.layout.BorderLayout=Ext.extend(Ext.layout.ContainerLayout,{monitorResize:true,rendered:false,type:"border",targetCls:"x-border-layout-ct",getLayoutTargetSize:function(){var b=this.container.getLayoutTarget();return b?b.getViewSize():{}},onLayout:function(Y,b){var X,P,n,U,c=Y.items.items,N=c.length;if(!this.rendered){X=[];for(P=0;P<N;P++){n=c[P];U=n.region;if(n.collapsed){X.push(n)}n.collapsed=false;if(!n.rendered){n.render(b,P);n.getPositionEl().addClass("x-border-panel")}this[U]=U!="center"&&n.split?new Ext.layout.BorderLayout.SplitRegion(this,n.initialConfig,U):new Ext.layout.BorderLayout.Region(this,n.initialConfig,U);this[U].render(b,n)}this.rendered=true}var h=this.getLayoutTargetSize();if(h.width<20||h.height<20){if(X){this.restoreCollapsed=X}return}else{if(this.restoreCollapsed){X=this.restoreCollapsed;
delete this.restoreCollapsed}}var w=h.width,L=h.height,M=w,Q=L,S=0,O=0,T=this.north,m=this.south,V=this.west,s=this.east,n=this.center,e,R,Z,i;if(!n&&Ext.layout.BorderLayout.WARN!==false){throw"No center region defined in BorderLayout "+Y.id}if(T&&T.isVisible()){e=T.getSize();R=T.getMargins();e.width=w-(R.left+R.right);e.x=R.left;e.y=R.top;S=e.height+e.y+R.bottom;Q-=S;T.applyLayout(e)}if(m&&m.isVisible()){e=m.getSize();R=m.getMargins();e.width=w-(R.left+R.right);e.x=R.left;i=(e.height+R.top+R.bottom);e.y=L-i+R.top;Q-=i;m.applyLayout(e)}if(V&&V.isVisible()){e=V.getSize();R=V.getMargins();e.height=Q-(R.top+R.bottom);e.x=R.left;e.y=S+R.top;Z=(e.width+R.left+R.right);O+=Z;M-=Z;V.applyLayout(e)}if(s&&s.isVisible()){e=s.getSize();R=s.getMargins();e.height=Q-(R.top+R.bottom);Z=(e.width+R.left+R.right);e.x=w-Z+R.left;e.y=S+R.top;M-=Z;s.applyLayout(e)}if(n){R=n.getMargins();var W={x:O+R.left,y:S+R.top,width:M-(R.left+R.right),height:Q-(R.top+R.bottom)};n.applyLayout(W)}if(X){for(P=0,N=X.length;P<N;P++){X[P].collapse(false)}}if(Ext.isIE&&Ext.isStrict){b.repaint()}if(P=b.getStyle("overflow")&&P!="hidden"&&!this.adjustmentPass){var aa=this.getLayoutTargetSize();if(aa.width!=h.width||aa.height!=h.height){this.adjustmentPass=true;this.onLayout(Y,b)}}delete this.adjustmentPass},destroy:function(){var d=["north","south","east","west"],e,g;for(e=0;e<d.length;e++){g=this[d[e]];if(g){if(g.destroy){g.destroy()}else{if(g.split){g.split.destroy(true)}}}}Ext.layout.BorderLayout.superclass.destroy.call(this)}});Ext.layout.BorderLayout.Region=function(d,e,g){Ext.apply(this,e);this.layout=d;this.position=g;this.state={};if(typeof this.margins=="string"){this.margins=this.layout.parseMargins(this.margins)}this.margins=Ext.applyIf(this.margins||{},this.defaultMargins);if(this.collapsible){if(typeof this.cmargins=="string"){this.cmargins=this.layout.parseMargins(this.cmargins)}if(this.collapseMode=="mini"&&!this.cmargins){this.cmargins={left:0,top:0,right:0,bottom:0}}else{this.cmargins=Ext.applyIf(this.cmargins||{},g=="north"||g=="south"?this.defaultNSCMargins:this.defaultEWCMargins)}}};Ext.layout.BorderLayout.Region.prototype={collapsible:false,split:false,floatable:true,minWidth:50,minHeight:50,defaultMargins:{left:0,top:0,right:0,bottom:0},defaultNSCMargins:{left:5,top:5,right:5,bottom:5},defaultEWCMargins:{left:5,top:0,right:5,bottom:0},floatingZIndex:100,isCollapsed:false,render:function(e,i){this.panel=i;i.el.enableDisplayMode();this.targetEl=e;this.el=i.el;var g=i.getState,h=this.position;i.getState=function(){return Ext.apply(g.call(i)||{},this.state)}.createDelegate(this);if(h!="center"){i.allowQueuedExpand=false;i.on({beforecollapse:this.beforeCollapse,collapse:this.onCollapse,beforeexpand:this.beforeExpand,expand:this.onExpand,hide:this.onHide,show:this.onShow,scope:this});if(this.collapsible||this.floatable){i.collapseEl="el";i.slideAnchor=this.getSlideAnchor()}if(i.tools&&i.tools.toggle){i.tools.toggle.addClass("x-tool-collapse-"+h);i.tools.toggle.addClassOnOver("x-tool-collapse-"+h+"-over")}}},getCollapsedEl:function(){if(!this.collapsedEl){if(!this.toolTemplate){var c=new Ext.Template('<div class="x-tool x-tool-{id}">&#160;</div>');c.disableFormats=true;c.compile();Ext.layout.BorderLayout.Region.prototype.toolTemplate=c}this.collapsedEl=this.targetEl.createChild({cls:"x-layout-collapsed x-layout-collapsed-"+this.position,id:this.panel.id+"-xcollapsed"});this.collapsedEl.enableDisplayMode("block");if(this.collapseMode=="mini"){this.collapsedEl.addClass("x-layout-cmini-"+this.position);this.miniCollapsedEl=this.collapsedEl.createChild({cls:"x-layout-mini x-layout-mini-"+this.position,html:"&#160;"});this.miniCollapsedEl.addClassOnOver("x-layout-mini-over");this.collapsedEl.addClassOnOver("x-layout-collapsed-over");this.collapsedEl.on("click",this.onExpandClick,this,{stopEvent:true})}else{if(this.collapsible!==false&&!this.hideCollapseTool){var d=this.expandToolEl=this.toolTemplate.append(this.collapsedEl.dom,{id:"expand-"+this.position},true);
d.addClassOnOver("x-tool-expand-"+this.position+"-over");d.on("click",this.onExpandClick,this,{stopEvent:true})}if(this.floatable!==false||this.titleCollapse){this.collapsedEl.addClassOnOver("x-layout-collapsed-over");this.collapsedEl.on("click",this[this.floatable?"collapseClick":"onExpandClick"],this)}}}return this.collapsedEl},onExpandClick:function(b){if(this.isSlid){this.panel.expand(false)}else{this.panel.expand()}},onCollapseClick:function(b){this.panel.collapse()},beforeCollapse:function(g,e){this.lastAnim=e;if(this.splitEl){this.splitEl.hide()}this.getCollapsedEl().show();var d=this.panel.getEl();this.originalZIndex=d.getStyle("z-index");d.setStyle("z-index",100);this.isCollapsed=true;this.layout.layout()},onCollapse:function(b){this.panel.el.setStyle("z-index",1);if(this.lastAnim===false||this.panel.animCollapse===false){this.getCollapsedEl().dom.style.visibility="visible"}else{this.getCollapsedEl().slideIn(this.panel.slideAnchor,{duration:0.2})}this.state.collapsed=true;this.panel.saveState()},beforeExpand:function(d){if(this.isSlid){this.afterSlideIn()}var c=this.getCollapsedEl();this.el.show();if(this.position=="east"||this.position=="west"){this.panel.setSize(undefined,c.getHeight())}else{this.panel.setSize(c.getWidth(),undefined)}c.hide();c.dom.style.visibility="hidden";this.panel.el.setStyle("z-index",this.floatingZIndex)},onExpand:function(){this.isCollapsed=false;if(this.splitEl){this.splitEl.show()}this.layout.layout();this.panel.el.setStyle("z-index",this.originalZIndex);this.state.collapsed=false;this.panel.saveState()},collapseClick:function(b){if(this.isSlid){b.stopPropagation();this.slideIn()}else{b.stopPropagation();this.slideOut()}},onHide:function(){if(this.isCollapsed){this.getCollapsedEl().hide()}else{if(this.splitEl){this.splitEl.hide()}}},onShow:function(){if(this.isCollapsed){this.getCollapsedEl().show()}else{if(this.splitEl){this.splitEl.show()}}},isVisible:function(){return !this.panel.hidden},getMargins:function(){return this.isCollapsed&&this.cmargins?this.cmargins:this.margins},getSize:function(){return this.isCollapsed?this.getCollapsedEl().getSize():this.panel.getSize()},setPanel:function(b){this.panel=b},getMinWidth:function(){return this.minWidth},getMinHeight:function(){return this.minHeight},applyLayoutCollapsed:function(d){var c=this.getCollapsedEl();c.setLeftTop(d.x,d.y);c.setSize(d.width,d.height)},applyLayout:function(b){if(this.isCollapsed){this.applyLayoutCollapsed(b)}else{this.panel.setPosition(b.x,b.y);this.panel.setSize(b.width,b.height)}},beforeSlide:function(){this.panel.beforeEffect()},afterSlide:function(){this.panel.afterEffect()},initAutoHide:function(){if(this.autoHide!==false){if(!this.autoHideHd){this.autoHideSlideTask=new Ext.util.DelayedTask(this.slideIn,this);this.autoHideHd={mouseout:function(b){if(!b.within(this.el,true)){this.autoHideSlideTask.delay(500)}},mouseover:function(b){this.autoHideSlideTask.cancel()},scope:this}}this.el.on(this.autoHideHd);this.collapsedEl.on(this.autoHideHd)}},clearAutoHide:function(){if(this.autoHide!==false){this.el.un("mouseout",this.autoHideHd.mouseout);this.el.un("mouseover",this.autoHideHd.mouseover);this.collapsedEl.un("mouseout",this.autoHideHd.mouseout);this.collapsedEl.un("mouseover",this.autoHideHd.mouseover)}},clearMonitor:function(){Ext.getDoc().un("click",this.slideInIf,this)},slideOut:function(){if(this.isSlid||this.el.hasActiveFx()){return}this.isSlid=true;var d=this.panel.tools,g,e;if(d&&d.toggle){d.toggle.hide()}this.el.show();e=this.panel.collapsed;this.panel.collapsed=false;if(this.position=="east"||this.position=="west"){g=this.panel.deferHeight;this.panel.deferHeight=false;this.panel.setSize(undefined,this.collapsedEl.getHeight());this.panel.deferHeight=g}else{this.panel.setSize(this.collapsedEl.getWidth(),undefined)}this.panel.collapsed=e;this.restoreLT=[this.el.dom.style.left,this.el.dom.style.top];this.el.alignTo(this.collapsedEl,this.getCollapseAnchor());this.el.setStyle("z-index",this.floatingZIndex+2);this.panel.el.replaceClass("x-panel-collapsed","x-panel-floating");
if(this.animFloat!==false){this.beforeSlide();this.el.slideIn(this.getSlideAnchor(),{callback:function(){this.afterSlide();this.initAutoHide();Ext.getDoc().on("click",this.slideInIf,this)},scope:this,block:true})}else{this.initAutoHide();Ext.getDoc().on("click",this.slideInIf,this)}},afterSlideIn:function(){this.clearAutoHide();this.isSlid=false;this.clearMonitor();this.el.setStyle("z-index","");this.panel.el.replaceClass("x-panel-floating","x-panel-collapsed");this.el.dom.style.left=this.restoreLT[0];this.el.dom.style.top=this.restoreLT[1];var b=this.panel.tools;if(b&&b.toggle){b.toggle.show()}},slideIn:function(b){if(!this.isSlid||this.el.hasActiveFx()){Ext.callback(b);return}this.isSlid=false;if(this.animFloat!==false){this.beforeSlide();this.el.slideOut(this.getSlideAnchor(),{callback:function(){this.el.hide();this.afterSlide();this.afterSlideIn();Ext.callback(b)},scope:this,block:true})}else{this.el.hide();this.afterSlideIn()}},slideInIf:function(b){if(!b.within(this.el)){this.slideIn()}},anchors:{west:"left",east:"right",north:"top",south:"bottom"},sanchors:{west:"l",east:"r",north:"t",south:"b"},canchors:{west:"tl-tr",east:"tr-tl",north:"tl-bl",south:"bl-tl"},getAnchor:function(){return this.anchors[this.position]},getCollapseAnchor:function(){return this.canchors[this.position]},getSlideAnchor:function(){return this.sanchors[this.position]},getAlignAdj:function(){var b=this.cmargins;switch(this.position){case"west":return[0,0];break;case"east":return[0,0];break;case"north":return[0,0];break;case"south":return[0,0];break}},getExpandAdj:function(){var c=this.collapsedEl,d=this.cmargins;switch(this.position){case"west":return[-(d.right+c.getWidth()+d.left),0];break;case"east":return[d.right+c.getWidth()+d.left,0];break;case"north":return[0,-(d.top+d.bottom+c.getHeight())];break;case"south":return[0,d.top+d.bottom+c.getHeight()];break}},destroy:function(){if(this.autoHideSlideTask&&this.autoHideSlideTask.cancel){this.autoHideSlideTask.cancel()}Ext.destroyMembers(this,"miniCollapsedEl","collapsedEl","expandToolEl")}};Ext.layout.BorderLayout.SplitRegion=function(d,e,g){Ext.layout.BorderLayout.SplitRegion.superclass.constructor.call(this,d,e,g);this.applyLayout=this.applyFns[g]};Ext.extend(Ext.layout.BorderLayout.SplitRegion,Ext.layout.BorderLayout.Region,{splitTip:"Drag to resize.",collapsibleSplitTip:"Drag to resize. Double click to hide.",useSplitTips:false,splitSettings:{north:{orientation:Ext.SplitBar.VERTICAL,placement:Ext.SplitBar.TOP,maxFn:"getVMaxSize",minProp:"minHeight",maxProp:"maxHeight"},south:{orientation:Ext.SplitBar.VERTICAL,placement:Ext.SplitBar.BOTTOM,maxFn:"getVMaxSize",minProp:"minHeight",maxProp:"maxHeight"},east:{orientation:Ext.SplitBar.HORIZONTAL,placement:Ext.SplitBar.RIGHT,maxFn:"getHMaxSize",minProp:"minWidth",maxProp:"maxWidth"},west:{orientation:Ext.SplitBar.HORIZONTAL,placement:Ext.SplitBar.LEFT,maxFn:"getHMaxSize",minProp:"minWidth",maxProp:"maxWidth"}},applyFns:{west:function(i){if(this.isCollapsed){return this.applyLayoutCollapsed(i)}var h=this.splitEl.dom,e=h.style;this.panel.setPosition(i.x,i.y);var g=h.offsetWidth;e.left=(i.x+i.width-g)+"px";e.top=(i.y)+"px";e.height=Math.max(0,i.height)+"px";this.panel.setSize(i.width-g,i.height)},east:function(i){if(this.isCollapsed){return this.applyLayoutCollapsed(i)}var h=this.splitEl.dom,e=h.style;var g=h.offsetWidth;this.panel.setPosition(i.x+g,i.y);e.left=(i.x)+"px";e.top=(i.y)+"px";e.height=Math.max(0,i.height)+"px";this.panel.setSize(i.width-g,i.height)},north:function(i){if(this.isCollapsed){return this.applyLayoutCollapsed(i)}var h=this.splitEl.dom,e=h.style;var g=h.offsetHeight;this.panel.setPosition(i.x,i.y);e.left=(i.x)+"px";e.top=(i.y+i.height-g)+"px";e.width=Math.max(0,i.width)+"px";this.panel.setSize(i.width,i.height-g)},south:function(i){if(this.isCollapsed){return this.applyLayoutCollapsed(i)}var h=this.splitEl.dom,e=h.style;var g=h.offsetHeight;this.panel.setPosition(i.x,i.y+g);e.left=(i.x)+"px";e.top=(i.y)+"px";e.width=Math.max(0,i.width)+"px";
this.panel.setSize(i.width,i.height-g)}},render:function(g,i){Ext.layout.BorderLayout.SplitRegion.superclass.render.call(this,g,i);var h=this.position;this.splitEl=g.createChild({cls:"x-layout-split x-layout-split-"+h,html:"&#160;",id:this.panel.id+"-xsplit"});if(this.collapseMode=="mini"){this.miniSplitEl=this.splitEl.createChild({cls:"x-layout-mini x-layout-mini-"+h,html:"&#160;"});this.miniSplitEl.addClassOnOver("x-layout-mini-over");this.miniSplitEl.on("click",this.onCollapseClick,this,{stopEvent:true})}var e=this.splitSettings[h];this.split=new Ext.SplitBar(this.splitEl.dom,i.el,e.orientation);this.split.tickSize=this.tickSize;this.split.placement=e.placement;this.split.getMaximumSize=this[e.maxFn].createDelegate(this);this.split.minSize=this.minSize||this[e.minProp];this.split.on("beforeapply",this.onSplitMove,this);this.split.useShim=this.useShim===true;this.maxSize=this.maxSize||this[e.maxProp];if(i.hidden){this.splitEl.hide()}if(this.useSplitTips){this.splitEl.dom.title=this.collapsible?this.collapsibleSplitTip:this.splitTip}if(this.collapsible){this.splitEl.on("dblclick",this.onCollapseClick,this)}},getSize:function(){if(this.isCollapsed){return this.collapsedEl.getSize()}var b=this.panel.getSize();if(this.position=="north"||this.position=="south"){b.height+=this.splitEl.dom.offsetHeight}else{b.width+=this.splitEl.dom.offsetWidth}return b},getHMaxSize:function(){var c=this.maxSize||10000;var d=this.layout.center;return Math.min(c,(this.el.getWidth()+d.el.getWidth())-d.getMinWidth())},getVMaxSize:function(){var c=this.maxSize||10000;var d=this.layout.center;return Math.min(c,(this.el.getHeight()+d.el.getHeight())-d.getMinHeight())},onSplitMove:function(d,e){var g=this.panel.getSize();this.lastSplitSize=e;if(this.position=="north"||this.position=="south"){this.panel.setSize(g.width,e);this.state.height=e}else{this.panel.setSize(e,g.height);this.state.width=e}this.layout.layout();this.panel.saveState();return false},getSplitBar:function(){return this.split},destroy:function(){Ext.destroy(this.miniSplitEl,this.split,this.splitEl);Ext.layout.BorderLayout.SplitRegion.superclass.destroy.call(this)}});Ext.Container.LAYOUTS.border=Ext.layout.BorderLayout;Ext.layout.FormLayout=Ext.extend(Ext.layout.AnchorLayout,{labelSeparator:":",trackLabels:true,type:"form",onRemove:function(g){Ext.layout.FormLayout.superclass.onRemove.call(this,g);if(this.trackLabels){g.un("show",this.onFieldShow,this);g.un("hide",this.onFieldHide,this)}var c=g.getPositionEl(),e=g.getItemCt&&g.getItemCt();if(g.rendered&&e){if(c&&c.dom){c.insertAfter(e)}Ext.destroy(e);Ext.destroyMembers(g,"label","itemCt");if(g.customItemCt){Ext.destroyMembers(g,"getItemCt","customItemCt")}}},setContainer:function(d){Ext.layout.FormLayout.superclass.setContainer.call(this,d);if(d.labelAlign){d.addClass("x-form-label-"+d.labelAlign)}if(d.hideLabels){Ext.apply(this,{labelStyle:"display:none",elementStyle:"padding-left:0;",labelAdjust:0})}else{this.labelSeparator=Ext.isDefined(d.labelSeparator)?d.labelSeparator:this.labelSeparator;d.labelWidth=d.labelWidth||100;if(Ext.isNumber(d.labelWidth)){var c=Ext.isNumber(d.labelPad)?d.labelPad:5;Ext.apply(this,{labelAdjust:d.labelWidth+c,labelStyle:"width:"+d.labelWidth+"px;",elementStyle:"padding-left:"+(d.labelWidth+c)+"px"})}if(d.labelAlign=="top"){Ext.apply(this,{labelStyle:"width:auto;",labelAdjust:0,elementStyle:"padding-left:0;"})}}},isHide:function(b){return b.hideLabel||this.container.hideLabels},onFieldShow:function(b){b.getItemCt().removeClass("x-hide-"+b.hideMode);if(b.isComposite){b.doLayout()}},onFieldHide:function(b){b.getItemCt().addClass("x-hide-"+b.hideMode)},getLabelStyle:function(i){var g="",l=[this.labelStyle,i];for(var k=0,h=l.length;k<h;++k){if(l[k]){g+=l[k];if(g.substr(-1,1)!=";"){g+=";"}}}return g},renderItem:function(h,g,i){if(h&&(h.isFormField||h.fieldLabel)&&h.inputType!="hidden"){var c=this.getTemplateArgs(h);if(Ext.isNumber(g)){g=i.dom.childNodes[g]||null}if(g){h.itemCt=this.fieldTpl.insertBefore(g,c,true)}else{h.itemCt=this.fieldTpl.append(i,c,true)
}if(!h.getItemCt){Ext.apply(h,{getItemCt:function(){return h.itemCt},customItemCt:true})}h.label=h.getItemCt().child("label.x-form-item-label");if(!h.rendered){h.render("x-form-el-"+h.id)}else{if(!this.isValidParent(h,i)){Ext.fly("x-form-el-"+h.id).appendChild(h.getPositionEl())}}if(this.trackLabels){if(h.hidden){this.onFieldHide(h)}h.on({scope:this,show:this.onFieldShow,hide:this.onFieldHide})}this.configureItem(h)}else{Ext.layout.FormLayout.superclass.renderItem.apply(this,arguments)}},getTemplateArgs:function(c){var d=!c.fieldLabel||c.hideLabel;return{id:c.id,label:c.fieldLabel,itemCls:(c.itemCls||this.container.itemCls||"")+(c.hideLabel?" x-hide-label":""),clearCls:c.clearCls||"x-form-clear-left",labelStyle:this.getLabelStyle(c.labelStyle),elementStyle:this.elementStyle||"",labelSeparator:d?"":(Ext.isDefined(c.labelSeparator)?c.labelSeparator:this.labelSeparator)}},adjustWidthAnchor:function(e,g){if(g.label&&!this.isHide(g)&&(this.container.labelAlign!="top")){var c=Ext.isIE6||(Ext.isIE&&!Ext.isStrict);return e-this.labelAdjust+(c?-3:0)}return e},adjustHeightAnchor:function(d,c){if(c.label&&!this.isHide(c)&&(this.container.labelAlign=="top")){return d-c.label.getHeight()}return d},isValidParent:function(c,d){return d&&this.container.getEl().contains(c.getPositionEl())}});Ext.Container.LAYOUTS.form=Ext.layout.FormLayout;Ext.layout.AccordionLayout=Ext.extend(Ext.layout.FitLayout,{fill:true,autoWidth:true,titleCollapse:true,hideCollapseTool:false,collapseFirst:false,animate:false,sequence:false,activeOnTop:false,type:"accordion",renderItem:function(b){if(this.animate===false){b.animCollapse=false}b.collapsible=true;if(this.autoWidth){b.autoWidth=true}if(this.titleCollapse){b.titleCollapse=true}if(this.hideCollapseTool){b.hideCollapseTool=true}if(this.collapseFirst!==undefined){b.collapseFirst=this.collapseFirst}if(!this.activeItem&&!b.collapsed){this.setActiveItem(b,true)}else{if(this.activeItem&&this.activeItem!=b){b.collapsed=true}}Ext.layout.AccordionLayout.superclass.renderItem.apply(this,arguments);b.header.addClass("x-accordion-hd");b.on("beforeexpand",this.beforeExpand,this)},onRemove:function(b){Ext.layout.AccordionLayout.superclass.onRemove.call(this,b);if(b.rendered){b.header.removeClass("x-accordion-hd")}b.un("beforeexpand",this.beforeExpand,this)},beforeExpand:function(g,d){var e=this.activeItem;if(e){if(this.sequence){delete this.activeItem;if(!e.collapsed){e.collapse({callback:function(){g.expand(d||true)},scope:this});return false}}else{e.collapse(this.animate)}}this.setActive(g);if(this.activeOnTop){g.el.dom.parentNode.insertBefore(g.el.dom,g.el.dom.parentNode.firstChild)}this.layout()},setItemSize:function(m,n){if(this.fill&&m){var o=0,p,i=this.getRenderedItems(this.container),k=i.length,l;for(p=0;p<k;p++){if((l=i[p])!=m&&!l.hidden){o+=l.header.getHeight()}}n.height-=o;m.setSize(n)}},setActiveItem:function(b){this.setActive(b,true)},setActive:function(g,d){var e=this.activeItem;g=this.container.getComponent(g);if(e!=g){if(g.rendered&&g.collapsed&&d){g.expand()}else{if(e){e.fireEvent("deactivate",e)}this.activeItem=g;g.fireEvent("activate",g)}}}});Ext.Container.LAYOUTS.accordion=Ext.layout.AccordionLayout;Ext.layout.Accordion=Ext.layout.AccordionLayout;Ext.layout.TableLayout=Ext.extend(Ext.layout.ContainerLayout,{monitorResize:false,type:"table",targetCls:"x-table-layout-ct",tableAttrs:null,setContainer:function(b){Ext.layout.TableLayout.superclass.setContainer.call(this,b);this.currentRow=0;this.currentColumn=0;this.cells=[]},onLayout:function(n,l){var m=n.items.items,i=m.length,k,c;if(!this.table){l.addClass("x-table-layout-ct");this.table=l.createChild(Ext.apply({tag:"table",cls:"x-table-layout",cellspacing:0,cn:{tag:"tbody"}},this.tableAttrs),null,true)}this.renderAll(n,l)},getRow:function(d){var c=this.table.tBodies[0].childNodes[d];if(!c){c=document.createElement("tr");this.table.tBodies[0].appendChild(c)}return c},getNextCell:function(m){var l=this.getNextNonSpan(this.currentColumn,this.currentRow);var p=this.currentColumn=l[0],q=this.currentRow=l[1];
for(var n=q;n<q+(m.rowspan||1);n++){if(!this.cells[n]){this.cells[n]=[]}for(var s=p;s<p+(m.colspan||1);s++){this.cells[n][s]=true}}var o=document.createElement("td");if(m.cellId){o.id=m.cellId}var c="x-table-layout-cell";if(m.cellCls){c+=" "+m.cellCls}o.className=c;if(m.colspan){o.colSpan=m.colspan}if(m.rowspan){o.rowSpan=m.rowspan}this.getRow(q).appendChild(o);return o},getNextNonSpan:function(e,g){var d=this.columns;while((d&&e>=d)||(this.cells[g]&&this.cells[g][e])){if(d&&e>=d){g++;e=0}else{e++}}return[e,g]},renderItem:function(h,g,i){if(!this.table){this.table=i.createChild(Ext.apply({tag:"table",cls:"x-table-layout",cellspacing:0,cn:{tag:"tbody"}},this.tableAttrs),null,true)}if(h&&!h.rendered){h.render(this.getNextCell(h));this.configureItem(h)}else{if(h&&!this.isValidParent(h,i)){var c=this.getNextCell(h);c.insertBefore(h.getPositionEl().dom,null);h.container=Ext.get(c);this.configureItem(h)}}},isValidParent:function(c,d){return c.getPositionEl().up("table",5).dom.parentNode===(d.dom||d)},destroy:function(){delete this.table;Ext.layout.TableLayout.superclass.destroy.call(this)}});Ext.Container.LAYOUTS.table=Ext.layout.TableLayout;Ext.layout.AbsoluteLayout=Ext.extend(Ext.layout.AnchorLayout,{extraCls:"x-abs-layout-item",type:"absolute",onLayout:function(d,c){c.position();this.paddingLeft=c.getPadding("l");this.paddingTop=c.getPadding("t");Ext.layout.AbsoluteLayout.superclass.onLayout.call(this,d,c)},adjustWidthAnchor:function(c,d){return c?c-d.getPosition(true)[0]+this.paddingLeft:c},adjustHeightAnchor:function(c,d){return c?c-d.getPosition(true)[1]+this.paddingTop:c}});Ext.Container.LAYOUTS.absolute=Ext.layout.AbsoluteLayout;Ext.layout.BoxLayout=Ext.extend(Ext.layout.ContainerLayout,{defaultMargins:{left:0,top:0,right:0,bottom:0},padding:"0",pack:"start",monitorResize:true,type:"box",scrollOffset:0,extraCls:"x-box-item",targetCls:"x-box-layout-ct",innerCls:"x-box-inner",constructor:function(g){Ext.layout.BoxLayout.superclass.constructor.call(this,g);if(Ext.isString(this.defaultMargins)){this.defaultMargins=this.parseMargins(this.defaultMargins)}var h=this.overflowHandler;if(typeof h=="string"){h={type:h}}var i="none";if(h&&h.type!=undefined){i=h.type}var e=Ext.layout.boxOverflow[i];if(e[this.type]){e=e[this.type]}this.overflowHandler=new e(this,h)},onLayout:function(v,p){Ext.layout.BoxLayout.superclass.onLayout.call(this,v,p);var t=this.getLayoutTargetSize(),o=this.getVisibleItems(v),u=this.calculateChildBoxes(o,t),q=u.boxes,n=u.meta;if(t.width>0){var m=this.overflowHandler,w=n.tooNarrow?"handleOverflow":"clearOverflow";var s=m[w](u,t);if(s){if(s.targetSize){t=s.targetSize}if(s.recalculate){o=this.getVisibleItems(v);u=this.calculateChildBoxes(o,t);q=u.boxes}}}this.layoutTargetLastSize=t;this.childBoxCache=u;this.updateInnerCtSize(t,u);this.updateChildBoxes(q);this.handleTargetOverflow(t,v,p)},updateChildBoxes:function(l){for(var g=0,i=l.length;g<i;g++){var k=l[g],h=k.component;if(k.dirtySize){h.setSize(k.width,k.height)}if(isNaN(k.left)||isNaN(k.top)){continue}h.setPosition(k.left,k.top)}},updateInnerCtSize:function(s,n){var m=this.align,o=this.padding,p=s.width,l=s.height;if(this.type=="hbox"){var k=p,q=n.meta.maxHeight+o.top+o.bottom;if(m=="stretch"){q=l}else{if(m=="middle"){q=Math.max(l,q)}}}else{var q=l,k=n.meta.maxWidth+o.left+o.right;if(m=="stretch"){k=p}else{if(m=="center"){k=Math.max(p,k)}}}this.innerCt.setSize(k||undefined,q||undefined)},handleTargetOverflow:function(k,h,l){var i=l.getStyle("overflow");if(i&&i!="hidden"&&!this.adjustmentPass){var g=this.getLayoutTargetSize();if(g.width!=k.width||g.height!=k.height){this.adjustmentPass=true;this.onLayout(h,l)}}delete this.adjustmentPass},isValidParent:function(c,d){return this.innerCt&&c.getPositionEl().dom.parentNode==this.innerCt.dom},getVisibleItems:function(n){var n=n||this.container,o=n.getLayoutTarget(),m=n.items.items,i=m.length,p,l,c=[];for(p=0;p<i;p++){if((l=m[p]).rendered&&this.isValidParent(l,o)&&l.hidden!==true&&l.collapsed!==true&&l.shouldLayout!==false){c.push(l)
}}return c},renderAll:function(d,c){if(!this.innerCt){this.innerCt=c.createChild({cls:this.innerCls});this.padding=this.parseMargins(this.padding)}Ext.layout.BoxLayout.superclass.renderAll.call(this,d,this.innerCt)},getLayoutTargetSize:function(){var c=this.container.getLayoutTarget(),d;if(c){d=c.getViewSize();if(Ext.isIE&&Ext.isStrict&&d.width==0){d=c.getStyleSize()}d.width-=c.getPadding("lr");d.height-=c.getPadding("tb")}return d},renderItem:function(b){if(Ext.isString(b.margins)){b.margins=this.parseMargins(b.margins)}else{if(!b.margins){b.margins=this.defaultMargins}}Ext.layout.BoxLayout.superclass.renderItem.apply(this,arguments)},destroy:function(){Ext.destroy(this.overflowHandler);Ext.layout.BoxLayout.superclass.destroy.apply(this,arguments)}});Ext.ns("Ext.layout.boxOverflow");Ext.layout.boxOverflow.None=Ext.extend(Object,{constructor:function(c,d){this.layout=c;Ext.apply(this,d||{})},handleOverflow:Ext.emptyFn,clearOverflow:Ext.emptyFn});Ext.layout.boxOverflow.none=Ext.layout.boxOverflow.None;Ext.layout.boxOverflow.Menu=Ext.extend(Ext.layout.boxOverflow.None,{afterCls:"x-strip-right",noItemsMenuText:'<div class="x-toolbar-no-items">(None)</div>',constructor:function(b){Ext.layout.boxOverflow.Menu.superclass.constructor.apply(this,arguments);this.menuItems=[]},createInnerElements:function(){if(!this.afterCt){this.afterCt=this.layout.innerCt.insertSibling({cls:this.afterCls},"before")}},clearOverflow:function(i,k){var l=k.width+(this.afterCt?this.afterCt.getWidth():0),h=this.menuItems;this.hideTrigger();for(var n=0,m=h.length;n<m;n++){h.pop().component.show()}return{targetSize:{height:k.height,width:l}}},showTrigger:function(){this.createMenu();this.menuTrigger.show()},hideTrigger:function(){if(this.menuTrigger!=undefined){this.menuTrigger.hide()}},beforeMenuShow:function(l){var i=this.menuItems,k=i.length,m,n;var p=function(a,b){return a.isXType("buttongroup")&&!(b instanceof Ext.Toolbar.Separator)};this.clearMenu();l.removeAll();for(var o=0;o<k;o++){m=i[o].component;if(n&&(p(m,n)||p(n,m))){l.add("-")}this.addComponentToMenu(l,m);n=m}if(l.items.length<1){l.add(this.noItemsMenuText)}},createMenuConfig:function(i,g){var e=Ext.apply({},i.initialConfig),h=i.toggleGroup;Ext.copyTo(e,i,["iconCls","icon","itemId","disabled","handler","scope","menu"]);Ext.apply(e,{text:i.overflowText||i.text,hideOnClick:g});if(h||i.enableToggle){Ext.apply(e,{group:h,checked:i.pressed,listeners:{checkchange:function(a,b){i.toggle(b)}}})}delete e.ownerCt;delete e.xtype;delete e.id;return e},addComponentToMenu:function(c,d){if(d instanceof Ext.Toolbar.Separator){c.add("-")}else{if(Ext.isFunction(d.isXType)){if(d.isXType("splitbutton")){c.add(this.createMenuConfig(d,true))}else{if(d.isXType("button")){c.add(this.createMenuConfig(d,!d.menu))}else{if(d.isXType("buttongroup")){d.items.each(function(a){this.addComponentToMenu(c,a)},this)}}}}}},clearMenu:function(){var b=this.moreMenu;if(b&&b.items){b.items.each(function(a){delete a.menu})}},createMenu:function(){if(!this.menuTrigger){this.createInnerElements();this.menu=new Ext.menu.Menu({ownerCt:this.layout.container,listeners:{scope:this,beforeshow:this.beforeMenuShow}});this.menuTrigger=new Ext.Button({iconCls:"x-toolbar-more-icon",cls:"x-toolbar-more",menu:this.menu,renderTo:this.afterCt})}},destroy:function(){Ext.destroy(this.menu,this.menuTrigger)}});Ext.layout.boxOverflow.menu=Ext.layout.boxOverflow.Menu;Ext.layout.boxOverflow.HorizontalMenu=Ext.extend(Ext.layout.boxOverflow.Menu,{constructor:function(){Ext.layout.boxOverflow.HorizontalMenu.superclass.constructor.apply(this,arguments);var g=this,d=g.layout,e=d.calculateChildBoxes;d.calculateChildBoxes=function(s,n){var a=e.apply(d,arguments),b=a.meta,q=g.menuItems;var c=0;for(var p=0,o=q.length;p<o;p++){c+=q[p].width}b.minimumWidth+=c;b.tooNarrow=b.minimumWidth>n.width;return a}},handleOverflow:function(D,A){this.showTrigger();var y=A.width-this.afterCt.getWidth(),x=D.boxes,C=0,H=false;for(var u=0,E=x.length;u<E;u++){C+=x[u].width}var G=y-C,B=0;for(var u=0,E=this.menuItems.length;
u<E;u++){var v=this.menuItems[u],w=v.component,F=v.width;if(F<G){w.show();G-=F;B++;H=true}else{break}}if(H){this.menuItems=this.menuItems.slice(B)}else{for(var z=x.length-1;z>=0;z--){var I=x[z].component,i=x[z].left+x[z].width;if(i>=y){this.menuItems.unshift({component:I,width:x[z].width});I.hide()}else{break}}}if(this.menuItems.length==0){this.hideTrigger()}return{targetSize:{height:A.height,width:y},recalculate:H}}});Ext.layout.boxOverflow.menu.hbox=Ext.layout.boxOverflow.HorizontalMenu;Ext.layout.boxOverflow.Scroller=Ext.extend(Ext.layout.boxOverflow.None,{animateScroll:true,scrollIncrement:100,wheelIncrement:3,scrollRepeatInterval:400,scrollDuration:0.4,beforeCls:"x-strip-left",afterCls:"x-strip-right",scrollerCls:"x-strip-scroller",beforeScrollerCls:"x-strip-scroller-left",afterScrollerCls:"x-strip-scroller-right",createWheelListener:function(){this.layout.innerCt.on({scope:this,mousewheel:function(b){b.stopEvent();this.scrollBy(b.getWheelDelta()*this.wheelIncrement*-1,false)}})},handleOverflow:function(d,c){this.createInnerElements();this.showScrollers()},clearOverflow:function(){this.hideScrollers()},showScrollers:function(){this.createScrollers();this.beforeScroller.show();this.afterScroller.show();this.updateScrollButtons()},hideScrollers:function(){if(this.beforeScroller!=undefined){this.beforeScroller.hide();this.afterScroller.hide()}},createScrollers:function(){if(!this.beforeScroller&&!this.afterScroller){var d=this.beforeCt.createChild({cls:String.format("{0} {1} ",this.scrollerCls,this.beforeScrollerCls)});var c=this.afterCt.createChild({cls:String.format("{0} {1}",this.scrollerCls,this.afterScrollerCls)});d.addClassOnOver(this.beforeScrollerCls+"-hover");c.addClassOnOver(this.afterScrollerCls+"-hover");d.setVisibilityMode(Ext.Element.DISPLAY);c.setVisibilityMode(Ext.Element.DISPLAY);this.beforeRepeater=new Ext.util.ClickRepeater(d,{interval:this.scrollRepeatInterval,handler:this.scrollLeft,scope:this});this.afterRepeater=new Ext.util.ClickRepeater(c,{interval:this.scrollRepeatInterval,handler:this.scrollRight,scope:this});this.beforeScroller=d;this.afterScroller=c}},destroy:function(){Ext.destroy(this.beforeScroller,this.afterScroller,this.beforeRepeater,this.afterRepeater,this.beforeCt,this.afterCt)},scrollBy:function(c,d){this.scrollTo(this.getScrollPosition()+c,d)},getItem:function(b){if(Ext.isString(b)){b=Ext.getCmp(b)}else{if(Ext.isNumber(b)){b=this.items[b]}}return b},getScrollAnim:function(){return{duration:this.scrollDuration,callback:this.updateScrollButtons,scope:this}},updateScrollButtons:function(){if(this.beforeScroller==undefined||this.afterScroller==undefined){return}var h=this.atExtremeBefore()?"addClass":"removeClass",i=this.atExtremeAfter()?"addClass":"removeClass",g=this.beforeScrollerCls+"-disabled",e=this.afterScrollerCls+"-disabled";this.beforeScroller[h](g);this.afterScroller[i](e);this.scrolling=false},atExtremeBefore:function(){return this.getScrollPosition()===0},scrollLeft:function(b){this.scrollBy(-this.scrollIncrement,b)},scrollRight:function(b){this.scrollBy(this.scrollIncrement,b)},scrollToItem:function(k,g){k=this.getItem(k);if(k!=undefined){var h=this.getItemVisibility(k);if(!h.fullyVisible){var l=k.getBox(true,true),i=l.x;if(h.hiddenRight){i-=(this.layout.innerCt.getWidth()-l.width)}this.scrollTo(i,g)}}},getItemVisibility:function(l){var m=this.getItem(l).getBox(true,true),i=m.x,n=m.x+m.width,k=this.getScrollPosition(),h=this.layout.innerCt.getWidth()+k;return{hiddenLeft:i<k,hiddenRight:n>h,fullyVisible:i>k&&n<h}}});Ext.layout.boxOverflow.scroller=Ext.layout.boxOverflow.Scroller;Ext.layout.boxOverflow.VerticalScroller=Ext.extend(Ext.layout.boxOverflow.Scroller,{scrollIncrement:75,wheelIncrement:2,handleOverflow:function(d,c){Ext.layout.boxOverflow.VerticalScroller.superclass.handleOverflow.apply(this,arguments);return{targetSize:{height:c.height-(this.beforeCt.getHeight()+this.afterCt.getHeight()),width:c.width}}},createInnerElements:function(){var b=this.layout.innerCt;if(!this.beforeCt){this.beforeCt=b.insertSibling({cls:this.beforeCls},"before");
this.afterCt=b.insertSibling({cls:this.afterCls},"after");this.createWheelListener()}},scrollTo:function(g,e){var h=this.getScrollPosition(),i=g.constrain(0,this.getMaxScrollBottom());if(i!=h&&!this.scrolling){if(e==undefined){e=this.animateScroll}this.layout.innerCt.scrollTo("top",i,e?this.getScrollAnim():false);if(e){this.scrolling=true}else{this.scrolling=false;this.updateScrollButtons()}}},getScrollPosition:function(){return parseInt(this.layout.innerCt.dom.scrollTop,10)||0},getMaxScrollBottom:function(){return this.layout.innerCt.dom.scrollHeight-this.layout.innerCt.getHeight()},atExtremeAfter:function(){return this.getScrollPosition()>=this.getMaxScrollBottom()}});Ext.layout.boxOverflow.scroller.vbox=Ext.layout.boxOverflow.VerticalScroller;Ext.layout.boxOverflow.HorizontalScroller=Ext.extend(Ext.layout.boxOverflow.Scroller,{handleOverflow:function(d,c){Ext.layout.boxOverflow.HorizontalScroller.superclass.handleOverflow.apply(this,arguments);return{targetSize:{height:c.height,width:c.width-(this.beforeCt.getWidth()+this.afterCt.getWidth())}}},createInnerElements:function(){var b=this.layout.innerCt;if(!this.beforeCt){this.afterCt=b.insertSibling({cls:this.afterCls},"before");this.beforeCt=b.insertSibling({cls:this.beforeCls},"before");this.createWheelListener()}},scrollTo:function(g,e){var h=this.getScrollPosition(),i=g.constrain(0,this.getMaxScrollRight());if(i!=h&&!this.scrolling){if(e==undefined){e=this.animateScroll}this.layout.innerCt.scrollTo("left",i,e?this.getScrollAnim():false);if(e){this.scrolling=true}else{this.scrolling=false;this.updateScrollButtons()}}},getScrollPosition:function(){return parseInt(this.layout.innerCt.dom.scrollLeft,10)||0},getMaxScrollRight:function(){return this.layout.innerCt.dom.scrollWidth-this.layout.innerCt.getWidth()},atExtremeAfter:function(){return this.getScrollPosition()>=this.getMaxScrollRight()}});Ext.layout.boxOverflow.scroller.hbox=Ext.layout.boxOverflow.HorizontalScroller;Ext.layout.HBoxLayout=Ext.extend(Ext.layout.BoxLayout,{align:"top",type:"hbox",calculateChildBoxes:function(aG,aU){var ar=aG.length,af=this.padding,au=af.top,ac=af.left,az=au+af.bottom,ai=ac+af.right,aV=aU.width-this.scrollOffset,aR=aU.height,aJ=Math.max(0,aR-az),ah=this.pack=="start",aa=this.pack=="center",ax=this.pack=="end",al=0,ag=0,ad=0,aM=0,i=0,ap=[],aN,an,ak,ab,aB,aO,ae,ao,aT,aA,aH,aj;for(ae=0;ae<ar;ae++){aN=aG[ae];ak=aN.height;an=aN.width;aO=!aN.hasLayout&&typeof aN.doLayout=="function";if(typeof an!="number"){if(aN.flex&&!an){ad+=aN.flex}else{if(!an&&aO){aN.doLayout()}ab=aN.getSize();an=ab.width;ak=ab.height}}aB=aN.margins;aA=aB.left+aB.right;al+=aA+(an||0);aM+=aA+(aN.flex?aN.minWidth||0:an);i+=aA+(aN.minWidth||an||0);if(typeof ak!="number"){if(aO){aN.doLayout()}ak=aN.getHeight()}ag=Math.max(ag,ak+aB.top+aB.bottom);ap.push({component:aN,height:ak||undefined,width:an||undefined})}var am=aM-aV,aI=i>aV;var aK=Math.max(0,aV-al-ai);if(aI){for(ae=0;ae<ar;ae++){ap[ae].width=aG[ae].minWidth||aG[ae].width||ap[ae].width}}else{if(am>0){var av=[];for(var at=0,aC=ar;at<aC;at++){var aw=aG[at],aE=aw.minWidth||0;if(aw.flex){ap[at].width=aE}else{av.push({minWidth:aE,available:ap[at].width-aE,index:at})}}av.sort(function(b,a){return b.available>a.available?1:-1});for(var ae=0,aC=av.length;ae<aC;ae++){var aq=av[ae].index;if(aq==undefined){continue}var aw=aG[aq],aL=ap[aq],aD=aL.width,aE=aw.minWidth,aS=Math.max(aE,aD-Math.ceil(am/(aC-ae))),aQ=aD-aS;ap[aq].width=aS;am-=aQ}}else{var aP=aK,aF=ad;for(ae=0;ae<ar;ae++){aN=aG[ae];ao=ap[ae];aB=aN.margins;aH=aB.top+aB.bottom;if(ah&&aN.flex&&!aN.width){aT=Math.ceil((aN.flex/aF)*aP);aP-=aT;aF-=aN.flex;ao.width=aT;ao.dirtySize=true}}}}if(aa){ac+=aK/2}else{if(ax){ac+=aK}}for(ae=0;ae<ar;ae++){aN=aG[ae];ao=ap[ae];aB=aN.margins;ac+=aB.left;aH=aB.top+aB.bottom;ao.left=ac;ao.top=au+aB.top;switch(this.align){case"stretch":aj=aJ-aH;ao.height=aj.constrain(aN.minHeight||0,aN.maxHeight||1000000);ao.dirtySize=true;break;case"stretchmax":aj=ag-aH;ao.height=aj.constrain(aN.minHeight||0,aN.maxHeight||1000000);
ao.dirtySize=true;break;case"middle":var ay=aJ-ao.height-aH;if(ay>0){ao.top=au+aH+(ay/2)}}ac+=ao.width+aB.right}return{boxes:ap,meta:{maxHeight:ag,nonFlexWidth:al,desiredWidth:aM,minimumWidth:i,shortfall:aM-aV,tooNarrow:aI}}}});Ext.Container.LAYOUTS.hbox=Ext.layout.HBoxLayout;Ext.layout.VBoxLayout=Ext.extend(Ext.layout.BoxLayout,{align:"left",type:"vbox",calculateChildBoxes:function(aI,aU){var ar=aI.length,ae=this.padding,au=ae.top,ab=ae.left,az=au+ae.bottom,ah=ab+ae.right,aV=aU.width-this.scrollOffset,aS=aU.height,al=Math.max(0,aV-ah),ag=this.pack=="start",i=this.pack=="center",ax=this.pack=="end",aM=0,aC=0,ac=0,ak=0,aK=0,ap=[],aO,an,ai,aa,aD,aP,ad,ao,aT,aA,aJ,aR;for(ad=0;ad<ar;ad++){aO=aI[ad];ai=aO.height;an=aO.width;aP=!aO.hasLayout&&typeof aO.doLayout=="function";if(typeof ai!="number"){if(aO.flex&&!ai){ac+=aO.flex}else{if(!ai&&aP){aO.doLayout()}aa=aO.getSize();an=aa.width;ai=aa.height}}aD=aO.margins;aJ=aD.top+aD.bottom;aM+=aJ+(ai||0);ak+=aJ+(aO.flex?aO.minHeight||0:ai);aK+=aJ+(aO.minHeight||ai||0);if(typeof an!="number"){if(aP){aO.doLayout()}an=aO.getWidth()}aC=Math.max(aC,an+aD.left+aD.right);ap.push({component:aO,height:ai||undefined,width:an||undefined})}var aj=ak-aS,aL=aK>aS;var aG=Math.max(0,(aS-aM-az));if(aL){for(ad=0,aF=ar;ad<aF;ad++){ap[ad].height=aI[ad].minHeight||aI[ad].height||ap[ad].height}}else{if(aj>0){var am=[];for(var at=0,aF=ar;at<aF;at++){var aw=aI[at],aE=aw.minHeight||0;if(aw.flex){ap[at].height=aE}else{am.push({minHeight:aE,available:ap[at].height-aE,index:at})}}am.sort(function(b,a){return b.available>a.available?1:-1});for(var ad=0,aF=am.length;ad<aF;ad++){var aq=am[ad].index;if(aq==undefined){continue}var aw=aI[aq],aN=ap[aq],aB=aN.height,aE=aw.minHeight,av=Math.max(aE,aB-Math.ceil(aj/(aF-ad))),aQ=aB-av;ap[aq].height=av;aj-=aQ}}else{var af=aG,aH=ac;for(ad=0;ad<ar;ad++){aO=aI[ad];ao=ap[ad];aD=aO.margins;aA=aD.left+aD.right;if(ag&&aO.flex&&!aO.height){flexedHeight=Math.ceil((aO.flex/aH)*af);af-=flexedHeight;aH-=aO.flex;ao.height=flexedHeight;ao.dirtySize=true}}}}if(i){au+=aG/2}else{if(ax){au+=aG}}for(ad=0;ad<ar;ad++){aO=aI[ad];ao=ap[ad];aD=aO.margins;au+=aD.top;aA=aD.left+aD.right;ao.left=ab+aD.left;ao.top=au;switch(this.align){case"stretch":aR=al-aA;ao.width=aR.constrain(aO.minWidth||0,aO.maxWidth||1000000);ao.dirtySize=true;break;case"stretchmax":aR=aC-aA;ao.width=aR.constrain(aO.minWidth||0,aO.maxWidth||1000000);ao.dirtySize=true;break;case"center":var ay=al-ao.width-aA;if(ay>0){ao.left=ab+aA+(ay/2)}}au+=ao.height+aD.bottom}return{boxes:ap,meta:{maxWidth:aC,nonFlexHeight:aM,desiredHeight:ak,minimumHeight:aK,shortfall:ak-aS,tooNarrow:aL}}}});Ext.Container.LAYOUTS.vbox=Ext.layout.VBoxLayout;Ext.layout.ToolbarLayout=Ext.extend(Ext.layout.ContainerLayout,{monitorResize:true,type:"toolbar",triggerWidth:18,noItemsMenuText:'<div class="x-toolbar-no-items">(None)</div>',lastOverflow:false,tableHTML:['<table cellspacing="0" class="x-toolbar-ct">',"<tbody>","<tr>",'<td class="x-toolbar-left" align="{0}">','<table cellspacing="0">',"<tbody>",'<tr class="x-toolbar-left-row"></tr>',"</tbody>","</table>","</td>",'<td class="x-toolbar-right" align="right">','<table cellspacing="0" class="x-toolbar-right-ct">',"<tbody>","<tr>","<td>",'<table cellspacing="0">',"<tbody>",'<tr class="x-toolbar-right-row"></tr>',"</tbody>","</table>","</td>","<td>",'<table cellspacing="0">',"<tbody>",'<tr class="x-toolbar-extras-row"></tr>',"</tbody>","</table>","</td>","</tr>","</tbody>","</table>","</td>","</tr>","</tbody>","</table>"].join(""),onLayout:function(t,p){if(!this.leftTr){var q=t.buttonAlign=="center"?"center":"left";p.addClass("x-toolbar-layout-ct");p.insertHtml("beforeEnd",String.format(this.tableHTML,q));this.leftTr=p.child("tr.x-toolbar-left-row",true);this.rightTr=p.child("tr.x-toolbar-right-row",true);this.extrasTr=p.child("tr.x-toolbar-extras-row",true);if(this.hiddenItem==undefined){this.hiddenItems=[]}}var o=t.buttonAlign=="right"?this.rightTr:this.leftTr,i=t.items.items,u=0;for(var v=0,s=i.length,c;v<s;v++,u++){c=i[v];
if(c.isFill){o=this.rightTr;u=-1}else{if(!c.rendered){c.render(this.insertCell(c,o,u));this.configureItem(c)}else{if(!c.xtbHidden&&!this.isValidParent(c,o.childNodes[u])){var w=this.insertCell(c,o,u);w.appendChild(c.getPositionEl().dom);c.container=Ext.get(w)}}}}this.cleanup(this.leftTr);this.cleanup(this.rightTr);this.cleanup(this.extrasTr);this.fitToSize(p)},cleanup:function(c){var h=c.childNodes,g,i;for(g=h.length-1;g>=0&&(i=h[g]);g--){if(!i.firstChild){c.removeChild(i)}}},insertCell:function(h,c,g){var i=document.createElement("td");i.className="x-toolbar-cell";c.insertBefore(i,c.childNodes[g]||null);return i},hideItem:function(b){this.hiddenItems.push(b);b.xtbHidden=true;b.xtbWidth=b.getPositionEl().dom.parentNode.offsetWidth;b.hide()},unhideItem:function(b){b.show();b.xtbHidden=false;this.hiddenItems.remove(b)},getItemWidth:function(b){return b.hidden?(b.xtbWidth||0):b.getPositionEl().dom.parentNode.offsetWidth},fitToSize:function(u){if(this.container.enableOverflow===false){return}var B=u.dom.clientWidth,v=u.dom.firstChild.offsetWidth,s=B-this.triggerWidth,C=this.lastWidth||0,A=this.hiddenItems,y=A.length!=0,q=B>=C;this.lastWidth=B;if(v>B||(y&&q)){var t=this.container.items.items,w=t.length,z=0,i;for(var x=0;x<w;x++){i=t[x];if(!i.isFill){z+=this.getItemWidth(i);if(z>s){if(!(i.hidden||i.xtbHidden)){this.hideItem(i)}}else{if(i.xtbHidden){this.unhideItem(i)}}}}}y=A.length!=0;if(y){this.initMore();if(!this.lastOverflow){this.container.fireEvent("overflowchange",this.container,true);this.lastOverflow=true}}else{if(this.more){this.clearMenu();this.more.destroy();delete this.more;if(this.lastOverflow){this.container.fireEvent("overflowchange",this.container,false);this.lastOverflow=false}}}},createMenuConfig:function(i,g){var e=Ext.apply({},i.initialConfig),h=i.toggleGroup;Ext.copyTo(e,i,["iconCls","icon","itemId","disabled","handler","scope","menu"]);Ext.apply(e,{text:i.overflowText||i.text,hideOnClick:g});if(h||i.enableToggle){Ext.apply(e,{group:h,checked:i.pressed,listeners:{checkchange:function(a,b){i.toggle(b)}}})}delete e.ownerCt;delete e.xtype;delete e.id;return e},addComponentToMenu:function(c,d){if(d instanceof Ext.Toolbar.Separator){c.add("-")}else{if(Ext.isFunction(d.isXType)){if(d.isXType("splitbutton")){c.add(this.createMenuConfig(d,true))}else{if(d.isXType("button")){c.add(this.createMenuConfig(d,!d.menu))}else{if(d.isXType("buttongroup")){d.items.each(function(a){this.addComponentToMenu(c,a)},this)}}}}}},clearMenu:function(){var b=this.moreMenu;if(b&&b.items){b.items.each(function(a){delete a.menu})}},beforeMoreShow:function(l){var i=this.container.items.items,k=i.length,m,n;var p=function(a,b){return a.isXType("buttongroup")&&!(b instanceof Ext.Toolbar.Separator)};this.clearMenu();l.removeAll();for(var o=0;o<k;o++){m=i[o];if(m.xtbHidden){if(n&&(p(m,n)||p(n,m))){l.add("-")}this.addComponentToMenu(l,m);n=m}}if(l.items.length<1){l.add(this.noItemsMenuText)}},initMore:function(){if(!this.more){this.moreMenu=new Ext.menu.Menu({ownerCt:this.container,listeners:{beforeshow:this.beforeMoreShow,scope:this}});this.more=new Ext.Button({iconCls:"x-toolbar-more-icon",cls:"x-toolbar-more",menu:this.moreMenu,ownerCt:this.container});var b=this.insertCell(this.more,this.extrasTr,100);this.more.render(b)}},destroy:function(){Ext.destroy(this.more,this.moreMenu);delete this.leftTr;delete this.rightTr;delete this.extrasTr;Ext.layout.ToolbarLayout.superclass.destroy.call(this)}});Ext.Container.LAYOUTS.toolbar=Ext.layout.ToolbarLayout;Ext.layout.MenuLayout=Ext.extend(Ext.layout.ContainerLayout,{monitorResize:true,type:"menu",setContainer:function(b){this.monitorResize=!b.floating;b.on("autosize",this.doAutoSize,this);Ext.layout.MenuLayout.superclass.setContainer.call(this,b)},renderItem:function(c,a,h){if(!this.itemTpl){this.itemTpl=Ext.layout.MenuLayout.prototype.itemTpl=new Ext.XTemplate('<li id="{itemId}" class="{itemCls}">','<tpl if="needsIcon">','<img alt="{altText}" src="{icon}" class="{iconCls}"/>',"</tpl>","</li>")}if(c&&!c.rendered){if(Ext.isNumber(a)){a=h.dom.childNodes[a]
}var i=this.getItemArgs(c);c.render(c.positionEl=a?this.itemTpl.insertBefore(a,i,true):this.itemTpl.append(h,i,true));c.positionEl.menuItemId=c.getItemId();if(!i.isMenuItem&&i.needsIcon){c.positionEl.addClass("x-menu-list-item-indent")}this.configureItem(c)}else{if(c&&!this.isValidParent(c,h)){if(Ext.isNumber(a)){a=h.dom.childNodes[a]}h.dom.insertBefore(c.getActionEl().dom,a||null)}}},getItemArgs:function(g){var e=g instanceof Ext.menu.Item,c=!(e||g instanceof Ext.menu.Separator);return{isMenuItem:e,needsIcon:c&&(g.icon||g.iconCls),icon:g.icon||Ext.BLANK_IMAGE_URL,iconCls:"x-menu-item-icon "+(g.iconCls||""),itemId:"x-menu-el-"+g.id,itemCls:"x-menu-list-item ",altText:g.altText||""}},isValidParent:function(c,d){return c.el.up("li.x-menu-list-item",5).dom.parentNode===(d.dom||d)},onLayout:function(d,c){Ext.layout.MenuLayout.superclass.onLayout.call(this,d,c);this.doAutoSize()},doAutoSize:function(){var i=this.container,g=i.width;if(i.floating){if(g){i.setWidth(g)}else{if(Ext.isIE){i.setWidth(Ext.isStrict&&(Ext.isIE7||Ext.isIE8)?"auto":i.minWidth);var h=i.getEl(),e=h.dom.offsetWidth;i.setWidth(i.getLayoutTarget().getWidth()+h.getFrameWidth("lr"))}}}}});Ext.Container.LAYOUTS.menu=Ext.layout.MenuLayout;Ext.Viewport=Ext.extend(Ext.Container,{initComponent:function(){Ext.Viewport.superclass.initComponent.call(this);document.getElementsByTagName("html")[0].className+=" x-viewport";this.el=Ext.getBody();this.el.setHeight=Ext.emptyFn;this.el.setWidth=Ext.emptyFn;this.el.setSize=Ext.emptyFn;this.el.dom.scroll="no";this.allowDomMove=false;this.autoWidth=true;this.autoHeight=true;Ext.EventManager.onWindowResize(this.fireResize,this);this.renderTo=this.el},fireResize:function(d,c){this.fireEvent("resize",this,d,c,d,c)}});Ext.reg("viewport",Ext.Viewport);Ext.Panel=Ext.extend(Ext.Container,{baseCls:"x-panel",collapsedCls:"x-panel-collapsed",maskDisabled:true,animCollapse:Ext.enableFx,headerAsText:true,buttonAlign:"right",collapsed:false,collapseFirst:true,minButtonWidth:75,elements:"body",preventBodyReset:false,padding:undefined,resizeEvent:"bodyresize",toolTarget:"header",collapseEl:"bwrap",slideAnchor:"t",disabledClass:"",deferHeight:true,expandDefaults:{duration:0.25},collapseDefaults:{duration:0.25},initComponent:function(){Ext.Panel.superclass.initComponent.call(this);this.addEvents("bodyresize","titlechange","iconchange","collapse","expand","beforecollapse","beforeexpand","beforeclose","close","activate","deactivate");if(this.unstyled){this.baseCls="x-plain"}this.toolbars=[];if(this.tbar){this.elements+=",tbar";this.topToolbar=this.createToolbar(this.tbar);this.tbar=null}if(this.bbar){this.elements+=",bbar";this.bottomToolbar=this.createToolbar(this.bbar);this.bbar=null}if(this.header===true){this.elements+=",header";this.header=null}else{if(this.headerCfg||(this.title&&this.header!==false)){this.elements+=",header"}}if(this.footerCfg||this.footer===true){this.elements+=",footer";this.footer=null}if(this.buttons){this.fbar=this.buttons;this.buttons=null}if(this.fbar){this.createFbar(this.fbar)}if(this.autoLoad){this.on("render",this.doAutoLoad,this,{delay:10})}},createFbar:function(c){var d=this.minButtonWidth;this.elements+=",footer";this.fbar=this.createToolbar(c,{buttonAlign:this.buttonAlign,toolbarCls:"x-panel-fbar",enableOverflow:false,defaults:function(a){return{minWidth:a.minWidth||d}}});this.fbar.items.each(function(a){a.minWidth=a.minWidth||this.minButtonWidth},this);this.buttons=this.fbar.items.items},createToolbar:function(d,g){var e;if(Ext.isArray(d)){d={items:d}}e=d.events?Ext.apply(d,g):this.createComponent(Ext.apply({},d,g),"toolbar");this.toolbars.push(e);return e},createElement:function(e,g){if(this[e]){g.appendChild(this[e].dom);return}if(e==="bwrap"||this.elements.indexOf(e)!=-1){if(this[e+"Cfg"]){this[e]=Ext.fly(g).createChild(this[e+"Cfg"])}else{var d=document.createElement("div");d.className=this[e+"Cls"];this[e]=Ext.get(g.appendChild(d))}if(this[e+"CssClass"]){this[e].addClass(this[e+"CssClass"])}if(this[e+"Style"]){this[e].applyStyles(this[e+"Style"])
}}},onRender:function(s,t){Ext.Panel.superclass.onRender.call(this,s,t);this.createClasses();var w=this.el,q=w.dom,n,p;if(this.collapsible&&!this.hideCollapseTool){this.tools=this.tools?this.tools.slice(0):[];this.tools[this.collapseFirst?"unshift":"push"]({id:"toggle",handler:this.toggleCollapse,scope:this})}if(this.tools){p=this.tools;this.elements+=(this.header!==false)?",header":""}this.tools={};w.addClass(this.baseCls);if(q.firstChild){this.header=w.down("."+this.headerCls);this.bwrap=w.down("."+this.bwrapCls);var o=this.bwrap?this.bwrap:w;this.tbar=o.down("."+this.tbarCls);this.body=o.down("."+this.bodyCls);this.bbar=o.down("."+this.bbarCls);this.footer=o.down("."+this.footerCls);this.fromMarkup=true}if(this.preventBodyReset===true){w.addClass("x-panel-reset")}if(this.cls){w.addClass(this.cls)}if(this.buttons){this.elements+=",footer"}if(this.frame){w.insertHtml("afterBegin",String.format(Ext.Element.boxMarkup,this.baseCls));this.createElement("header",q.firstChild.firstChild.firstChild);this.createElement("bwrap",q);n=this.bwrap.dom;var u=q.childNodes[1],v=q.childNodes[2];n.appendChild(u);n.appendChild(v);var d=n.firstChild.firstChild.firstChild;this.createElement("tbar",d);this.createElement("body",d);this.createElement("bbar",d);this.createElement("footer",n.lastChild.firstChild.firstChild);if(!this.footer){this.bwrap.dom.lastChild.className+=" x-panel-nofooter"}this.ft=Ext.get(this.bwrap.dom.lastChild);this.mc=Ext.get(d)}else{this.createElement("header",q);this.createElement("bwrap",q);n=this.bwrap.dom;this.createElement("tbar",n);this.createElement("body",n);this.createElement("bbar",n);this.createElement("footer",n);if(!this.header){this.body.addClass(this.bodyCls+"-noheader");if(this.tbar){this.tbar.addClass(this.tbarCls+"-noheader")}}}if(Ext.isDefined(this.padding)){this.body.setStyle("padding",this.body.addUnits(this.padding))}if(this.border===false){this.el.addClass(this.baseCls+"-noborder");this.body.addClass(this.bodyCls+"-noborder");if(this.header){this.header.addClass(this.headerCls+"-noborder")}if(this.footer){this.footer.addClass(this.footerCls+"-noborder")}if(this.tbar){this.tbar.addClass(this.tbarCls+"-noborder")}if(this.bbar){this.bbar.addClass(this.bbarCls+"-noborder")}}if(this.bodyBorder===false){this.body.addClass(this.bodyCls+"-noborder")}this.bwrap.enableDisplayMode("block");if(this.header){this.header.unselectable();if(this.headerAsText){this.header.dom.innerHTML='<span class="'+this.headerTextCls+'">'+this.header.dom.innerHTML+"</span>";if(this.iconCls){this.setIconClass(this.iconCls)}}}if(this.floating){this.makeFloating(this.floating)}if(this.collapsible&&this.titleCollapse&&this.header){this.mon(this.header,"click",this.toggleCollapse,this);this.header.setStyle("cursor","pointer")}if(p){this.addTool.apply(this,p)}if(this.fbar){this.footer.addClass("x-panel-btns");this.fbar.ownerCt=this;this.fbar.render(this.footer);this.footer.createChild({cls:"x-clear"})}if(this.tbar&&this.topToolbar){this.topToolbar.ownerCt=this;this.topToolbar.render(this.tbar)}if(this.bbar&&this.bottomToolbar){this.bottomToolbar.ownerCt=this;this.bottomToolbar.render(this.bbar)}},setIconClass:function(g){var h=this.iconCls;this.iconCls=g;if(this.rendered&&this.header){if(this.frame){this.header.addClass("x-panel-icon");this.header.replaceClass(h,this.iconCls)}else{var i=this.header,l=i.child("img.x-panel-inline-icon");if(l){Ext.fly(l).replaceClass(h,this.iconCls)}else{var k=i.child("span."+this.headerTextCls);if(k){Ext.DomHelper.insertBefore(k.dom,{tag:"img",alt:"",src:Ext.BLANK_IMAGE_URL,cls:"x-panel-inline-icon "+this.iconCls})}}}}this.fireEvent("iconchange",this,g,h)},makeFloating:function(b){this.floating=true;this.el=new Ext.Layer(Ext.apply({},b,{shadow:Ext.isDefined(this.shadow)?this.shadow:"sides",shadowOffset:this.shadowOffset,constrain:false,shim:this.shim===false?false:undefined}),this.el)},getTopToolbar:function(){return this.topToolbar},getBottomToolbar:function(){return this.bottomToolbar},getFooterToolbar:function(){return this.fbar
},addButton:function(e,g,d){if(!this.fbar){this.createFbar([])}if(g){if(Ext.isString(e)){e={text:e}}e=Ext.apply({handler:g,scope:d},e)}return this.fbar.add(e)},addTool:function(){if(!this.rendered){if(!this.tools){this.tools=[]}Ext.each(arguments,function(b){this.tools.push(b)},this);return}if(!this[this.toolTarget]){return}if(!this.toolTemplate){var l=new Ext.Template('<div class="x-tool x-tool-{id}">&#160;</div>');l.disableFormats=true;l.compile();Ext.Panel.prototype.toolTemplate=l}for(var m=0,o=arguments,p=o.length;m<p;m++){var a=o[m];if(!this.tools[a.id]){var i="x-tool-"+a.id+"-over";var n=this.toolTemplate.insertFirst(this[this.toolTarget],a,true);this.tools[a.id]=n;n.enableDisplayMode("block");this.mon(n,"click",this.createToolHandler(n,a,i,this));if(a.on){this.mon(n,a.on)}if(a.hidden){n.hide()}if(a.qtip){if(Ext.isObject(a.qtip)){Ext.QuickTips.register(Ext.apply({target:n.id},a.qtip))}else{n.dom.qtip=a.qtip}}n.addClassOnOver(i)}}},onLayout:function(c,d){Ext.Panel.superclass.onLayout.apply(this,arguments);if(this.hasLayout&&this.toolbars.length>0){Ext.each(this.toolbars,function(a){a.doLayout(undefined,d)});this.syncHeight()}},syncHeight:function(){var e=this.toolbarHeight,i=this.body,g=this.lastSize.height,h;if(this.autoHeight||!Ext.isDefined(g)||g=="auto"){return}if(e!=this.getToolbarHeight()){e=Math.max(0,g-this.getFrameHeight());i.setHeight(e);h=i.getSize();this.toolbarHeight=this.getToolbarHeight();this.onBodyResize(h.width,h.height)}},onShow:function(){if(this.floating){return this.el.show()}Ext.Panel.superclass.onShow.call(this)},onHide:function(){if(this.floating){return this.el.hide()}Ext.Panel.superclass.onHide.call(this)},createToolHandler:function(i,g,h,e){return function(a){i.removeClass(h);if(g.stopEvent!==false){a.stopEvent()}if(g.handler){g.handler.call(g.scope||i,a,i,e,g)}}},afterRender:function(){if(this.floating&&!this.hidden){this.el.show()}if(this.title){this.setTitle(this.title)}Ext.Panel.superclass.afterRender.call(this);if(this.collapsed){this.collapsed=false;this.collapse(false)}this.initEvents()},getKeyMap:function(){if(!this.keyMap){this.keyMap=new Ext.KeyMap(this.el,this.keys)}return this.keyMap},initEvents:function(){if(this.keys){this.getKeyMap()}if(this.draggable){this.initDraggable()}if(this.toolbars.length>0){Ext.each(this.toolbars,function(b){b.doLayout();b.on({scope:this,afterlayout:this.syncHeight,remove:this.syncHeight})},this);this.syncHeight()}},initDraggable:function(){this.dd=new Ext.Panel.DD(this,Ext.isBoolean(this.draggable)?null:this.draggable)},beforeEffect:function(b){if(this.floating){this.el.beforeAction()}if(b!==false){this.el.addClass("x-panel-animated")}},afterEffect:function(b){this.syncShadow();this.el.removeClass("x-panel-animated")},createEffect:function(i,a,h){var g={scope:h,block:true};if(i===true){g.callback=a;return g}else{if(!i.callback){g.callback=a}else{g.callback=function(){a.call(h);Ext.callback(i.callback,i.scope)}}}return Ext.applyIf(g,i)},collapse:function(c){if(this.collapsed||this.el.hasFxBlock()||this.fireEvent("beforecollapse",this,c)===false){return}var d=c===true||(c!==false&&this.animCollapse);this.beforeEffect(d);this.onCollapse(d,c);return this},onCollapse:function(d,c){if(d){this[this.collapseEl].slideOut(this.slideAnchor,Ext.apply(this.createEffect(c||true,this.afterCollapse,this),this.collapseDefaults))}else{this[this.collapseEl].hide(this.hideMode);this.afterCollapse(false)}},afterCollapse:function(b){this.collapsed=true;this.el.addClass(this.collapsedCls);if(b!==false){this[this.collapseEl].hide(this.hideMode)}this.afterEffect(b);this.cascade(function(a){if(a.lastSize){a.lastSize={width:undefined,height:undefined}}});this.fireEvent("collapse",this)},expand:function(c){if(!this.collapsed||this.el.hasFxBlock()||this.fireEvent("beforeexpand",this,c)===false){return}var d=c===true||(c!==false&&this.animCollapse);this.el.removeClass(this.collapsedCls);this.beforeEffect(d);this.onExpand(d,c);return this},onExpand:function(d,c){if(d){this[this.collapseEl].slideIn(this.slideAnchor,Ext.apply(this.createEffect(c||true,this.afterExpand,this),this.expandDefaults))
}else{this[this.collapseEl].show(this.hideMode);this.afterExpand(false)}},afterExpand:function(b){this.collapsed=false;if(b!==false){this[this.collapseEl].show(this.hideMode)}this.afterEffect(b);if(this.deferLayout){delete this.deferLayout;this.doLayout(true)}this.fireEvent("expand",this)},toggleCollapse:function(b){this[this.collapsed?"expand":"collapse"](b);return this},onDisable:function(){if(this.rendered&&this.maskDisabled){this.el.mask()}Ext.Panel.superclass.onDisable.call(this)},onEnable:function(){if(this.rendered&&this.maskDisabled){this.el.unmask()}Ext.Panel.superclass.onEnable.call(this)},onResize:function(k,m,n,l){var i=k,h=m;if(Ext.isDefined(i)||Ext.isDefined(h)){if(!this.collapsed){if(Ext.isNumber(i)){this.body.setWidth(i=this.adjustBodyWidth(i-this.getFrameWidth()))}else{if(i=="auto"){i=this.body.setWidth("auto").dom.offsetWidth}else{i=this.body.dom.offsetWidth}}if(this.tbar){this.tbar.setWidth(i);if(this.topToolbar){this.topToolbar.setSize(i)}}if(this.bbar){this.bbar.setWidth(i);if(this.bottomToolbar){this.bottomToolbar.setSize(i);if(Ext.isIE){this.bbar.setStyle("position","static");this.bbar.setStyle("position","")}}}if(this.footer){this.footer.setWidth(i);if(this.fbar){this.fbar.setSize(Ext.isIE?(i-this.footer.getFrameWidth("lr")):"auto")}}if(Ext.isNumber(h)){h=Math.max(0,h-this.getFrameHeight());this.body.setHeight(h)}else{if(h=="auto"){this.body.setHeight(h)}}if(this.disabled&&this.el._mask){this.el._mask.setSize(this.el.dom.clientWidth,this.el.getHeight())}}else{this.queuedBodySize={width:i,height:h};if(!this.queuedExpand&&this.allowQueuedExpand!==false){this.queuedExpand=true;this.on("expand",function(){delete this.queuedExpand;this.onResize(this.queuedBodySize.width,this.queuedBodySize.height)},this,{single:true})}}this.onBodyResize(i,h)}this.syncShadow();Ext.Panel.superclass.onResize.call(this,k,m,n,l)},onBodyResize:function(d,c){this.fireEvent("bodyresize",this,d,c)},getToolbarHeight:function(){var b=0;if(this.rendered){Ext.each(this.toolbars,function(a){b+=a.getHeight()},this)}return b},adjustBodyHeight:function(b){return b},adjustBodyWidth:function(b){return b},onPosition:function(){this.syncShadow()},getFrameWidth:function(){var c=this.el.getFrameWidth("lr")+this.bwrap.getFrameWidth("lr");if(this.frame){var d=this.bwrap.dom.firstChild;c+=(Ext.fly(d).getFrameWidth("l")+Ext.fly(d.firstChild).getFrameWidth("r"));c+=this.mc.getFrameWidth("lr")}return c},getFrameHeight:function(){var b=this.el.getFrameWidth("tb")+this.bwrap.getFrameWidth("tb");b+=(this.tbar?this.tbar.getHeight():0)+(this.bbar?this.bbar.getHeight():0);if(this.frame){b+=this.el.dom.firstChild.offsetHeight+this.ft.dom.offsetHeight+this.mc.getFrameWidth("tb")}else{b+=(this.header?this.header.getHeight():0)+(this.footer?this.footer.getHeight():0)}return b},getInnerWidth:function(){return this.getSize().width-this.getFrameWidth()},getInnerHeight:function(){return this.body.getHeight()},syncShadow:function(){if(this.floating){this.el.sync(true)}},getLayoutTarget:function(){return this.body},getContentTarget:function(){return this.body},setTitle:function(c,d){this.title=c;if(this.header&&this.headerAsText){this.header.child("span").update(c)}if(d){this.setIconClass(d)}this.fireEvent("titlechange",this,c);return this},getUpdater:function(){return this.body.getUpdater()},load:function(){var b=this.body.getUpdater();b.update.apply(b,arguments);return this},beforeDestroy:function(){Ext.Panel.superclass.beforeDestroy.call(this);if(this.header){this.header.removeAllListeners()}if(this.tools){for(var b in this.tools){Ext.destroy(this.tools[b])}}if(this.toolbars.length>0){Ext.each(this.toolbars,function(a){a.un("afterlayout",this.syncHeight,this);a.un("remove",this.syncHeight,this)},this)}if(Ext.isArray(this.buttons)){while(this.buttons.length){Ext.destroy(this.buttons[0])}}if(this.rendered){Ext.destroy(this.ft,this.header,this.footer,this.tbar,this.bbar,this.body,this.mc,this.bwrap,this.dd);if(this.fbar){Ext.destroy(this.fbar,this.fbar.el)}}Ext.destroy(this.toolbars)
},createClasses:function(){this.headerCls=this.baseCls+"-header";this.headerTextCls=this.baseCls+"-header-text";this.bwrapCls=this.baseCls+"-bwrap";this.tbarCls=this.baseCls+"-tbar";this.bodyCls=this.baseCls+"-body";this.bbarCls=this.baseCls+"-bbar";this.footerCls=this.baseCls+"-footer"},createGhost:function(h,i,g){var k=document.createElement("div");k.className="x-panel-ghost "+(h?h:"");if(this.header){k.appendChild(this.el.dom.firstChild.cloneNode(true))}Ext.fly(k.appendChild(document.createElement("ul"))).setHeight(this.bwrap.getHeight());k.style.width=this.el.dom.offsetWidth+"px";if(!g){this.container.dom.appendChild(k)}else{Ext.getDom(g).appendChild(k)}if(i!==false&&this.el.useShim!==false){var l=new Ext.Layer({shadow:false,useDisplay:true,constrain:false},k);l.show();return l}else{return new Ext.Element(k)}},doAutoLoad:function(){var b=this.body.getUpdater();if(this.renderer){b.setRenderer(this.renderer)}b.update(Ext.isObject(this.autoLoad)?this.autoLoad:{url:this.autoLoad})},getTool:function(b){return this.tools[b]}});Ext.reg("panel",Ext.Panel);Ext.Editor=function(c,d){if(c.field){this.field=Ext.create(c.field,"textfield");d=Ext.apply({},c);delete d.field}else{this.field=c}Ext.Editor.superclass.constructor.call(this,d)};Ext.extend(Ext.Editor,Ext.Component,{allowBlur:true,value:"",alignment:"c-c?",offsets:[0,0],shadow:"frame",constrain:false,swallowKeys:true,completeOnEnter:true,cancelOnEsc:true,updateEl:false,initComponent:function(){Ext.Editor.superclass.initComponent.call(this);this.addEvents("beforestartedit","startedit","beforecomplete","complete","canceledit","specialkey")},onRender:function(c,d){this.el=new Ext.Layer({shadow:this.shadow,cls:"x-editor",parentEl:c,shim:this.shim,shadowOffset:this.shadowOffset||4,id:this.id,constrain:this.constrain});if(this.zIndex){this.el.setZIndex(this.zIndex)}this.el.setStyle("overflow",Ext.isGecko?"auto":"hidden");if(this.field.msgTarget!="title"){this.field.msgTarget="qtip"}this.field.inEditor=true;this.mon(this.field,{scope:this,blur:this.onBlur,specialkey:this.onSpecialKey});if(this.field.grow){this.mon(this.field,"autosize",this.el.sync,this.el,{delay:1})}this.field.render(this.el).show();this.field.getEl().dom.name="";if(this.swallowKeys){this.field.el.swallowEvent(["keypress","keydown"])}},onSpecialKey:function(i,k){var e=k.getKey(),h=this.completeOnEnter&&e==k.ENTER,l=this.cancelOnEsc&&e==k.ESC;if(h||l){k.stopEvent();if(h){this.completeEdit()}else{this.cancelEdit()}if(i.triggerBlur){i.triggerBlur()}}this.fireEvent("specialkey",i,k)},startEdit:function(d,g){if(this.editing){this.completeEdit()}this.boundEl=Ext.get(d);var e=g!==undefined?g:this.boundEl.dom.innerHTML;if(!this.rendered){this.render(this.parentEl||document.body)}if(this.fireEvent("beforestartedit",this,this.boundEl,e)!==false){this.startValue=e;this.field.reset();this.field.setValue(e);this.realign(true);this.editing=true;this.show()}},doAutoSize:function(){if(this.autoSize){var c=this.boundEl.getSize(),d=this.field.getSize();switch(this.autoSize){case"width":this.setSize(c.width,d.height);break;case"height":this.setSize(d.width,c.height);break;case"none":this.setSize(d.width,d.height);break;default:this.setSize(c.width,c.height)}}},setSize:function(d,c){delete this.field.lastSize;this.field.setSize(d,c);if(this.el){if(Ext.isGecko2||Ext.isOpera||(Ext.isIE7&&Ext.isStrict)){this.el.setSize(d,c)}this.el.sync()}},realign:function(b){if(b===true){this.doAutoSize()}this.el.alignTo(this.boundEl,this.alignment,this.offsets)},completeEdit:function(d){if(!this.editing){return}if(this.field.assertValue){this.field.assertValue()}var c=this.getValue();if(!this.field.isValid()){if(this.revertInvalid!==false){this.cancelEdit(d)}return}if(String(c)===String(this.startValue)&&this.ignoreNoChange){this.hideEdit(d);return}if(this.fireEvent("beforecomplete",this,c,this.startValue)!==false){c=this.getValue();if(this.updateEl&&this.boundEl){this.boundEl.update(c)}this.hideEdit(d);this.fireEvent("complete",this,c,this.startValue)}},onShow:function(){this.el.show();
if(this.hideEl!==false){this.boundEl.hide()}this.field.show().focus(false,true);this.fireEvent("startedit",this.boundEl,this.startValue)},cancelEdit:function(d){if(this.editing){var c=this.getValue();this.setValue(this.startValue);this.hideEdit(d);this.fireEvent("canceledit",this,c,this.startValue)}},hideEdit:function(b){if(b!==true){this.editing=false;this.hide()}},onBlur:function(){if(this.allowBlur===true&&this.editing&&this.selectSameEditor!==true){this.completeEdit()}},onHide:function(){if(this.editing){this.completeEdit();return}this.field.blur();if(this.field.collapse){this.field.collapse()}this.el.hide();if(this.hideEl!==false){this.boundEl.show()}},setValue:function(b){this.field.setValue(b)},getValue:function(){return this.field.getValue()},beforeDestroy:function(){Ext.destroyMembers(this,"field");delete this.parentEl;delete this.boundEl}});Ext.reg("editor",Ext.Editor);Ext.ColorPalette=Ext.extend(Ext.Component,{itemCls:"x-color-palette",value:null,clickEvent:"click",ctype:"Ext.ColorPalette",allowReselect:false,colors:["000000","993300","333300","003300","003366","000080","333399","333333","800000","FF6600","808000","008000","008080","0000FF","666699","808080","FF0000","FF9900","99CC00","339966","33CCCC","3366FF","800080","969696","FF00FF","FFCC00","FFFF00","00FF00","00FFFF","00CCFF","993366","C0C0C0","FF99CC","FFCC99","FFFF99","CCFFCC","CCFFFF","99CCFF","CC99FF","FFFFFF"],initComponent:function(){Ext.ColorPalette.superclass.initComponent.call(this);this.addEvents("select");if(this.handler){this.on("select",this.handler,this.scope,true)}},onRender:function(d,e){this.autoEl={tag:"div",cls:this.itemCls};Ext.ColorPalette.superclass.onRender.call(this,d,e);var g=this.tpl||new Ext.XTemplate('<tpl for="."><a href="#" class="color-{.}" hidefocus="on"><em><span style="background:#{.}" unselectable="on">&#160;</span></em></a></tpl>');g.overwrite(this.el,this.colors);this.mon(this.el,this.clickEvent,this.handleClick,this,{delegate:"a"});if(this.clickEvent!="click"){this.mon(this.el,"click",Ext.emptyFn,this,{delegate:"a",preventDefault:true})}},afterRender:function(){Ext.ColorPalette.superclass.afterRender.call(this);if(this.value){var b=this.value;this.value=null;this.select(b,true)}},handleClick:function(c,e){c.preventDefault();if(!this.disabled){var g=e.className.match(/(?:^|\s)color-(.{6})(?:\s|$)/)[1];this.select(g.toUpperCase())}},select:function(d,e){d=d.replace("#","");if(d!=this.value||this.allowReselect){var g=this.el;if(this.value){g.child("a.color-"+this.value).removeClass("x-color-palette-sel")}g.child("a.color-"+d).addClass("x-color-palette-sel");this.value=d;if(e!==true){this.fireEvent("select",this,d)}}}});Ext.reg("colorpalette",Ext.ColorPalette);Ext.DatePicker=Ext.extend(Ext.BoxComponent,{todayText:"Today",okText:"&#160;OK&#160;",cancelText:"Cancel",todayTip:"{0} (Spacebar)",minText:"This date is before the minimum date",maxText:"This date is after the maximum date",format:"m/d/y",disabledDaysText:"Disabled",disabledDatesText:"Disabled",monthNames:Date.monthNames,dayNames:Date.dayNames,nextText:"Next Month (Control+Right)",prevText:"Previous Month (Control+Left)",monthYearText:"Choose a month (Control+Up/Down to move years)",startDay:0,showToday:true,focusOnSelect:true,initHour:12,initComponent:function(){Ext.DatePicker.superclass.initComponent.call(this);this.value=this.value?this.value.clearTime(true):new Date().clearTime();this.addEvents("select");if(this.handler){this.on("select",this.handler,this.scope||this)}this.initDisabledDays()},initDisabledDays:function(){if(!this.disabledDatesRE&&this.disabledDates){var d=this.disabledDates,e=d.length-1,g="(?:";Ext.each(d,function(a,b){g+=Ext.isDate(a)?"^"+Ext.escapeRe(a.dateFormat(this.format))+"$":d[b];if(b!=e){g+="|"}},this);this.disabledDatesRE=new RegExp(g+")")}},setDisabledDates:function(b){if(Ext.isArray(b)){this.disabledDates=b;this.disabledDatesRE=null}else{this.disabledDatesRE=b}this.initDisabledDays();this.update(this.value,true)},setDisabledDays:function(b){this.disabledDays=b;
this.update(this.value,true)},setMinDate:function(b){this.minDate=b;this.update(this.value,true)},setMaxDate:function(b){this.maxDate=b;this.update(this.value,true)},setValue:function(b){this.value=b.clearTime(true);this.update(this.value)},getValue:function(){return this.value},focus:function(){this.update(this.activeDate)},onEnable:function(b){Ext.DatePicker.superclass.onEnable.call(this);this.doDisabled(false);this.update(b?this.value:this.activeDate);if(Ext.isIE){this.el.repaint()}},onDisable:function(){Ext.DatePicker.superclass.onDisable.call(this);this.doDisabled(true);if(Ext.isIE&&!Ext.isIE8){Ext.each([].concat(this.textNodes,this.el.query("th span")),function(b){Ext.fly(b).repaint()})}},doDisabled:function(b){this.keyNav.setDisabled(b);this.prevRepeater.setDisabled(b);this.nextRepeater.setDisabled(b);if(this.showToday){this.todayKeyListener.setDisabled(b);this.todayBtn.setDisabled(b)}},onRender:function(q,d){var m=['<table cellspacing="0">','<tr><td class="x-date-left"><a href="#" title="',this.prevText,'">&#160;</a></td><td class="x-date-middle" align="center"></td><td class="x-date-right"><a href="#" title="',this.nextText,'">&#160;</a></td></tr>','<tr><td colspan="3"><table class="x-date-inner" cellspacing="0"><thead><tr>'],s=this.dayNames,o;for(o=0;o<7;o++){var i=this.startDay+o;if(i>6){i=i-7}m.push("<th><span>",s[i].substr(0,1),"</span></th>")}m[m.length]="</tr></thead><tbody><tr>";for(o=0;o<42;o++){if(o%7===0&&o!==0){m[m.length]="</tr><tr>"}m[m.length]='<td><a href="#" hidefocus="on" class="x-date-date" tabIndex="1"><em><span></span></em></a></td>'}m.push("</tr></tbody></table></td></tr>",this.showToday?'<tr><td colspan="3" class="x-date-bottom" align="center"></td></tr>':"",'</table><div class="x-date-mp"></div>');var n=document.createElement("div");n.className="x-date-picker";n.innerHTML=m.join("");q.dom.insertBefore(n,d);this.el=Ext.get(n);this.eventEl=Ext.get(n.firstChild);this.prevRepeater=new Ext.util.ClickRepeater(this.el.child("td.x-date-left a"),{handler:this.showPrevMonth,scope:this,preventDefault:true,stopDefault:true});this.nextRepeater=new Ext.util.ClickRepeater(this.el.child("td.x-date-right a"),{handler:this.showNextMonth,scope:this,preventDefault:true,stopDefault:true});this.monthPicker=this.el.down("div.x-date-mp");this.monthPicker.enableDisplayMode("block");this.keyNav=new Ext.KeyNav(this.eventEl,{left:function(a){if(a.ctrlKey){this.showPrevMonth()}else{this.update(this.activeDate.add("d",-1))}},right:function(a){if(a.ctrlKey){this.showNextMonth()}else{this.update(this.activeDate.add("d",1))}},up:function(a){if(a.ctrlKey){this.showNextYear()}else{this.update(this.activeDate.add("d",-7))}},down:function(a){if(a.ctrlKey){this.showPrevYear()}else{this.update(this.activeDate.add("d",7))}},pageUp:function(a){this.showNextMonth()},pageDown:function(a){this.showPrevMonth()},enter:function(a){a.stopPropagation();return true},scope:this});this.el.unselectable();this.cells=this.el.select("table.x-date-inner tbody td");this.textNodes=this.el.query("table.x-date-inner tbody span");this.mbtn=new Ext.Button({text:"&#160;",tooltip:this.monthYearText,renderTo:this.el.child("td.x-date-middle",true)});this.mbtn.el.child("em").addClass("x-btn-arrow");if(this.showToday){this.todayKeyListener=this.eventEl.addKeyListener(Ext.EventObject.SPACE,this.selectToday,this);var p=(new Date()).dateFormat(this.format);this.todayBtn=new Ext.Button({renderTo:this.el.child("td.x-date-bottom",true),text:String.format(this.todayText,p),tooltip:String.format(this.todayTip,p),handler:this.selectToday,scope:this})}this.mon(this.eventEl,"mousewheel",this.handleMouseWheel,this);this.mon(this.eventEl,"click",this.handleDateClick,this,{delegate:"a.x-date-date"});this.mon(this.mbtn,"click",this.showMonthPicker,this);this.onEnable(true)},createMonthPicker:function(){if(!this.monthPicker.dom.firstChild){var d=['<table border="0" cellspacing="0">'];for(var c=0;c<6;c++){d.push('<tr><td class="x-date-mp-month"><a href="#">',Date.getShortMonthName(c),"</a></td>",'<td class="x-date-mp-month x-date-mp-sep"><a href="#">',Date.getShortMonthName(c+6),"</a></td>",c===0?'<td class="x-date-mp-ybtn" align="center"><a class="x-date-mp-prev"></a></td><td class="x-date-mp-ybtn" align="center"><a class="x-date-mp-next"></a></td></tr>':'<td class="x-date-mp-year"><a href="#"></a></td><td class="x-date-mp-year"><a href="#"></a></td></tr>')
}d.push('<tr class="x-date-mp-btns"><td colspan="4"><button type="button" class="x-date-mp-ok">',this.okText,'</button><button type="button" class="x-date-mp-cancel">',this.cancelText,"</button></td></tr>","</table>");this.monthPicker.update(d.join(""));this.mon(this.monthPicker,"click",this.onMonthClick,this);this.mon(this.monthPicker,"dblclick",this.onMonthDblClick,this);this.mpMonths=this.monthPicker.select("td.x-date-mp-month");this.mpYears=this.monthPicker.select("td.x-date-mp-year");this.mpMonths.each(function(g,b,a){a+=1;if((a%2)===0){g.dom.xmonth=5+Math.round(a*0.5)}else{g.dom.xmonth=Math.round((a-1)*0.5)}})}},showMonthPicker:function(){if(!this.disabled){this.createMonthPicker();var b=this.el.getSize();this.monthPicker.setSize(b);this.monthPicker.child("table").setSize(b);this.mpSelMonth=(this.activeDate||this.value).getMonth();this.updateMPMonth(this.mpSelMonth);this.mpSelYear=(this.activeDate||this.value).getFullYear();this.updateMPYear(this.mpSelYear);this.monthPicker.slideIn("t",{duration:0.2})}},updateMPYear:function(i){this.mpyear=i;var l=this.mpYears.elements;for(var g=1;g<=10;g++){var k=l[g-1],h;if((g%2)===0){h=i+Math.round(g*0.5);k.firstChild.innerHTML=h;k.xyear=h}else{h=i-(5-Math.round(g*0.5));k.firstChild.innerHTML=h;k.xyear=h}this.mpYears.item(g-1)[h==this.mpSelYear?"addClass":"removeClass"]("x-date-mp-sel")}},updateMPMonth:function(b){this.mpMonths.each(function(a,g,e){a[a.dom.xmonth==b?"addClass":"removeClass"]("x-date-mp-sel")})},selectMPMonth:function(b){},onMonthClick:function(k,d){k.stopEvent();var l=new Ext.Element(d),e;if(l.is("button.x-date-mp-cancel")){this.hideMonthPicker()}else{if(l.is("button.x-date-mp-ok")){var i=new Date(this.mpSelYear,this.mpSelMonth,(this.activeDate||this.value).getDate());if(i.getMonth()!=this.mpSelMonth){i=new Date(this.mpSelYear,this.mpSelMonth,1).getLastDateOfMonth()}this.update(i);this.hideMonthPicker()}else{if((e=l.up("td.x-date-mp-month",2))){this.mpMonths.removeClass("x-date-mp-sel");e.addClass("x-date-mp-sel");this.mpSelMonth=e.dom.xmonth}else{if((e=l.up("td.x-date-mp-year",2))){this.mpYears.removeClass("x-date-mp-sel");e.addClass("x-date-mp-sel");this.mpSelYear=e.dom.xyear}else{if(l.is("a.x-date-mp-prev")){this.updateMPYear(this.mpyear-10)}else{if(l.is("a.x-date-mp-next")){this.updateMPYear(this.mpyear+10)}}}}}}},onMonthDblClick:function(h,e){h.stopEvent();var i=new Ext.Element(e),g;if((g=i.up("td.x-date-mp-month",2))){this.update(new Date(this.mpSelYear,g.dom.xmonth,(this.activeDate||this.value).getDate()));this.hideMonthPicker()}else{if((g=i.up("td.x-date-mp-year",2))){this.update(new Date(g.dom.xyear,this.mpSelMonth,(this.activeDate||this.value).getDate()));this.hideMonthPicker()}}},hideMonthPicker:function(b){if(this.monthPicker){if(b===true){this.monthPicker.hide()}else{this.monthPicker.slideOut("t",{duration:0.2})}}},showPrevMonth:function(b){this.update(this.activeDate.add("mo",-1))},showNextMonth:function(b){this.update(this.activeDate.add("mo",1))},showPrevYear:function(){this.update(this.activeDate.add("y",-1))},showNextYear:function(){this.update(this.activeDate.add("y",1))},handleMouseWheel:function(d){d.stopEvent();if(!this.disabled){var c=d.getWheelDelta();if(c>0){this.showPrevMonth()}else{if(c<0){this.showNextMonth()}}}},handleDateClick:function(c,d){c.stopEvent();if(!this.disabled&&d.dateValue&&!Ext.fly(d.parentNode).hasClass("x-date-disabled")){this.cancelFocus=this.focusOnSelect===false;this.setValue(new Date(d.dateValue));delete this.cancelFocus;this.fireEvent("select",this,this.value)}},selectToday:function(){if(this.todayBtn&&!this.todayBtn.disabled){this.setValue(new Date().clearTime());this.fireEvent("select",this,this.value)}},update:function(L,V){if(this.rendered){var ak=this.activeDate,X=this.isVisible();this.activeDate=L;if(!V&&ak&&this.el){var Z=L.getTime();if(ak.getMonth()==L.getMonth()&&ak.getFullYear()==L.getFullYear()){this.cells.removeClass("x-date-selected");this.cells.each(function(a){if(a.dom.firstChild.dateValue==Z){a.addClass("x-date-selected");
if(X&&!this.cancelFocus){Ext.fly(a.dom.firstChild).focus(50)}return false}},this);return}}var ad=L.getDaysInMonth(),T=L.getFirstDateOfMonth(),ag=T.getDay()-this.startDay;if(ag<0){ag+=7}ad+=ag;var U=L.add("mo",-1),af=U.getDaysInMonth()-ag,ah=this.cells.elements,R=this.textNodes,Q=(new Date(U.getFullYear(),U.getMonth(),af,this.initHour)),S=new Date().clearTime().getTime(),w=L.clearTime(true).getTime(),M=this.minDate?this.minDate.clearTime(true):Number.NEGATIVE_INFINITY,Y=this.maxDate?this.maxDate.clearTime(true):Number.POSITIVE_INFINITY,N=this.disabledDatesRE,P=this.disabledDatesText,i=this.disabledDays?this.disabledDays.join(""):false,O=this.disabledDaysText,W=this.format;if(this.showToday){var ab=new Date().clearTime(),ai=(ab<M||ab>Y||(N&&W&&N.test(ab.dateFormat(W)))||(i&&i.indexOf(ab.getDay())!=-1));if(!this.disabled){this.todayBtn.setDisabled(ai);this.todayKeyListener[ai?"disable":"enable"]()}}var ac=function(a,e){e.title="";var c=Q.clearTime(true).getTime();e.firstChild.dateValue=c;if(c==S){e.className+=" x-date-today";e.title=a.todayText}if(c==w){e.className+=" x-date-selected";if(X){Ext.fly(e.firstChild).focus(50)}}if(c<M){e.className=" x-date-disabled";e.title=a.minText;return}if(c>Y){e.className=" x-date-disabled";e.title=a.maxText;return}if(i){if(i.indexOf(Q.getDay())!=-1){e.title=O;e.className=" x-date-disabled"}}if(N&&W){var b=Q.dateFormat(W);if(N.test(b)){e.title=P.replace("%0",b);e.className=" x-date-disabled"}}};var d=0;for(;d<ag;d++){R[d].innerHTML=(++af);Q.setDate(Q.getDate()+1);ah[d].className="x-date-prevday";ac(this,ah[d])}for(;d<ad;d++){var aj=d-ag+1;R[d].innerHTML=(aj);Q.setDate(Q.getDate()+1);ah[d].className="x-date-active";ac(this,ah[d])}var t=0;for(;d<42;d++){R[d].innerHTML=(++t);Q.setDate(Q.getDate()+1);ah[d].className="x-date-nextday";ac(this,ah[d])}this.mbtn.setText(this.monthNames[L.getMonth()]+" "+L.getFullYear());if(!this.internalRender){var ae=this.el.dom.firstChild,aa=ae.offsetWidth;this.el.setWidth(aa+this.el.getBorderWidth("lr"));Ext.fly(ae).setWidth(aa);this.internalRender=true;if(Ext.isOpera&&!this.secondPass){ae.rows[0].cells[1].style.width=(aa-(ae.rows[0].cells[0].offsetWidth+ae.rows[0].cells[2].offsetWidth))+"px";this.secondPass=true;this.update.defer(10,this,[L])}}}},beforeDestroy:function(){if(this.rendered){Ext.destroy(this.keyNav,this.monthPicker,this.eventEl,this.mbtn,this.nextRepeater,this.prevRepeater,this.cells.el,this.todayBtn);delete this.textNodes;delete this.cells.elements}}});Ext.reg("datepicker",Ext.DatePicker);Ext.LoadMask=function(g,d){this.el=Ext.get(g);Ext.apply(this,d);if(this.store){this.store.on({scope:this,beforeload:this.onBeforeLoad,load:this.onLoad,exception:this.onLoad});this.removeMask=Ext.value(this.removeMask,false)}else{var e=this.el.getUpdater();e.showLoadIndicator=false;e.on({scope:this,beforeupdate:this.onBeforeLoad,update:this.onLoad,failure:this.onLoad});this.removeMask=Ext.value(this.removeMask,true)}};Ext.LoadMask.prototype={msg:"Loading...",msgCls:"x-mask-loading",disabled:false,disable:function(){this.disabled=true},enable:function(){this.disabled=false},onLoad:function(){this.el.unmask(this.removeMask)},onBeforeLoad:function(){if(!this.disabled){this.el.mask(this.msg,this.msgCls)}},show:function(){this.onBeforeLoad()},hide:function(){this.onLoad()},destroy:function(){if(this.store){this.store.un("beforeload",this.onBeforeLoad,this);this.store.un("load",this.onLoad,this);this.store.un("exception",this.onLoad,this)}else{var b=this.el.getUpdater();b.un("beforeupdate",this.onBeforeLoad,this);b.un("update",this.onLoad,this);b.un("failure",this.onLoad,this)}}};Ext.ns("Ext.slider");Ext.slider.Thumb=Ext.extend(Object,{dragging:false,constructor:function(b){Ext.apply(this,b||{},{cls:"x-slider-thumb",constrain:false});Ext.slider.Thumb.superclass.constructor.call(this,b);if(this.slider.vertical){Ext.apply(this,Ext.slider.Thumb.Vertical)}},render:function(){this.el=this.slider.innerEl.insertFirst({cls:this.cls});this.initEvents()},enable:function(){this.disabled=false;
this.el.removeClass(this.slider.disabledClass)},disable:function(){this.disabled=true;this.el.addClass(this.slider.disabledClass)},initEvents:function(){var b=this.el;b.addClassOnOver("x-slider-thumb-over");this.tracker=new Ext.dd.DragTracker({onBeforeStart:this.onBeforeDragStart.createDelegate(this),onStart:this.onDragStart.createDelegate(this),onDrag:this.onDrag.createDelegate(this),onEnd:this.onDragEnd.createDelegate(this),tolerance:3,autoStart:300});this.tracker.initEl(b)},onBeforeDragStart:function(b){if(this.disabled){return false}else{this.slider.promoteThumb(this);return true}},onDragStart:function(b){this.el.addClass("x-slider-thumb-drag");this.dragging=true;this.dragStartValue=this.value;this.slider.fireEvent("dragstart",this.slider,b,this)},onDrag:function(l){var n=this.slider,e=this.index,m=this.getNewValue();if(this.constrain){var i=n.thumbs[e+1],k=n.thumbs[e-1];if(k!=undefined&&m<=k.value){m=k.value}if(i!=undefined&&m>=i.value){m=i.value}}n.setValue(e,m,false);n.fireEvent("drag",n,l,this)},getNewValue:function(){var d=this.slider,c=d.innerEl.translatePoints(this.tracker.getXY());return Ext.util.Format.round(d.reverseValue(c.left),d.decimalPrecision)},onDragEnd:function(g){var e=this.slider,d=this.value;this.el.removeClass("x-slider-thumb-drag");this.dragging=false;e.fireEvent("dragend",e,g);if(this.dragStartValue!=d){e.fireEvent("changecomplete",e,d,this)}},destroy:function(){Ext.destroyMembers(this,"tracker","el")}});Ext.slider.MultiSlider=Ext.extend(Ext.BoxComponent,{vertical:false,minValue:0,maxValue:100,decimalPrecision:0,keyIncrement:1,increment:0,clickRange:[5,15],clickToChange:true,animate:true,constrainThumbs:true,topThumbZIndex:10000,initComponent:function(){if(!Ext.isDefined(this.value)){this.value=this.minValue}this.thumbs=[];Ext.slider.MultiSlider.superclass.initComponent.call(this);this.keyIncrement=Math.max(this.increment,this.keyIncrement);this.addEvents("beforechange","change","changecomplete","dragstart","drag","dragend");if(this.values==undefined||Ext.isEmpty(this.values)){this.values=[0]}var d=this.values;for(var c=0;c<d.length;c++){this.addThumb(d[c])}if(this.vertical){Ext.apply(this,Ext.slider.Vertical)}},addThumb:function(c){var d=new Ext.slider.Thumb({value:c,slider:this,index:this.thumbs.length,constrain:this.constrainThumbs});this.thumbs.push(d);if(this.rendered){d.render()}},promoteThumb:function(m){var i=this.thumbs,k,h;for(var l=0,n=i.length;l<n;l++){h=i[l];if(h==m){k=this.topThumbZIndex}else{k=""}h.el.setStyle("zIndex",k)}},onRender:function(){this.autoEl={cls:"x-slider "+(this.vertical?"x-slider-vert":"x-slider-horz"),cn:{cls:"x-slider-end",cn:{cls:"x-slider-inner",cn:[{tag:"a",cls:"x-slider-focus",href:"#",tabIndex:"-1",hidefocus:"on"}]}}};Ext.slider.MultiSlider.superclass.onRender.apply(this,arguments);this.endEl=this.el.first();this.innerEl=this.endEl.first();this.focusEl=this.innerEl.child(".x-slider-focus");for(var c=0;c<this.thumbs.length;c++){this.thumbs[c].render()}var d=this.innerEl.child(".x-slider-thumb");this.halfThumb=(this.vertical?d.getHeight():d.getWidth())/2;this.initEvents()},initEvents:function(){this.mon(this.el,{scope:this,mousedown:this.onMouseDown,keydown:this.onKeyDown});this.focusEl.swallowEvent("click",true)},onMouseDown:function(h){if(this.disabled){return}var i=false;for(var e=0;e<this.thumbs.length;e++){i=i||h.target==this.thumbs[e].el.dom}if(this.clickToChange&&!i){var g=this.innerEl.translatePoints(h.getXY());this.onClickChange(g)}this.focus()},onClickChange:function(g){if(g.top>this.clickRange[0]&&g.top<this.clickRange[1]){var e=this.getNearest(g,"left"),d=e.index;this.setValue(d,Ext.util.Format.round(this.reverseValue(g.left),this.decimalPrecision),undefined,true)}},getNearest:function(p,x){var i=x=="top"?this.innerEl.getHeight()-p[x]:p[x],t=this.reverseValue(i),q=(this.maxValue-this.minValue)+5,u=0,w=null;for(var v=0;v<this.thumbs.length;v++){var y=this.thumbs[v],o=y.value,s=Math.abs(o-t);if(Math.abs(s<=q)){w=y;u=v;q=s}}return w},onKeyDown:function(d){if(this.disabled||this.thumbs.length!==1){d.preventDefault();
return}var e=d.getKey(),g;switch(e){case d.UP:case d.RIGHT:d.stopEvent();g=d.ctrlKey?this.maxValue:this.getValue(0)+this.keyIncrement;this.setValue(0,g,undefined,true);break;case d.DOWN:case d.LEFT:d.stopEvent();g=d.ctrlKey?this.minValue:this.getValue(0)-this.keyIncrement;this.setValue(0,g,undefined,true);break;default:d.preventDefault()}},doSnap:function(e){if(!(this.increment&&e)){return e}var h=e,i=this.increment,g=e%i;if(g!=0){h-=g;if(g*2>=i){h+=i}else{if(g*2<-i){h-=i}}}return h.constrain(this.minValue,this.maxValue)},afterRender:function(){Ext.slider.MultiSlider.superclass.afterRender.apply(this,arguments);for(var g=0;g<this.thumbs.length;g++){var d=this.thumbs[g];if(d.value!==undefined){var e=this.normalizeValue(d.value);if(e!==d.value){this.setValue(g,e,false)}else{this.moveThumb(g,this.translateValue(e),false)}}}},getRatio:function(){var d=this.innerEl.getWidth(),c=this.maxValue-this.minValue;return c==0?d:(d/c)},normalizeValue:function(b){b=this.doSnap(b);b=Ext.util.Format.round(b,this.decimalPrecision);b=b.constrain(this.minValue,this.maxValue);return b},setMinValue:function(i){this.minValue=i;var k=0,g=this.thumbs,h=g.length,l;for(;k<h;++k){l=g[k];l.value=l.value<i?i:l.value}this.syncThumb()},setMaxValue:function(i){this.maxValue=i;var k=0,g=this.thumbs,h=g.length,l;for(;k<h;++k){l=g[k];l.value=l.value>i?i:l.value}this.syncThumb()},setValue:function(m,n,h,k){var i=this.thumbs[m],l=i.el;n=this.normalizeValue(n);if(n!==i.value&&this.fireEvent("beforechange",this,n,i.value,i)!==false){i.value=n;if(this.rendered){this.moveThumb(m,this.translateValue(n),h!==false);this.fireEvent("change",this,n,i);if(k){this.fireEvent("changecomplete",this,n,i)}}}},translateValue:function(d){var c=this.getRatio();return(d*c)-(this.minValue*c)-this.halfThumb},reverseValue:function(c){var d=this.getRatio();return(c+(this.minValue*d))/d},moveThumb:function(h,i,e){var g=this.thumbs[h].el;if(!e||this.animate===false){g.setLeft(i)}else{g.shift({left:i,stopFx:true,duration:0.35})}},focus:function(){this.focusEl.focus(10)},onResize:function(l,i){var g=this.thumbs,h=g.length,k=0;for(;k<h;++k){g[k].el.stopFx()}if(Ext.isNumber(l)){this.innerEl.setWidth(l-(this.el.getPadding("l")+this.endEl.getPadding("r")))}this.syncThumb();Ext.slider.MultiSlider.superclass.onResize.apply(this,arguments)},onDisable:function(){Ext.slider.MultiSlider.superclass.onDisable.call(this);for(var e=0;e<this.thumbs.length;e++){var g=this.thumbs[e],i=g.el;g.disable();if(Ext.isIE){var h=i.getXY();i.hide();this.innerEl.addClass(this.disabledClass).dom.disabled=true;if(!this.thumbHolder){this.thumbHolder=this.endEl.createChild({cls:"x-slider-thumb "+this.disabledClass})}this.thumbHolder.show().setXY(h)}}},onEnable:function(){Ext.slider.MultiSlider.superclass.onEnable.call(this);for(var d=0;d<this.thumbs.length;d++){var e=this.thumbs[d],g=e.el;e.enable();if(Ext.isIE){this.innerEl.removeClass(this.disabledClass).dom.disabled=false;if(this.thumbHolder){this.thumbHolder.hide()}g.show();this.syncThumb()}}},syncThumb:function(){if(this.rendered){for(var b=0;b<this.thumbs.length;b++){this.moveThumb(b,this.translateValue(this.thumbs[b].value))}}},getValue:function(b){return this.thumbs[b].value},getValues:function(){var d=[];for(var c=0;c<this.thumbs.length;c++){d.push(this.thumbs[c].value)}return d},beforeDestroy:function(){var d=this.thumbs;for(var g=0,e=d.length;g<e;++g){d[g].destroy();d[g]=null}Ext.destroyMembers(this,"endEl","innerEl","focusEl","thumbHolder");Ext.slider.MultiSlider.superclass.beforeDestroy.call(this)}});Ext.reg("multislider",Ext.slider.MultiSlider);Ext.slider.SingleSlider=Ext.extend(Ext.slider.MultiSlider,{constructor:function(b){b=b||{};Ext.applyIf(b,{values:[b.value||0]});Ext.slider.SingleSlider.superclass.constructor.call(this,b)},getValue:function(){return Ext.slider.SingleSlider.superclass.getValue.call(this,0)},setValue:function(h,e){var i=Ext.toArray(arguments),g=i.length;if(g==1||(g<=3&&typeof arguments[1]!="number")){i.unshift(0)}return Ext.slider.SingleSlider.superclass.setValue.apply(this,i)
},syncThumb:function(){return Ext.slider.SingleSlider.superclass.syncThumb.apply(this,[0].concat(arguments))},getNearest:function(){return this.thumbs[0]}});Ext.Slider=Ext.slider.SingleSlider;Ext.reg("slider",Ext.slider.SingleSlider);Ext.slider.Vertical={onResize:function(d,c){this.innerEl.setHeight(c-(this.el.getPadding("t")+this.endEl.getPadding("b")));this.syncThumb()},getRatio:function(){var c=this.innerEl.getHeight(),d=this.maxValue-this.minValue;return c/d},moveThumb:function(k,l,g){var h=this.thumbs[k],i=h.el;if(!g||this.animate===false){i.setBottom(l)}else{i.shift({bottom:l,stopFx:true,duration:0.35})}},onClickChange:function(i){if(i.left>this.clickRange[0]&&i.left<this.clickRange[1]){var g=this.getNearest(i,"top"),e=g.index,h=this.minValue+this.reverseValue(this.innerEl.getHeight()-i.top);this.setValue(e,Ext.util.Format.round(h,this.decimalPrecision),undefined,true)}}};Ext.slider.Thumb.Vertical={getNewValue:function(){var e=this.slider,i=e.innerEl,h=i.translatePoints(this.tracker.getXY()),g=i.getHeight()-h.top;return e.minValue+Ext.util.Format.round(g/e.getRatio(),e.decimalPrecision)}};Ext.ProgressBar=Ext.extend(Ext.BoxComponent,{baseCls:"x-progress",animate:false,waitTimer:null,initComponent:function(){Ext.ProgressBar.superclass.initComponent.call(this);this.addEvents("update")},onRender:function(k,h){var l=new Ext.Template('<div class="{cls}-wrap">','<div class="{cls}-inner">','<div class="{cls}-bar">','<div class="{cls}-text">',"<div>&#160;</div>","</div>","</div>",'<div class="{cls}-text {cls}-text-back">',"<div>&#160;</div>","</div>","</div>","</div>");this.el=h?l.insertBefore(h,{cls:this.baseCls},true):l.append(k,{cls:this.baseCls},true);if(this.id){this.el.dom.id=this.id}var g=this.el.dom.firstChild;this.progressBar=Ext.get(g.firstChild);if(this.textEl){this.textEl=Ext.get(this.textEl);delete this.textTopEl}else{this.textTopEl=Ext.get(this.progressBar.dom.firstChild);var i=Ext.get(g.childNodes[1]);this.textTopEl.setStyle("z-index",99).addClass("x-hidden");this.textEl=new Ext.CompositeElement([this.textTopEl.dom.firstChild,i.dom.firstChild]);this.textEl.setWidth(g.offsetWidth)}this.progressBar.setHeight(g.offsetHeight)},afterRender:function(){Ext.ProgressBar.superclass.afterRender.call(this);if(this.value){this.updateProgress(this.value,this.text)}else{this.updateText(this.text)}},updateProgress:function(i,h,e){this.value=i||0;if(h){this.updateText(h)}if(this.rendered&&!this.isDestroyed){var g=Math.floor(i*this.el.dom.firstChild.offsetWidth);this.progressBar.setWidth(g,e===true||(e!==false&&this.animate));if(this.textTopEl){this.textTopEl.removeClass("x-hidden").setWidth(g)}}this.fireEvent("update",this,i,h);return this},wait:function(c){if(!this.waitTimer){var d=this;c=c||{};this.updateText(c.text);this.waitTimer=Ext.TaskMgr.start({run:function(b){var a=c.increment||10;b-=1;this.updateProgress(((((b+a)%a)+1)*(100/a))*0.01,null,c.animate)},interval:c.interval||1000,duration:c.duration,onStop:function(){if(c.fn){c.fn.apply(c.scope||this)}this.reset()},scope:d})}return this},isWaiting:function(){return this.waitTimer!==null},updateText:function(b){this.text=b||"&#160;";if(this.rendered){this.textEl.update(this.text)}return this},syncProgressBar:function(){if(this.value){this.updateProgress(this.value,this.text)}return this},setSize:function(e,g){Ext.ProgressBar.superclass.setSize.call(this,e,g);if(this.textTopEl){var d=this.el.dom.firstChild;this.textEl.setSize(d.offsetWidth,d.offsetHeight)}this.syncProgressBar();return this},reset:function(b){this.updateProgress(0);if(this.textTopEl){this.textTopEl.addClass("x-hidden")}this.clearTimer();if(b===true){this.hide()}return this},clearTimer:function(){if(this.waitTimer){this.waitTimer.onStop=null;Ext.TaskMgr.stop(this.waitTimer);this.waitTimer=null}},onDestroy:function(){this.clearTimer();if(this.rendered){if(this.textEl.isComposite){this.textEl.clear()}Ext.destroyMembers(this,"textEl","progressBar","textTopEl")}Ext.ProgressBar.superclass.onDestroy.call(this)}});Ext.reg("progress",Ext.ProgressBar);
(function(){var d=Ext.EventManager;var c=Ext.lib.Dom;Ext.dd.DragDrop=function(a,g,b){if(a){this.init(a,g,b)}};Ext.dd.DragDrop.prototype={id:null,config:null,dragElId:null,handleElId:null,invalidHandleTypes:null,invalidHandleIds:null,invalidHandleClasses:null,startPageX:0,startPageY:0,groups:null,locked:false,lock:function(){this.locked=true},moveOnly:false,unlock:function(){this.locked=false},isTarget:true,padding:null,_domRef:null,__ygDragDrop:true,constrainX:false,constrainY:false,minX:0,maxX:0,minY:0,maxY:0,maintainOffset:false,xTicks:null,yTicks:null,primaryButtonOnly:true,available:false,hasOuterHandles:false,b4StartDrag:function(b,a){},startDrag:function(b,a){},b4Drag:function(a){},onDrag:function(a){},onDragEnter:function(b,a){},b4DragOver:function(a){},onDragOver:function(b,a){},b4DragOut:function(a){},onDragOut:function(b,a){},b4DragDrop:function(a){},onDragDrop:function(b,a){},onInvalidDrop:function(a){},b4EndDrag:function(a){},endDrag:function(a){},b4MouseDown:function(a){},onMouseDown:function(a){},onMouseUp:function(a){},onAvailable:function(){},defaultPadding:{left:0,right:0,top:0,bottom:0},constrainTo:function(u,w,a){if(Ext.isNumber(w)){w={left:w,right:w,top:w,bottom:w}}w=w||this.defaultPadding;var s=Ext.get(this.getEl()).getBox(),z=Ext.get(u),b=z.getScroll(),t,y=z.dom;if(y==document.body){t={x:b.left,y:b.top,width:Ext.lib.Dom.getViewWidth(),height:Ext.lib.Dom.getViewHeight()}}else{var q=z.getXY();t={x:q[0],y:q[1],width:y.clientWidth,height:y.clientHeight}}var v=s.y-t.y,x=s.x-t.x;this.resetConstraints();this.setXConstraint(x-(w.left||0),t.width-x-s.width-(w.right||0),this.xTickSize);this.setYConstraint(v-(w.top||0),t.height-v-s.height-(w.bottom||0),this.yTickSize)},getEl:function(){if(!this._domRef){this._domRef=Ext.getDom(this.id)}return this._domRef},getDragEl:function(){return Ext.getDom(this.dragElId)},init:function(a,g,b){this.initTarget(a,g,b);d.on(this.id,"mousedown",this.handleMouseDown,this)},initTarget:function(a,g,b){this.config=b||{};this.DDM=Ext.dd.DDM;this.groups={};if(typeof a!=="string"){a=Ext.id(a)}this.id=a;this.addToGroup((g)?g:"default");this.handleElId=a;this.setDragElId(a);this.invalidHandleTypes={A:"A"};this.invalidHandleIds={};this.invalidHandleClasses=[];this.applyConfig();this.handleOnAvailable()},applyConfig:function(){this.padding=this.config.padding||[0,0,0,0];this.isTarget=(this.config.isTarget!==false);this.maintainOffset=(this.config.maintainOffset);this.primaryButtonOnly=(this.config.primaryButtonOnly!==false)},handleOnAvailable:function(){this.available=true;this.resetConstraints();this.onAvailable()},setPadding:function(b,i,a,h){if(!i&&0!==i){this.padding=[b,b,b,b]}else{if(!a&&0!==a){this.padding=[b,i,b,i]}else{this.padding=[b,i,a,h]}}},setInitPosition:function(k,l){var b=this.getEl();if(!this.DDM.verifyEl(b)){return}var m=k||0;var n=l||0;var a=c.getXY(b);this.initPageX=a[0]-m;this.initPageY=a[1]-n;this.lastPageX=a[0];this.lastPageY=a[1];this.setStartPosition(a)},setStartPosition:function(a){var b=a||c.getXY(this.getEl());this.deltaSetXY=null;this.startPageX=b[0];this.startPageY=b[1]},addToGroup:function(a){this.groups[a]=true;this.DDM.regDragDrop(this,a)},removeFromGroup:function(a){if(this.groups[a]){delete this.groups[a]}this.DDM.removeDDFromGroup(this,a)},setDragElId:function(a){this.dragElId=a},setHandleElId:function(a){if(typeof a!=="string"){a=Ext.id(a)}this.handleElId=a;this.DDM.regHandle(this.id,a)},setOuterHandleElId:function(a){if(typeof a!=="string"){a=Ext.id(a)}d.on(a,"mousedown",this.handleMouseDown,this);this.setHandleElId(a);this.hasOuterHandles=true},unreg:function(){d.un(this.id,"mousedown",this.handleMouseDown);this._domRef=null;this.DDM._remove(this)},destroy:function(){this.unreg()},isLocked:function(){return(this.DDM.isLocked()||this.locked)},handleMouseDown:function(a,b){if(this.primaryButtonOnly&&a.button!=0){return}if(this.isLocked()){return}this.DDM.refreshCache(this.groups);var e=new Ext.lib.Point(Ext.lib.Event.getPageX(a),Ext.lib.Event.getPageY(a));if(!this.hasOuterHandles&&!this.DDM.isOverTarget(e,this)){}else{if(this.clickValidator(a)){this.setStartPosition();
this.b4MouseDown(a);this.onMouseDown(a);this.DDM.handleMouseDown(a,this);this.DDM.stopEvent(a)}else{}}},clickValidator:function(a){var b=a.getTarget();return(this.isValidHandleChild(b)&&(this.id==this.handleElId||this.DDM.handleWasClicked(b,this.id)))},addInvalidHandleType:function(b){var a=b.toUpperCase();this.invalidHandleTypes[a]=a},addInvalidHandleId:function(a){if(typeof a!=="string"){a=Ext.id(a)}this.invalidHandleIds[a]=a},addInvalidHandleClass:function(a){this.invalidHandleClasses.push(a)},removeInvalidHandleType:function(b){var a=b.toUpperCase();delete this.invalidHandleTypes[a]},removeInvalidHandleId:function(a){if(typeof a!=="string"){a=Ext.id(a)}delete this.invalidHandleIds[a]},removeInvalidHandleClass:function(b){for(var a=0,g=this.invalidHandleClasses.length;a<g;++a){if(this.invalidHandleClasses[a]==b){delete this.invalidHandleClasses[a]}}},isValidHandleChild:function(e){var i=true;var a;try{a=e.nodeName.toUpperCase()}catch(b){a=e.nodeName}i=i&&!this.invalidHandleTypes[a];i=i&&!this.invalidHandleIds[e.id];for(var m=0,n=this.invalidHandleClasses.length;i&&m<n;++m){i=!Ext.fly(e).hasClass(this.invalidHandleClasses[m])}return i},setXTicks:function(a,i){this.xTicks=[];this.xTickSize=i;var b={};for(var h=this.initPageX;h>=this.minX;h=h-i){if(!b[h]){this.xTicks[this.xTicks.length]=h;b[h]=true}}for(h=this.initPageX;h<=this.maxX;h=h+i){if(!b[h]){this.xTicks[this.xTicks.length]=h;b[h]=true}}this.xTicks.sort(this.DDM.numericSort)},setYTicks:function(a,i){this.yTicks=[];this.yTickSize=i;var b={};for(var h=this.initPageY;h>=this.minY;h=h-i){if(!b[h]){this.yTicks[this.yTicks.length]=h;b[h]=true}}for(h=this.initPageY;h<=this.maxY;h=h+i){if(!b[h]){this.yTicks[this.yTicks.length]=h;b[h]=true}}this.yTicks.sort(this.DDM.numericSort)},setXConstraint:function(a,b,g){this.leftConstraint=a;this.rightConstraint=b;this.minX=this.initPageX-a;this.maxX=this.initPageX+b;if(g){this.setXTicks(this.initPageX,g)}this.constrainX=true},clearConstraints:function(){this.constrainX=false;this.constrainY=false;this.clearTicks()},clearTicks:function(){this.xTicks=null;this.yTicks=null;this.xTickSize=0;this.yTickSize=0},setYConstraint:function(g,a,b){this.topConstraint=g;this.bottomConstraint=a;this.minY=this.initPageY-g;this.maxY=this.initPageY+a;if(b){this.setYTicks(this.initPageY,b)}this.constrainY=true},resetConstraints:function(){if(this.initPageX||this.initPageX===0){var a=(this.maintainOffset)?this.lastPageX-this.initPageX:0;var b=(this.maintainOffset)?this.lastPageY-this.initPageY:0;this.setInitPosition(a,b)}else{this.setInitPosition()}if(this.constrainX){this.setXConstraint(this.leftConstraint,this.rightConstraint,this.xTickSize)}if(this.constrainY){this.setYConstraint(this.topConstraint,this.bottomConstraint,this.yTickSize)}},getTick:function(a,m){if(!m){return a}else{if(m[0]>=a){return m[0]}else{for(var o=0,p=m.length;o<p;++o){var n=o+1;if(m[n]&&m[n]>=a){var b=a-m[o];var i=m[n]-a;return(i>b)?m[o]:m[n]}}return m[m.length-1]}}},toString:function(){return("DragDrop "+this.id)}}})();if(!Ext.dd.DragDropMgr){Ext.dd.DragDropMgr=function(){var b=Ext.EventManager;return{ids:{},handleIds:{},dragCurrent:null,dragOvers:{},deltaX:0,deltaY:0,preventDefault:true,stopPropagation:true,initialized:false,locked:false,init:function(){this.initialized=true},POINT:0,INTERSECT:1,mode:0,_execOnAll:function(k,l){for(var i in this.ids){for(var a in this.ids[i]){var h=this.ids[i][a];if(!this.isTypeOfDD(h)){continue}h[k].apply(h,l)}}},_onLoad:function(){this.init();b.on(document,"mouseup",this.handleMouseUp,this,true);b.on(document,"mousemove",this.handleMouseMove,this,true);b.on(window,"unload",this._onUnload,this,true);b.on(window,"resize",this._onResize,this,true)},_onResize:function(a){this._execOnAll("resetConstraints",[])},lock:function(){this.locked=true},unlock:function(){this.locked=false},isLocked:function(){return this.locked},locationCache:{},useCache:true,clickPixelThresh:3,clickTimeThresh:350,dragThreshMet:false,clickTimeout:null,startX:0,startY:0,regDragDrop:function(d,a){if(!this.initialized){this.init()
}if(!this.ids[a]){this.ids[a]={}}this.ids[a][d.id]=d},removeDDFromGroup:function(e,a){if(!this.ids[a]){this.ids[a]={}}var g=this.ids[a];if(g&&g[e.id]){delete g[e.id]}},_remove:function(d){for(var a in d.groups){if(a&&this.ids[a]&&this.ids[a][d.id]){delete this.ids[a][d.id]}}delete this.handleIds[d.id]},regHandle:function(d,a){if(!this.handleIds[d]){this.handleIds[d]={}}this.handleIds[d][a]=a},isDragDrop:function(a){return(this.getDDById(a))?true:false},getRelated:function(i,n){var k=[];for(var l in i.groups){for(var m in this.ids[l]){var a=this.ids[l][m];if(!this.isTypeOfDD(a)){continue}if(!n||a.isTarget){k[k.length]=a}}}return k},isLegalTarget:function(h,i){var l=this.getRelated(h,true);for(var k=0,a=l.length;k<a;++k){if(l[k].id==i.id){return true}}return false},isTypeOfDD:function(a){return(a&&a.__ygDragDrop)},isHandle:function(d,a){return(this.handleIds[d]&&this.handleIds[d][a])},getDDById:function(d){for(var a in this.ids){if(this.ids[a][d]){return this.ids[a][d]}}return null},handleMouseDown:function(e,g){if(Ext.QuickTips){Ext.QuickTips.ddDisable()}if(this.dragCurrent){this.handleMouseUp(e)}this.currentTarget=e.getTarget();this.dragCurrent=g;var a=g.getEl();this.startX=e.getPageX();this.startY=e.getPageY();this.deltaX=this.startX-a.offsetLeft;this.deltaY=this.startY-a.offsetTop;this.dragThreshMet=false;this.clickTimeout=setTimeout(function(){var c=Ext.dd.DDM;c.startDrag(c.startX,c.startY)},this.clickTimeThresh)},startDrag:function(a,d){clearTimeout(this.clickTimeout);if(this.dragCurrent){this.dragCurrent.b4StartDrag(a,d);this.dragCurrent.startDrag(a,d)}this.dragThreshMet=true},handleMouseUp:function(a){if(Ext.QuickTips){Ext.QuickTips.ddEnable()}if(!this.dragCurrent){return}clearTimeout(this.clickTimeout);if(this.dragThreshMet){this.fireEvents(a,true)}else{}this.stopDrag(a);this.stopEvent(a)},stopEvent:function(a){if(this.stopPropagation){a.stopPropagation()}if(this.preventDefault){a.preventDefault()}},stopDrag:function(a){if(this.dragCurrent){if(this.dragThreshMet){this.dragCurrent.b4EndDrag(a);this.dragCurrent.endDrag(a)}this.dragCurrent.onMouseUp(a)}this.dragCurrent=null;this.dragOvers={}},handleMouseMove:function(e){if(!this.dragCurrent){return true}if(Ext.isIE&&(e.button!==0&&e.button!==1&&e.button!==2)){this.stopEvent(e);return this.handleMouseUp(e)}if(!this.dragThreshMet){var g=Math.abs(this.startX-e.getPageX());var a=Math.abs(this.startY-e.getPageY());if(g>this.clickPixelThresh||a>this.clickPixelThresh){this.startDrag(this.startX,this.startY)}}if(this.dragThreshMet){this.dragCurrent.b4Drag(e);this.dragCurrent.onDrag(e);if(!this.dragCurrent.moveOnly){this.fireEvents(e,false)}}this.stopEvent(e);return true},fireEvents:function(i,e){var E=this.dragCurrent;if(!E||E.isLocked()){return}var D=i.getPoint();var C=[];var z=[];var v=[];var x=[];var A=[];for(var y in this.dragOvers){var B=this.dragOvers[y];if(!this.isTypeOfDD(B)){continue}if(!this.isOverTarget(D,B,this.mode)){z.push(B)}C[y]=true;delete this.dragOvers[y]}for(var a in E.groups){if("string"!=typeof a){continue}for(y in this.ids[a]){var w=this.ids[a][y];if(!this.isTypeOfDD(w)){continue}if(w.isTarget&&!w.isLocked()&&((w!=E)||(E.ignoreSelf===false))){if(this.isOverTarget(D,w,this.mode)){if(e){x.push(w)}else{if(!C[w.id]){A.push(w)}else{v.push(w)}this.dragOvers[w.id]=w}}}}}if(this.mode){if(z.length){E.b4DragOut(i,z);E.onDragOut(i,z)}if(A.length){E.onDragEnter(i,A)}if(v.length){E.b4DragOver(i,v);E.onDragOver(i,v)}if(x.length){E.b4DragDrop(i,x);E.onDragDrop(i,x)}}else{var u=0;for(y=0,u=z.length;y<u;++y){E.b4DragOut(i,z[y].id);E.onDragOut(i,z[y].id)}for(y=0,u=A.length;y<u;++y){E.onDragEnter(i,A[y].id)}for(y=0,u=v.length;y<u;++y){E.b4DragOver(i,v[y].id);E.onDragOver(i,v[y].id)}for(y=0,u=x.length;y<u;++y){E.b4DragDrop(i,x[y].id);E.onDragDrop(i,x[y].id)}}if(e&&!x.length){E.onInvalidDrop(i)}},getBestMatch:function(k){var h=null;var l=k.length;if(l==1){h=k[0]}else{for(var i=0;i<l;++i){var a=k[i];if(a.cursorIsOver){h=a;break}else{if(!h||h.overlap.getArea()<a.overlap.getArea()){h=a
}}}}return h},refreshCache:function(l){for(var a in l){if("string"!=typeof a){continue}for(var k in this.ids[a]){var i=this.ids[a][k];if(this.isTypeOfDD(i)){var h=this.getLocation(i);if(h){this.locationCache[i.id]=h}else{delete this.locationCache[i.id]}}}}},verifyEl:function(g){if(g){var a;if(Ext.isIE){try{a=g.offsetParent}catch(e){}}else{a=g.offsetParent}if(a){return true}}return false},getLocation:function(v){if(!this.isTypeOfDD(v)){return null}var x=v.getEl(),l,y,z,a,e,B,A,t,w;try{l=Ext.lib.Dom.getXY(x)}catch(u){}if(!l){return null}y=l[0];z=y+x.offsetWidth;a=l[1];e=a+x.offsetHeight;B=a-v.padding[0];A=z+v.padding[1];t=e+v.padding[2];w=y-v.padding[3];return new Ext.lib.Region(B,A,t,w)},isOverTarget:function(a,u,s){var p=this.locationCache[u.id];if(!p||!this.useCache){p=this.getLocation(u);this.locationCache[u.id]=p}if(!p){return false}u.cursorIsOver=p.contains(a);var m=this.dragCurrent;if(!m||!m.getTargetCoord||(!s&&!m.constrainX&&!m.constrainY)){return u.cursorIsOver}u.overlap=null;var o=m.getTargetCoord(a.x,a.y);var t=m.getDragEl();var q=new Ext.lib.Region(o.y,o.x+t.offsetWidth,o.y+t.offsetHeight,o.x);var n=q.intersect(p);if(n){u.overlap=n;return(s)?true:u.cursorIsOver}else{return false}},_onUnload:function(d,a){Ext.dd.DragDropMgr.unregAll()},unregAll:function(){if(this.dragCurrent){this.stopDrag();this.dragCurrent=null}this._execOnAll("unreg",[]);for(var a in this.elementCache){delete this.elementCache[a]}this.elementCache={};this.ids={}},elementCache:{},getElWrapper:function(d){var a=this.elementCache[d];if(!a||!a.el){a=this.elementCache[d]=new this.ElementWrapper(Ext.getDom(d))}return a},getElement:function(a){return Ext.getDom(a)},getCss:function(d){var a=Ext.getDom(d);return(a)?a.style:null},ElementWrapper:function(a){this.el=a||null;this.id=this.el&&a.id;this.css=this.el&&a.style},getPosX:function(a){return Ext.lib.Dom.getX(a)},getPosY:function(a){return Ext.lib.Dom.getY(a)},swapNode:function(h,a){if(h.swapNode){h.swapNode(a)}else{var g=a.parentNode;var i=a.nextSibling;if(i==h){g.insertBefore(h,a)}else{if(a==h.nextSibling){g.insertBefore(a,h)}else{h.parentNode.replaceChild(a,h);g.insertBefore(h,i)}}}},getScroll:function(){var h,a,g=document.documentElement,i=document.body;if(g&&(g.scrollTop||g.scrollLeft)){h=g.scrollTop;a=g.scrollLeft}else{if(i){h=i.scrollTop;a=i.scrollLeft}else{}}return{top:h,left:a}},getStyle:function(d,a){return Ext.fly(d).getStyle(a)},getScrollTop:function(){return this.getScroll().top},getScrollLeft:function(){return this.getScroll().left},moveToEl:function(a,e){var g=Ext.lib.Dom.getXY(e);Ext.lib.Dom.setXY(a,g)},numericSort:function(a,e){return(a-e)},_timeoutCount:0,_addListeners:function(){var a=Ext.dd.DDM;if(Ext.lib.Event&&document){a._onLoad()}else{if(a._timeoutCount>2000){}else{setTimeout(a._addListeners,10);if(document&&document.body){a._timeoutCount+=1}}}},handleWasClicked:function(a,e){if(this.isHandle(e,a.id)){return true}else{var g=a.parentNode;while(g){if(this.isHandle(e,g.id)){return true}else{g=g.parentNode}}}return false}}}();Ext.dd.DDM=Ext.dd.DragDropMgr;Ext.dd.DDM._addListeners()}Ext.dd.DD=function(g,e,d){if(g){this.init(g,e,d)}};Ext.extend(Ext.dd.DD,Ext.dd.DragDrop,{scroll:true,autoOffset:function(i,e){var g=i-this.startPageX;var h=e-this.startPageY;this.setDelta(g,h)},setDelta:function(c,d){this.deltaX=c;this.deltaY=d},setDragElPos:function(g,d){var e=this.getDragEl();this.alignElWithMouse(e,g,d)},alignElWithMouse:function(s,n,o){var p=this.getTargetCoord(n,o);var k=s.dom?s:Ext.fly(s,"_dd");if(!this.deltaSetXY){var m=[p.x,p.y];k.setXY(m);var q=k.getLeft(true);var l=k.getTop(true);this.deltaSetXY=[q-p.x,l-p.y]}else{k.setLeftTop(p.x+this.deltaSetXY[0],p.y+this.deltaSetXY[1])}this.cachePosition(p.x,p.y);this.autoScroll(p.x,p.y,s.offsetHeight,s.offsetWidth);return p},cachePosition:function(d,e){if(d){this.lastPageX=d;this.lastPageY=e}else{var g=Ext.lib.Dom.getXY(this.getEl());this.lastPageX=g[0];this.lastPageY=g[1]}},autoScroll:function(v,w,A,u){if(this.scroll){var t=Ext.lib.Dom.getViewHeight();
var D=Ext.lib.Dom.getViewWidth();var h=this.DDM.getScrollTop();var B=this.DDM.getScrollLeft();var x=A+w;var s=u+v;var y=(t+h-w-this.deltaY);var z=(D+B-v-this.deltaX);var C=40;var E=(document.all)?80:30;if(x>t&&y<C){window.scrollTo(B,h+E)}if(w<h&&h>0&&w-h<C){window.scrollTo(B,h-E)}if(s>D&&z<C){window.scrollTo(B+E,h)}if(v<B&&B>0&&v-B<C){window.scrollTo(B-E,h)}}},getTargetCoord:function(i,e){var g=i-this.deltaX;var h=e-this.deltaY;if(this.constrainX){if(g<this.minX){g=this.minX}if(g>this.maxX){g=this.maxX}}if(this.constrainY){if(h<this.minY){h=this.minY}if(h>this.maxY){h=this.maxY}}g=this.getTick(g,this.xTicks);h=this.getTick(h,this.yTicks);return{x:g,y:h}},applyConfig:function(){Ext.dd.DD.superclass.applyConfig.call(this);this.scroll=(this.config.scroll!==false)},b4MouseDown:function(b){this.autoOffset(b.getPageX(),b.getPageY())},b4Drag:function(b){this.setDragElPos(b.getPageX(),b.getPageY())},toString:function(){return("DD "+this.id)}});Ext.dd.DDProxy=function(g,e,d){if(g){this.init(g,e,d);this.initFrame()}};Ext.dd.DDProxy.dragElId="ygddfdiv";Ext.extend(Ext.dd.DDProxy,Ext.dd.DD,{resizeFrame:true,centerFrame:false,createFrame:function(){var e=this;var g=document.body;if(!g||!g.firstChild){setTimeout(function(){e.createFrame()},50);return}var h=this.getDragEl();if(!h){h=document.createElement("div");h.id=this.dragElId;var i=h.style;i.position="absolute";i.visibility="hidden";i.cursor="move";i.border="2px solid #aaa";i.zIndex=999;g.insertBefore(h,g.firstChild)}},initFrame:function(){this.createFrame()},applyConfig:function(){Ext.dd.DDProxy.superclass.applyConfig.call(this);this.resizeFrame=(this.config.resizeFrame!==false);this.centerFrame=(this.config.centerFrame);this.setDragElId(this.config.dragElId||Ext.dd.DDProxy.dragElId)},showFrame:function(i,k){var l=this.getEl();var h=this.getDragEl();var g=h.style;this._resizeProxy();if(this.centerFrame){this.setDelta(Math.round(parseInt(g.width,10)/2),Math.round(parseInt(g.height,10)/2))}this.setDragElPos(i,k);Ext.fly(h).show()},_resizeProxy:function(){if(this.resizeFrame){var b=this.getEl();Ext.fly(this.getDragEl()).setSize(b.offsetWidth,b.offsetHeight)}},b4MouseDown:function(d){var e=d.getPageX();var g=d.getPageY();this.autoOffset(e,g);this.setDragElPos(e,g)},b4StartDrag:function(d,c){this.showFrame(d,c)},b4EndDrag:function(b){Ext.fly(this.getDragEl()).hide()},endDrag:function(g){var d=this.getEl();var e=this.getDragEl();e.style.visibility="";this.beforeMove();d.style.visibility="hidden";Ext.dd.DDM.moveToEl(d,e);e.style.visibility="hidden";d.style.visibility="";this.afterDrag()},beforeMove:function(){},afterDrag:function(){},toString:function(){return("DDProxy "+this.id)}});Ext.dd.DDTarget=function(g,e,d){if(g){this.initTarget(g,e,d)}};Ext.extend(Ext.dd.DDTarget,Ext.dd.DragDrop,{getDragEl:Ext.emptyFn,isValidHandleChild:Ext.emptyFn,startDrag:Ext.emptyFn,endDrag:Ext.emptyFn,onDrag:Ext.emptyFn,onDragDrop:Ext.emptyFn,onDragEnter:Ext.emptyFn,onDragOut:Ext.emptyFn,onDragOver:Ext.emptyFn,onInvalidDrop:Ext.emptyFn,onMouseDown:Ext.emptyFn,onMouseUp:Ext.emptyFn,setXConstraint:Ext.emptyFn,setYConstraint:Ext.emptyFn,resetConstraints:Ext.emptyFn,clearConstraints:Ext.emptyFn,clearTicks:Ext.emptyFn,setInitPosition:Ext.emptyFn,setDragElId:Ext.emptyFn,setHandleElId:Ext.emptyFn,setOuterHandleElId:Ext.emptyFn,addInvalidHandleClass:Ext.emptyFn,addInvalidHandleId:Ext.emptyFn,addInvalidHandleType:Ext.emptyFn,removeInvalidHandleClass:Ext.emptyFn,removeInvalidHandleId:Ext.emptyFn,removeInvalidHandleType:Ext.emptyFn,toString:function(){return("DDTarget "+this.id)}});Ext.dd.DragTracker=Ext.extend(Ext.util.Observable,{active:false,tolerance:5,autoStart:false,constructor:function(b){Ext.apply(this,b);this.addEvents("mousedown","mouseup","mousemove","dragstart","dragend","drag");this.dragRegion=new Ext.lib.Region(0,0,0,0);if(this.el){this.initEl(this.el)}Ext.dd.DragTracker.superclass.constructor.call(this,b)},initEl:function(b){this.el=Ext.get(b);b.on("mousedown",this.onMouseDown,this,this.delegate?{delegate:this.delegate}:undefined)
},destroy:function(){this.el.un("mousedown",this.onMouseDown,this);delete this.el},onMouseDown:function(c,d){if(this.fireEvent("mousedown",this,c)!==false&&this.onBeforeStart(c)!==false){this.startXY=this.lastXY=c.getXY();this.dragTarget=this.delegate?d:this.el.dom;if(this.preventDefault!==false){c.preventDefault()}Ext.getDoc().on({scope:this,mouseup:this.onMouseUp,mousemove:this.onMouseMove,selectstart:this.stopSelect});if(this.autoStart){this.timer=this.triggerStart.defer(this.autoStart===true?1000:this.autoStart,this,[c])}}},onMouseMove:function(h,i){if(this.active&&Ext.isIE&&!h.browserEvent.button){h.preventDefault();this.onMouseUp(h);return}h.preventDefault();var e=h.getXY(),g=this.startXY;this.lastXY=e;if(!this.active){if(Math.abs(g[0]-e[0])>this.tolerance||Math.abs(g[1]-e[1])>this.tolerance){this.triggerStart(h)}else{return}}this.fireEvent("mousemove",this,h);this.onDrag(h);this.fireEvent("drag",this,h)},onMouseUp:function(g){var d=Ext.getDoc(),e=this.active;d.un("mousemove",this.onMouseMove,this);d.un("mouseup",this.onMouseUp,this);d.un("selectstart",this.stopSelect,this);g.preventDefault();this.clearStart();this.active=false;delete this.elRegion;this.fireEvent("mouseup",this,g);if(e){this.onEnd(g);this.fireEvent("dragend",this,g)}},triggerStart:function(b){this.clearStart();this.active=true;this.onStart(b);this.fireEvent("dragstart",this,b)},clearStart:function(){if(this.timer){clearTimeout(this.timer);delete this.timer}},stopSelect:function(b){b.stopEvent();return false},onBeforeStart:function(b){},onStart:function(b){},onDrag:function(b){},onEnd:function(b){},getDragTarget:function(){return this.dragTarget},getDragCt:function(){return this.el},getXY:function(b){return b?this.constrainModes[b].call(this,this.lastXY):this.lastXY},getOffset:function(g){var d=this.getXY(g),e=this.startXY;return[e[0]-d[0],e[1]-d[1]]},constrainModes:{point:function(c){if(!this.elRegion){this.elRegion=this.getDragCt().getRegion()}var d=this.dragRegion;d.left=c[0];d.top=c[1];d.right=c[0];d.bottom=c[1];d.constrainTo(this.elRegion);return[d.left,d.top]}}});Ext.dd.ScrollManager=function(){var u=Ext.dd.DragDropMgr;var s={};var v=null;var o={};var p=function(a){v=null;w()};var n=function(){if(u.dragCurrent){u.refreshCache(u.dragCurrent.groups)}};var t=function(){if(u.dragCurrent){var a=Ext.dd.ScrollManager;var b=o.el.ddScrollConfig?o.el.ddScrollConfig.increment:a.increment;if(!a.animate){if(o.el.scroll(o.dir,b)){n()}}else{o.el.scroll(o.dir,b,true,a.animDuration,n)}}};var w=function(){if(o.id){clearInterval(o.id)}o.id=0;o.el=null;o.dir=""};var q=function(d,a){w();o.el=d;o.dir=a;var b=d.ddScrollConfig?d.ddScrollConfig.ddGroup:undefined,c=(d.ddScrollConfig&&d.ddScrollConfig.frequency)?d.ddScrollConfig.frequency:Ext.dd.ScrollManager.frequency;if(b===undefined||u.dragCurrent.ddGroup==b){o.id=setInterval(t,c)}};var m=function(b,k){if(k||!u.dragCurrent){return}var i=Ext.dd.ScrollManager;if(!v||v!=u.dragCurrent){v=u.dragCurrent;i.refreshCache()}var h=Ext.lib.Event.getXY(b);var g=new Ext.lib.Point(h[0],h[1]);for(var d in s){var c=s[d],e=c._region;var a=c.ddScrollConfig?c.ddScrollConfig:i;if(e&&e.contains(g)&&c.isScrollable()){if(e.bottom-g.y<=a.vthresh){if(o.el!=c){q(c,"down")}return}else{if(e.right-g.x<=a.hthresh){if(o.el!=c){q(c,"left")}return}else{if(g.y-e.top<=a.vthresh){if(o.el!=c){q(c,"up")}return}else{if(g.x-e.left<=a.hthresh){if(o.el!=c){q(c,"right")}return}}}}}}w()};u.fireEvents=u.fireEvents.createSequence(m,u);u.stopDrag=u.stopDrag.createSequence(p,u);return{register:function(b){if(Ext.isArray(b)){for(var c=0,a=b.length;c<a;c++){this.register(b[c])}}else{b=Ext.get(b);s[b.id]=b}},unregister:function(b){if(Ext.isArray(b)){for(var c=0,a=b.length;c<a;c++){this.unregister(b[c])}}else{b=Ext.get(b);delete s[b.id]}},vthresh:25,hthresh:25,increment:100,frequency:500,animate:true,animDuration:0.4,ddGroup:undefined,refreshCache:function(){for(var a in s){if(typeof s[a]=="object"){s[a]._region=s[a].getRegion()}}}}}();Ext.dd.Registry=function(){var h={};var e={};
var g=0;var i=function(b,c){if(typeof b=="string"){return b}var a=b.id;if(!a&&c!==false){a="extdd-"+(++g);b.id=a}return a};return{register:function(b,a){a=a||{};if(typeof b=="string"){b=document.getElementById(b)}a.ddel=b;h[i(b)]=a;if(a.isHandle!==false){e[a.ddel.id]=a}if(a.handles){var c=a.handles;for(var d=0,m=c.length;d<m;d++){e[i(c[d])]=a}}},unregister:function(c){var a=i(c,false);var b=h[a];if(b){delete h[a];if(b.handles){var d=b.handles;for(var n=0,o=d.length;n<o;n++){delete e[i(d[n],false)]}}}},getHandle:function(a){if(typeof a!="string"){a=a.id}return e[a]},getHandleFromEvent:function(a){var b=Ext.lib.Event.getTarget(a);return b?e[b.id]:null},getTarget:function(a){if(typeof a!="string"){a=a.id}return h[a]},getTargetFromEvent:function(a){var b=Ext.lib.Event.getTarget(a);return b?h[b.id]||e[b.id]:null}}}();Ext.dd.StatusProxy=function(b){Ext.apply(this,b);this.id=this.id||Ext.id();this.el=new Ext.Layer({dh:{id:this.id,tag:"div",cls:"x-dd-drag-proxy "+this.dropNotAllowed,children:[{tag:"div",cls:"x-dd-drop-icon"},{tag:"div",cls:"x-dd-drag-ghost"}]},shadow:!b||b.shadow!==false});this.ghost=Ext.get(this.el.dom.childNodes[1]);this.dropStatus=this.dropNotAllowed};Ext.dd.StatusProxy.prototype={dropAllowed:"x-dd-drop-ok",dropNotAllowed:"x-dd-drop-nodrop",setStatus:function(b){b=b||this.dropNotAllowed;if(this.dropStatus!=b){this.el.replaceClass(this.dropStatus,b);this.dropStatus=b}},reset:function(b){this.el.dom.className="x-dd-drag-proxy "+this.dropNotAllowed;this.dropStatus=this.dropNotAllowed;if(b){this.ghost.update("")}},update:function(d){if(typeof d=="string"){this.ghost.update(d)}else{this.ghost.update("");d.style.margin="0";this.ghost.dom.appendChild(d)}var c=this.ghost.dom.firstChild;if(c){Ext.fly(c).setStyle("float","none")}},getEl:function(){return this.el},getGhost:function(){return this.ghost},hide:function(b){this.el.hide();if(b){this.reset(true)}},stop:function(){if(this.anim&&this.anim.isAnimated&&this.anim.isAnimated()){this.anim.stop()}},show:function(){this.el.show()},sync:function(){this.el.sync()},repair:function(d,g,e){this.callback=g;this.scope=e;if(d&&this.animRepair!==false){this.el.addClass("x-dd-drag-repair");this.el.hideUnders(true);this.anim=this.el.shift({duration:this.repairDuration||0.5,easing:"easeOut",xy:d,stopFx:true,callback:this.afterRepair,scope:this})}else{this.afterRepair()}},afterRepair:function(){this.hide(true);if(typeof this.callback=="function"){this.callback.call(this.scope||this)}this.callback=null;this.scope=null},destroy:function(){Ext.destroy(this.ghost,this.el)}};Ext.dd.DragSource=function(c,d){this.el=Ext.get(c);if(!this.dragData){this.dragData={}}Ext.apply(this,d);if(!this.proxy){this.proxy=new Ext.dd.StatusProxy()}Ext.dd.DragSource.superclass.constructor.call(this,this.el.dom,this.ddGroup||this.group,{dragElId:this.proxy.id,resizeFrame:false,isTarget:false,scroll:this.scroll===true});this.dragging=false};Ext.extend(Ext.dd.DragSource,Ext.dd.DDProxy,{dropAllowed:"x-dd-drop-ok",dropNotAllowed:"x-dd-drop-nodrop",getDragData:function(b){return this.dragData},onDragEnter:function(i,h){var e=Ext.dd.DragDropMgr.getDDById(h);this.cachedTarget=e;if(this.beforeDragEnter(e,i,h)!==false){if(e.isNotifyTarget){var g=e.notifyEnter(this,i,this.dragData);this.proxy.setStatus(g)}else{this.proxy.setStatus(this.dropAllowed)}if(this.afterDragEnter){this.afterDragEnter(e,i,h)}}},beforeDragEnter:function(d,e,g){return true},alignElWithMouse:function(){Ext.dd.DragSource.superclass.alignElWithMouse.apply(this,arguments);this.proxy.sync()},onDragOver:function(i,h){var e=this.cachedTarget||Ext.dd.DragDropMgr.getDDById(h);if(this.beforeDragOver(e,i,h)!==false){if(e.isNotifyTarget){var g=e.notifyOver(this,i,this.dragData);this.proxy.setStatus(g)}if(this.afterDragOver){this.afterDragOver(e,i,h)}}},beforeDragOver:function(d,e,g){return true},onDragOut:function(d,g){var e=this.cachedTarget||Ext.dd.DragDropMgr.getDDById(g);if(this.beforeDragOut(e,d,g)!==false){if(e.isNotifyTarget){e.notifyOut(this,d,this.dragData)
}this.proxy.reset();if(this.afterDragOut){this.afterDragOut(e,d,g)}}this.cachedTarget=null},beforeDragOut:function(d,e,g){return true},onDragDrop:function(d,g){var e=this.cachedTarget||Ext.dd.DragDropMgr.getDDById(g);if(this.beforeDragDrop(e,d,g)!==false){if(e.isNotifyTarget){if(e.notifyDrop(this,d,this.dragData)){this.onValidDrop(e,d,g)}else{this.onInvalidDrop(e,d,g)}}else{this.onValidDrop(e,d,g)}if(this.afterDragDrop){this.afterDragDrop(e,d,g)}}delete this.cachedTarget},beforeDragDrop:function(d,e,g){return true},onValidDrop:function(d,e,g){this.hideProxy();if(this.afterValidDrop){this.afterValidDrop(d,e,g)}},getRepairXY:function(c,d){return this.el.getXY()},onInvalidDrop:function(d,e,g){this.beforeInvalidDrop(d,e,g);if(this.cachedTarget){if(this.cachedTarget.isNotifyTarget){this.cachedTarget.notifyOut(this,e,this.dragData)}this.cacheTarget=null}this.proxy.repair(this.getRepairXY(e,this.dragData),this.afterRepair,this);if(this.afterInvalidDrop){this.afterInvalidDrop(e,g)}},afterRepair:function(){if(Ext.enableFx){this.el.highlight(this.hlColor||"c3daf9")}this.dragging=false},beforeInvalidDrop:function(d,e,g){return true},handleMouseDown:function(c){if(this.dragging){return}var d=this.getDragData(c);if(d&&this.onBeforeDrag(d,c)!==false){this.dragData=d;this.proxy.stop();Ext.dd.DragSource.superclass.handleMouseDown.apply(this,arguments)}},onBeforeDrag:function(d,c){return true},onStartDrag:Ext.emptyFn,startDrag:function(d,c){this.proxy.reset();this.dragging=true;this.proxy.update("");this.onInitDrag(d,c);this.proxy.show()},onInitDrag:function(e,g){var d=this.el.dom.cloneNode(true);d.id=Ext.id();this.proxy.update(d);this.onStartDrag(e,g);return true},getProxy:function(){return this.proxy},hideProxy:function(){this.proxy.hide();this.proxy.reset(true);this.dragging=false},triggerCacheRefresh:function(){Ext.dd.DDM.refreshCache(this.groups)},b4EndDrag:function(b){},endDrag:function(b){this.onEndDrag(this.dragData,b)},onEndDrag:function(d,c){},autoOffset:function(d,c){this.setDelta(-12,-20)},destroy:function(){Ext.dd.DragSource.superclass.destroy.call(this);Ext.destroy(this.proxy)}});Ext.dd.DropTarget=Ext.extend(Ext.dd.DDTarget,{constructor:function(c,d){this.el=Ext.get(c);Ext.apply(this,d);if(this.containerScroll){Ext.dd.ScrollManager.register(this.el)}Ext.dd.DropTarget.superclass.constructor.call(this,this.el.dom,this.ddGroup||this.group,{isTarget:true})},dropAllowed:"x-dd-drop-ok",dropNotAllowed:"x-dd-drop-nodrop",isTarget:true,isNotifyTarget:true,notifyEnter:function(e,g,d){if(this.overClass){this.el.addClass(this.overClass)}return this.dropAllowed},notifyOver:function(e,g,d){return this.dropAllowed},notifyOut:function(e,g,d){if(this.overClass){this.el.removeClass(this.overClass)}},notifyDrop:function(e,g,d){return false},destroy:function(){Ext.dd.DropTarget.superclass.destroy.call(this);if(this.containerScroll){Ext.dd.ScrollManager.unregister(this.el)}}});Ext.dd.DragZone=Ext.extend(Ext.dd.DragSource,{constructor:function(c,d){Ext.dd.DragZone.superclass.constructor.call(this,c,d);if(this.containerScroll){Ext.dd.ScrollManager.register(this.el)}},getDragData:function(b){return Ext.dd.Registry.getHandleFromEvent(b)},onInitDrag:function(d,c){this.proxy.update(this.dragData.ddel.cloneNode(true));this.onStartDrag(d,c);return true},afterRepair:function(){if(Ext.enableFx){Ext.Element.fly(this.dragData.ddel).highlight(this.hlColor||"c3daf9")}this.dragging=false},getRepairXY:function(b){return Ext.Element.fly(this.dragData.ddel).getXY()},destroy:function(){Ext.dd.DragZone.superclass.destroy.call(this);if(this.containerScroll){Ext.dd.ScrollManager.unregister(this.el)}}});Ext.dd.DropZone=function(c,d){Ext.dd.DropZone.superclass.constructor.call(this,c,d)};Ext.extend(Ext.dd.DropZone,Ext.dd.DropTarget,{getTargetFromEvent:function(b){return Ext.dd.Registry.getTargetFromEvent(b)},onNodeEnter:function(h,g,i,e){},onNodeOver:function(h,g,i,e){return this.dropAllowed},onNodeOut:function(h,g,i,e){},onNodeDrop:function(h,g,i,e){return false},onContainerOver:function(e,g,d){return this.dropNotAllowed
},onContainerDrop:function(e,g,d){return false},notifyEnter:function(e,g,d){return this.dropNotAllowed},notifyOver:function(g,i,e){var h=this.getTargetFromEvent(i);if(!h){if(this.lastOverNode){this.onNodeOut(this.lastOverNode,g,i,e);this.lastOverNode=null}return this.onContainerOver(g,i,e)}if(this.lastOverNode!=h){if(this.lastOverNode){this.onNodeOut(this.lastOverNode,g,i,e)}this.onNodeEnter(h,g,i,e);this.lastOverNode=h}return this.onNodeOver(h,g,i,e)},notifyOut:function(e,g,d){if(this.lastOverNode){this.onNodeOut(this.lastOverNode,e,g,d);this.lastOverNode=null}},notifyDrop:function(g,i,e){if(this.lastOverNode){this.onNodeOut(this.lastOverNode,g,i,e);this.lastOverNode=null}var h=this.getTargetFromEvent(i);return h?this.onNodeDrop(h,g,i,e):this.onContainerDrop(g,i,e)},triggerCacheRefresh:function(){Ext.dd.DDM.refreshCache(this.groups)}});Ext.Element.addMethods({initDD:function(i,e,h){var g=new Ext.dd.DD(Ext.id(this.dom),i,e);return Ext.apply(g,h)},initDDProxy:function(i,e,h){var g=new Ext.dd.DDProxy(Ext.id(this.dom),i,e);return Ext.apply(g,h)},initDDTarget:function(i,e,h){var g=new Ext.dd.DDTarget(Ext.id(this.dom),i,e);return Ext.apply(g,h)}});Ext.data.Api=(function(){var b={};return{actions:{create:"create",read:"read",update:"update",destroy:"destroy"},restActions:{create:"POST",read:"GET",update:"PUT",destroy:"DELETE"},isAction:function(a){return(Ext.data.Api.actions[a])?true:false},getVerb:function(a){if(b[a]){return b[a]}for(var d in this.actions){if(this.actions[d]===a){b[a]=d;break}}return(b[a]!==undefined)?b[a]:null},isValid:function(a){var g=[];var h=this.actions;for(var i in a){if(!(i in h)){g.push(i)}}return(!g.length)?true:g},hasUniqueUrl:function(l,h){var a=(l.api[h])?l.api[h].url:null;var i=true;for(var k in l.api){if((i=(k===h)?true:(l.api[k].url!=a)?true:false)===false){break}}return i},prepare:function(a){if(!a.api){a.api={}}for(var e in this.actions){var g=this.actions[e];a.api[g]=a.api[g]||a.url||a.directFn;if(typeof(a.api[g])=="string"){a.api[g]={url:a.api[g],method:(a.restful===true)?Ext.data.Api.restActions[g]:undefined}}}},restify:function(a){a.restful=true;for(var d in this.restActions){a.api[this.actions[d]].method||(a.api[this.actions[d]].method=this.restActions[d])}a.onWrite=a.onWrite.createInterceptor(function(l,c,n,o){var p=c.reader;var m=new Ext.data.Response({action:l,raw:n});switch(n.status){case 200:return true;break;case 201:if(Ext.isEmpty(m.raw.responseText)){m.success=true}else{return true}break;case 204:m.success=true;m.data=null;break;default:return true;break}if(m.success===true){this.fireEvent("write",this,l,m.data,m,o,c.request.arg)}else{this.fireEvent("exception",this,"remote",l,c,m,o)}c.request.callback.call(c.request.scope,m.data,m,m.success);return false},a)}}})();Ext.data.Response=function(c,d){Ext.apply(this,c,{raw:d})};Ext.data.Response.prototype={message:null,success:false,status:null,root:null,raw:null,getMessage:function(){return this.message},getSuccess:function(){return this.success},getStatus:function(){return this.status},getRoot:function(){return this.root},getRawResponse:function(){return this.raw}};Ext.data.Api.Error=Ext.extend(Ext.Error,{constructor:function(c,d){this.arg=d;Ext.Error.call(this,c)},name:"Ext.data.Api"});Ext.apply(Ext.data.Api.Error.prototype,{lang:{"action-url-undefined":"No fallback url defined for this action.  When defining a DataProxy api, please be sure to define an url for each CRUD action in Ext.data.Api.actions or define a default url in addition to your api-configuration.",invalid:"received an invalid API-configuration.  Please ensure your proxy API-configuration contains only the actions defined in Ext.data.Api.actions","invalid-url":"Invalid url.  Please review your proxy configuration.",execute:'Attempted to execute an unknown action.  Valid API actions are defined in Ext.data.Api.actions"'}});Ext.data.SortTypes={none:function(b){return b},stripTagsRE:/<\/?[^>]+>/gi,asText:function(b){return String(b).replace(this.stripTagsRE,"")},asUCText:function(b){return String(b).toUpperCase().replace(this.stripTagsRE,"")
},asUCString:function(b){return String(b).toUpperCase()},asDate:function(b){if(!b){return 0}if(Ext.isDate(b)){return b.getTime()}return Date.parse(String(b))},asFloat:function(d){var c=parseFloat(String(d).replace(/,/g,""));return isNaN(c)?0:c},asInt:function(d){var c=parseInt(String(d).replace(/,/g,""),10);return isNaN(c)?0:c}};Ext.data.Record=function(d,c){this.id=(c||c===0)?c:Ext.data.Record.id(this);this.data=d||{}};Ext.data.Record.create=function(i){var l=Ext.extend(Ext.data.Record,{});var k=l.prototype;k.fields=new Ext.util.MixedCollection(false,function(a){return a.name});for(var g=0,h=i.length;g<h;g++){k.fields.add(new Ext.data.Field(i[g]))}l.getField=function(a){return k.fields.get(a)};return l};Ext.data.Record.PREFIX="ext-record";Ext.data.Record.AUTO_ID=1;Ext.data.Record.EDIT="edit";Ext.data.Record.REJECT="reject";Ext.data.Record.COMMIT="commit";Ext.data.Record.id=function(b){b.phantom=true;return[Ext.data.Record.PREFIX,"-",Ext.data.Record.AUTO_ID++].join("")};Ext.data.Record.prototype={dirty:false,editing:false,error:null,modified:null,phantom:false,join:function(b){this.store=b},set:function(e,g){var d=Ext.isPrimitive(g)?String:Ext.encode;if(d(this.data[e])==d(g)){return}this.dirty=true;if(!this.modified){this.modified={}}if(this.modified[e]===undefined){this.modified[e]=this.data[e]}this.data[e]=g;if(!this.editing){this.afterEdit()}},afterEdit:function(){if(this.store!=undefined&&typeof this.store.afterEdit=="function"){this.store.afterEdit(this)}},afterReject:function(){if(this.store){this.store.afterReject(this)}},afterCommit:function(){if(this.store){this.store.afterCommit(this)}},get:function(b){return this.data[b]},beginEdit:function(){this.editing=true;this.modified=this.modified||{}},cancelEdit:function(){this.editing=false;delete this.modified},endEdit:function(){this.editing=false;if(this.dirty){this.afterEdit()}},reject:function(d){var e=this.modified;for(var g in e){if(typeof e[g]!="function"){this.data[g]=e[g]}}this.dirty=false;delete this.modified;this.editing=false;if(d!==true){this.afterReject()}},commit:function(b){this.dirty=false;delete this.modified;this.editing=false;if(b!==true){this.afterCommit()}},getChanges:function(){var e=this.modified,d={};for(var g in e){if(e.hasOwnProperty(g)){d[g]=this.data[g]}}return d},hasError:function(){return this.error!==null},clearError:function(){this.error=null},copy:function(b){return new this.constructor(Ext.apply({},this.data),b||this.id)},isModified:function(b){return !!(this.modified&&this.modified.hasOwnProperty(b))},isValid:function(){return this.fields.find(function(b){return(b.allowBlank===false&&Ext.isEmpty(this.data[b.name]))?true:false},this)?false:true},markDirty:function(){this.dirty=true;if(!this.modified){this.modified={}}this.fields.each(function(b){this.modified[b.name]=this.data[b.name]},this)}};Ext.StoreMgr=Ext.apply(new Ext.util.MixedCollection(),{register:function(){for(var d=0,c;(c=arguments[d]);d++){this.add(c)}},unregister:function(){for(var d=0,c;(c=arguments[d]);d++){this.remove(this.lookup(c))}},lookup:function(i){if(Ext.isArray(i)){var g=["field1"],k=!Ext.isArray(i[0]);if(!k){for(var l=2,h=i[0].length;l<=h;++l){g.push("field"+l)}}return new Ext.data.ArrayStore({fields:g,data:i,expandData:k,autoDestroy:true,autoCreated:true})}return Ext.isObject(i)?(i.events?i:Ext.create(i,"store")):this.get(i)},getKey:function(b){return b.storeId}});Ext.data.Store=Ext.extend(Ext.util.Observable,{writer:undefined,remoteSort:false,autoDestroy:false,pruneModifiedRecords:false,lastOptions:null,autoSave:true,batch:true,restful:false,paramNames:undefined,defaultParamNames:{start:"start",limit:"limit",sort:"sort",dir:"dir"},isDestroyed:false,hasMultiSort:false,batchKey:"_ext_batch_",constructor:function(b){this.data=new Ext.util.MixedCollection(false);this.data.getKey=function(a){return a.id};this.removed=[];if(b&&b.data){this.inlineData=b.data;delete b.data}Ext.apply(this,b);this.baseParams=Ext.isObject(this.baseParams)?this.baseParams:{};this.paramNames=Ext.applyIf(this.paramNames||{},this.defaultParamNames);
if((this.url||this.api)&&!this.proxy){this.proxy=new Ext.data.HttpProxy({url:this.url,api:this.api})}if(this.restful===true&&this.proxy){this.batch=false;Ext.data.Api.restify(this.proxy)}if(this.reader){if(!this.recordType){this.recordType=this.reader.recordType}if(this.reader.onMetaChange){this.reader.onMetaChange=this.reader.onMetaChange.createSequence(this.onMetaChange,this)}if(this.writer){if(this.writer instanceof (Ext.data.DataWriter)===false){this.writer=this.buildWriter(this.writer)}this.writer.meta=this.reader.meta;this.pruneModifiedRecords=true}}if(this.recordType){this.fields=this.recordType.prototype.fields}this.modified=[];this.addEvents("datachanged","metachange","add","remove","update","clear","exception","beforeload","load","loadexception","beforewrite","write","beforesave","save");if(this.proxy){this.relayEvents(this.proxy,["loadexception","exception"])}if(this.writer){this.on({scope:this,add:this.createRecords,remove:this.destroyRecord,update:this.updateRecord,clear:this.onClear})}this.sortToggle={};if(this.sortField){this.setDefaultSort(this.sortField,this.sortDir)}else{if(this.sortInfo){this.setDefaultSort(this.sortInfo.field,this.sortInfo.direction)}}Ext.data.Store.superclass.constructor.call(this);if(this.id){this.storeId=this.id;delete this.id}if(this.storeId){Ext.StoreMgr.register(this)}if(this.inlineData){this.loadData(this.inlineData);delete this.inlineData}else{if(this.autoLoad){this.load.defer(10,this,[typeof this.autoLoad=="object"?this.autoLoad:undefined])}}this.batchCounter=0;this.batches={}},buildWriter:function(d){var e=undefined,g=(d.format||"json").toLowerCase();switch(g){case"json":e=Ext.data.JsonWriter;break;case"xml":e=Ext.data.XmlWriter;break;default:e=Ext.data.JsonWriter}return new e(d)},destroy:function(){if(!this.isDestroyed){if(this.storeId){Ext.StoreMgr.unregister(this)}this.clearData();this.data=null;Ext.destroy(this.proxy);this.reader=this.writer=null;this.purgeListeners();this.isDestroyed=true}},add:function(e){var h,g,i;e=[].concat(e);if(e.length<1){return}for(h=0,len=e.length;h<len;h++){g=e[h];g.join(this);if(g.dirty||g.phantom){this.modified.push(g)}}i=this.data.length;this.data.addAll(e);if(this.snapshot){this.snapshot.addAll(e)}this.fireEvent("add",this,e,i)},addSorted:function(d){var c=this.findInsertIndex(d);this.insert(c,d)},doUpdate:function(b){this.data.replace(b.id,b);if(this.snapshot){this.snapshot.replace(b.id,b)}this.fireEvent("update",this,b,Ext.data.Record.COMMIT)},remove:function(d){if(Ext.isArray(d)){Ext.each(d,function(a){this.remove(a)},this);return}var c=this.data.indexOf(d);if(c>-1){d.join(null);this.data.removeAt(c)}if(this.pruneModifiedRecords){this.modified.remove(d)}if(this.snapshot){this.snapshot.remove(d)}if(c>-1){this.fireEvent("remove",this,d,c)}},removeAt:function(b){this.remove(this.getAt(b))},removeAll:function(c){var d=[];this.each(function(a){d.push(a)});this.clearData();if(this.snapshot){this.snapshot.clear()}if(this.pruneModifiedRecords){this.modified=[]}if(c!==true){this.fireEvent("clear",this,d)}},onClear:function(c,d){Ext.each(d,function(a,b){this.destroyRecord(this,a,b)},this)},insert:function(i,e){var h,g;e=[].concat(e);for(h=0,len=e.length;h<len;h++){g=e[h];this.data.insert(i+h,g);g.join(this);if(g.dirty||g.phantom){this.modified.push(g)}}if(this.snapshot){this.snapshot.addAll(e)}this.fireEvent("add",this,e,i)},indexOf:function(b){return this.data.indexOf(b)},indexOfId:function(b){return this.data.indexOfKey(b)},getById:function(b){return(this.snapshot||this.data).key(b)},getAt:function(b){return this.data.itemAt(b)},getRange:function(c,d){return this.data.getRange(c,d)},storeOptions:function(b){b=Ext.apply({},b);delete b.callback;delete b.scope;this.lastOptions=b},clearData:function(){this.data.each(function(b){b.join(null)});this.data.clear()},load:function(d){d=Ext.apply({},d);this.storeOptions(d);if(this.sortInfo&&this.remoteSort){var e=this.paramNames;d.params=Ext.apply({},d.params);d.params[e.sort]=this.sortInfo.field;d.params[e.dir]=this.sortInfo.direction
}try{return this.execute("read",null,d)}catch(g){this.handleException(g);return false}},updateRecord:function(d,e,g){if(g==Ext.data.Record.EDIT&&this.autoSave===true&&(!e.phantom||(e.phantom&&e.isValid()))){this.save()}},createRecords:function(p,i,n){var o=this.modified,l=i.length,k,m;for(m=0;m<l;m++){k=i[m];if(k.phantom&&k.isValid()){k.markDirty();if(o.indexOf(k)==-1){o.push(k)}}}if(this.autoSave===true){this.save()}},destroyRecord:function(d,e,g){if(this.modified.indexOf(e)!=-1){this.modified.remove(e)}if(!e.phantom){this.removed.push(e);e.lastIndex=g;if(this.autoSave===true){this.save()}}},execute:function(i,h,l,g){if(!Ext.data.Api.isAction(i)){throw new Ext.data.Api.Error("execute",i)}l=Ext.applyIf(l||{},{params:{}});if(g!==undefined){this.addToBatch(g)}var k=true;if(i==="read"){k=this.fireEvent("beforeload",this,l);Ext.applyIf(l.params,this.baseParams)}else{if(this.writer.listful===true&&this.restful!==true){h=(Ext.isArray(h))?h:[h]}else{if(Ext.isArray(h)&&h.length==1){h=h.shift()}}if((k=this.fireEvent("beforewrite",this,i,h,l))!==false){this.writer.apply(l.params,this.baseParams,i,h)}}if(k!==false){if(this.writer&&this.proxy.url&&!this.proxy.restful&&!Ext.data.Api.hasUniqueUrl(this.proxy,i)){l.params.xaction=i}this.proxy.request(Ext.data.Api.actions[i],h,l.params,this.reader,this.createCallback(i,h,g),this,l)}return k},save:function(){if(!this.writer){throw new Ext.data.Store.Error("writer-undefined")}var n=[],m,i,p,s={},q;if(this.removed.length){n.push(["destroy",this.removed])}var t=[].concat(this.getModifiedRecords());if(t.length){var o=[];for(q=t.length-1;q>=0;q--){if(t[q].phantom===true){var u=t.splice(q,1).shift();if(u.isValid()){o.push(u)}}else{if(!t[q].isValid()){t.splice(q,1)}}}if(o.length){n.push(["create",o])}if(t.length){n.push(["update",t])}}m=n.length;if(m){p=++this.batchCounter;for(q=0;q<m;++q){i=n[q];s[i[0]]=i[1]}if(this.fireEvent("beforesave",this,s)!==false){for(q=0;q<m;++q){i=n[q];this.doTransaction(i[0],i[1],p)}return p}}return -1},doTransaction:function(l,h,n){function k(b){try{this.execute(l,b,undefined,n)}catch(a){this.handleException(a)}}if(this.batch===false){for(var m=0,i=h.length;m<i;m++){k.call(this,h[m])}}else{k.call(this,h)}},addToBatch:function(i){var b=this.batches,h=this.batchKey+i,g=b[h];if(!g){b[h]=g={id:i,count:0,data:{}}}++g.count},removeFromBatch:function(o,l,m){var p=this.batches,n=this.batchKey+o,k=p[n],b;if(k){b=k.data[l]||[];k.data[l]=b.concat(m);if(k.count===1){m=k.data;delete p[n];this.fireEvent("save",this,o,m)}else{--k.count}}},createCallback:function(i,g,e){var h=Ext.data.Api.actions;return(i=="read")?this.loadRecords:function(b,c,a){this["on"+Ext.util.Format.capitalize(i)+"Records"](a,g,[].concat(b));if(a===true){this.fireEvent("write",this,i,b,c,g)}this.removeFromBatch(e,i,b)}},clearModified:function(d){if(Ext.isArray(d)){for(var c=d.length-1;c>=0;c--){this.modified.splice(this.modified.indexOf(d[c]),1)}}else{this.modified.splice(this.modified.indexOf(d),1)}},reMap:function(e){if(Ext.isArray(e)){for(var h=0,g=e.length;h<g;h++){this.reMap(e[h])}}else{delete this.data.map[e._phid];this.data.map[e.id]=e;var i=this.data.keys.indexOf(e._phid);this.data.keys.splice(i,1,e.id);delete e._phid}},onCreateRecords:function(h,g,e){if(h===true){try{this.reader.realize(g,e);this.reMap(g)}catch(i){this.handleException(i);if(Ext.isArray(g)){this.onCreateRecords(h,g,e)}}}},onUpdateRecords:function(h,g,e){if(h===true){try{this.reader.update(g,e)}catch(i){this.handleException(i);if(Ext.isArray(g)){this.onUpdateRecords(h,g,e)}}}},onDestroyRecords:function(i,g,k){g=(g instanceof Ext.data.Record)?[g]:[].concat(g);for(var l=0,h=g.length;l<h;l++){this.removed.splice(this.removed.indexOf(g[l]),1)}if(i===false){for(l=g.length-1;l>=0;l--){this.insert(g[l].lastIndex,g[l])}}},handleException:function(b){Ext.handleError(b)},reload:function(b){this.load(Ext.applyIf(b||{},this.lastOptions))},loadRecords:function(t,i,o){var p;if(this.isDestroyed===true){return}if(!t||o===false){if(o!==false){this.fireEvent("load",this,[],i)
}if(i.callback){i.callback.call(i.scope||this,[],i,false,t)}return}var u=t.records,n=t.totalRecords||u.length;if(!i||i.add!==true){if(this.pruneModifiedRecords){this.modified=[]}for(p=0,len=u.length;p<len;p++){u[p].join(this)}if(this.snapshot){this.data=this.snapshot;delete this.snapshot}this.clearData();this.data.addAll(u);this.totalLength=n;this.applySort();this.fireEvent("datachanged",this)}else{var m=[],q,s=0;for(p=0,len=u.length;p<len;++p){q=u[p];if(this.indexOfId(q.id)>-1){this.doUpdate(q)}else{m.push(q);++s}}this.totalLength=Math.max(n,this.data.length+s);this.add(m)}this.fireEvent("load",this,u,i);if(i.callback){i.callback.call(i.scope||this,u,i,true)}},loadData:function(g,e){var d=this.reader.readRecords(g);this.loadRecords(d,{add:e},true)},getCount:function(){return this.data.length||0},getTotalCount:function(){return this.totalLength||0},getSortState:function(){return this.sortInfo},applySort:function(){if((this.sortInfo||this.multiSortInfo)&&!this.remoteSort){this.sortData()}},sortData:function(){var l=this.hasMultiSort?this.multiSortInfo:this.sortInfo,m=l.direction||"ASC",n=l.sorters,s=[];if(!this.hasMultiSort){n=[{direction:m,field:l.field}]}for(var q=0,i=n.length;q<i;q++){s.push(this.createSortFunction(n[q].field,n[q].direction))}if(s.length==0){return}var o=m.toUpperCase()=="DESC"?-1:1;var p=function(e,a){var b=s[0].call(this,e,a);if(s.length>1){for(var c=1,d=s.length;c<d;c++){b=b||s[c].call(this,e,a)}}return o*b};this.data.sort(m,p);if(this.snapshot&&this.snapshot!=this.data){this.snapshot.sort(m,p)}},createSortFunction:function(i,e){e=e||"ASC";var g=e.toUpperCase()=="DESC"?-1:1;var h=this.fields.get(i).sortType;return function(c,d){var a=h(c.data[i]),b=h(d.data[i]);return g*(a>b?1:(a<b?-1:0))}},setDefaultSort:function(c,d){d=d?d.toUpperCase():"ASC";this.sortInfo={field:c,direction:d};this.sortToggle[c]=d},sort:function(c,d){if(Ext.isArray(arguments[0])){return this.multiSort.call(this,c,d)}else{return this.singleSort(c,d)}},singleSort:function(k,n){var l=this.fields.get(k);if(!l){return false}var h=l.name,i=this.sortInfo||null,m=this.sortToggle?this.sortToggle[h]:null;if(!n){if(i&&i.field==h){n=(this.sortToggle[h]||"ASC").toggle("ASC","DESC")}else{n=l.sortDir}}this.sortToggle[h]=n;this.sortInfo={field:h,direction:n};this.hasMultiSort=false;if(this.remoteSort){if(!this.load(this.lastOptions)){if(m){this.sortToggle[h]=m}if(i){this.sortInfo=i}}}else{this.applySort();this.fireEvent("datachanged",this)}return true},multiSort:function(c,d){this.hasMultiSort=true;d=d||"ASC";if(this.multiSortInfo&&d==this.multiSortInfo.direction){d=d.toggle("ASC","DESC")}this.multiSortInfo={sorters:c,direction:d};if(this.remoteSort){this.singleSort(c[0].field,c[0].direction)}else{this.applySort();this.fireEvent("datachanged",this)}},each:function(c,d){this.data.each(c,d)},getModifiedRecords:function(){return this.modified},sum:function(l,k,i){var n=this.data.items,h=0;k=k||0;i=(i||i===0)?i:n.length-1;for(var m=k;m<=i;m++){h+=(n[m].data[l]||0)}return h},createFilterFn:function(k,l,i,h,g){if(Ext.isEmpty(l,false)){return false}l=this.data.createValueMatcher(l,i,h,g);return function(a){return l.test(a.data[k])}},createMultipleFilterFn:function(b){return function(a){var i=true;for(var o=0,p=b.length;o<p;o++){var l=b[o],m=l.fn,n=l.scope;i=i&&m.call(n,a)}return i}},filter:function(p,q,u,t,w){var s;if(Ext.isObject(p)){p=[p]}if(Ext.isArray(p)){var z=[];for(var v=0,x=p.length;v<x;v++){var A=p[v],y=A.fn,i=A.scope||this;if(!Ext.isFunction(y)){y=this.createFilterFn(A.property,A.value,A.anyMatch,A.caseSensitive,A.exactMatch)}z.push({fn:y,scope:i})}s=this.createMultipleFilterFn(z)}else{s=this.createFilterFn(p,q,u,t,w)}return s?this.filterBy(s):this.clearFilter()},filterBy:function(c,d){this.snapshot=this.snapshot||this.data;this.data=this.queryBy(c,d||this);this.fireEvent("datachanged",this)},clearFilter:function(b){if(this.isFiltered()){this.data=this.snapshot;delete this.snapshot;if(b!==true){this.fireEvent("datachanged",this)}}},isFiltered:function(){return !!this.snapshot&&this.snapshot!=this.data
},query:function(k,l,i,h){var g=this.createFilterFn(k,l,i,h);return g?this.queryBy(g):this.data.clone()},queryBy:function(d,e){var g=this.snapshot||this.data;return g.filterBy(d,e||this)},find:function(m,n,k,l,i){var h=this.createFilterFn(m,n,l,i);return h?this.data.findIndexBy(h,null,k):-1},findExact:function(d,e,g){return this.data.findIndexBy(function(a){return a.get(d)===e},this,g)},findBy:function(d,e,g){return this.data.findIndexBy(d,e,g)},collect:function(p,l,v){var q=(v===true&&this.snapshot)?this.snapshot.items:this.data.items;var i,d,w=[],u={};for(var t=0,s=q.length;t<s;t++){i=q[t].data[p];d=String(i);if((l||!Ext.isEmpty(i))&&!u[d]){u[d]=true;w[w.length]=i}}return w},afterEdit:function(b){if(this.modified.indexOf(b)==-1){this.modified.push(b)}this.fireEvent("update",this,b,Ext.data.Record.EDIT)},afterReject:function(b){this.modified.remove(b);this.fireEvent("update",this,b,Ext.data.Record.REJECT)},afterCommit:function(b){this.modified.remove(b);this.fireEvent("update",this,b,Ext.data.Record.COMMIT)},commitChanges:function(){var e=this.modified.slice(0),g=e.length,d;for(d=0;d<g;d++){e[d].commit()}this.modified=[];this.removed=[]},rejectChanges:function(){var h=this.modified.slice(0),i=this.removed.slice(0).reverse(),l=h.length,k=i.length,g;for(g=0;g<l;g++){h[g].reject()}for(g=0;g<k;g++){this.insert(i[g].lastIndex||0,i[g]);i[g].reject()}this.modified=[];this.removed=[]},onMetaChange:function(b){this.recordType=this.reader.recordType;this.fields=this.recordType.prototype.fields;delete this.snapshot;if(this.reader.meta.sortInfo){this.sortInfo=this.reader.meta.sortInfo}else{if(this.sortInfo&&!this.fields.get(this.sortInfo.field)){delete this.sortInfo}}if(this.writer){this.writer.meta=this.reader.meta}this.modified=[];this.fireEvent("metachange",this,this.reader.meta)},findInsertIndex:function(e){this.suspendEvents();var g=this.data.clone();this.data.add(e);this.applySort();var d=this.data.indexOf(e);this.data=g;this.resumeEvents();return d},setBaseParam:function(d,c){this.baseParams=this.baseParams||{};this.baseParams[d]=c}});Ext.reg("store",Ext.data.Store);Ext.data.Store.Error=Ext.extend(Ext.Error,{name:"Ext.data.Store"});Ext.apply(Ext.data.Store.Error.prototype,{lang:{"writer-undefined":"Attempted to execute a write-action without a DataWriter installed."}});Ext.data.Field=Ext.extend(Object,{constructor:function(e){if(Ext.isString(e)){e={name:e}}Ext.apply(this,e);var h=Ext.data.Types,g=this.sortType,i;if(this.type){if(Ext.isString(this.type)){this.type=Ext.data.Types[this.type.toUpperCase()]||h.AUTO}}else{this.type=h.AUTO}if(Ext.isString(g)){this.sortType=Ext.data.SortTypes[g]}else{if(Ext.isEmpty(g)){this.sortType=this.type.sortType}}if(!this.convert){this.convert=this.type.convert}},dateFormat:null,useNull:false,defaultValue:"",mapping:null,sortType:null,sortDir:"ASC",allowBlank:true});Ext.data.DataReader=function(d,c){this.meta=d;this.recordType=Ext.isArray(c)?Ext.data.Record.create(c):c;if(this.recordType){this.buildExtractors()}};Ext.data.DataReader.prototype={getTotal:Ext.emptyFn,getRoot:Ext.emptyFn,getMessage:Ext.emptyFn,getSuccess:Ext.emptyFn,getId:Ext.emptyFn,buildExtractors:Ext.emptyFn,extractValues:Ext.emptyFn,realize:function(e,g){if(Ext.isArray(e)){for(var d=e.length-1;d>=0;d--){if(Ext.isArray(g)){this.realize(e.splice(d,1).shift(),g.splice(d,1).shift())}else{this.realize(e.splice(d,1).shift(),g)}}}else{if(Ext.isArray(g)&&g.length==1){g=g.shift()}if(!this.isData(g)){throw new Ext.data.DataReader.Error("realize",e)}e.phantom=false;e._phid=e.id;e.id=this.getId(g);e.data=g;e.commit()}},update:function(e,g){if(Ext.isArray(e)){for(var d=e.length-1;d>=0;d--){if(Ext.isArray(g)){this.update(e.splice(d,1).shift(),g.splice(d,1).shift())}else{this.update(e.splice(d,1).shift(),g)}}}else{if(Ext.isArray(g)&&g.length==1){g=g.shift()}if(this.isData(g)){e.data=Ext.apply(e.data,g)}e.commit()}},extractData:function(s,A){var t=(this instanceof Ext.data.JsonReader)?"json":"node";var y=[];if(this.isData(s)&&!(this instanceof Ext.data.XmlReader)){s=[s]
}var u=this.recordType.prototype.fields,i=u.items,n=u.length,y=[];if(A===true){var q=this.recordType;for(var w=0;w<s.length;w++){var z=s[w];var v=new q(this.extractValues(z,i,n),this.getId(z));v[t]=z;y.push(v)}}else{for(var w=0;w<s.length;w++){var x=this.extractValues(s[w],i,n);x[this.meta.idProperty]=this.getId(s[w]);y.push(x)}}return y},isData:function(b){return(b&&Ext.isObject(b)&&!Ext.isEmpty(this.getId(b)))?true:false},onMetaChange:function(b){delete this.ef;this.meta=b;this.recordType=Ext.data.Record.create(b.fields);this.buildExtractors()}};Ext.data.DataReader.Error=Ext.extend(Ext.Error,{constructor:function(c,d){this.arg=d;Ext.Error.call(this,c)},name:"Ext.data.DataReader"});Ext.apply(Ext.data.DataReader.Error.prototype,{lang:{update:"#update received invalid data from server.  Please see docs for DataReader#update and review your DataReader configuration.",realize:"#realize was called with invalid remote-data.  Please see the docs for DataReader#realize and review your DataReader configuration.","invalid-response":"#readResponse received an invalid response from the server."}});Ext.data.DataWriter=function(b){Ext.apply(this,b)};Ext.data.DataWriter.prototype={writeAllFields:false,listful:false,apply:function(l,k,m,i){var n=[],h=m+"Record";if(Ext.isArray(i)){Ext.each(i,function(a){n.push(this[h](a))},this)}else{if(i instanceof Ext.data.Record){n=this[h](i)}}this.render(l,k,n)},render:Ext.emptyFn,updateRecord:Ext.emptyFn,createRecord:Ext.emptyFn,destroyRecord:Ext.emptyFn,toHash:function(k,n){var l=k.fields.map,m={},h=(this.writeAllFields===false&&k.phantom===false)?k.getChanges():k.data,i;Ext.iterate(h,function(a,b){if((i=l[a])){m[i.mapping?i.mapping:i.name]=b}});if(k.phantom){if(k.fields.containsKey(this.meta.idProperty)&&Ext.isEmpty(k.data[this.meta.idProperty])){delete m[this.meta.idProperty]}}else{m[this.meta.idProperty]=k.id}return m},toArray:function(c){var d=[];Ext.iterate(c,function(a,b){d.push({name:a,value:b})},this);return d}};Ext.data.DataProxy=function(d){d=d||{};this.api=d.api;this.url=d.url;this.restful=d.restful;this.listeners=d.listeners;this.prettyUrls=d.prettyUrls;this.addEvents("exception","beforeload","load","loadexception","beforewrite","write");Ext.data.DataProxy.superclass.constructor.call(this);try{Ext.data.Api.prepare(this)}catch(c){if(c instanceof Ext.data.Api.Error){c.toConsole()}}Ext.data.DataProxy.relayEvents(this,["beforewrite","write","exception"])};Ext.extend(Ext.data.DataProxy,Ext.util.Observable,{restful:false,setApi:function(){if(arguments.length==1){var b=Ext.data.Api.isValid(arguments[0]);if(b===true){this.api=arguments[0]}else{throw new Ext.data.Api.Error("invalid",b)}}else{if(arguments.length==2){if(!Ext.data.Api.isAction(arguments[0])){throw new Ext.data.Api.Error("invalid",arguments[0])}this.api[arguments[0]]=arguments[1]}}Ext.data.Api.prepare(this)},isApiAction:function(b){return(this.api[b])?true:false},request:function(n,i,m,k,l,o,p){if(!this.api[n]&&!this.load){throw new Ext.data.DataProxy.Error("action-undefined",n)}m=m||{};if((n===Ext.data.Api.actions.read)?this.fireEvent("beforeload",this,m):this.fireEvent("beforewrite",this,n,i,m)!==false){this.doRequest.apply(this,arguments)}else{l.call(o||this,null,p,false)}},load:null,doRequest:function(n,i,m,k,l,o,p){this.load(m,k,l,o,p)},onRead:Ext.emptyFn,onWrite:Ext.emptyFn,buildUrl:function(k,g){g=g||null;var l=(this.conn&&this.conn.url)?this.conn.url:(this.api[k])?this.api[k].url:this.url;if(!l){throw new Ext.data.Api.Error("invalid-url",k)}var i=null;var h=l.match(/(.*)(\.json|\.xml|\.html)$/);if(h){i=h[2];l=h[1]}if((this.restful===true||this.prettyUrls===true)&&g instanceof Ext.data.Record&&!g.phantom){l+="/"+g.id}return(i===null)?l:l+i},destroy:function(){this.purgeListeners()}});Ext.apply(Ext.data.DataProxy,Ext.util.Observable.prototype);Ext.util.Observable.call(Ext.data.DataProxy);Ext.data.DataProxy.Error=Ext.extend(Ext.Error,{constructor:function(c,d){this.arg=d;Ext.Error.call(this,c)},name:"Ext.data.DataProxy"});Ext.apply(Ext.data.DataProxy.Error.prototype,{lang:{"action-undefined":"DataProxy attempted to execute an API-action but found an undefined url / function.  Please review your Proxy url/api-configuration.","api-invalid":"Recieved an invalid API-configuration.  Please ensure your proxy API-configuration contains only the actions from Ext.data.Api.actions."}});
Ext.data.Request=function(b){Ext.apply(this,b)};Ext.data.Request.prototype={action:undefined,rs:undefined,params:undefined,callback:Ext.emptyFn,scope:undefined,reader:undefined};Ext.data.Response=function(b){Ext.apply(this,b)};Ext.data.Response.prototype={action:undefined,success:undefined,message:undefined,data:undefined,raw:undefined,records:undefined};Ext.data.ScriptTagProxy=function(b){Ext.apply(this,b);Ext.data.ScriptTagProxy.superclass.constructor.call(this,b);this.head=document.getElementsByTagName("head")[0]};Ext.data.ScriptTagProxy.TRANS_ID=1000;Ext.extend(Ext.data.ScriptTagProxy,Ext.data.DataProxy,{timeout:30000,callbackParam:"callback",nocache:true,doRequest:function(w,v,x,u,s,q,p){var y=Ext.urlEncode(Ext.apply(x,this.extraParams));var z=this.buildUrl(w,v);if(!z){throw new Ext.data.Api.Error("invalid-url",z)}z=Ext.urlAppend(z,y);if(this.nocache){z=Ext.urlAppend(z,"_dc="+(new Date().getTime()))}var A=++Ext.data.ScriptTagProxy.TRANS_ID;var o={id:A,action:w,cb:"stcCallback"+A,scriptId:"stcScript"+A,params:x,arg:p,url:z,callback:s,scope:q,reader:u};window[o.cb]=this.createCallback(w,v,o);z+=String.format("&{0}={1}",this.callbackParam,o.cb);if(this.autoAbort!==false){this.abort()}o.timeoutId=this.handleFailure.defer(this.timeout,this,[o]);var t=document.createElement("script");t.setAttribute("src",z);t.setAttribute("type","text/javascript");t.setAttribute("id",o.scriptId);this.head.appendChild(t);this.trans=o},createCallback:function(h,e,i){var g=this;return function(a){g.trans=false;g.destroyTrans(i,true);if(h===Ext.data.Api.actions.read){g.onRead.call(g,h,i,a)}else{g.onWrite.call(g,h,i,a,e)}}},onRead:function(k,l,e){var h;try{h=l.reader.readRecords(e)}catch(i){this.fireEvent("loadexception",this,l,e,i);this.fireEvent("exception",this,"response",k,l,e,i);l.callback.call(l.scope||window,null,l.arg,false);return}if(h.success===false){this.fireEvent("loadexception",this,l,e);this.fireEvent("exception",this,"remote",k,l,e,null)}else{this.fireEvent("load",this,e,l.arg)}l.callback.call(l.scope||window,h,l.arg,h.success)},onWrite:function(m,n,p,e){var k=n.reader;try{var o=k.readResponse(m,p)}catch(l){this.fireEvent("exception",this,"response",m,n,o,l);n.callback.call(n.scope||window,null,o,false);return}if(!o.success===true){this.fireEvent("exception",this,"remote",m,n,o,e);n.callback.call(n.scope||window,null,o,false);return}this.fireEvent("write",this,m,o.data,o,e,n.arg);n.callback.call(n.scope||window,o.data,o,true)},isLoading:function(){return this.trans?true:false},abort:function(){if(this.isLoading()){this.destroyTrans(this.trans)}},destroyTrans:function(d,e){this.head.removeChild(document.getElementById(d.scriptId));clearTimeout(d.timeoutId);if(e){window[d.cb]=undefined;try{delete window[d.cb]}catch(g){}}else{window[d.cb]=function(){window[d.cb]=undefined;try{delete window[d.cb]}catch(a){}}}},handleFailure:function(b){this.trans=false;this.destroyTrans(b,false);if(b.action===Ext.data.Api.actions.read){this.fireEvent("loadexception",this,null,b.arg)}this.fireEvent("exception",this,"response",b.action,{response:null,options:b.arg});b.callback.call(b.scope||window,null,b.arg,false)},destroy:function(){this.abort();Ext.data.ScriptTagProxy.superclass.destroy.call(this)}});Ext.data.HttpProxy=function(e){Ext.data.HttpProxy.superclass.constructor.call(this,e);this.conn=e;this.conn.url=null;this.useAjax=!e||!e.events;var g=Ext.data.Api.actions;this.activeRequest={};for(var d in g){this.activeRequest[g[d]]=undefined}};Ext.extend(Ext.data.HttpProxy,Ext.data.DataProxy,{getConnection:function(){return this.useAjax?Ext.Ajax:this.conn},setUrl:function(d,c){this.conn.url=d;if(c===true){this.url=d;this.api=null;Ext.data.Api.prepare(this)}},doRequest:function(o,q,m,s,k,p,l){var n={method:(this.api[o])?this.api[o]["method"]:undefined,request:{callback:k,scope:p,arg:l},reader:s,callback:this.createCallback(o,q),scope:this};if(m.jsonData){n.jsonData=m.jsonData}else{if(m.xmlData){n.xmlData=m.xmlData}else{n.params=m||{}}}this.conn.url=this.buildUrl(o,q);
if(this.useAjax){Ext.applyIf(n,this.conn);if(this.activeRequest[o]){}this.activeRequest[o]=Ext.Ajax.request(n)}else{this.conn.request(n)}this.conn.url=null},createCallback:function(c,d){return function(a,b,g){this.activeRequest[c]=undefined;if(!b){if(c===Ext.data.Api.actions.read){this.fireEvent("loadexception",this,a,g)}this.fireEvent("exception",this,"response",c,a,g);a.request.callback.call(a.request.scope,null,a.request.arg,false);return}if(c===Ext.data.Api.actions.read){this.onRead(c,a,g)}else{this.onWrite(c,a,g,d)}}},onRead:function(m,k,e){var i;try{i=k.reader.read(e)}catch(l){this.fireEvent("loadexception",this,k,e,l);this.fireEvent("exception",this,"response",m,k,e,l);k.request.callback.call(k.request.scope,null,k.request.arg,false);return}if(i.success===false){this.fireEvent("loadexception",this,k,e);var n=k.reader.readResponse(m,e);this.fireEvent("exception",this,"remote",m,k,n,null)}else{this.fireEvent("load",this,k,k.request.arg)}k.request.callback.call(k.request.scope,i,k.request.arg,i.success)},onWrite:function(n,l,p,e){var k=l.reader;var o;try{o=k.readResponse(n,p)}catch(m){this.fireEvent("exception",this,"response",n,l,p,m);l.request.callback.call(l.request.scope,null,l.request.arg,false);return}if(o.success===true){this.fireEvent("write",this,n,o.data,o,e,l.request.arg)}else{this.fireEvent("exception",this,"remote",n,l,o,e)}l.request.callback.call(l.request.scope,o.data,o,o.success)},destroy:function(){if(!this.useAjax){this.conn.abort()}else{if(this.activeRequest){var c=Ext.data.Api.actions;for(var d in c){if(this.activeRequest[c[d]]){Ext.Ajax.abort(this.activeRequest[c[d]])}}}}Ext.data.HttpProxy.superclass.destroy.call(this)}});Ext.data.MemoryProxy=function(c){var d={};d[Ext.data.Api.actions.read]=true;Ext.data.MemoryProxy.superclass.constructor.call(this,{api:d});this.data=c};Ext.extend(Ext.data.MemoryProxy,Ext.data.DataProxy,{doRequest:function(t,s,u,q,o,n,m){u=u||{};var e;try{e=q.readRecords(this.data)}catch(p){this.fireEvent("loadexception",this,null,m,p);this.fireEvent("exception",this,"response",t,m,null,p);o.call(n,null,m,false);return}o.call(n,e,m,true)}});Ext.data.Types=new function(){var b=Ext.data.SortTypes;Ext.apply(this,{stripRe:/[\$,%]/g,AUTO:{convert:function(a){return a},sortType:b.none,type:"auto"},STRING:{convert:function(a){return(a===undefined||a===null)?"":String(a)},sortType:b.asUCString,type:"string"},INT:{convert:function(a){return a!==undefined&&a!==null&&a!==""?parseInt(String(a).replace(Ext.data.Types.stripRe,""),10):(this.useNull?null:0)},sortType:b.none,type:"int"},FLOAT:{convert:function(a){return a!==undefined&&a!==null&&a!==""?parseFloat(String(a).replace(Ext.data.Types.stripRe,""),10):(this.useNull?null:0)},sortType:b.none,type:"float"},BOOL:{convert:function(a){return a===true||a==="true"||a==1},sortType:b.none,type:"bool"},DATE:{convert:function(g){var e=this.dateFormat;if(!g){return null}if(Ext.isDate(g)){return g}if(e){if(e=="timestamp"){return new Date(g*1000)}if(e=="time"){return new Date(parseInt(g,10))}return Date.parseDate(g,e)}var a=Date.parse(g);return a?new Date(a):null},sortType:b.asDate,type:"date"}});Ext.apply(this,{BOOLEAN:this.BOOL,INTEGER:this.INT,NUMBER:this.FLOAT})};Ext.data.JsonWriter=Ext.extend(Ext.data.DataWriter,{encode:true,encodeDelete:false,constructor:function(b){Ext.data.JsonWriter.superclass.constructor.call(this,b)},render:function(i,h,e){if(this.encode===true){Ext.apply(i,h);i[this.meta.root]=Ext.encode(e)}else{var g=Ext.apply({},h);g[this.meta.root]=e;i.jsonData=g}},createRecord:function(b){return this.toHash(b)},updateRecord:function(b){return this.toHash(b)},destroyRecord:function(c){if(this.encodeDelete){var d={};d[this.meta.idProperty]=c.id;return d}else{return c.id}}});Ext.data.JsonReader=function(d,c){d=d||{};Ext.applyIf(d,{idProperty:"id",successProperty:"success",totalProperty:"total"});Ext.data.JsonReader.superclass.constructor.call(this,d,c||d.fields)};Ext.extend(Ext.data.JsonReader,Ext.data.DataReader,{read:function(e){var d=e.responseText;
var g=Ext.decode(d);if(!g){throw {message:"JsonReader.read: Json object not found"}}return this.readRecords(g)},readResponse:function(l,h){var k=(h.responseText!==undefined)?Ext.decode(h.responseText):h;if(!k){throw new Ext.data.JsonReader.Error("response")}var i=this.getRoot(k);if(l===Ext.data.Api.actions.create){var m=Ext.isDefined(i);if(m&&Ext.isEmpty(i)){throw new Ext.data.JsonReader.Error("root-empty",this.meta.root)}else{if(!m){throw new Ext.data.JsonReader.Error("root-undefined-response",this.meta.root)}}}var n=new Ext.data.Response({action:l,success:this.getSuccess(k),data:(i)?this.extractData(i,false):[],message:this.getMessage(k),raw:k});if(Ext.isEmpty(n.success)){throw new Ext.data.JsonReader.Error("successProperty-response",this.meta.successProperty)}return n},readRecords:function(y){this.jsonData=y;if(y.metaData){this.onMetaChange(y.metaData)}var c=this.meta,t=this.recordType,x=t.prototype.fields,o=x.items,s=x.length,q;var u=this.getRoot(y),v=u.length,w=v,p=true;if(c.totalProperty){q=parseInt(this.getTotal(y),10);if(!isNaN(q)){w=q}}if(c.successProperty){q=this.getSuccess(y);if(q===false||q==="false"){p=false}}return{success:p,records:this.extractData(u,true),totalRecords:w}},buildExtractors:function(){if(this.ef){return}var g=this.meta,o=this.recordType,p=o.prototype.fields,i=p.items,n=p.length;if(g.totalProperty){this.getTotal=this.createAccessor(g.totalProperty)}if(g.successProperty){this.getSuccess=this.createAccessor(g.successProperty)}if(g.messageProperty){this.getMessage=this.createAccessor(g.messageProperty)}this.getRoot=g.root?this.createAccessor(g.root):function(a){return a};if(g.id||g.idProperty){var q=this.createAccessor(g.id||g.idProperty);this.getId=function(a){var b=q(a);return(b===undefined||b==="")?null:b}}else{this.getId=function(){return null}}var s=[];for(var t=0;t<n;t++){p=i[t];var u=(p.mapping!==undefined&&p.mapping!==null)?p.mapping:p.name;s.push(this.createAccessor(u))}this.ef=s},simpleAccess:function(c,d){return c[d]},createAccessor:function(){var b=/[\[\.]/;return function(d){if(Ext.isEmpty(d)){return Ext.emptyFn}if(Ext.isFunction(d)){return d}var a=String(d).search(b);if(a>=0){return new Function("obj","return obj"+(a>0?".":"")+d)}return function(c){return c[d]}}}(),extractValues:function(l,o,k){var m,p={};for(var n=0;n<k;n++){m=o[n];var i=this.ef[n](l);p[m.name]=m.convert((i!==undefined)?i:m.defaultValue,l)}return p}});Ext.data.JsonReader.Error=Ext.extend(Ext.Error,{constructor:function(c,d){this.arg=d;Ext.Error.call(this,c)},name:"Ext.data.JsonReader"});Ext.apply(Ext.data.JsonReader.Error.prototype,{lang:{response:"An error occurred while json-decoding your server response","successProperty-response":'Could not locate your "successProperty" in your server response.  Please review your JsonReader config to ensure the config-property "successProperty" matches the property in your server-response.  See the JsonReader docs.',"root-undefined-config":'Your JsonReader was configured without a "root" property.  Please review your JsonReader config and make sure to define the root property.  See the JsonReader docs.',"idProperty-undefined":'Your JsonReader was configured without an "idProperty"  Please review your JsonReader configuration and ensure the "idProperty" is set (e.g.: "id").  See the JsonReader docs.',"root-empty":'Data was expected to be returned by the server in the "root" property of the response.  Please review your JsonReader configuration to ensure the "root" property matches that returned in the server-response.  See JsonReader docs.'}});Ext.data.ArrayReader=Ext.extend(Ext.data.JsonReader,{readRecords:function(v){this.arrayData=v;var J=this.meta,N=J?Ext.num(J.idIndex,J.id):null,P=this.recordType,F=P.prototype.fields,G=[],M=true,L;var o=this.getRoot(v);for(var i=0,E=o.length;i<E;i++){var s=o[i],Q={},H=((N||N===0)&&s[N]!==undefined&&s[N]!==""?s[N]:null);for(var k=0,I=F.length;k<I;k++){var D=F.items[k],n=D.mapping!==undefined&&D.mapping!==null?D.mapping:k;L=s[n]!==undefined?s[n]:D.defaultValue;
L=D.convert(L,s);Q[D.name]=L}var O=new P(Q,H);O.json=s;G[G.length]=O}var K=G.length;if(J.totalProperty){L=parseInt(this.getTotal(v),10);if(!isNaN(L)){K=L}}if(J.successProperty){L=this.getSuccess(v);if(L===false||L==="false"){M=false}}return{success:M,records:G,totalRecords:K}}});Ext.data.ArrayStore=Ext.extend(Ext.data.Store,{constructor:function(b){Ext.data.ArrayStore.superclass.constructor.call(this,Ext.apply(b,{reader:new Ext.data.ArrayReader(b)}))},loadData:function(i,g){if(this.expandData===true){var k=[];for(var l=0,h=i.length;l<h;l++){k[k.length]=[i[l]]}i=k}Ext.data.ArrayStore.superclass.loadData.call(this,i,g)}});Ext.reg("arraystore",Ext.data.ArrayStore);Ext.data.SimpleStore=Ext.data.ArrayStore;Ext.reg("simplestore",Ext.data.SimpleStore);Ext.data.JsonStore=Ext.extend(Ext.data.Store,{constructor:function(b){Ext.data.JsonStore.superclass.constructor.call(this,Ext.apply(b,{reader:new Ext.data.JsonReader(b)}))}});Ext.reg("jsonstore",Ext.data.JsonStore);Ext.data.XmlWriter=function(b){Ext.data.XmlWriter.superclass.constructor.apply(this,arguments);this.tpl=(typeof(this.tpl)==="string")?new Ext.XTemplate(this.tpl).compile():this.tpl.compile()};Ext.extend(Ext.data.XmlWriter,Ext.data.DataWriter,{documentRoot:"xrequest",forceDocumentRoot:false,root:"records",xmlVersion:"1.0",xmlEncoding:"ISO-8859-15",tpl:'<tpl for="."><\u003fxml version="{version}" encoding="{encoding}"\u003f><tpl if="documentRoot"><{documentRoot}><tpl for="baseParams"><tpl for="."><{name}>{value}</{name}></tpl></tpl></tpl><tpl if="records.length&gt;1"><{root}></tpl><tpl for="records"><{parent.record}><tpl for="."><{name}>{value}</{name}></tpl></{parent.record}></tpl><tpl if="records.length&gt;1"></{root}></tpl><tpl if="documentRoot"></{documentRoot}></tpl></tpl>',render:function(d,g,e){g=this.toArray(g);d.xmlData=this.tpl.applyTemplate({version:this.xmlVersion,encoding:this.xmlEncoding,documentRoot:(g.length>0||this.forceDocumentRoot===true)?this.documentRoot:false,record:this.meta.record,root:this.root,baseParams:g,records:(Ext.isArray(e[0]))?e:[e]})},createRecord:function(b){return this.toArray(this.toHash(b))},updateRecord:function(b){return this.toArray(this.toHash(b))},destroyRecord:function(c){var d={};d[this.meta.idProperty]=c.id;return this.toArray(d)}});Ext.data.XmlReader=function(d,c){d=d||{};Ext.applyIf(d,{idProperty:d.idProperty||d.idPath||d.id,successProperty:d.successProperty||d.success});Ext.data.XmlReader.superclass.constructor.call(this,d,c||d.fields)};Ext.extend(Ext.data.XmlReader,Ext.data.DataReader,{read:function(d){var c=d.responseXML;if(!c){throw {message:"XmlReader.read: XML Document not available"}}return this.readRecords(c)},readRecords:function(m){this.xmlData=m;var i=m.documentElement||m,n=Ext.DomQuery,k=0,l=true;if(this.meta.totalProperty){k=this.getTotal(i,0)}if(this.meta.successProperty){l=this.getSuccess(i)}var h=this.extractData(n.select(this.meta.record,i),true);return{success:l,records:h,totalRecords:k||h.length}},readResponse:function(m,i){var n=Ext.DomQuery,l=i.responseXML,k=l.documentElement||l;var p=new Ext.data.Response({action:m,success:this.getSuccess(k),message:this.getMessage(k),data:this.extractData(n.select(this.meta.record,k)||n.select(this.meta.root,k),false),raw:l});if(Ext.isEmpty(p.success)){throw new Ext.data.DataReader.Error("successProperty-response",this.meta.successProperty)}if(m===Ext.data.Api.actions.create){var o=Ext.isDefined(p.data);if(o&&Ext.isEmpty(p.data)){throw new Ext.data.JsonReader.Error("root-empty",this.meta.root)}else{if(!o){throw new Ext.data.JsonReader.Error("root-undefined-response",this.meta.root)}}}return p},getSuccess:function(){return true},buildExtractors:function(){if(this.ef){return}var g=this.meta,o=this.recordType,p=o.prototype.fields,i=p.items,n=p.length;if(g.totalProperty){this.getTotal=this.createAccessor(g.totalProperty)}if(g.successProperty){this.getSuccess=this.createAccessor(g.successProperty)}if(g.messageProperty){this.getMessage=this.createAccessor(g.messageProperty)}this.getRoot=function(a){return(!Ext.isEmpty(a[this.meta.record]))?a[this.meta.record]:a[this.meta.root]
};if(g.idPath||g.idProperty){var q=this.createAccessor(g.idPath||g.idProperty);this.getId=function(b){var a=q(b)||b.id;return(a===undefined||a==="")?null:a}}else{this.getId=function(){return null}}var s=[];for(var t=0;t<n;t++){p=i[t];var u=(p.mapping!==undefined&&p.mapping!==null)?p.mapping:p.name;s.push(this.createAccessor(u))}this.ef=s},createAccessor:function(){var b=Ext.DomQuery;return function(a){switch(a){case this.meta.totalProperty:return function(g,e){return b.selectNumber(a,g,e)};break;case this.meta.successProperty:return function(k,i){var l=b.selectValue(a,k,true);var h=l!==false&&l!=="false";return h};break;default:return function(g,e){return b.selectValue(a,g,e)};break}}}(),extractValues:function(l,o,k){var m,p={};for(var n=0;n<k;n++){m=o[n];var i=this.ef[n](l);p[m.name]=m.convert((i!==undefined)?i:m.defaultValue,l)}return p}});Ext.data.XmlStore=Ext.extend(Ext.data.Store,{constructor:function(b){Ext.data.XmlStore.superclass.constructor.call(this,Ext.apply(b,{reader:new Ext.data.XmlReader(b)}))}});Ext.reg("xmlstore",Ext.data.XmlStore);Ext.data.GroupingStore=Ext.extend(Ext.data.Store,{constructor:function(k){k=k||{};this.hasMultiSort=true;this.multiSortInfo=this.multiSortInfo||{sorters:[]};var i=this.multiSortInfo.sorters,l=k.groupField||this.groupField,g=k.sortInfo||this.sortInfo,h=k.groupDir||this.groupDir;if(l){i.push({field:l,direction:h})}if(g){i.push(g)}Ext.data.GroupingStore.superclass.constructor.call(this,k);this.addEvents("groupchange");this.applyGroupField()},remoteGroup:false,groupOnSort:false,groupDir:"ASC",clearGrouping:function(){this.groupField=false;if(this.remoteGroup){if(this.baseParams){delete this.baseParams.groupBy;delete this.baseParams.groupDir}var b=this.lastOptions;if(b&&b.params){delete b.params.groupBy;delete b.params.groupDir}this.reload()}else{this.sort();this.fireEvent("datachanged",this)}},groupBy:function(i,h,k){k=k?(String(k).toUpperCase()=="DESC"?"DESC":"ASC"):this.groupDir;if(this.groupField==i&&this.groupDir==k&&!h){return}var l=this.multiSortInfo.sorters;if(l.length>0&&l[0].field==this.groupField){l.shift()}this.groupField=i;this.groupDir=k;this.applyGroupField();var g=function(){this.fireEvent("groupchange",this,this.getGroupState())};if(this.groupOnSort){this.sort(i,k);g.call(this);return}if(this.remoteGroup){this.on("load",g,this,{single:true});this.reload()}else{this.sort(l);g.call(this)}},sort:function(l,p){if(this.remoteSort){return Ext.data.GroupingStore.superclass.sort.call(this,l,p)}var m=[];if(Ext.isArray(arguments[0])){m=arguments[0]}else{if(l==undefined){m=this.sortInfo?[this.sortInfo]:[]}else{var n=this.fields.get(l);if(!n){return false}var i=n.name,k=this.sortInfo||null,o=this.sortToggle?this.sortToggle[i]:null;if(!p){if(k&&k.field==i){p=(this.sortToggle[i]||"ASC").toggle("ASC","DESC")}else{p=n.sortDir}}this.sortToggle[i]=p;this.sortInfo={field:i,direction:p};m=[this.sortInfo]}}if(this.groupField){m.unshift({direction:this.groupDir,field:this.groupField})}return this.multiSort.call(this,m,p)},applyGroupField:function(){if(this.remoteGroup){if(!this.baseParams){this.baseParams={}}Ext.apply(this.baseParams,{groupBy:this.groupField,groupDir:this.groupDir});var b=this.lastOptions;if(b&&b.params){b.params.groupDir=this.groupDir;delete b.params.groupBy}}},applyGrouping:function(b){if(this.groupField!==false){this.groupBy(this.groupField,true,this.groupDir);return true}else{if(b===true){this.fireEvent("datachanged",this)}return false}},getGroupState:function(){return this.groupOnSort&&this.groupField!==false?(this.sortInfo?this.sortInfo.field:undefined):this.groupField}});Ext.reg("groupingstore",Ext.data.GroupingStore);Ext.data.DirectProxy=function(b){Ext.apply(this,b);if(typeof this.paramOrder=="string"){this.paramOrder=this.paramOrder.split(/[\s,|]/)}Ext.data.DirectProxy.superclass.constructor.call(this,b)};Ext.extend(Ext.data.DirectProxy,Ext.data.DataProxy,{paramOrder:undefined,paramsAsHash:true,directFn:undefined,doRequest:function(z,y,A,w,s,q,i){var t=[],u=this.api[z]||this.directFn;
switch(z){case Ext.data.Api.actions.create:t.push(A.jsonData);break;case Ext.data.Api.actions.read:if(u.directCfg.method.len>0){if(this.paramOrder){for(var x=0,v=this.paramOrder.length;x<v;x++){t.push(A[this.paramOrder[x]])}}else{if(this.paramsAsHash){t.push(A)}}}break;case Ext.data.Api.actions.update:t.push(A.jsonData);break;case Ext.data.Api.actions.destroy:t.push(A.jsonData);break}var p={params:A||{},request:{callback:s,scope:q,arg:i},reader:w};t.push(this.createCallback(z,y,p),this);u.apply(window,t)},createCallback:function(h,g,e){var i=this;return function(b,a){if(!a.status){if(h===Ext.data.Api.actions.read){i.fireEvent("loadexception",i,e,a,null)}i.fireEvent("exception",i,"remote",h,e,a,null);e.request.callback.call(e.request.scope,null,e.request.arg,false);return}if(h===Ext.data.Api.actions.read){i.onRead(h,e,b,a)}else{i.onWrite(h,e,b,a,g)}}},onRead:function(k,l,i,m){var h;try{h=l.reader.readRecords(i)}catch(n){this.fireEvent("loadexception",this,l,m,n);this.fireEvent("exception",this,"response",k,l,m,n);l.request.callback.call(l.request.scope,null,l.request.arg,false);return}this.fireEvent("load",this,m,l.request.arg);l.request.callback.call(l.request.scope,h,l.request.arg,true)},onWrite:function(m,o,k,p,i){var n=o.reader.extractData(o.reader.getRoot(k),false);var l=o.reader.getSuccess(k);l=(l!==false);if(l){this.fireEvent("write",this,m,n,p,i,o.request.arg)}else{this.fireEvent("exception",this,"remote",m,o,k,i)}o.request.callback.call(o.request.scope,n,p,l)}});Ext.data.DirectStore=Ext.extend(Ext.data.Store,{constructor:function(d){var c=Ext.apply({},{batchTransactions:false},d);Ext.data.DirectStore.superclass.constructor.call(this,Ext.apply(c,{proxy:Ext.isDefined(c.proxy)?c.proxy:new Ext.data.DirectProxy(Ext.copyTo({},c,"paramOrder,paramsAsHash,directFn,api")),reader:(!Ext.isDefined(c.reader)&&c.fields)?new Ext.data.JsonReader(Ext.copyTo({},c,"totalProperty,root,idProperty"),c.fields):c.reader}))}});Ext.reg("directstore",Ext.data.DirectStore);Ext.Direct=Ext.extend(Ext.util.Observable,{exceptions:{TRANSPORT:"xhr",PARSE:"parse",LOGIN:"login",SERVER:"exception"},constructor:function(){this.addEvents("event","exception");this.transactions={};this.providers={}},addProvider:function(g){var i=arguments;if(i.length>1){for(var h=0,a=i.length;h<a;h++){this.addProvider(i[h])}return}if(!g.events){g=new Ext.Direct.PROVIDERS[g.type](g)}g.id=g.id||Ext.id();this.providers[g.id]=g;g.on("data",this.onProviderData,this);g.on("exception",this.onProviderException,this);if(!g.isConnected()){g.connect()}return g},getProvider:function(b){return this.providers[b]},removeProvider:function(c){var d=c.id?c:this.providers[c];d.un("data",this.onProviderData,this);d.un("exception",this.onProviderException,this);delete this.providers[d.id];return d},addTransaction:function(b){this.transactions[b.tid]=b;return b},removeTransaction:function(b){delete this.transactions[b.tid||b];return b},getTransaction:function(b){return this.transactions[b.tid||b]},onProviderData:function(h,i){if(Ext.isArray(i)){for(var e=0,g=i.length;e<g;e++){this.onProviderData(h,i[e])}return}if(i.name&&i.name!="event"&&i.name!="exception"){this.fireEvent(i.name,i)}else{if(i.type=="exception"){this.fireEvent("exception",i)}}this.fireEvent("event",i,h)},createEvent:function(d,c){return new Ext.Direct.eventTypes[d.type](Ext.apply(d,c))}});Ext.Direct=new Ext.Direct();Ext.Direct.TID=1;Ext.Direct.PROVIDERS={};Ext.Direct.Transaction=function(b){Ext.apply(this,b);this.tid=++Ext.Direct.TID;this.retryCount=0};Ext.Direct.Transaction.prototype={send:function(){this.provider.queueTransaction(this)},retry:function(){this.retryCount++;this.send()},getProvider:function(){return this.provider}};Ext.Direct.Event=function(b){Ext.apply(this,b)};Ext.Direct.Event.prototype={status:true,getData:function(){return this.data}};Ext.Direct.RemotingEvent=Ext.extend(Ext.Direct.Event,{type:"rpc",getTransaction:function(){return this.transaction||Ext.Direct.getTransaction(this.tid)}});Ext.Direct.ExceptionEvent=Ext.extend(Ext.Direct.RemotingEvent,{status:false,type:"exception"});
Ext.Direct.eventTypes={rpc:Ext.Direct.RemotingEvent,event:Ext.Direct.Event,exception:Ext.Direct.ExceptionEvent};Ext.direct.Provider=Ext.extend(Ext.util.Observable,{priority:1,constructor:function(b){Ext.apply(this,b);this.addEvents("connect","disconnect","data","exception");Ext.direct.Provider.superclass.constructor.call(this,b)},isConnected:function(){return false},connect:Ext.emptyFn,disconnect:Ext.emptyFn});Ext.direct.JsonProvider=Ext.extend(Ext.direct.Provider,{parseResponse:function(b){if(!Ext.isEmpty(b.responseText)){if(typeof b.responseText=="object"){return b.responseText}return Ext.decode(b.responseText)}return null},getEvents:function(l){var n=null;try{n=this.parseResponse(l)}catch(m){var o=new Ext.Direct.ExceptionEvent({data:m,xhr:l,code:Ext.Direct.exceptions.PARSE,message:"Error parsing json response: \n\n "+n});return[o]}var p=[];if(Ext.isArray(n)){for(var e=0,i=n.length;e<i;e++){p.push(Ext.Direct.createEvent(n[e]))}}else{p.push(Ext.Direct.createEvent(n))}return p}});Ext.direct.PollingProvider=Ext.extend(Ext.direct.JsonProvider,{priority:3,interval:3000,constructor:function(b){Ext.direct.PollingProvider.superclass.constructor.call(this,b);this.addEvents("beforepoll","poll")},isConnected:function(){return !!this.pollTask},connect:function(){if(this.url&&!this.pollTask){this.pollTask=Ext.TaskMgr.start({run:function(){if(this.fireEvent("beforepoll",this)!==false){if(typeof this.url=="function"){this.url(this.baseParams)}else{Ext.Ajax.request({url:this.url,callback:this.onData,scope:this,params:this.baseParams})}}},interval:this.interval,scope:this});this.fireEvent("connect",this)}else{if(!this.url){throw"Error initializing PollingProvider, no url configured."}}},disconnect:function(){if(this.pollTask){Ext.TaskMgr.stop(this.pollTask);delete this.pollTask;this.fireEvent("disconnect",this)}},onData:function(o,l,m){if(l){var p=this.getEvents(m);for(var e=0,i=p.length;e<i;e++){var n=p[e];this.fireEvent("data",this,n)}}else{var n=new Ext.Direct.ExceptionEvent({data:n,code:Ext.Direct.exceptions.TRANSPORT,message:"Unable to connect to the server.",xhr:m});this.fireEvent("data",this,n)}}});Ext.Direct.PROVIDERS.polling=Ext.direct.PollingProvider;Ext.direct.RemotingProvider=Ext.extend(Ext.direct.JsonProvider,{enableBuffer:10,maxRetries:1,timeout:undefined,constructor:function(b){Ext.direct.RemotingProvider.superclass.constructor.call(this,b);this.addEvents("beforecall","call");this.namespace=(Ext.isString(this.namespace))?Ext.ns(this.namespace):this.namespace||window;this.transactions={};this.callBuffer=[]},initAPI:function(){var m=this.actions;for(var l in m){var p=this.namespace[l]||(this.namespace[l]={}),o=m[l];for(var n=0,c=o.length;n<c;n++){var i=o[n];p[i.name]=this.createMethod(l,i)}}},isConnected:function(){return !!this.connected},connect:function(){if(this.url){this.initAPI();this.connected=true;this.fireEvent("connect",this)}else{if(!this.url){throw"Error initializing RemotingProvider, no url configured."}}},disconnect:function(){if(this.connected){this.connected=false;this.fireEvent("disconnect",this)}},onData:function(u,o,n){if(o){var i=this.getEvents(n);for(var t=0,s=i.length;t<s;t++){var q=i[t],e=this.getTransaction(q);this.fireEvent("data",this,q);if(e){this.doCallback(e,q,true);Ext.Direct.removeTransaction(e)}}}else{var p=[].concat(u.ts);for(var t=0,s=p.length;t<s;t++){var e=this.getTransaction(p[t]);if(e&&e.retryCount<this.maxRetries){e.retry()}else{var q=new Ext.Direct.ExceptionEvent({data:q,transaction:e,code:Ext.Direct.exceptions.TRANSPORT,message:"Unable to connect to the server.",xhr:n});this.fireEvent("data",this,q);if(e){this.doCallback(e,q,false);Ext.Direct.removeTransaction(e)}}}}},getCallData:function(b){return{action:b.action,method:b.method,data:b.data,type:"rpc",tid:b.tid}},doSend:function(m){var k={url:this.url,callback:this.onData,scope:this,ts:m,timeout:this.timeout},h;if(Ext.isArray(m)){h=[];for(var n=0,i=m.length;n<i;n++){h.push(this.getCallData(m[n]))}}else{h=this.getCallData(m)}if(this.enableUrlEncode){var l={};
l[Ext.isString(this.enableUrlEncode)?this.enableUrlEncode:"data"]=Ext.encode(h);k.params=l}else{k.jsonData=h}Ext.Ajax.request(k)},combineAndSend:function(){var b=this.callBuffer.length;if(b>0){this.doSend(b==1?this.callBuffer[0]:this.callBuffer);this.callBuffer=[]}},queueTransaction:function(b){if(b.form){this.processForm(b);return}this.callBuffer.push(b);if(this.enableBuffer){if(!this.callTask){this.callTask=new Ext.util.DelayedTask(this.combineAndSend,this)}this.callTask.delay(Ext.isNumber(this.enableBuffer)?this.enableBuffer:10)}else{this.combineAndSend()}},doCall:function(l,k,c){var m=null,o=c[k.len],n=c[k.len+1];if(k.len!==0){m=c.slice(0,k.len)}var p=new Ext.Direct.Transaction({provider:this,args:c,action:l,method:k.name,data:m,cb:n&&Ext.isFunction(o)?o.createDelegate(n):o});if(this.fireEvent("beforecall",this,p,k)!==false){Ext.Direct.addTransaction(p);this.queueTransaction(p);this.fireEvent("call",this,p,k)}},doForm:function(m,c,p,n,q){var s=new Ext.Direct.Transaction({provider:this,action:m,method:c.name,args:[p,n,q],cb:q&&Ext.isFunction(n)?n.createDelegate(q):n,isForm:true});if(this.fireEvent("beforecall",this,s,c)!==false){Ext.Direct.addTransaction(s);var l=String(p.getAttribute("enctype")).toLowerCase()=="multipart/form-data",o={extTID:s.tid,extAction:m,extMethod:c.name,extType:"rpc",extUpload:String(l)};Ext.apply(s,{form:Ext.getDom(p),isUpload:l,params:n&&Ext.isObject(n.params)?Ext.apply(o,n.params):o});this.fireEvent("call",this,s,c);this.processForm(s)}},processForm:function(b){Ext.Ajax.request({url:this.url,params:b.params,callback:this.onData,scope:this,form:b.form,isUpload:b.isUpload,ts:b})},createMethod:function(g,e){var c;if(!e.formHandler){c=function(){this.doCall(g,e,Array.prototype.slice.call(arguments,0))}.createDelegate(this)}else{c=function(b,a,d){this.doForm(g,e,b,a,d)}.createDelegate(this)}c.directCfg={action:g,method:e};return c},getTransaction:function(b){return b&&b.tid?Ext.Direct.getTransaction(b.tid):null},doCallback:function(l,i){var k=i.status?"success":"failure";if(l&&l.cb){var e=l.cb,h=Ext.isDefined(i.result)?i.result:i.data;if(Ext.isFunction(e)){e(h,i)}else{Ext.callback(e[k],e.scope,[h,i]);Ext.callback(e.callback,e.scope,[h,i])}}}});Ext.Direct.PROVIDERS.remoting=Ext.direct.RemotingProvider;Ext.Resizable=Ext.extend(Ext.util.Observable,{constructor:function(z,y){this.el=Ext.get(z);if(y&&y.wrap){y.resizeChild=this.el;this.el=this.el.wrap(typeof y.wrap=="object"?y.wrap:{cls:"xresizable-wrap"});this.el.id=this.el.dom.id=y.resizeChild.id+"-rzwrap";this.el.setStyle("overflow","hidden");this.el.setPositioning(y.resizeChild.getPositioning());y.resizeChild.clearPositioning();if(!y.width||!y.height){var x=y.resizeChild.getSize();this.el.setSize(x.width,x.height)}if(y.pinned&&!y.adjustments){y.adjustments="auto"}}this.proxy=this.el.createProxy({tag:"div",cls:"x-resizable-proxy",id:this.el.id+"-rzproxy"},Ext.getBody());this.proxy.unselectable();this.proxy.enableDisplayMode("block");Ext.apply(this,y);if(this.pinned){this.disableTrackOver=true;this.el.addClass("x-resizable-pinned")}var u=this.el.getStyle("position");if(u!="absolute"&&u!="fixed"){this.el.setStyle("position","relative")}if(!this.handles){this.handles="s,e,se";if(this.multiDirectional){this.handles+=",n,w"}}if(this.handles=="all"){this.handles="n s e w ne nw se sw"}var i=this.handles.split(/\s*?[,;]\s*?| /);var A=Ext.Resizable.positions;for(var v=0,t=i.length;v<t;v++){if(i[v]&&A[i[v]]){var q=A[i[v]];this[q]=new Ext.Resizable.Handle(this,q,this.disableTrackOver,this.transparent,this.handleCls)}}this.corner=this.southeast;if(this.handles.indexOf("n")!=-1||this.handles.indexOf("w")!=-1){this.updateBox=true}this.activeHandle=null;if(this.resizeChild){if(typeof this.resizeChild=="boolean"){this.resizeChild=Ext.get(this.el.dom.firstChild,true)}else{this.resizeChild=Ext.get(this.resizeChild,true)}}if(this.adjustments=="auto"){var B=this.resizeChild;var s=this.west,w=this.east,C=this.north,i=this.south;if(B&&(s||C)){B.position("relative");B.setLeft(s?s.el.getWidth():0);
B.setTop(C?C.el.getHeight():0)}this.adjustments=[(w?-w.el.getWidth():0)+(s?-s.el.getWidth():0),(C?-C.el.getHeight():0)+(i?-i.el.getHeight():0)-1]}if(this.draggable){this.dd=this.dynamic?this.el.initDD(null):this.el.initDDProxy(null,{dragElId:this.proxy.id});this.dd.setHandleElId(this.resizeChild?this.resizeChild.id:this.el.id);if(this.constrainTo){this.dd.constrainTo(this.constrainTo)}}this.addEvents("beforeresize","resize");if(this.width!==null&&this.height!==null){this.resizeTo(this.width,this.height)}else{this.updateChildSize()}if(Ext.isIE){this.el.dom.style.zoom=1}Ext.Resizable.superclass.constructor.call(this)},adjustments:[0,0],animate:false,disableTrackOver:false,draggable:false,duration:0.35,dynamic:false,easing:"easeOutStrong",enabled:true,handles:false,multiDirectional:false,height:null,width:null,heightIncrement:0,widthIncrement:0,minHeight:5,minWidth:5,maxHeight:10000,maxWidth:10000,minX:0,minY:0,pinned:false,preserveRatio:false,resizeChild:false,transparent:false,resizeTo:function(c,d){this.el.setSize(c,d);this.updateChildSize();this.fireEvent("resize",this,c,d,null)},startSizing:function(g,d){this.fireEvent("beforeresize",this,g);if(this.enabled){if(!this.overlay){this.overlay=this.el.createProxy({tag:"div",cls:"x-resizable-overlay",html:"&#160;"},Ext.getBody());this.overlay.unselectable();this.overlay.enableDisplayMode("block");this.overlay.on({scope:this,mousemove:this.onMouseMove,mouseup:this.onMouseUp})}this.overlay.setStyle("cursor",d.el.getStyle("cursor"));this.resizing=true;this.startBox=this.el.getBox();this.startPoint=g.getXY();this.offsets=[(this.startBox.x+this.startBox.width)-this.startPoint[0],(this.startBox.y+this.startBox.height)-this.startPoint[1]];this.overlay.setSize(Ext.lib.Dom.getViewWidth(true),Ext.lib.Dom.getViewHeight(true));this.overlay.show();if(this.constrainTo){var e=Ext.get(this.constrainTo);this.resizeRegion=e.getRegion().adjust(e.getFrameWidth("t"),e.getFrameWidth("l"),-e.getFrameWidth("b"),-e.getFrameWidth("r"))}this.proxy.setStyle("visibility","hidden");this.proxy.show();this.proxy.setBox(this.startBox);if(!this.dynamic){this.proxy.setStyle("visibility","visible")}}},onMouseDown:function(d,c){if(this.enabled){c.stopEvent();this.activeHandle=d;this.startSizing(c,d)}},onMouseUp:function(c){this.activeHandle=null;var d=this.resizeElement();this.resizing=false;this.handleOut();this.overlay.hide();this.proxy.hide();this.fireEvent("resize",this,d.width,d.height,c)},updateChildSize:function(){if(this.resizeChild){var h=this.el;var g=this.resizeChild;var i=this.adjustments;if(h.dom.offsetWidth){var b=h.getSize(true);g.setSize(b.width+i[0],b.height+i[1])}if(Ext.isIE){setTimeout(function(){if(h.dom.offsetWidth){var a=h.getSize(true);g.setSize(a.width+i[0],a.height+i[1])}},10)}}},snap:function(l,i,g){if(!i||!l){return l}var k=l;var h=l%i;if(h>0){if(h>(i/2)){k=l+(i-h)}else{k=l-h}}return Math.max(g,k)},resizeElement:function(){var b=this.proxy.getBox();if(this.updateBox){this.el.setBox(b,false,this.animate,this.duration,null,this.easing)}else{this.el.setSize(b.width,b.height,this.animate,this.duration,null,this.easing)}this.updateChildSize();if(!this.dynamic){this.proxy.hide()}if(this.draggable&&this.constrainTo){this.dd.resetConstraints();this.dd.constrainTo(this.constrainTo)}return b},constrain:function(e,i,g,h){if(e-i<g){i=e-g}else{if(e-i>h){i=e-h}}return i},onMouseMove:function(N){if(this.enabled&&this.activeHandle){try{if(this.resizeRegion&&!this.resizeRegion.contains(N.getPoint())){return}var w=this.curSize||this.startBox,S=this.startBox.x,T=this.startBox.y,Y=S,Z=T,R=w.width,e=w.height,X=R,P=e,Q=this.minWidth,L=this.minHeight,y=this.maxWidth,x=this.maxHeight,V=this.widthIncrement,aa=this.heightIncrement,K=N.getXY(),I=-(this.startPoint[0]-Math.max(this.minX,K[0])),M=-(this.startPoint[1]-Math.max(this.minY,K[1])),U=this.activeHandle.position,h,W;switch(U){case"east":R+=I;R=Math.min(Math.max(Q,R),y);break;case"south":e+=M;e=Math.min(Math.max(L,e),x);break;case"southeast":R+=I;e+=M;R=Math.min(Math.max(Q,R),y);
e=Math.min(Math.max(L,e),x);break;case"north":M=this.constrain(e,M,L,x);T+=M;e-=M;break;case"west":I=this.constrain(R,I,Q,y);S+=I;R-=I;break;case"northeast":R+=I;R=Math.min(Math.max(Q,R),y);M=this.constrain(e,M,L,x);T+=M;e-=M;break;case"northwest":I=this.constrain(R,I,Q,y);M=this.constrain(e,M,L,x);T+=M;e-=M;S+=I;R-=I;break;case"southwest":I=this.constrain(R,I,Q,y);e+=M;e=Math.min(Math.max(L,e),x);S+=I;R-=I;break}var J=this.snap(R,V,Q);var H=this.snap(e,aa,L);if(J!=R||H!=e){switch(U){case"northeast":T-=H-e;break;case"north":T-=H-e;break;case"southwest":S-=J-R;break;case"west":S-=J-R;break;case"northwest":S-=J-R;T-=H-e;break}R=J;e=H}if(this.preserveRatio){switch(U){case"southeast":case"east":e=P*(R/X);e=Math.min(Math.max(L,e),x);R=X*(e/P);break;case"south":R=X*(e/P);R=Math.min(Math.max(Q,R),y);e=P*(R/X);break;case"northeast":R=X*(e/P);R=Math.min(Math.max(Q,R),y);e=P*(R/X);break;case"north":h=R;R=X*(e/P);R=Math.min(Math.max(Q,R),y);e=P*(R/X);S+=(h-R)/2;break;case"southwest":e=P*(R/X);e=Math.min(Math.max(L,e),x);h=R;R=X*(e/P);S+=h-R;break;case"west":W=e;e=P*(R/X);e=Math.min(Math.max(L,e),x);T+=(W-e)/2;h=R;R=X*(e/P);S+=h-R;break;case"northwest":h=R;W=e;e=P*(R/X);e=Math.min(Math.max(L,e),x);R=X*(e/P);T+=W-e;S+=h-R;break}}this.proxy.setBounds(S,T,R,e);if(this.dynamic){this.resizeElement()}}catch(O){}}},handleOver:function(){if(this.enabled){this.el.addClass("x-resizable-over")}},handleOut:function(){if(!this.resizing){this.el.removeClass("x-resizable-over")}},getEl:function(){return this.el},getResizeChild:function(){return this.resizeChild},destroy:function(d){Ext.destroy(this.dd,this.overlay,this.proxy);this.overlay=null;this.proxy=null;var g=Ext.Resizable.positions;for(var e in g){if(typeof g[e]!="function"&&this[g[e]]){this[g[e]].destroy()}}if(d){this.el.update("");Ext.destroy(this.el);this.el=null}this.purgeListeners()},syncHandleHeight:function(){var b=this.el.getHeight(true);if(this.west){this.west.el.setHeight(b)}if(this.east){this.east.el.setHeight(b)}}});Ext.Resizable.positions={n:"north",s:"south",e:"east",w:"west",se:"southeast",sw:"southwest",nw:"northwest",ne:"northeast"};Ext.Resizable.Handle=Ext.extend(Object,{constructor:function(m,k,n,l,i){if(!this.tpl){var h=Ext.DomHelper.createTemplate({tag:"div",cls:"x-resizable-handle x-resizable-handle-{0}"});h.compile();Ext.Resizable.Handle.prototype.tpl=h}this.position=k;this.rz=m;this.el=this.tpl.append(m.el.dom,[this.position],true);this.el.unselectable();if(l){this.el.setOpacity(0)}if(!Ext.isEmpty(i)){this.el.addClass(i)}this.el.on("mousedown",this.onMouseDown,this);if(!n){this.el.on({scope:this,mouseover:this.onMouseOver,mouseout:this.onMouseOut})}},afterResize:function(b){},onMouseDown:function(b){this.rz.onMouseDown(this,b)},onMouseOver:function(b){this.rz.handleOver(this,b)},onMouseOut:function(b){this.rz.handleOut(this,b)},destroy:function(){Ext.destroy(this.el);this.el=null}});Ext.Window=Ext.extend(Ext.Panel,{baseCls:"x-window",resizable:true,draggable:true,closable:true,closeAction:"close",constrain:false,constrainHeader:false,plain:false,minimizable:false,maximizable:false,minHeight:100,minWidth:200,expandOnShow:true,showAnimDuration:0.25,hideAnimDuration:0.25,collapsible:false,initHidden:undefined,hidden:true,elements:"header,body",frame:true,floating:true,initComponent:function(){this.initTools();Ext.Window.superclass.initComponent.call(this);this.addEvents("resize","maximize","minimize","restore");if(Ext.isDefined(this.initHidden)){this.hidden=this.initHidden}if(this.hidden===false){this.hidden=true;this.show()}},getState:function(){return Ext.apply(Ext.Window.superclass.getState.call(this)||{},this.getBox(true))},onRender:function(c,d){Ext.Window.superclass.onRender.call(this,c,d);if(this.plain){this.el.addClass("x-window-plain")}this.focusEl=this.el.createChild({tag:"a",href:"#",cls:"x-dlg-focus",tabIndex:"-1",html:"&#160;"});this.focusEl.swallowEvent("click",true);this.proxy=this.el.createProxy("x-window-proxy");this.proxy.enableDisplayMode("block");if(this.modal){this.mask=this.container.createChild({cls:"ext-el-mask"},this.el.dom);
this.mask.enableDisplayMode("block");this.mask.hide();this.mon(this.mask,"click",this.focus,this)}if(this.maximizable){this.mon(this.header,"dblclick",this.toggleMaximize,this)}},initEvents:function(){Ext.Window.superclass.initEvents.call(this);if(this.animateTarget){this.setAnimateTarget(this.animateTarget)}if(this.resizable){this.resizer=new Ext.Resizable(this.el,{minWidth:this.minWidth,minHeight:this.minHeight,handles:this.resizeHandles||"all",pinned:true,resizeElement:this.resizerAction,handleCls:"x-window-handle"});this.resizer.window=this;this.mon(this.resizer,"beforeresize",this.beforeResize,this)}if(this.draggable){this.header.addClass("x-window-draggable")}this.mon(this.el,"mousedown",this.toFront,this);this.manager=this.manager||Ext.WindowMgr;this.manager.register(this);if(this.maximized){this.maximized=false;this.maximize()}if(this.closable){var b=this.getKeyMap();b.on(27,this.onEsc,this);b.disable()}},initDraggable:function(){this.dd=new Ext.Window.DD(this)},onEsc:function(d,c){c.stopEvent();this[this.closeAction]()},beforeDestroy:function(){if(this.rendered){this.hide();this.clearAnchor();Ext.destroy(this.focusEl,this.resizer,this.dd,this.proxy,this.mask)}Ext.Window.superclass.beforeDestroy.call(this)},onDestroy:function(){if(this.manager){this.manager.unregister(this)}Ext.Window.superclass.onDestroy.call(this)},initTools:function(){if(this.minimizable){this.addTool({id:"minimize",handler:this.minimize.createDelegate(this,[])})}if(this.maximizable){this.addTool({id:"maximize",handler:this.maximize.createDelegate(this,[])});this.addTool({id:"restore",handler:this.restore.createDelegate(this,[]),hidden:true})}if(this.closable){this.addTool({id:"close",handler:this[this.closeAction].createDelegate(this,[])})}},resizerAction:function(){var b=this.proxy.getBox();this.proxy.hide();this.window.handleResize(b);return b},beforeResize:function(){this.resizer.minHeight=Math.max(this.minHeight,this.getFrameHeight()+40);this.resizer.minWidth=Math.max(this.minWidth,this.getFrameWidth()+40);this.resizeBox=this.el.getBox()},updateHandles:function(){if(Ext.isIE&&this.resizer){this.resizer.syncHandleHeight();this.el.repaint()}},handleResize:function(c){var d=this.resizeBox;if(d.x!=c.x||d.y!=c.y){this.updateBox(c)}else{this.setSize(c);if(Ext.isIE6&&Ext.isStrict){this.doLayout()}}this.focus();this.updateHandles();this.saveState()},focus:function(){var i=this.focusEl,h=this.defaultButton,l=typeof h,k,g;if(Ext.isDefined(h)){if(Ext.isNumber(h)&&this.fbar){i=this.fbar.items.get(h)}else{if(Ext.isString(h)){i=Ext.getCmp(h)}else{i=h}}k=i.getEl();g=Ext.getDom(this.container);if(k&&g){if(g!=document.body&&!Ext.lib.Region.getRegion(g).contains(Ext.lib.Region.getRegion(k.dom))){return}}}i=i||this.focusEl;i.focus.defer(10,i)},setAnimateTarget:function(b){b=Ext.get(b);this.animateTarget=b},beforeShow:function(){delete this.el.lastXY;delete this.el.lastLT;if(this.x===undefined||this.y===undefined){var d=this.el.getAlignToXY(this.container,"c-c");var c=this.el.translatePoints(d[0],d[1]);this.x=this.x===undefined?c.left:this.x;this.y=this.y===undefined?c.top:this.y}this.el.setLeftTop(this.x,this.y);if(this.expandOnShow){this.expand(false)}if(this.modal){Ext.getBody().addClass("x-body-masked");this.mask.setSize(Ext.lib.Dom.getViewWidth(true),Ext.lib.Dom.getViewHeight(true));this.mask.show()}},show:function(g,e,d){if(!this.rendered){this.render(Ext.getBody())}if(this.hidden===false){this.toFront();return this}if(this.fireEvent("beforeshow",this)===false){return this}if(e){this.on("show",e,d,{single:true})}this.hidden=false;if(Ext.isDefined(g)){this.setAnimateTarget(g)}this.beforeShow();if(this.animateTarget){this.animShow()}else{this.afterShow()}return this},afterShow:function(c){if(this.isDestroyed){return false}this.proxy.hide();this.el.setStyle("display","block");this.el.show();if(this.maximized){this.fitContainer()}if(Ext.isMac&&Ext.isGecko2){this.cascade(this.setAutoScroll)}if(this.monitorResize||this.modal||this.constrain||this.constrainHeader){Ext.EventManager.onWindowResize(this.onWindowResize,this)
}this.doConstrain();this.doLayout();if(this.keyMap){this.keyMap.enable()}this.toFront();this.updateHandles();if(c&&(Ext.isIE||Ext.isWebKit)){var d=this.getSize();this.onResize(d.width,d.height)}this.onShow();this.fireEvent("show",this)},animShow:function(){this.proxy.show();this.proxy.setBox(this.animateTarget.getBox());this.proxy.setOpacity(0);var b=this.getBox();this.el.setStyle("display","none");this.proxy.shift(Ext.apply(b,{callback:this.afterShow.createDelegate(this,[true],false),scope:this,easing:"easeNone",duration:this.showAnimDuration,opacity:0.5}))},hide:function(g,e,d){if(this.hidden||this.fireEvent("beforehide",this)===false){return this}if(e){this.on("hide",e,d,{single:true})}this.hidden=true;if(g!==undefined){this.setAnimateTarget(g)}if(this.modal){this.mask.hide();Ext.getBody().removeClass("x-body-masked")}if(this.animateTarget){this.animHide()}else{this.el.hide();this.afterHide()}return this},afterHide:function(){this.proxy.hide();if(this.monitorResize||this.modal||this.constrain||this.constrainHeader){Ext.EventManager.removeResizeListener(this.onWindowResize,this)}if(this.keyMap){this.keyMap.disable()}this.onHide();this.fireEvent("hide",this)},animHide:function(){this.proxy.setOpacity(0.5);this.proxy.show();var b=this.getBox(false);this.proxy.setBox(b);this.el.hide();this.proxy.shift(Ext.apply(this.animateTarget.getBox(),{callback:this.afterHide,scope:this,duration:this.hideAnimDuration,easing:"easeNone",opacity:0}))},onShow:Ext.emptyFn,onHide:Ext.emptyFn,onWindowResize:function(){if(this.maximized){this.fitContainer()}if(this.modal){this.mask.setSize("100%","100%");var b=this.mask.dom.offsetHeight;this.mask.setSize(Ext.lib.Dom.getViewWidth(true),Ext.lib.Dom.getViewHeight(true))}this.doConstrain()},doConstrain:function(){if(this.constrain||this.constrainHeader){var d;if(this.constrain){d={right:this.el.shadowOffset,left:this.el.shadowOffset,bottom:this.el.shadowOffset}}else{var e=this.getSize();d={right:-(e.width-100),bottom:-(e.height-25)}}var g=this.el.getConstrainToXY(this.container,true,d);if(g){this.setPosition(g[0],g[1])}}},ghost:function(e){var g=this.createGhost(e);var d=this.getBox(true);g.setLeftTop(d.x,d.y);g.setWidth(d.width);this.el.hide();this.activeGhost=g;return g},unghost:function(c,d){if(!this.activeGhost){return}if(c!==false){this.el.show();this.focus.defer(10,this);if(Ext.isMac&&Ext.isGecko2){this.cascade(this.setAutoScroll)}}if(d!==false){this.setPosition(this.activeGhost.getLeft(true),this.activeGhost.getTop(true))}this.activeGhost.hide();this.activeGhost.remove();delete this.activeGhost},minimize:function(){this.fireEvent("minimize",this);return this},close:function(){if(this.fireEvent("beforeclose",this)!==false){if(this.hidden){this.doClose()}else{this.hide(null,this.doClose,this)}}},doClose:function(){this.fireEvent("close",this);this.destroy()},maximize:function(){if(!this.maximized){this.expand(false);this.restoreSize=this.getSize();this.restorePos=this.getPosition(true);if(this.maximizable){this.tools.maximize.hide();this.tools.restore.show()}this.maximized=true;this.el.disableShadow();if(this.dd){this.dd.lock()}if(this.collapsible){this.tools.toggle.hide()}this.el.addClass("x-window-maximized");this.container.addClass("x-window-maximized-ct");this.setPosition(0,0);this.fitContainer();this.fireEvent("maximize",this)}return this},restore:function(){if(this.maximized){var b=this.tools;this.el.removeClass("x-window-maximized");if(b.restore){b.restore.hide()}if(b.maximize){b.maximize.show()}this.setPosition(this.restorePos[0],this.restorePos[1]);this.setSize(this.restoreSize.width,this.restoreSize.height);delete this.restorePos;delete this.restoreSize;this.maximized=false;this.el.enableShadow(true);if(this.dd){this.dd.unlock()}if(this.collapsible&&b.toggle){b.toggle.show()}this.container.removeClass("x-window-maximized-ct");this.doConstrain();this.fireEvent("restore",this)}return this},toggleMaximize:function(){return this[this.maximized?"restore":"maximize"]()},fitContainer:function(){var b=this.container.getViewSize(false);
this.setSize(b.width,b.height)},setZIndex:function(b){if(this.modal){this.mask.setStyle("z-index",b)}this.el.setZIndex(++b);b+=5;if(this.resizer){this.resizer.proxy.setStyle("z-index",++b)}this.lastZIndex=b},alignTo:function(e,g,i){var h=this.el.getAlignToXY(e,g,i);this.setPagePosition(h[0],h[1]);return this},anchorTo:function(l,i,k,g){this.clearAnchor();this.anchorTarget={el:l,alignment:i,offsets:k};Ext.EventManager.onWindowResize(this.doAnchor,this);var h=typeof g;if(h!="undefined"){Ext.EventManager.on(window,"scroll",this.doAnchor,this,{buffer:h=="number"?g:50})}return this.doAnchor()},doAnchor:function(){var b=this.anchorTarget;this.alignTo(b.el,b.alignment,b.offsets);return this},clearAnchor:function(){if(this.anchorTarget){Ext.EventManager.removeResizeListener(this.doAnchor,this);Ext.EventManager.un(window,"scroll",this.doAnchor,this);delete this.anchorTarget}return this},toFront:function(b){if(this.manager.bringToFront(this)){if(!b||!b.getTarget().focus){this.focus()}}return this},setActive:function(b){if(b){if(!this.maximized){this.el.enableShadow(true)}this.fireEvent("activate",this)}else{this.el.disableShadow();this.fireEvent("deactivate",this)}},toBack:function(){this.manager.sendToBack(this);return this},center:function(){var b=this.el.getAlignToXY(this.container,"c-c");this.setPagePosition(b[0],b[1]);return this}});Ext.reg("window",Ext.Window);Ext.Window.DD=Ext.extend(Ext.dd.DD,{constructor:function(b){this.win=b;Ext.Window.DD.superclass.constructor.call(this,b.el.id,"WindowDD-"+b.id);this.setHandleElId(b.header.id);this.scroll=false},moveOnly:true,headerOffsets:[100,25],startDrag:function(){var e=this.win;this.proxy=e.ghost(e.initialConfig.cls);if(e.constrain!==false){var g=e.el.shadowOffset;this.constrainTo(e.container,{right:g,left:g,bottom:g})}else{if(e.constrainHeader!==false){var d=this.proxy.getSize();this.constrainTo(e.container,{right:-(d.width-this.headerOffsets[0]),bottom:-(d.height-this.headerOffsets[1])})}}},b4Drag:Ext.emptyFn,onDrag:function(b){this.alignElWithMouse(this.proxy,b.getPageX(),b.getPageY())},endDrag:function(b){this.win.unghost();this.win.saveState()}});Ext.WindowGroup=function(){var m={};var o=[];var n=null;var p=function(a,b){return(!a._lastAccess||a._lastAccess<b._lastAccess)?-1:1};var l=function(){var a=o,c=a.length;if(c>0){a.sort(p);var b=a[0].manager.zseed;for(var e=0;e<c;e++){var d=a[e];if(d&&!d.hidden){d.setZIndex(b+(e*10))}}}k()};var i=function(a){if(a!=n){if(n){n.setActive(false)}n=a;if(a){a.setActive(true)}}};var k=function(){for(var a=o.length-1;a>=0;--a){if(!o[a].hidden){i(o[a]);return}}i(null)};return{zseed:9000,register:function(a){if(a.manager){a.manager.unregister(a)}a.manager=this;m[a.id]=a;o.push(a);a.on("hide",k)},unregister:function(a){delete a.manager;delete m[a.id];a.un("hide",k);o.remove(a)},get:function(a){return typeof a=="object"?a:m[a]},bringToFront:function(a){a=this.get(a);if(a!=n){a._lastAccess=new Date().getTime();l();return true}return false},sendToBack:function(a){a=this.get(a);a._lastAccess=-(new Date().getTime());l();return a},hideAll:function(){for(var a in m){if(m[a]&&typeof m[a]!="function"&&m[a].isVisible()){m[a].hide()}}},getActive:function(){return n},getBy:function(a,b){var e=[];for(var c=o.length-1;c>=0;--c){var d=o[c];if(a.call(b||d,d)!==false){e.push(d)}}return e},each:function(b,c){for(var a in m){if(m[a]&&typeof m[a]!="function"){if(b.call(c||m[a],m[a])===false){return}}}}}};Ext.WindowMgr=new Ext.WindowGroup();Ext.MessageBox=function(){var B,T,F,C,O,K,D,U,I,G,M,P,E,A,H,N="",R="",J=["ok","yes","no","cancel"];var S=function(a){E[a].blur();if(B.isVisible()){B.hide();z();Ext.callback(T.fn,T.scope||window,[a,A.dom.value,T],1)}};var z=function(){if(T&&T.cls){B.el.removeClass(T.cls)}I.reset()};var Q=function(c,b,a){if(T&&T.closable!==false){B.hide();z()}if(a){a.stopEvent()}};var L=function(b){var c=0,a;if(!b){Ext.each(J,function(d){E[d].hide()});return c}B.footer.dom.style.display="";Ext.iterate(E,function(e,d){a=b[e];if(a){d.show();d.setText(Ext.isString(a)?a:Ext.MessageBox.buttonText[e]);
c+=d.getEl().getWidth()+15}else{d.hide()}});return c};return{getDialog:function(b){if(!B){var c=[];E={};Ext.each(J,function(d){c.push(E[d]=new Ext.Button({text:this.buttonText[d],handler:S.createCallback(d),hideMode:"offsets"}))},this);B=new Ext.Window({autoCreate:true,title:b,resizable:false,constrain:true,constrainHeader:true,minimizable:false,maximizable:false,stateful:false,modal:true,shim:true,buttonAlign:"center",width:400,height:100,minHeight:80,plain:true,footer:true,closable:true,close:function(){if(T&&T.buttons&&T.buttons.no&&!T.buttons.cancel){S("no")}else{S("cancel")}},fbar:new Ext.Toolbar({items:c,enableOverflow:false})});B.render(document.body);B.getEl().addClass("x-window-dlg");F=B.mask;O=B.body.createChild({html:'<div class="ext-mb-icon"></div><div class="ext-mb-content"><span class="ext-mb-text"></span><br /><div class="ext-mb-fix-cursor"><input type="text" class="ext-mb-input" /><textarea class="ext-mb-textarea"></textarea></div></div>'});M=Ext.get(O.dom.firstChild);var a=O.dom.childNodes[1];K=Ext.get(a.firstChild);D=Ext.get(a.childNodes[2].firstChild);D.enableDisplayMode();D.addKeyListener([10,13],function(){if(B.isVisible()&&T&&T.buttons){if(T.buttons.ok){S("ok")}else{if(T.buttons.yes){S("yes")}}}});U=Ext.get(a.childNodes[2].childNodes[1]);U.enableDisplayMode();I=new Ext.ProgressBar({renderTo:O});O.createChild({cls:"x-clear"})}return B},updateText:function(e){if(!B.isVisible()&&!T.width){B.setSize(this.maxWidth,100)}K.update(e?e+" ":"&#160;");var a=R!=""?(M.getWidth()+M.getMargins("lr")):0,b=K.getWidth()+K.getMargins("lr"),g=B.getFrameWidth("lr"),c=B.body.getFrameWidth("lr"),d;d=Math.max(Math.min(T.width||a+b+g+c,T.maxWidth||this.maxWidth),Math.max(T.minWidth||this.minWidth,H||0));if(T.prompt===true){A.setWidth(d-a-g-c)}if(T.progress===true||T.wait===true){I.setSize(d-a-g-c)}if(Ext.isIE&&d==H){d+=4}K.update(e||"&#160;");B.setSize(d,"auto").center();return this},updateProgress:function(a,b,c){I.updateProgress(a,b);if(c){this.updateText(c)}return this},isVisible:function(){return B&&B.isVisible()},hide:function(){var a=B?B.activeGhost:null;if(this.isVisible()||a){B.hide();z();if(a){B.unghost(false,false)}}return this},show:function(d){if(this.isVisible()){this.hide()}T=d;var b=this.getDialog(T.title||"&#160;");b.setTitle(T.title||"&#160;");var c=(T.closable!==false&&T.progress!==true&&T.wait!==true);b.tools.close.setDisplayed(c);A=D;T.prompt=T.prompt||(T.multiline?true:false);if(T.prompt){if(T.multiline){D.hide();U.show();U.setHeight(Ext.isNumber(T.multiline)?T.multiline:this.defaultTextHeight);A=U}else{D.show();U.hide()}}else{D.hide();U.hide()}A.dom.value=T.value||"";if(T.prompt){b.focusEl=A}else{var e=T.buttons;var a=null;if(e&&e.ok){a=E.ok}else{if(e&&e.yes){a=E.yes}}if(a){b.focusEl=a}}if(Ext.isDefined(T.iconCls)){b.setIconClass(T.iconCls)}this.setIcon(Ext.isDefined(T.icon)?T.icon:N);H=L(T.buttons);I.setVisible(T.progress===true||T.wait===true);this.updateProgress(0,T.progressText);this.updateText(T.msg);if(T.cls){b.el.addClass(T.cls)}b.proxyDrag=T.proxyDrag===true;b.modal=T.modal!==false;b.mask=T.modal!==false?F:false;if(!b.isVisible()){document.body.appendChild(B.el.dom);b.setAnimateTarget(T.animEl);b.on("show",function(){if(c===true){b.keyMap.enable()}else{b.keyMap.disable()}},this,{single:true});b.show(T.animEl)}if(T.wait===true){I.wait(T.waitConfig)}return this},setIcon:function(a){if(!B){N=a;return}N=undefined;if(a&&a!=""){M.removeClass("x-hidden");M.replaceClass(R,a);O.addClass("x-dlg-icon");R=a}else{M.replaceClass(R,"x-hidden");O.removeClass("x-dlg-icon");R=""}return this},progress:function(c,a,b){this.show({title:c,msg:a,buttons:false,progress:true,closable:false,minWidth:this.minProgressWidth,progressText:b});return this},wait:function(c,a,b){this.show({title:a,msg:c,buttons:false,closable:false,wait:true,modal:true,minWidth:this.minProgressWidth,waitConfig:b});return this},alert:function(c,d,a,b){this.show({title:c,msg:d,buttons:this.OK,fn:a,scope:b,minWidth:this.minWidth});return this},confirm:function(c,d,a,b){this.show({title:c,msg:d,buttons:this.YESNO,fn:a,scope:b,icon:this.QUESTION,minWidth:this.minWidth});
return this},prompt:function(b,c,g,a,e,d){this.show({title:b,msg:c,buttons:this.OKCANCEL,fn:g,minWidth:this.minPromptWidth,scope:a,prompt:true,multiline:e,value:d});return this},OK:{ok:true},CANCEL:{cancel:true},OKCANCEL:{ok:true,cancel:true},YESNO:{yes:true,no:true},YESNOCANCEL:{yes:true,no:true,cancel:true},INFO:"ext-mb-info",WARNING:"ext-mb-warning",QUESTION:"ext-mb-question",ERROR:"ext-mb-error",defaultTextHeight:75,maxWidth:600,minWidth:100,minProgressWidth:250,minPromptWidth:250,buttonText:{ok:"OK",cancel:"Cancel",yes:"Yes",no:"No"}}}();Ext.Msg=Ext.MessageBox;Ext.dd.PanelProxy=Ext.extend(Object,{constructor:function(d,c){this.panel=d;this.id=this.panel.id+"-ddproxy";Ext.apply(this,c)},insertProxy:true,setStatus:Ext.emptyFn,reset:Ext.emptyFn,update:Ext.emptyFn,stop:Ext.emptyFn,sync:Ext.emptyFn,getEl:function(){return this.ghost},getGhost:function(){return this.ghost},getProxy:function(){return this.proxy},hide:function(){if(this.ghost){if(this.proxy){this.proxy.remove();delete this.proxy}this.panel.el.dom.style.display="";this.ghost.remove();delete this.ghost}},show:function(){if(!this.ghost){this.ghost=this.panel.createGhost(this.panel.initialConfig.cls,undefined,Ext.getBody());this.ghost.setXY(this.panel.el.getXY());if(this.insertProxy){this.proxy=this.panel.el.insertSibling({cls:"x-panel-dd-spacer"});this.proxy.setSize(this.panel.getSize())}this.panel.el.dom.style.display="none"}},repair:function(d,g,e){this.hide();if(typeof g=="function"){g.call(e||this)}},moveProxy:function(d,c){if(this.proxy){d.insertBefore(this.proxy.dom,c)}}});Ext.Panel.DD=Ext.extend(Ext.dd.DragSource,{constructor:function(e,g){this.panel=e;this.dragData={panel:e};this.proxy=new Ext.dd.PanelProxy(e,g);Ext.Panel.DD.superclass.constructor.call(this,e.el,g);var h=e.header,i=e.body;if(h){this.setHandleElId(h.id);i=e.header}i.setStyle("cursor","move");this.scroll=false},showFrame:Ext.emptyFn,startDrag:Ext.emptyFn,b4StartDrag:function(d,c){this.proxy.show()},b4MouseDown:function(d){var e=d.getPageX(),g=d.getPageY();this.autoOffset(e,g)},onInitDrag:function(d,c){this.onStartDrag(d,c);return true},createFrame:Ext.emptyFn,getDragEl:function(b){return this.proxy.ghost.dom},endDrag:function(b){this.proxy.hide();this.panel.saveState()},autoOffset:function(d,c){d-=this.startPageX;c-=this.startPageY;this.setDelta(d,c)}});Ext.state.Provider=Ext.extend(Ext.util.Observable,{constructor:function(){this.addEvents("statechange");this.state={};Ext.state.Provider.superclass.constructor.call(this)},get:function(c,d){return typeof this.state[c]=="undefined"?d:this.state[c]},clear:function(b){delete this.state[b];this.fireEvent("statechange",this,b,null)},set:function(d,c){this.state[d]=c;this.fireEvent("statechange",this,d,c)},decodeValue:function(i){var n=/^(a|n|d|b|s|o|e)\:(.*)$/,l=n.exec(unescape(i)),o,p,k,m;if(!l||!l[1]){return}p=l[1];k=l[2];switch(p){case"e":return null;case"n":return parseFloat(k);case"d":return new Date(Date.parse(k));case"b":return(k=="1");case"a":o=[];if(k!=""){Ext.each(k.split("^"),function(a){o.push(this.decodeValue(a))},this)}return o;case"o":o={};if(k!=""){Ext.each(k.split("^"),function(a){m=a.split("=");o[m[0]]=this.decodeValue(m[1])},this)}return o;default:return k}},encodeValue:function(n){var h,k="",l=0,i,m;if(n==null){return"e:1"}else{if(typeof n=="number"){h="n:"+n}else{if(typeof n=="boolean"){h="b:"+(n?"1":"0")}else{if(Ext.isDate(n)){h="d:"+n.toGMTString()}else{if(Ext.isArray(n)){for(i=n.length;l<i;l++){k+=this.encodeValue(n[l]);if(l!=i-1){k+="^"}}h="a:"+k}else{if(typeof n=="object"){for(m in n){if(typeof n[m]!="function"&&n[m]!==undefined){k+=m+"="+this.encodeValue(n[m])+"^"}}h="o:"+k.substring(0,k.length-1)}else{h="s:"+n}}}}}}return escape(h)}});Ext.state.Manager=function(){var b=new Ext.state.Provider();return{setProvider:function(a){b=a},get:function(d,a){return b.get(d,a)},set:function(a,d){b.set(a,d)},clear:function(a){b.clear(a)},getProvider:function(){return b}}}();Ext.state.CookieProvider=Ext.extend(Ext.state.Provider,{constructor:function(b){Ext.state.CookieProvider.superclass.constructor.call(this);
this.path="/";this.expires=new Date(new Date().getTime()+(1000*60*60*24*7));this.domain=null;this.secure=false;Ext.apply(this,b);this.state=this.readCookies()},set:function(d,c){if(typeof c=="undefined"||c===null){this.clear(d);return}this.setCookie(d,c);Ext.state.CookieProvider.superclass.set.call(this,d,c)},clear:function(b){this.clearCookie(b);Ext.state.CookieProvider.superclass.clear.call(this,b)},readCookies:function(){var n={},k=document.cookie+";",c=/\s?(.*?)=(.*?);/g,l,i,m;while((l=c.exec(k))!=null){i=l[1];m=l[2];if(i&&i.substring(0,3)=="ys-"){n[i.substr(3)]=this.decodeValue(m)}}return n},setCookie:function(d,c){document.cookie="ys-"+d+"="+this.encodeValue(c)+((this.expires==null)?"":("; expires="+this.expires.toGMTString()))+((this.path==null)?"":("; path="+this.path))+((this.domain==null)?"":("; domain="+this.domain))+((this.secure==true)?"; secure":"")},clearCookie:function(b){document.cookie="ys-"+b+"=null; expires=Thu, 01-Jan-70 00:00:01 GMT"+((this.path==null)?"":("; path="+this.path))+((this.domain==null)?"":("; domain="+this.domain))+((this.secure==true)?"; secure":"")}});Ext.DataView=Ext.extend(Ext.BoxComponent,{selectedClass:"x-view-selected",emptyText:"",deferEmptyText:true,trackOver:false,blockRefresh:false,last:false,initComponent:function(){Ext.DataView.superclass.initComponent.call(this);if(Ext.isString(this.tpl)||Ext.isArray(this.tpl)){this.tpl=new Ext.XTemplate(this.tpl)}this.addEvents("beforeclick","click","mouseenter","mouseleave","containerclick","dblclick","contextmenu","containercontextmenu","selectionchange","beforeselect");this.store=Ext.StoreMgr.lookup(this.store);this.all=new Ext.CompositeElementLite();this.selected=new Ext.CompositeElementLite()},afterRender:function(){Ext.DataView.superclass.afterRender.call(this);this.mon(this.getTemplateTarget(),{click:this.onClick,dblclick:this.onDblClick,contextmenu:this.onContextMenu,scope:this});if(this.overClass||this.trackOver){this.mon(this.getTemplateTarget(),{mouseover:this.onMouseOver,mouseout:this.onMouseOut,scope:this})}if(this.store){this.bindStore(this.store,true)}},refresh:function(){this.clearSelections(false,true);var c=this.getTemplateTarget(),d=this.store.getRange();c.update("");if(d.length<1){if(!this.deferEmptyText||this.hasSkippedEmptyText){c.update(this.emptyText)}this.all.clear()}else{this.tpl.overwrite(c,this.collectData(d,0));this.all.fill(Ext.query(this.itemSelector,c.dom));this.updateIndexes(0)}this.hasSkippedEmptyText=true},getTemplateTarget:function(){return this.el},prepareData:function(b){return b},collectData:function(g,i){var k=[],l=0,h=g.length;for(;l<h;l++){k[k.length]=this.prepareData(g[l].data,i+l,g[l])}return k},bufferRender:function(e,d){var g=document.createElement("div");this.tpl.overwrite(g,this.collectData(e,d));return Ext.query(this.itemSelector,g)},onUpdate:function(k,i){var h=this.store.indexOf(i);if(h>-1){var l=this.isSelected(h),n=this.all.elements[h],m=this.bufferRender([i],h)[0];this.all.replaceElement(h,m,true);if(l){this.selected.replaceElement(n,m);this.all.item(h).addClass(this.selectedClass)}this.updateIndexes(h,h)}},onAdd:function(k,m,l){if(this.all.getCount()===0){this.refresh();return}var n=this.bufferRender(m,l),i,a=this.all.elements;if(l<this.all.getCount()){i=this.all.item(l).insertSibling(n,"before",true);a.splice.apply(a,[l,0].concat(n))}else{i=this.all.last().insertSibling(n,"after",true);a.push.apply(a,n)}this.updateIndexes(l)},onRemove:function(g,e,d){this.deselect(d);this.all.removeElement(d,true);this.updateIndexes(d);if(this.store.getCount()===0){this.refresh()}},refreshNode:function(b){this.onUpdate(this.store,this.store.getAt(b))},updateIndexes:function(h,i){var e=this.all.elements;h=h||0;i=i||((i===0)?0:(e.length-1));for(var g=h;g<=i;g++){e[g].viewIndex=g}},getStore:function(){return this.store},bindStore:function(d,c){if(!c&&this.store){if(d!==this.store&&this.store.autoDestroy){this.store.destroy()}else{this.store.un("beforeload",this.onBeforeLoad,this);this.store.un("datachanged",this.onDataChanged,this);
this.store.un("add",this.onAdd,this);this.store.un("remove",this.onRemove,this);this.store.un("update",this.onUpdate,this);this.store.un("clear",this.refresh,this)}if(!d){this.store=null}}if(d){d=Ext.StoreMgr.lookup(d);d.on({scope:this,beforeload:this.onBeforeLoad,datachanged:this.onDataChanged,add:this.onAdd,remove:this.onRemove,update:this.onUpdate,clear:this.refresh})}this.store=d;if(d){this.refresh()}},onDataChanged:function(){if(this.blockRefresh!==true){this.refresh.apply(this,arguments)}},findItemFromChild:function(b){return Ext.fly(b).findParent(this.itemSelector,this.getTemplateTarget())},onClick:function(g){var d=g.getTarget(this.itemSelector,this.getTemplateTarget()),e;if(d){e=this.indexOf(d);if(this.onItemClick(d,e,g)!==false){this.fireEvent("click",this,e,d,g)}}else{if(this.fireEvent("containerclick",this,g)!==false){this.onContainerClick(g)}}},onContainerClick:function(b){this.clearSelections()},onContextMenu:function(c){var d=c.getTarget(this.itemSelector,this.getTemplateTarget());if(d){this.fireEvent("contextmenu",this,this.indexOf(d),d,c)}else{this.fireEvent("containercontextmenu",this,c)}},onDblClick:function(c){var d=c.getTarget(this.itemSelector,this.getTemplateTarget());if(d){this.fireEvent("dblclick",this,this.indexOf(d),d,c)}},onMouseOver:function(c){var d=c.getTarget(this.itemSelector,this.getTemplateTarget());if(d&&d!==this.lastItem){this.lastItem=d;Ext.fly(d).addClass(this.overClass);this.fireEvent("mouseenter",this,this.indexOf(d),d,c)}},onMouseOut:function(b){if(this.lastItem){if(!b.within(this.lastItem,true,true)){Ext.fly(this.lastItem).removeClass(this.overClass);this.fireEvent("mouseleave",this,this.indexOf(this.lastItem),this.lastItem,b);delete this.lastItem}}},onItemClick:function(d,e,g){if(this.fireEvent("beforeclick",this,e,d,g)===false){return false}if(this.multiSelect){this.doMultiSelection(d,e,g);g.preventDefault()}else{if(this.singleSelect){this.doSingleSelection(d,e,g);g.preventDefault()}}return true},doSingleSelection:function(d,e,g){if(g.ctrlKey&&this.isSelected(e)){this.deselect(e)}else{this.select(e,false)}},doMultiSelection:function(i,g,h){if(h.shiftKey&&this.last!==false){var e=this.last;this.selectRange(e,g,h.ctrlKey);this.last=e}else{if((h.ctrlKey||this.simpleSelect)&&this.isSelected(g)){this.deselect(g)}else{this.select(g,h.ctrlKey||h.shiftKey||this.simpleSelect)}}},getSelectionCount:function(){return this.selected.getCount()},getSelectedNodes:function(){return this.selected.elements},getSelectedIndexes:function(){var e=[],h=this.selected.elements,i=0,g=h.length;for(;i<g;i++){e.push(h[i].viewIndex)}return e},getSelectedRecords:function(){return this.getRecords(this.selected.elements)},getRecords:function(i){var e=[],h=0,g=i.length;for(;h<g;h++){e[e.length]=this.store.getAt(i[h].viewIndex)}return e},getRecord:function(b){return this.store.getAt(b.viewIndex)},clearSelections:function(d,c){if((this.multiSelect||this.singleSelect)&&this.selected.getCount()>0){if(!c){this.selected.removeClass(this.selectedClass)}this.selected.clear();this.last=false;if(!d){this.fireEvent("selectionchange",this,this.selected.elements)}}},isSelected:function(b){return this.selected.contains(this.getNode(b))},deselect:function(b){if(this.isSelected(b)){b=this.getNode(b);this.selected.removeElement(b);if(this.last==b.viewIndex){this.last=false}Ext.fly(b).removeClass(this.selectedClass);this.fireEvent("selectionchange",this,this.selected.elements)}},select:function(m,k,h){if(Ext.isArray(m)){if(!k){this.clearSelections(true)}for(var n=0,i=m.length;n<i;n++){this.select(m[n],true,true)}if(!h){this.fireEvent("selectionchange",this,this.selected.elements)}}else{var l=this.getNode(m);if(!k){this.clearSelections(true)}if(l&&!this.isSelected(l)){if(this.fireEvent("beforeselect",this,l,this.selected.elements)!==false){Ext.fly(l).addClass(this.selectedClass);this.selected.add(l);this.last=l.viewIndex;if(!h){this.fireEvent("selectionchange",this,this.selected.elements)}}}}},selectRange:function(g,e,d){if(!d){this.clearSelections(true)
}this.select(this.getNodes(g,e),true)},getNode:function(c){if(Ext.isString(c)){return document.getElementById(c)}else{if(Ext.isNumber(c)){return this.all.elements[c]}else{if(c instanceof Ext.data.Record){var d=this.store.indexOf(c);return this.all.elements[d]}}}return c},getNodes:function(i,h){var k=this.all.elements,g=[],l;i=i||0;h=!Ext.isDefined(h)?Math.max(k.length-1,0):h;if(i<=h){for(l=i;l<=h&&k[l];l++){g.push(k[l])}}else{for(l=i;l>=h&&k[l];l--){g.push(k[l])}}return g},indexOf:function(b){b=this.getNode(b);if(Ext.isNumber(b.viewIndex)){return b.viewIndex}return this.all.indexOf(b)},onBeforeLoad:function(){if(this.loadingText){this.clearSelections(false,true);this.getTemplateTarget().update('<div class="loading-indicator">'+this.loadingText+"</div>");this.all.clear()}},onDestroy:function(){this.all.clear();this.selected.clear();Ext.DataView.superclass.onDestroy.call(this);this.bindStore(null)}});Ext.DataView.prototype.setStore=Ext.DataView.prototype.bindStore;Ext.reg("dataview",Ext.DataView);Ext.list.ListView=Ext.extend(Ext.DataView,{itemSelector:"dl",selectedClass:"x-list-selected",overClass:"x-list-over",scrollOffset:undefined,columnResize:true,columnSort:true,maxColumnWidth:Ext.isIE?99:100,initComponent:function(){if(this.columnResize){this.colResizer=new Ext.list.ColumnResizer(this.colResizer);this.colResizer.init(this)}if(this.columnSort){this.colSorter=new Ext.list.Sorter(this.columnSort);this.colSorter.init(this)}if(!this.internalTpl){this.internalTpl=new Ext.XTemplate('<div class="x-list-header"><div class="x-list-header-inner">','<tpl for="columns">','<div style="width:{[values.width*100]}%;text-align:{align};"><em unselectable="on" id="',this.id,'-xlhd-{#}">',"{header}","</em></div>","</tpl>",'<div class="x-clear"></div>',"</div></div>",'<div class="x-list-body"><div class="x-list-body-inner">',"</div></div>")}if(!this.tpl){this.tpl=new Ext.XTemplate('<tpl for="rows">',"<dl>",'<tpl for="parent.columns">','<dt style="width:{[values.width*100]}%;text-align:{align};">','<em unselectable="on"<tpl if="cls"> class="{cls}</tpl>">',"{[values.tpl.apply(parent)]}","</em></dt>","</tpl>",'<div class="x-clear"></div>',"</dl>","</tpl>")}var o=this.columns,q=0,p=0,i=o.length,v=[];for(var s=0;s<i;s++){var c=o[s];if(!c.isColumn){c.xtype=c.xtype?(/^lv/.test(c.xtype)?c.xtype:"lv"+c.xtype):"lvcolumn";c=Ext.create(c)}if(c.width){q+=c.width*100;if(q>this.maxColumnWidth){c.width-=(q-this.maxColumnWidth)/100}p++}v.push(c)}o=this.columns=v;if(p<i){var u=i-p;if(q<this.maxColumnWidth){var w=((this.maxColumnWidth-q)/u)/100;for(var t=0;t<i;t++){var c=o[t];if(!c.width){c.width=w}}}}Ext.list.ListView.superclass.initComponent.call(this)},onRender:function(){this.autoEl={cls:"x-list-wrap"};Ext.list.ListView.superclass.onRender.apply(this,arguments);this.internalTpl.overwrite(this.el,{columns:this.columns});this.innerBody=Ext.get(this.el.dom.childNodes[1].firstChild);this.innerHd=Ext.get(this.el.dom.firstChild.firstChild);if(this.hideHeaders){this.el.dom.firstChild.style.display="none"}},getTemplateTarget:function(){return this.innerBody},collectData:function(){var b=Ext.list.ListView.superclass.collectData.apply(this,arguments);return{columns:this.columns,rows:b}},verifyInternalSize:function(){if(this.lastSize){this.onResize(this.lastSize.width,this.lastSize.height)}},onResize:function(n,l){var h=this.innerBody.dom,k=this.innerHd.dom,m=n-Ext.num(this.scrollOffset,Ext.getScrollBarWidth())+"px",i;if(!h){return}i=h.parentNode;if(Ext.isNumber(n)){if(this.reserveScrollOffset||((i.offsetWidth-i.clientWidth)>10)){h.style.width=m;k.style.width=m}else{h.style.width=n+"px";k.style.width=n+"px";setTimeout(function(){if((i.offsetWidth-i.clientWidth)>10){h.style.width=m;k.style.width=m}},10)}}if(Ext.isNumber(l)){i.style.height=Math.max(0,l-k.parentNode.offsetHeight)+"px"}},updateIndexes:function(){Ext.list.ListView.superclass.updateIndexes.apply(this,arguments);this.verifyInternalSize()},findHeaderIndex:function(i){i=i.dom||i;var h=i.parentNode,l=h.parentNode.childNodes,c=0,k;
for(;k=l[c];c++){if(k==h){return c}}return -1},setHdWidths:function(){var h=this.innerHd.dom.getElementsByTagName("div"),i=0,e=this.columns,g=e.length;for(;i<g;i++){h[i].style.width=(e[i].width*100)+"%"}}});Ext.reg("listview",Ext.list.ListView);Ext.ListView=Ext.list.ListView;Ext.list.Column=Ext.extend(Object,{isColumn:true,align:"left",header:"",width:null,cls:"",constructor:function(b){if(!b.tpl){b.tpl=new Ext.XTemplate("{"+b.dataIndex+"}")}else{if(Ext.isString(b.tpl)){b.tpl=new Ext.XTemplate(b.tpl)}}Ext.apply(this,b)}});Ext.reg("lvcolumn",Ext.list.Column);Ext.list.NumberColumn=Ext.extend(Ext.list.Column,{format:"0,000.00",constructor:function(b){b.tpl=b.tpl||new Ext.XTemplate("{"+b.dataIndex+':number("'+(b.format||this.format)+'")}');Ext.list.NumberColumn.superclass.constructor.call(this,b)}});Ext.reg("lvnumbercolumn",Ext.list.NumberColumn);Ext.list.DateColumn=Ext.extend(Ext.list.Column,{format:"m/d/Y",constructor:function(b){b.tpl=b.tpl||new Ext.XTemplate("{"+b.dataIndex+':date("'+(b.format||this.format)+'")}');Ext.list.DateColumn.superclass.constructor.call(this,b)}});Ext.reg("lvdatecolumn",Ext.list.DateColumn);Ext.list.BooleanColumn=Ext.extend(Ext.list.Column,{trueText:"true",falseText:"false",undefinedText:"&#160;",constructor:function(h){h.tpl=h.tpl||new Ext.XTemplate("{"+h.dataIndex+":this.format}");var c=this.trueText,i=this.falseText,g=this.undefinedText;h.tpl.format=function(a){if(a===undefined){return g}if(!a||a==="false"){return i}return c};Ext.list.DateColumn.superclass.constructor.call(this,h)}});Ext.reg("lvbooleancolumn",Ext.list.BooleanColumn);Ext.list.ColumnResizer=Ext.extend(Ext.util.Observable,{minPct:0.05,constructor:function(b){Ext.apply(this,b);Ext.list.ColumnResizer.superclass.constructor.call(this)},init:function(b){this.view=b;b.on("render",this.initEvents,this)},initEvents:function(b){b.mon(b.innerHd,"mousemove",this.handleHdMove,this);this.tracker=new Ext.dd.DragTracker({onBeforeStart:this.onBeforeStart.createDelegate(this),onStart:this.onStart.createDelegate(this),onDrag:this.onDrag.createDelegate(this),onEnd:this.onEnd.createDelegate(this),tolerance:3,autoStart:300});this.tracker.initEl(b.innerHd);b.on("beforedestroy",this.tracker.destroy,this.tracker)},handleHdMove:function(n,q){var s=5,e=n.getPageX(),m=n.getTarget("em",3,true);if(m){var o=m.getRegion(),p=m.dom.style,l=m.dom.parentNode;if(e-o.left<=s&&l!=l.parentNode.firstChild){this.activeHd=Ext.get(l.previousSibling.firstChild);p.cursor=Ext.isWebKit?"e-resize":"col-resize"}else{if(o.right-e<=s&&l!=l.parentNode.lastChild.previousSibling){this.activeHd=m;p.cursor=Ext.isWebKit?"w-resize":"col-resize"}else{delete this.activeHd;p.cursor=""}}}},onBeforeStart:function(b){this.dragHd=this.activeHd;return !!this.dragHd},onStart:function(i){var k=this,e=k.view,l=k.dragHd,h=k.tracker.getXY()[0];k.proxy=e.el.createChild({cls:"x-list-resizer"});k.dragX=l.getX();k.headerIndex=e.findHeaderIndex(l);k.headersDisabled=e.disableHeaders;e.disableHeaders=true;k.proxy.setHeight(e.el.getHeight());k.proxy.setX(k.dragX);k.proxy.setWidth(h-k.dragX);this.setBoundaries()},setBoundaries:function(p){var o=this.view,s=this.headerIndex,w=o.innerHd.getWidth(),p=o.innerHd.getX(),x=Math.ceil(w*this.minPct),n=w-x,u=o.columns.length,v=o.innerHd.select("em",true),t=x+p,y=n+p,q;if(u==2){this.minX=t;this.maxX=y}else{q=v.item(s+2);this.minX=v.item(s).getX()+x;this.maxX=q?q.getX()-x:y;if(s==0){this.minX=t}else{if(s==u-2){this.maxX=y}}}},onDrag:function(g){var d=this,e=d.tracker.getXY()[0].constrain(d.minX,d.maxX);d.proxy.setWidth(e-this.dragX)},onEnd:function(s){var u=this.proxy.getWidth(),t=this.headerIndex,o=this.view,w=o.columns,x=o.innerHd.getWidth(),p=Math.ceil(u*o.maxColumnWidth/x)/100,v=this.headersDisabled,e=w[t],q=w[t+1],y=e.width+q.width;this.proxy.remove();e.width=p;q.width=y-p;delete this.dragHd;o.setHdWidths();o.refresh();setTimeout(function(){o.disableHeaders=v},100)}});Ext.ListView.ColumnResizer=Ext.list.ColumnResizer;Ext.list.Sorter=Ext.extend(Ext.util.Observable,{sortClasses:["sort-asc","sort-desc"],constructor:function(b){Ext.apply(this,b);
Ext.list.Sorter.superclass.constructor.call(this)},init:function(b){this.view=b;b.on("render",this.initEvents,this)},initEvents:function(b){b.mon(b.innerHd,"click",this.onHdClick,this);b.innerHd.setStyle("cursor","pointer");b.mon(b.store,"datachanged",this.updateSortState,this);this.updateSortState.defer(10,this,[b.store])},updateSortState:function(p){var m=p.getSortState();if(!m){return}this.sortState=m;var n=this.view.columns,l=-1;for(var o=0,k=n.length;o<k;o++){if(n[o].dataIndex==m.field){l=o;break}}if(l!=-1){var i=m.direction;this.updateSortIcon(l,i)}},updateSortIcon:function(e,g){var h=this.sortClasses;var i=this.view.innerHd.select("em").removeClass(h);i.item(e).addClass(h[g=="DESC"?1:0])},onHdClick:function(g){var d=g.getTarget("em",3);if(d&&!this.view.disableHeaders){var e=this.view.findHeaderIndex(d);this.view.store.sort(this.view.columns[e].dataIndex)}}});Ext.ListView.Sorter=Ext.list.Sorter;Ext.TabPanel=Ext.extend(Ext.Panel,{deferredRender:true,tabWidth:120,minTabWidth:30,resizeTabs:false,enableTabScroll:false,scrollIncrement:0,scrollRepeatInterval:400,scrollDuration:0.35,animScroll:true,tabPosition:"top",baseCls:"x-tab-panel",autoTabs:false,autoTabSelector:"div.x-tab",activeTab:undefined,tabMargin:2,plain:false,wheelIncrement:20,idDelimiter:"__",itemCls:"x-tab-item",elements:"body",headerAsText:false,frame:false,hideBorders:true,initComponent:function(){this.frame=false;Ext.TabPanel.superclass.initComponent.call(this);this.addEvents("beforetabchange","tabchange","contextmenu");this.setLayout(new Ext.layout.CardLayout(Ext.apply({layoutOnCardChange:this.layoutOnTabChange,deferredRender:this.deferredRender},this.layoutConfig)));if(this.tabPosition=="top"){this.elements+=",header";this.stripTarget="header"}else{this.elements+=",footer";this.stripTarget="footer"}if(!this.stack){this.stack=Ext.TabPanel.AccessStack()}this.initItems()},onRender:function(n,i){Ext.TabPanel.superclass.onRender.call(this,n,i);if(this.plain){var k=this.tabPosition=="top"?"header":"footer";this[k].addClass("x-tab-panel-"+k+"-plain")}var h=this[this.stripTarget];this.stripWrap=h.createChild({cls:"x-tab-strip-wrap",cn:{tag:"ul",cls:"x-tab-strip x-tab-strip-"+this.tabPosition}});var l=(this.tabPosition=="bottom"?this.stripWrap:null);h.createChild({cls:"x-tab-strip-spacer"},l);this.strip=new Ext.Element(this.stripWrap.dom.firstChild);this.edge=this.strip.createChild({tag:"li",cls:"x-tab-edge",cn:[{tag:"span",cls:"x-tab-strip-text",cn:"&#160;"}]});this.strip.createChild({cls:"x-clear"});this.body.addClass("x-tab-panel-body-"+this.tabPosition);if(!this.itemTpl){var m=new Ext.Template('<li class="{cls}" id="{id}"><a class="x-tab-strip-close"></a>','<a class="x-tab-right" href="#"><em class="x-tab-left">','<span class="x-tab-strip-inner"><span class="x-tab-strip-text {iconCls}">{text}</span></span>',"</em></a></li>");m.disableFormats=true;m.compile();Ext.TabPanel.prototype.itemTpl=m}this.items.each(this.initTab,this)},afterRender:function(){Ext.TabPanel.superclass.afterRender.call(this);if(this.autoTabs){this.readTabs(false)}if(this.activeTab!==undefined){var b=Ext.isObject(this.activeTab)?this.activeTab:this.items.get(this.activeTab);delete this.activeTab;this.setActiveTab(b)}},initEvents:function(){Ext.TabPanel.superclass.initEvents.call(this);this.mon(this.strip,{scope:this,mousedown:this.onStripMouseDown,contextmenu:this.onStripContextMenu});if(this.enableTabScroll){this.mon(this.strip,"mousewheel",this.onWheel,this)}},findTargets:function(g){var d=null,e=g.getTarget("li:not(.x-tab-edge)",this.strip);if(e){d=this.getComponent(e.id.split(this.idDelimiter)[1]);if(d.disabled){return{close:null,item:null,el:null}}}return{close:g.getTarget(".x-tab-strip-close",this.strip),item:d,el:e}},onStripMouseDown:function(c){if(c.button!==0){return}c.preventDefault();var d=this.findTargets(c);if(d.close){if(d.item.fireEvent("beforeclose",d.item)!==false){d.item.fireEvent("close",d.item);this.remove(d.item)}return}if(d.item&&d.item!=this.activeTab){this.setActiveTab(d.item)
}},onStripContextMenu:function(c){c.preventDefault();var d=this.findTargets(c);if(d.item){this.fireEvent("contextmenu",this,d.item,c)}},readTabs:function(m){if(m===true){this.items.each(function(a){this.remove(a)},this)}var n=this.el.query(this.autoTabSelector);for(var h=0,i=n.length;h<i;h++){var l=n[h],k=l.getAttribute("title");l.removeAttribute("title");this.add({title:k,contentEl:l})}},initTab:function(o,i){var n=this.strip.dom.childNodes[i],m=this.getTemplateArgs(o),p=n?this.itemTpl.insertBefore(n,m):this.itemTpl.append(this.strip,m),k="x-tab-strip-over",l=Ext.get(p);l.hover(function(){if(!o.disabled){l.addClass(k)}},function(){l.removeClass(k)});if(o.tabTip){l.child("span.x-tab-strip-text",true).qtip=o.tabTip}o.tabEl=p;l.select("a").on("click",function(a){if(!a.getPageX()){this.onStripMouseDown(a)}},this,{preventDefault:true});o.on({scope:this,disable:this.onItemDisabled,enable:this.onItemEnabled,titlechange:this.onItemTitleChanged,iconchange:this.onItemIconChanged,beforeshow:this.onBeforeShowItem})},getTemplateArgs:function(c){var d=c.closable?"x-tab-strip-closable":"";if(c.disabled){d+=" x-item-disabled"}if(c.iconCls){d+=" x-tab-with-icon"}if(c.tabCls){d+=" "+c.tabCls}return{id:this.id+this.idDelimiter+c.getItemId(),text:c.title,cls:d,iconCls:c.iconCls||""}},onAdd:function(c){Ext.TabPanel.superclass.onAdd.call(this,c);if(this.rendered){var d=this.items;this.initTab(c,d.indexOf(c));this.delegateUpdates()}},onBeforeAdd:function(d){var e=d.events?(this.items.containsKey(d.getItemId())?d:null):this.items.get(d);if(e){this.setActiveTab(d);return false}Ext.TabPanel.superclass.onBeforeAdd.apply(this,arguments);var g=d.elements;d.elements=g?g.replace(",header",""):g;d.border=(d.border===true)},onRemove:function(g){var c=Ext.get(g.tabEl);if(c){c.select("a").removeAllListeners();Ext.destroy(c)}Ext.TabPanel.superclass.onRemove.call(this,g);this.stack.remove(g);delete g.tabEl;g.un("disable",this.onItemDisabled,this);g.un("enable",this.onItemEnabled,this);g.un("titlechange",this.onItemTitleChanged,this);g.un("iconchange",this.onItemIconChanged,this);g.un("beforeshow",this.onBeforeShowItem,this);if(g==this.activeTab){var e=this.stack.next();if(e){this.setActiveTab(e)}else{if(this.items.getCount()>0){this.setActiveTab(0)}else{this.setActiveTab(null)}}}if(!this.destroying){this.delegateUpdates()}},onBeforeShowItem:function(b){if(b!=this.activeTab){this.setActiveTab(b);return false}},onItemDisabled:function(c){var d=this.getTabEl(c);if(d){Ext.fly(d).addClass("x-item-disabled")}this.stack.remove(c)},onItemEnabled:function(c){var d=this.getTabEl(c);if(d){Ext.fly(d).removeClass("x-item-disabled")}},onItemTitleChanged:function(c){var d=this.getTabEl(c);if(d){Ext.fly(d).child("span.x-tab-strip-text",true).innerHTML=c.title}},onItemIconChanged:function(h,g,i){var e=this.getTabEl(h);if(e){e=Ext.get(e);e.child("span.x-tab-strip-text").replaceClass(i,g);e[Ext.isEmpty(g)?"removeClass":"addClass"]("x-tab-with-icon")}},getTabEl:function(d){var c=this.getComponent(d);return c?c.tabEl:null},onResize:function(){Ext.TabPanel.superclass.onResize.apply(this,arguments);this.delegateUpdates()},beginUpdate:function(){this.suspendUpdates=true},endUpdate:function(){this.suspendUpdates=false;this.delegateUpdates()},hideTabStripItem:function(c){c=this.getComponent(c);var d=this.getTabEl(c);if(d){d.style.display="none";this.delegateUpdates()}this.stack.remove(c)},unhideTabStripItem:function(c){c=this.getComponent(c);var d=this.getTabEl(c);if(d){d.style.display="";this.delegateUpdates()}},delegateUpdates:function(){var b=this.rendered;if(this.suspendUpdates){return}if(this.resizeTabs&&b){this.autoSizeTabs()}if(this.enableTabScroll&&b){this.autoScrollTabs()}},autoSizeTabs:function(){var u=this.items.length,z=this.tabPosition!="bottom"?"header":"footer",y=this[z].dom.offsetWidth,A=this[z].dom.clientWidth;if(!this.resizeTabs||u<1||!A){return}var s=Math.max(Math.min(Math.floor((A-4)/u)-this.tabMargin,this.tabWidth),this.minTabWidth);this.lastTabWidth=s;var p=this.strip.query("li:not(.x-tab-edge)");
for(var w=0,t=p.length;w<t;w++){var q=p[w],i=Ext.fly(q).child(".x-tab-strip-inner",true),v=q.offsetWidth,x=i.offsetWidth;i.style.width=(s-(v-x))+"px"}},adjustBodyWidth:function(b){if(this.header){this.header.setWidth(b)}if(this.footer){this.footer.setWidth(b)}return b},setActiveTab:function(g){g=this.getComponent(g);if(this.fireEvent("beforetabchange",this,g,this.activeTab)===false){return}if(!this.rendered){this.activeTab=g;return}if(this.activeTab!=g){if(this.activeTab){var e=this.getTabEl(this.activeTab);if(e){Ext.fly(e).removeClass("x-tab-strip-active")}}this.activeTab=g;if(g){var d=this.getTabEl(g);Ext.fly(d).addClass("x-tab-strip-active");this.stack.add(g);this.layout.setActiveItem(g);this.delegateUpdates();if(this.scrolling){this.scrollToTab(g,this.animScroll)}}this.fireEvent("tabchange",this,g)}},getActiveTab:function(){return this.activeTab||null},getItem:function(b){return this.getComponent(b)},autoScrollTabs:function(){this.pos=this.tabPosition=="bottom"?this.footer:this.header;var n=this.items.length,q=this.pos.dom.offsetWidth,s=this.pos.dom.clientWidth,o=this.stripWrap,p=o.dom,k=p.offsetWidth,m=this.getScrollPos(),l=this.edge.getOffsetsTo(this.stripWrap)[0]+m;if(!this.enableTabScroll||k<20){return}if(n==0||l<=s){p.scrollLeft=0;o.setWidth(s);if(this.scrolling){this.scrolling=false;this.pos.removeClass("x-tab-scrolling");this.scrollLeft.hide();this.scrollRight.hide();if(Ext.isAir||Ext.isWebKit){p.style.marginLeft="";p.style.marginRight=""}}}else{if(!this.scrolling){this.pos.addClass("x-tab-scrolling");if(Ext.isAir||Ext.isWebKit){p.style.marginLeft="18px";p.style.marginRight="18px"}}s-=o.getMargins("lr");o.setWidth(s>20?s:20);if(!this.scrolling){if(!this.scrollLeft){this.createScrollers()}else{this.scrollLeft.show();this.scrollRight.show()}}this.scrolling=true;if(m>(l-s)){p.scrollLeft=l-s}else{this.scrollToTab(this.activeTab,false)}this.updateScrollButtons()}},createScrollers:function(){this.pos.addClass("x-tab-scrolling-"+this.tabPosition);var g=this.stripWrap.dom.offsetHeight;var e=this.pos.insertFirst({cls:"x-tab-scroller-left"});e.setHeight(g);e.addClassOnOver("x-tab-scroller-left-over");this.leftRepeater=new Ext.util.ClickRepeater(e,{interval:this.scrollRepeatInterval,handler:this.onScrollLeft,scope:this});this.scrollLeft=e;var d=this.pos.insertFirst({cls:"x-tab-scroller-right"});d.setHeight(g);d.addClassOnOver("x-tab-scroller-right-over");this.rightRepeater=new Ext.util.ClickRepeater(d,{interval:this.scrollRepeatInterval,handler:this.onScrollRight,scope:this});this.scrollRight=d},getScrollWidth:function(){return this.edge.getOffsetsTo(this.stripWrap)[0]+this.getScrollPos()},getScrollPos:function(){return parseInt(this.stripWrap.dom.scrollLeft,10)||0},getScrollArea:function(){return parseInt(this.stripWrap.dom.clientWidth,10)||0},getScrollAnim:function(){return{duration:this.scrollDuration,callback:this.updateScrollButtons,scope:this}},getScrollIncrement:function(){return this.scrollIncrement||(this.resizeTabs?this.lastTabWidth+2:100)},scrollToTab:function(n,k){if(!n){return}var p=this.getTabEl(n),l=this.getScrollPos(),o=this.getScrollArea(),m=Ext.fly(p).getOffsetsTo(this.stripWrap)[0]+l,i=m+p.offsetWidth;if(m<l){this.scrollTo(m,k)}else{if(i>(l+o)){this.scrollTo(i-o,k)}}},scrollTo:function(c,d){this.stripWrap.scrollTo("left",c,d?this.getScrollAnim():false);if(!d){this.updateScrollButtons()}},onWheel:function(m){var l=m.getWheelDelta()*this.wheelIncrement*-1;m.stopEvent();var k=this.getScrollPos(),n=k+l,e=this.getScrollWidth()-this.getScrollArea();var d=Math.max(0,Math.min(e,n));if(d!=k){this.scrollTo(d,false)}},onScrollRight:function(){var e=this.getScrollWidth()-this.getScrollArea(),g=this.getScrollPos(),d=Math.min(e,g+this.getScrollIncrement());if(d!=g){this.scrollTo(d,this.animScroll)}},onScrollLeft:function(){var c=this.getScrollPos(),d=Math.max(0,c-this.getScrollIncrement());if(d!=c){this.scrollTo(d,this.animScroll)}},updateScrollButtons:function(){var b=this.getScrollPos();this.scrollLeft[b===0?"addClass":"removeClass"]("x-tab-scroller-left-disabled");
this.scrollRight[b>=(this.getScrollWidth()-this.getScrollArea())?"addClass":"removeClass"]("x-tab-scroller-right-disabled")},beforeDestroy:function(){Ext.destroy(this.leftRepeater,this.rightRepeater);this.deleteMembers("strip","edge","scrollLeft","scrollRight","stripWrap");this.activeTab=null;Ext.TabPanel.superclass.beforeDestroy.apply(this)}});Ext.reg("tabpanel",Ext.TabPanel);Ext.TabPanel.prototype.activate=Ext.TabPanel.prototype.setActiveTab;Ext.TabPanel.AccessStack=function(){var b=[];return{add:function(a){b.push(a);if(b.length>10){b.shift()}},remove:function(g){var h=[];for(var i=0,a=b.length;i<a;i++){if(b[i]!=g){h.push(b[i])}}b=h},next:function(){return b.pop()}}};Ext.Button=Ext.extend(Ext.BoxComponent,{hidden:false,disabled:false,pressed:false,enableToggle:false,menuAlign:"tl-bl?",type:"button",menuClassTarget:"tr:nth(2)",clickEvent:"click",handleMouseEvents:true,tooltipType:"qtip",buttonSelector:"button:first-child",scale:"small",iconAlign:"left",arrowAlign:"right",initComponent:function(){Ext.Button.superclass.initComponent.call(this);this.addEvents("click","toggle","mouseover","mouseout","menushow","menuhide","menutriggerover","menutriggerout");if(this.menu){this.menu=Ext.menu.MenuMgr.get(this.menu)}if(Ext.isString(this.toggleGroup)){this.enableToggle=true}},getTemplateArgs:function(){return[this.type,"x-btn-"+this.scale+" x-btn-icon-"+this.scale+"-"+this.iconAlign,this.getMenuClass(),this.cls,this.id]},setButtonClass:function(){if(this.useSetClass){if(!Ext.isEmpty(this.oldCls)){this.el.removeClass([this.oldCls,"x-btn-pressed"])}this.oldCls=(this.iconCls||this.icon)?(this.text?"x-btn-text-icon":"x-btn-icon"):"x-btn-noicon";this.el.addClass([this.oldCls,this.pressed?"x-btn-pressed":null])}},getMenuClass:function(){return this.menu?(this.arrowAlign!="bottom"?"x-btn-arrow":"x-btn-arrow-bottom"):""},onRender:function(i,g){if(!this.template){if(!Ext.Button.buttonTemplate){Ext.Button.buttonTemplate=new Ext.Template('<table id="{4}" cellspacing="0" class="x-btn {3}"><tbody class="{1}">','<tr><td class="x-btn-tl"><i>&#160;</i></td><td class="x-btn-tc"></td><td class="x-btn-tr"><i>&#160;</i></td></tr>','<tr><td class="x-btn-ml"><i>&#160;</i></td><td class="x-btn-mc"><em class="{2}" unselectable="on"><button type="{0}"></button></em></td><td class="x-btn-mr"><i>&#160;</i></td></tr>','<tr><td class="x-btn-bl"><i>&#160;</i></td><td class="x-btn-bc"></td><td class="x-btn-br"><i>&#160;</i></td></tr>',"</tbody></table>");Ext.Button.buttonTemplate.compile()}this.template=Ext.Button.buttonTemplate}var e,h=this.getTemplateArgs();if(g){e=this.template.insertBefore(g,h,true)}else{e=this.template.append(i,h,true)}this.btnEl=e.child(this.buttonSelector);this.mon(this.btnEl,{scope:this,focus:this.onFocus,blur:this.onBlur});this.initButtonEl(e,this.btnEl);Ext.ButtonToggleMgr.register(this)},initButtonEl:function(d,g){this.el=d;this.setIcon(this.icon);this.setText(this.text);this.setIconClass(this.iconCls);if(Ext.isDefined(this.tabIndex)){g.dom.tabIndex=this.tabIndex}if(this.tooltip){this.setTooltip(this.tooltip,true)}if(this.handleMouseEvents){this.mon(d,{scope:this,mouseover:this.onMouseOver,mousedown:this.onMouseDown})}if(this.menu){this.mon(this.menu,{scope:this,show:this.onMenuShow,hide:this.onMenuHide})}if(this.repeat){var e=new Ext.util.ClickRepeater(d,Ext.isObject(this.repeat)?this.repeat:{});this.mon(e,"click",this.onRepeatClick,this)}else{this.mon(d,this.clickEvent,this.onClick,this)}},afterRender:function(){Ext.Button.superclass.afterRender.call(this);this.useSetClass=true;this.setButtonClass();this.doc=Ext.getDoc();this.doAutoWidth()},setIconClass:function(b){this.iconCls=b;if(this.el){this.btnEl.dom.className="";this.btnEl.addClass(["x-btn-text",b||""]);this.setButtonClass()}return this},setTooltip:function(c,d){if(this.rendered){if(!d){this.clearTip()}if(Ext.isObject(c)){Ext.QuickTips.register(Ext.apply({target:this.btnEl.id},c));this.tooltip=c}else{this.btnEl.dom[this.tooltipType]=c}}else{this.tooltip=c}return this},clearTip:function(){if(Ext.isObject(this.tooltip)){Ext.QuickTips.unregister(this.btnEl)
}},beforeDestroy:function(){if(this.rendered){this.clearTip()}if(this.menu&&this.destroyMenu!==false){Ext.destroy(this.btnEl,this.menu)}Ext.destroy(this.repeater)},onDestroy:function(){if(this.rendered){this.doc.un("mouseover",this.monitorMouseOver,this);this.doc.un("mouseup",this.onMouseUp,this);delete this.doc;delete this.btnEl;Ext.ButtonToggleMgr.unregister(this)}Ext.Button.superclass.onDestroy.call(this)},doAutoWidth:function(){if(this.autoWidth!==false&&this.el&&this.text&&this.width===undefined){this.el.setWidth("auto");if(Ext.isIE7&&Ext.isStrict){var b=this.btnEl;if(b&&b.getWidth()>20){b.clip();b.setWidth(Ext.util.TextMetrics.measure(b,this.text).width+b.getFrameWidth("lr"))}}if(this.minWidth){if(this.el.getWidth()<this.minWidth){this.el.setWidth(this.minWidth)}}}},setHandler:function(c,d){this.handler=c;this.scope=d;return this},setText:function(b){this.text=b;if(this.el){this.btnEl.update(b||"&#160;");this.setButtonClass()}this.doAutoWidth();return this},setIcon:function(b){this.icon=b;if(this.el){this.btnEl.setStyle("background-image",b?"url("+b+")":"");this.setButtonClass()}return this},getText:function(){return this.text},toggle:function(c,d){c=c===undefined?!this.pressed:!!c;if(c!=this.pressed){if(this.rendered){this.el[c?"addClass":"removeClass"]("x-btn-pressed")}this.pressed=c;if(!d){this.fireEvent("toggle",this,c);if(this.toggleHandler){this.toggleHandler.call(this.scope||this,this,c)}}}return this},onDisable:function(){this.onDisableChange(true)},onEnable:function(){this.onDisableChange(false)},onDisableChange:function(b){if(this.el){if(!Ext.isIE6||!this.text){this.el[b?"addClass":"removeClass"](this.disabledClass)}this.el.dom.disabled=b}this.disabled=b},showMenu:function(){if(this.rendered&&this.menu){if(this.tooltip){Ext.QuickTips.getQuickTip().cancelShow(this.btnEl)}if(this.menu.isVisible()){this.menu.hide()}this.menu.ownerCt=this;this.menu.show(this.el,this.menuAlign)}return this},hideMenu:function(){if(this.hasVisibleMenu()){this.menu.hide()}return this},hasVisibleMenu:function(){return this.menu&&this.menu.ownerCt==this&&this.menu.isVisible()},onRepeatClick:function(d,c){this.onClick(c)},onClick:function(b){if(b){b.preventDefault()}if(b.button!==0){return}if(!this.disabled){this.doToggle();if(this.menu&&!this.hasVisibleMenu()&&!this.ignoreNextClick){this.showMenu()}this.fireEvent("click",this,b);if(this.handler){this.handler.call(this.scope||this,this,b)}}},doToggle:function(){if(this.enableToggle&&(this.allowDepress!==false||!this.pressed)){this.toggle()}},isMenuTriggerOver:function(c,d){return this.menu&&!d},isMenuTriggerOut:function(c,d){return this.menu&&!d},onMouseOver:function(c){if(!this.disabled){var d=c.within(this.el,true);if(!d){this.el.addClass("x-btn-over");if(!this.monitoringMouseOver){this.doc.on("mouseover",this.monitorMouseOver,this);this.monitoringMouseOver=true}this.fireEvent("mouseover",this,c)}if(this.isMenuTriggerOver(c,d)){this.fireEvent("menutriggerover",this,this.menu,c)}}},monitorMouseOver:function(b){if(b.target!=this.el.dom&&!b.within(this.el)){if(this.monitoringMouseOver){this.doc.un("mouseover",this.monitorMouseOver,this);this.monitoringMouseOver=false}this.onMouseOut(b)}},onMouseOut:function(c){var d=c.within(this.el)&&c.target!=this.el.dom;this.el.removeClass("x-btn-over");this.fireEvent("mouseout",this,c);if(this.isMenuTriggerOut(c,d)){this.fireEvent("menutriggerout",this,this.menu,c)}},focus:function(){this.btnEl.focus()},blur:function(){this.btnEl.blur()},onFocus:function(b){if(!this.disabled){this.el.addClass("x-btn-focus")}},onBlur:function(b){this.el.removeClass("x-btn-focus")},getClickEl:function(c,d){return this.el},onMouseDown:function(b){if(!this.disabled&&b.button===0){this.getClickEl(b).addClass("x-btn-click");this.doc.on("mouseup",this.onMouseUp,this)}},onMouseUp:function(b){if(b.button===0){this.getClickEl(b,true).removeClass("x-btn-click");this.doc.un("mouseup",this.onMouseUp,this)}},onMenuShow:function(b){if(this.menu.ownerCt==this){this.menu.ownerCt=this;this.ignoreNextClick=0;
this.el.addClass("x-btn-menu-active");this.fireEvent("menushow",this,this.menu)}},onMenuHide:function(b){if(this.menu.ownerCt==this){this.el.removeClass("x-btn-menu-active");this.ignoreNextClick=this.restoreClick.defer(250,this);this.fireEvent("menuhide",this,this.menu);delete this.menu.ownerCt}},restoreClick:function(){this.ignoreNextClick=0}});Ext.reg("button",Ext.Button);Ext.ButtonToggleMgr=function(){var d={};function c(g,a){if(a){var b=d[g.toggleGroup];for(var i=0,l=b.length;i<l;i++){if(b[i]!=g){b[i].toggle(false)}}}}return{register:function(b){if(!b.toggleGroup){return}var a=d[b.toggleGroup];if(!a){a=d[b.toggleGroup]=[]}a.push(b);b.on("toggle",c)},unregister:function(b){if(!b.toggleGroup){return}var a=d[b.toggleGroup];if(a){a.remove(b);b.un("toggle",c)}},getPressed:function(a){var b=d[a];if(b){for(var g=0,i=b.length;g<i;g++){if(b[g].pressed===true){return b[g]}}}return null}}}();Ext.SplitButton=Ext.extend(Ext.Button,{arrowSelector:"em",split:true,initComponent:function(){Ext.SplitButton.superclass.initComponent.call(this);this.addEvents("arrowclick")},onRender:function(){Ext.SplitButton.superclass.onRender.apply(this,arguments);if(this.arrowTooltip){this.el.child(this.arrowSelector).dom[this.tooltipType]=this.arrowTooltip}},setArrowHandler:function(c,d){this.arrowHandler=c;this.scope=d},getMenuClass:function(){return"x-btn-split"+(this.arrowAlign=="bottom"?"-bottom":"")},isClickOnArrow:function(g){if(this.arrowAlign!="bottom"){var d=this.el.child("em.x-btn-split");var e=d.getRegion().right-d.getPadding("r");return g.getPageX()>e}else{return g.getPageY()>this.btnEl.getRegion().bottom}},onClick:function(c,d){c.preventDefault();if(!this.disabled){if(this.isClickOnArrow(c)){if(this.menu&&!this.menu.isVisible()&&!this.ignoreNextClick){this.showMenu()}this.fireEvent("arrowclick",this,c);if(this.arrowHandler){this.arrowHandler.call(this.scope||this,this,c)}}else{this.doToggle();this.fireEvent("click",this,c);if(this.handler){this.handler.call(this.scope||this,this,c)}}}},isMenuTriggerOver:function(b){return this.menu&&b.target.tagName==this.arrowSelector},isMenuTriggerOut:function(c,d){return this.menu&&c.target.tagName!=this.arrowSelector}});Ext.reg("splitbutton",Ext.SplitButton);Ext.CycleButton=Ext.extend(Ext.SplitButton,{getItemText:function(d){if(d&&this.showText===true){var c="";if(this.prependText){c+=this.prependText}c+=d.text;return c}return undefined},setActiveItem:function(g,e){if(!Ext.isObject(g)){g=this.menu.getComponent(g)}if(g){if(!this.rendered){this.text=this.getItemText(g);this.iconCls=g.iconCls}else{var d=this.getItemText(g);if(d){this.setText(d)}this.setIconClass(g.iconCls)}this.activeItem=g;if(!g.checked){g.setChecked(true,false)}if(this.forceIcon){this.setIconClass(this.forceIcon)}if(!e){this.fireEvent("change",this,g)}}},getActiveItem:function(){return this.activeItem},initComponent:function(){this.addEvents("change");if(this.changeHandler){this.on("change",this.changeHandler,this.scope||this);delete this.changeHandler}this.itemCount=this.items.length;this.menu={cls:"x-cycle-menu",items:[]};var b=0;Ext.each(this.items,function(d,a){Ext.apply(d,{group:d.group||this.id,itemIndex:a,checkHandler:this.checkHandler,scope:this,checked:d.checked||false});this.menu.items.push(d);if(d.checked){b=a}},this);Ext.CycleButton.superclass.initComponent.call(this);this.on("click",this.toggleSelected,this);this.setActiveItem(b,true)},checkHandler:function(d,c){if(c){this.setActiveItem(d)}},toggleSelected:function(){var g=this.menu;g.render();if(!g.hasLayout){g.doLayout()}var h,e;for(var i=1;i<this.itemCount;i++){h=(this.activeItem.itemIndex+i)%this.itemCount;e=g.items.itemAt(h);if(!e.disabled){e.setChecked(true);break}}}});Ext.reg("cycle",Ext.CycleButton);Ext.Toolbar=function(b){if(Ext.isArray(b)){b={items:b,layout:"toolbar"}}else{b=Ext.apply({layout:"toolbar"},b);if(b.buttons){b.items=b.buttons}}Ext.Toolbar.superclass.constructor.call(this,b)};(function(){var b=Ext.Toolbar;Ext.extend(b,Ext.Container,{defaultType:"button",enableOverflow:false,trackMenus:true,internalDefaults:{removeMode:"container",hideParent:true},toolbarCls:"x-toolbar",initComponent:function(){b.superclass.initComponent.call(this);
this.addEvents("overflowchange")},onRender:function(d,a){if(!this.el){if(!this.autoCreate){this.autoCreate={cls:this.toolbarCls+" x-small-editor"}}this.el=d.createChild(Ext.apply({id:this.id},this.autoCreate),a);Ext.Toolbar.superclass.onRender.apply(this,arguments)}},lookupComponent:function(a){if(Ext.isString(a)){if(a=="-"){a=new b.Separator()}else{if(a==" "){a=new b.Spacer()}else{if(a=="->"){a=new b.Fill()}else{a=new b.TextItem(a)}}}this.applyDefaults(a)}else{if(a.isFormField||a.render){a=this.createComponent(a)}else{if(a.tag){a=new b.Item({autoEl:a})}else{if(a.tagName){a=new b.Item({el:a})}else{if(Ext.isObject(a)){a=a.xtype?this.createComponent(a):this.constructButton(a)}}}}}return a},applyDefaults:function(c){if(!Ext.isString(c)){c=Ext.Toolbar.superclass.applyDefaults.call(this,c);var a=this.internalDefaults;if(c.events){Ext.applyIf(c.initialConfig,a);Ext.apply(c,a)}else{Ext.applyIf(c,a)}}return c},addSeparator:function(){return this.add(new b.Separator())},addSpacer:function(){return this.add(new b.Spacer())},addFill:function(){this.add(new b.Fill())},addElement:function(a){return this.addItem(new b.Item({el:a}))},addItem:function(a){return this.add.apply(this,arguments)},addButton:function(i){if(Ext.isArray(i)){var g=[];for(var h=0,a=i.length;h<a;h++){g.push(this.addButton(i[h]))}return g}return this.add(this.constructButton(i))},addText:function(a){return this.addItem(new b.TextItem(a))},addDom:function(a){return this.add(new b.Item({autoEl:a}))},addField:function(a){return this.add(a)},insertButton:function(l,h){if(Ext.isArray(h)){var i=[];for(var k=0,a=h.length;k<a;k++){i.push(this.insertButton(l+k,h[k]))}return i}return Ext.Toolbar.superclass.insert.call(this,l,h)},trackMenu:function(g,a){if(this.trackMenus&&g.menu){var e=a?"mun":"mon";this[e](g,"menutriggerover",this.onButtonTriggerOver,this);this[e](g,"menushow",this.onButtonMenuShow,this);this[e](g,"menuhide",this.onButtonMenuHide,this)}},constructButton:function(a){var e=a.events?a:this.createComponent(a,a.split?"splitbutton":this.defaultType);return e},onAdd:function(a){Ext.Toolbar.superclass.onAdd.call(this);this.trackMenu(a);if(this.disabled){a.disable()}},onRemove:function(a){Ext.Toolbar.superclass.onRemove.call(this);if(a==this.activeMenuBtn){delete this.activeMenuBtn}this.trackMenu(a,true)},onDisable:function(){this.items.each(function(a){if(a.disable){a.disable()}})},onEnable:function(){this.items.each(function(a){if(a.enable){a.enable()}})},onButtonTriggerOver:function(a){if(this.activeMenuBtn&&this.activeMenuBtn!=a){this.activeMenuBtn.hideMenu();a.showMenu();this.activeMenuBtn=a}},onButtonMenuShow:function(a){this.activeMenuBtn=a},onButtonMenuHide:function(a){delete this.activeMenuBtn}});Ext.reg("toolbar",Ext.Toolbar);b.Item=Ext.extend(Ext.BoxComponent,{hideParent:true,enable:Ext.emptyFn,disable:Ext.emptyFn,focus:Ext.emptyFn});Ext.reg("tbitem",b.Item);b.Separator=Ext.extend(b.Item,{onRender:function(d,a){this.el=d.createChild({tag:"span",cls:"xtb-sep"},a)}});Ext.reg("tbseparator",b.Separator);b.Spacer=Ext.extend(b.Item,{onRender:function(d,a){this.el=d.createChild({tag:"div",cls:"xtb-spacer",style:this.width?"width:"+this.width+"px":""},a)}});Ext.reg("tbspacer",b.Spacer);b.Fill=Ext.extend(b.Item,{render:Ext.emptyFn,isFill:true});Ext.reg("tbfill",b.Fill);b.TextItem=Ext.extend(b.Item,{constructor:function(a){b.TextItem.superclass.constructor.call(this,Ext.isString(a)?{text:a}:a)},onRender:function(d,a){this.autoEl={cls:"xtb-text",html:this.text||""};b.TextItem.superclass.onRender.call(this,d,a)},setText:function(a){if(this.rendered){this.el.update(a)}else{this.text=a}}});Ext.reg("tbtext",b.TextItem);b.Button=Ext.extend(Ext.Button,{});b.SplitButton=Ext.extend(Ext.SplitButton,{});Ext.reg("tbbutton",b.Button);Ext.reg("tbsplit",b.SplitButton)})();Ext.ButtonGroup=Ext.extend(Ext.Panel,{baseCls:"x-btn-group",layout:"table",defaultType:"button",frame:true,internalDefaults:{removeMode:"container",hideParent:true},initComponent:function(){this.layoutConfig=this.layoutConfig||{};
Ext.applyIf(this.layoutConfig,{columns:this.columns});if(!this.title){this.addClass("x-btn-group-notitle")}this.on("afterlayout",this.onAfterLayout,this);Ext.ButtonGroup.superclass.initComponent.call(this)},applyDefaults:function(c){c=Ext.ButtonGroup.superclass.applyDefaults.call(this,c);var d=this.internalDefaults;if(c.events){Ext.applyIf(c.initialConfig,d);Ext.apply(c,d)}else{Ext.applyIf(c,d)}return c},onAfterLayout:function(){var b=this.body.getFrameWidth("lr")+this.body.dom.firstChild.offsetWidth;this.body.setWidth(b);this.el.setWidth(b+this.getFrameWidth())}});Ext.reg("buttongroup",Ext.ButtonGroup);(function(){var b=Ext.Toolbar;Ext.PagingToolbar=Ext.extend(Ext.Toolbar,{pageSize:20,displayMsg:"Displaying {0} - {1} of {2}",emptyMsg:"No data to display",beforePageText:"Page",afterPageText:"of {0}",firstText:"First Page",prevText:"Previous Page",nextText:"Next Page",lastText:"Last Page",refreshText:"Refresh",initComponent:function(){var d=[this.first=new b.Button({tooltip:this.firstText,overflowText:this.firstText,iconCls:"x-tbar-page-first",disabled:true,handler:this.moveFirst,scope:this}),this.prev=new b.Button({tooltip:this.prevText,overflowText:this.prevText,iconCls:"x-tbar-page-prev",disabled:true,handler:this.movePrevious,scope:this}),"-",this.beforePageText,this.inputItem=new Ext.form.NumberField({cls:"x-tbar-page-number",allowDecimals:false,allowNegative:false,enableKeyEvents:true,selectOnFocus:true,submitValue:false,listeners:{scope:this,keydown:this.onPagingKeyDown,blur:this.onPagingBlur}}),this.afterTextItem=new b.TextItem({text:String.format(this.afterPageText,1)}),"-",this.next=new b.Button({tooltip:this.nextText,overflowText:this.nextText,iconCls:"x-tbar-page-next",disabled:true,handler:this.moveNext,scope:this}),this.last=new b.Button({tooltip:this.lastText,overflowText:this.lastText,iconCls:"x-tbar-page-last",disabled:true,handler:this.moveLast,scope:this}),"-",this.refresh=new b.Button({tooltip:this.refreshText,overflowText:this.refreshText,iconCls:"x-tbar-loading",handler:this.doRefresh,scope:this})];var a=this.items||this.buttons||[];if(this.prependButtons){this.items=a.concat(d)}else{this.items=d.concat(a)}delete this.buttons;if(this.displayInfo){this.items.push("->");this.items.push(this.displayItem=new b.TextItem({}))}Ext.PagingToolbar.superclass.initComponent.call(this);this.addEvents("change","beforechange");this.on("afterlayout",this.onFirstLayout,this,{single:true});this.cursor=0;this.bindStore(this.store,true)},onFirstLayout:function(){if(this.dsLoaded){this.onLoad.apply(this,this.dsLoaded)}},updateInfo:function(){if(this.displayItem){var a=this.store.getCount();var d=a==0?this.emptyMsg:String.format(this.displayMsg,this.cursor+1,this.cursor+a,this.store.getTotalCount());this.displayItem.setText(d)}},onLoad:function(a,o,d){if(!this.rendered){this.dsLoaded=[a,o,d];return}var n=this.getParams();this.cursor=(d.params&&d.params[n.start])?d.params[n.start]:0;var l=this.getPageData(),p=l.activePage,m=l.pages;this.afterTextItem.setText(String.format(this.afterPageText,l.pages));this.inputItem.setValue(p);this.first.setDisabled(p==1);this.prev.setDisabled(p==1);this.next.setDisabled(p==m);this.last.setDisabled(p==m);this.refresh.enable();this.updateInfo();this.fireEvent("change",this,l)},getPageData:function(){var a=this.store.getTotalCount();return{total:a,activePage:Math.ceil((this.cursor+this.pageSize)/this.pageSize),pages:a<this.pageSize?1:Math.ceil(a/this.pageSize)}},changePage:function(a){this.doLoad(((a-1)*this.pageSize).constrain(0,this.store.getTotalCount()))},onLoadError:function(){if(!this.rendered){return}this.refresh.enable()},readPage:function(d){var a=this.inputItem.getValue(),g;if(!a||isNaN(g=parseInt(a,10))){this.inputItem.setValue(d.activePage);return false}return g},onPagingFocus:function(){this.inputItem.select()},onPagingBlur:function(a){this.inputItem.setValue(this.getPageData().activePage)},onPagingKeyDown:function(e,k){var n=k.getKey(),d=this.getPageData(),m;if(n==k.RETURN){k.stopEvent();
m=this.readPage(d);if(m!==false){m=Math.min(Math.max(1,m),d.pages)-1;this.doLoad(m*this.pageSize)}}else{if(n==k.HOME||n==k.END){k.stopEvent();m=n==k.HOME?1:d.pages;e.setValue(m)}else{if(n==k.UP||n==k.PAGEUP||n==k.DOWN||n==k.PAGEDOWN){k.stopEvent();if((m=this.readPage(d))){var a=k.shiftKey?10:1;if(n==k.DOWN||n==k.PAGEDOWN){a*=-1}m+=a;if(m>=1&m<=d.pages){e.setValue(m)}}}}}},getParams:function(){return this.paramNames||this.store.paramNames},beforeLoad:function(){if(this.rendered&&this.refresh){this.refresh.disable()}},doLoad:function(e){var g={},a=this.getParams();g[a.start]=e;g[a.limit]=this.pageSize;if(this.fireEvent("beforechange",this,g)!==false){this.store.load({params:g})}},moveFirst:function(){this.doLoad(0)},movePrevious:function(){this.doLoad(Math.max(0,this.cursor-this.pageSize))},moveNext:function(){this.doLoad(this.cursor+this.pageSize)},moveLast:function(){var d=this.store.getTotalCount(),a=d%this.pageSize;this.doLoad(a?(d-a):d-this.pageSize)},doRefresh:function(){this.doLoad(this.cursor)},bindStore:function(g,e){var a;if(!e&&this.store){if(g!==this.store&&this.store.autoDestroy){this.store.destroy()}else{this.store.un("beforeload",this.beforeLoad,this);this.store.un("load",this.onLoad,this);this.store.un("exception",this.onLoadError,this)}if(!g){this.store=null}}if(g){g=Ext.StoreMgr.lookup(g);g.on({scope:this,beforeload:this.beforeLoad,load:this.onLoad,exception:this.onLoadError});a=true}this.store=g;if(a){this.onLoad(g,null,{})}},unbind:function(a){this.bindStore(null)},bind:function(a){this.bindStore(a)},onDestroy:function(){this.bindStore(null);Ext.PagingToolbar.superclass.onDestroy.call(this)}})})();Ext.reg("paging",Ext.PagingToolbar);Ext.History=(function(){var s,u;var m=false;var t;function q(){var a=location.href,b=a.indexOf("#");return b>=0?a.substr(b+1):null}function w(){u.value=t}function p(a){t=a;Ext.History.fireEvent("change",a)}function o(d){var a=['<html><body><div id="state">',Ext.util.Format.htmlEncode(d),"</div></body></html>"].join("");try{var b=s.contentWindow.document;b.open();b.write(a);b.close();return true}catch(c){return false}}function v(){if(!s.contentWindow||!s.contentWindow.document){setTimeout(v,10);return}var b=s.contentWindow.document;var d=b.getElementById("state");var a=d?d.innerText:null;var c=q();setInterval(function(){b=s.contentWindow.document;d=b.getElementById("state");var e=d?d.innerText:null;var g=q();if(e!==a){a=e;p(a);top.location.hash=a;c=a;w()}else{if(g!==c){c=g;o(g)}}},50);m=true;Ext.History.fireEvent("ready",Ext.History)}function n(){t=u.value?u.value:q();if(Ext.isIE){v()}else{var a=q();setInterval(function(){var b=q();if(b!==a){a=b;p(a);w()}},50);m=true;Ext.History.fireEvent("ready",Ext.History)}}return{fieldId:"x-history-field",iframeId:"x-history-frame",events:{},init:function(b,a){if(m){Ext.callback(b,a,[this]);return}if(!Ext.isReady){Ext.onReady(function(){Ext.History.init(b,a)});return}u=Ext.getDom(Ext.History.fieldId);if(Ext.isIE){s=Ext.getDom(Ext.History.iframeId)}this.addEvents("ready","change");if(b){this.on("ready",b,a,{single:true})}n()},add:function(a,b){if(b!==false){if(this.getToken()==a){return true}}if(Ext.isIE){return o(a)}else{top.location.hash=a;return true}},back:function(){history.go(-1)},forward:function(){history.go(1)},getToken:function(){return m?t:q()}}})();Ext.apply(Ext.History,new Ext.util.Observable());Ext.Tip=Ext.extend(Ext.Panel,{minWidth:40,maxWidth:300,shadow:"sides",defaultAlign:"tl-bl?",autoRender:true,quickShowInterval:250,frame:true,hidden:true,baseCls:"x-tip",floating:{shadow:true,shim:true,useDisplay:true,constrain:false},autoHeight:true,closeAction:"hide",initComponent:function(){Ext.Tip.superclass.initComponent.call(this);if(this.closable&&!this.title){this.elements+=",header"}},afterRender:function(){Ext.Tip.superclass.afterRender.call(this);if(this.closable){this.addTool({id:"close",handler:this[this.closeAction],scope:this})}},showAt:function(b){Ext.Tip.superclass.show.call(this);if(this.measureWidth!==false&&(!this.initialConfig||typeof this.initialConfig.width!="number")){this.doAutoWidth()
}if(this.constrainPosition){b=this.el.adjustForConstraints(b)}this.setPagePosition(b[0],b[1])},doAutoWidth:function(d){d=d||0;var c=this.body.getTextWidth();if(this.title){c=Math.max(c,this.header.child("span").getTextWidth(this.title))}c+=this.getFrameWidth()+(this.closable?20:0)+this.body.getPadding("lr")+d;this.setWidth(c.constrain(this.minWidth,this.maxWidth));if(Ext.isIE7&&!this.repainted){this.el.repaint();this.repainted=true}},showBy:function(d,c){if(!this.rendered){this.render(Ext.getBody())}this.showAt(this.el.getAlignToXY(d,c||this.defaultAlign))},initDraggable:function(){this.dd=new Ext.Tip.DD(this,typeof this.draggable=="boolean"?null:this.draggable);this.header.addClass("x-tip-draggable")}});Ext.reg("tip",Ext.Tip);Ext.Tip.DD=function(c,d){Ext.apply(this,d);this.tip=c;Ext.Tip.DD.superclass.constructor.call(this,c.el.id,"WindowDD-"+c.id);this.setHandleElId(c.header.id);this.scroll=false};Ext.extend(Ext.Tip.DD,Ext.dd.DD,{moveOnly:true,scroll:false,headerOffsets:[100,25],startDrag:function(){this.tip.el.disableShadow()},endDrag:function(b){this.tip.el.enableShadow(true)}});Ext.ToolTip=Ext.extend(Ext.Tip,{showDelay:500,hideDelay:200,dismissDelay:5000,trackMouse:false,anchorToTarget:true,anchorOffset:0,targetCounter:0,constrainPosition:false,initComponent:function(){Ext.ToolTip.superclass.initComponent.call(this);this.lastActive=new Date();this.initTarget(this.target);this.origAnchor=this.anchor},onRender:function(c,d){Ext.ToolTip.superclass.onRender.call(this,c,d);this.anchorCls="x-tip-anchor-"+this.getAnchorPosition();this.anchorEl=this.el.createChild({cls:"x-tip-anchor "+this.anchorCls})},afterRender:function(){Ext.ToolTip.superclass.afterRender.call(this);this.anchorEl.setStyle("z-index",this.el.getZIndex()+1).setVisibilityMode(Ext.Element.DISPLAY)},initTarget:function(g){var e;if((e=Ext.get(g))){if(this.target){var d=Ext.get(this.target);this.mun(d,"mouseover",this.onTargetOver,this);this.mun(d,"mouseout",this.onTargetOut,this);this.mun(d,"mousemove",this.onMouseMove,this)}this.mon(e,{mouseover:this.onTargetOver,mouseout:this.onTargetOut,mousemove:this.onMouseMove,scope:this});this.target=e}if(this.anchor){this.anchorTarget=this.target}},onMouseMove:function(c){var d=this.delegate?c.getTarget(this.delegate):this.triggerElement=true;if(d){this.targetXY=c.getXY();if(d===this.triggerElement){if(!this.hidden&&this.trackMouse){this.setPagePosition(this.getTargetXY())}}else{this.hide();this.lastActive=new Date(0);this.onTargetOver(c)}}else{if(!this.closable&&this.isVisible()){this.hide()}}},getTargetXY:function(){if(this.delegate){this.anchorTarget=this.triggerElement}if(this.anchor){this.targetCounter++;var w=this.getOffsets(),n=(this.anchorToTarget&&!this.trackMouse)?this.el.getAlignToXY(this.anchorTarget,this.getAnchorAlign()):this.targetXY,y=Ext.lib.Dom.getViewWidth()-5,s=Ext.lib.Dom.getViewHeight()-5,q=document.documentElement,u=document.body,o=(q.scrollLeft||u.scrollLeft||0)+5,p=(q.scrollTop||u.scrollTop||0)+5,x=[n[0]+w[0],n[1]+w[1]],t=this.getSize();this.anchorEl.removeClass(this.anchorCls);if(this.targetCounter<2){if(x[0]<o){if(this.anchorToTarget){this.defaultAlign="l-r";if(this.mouseOffset){this.mouseOffset[0]*=-1}}this.anchor="left";return this.getTargetXY()}if(x[0]+t.width>y){if(this.anchorToTarget){this.defaultAlign="r-l";if(this.mouseOffset){this.mouseOffset[0]*=-1}}this.anchor="right";return this.getTargetXY()}if(x[1]<p){if(this.anchorToTarget){this.defaultAlign="t-b";if(this.mouseOffset){this.mouseOffset[1]*=-1}}this.anchor="top";return this.getTargetXY()}if(x[1]+t.height>s){if(this.anchorToTarget){this.defaultAlign="b-t";if(this.mouseOffset){this.mouseOffset[1]*=-1}}this.anchor="bottom";return this.getTargetXY()}}this.anchorCls="x-tip-anchor-"+this.getAnchorPosition();this.anchorEl.addClass(this.anchorCls);this.targetCounter=0;return x}else{var v=this.getMouseOffset();return[this.targetXY[0]+v[0],this.targetXY[1]+v[1]]}},getMouseOffset:function(){var b=this.anchor?[0,0]:[15,18];if(this.mouseOffset){b[0]+=this.mouseOffset[0];
b[1]+=this.mouseOffset[1]}return b},getAnchorPosition:function(){if(this.anchor){this.tipAnchor=this.anchor.charAt(0)}else{var b=this.defaultAlign.match(/^([a-z]+)-([a-z]+)(\?)?$/);if(!b){throw"AnchorTip.defaultAlign is invalid"}this.tipAnchor=b[1].charAt(0)}switch(this.tipAnchor){case"t":return"top";case"b":return"bottom";case"r":return"right"}return"left"},getAnchorAlign:function(){switch(this.anchor){case"top":return"tl-bl";case"left":return"tl-tr";case"right":return"tr-tl";default:return"bl-tl"}},getOffsets:function(){var d,e=this.getAnchorPosition().charAt(0);if(this.anchorToTarget&&!this.trackMouse){switch(e){case"t":d=[0,9];break;case"b":d=[0,-13];break;case"r":d=[-13,0];break;default:d=[9,0];break}}else{switch(e){case"t":d=[-15-this.anchorOffset,30];break;case"b":d=[-19-this.anchorOffset,-13-this.el.dom.offsetHeight];break;case"r":d=[-15-this.el.dom.offsetWidth,-13-this.anchorOffset];break;default:d=[25,-13-this.anchorOffset];break}}var g=this.getMouseOffset();d[0]+=g[0];d[1]+=g[1];return d},onTargetOver:function(c){if(this.disabled||c.within(this.target.dom,true)){return}var d=c.getTarget(this.delegate);if(d){this.triggerElement=d;this.clearTimer("hide");this.targetXY=c.getXY();this.delayShow()}},delayShow:function(){if(this.hidden&&!this.showTimer){if(this.lastActive.getElapsed()<this.quickShowInterval){this.show()}else{this.showTimer=this.show.defer(this.showDelay,this)}}else{if(!this.hidden&&this.autoHide!==false){this.show()}}},onTargetOut:function(b){if(this.disabled||b.within(this.target.dom,true)){return}this.clearTimer("show");if(this.autoHide!==false){this.delayHide()}},delayHide:function(){if(!this.hidden&&!this.hideTimer){this.hideTimer=this.hide.defer(this.hideDelay,this)}},hide:function(){this.clearTimer("dismiss");this.lastActive=new Date();if(this.anchorEl){this.anchorEl.hide()}Ext.ToolTip.superclass.hide.call(this);delete this.triggerElement},show:function(){if(this.anchor){this.showAt([-1000,-1000]);this.origConstrainPosition=this.constrainPosition;this.constrainPosition=false;this.anchor=this.origAnchor}this.showAt(this.getTargetXY());if(this.anchor){this.anchorEl.show();this.syncAnchor();this.constrainPosition=this.origConstrainPosition}else{this.anchorEl.hide()}},showAt:function(b){this.lastActive=new Date();this.clearTimers();Ext.ToolTip.superclass.showAt.call(this,b);if(this.dismissDelay&&this.autoHide!==false){this.dismissTimer=this.hide.defer(this.dismissDelay,this)}if(this.anchor&&!this.anchorEl.isVisible()){this.syncAnchor();this.anchorEl.show()}else{this.anchorEl.hide()}},syncAnchor:function(){var e,d,g;switch(this.tipAnchor.charAt(0)){case"t":e="b";d="tl";g=[20+this.anchorOffset,2];break;case"r":e="l";d="tr";g=[-2,11+this.anchorOffset];break;case"b":e="t";d="bl";g=[20+this.anchorOffset,-2];break;default:e="r";d="tl";g=[2,11+this.anchorOffset];break}this.anchorEl.alignTo(this.el,e+"-"+d,g)},setPagePosition:function(d,c){Ext.ToolTip.superclass.setPagePosition.call(this,d,c);if(this.anchor){this.syncAnchor()}},clearTimer:function(b){b=b+"Timer";clearTimeout(this[b]);delete this[b]},clearTimers:function(){this.clearTimer("show");this.clearTimer("dismiss");this.clearTimer("hide")},onShow:function(){Ext.ToolTip.superclass.onShow.call(this);Ext.getDoc().on("mousedown",this.onDocMouseDown,this)},onHide:function(){Ext.ToolTip.superclass.onHide.call(this);Ext.getDoc().un("mousedown",this.onDocMouseDown,this)},onDocMouseDown:function(b){if(this.autoHide!==true&&!this.closable&&!b.within(this.el.dom)){this.disable();this.doEnable.defer(100,this)}},doEnable:function(){if(!this.isDestroyed){this.enable()}},onDisable:function(){this.clearTimers();this.hide()},adjustPosition:function(g,h){if(this.contstrainPosition){var i=this.targetXY[1],e=this.getSize().height;if(h<=i&&(h+e)>=i){h=i-e-5}}return{x:g,y:h}},beforeDestroy:function(){this.clearTimers();Ext.destroy(this.anchorEl);delete this.anchorEl;delete this.target;delete this.anchorTarget;delete this.triggerElement;Ext.ToolTip.superclass.beforeDestroy.call(this)
},onDestroy:function(){Ext.getDoc().un("mousedown",this.onDocMouseDown,this);Ext.ToolTip.superclass.onDestroy.call(this)}});Ext.reg("tooltip",Ext.ToolTip);Ext.QuickTip=Ext.extend(Ext.ToolTip,{interceptTitles:false,tagConfig:{namespace:"ext",attribute:"qtip",width:"qwidth",target:"target",title:"qtitle",hide:"hide",cls:"qclass",align:"qalign",anchor:"anchor"},initComponent:function(){this.target=this.target||Ext.getDoc();this.targets=this.targets||{};Ext.QuickTip.superclass.initComponent.call(this)},register:function(q){var o=Ext.isArray(q)?q:arguments;for(var p=0,m=o.length;p<m;p++){var i=o[p];var n=i.target;if(n){if(Ext.isArray(n)){for(var s=0,c=n.length;s<c;s++){this.targets[Ext.id(n[s])]=i}}else{this.targets[Ext.id(n)]=i}}}},unregister:function(b){delete this.targets[Ext.id(b)]},cancelShow:function(c){var d=this.activeTarget;c=Ext.get(c).dom;if(this.isVisible()){if(d&&d.el==c){this.hide()}}else{if(d&&d.el==c){this.clearTimer("show")}}},getTipCfg:function(h){var e=h.getTarget(),i,g;if(this.interceptTitles&&e.title&&Ext.isString(e.title)){i=e.title;e.qtip=i;e.removeAttribute("title");h.preventDefault()}else{g=this.tagConfig;i=e.qtip||Ext.fly(e).getAttribute(g.attribute,g.namespace)}return i},onTargetOver:function(l){if(this.disabled){return}this.targetXY=l.getXY();var p=l.getTarget();if(!p||p.nodeType!==1||p==document||p==document.body){return}if(this.activeTarget&&((p==this.activeTarget.el)||Ext.fly(this.activeTarget.el).contains(p))){this.clearTimer("hide");this.show();return}if(p&&this.targets[p.id]){this.activeTarget=this.targets[p.id];this.activeTarget.el=p;this.anchor=this.activeTarget.anchor;if(this.anchor){this.anchorTarget=p}this.delayShow();return}var n,m=Ext.fly(p),e=this.tagConfig,o=e.namespace;if(n=this.getTipCfg(l)){var k=m.getAttribute(e.hide,o);this.activeTarget={el:p,text:n,width:m.getAttribute(e.width,o),autoHide:k!="user"&&k!=="false",title:m.getAttribute(e.title,o),cls:m.getAttribute(e.cls,o),align:m.getAttribute(e.align,o)};this.anchor=m.getAttribute(e.anchor,o);if(this.anchor){this.anchorTarget=p}this.delayShow()}},onTargetOut:function(b){if(this.activeTarget&&b.within(this.activeTarget.el)&&!this.getTipCfg(b)){return}this.clearTimer("show");if(this.autoHide!==false){this.delayHide()}},showAt:function(c){var d=this.activeTarget;if(d){if(!this.rendered){this.render(Ext.getBody());this.activeTarget=d}if(d.width){this.setWidth(d.width);this.body.setWidth(this.adjustBodyWidth(d.width-this.getFrameWidth()));this.measureWidth=false}else{this.measureWidth=true}this.setTitle(d.title||"");this.body.update(d.text);this.autoHide=d.autoHide;this.dismissDelay=d.dismissDelay||this.dismissDelay;if(this.lastCls){this.el.removeClass(this.lastCls);delete this.lastCls}if(d.cls){this.el.addClass(d.cls);this.lastCls=d.cls}if(this.anchor){this.constrainPosition=false}else{if(d.align){c=this.el.getAlignToXY(d.el,d.align);this.constrainPosition=false}else{this.constrainPosition=true}}}Ext.QuickTip.superclass.showAt.call(this,c)},hide:function(){delete this.activeTarget;Ext.QuickTip.superclass.hide.call(this)}});Ext.reg("quicktip",Ext.QuickTip);Ext.QuickTips=function(){var c,d=false;return{init:function(a){if(!c){if(!Ext.isReady){Ext.onReady(function(){Ext.QuickTips.init(a)});return}c=new Ext.QuickTip({elements:"header,body",disabled:d});if(a!==false){c.render(Ext.getBody())}}},ddDisable:function(){if(c&&!d){c.disable()}},ddEnable:function(){if(c&&!d){c.enable()}},enable:function(){if(c){c.enable()}d=false},disable:function(){if(c){c.disable()}d=true},isEnabled:function(){return c!==undefined&&!c.disabled},getQuickTip:function(){return c},register:function(){c.register.apply(c,arguments)},unregister:function(){c.unregister.apply(c,arguments)},tips:function(){c.register.apply(c,arguments)}}}();Ext.slider.Tip=Ext.extend(Ext.Tip,{minWidth:10,offsets:[0,-10],init:function(b){b.on({scope:this,dragstart:this.onSlide,drag:this.onSlide,dragend:this.hide,destroy:this.destroy})},onSlide:function(d,g,e){this.show();this.body.update(this.getText(e));
this.doAutoWidth();this.el.alignTo(e.el,"b-t?",this.offsets)},getText:function(b){return String(b.value)}});Ext.ux.SliderTip=Ext.slider.Tip;Ext.tree.TreePanel=Ext.extend(Ext.Panel,{rootVisible:true,animate:Ext.enableFx,lines:true,enableDD:false,hlDrop:Ext.enableFx,pathSeparator:"/",bubbleEvents:[],initComponent:function(){Ext.tree.TreePanel.superclass.initComponent.call(this);if(!this.eventModel){this.eventModel=new Ext.tree.TreeEventModel(this)}var d=this.loader;if(!d){d=new Ext.tree.TreeLoader({dataUrl:this.dataUrl,requestMethod:this.requestMethod})}else{if(Ext.isObject(d)&&!d.load){d=new Ext.tree.TreeLoader(d)}}this.loader=d;this.nodeHash={};if(this.root){var c=this.root;delete this.root;this.setRootNode(c)}this.addEvents("append","remove","movenode","insert","beforeappend","beforeremove","beforemovenode","beforeinsert","beforeload","load","textchange","beforeexpandnode","beforecollapsenode","expandnode","disabledchange","collapsenode","beforeclick","click","containerclick","checkchange","beforedblclick","dblclick","containerdblclick","contextmenu","containercontextmenu","beforechildrenrendered","startdrag","enddrag","dragdrop","beforenodedrop","nodedrop","nodedragover");if(this.singleExpand){this.on("beforeexpandnode",this.restrictExpand,this)}},proxyNodeEvent:function(p,i,k,l,m,n,o){if(p=="collapse"||p=="expand"||p=="beforecollapse"||p=="beforeexpand"||p=="move"||p=="beforemove"){p=p+"node"}return this.fireEvent(p,i,k,l,m,n,o)},getRootNode:function(){return this.root},setRootNode:function(c){this.destroyRoot();if(!c.render){c=this.loader.createNode(c)}this.root=c;c.ownerTree=this;c.isRoot=true;this.registerNode(c);if(!this.rootVisible){var d=c.attributes.uiProvider;c.ui=d?new d(c):new Ext.tree.RootTreeNodeUI(c)}if(this.innerCt){this.clearInnerCt();this.renderRoot()}return c},clearInnerCt:function(){this.innerCt.update("")},renderRoot:function(){this.root.render();if(!this.rootVisible){this.root.renderChildren()}},getNodeById:function(b){return this.nodeHash[b]},registerNode:function(b){this.nodeHash[b.id]=b},unregisterNode:function(b){delete this.nodeHash[b.id]},toString:function(){return"[Tree"+(this.id?" "+this.id:"")+"]"},restrictExpand:function(d){var c=d.parentNode;if(c){if(c.expandedChild&&c.expandedChild.parentNode==c){c.expandedChild.collapse()}c.expandedChild=d}},getChecked:function(a,i){i=i||this.root;var h=[];var g=function(){if(this.attributes.checked){h.push(!a?this:(a=="id"?this.id:this.attributes[a]))}};i.cascade(g);return h},getLoader:function(){return this.loader},expandAll:function(){this.root.expand(true)},collapseAll:function(){this.root.collapse(true)},getSelectionModel:function(){if(!this.selModel){this.selModel=new Ext.tree.DefaultSelectionModel()}return this.selModel},expandPath:function(m,k,l){if(Ext.isEmpty(m)){if(l){l(false,undefined)}return}k=k||"id";var o=m.split(this.pathSeparator);var p=this.root;if(p.attributes[k]!=o[1]){if(l){l(false,null)}return}var i=1;var n=function(){if(++i==o.length){if(l){l(true,p)}return}var a=p.findChild(k,o[i]);if(!a){if(l){l(false,p)}return}p=a;a.expand(false,false,n)};p.expand(false,false,n)},selectPath:function(l,i,k){if(Ext.isEmpty(l)){if(k){k(false,undefined)}return}i=i||"id";var n=l.split(this.pathSeparator),h=n.pop();if(n.length>1){var m=function(b,c){if(b&&c){var a=c.findChild(i,h);if(a){a.select();if(k){k(true,a)}}else{if(k){k(false,a)}}}else{if(k){k(false,a)}}};this.expandPath(n.join(this.pathSeparator),i,m)}else{this.root.select();if(k){k(true,this.root)}}},getTreeEl:function(){return this.body},onRender:function(c,d){Ext.tree.TreePanel.superclass.onRender.call(this,c,d);this.el.addClass("x-tree");this.innerCt=this.body.createChild({tag:"ul",cls:"x-tree-root-ct "+(this.useArrows?"x-tree-arrows":this.lines?"x-tree-lines":"x-tree-no-lines")})},initEvents:function(){Ext.tree.TreePanel.superclass.initEvents.call(this);if(this.containerScroll){Ext.dd.ScrollManager.register(this.body)}if((this.enableDD||this.enableDrop)&&!this.dropZone){this.dropZone=new Ext.tree.TreeDropZone(this,this.dropConfig||{ddGroup:this.ddGroup||"TreeDD",appendOnly:this.ddAppendOnly===true})
}if((this.enableDD||this.enableDrag)&&!this.dragZone){this.dragZone=new Ext.tree.TreeDragZone(this,this.dragConfig||{ddGroup:this.ddGroup||"TreeDD",scroll:this.ddScroll})}this.getSelectionModel().init(this)},afterRender:function(){Ext.tree.TreePanel.superclass.afterRender.call(this);this.renderRoot()},beforeDestroy:function(){if(this.rendered){Ext.dd.ScrollManager.unregister(this.body);Ext.destroy(this.dropZone,this.dragZone)}this.destroyRoot();Ext.destroy(this.loader);this.nodeHash=this.root=this.loader=null;Ext.tree.TreePanel.superclass.beforeDestroy.call(this)},destroyRoot:function(){if(this.root&&this.root.destroy){this.root.destroy(true)}}});Ext.tree.TreePanel.nodeTypes={};Ext.reg("treepanel",Ext.tree.TreePanel);Ext.tree.TreeEventModel=function(b){this.tree=b;this.tree.on("render",this.initEvents,this)};Ext.tree.TreeEventModel.prototype={initEvents:function(){var b=this.tree;if(b.trackMouseOver!==false){b.mon(b.innerCt,{scope:this,mouseover:this.delegateOver,mouseout:this.delegateOut})}b.mon(b.getTreeEl(),{scope:this,click:this.delegateClick,dblclick:this.delegateDblClick,contextmenu:this.delegateContextMenu})},getNode:function(d){var e;if(e=d.getTarget(".x-tree-node-el",10)){var g=Ext.fly(e,"_treeEvents").getAttribute("tree-node-id","ext");if(g){return this.tree.getNodeById(g)}}return null},getNodeTarget:function(c){var d=c.getTarget(".x-tree-node-icon",1);if(!d){d=c.getTarget(".x-tree-node-el",6)}return d},delegateOut:function(d,e){if(!this.beforeEvent(d)){return}if(d.getTarget(".x-tree-ec-icon",1)){var g=this.getNode(d);this.onIconOut(d,g);if(g==this.lastEcOver){delete this.lastEcOver}}if((e=this.getNodeTarget(d))&&!d.within(e,true)){this.onNodeOut(d,this.getNode(d))}},delegateOver:function(c,d){if(!this.beforeEvent(c)){return}if(Ext.isGecko&&!this.trackingDoc){Ext.getBody().on("mouseover",this.trackExit,this);this.trackingDoc=true}if(this.lastEcOver){this.onIconOut(c,this.lastEcOver);delete this.lastEcOver}if(c.getTarget(".x-tree-ec-icon",1)){this.lastEcOver=this.getNode(c);this.onIconOver(c,this.lastEcOver)}if(d=this.getNodeTarget(c)){this.onNodeOver(c,this.getNode(c))}},trackExit:function(b){if(this.lastOverNode){if(this.lastOverNode.ui&&!b.within(this.lastOverNode.ui.getEl())){this.onNodeOut(b,this.lastOverNode)}delete this.lastOverNode;Ext.getBody().un("mouseover",this.trackExit,this);this.trackingDoc=false}},delegateClick:function(c,d){if(this.beforeEvent(c)){if(c.getTarget("input[type=checkbox]",1)){this.onCheckboxClick(c,this.getNode(c))}else{if(c.getTarget(".x-tree-ec-icon",1)){this.onIconClick(c,this.getNode(c))}else{if(this.getNodeTarget(c)){this.onNodeClick(c,this.getNode(c))}}}}else{this.checkContainerEvent(c,"click")}},delegateDblClick:function(c,d){if(this.beforeEvent(c)){if(this.getNodeTarget(c)){this.onNodeDblClick(c,this.getNode(c))}}else{this.checkContainerEvent(c,"dblclick")}},delegateContextMenu:function(c,d){if(this.beforeEvent(c)){if(this.getNodeTarget(c)){this.onNodeContextMenu(c,this.getNode(c))}}else{this.checkContainerEvent(c,"contextmenu")}},checkContainerEvent:function(c,d){if(this.disabled){c.stopEvent();return false}this.onContainerEvent(c,d)},onContainerEvent:function(c,d){this.tree.fireEvent("container"+d,this.tree,c)},onNodeClick:function(c,d){d.ui.onClick(c)},onNodeOver:function(c,d){this.lastOverNode=d;d.ui.onOver(c)},onNodeOut:function(c,d){d.ui.onOut(c)},onIconOver:function(c,d){d.ui.addClass("x-tree-ec-over")},onIconOut:function(c,d){d.ui.removeClass("x-tree-ec-over")},onIconClick:function(c,d){d.ui.ecClick(c)},onCheckboxClick:function(c,d){d.ui.onCheckChange(c)},onNodeDblClick:function(c,d){d.ui.onDblClick(c)},onNodeContextMenu:function(c,d){d.ui.onContextMenu(c)},beforeEvent:function(c){var d=this.getNode(c);if(this.disabled||!d||!d.ui){c.stopEvent();return false}return true},disable:function(){this.disabled=true},enable:function(){this.disabled=false}};Ext.tree.DefaultSelectionModel=Ext.extend(Ext.util.Observable,{constructor:function(b){this.selNode=null;this.addEvents("selectionchange","beforeselect");
Ext.apply(this,b);Ext.tree.DefaultSelectionModel.superclass.constructor.call(this)},init:function(b){this.tree=b;b.mon(b.getTreeEl(),"keydown",this.onKeyDown,this);b.on("click",this.onNodeClick,this)},onNodeClick:function(d,c){this.select(d)},select:function(g,e){if(!Ext.fly(g.ui.wrap).isVisible()&&e){return e.call(this,g)}var d=this.selNode;if(g==d){g.ui.onSelectedChange(true)}else{if(this.fireEvent("beforeselect",this,g,d)!==false){if(d&&d.ui){d.ui.onSelectedChange(false)}this.selNode=g;g.ui.onSelectedChange(true);this.fireEvent("selectionchange",this,g,d)}}return g},unselect:function(c,d){if(this.selNode==c){this.clearSelections(d)}},clearSelections:function(d){var c=this.selNode;if(c){c.ui.onSelectedChange(false);this.selNode=null;if(d!==true){this.fireEvent("selectionchange",this,null)}}return c},getSelectedNode:function(){return this.selNode},isSelected:function(b){return this.selNode==b},selectPrevious:function(e){if(!(e=e||this.selNode||this.lastSelNode)){return null}var g=e.previousSibling;if(g){if(!g.isExpanded()||g.childNodes.length<1){return this.select(g,this.selectPrevious)}else{var d=g.lastChild;while(d&&d.isExpanded()&&Ext.fly(d.ui.wrap).isVisible()&&d.childNodes.length>0){d=d.lastChild}return this.select(d,this.selectPrevious)}}else{if(e.parentNode&&(this.tree.rootVisible||!e.parentNode.isRoot)){return this.select(e.parentNode,this.selectPrevious)}}return null},selectNext:function(c){if(!(c=c||this.selNode||this.lastSelNode)){return null}if(c.firstChild&&c.isExpanded()&&Ext.fly(c.ui.wrap).isVisible()){return this.select(c.firstChild,this.selectNext)}else{if(c.nextSibling){return this.select(c.nextSibling,this.selectNext)}else{if(c.parentNode){var d=null;c.parentNode.bubble(function(){if(this.nextSibling){d=this.getOwnerTree().selModel.select(this.nextSibling,this.selectNext);return false}});return d}}}return null},onKeyDown:function(i){var e=this.selNode||this.lastSelNode;var h=this;if(!e){return}var g=i.getKey();switch(g){case i.DOWN:i.stopEvent();this.selectNext();break;case i.UP:i.stopEvent();this.selectPrevious();break;case i.RIGHT:i.preventDefault();if(e.hasChildNodes()){if(!e.isExpanded()){e.expand()}else{if(e.firstChild){this.select(e.firstChild,i)}}}break;case i.LEFT:i.preventDefault();if(e.hasChildNodes()&&e.isExpanded()){e.collapse()}else{if(e.parentNode&&(this.tree.rootVisible||e.parentNode!=this.tree.getRootNode())){this.select(e.parentNode,i)}}break}}});Ext.tree.MultiSelectionModel=Ext.extend(Ext.util.Observable,{constructor:function(b){this.selNodes=[];this.selMap={};this.addEvents("selectionchange");Ext.apply(this,b);Ext.tree.MultiSelectionModel.superclass.constructor.call(this)},init:function(b){this.tree=b;b.mon(b.getTreeEl(),"keydown",this.onKeyDown,this);b.on("click",this.onNodeClick,this)},onNodeClick:function(d,c){if(c.ctrlKey&&this.isSelected(d)){this.unselect(d)}else{this.select(d,c,c.ctrlKey)}},select:function(e,g,d){if(d!==true){this.clearSelections(true)}if(this.isSelected(e)){this.lastSelNode=e;return e}this.selNodes.push(e);this.selMap[e.id]=e;this.lastSelNode=e;e.ui.onSelectedChange(true);this.fireEvent("selectionchange",this,this.selNodes);return e},unselect:function(d){if(this.selMap[d.id]){d.ui.onSelectedChange(false);var g=this.selNodes;var e=g.indexOf(d);if(e!=-1){this.selNodes.splice(e,1)}delete this.selMap[d.id];this.fireEvent("selectionchange",this,this.selNodes)}},clearSelections:function(e){var h=this.selNodes;if(h.length>0){for(var i=0,g=h.length;i<g;i++){h[i].ui.onSelectedChange(false)}this.selNodes=[];this.selMap={};if(e!==true){this.fireEvent("selectionchange",this,this.selNodes)}}},isSelected:function(b){return this.selMap[b.id]?true:false},getSelectedNodes:function(){return this.selNodes.concat([])},onKeyDown:Ext.tree.DefaultSelectionModel.prototype.onKeyDown,selectNext:Ext.tree.DefaultSelectionModel.prototype.selectNext,selectPrevious:Ext.tree.DefaultSelectionModel.prototype.selectPrevious});Ext.data.Tree=Ext.extend(Ext.util.Observable,{constructor:function(b){this.nodeHash={};
this.root=null;if(b){this.setRootNode(b)}this.addEvents("append","remove","move","insert","beforeappend","beforeremove","beforemove","beforeinsert");Ext.data.Tree.superclass.constructor.call(this)},pathSeparator:"/",proxyNodeEvent:function(){return this.fireEvent.apply(this,arguments)},getRootNode:function(){return this.root},setRootNode:function(b){this.root=b;b.ownerTree=this;b.isRoot=true;this.registerNode(b);return b},getNodeById:function(b){return this.nodeHash[b]},registerNode:function(b){this.nodeHash[b.id]=b},unregisterNode:function(b){delete this.nodeHash[b.id]},toString:function(){return"[Tree"+(this.id?" "+this.id:"")+"]"}});Ext.data.Node=Ext.extend(Ext.util.Observable,{constructor:function(b){this.attributes=b||{};this.leaf=this.attributes.leaf;this.id=this.attributes.id;if(!this.id){this.id=Ext.id(null,"xnode-");this.attributes.id=this.id}this.childNodes=[];this.parentNode=null;this.firstChild=null;this.lastChild=null;this.previousSibling=null;this.nextSibling=null;this.addEvents({append:true,remove:true,move:true,insert:true,beforeappend:true,beforeremove:true,beforemove:true,beforeinsert:true});this.listeners=this.attributes.listeners;Ext.data.Node.superclass.constructor.call(this)},fireEvent:function(c){if(Ext.data.Node.superclass.fireEvent.apply(this,arguments)===false){return false}var d=this.getOwnerTree();if(d){if(d.proxyNodeEvent.apply(d,arguments)===false){return false}}return true},isLeaf:function(){return this.leaf===true},setFirstChild:function(b){this.firstChild=b},setLastChild:function(b){this.lastChild=b},isLast:function(){return(!this.parentNode?true:this.parentNode.lastChild==this)},isFirst:function(){return(!this.parentNode?true:this.parentNode.firstChild==this)},hasChildNodes:function(){return !this.isLeaf()&&this.childNodes.length>0},isExpandable:function(){return this.attributes.expandable||this.hasChildNodes()},appendChild:function(n){var m=false;if(Ext.isArray(n)){m=n}else{if(arguments.length>1){m=arguments}}if(m){for(var o=0,k=m.length;o<k;o++){this.appendChild(m[o])}}else{if(this.fireEvent("beforeappend",this.ownerTree,this,n)===false){return false}var i=this.childNodes.length;var p=n.parentNode;if(p){if(n.fireEvent("beforemove",n.getOwnerTree(),n,p,this,i)===false){return false}p.removeChild(n)}i=this.childNodes.length;if(i===0){this.setFirstChild(n)}this.childNodes.push(n);n.parentNode=this;var l=this.childNodes[i-1];if(l){n.previousSibling=l;l.nextSibling=n}else{n.previousSibling=null}n.nextSibling=null;this.setLastChild(n);n.setOwnerTree(this.getOwnerTree());this.fireEvent("append",this.ownerTree,this,n,i);if(p){n.fireEvent("move",this.ownerTree,n,p,this,i)}return n}},removeChild:function(g,d){var e=this.childNodes.indexOf(g);if(e==-1){return false}if(this.fireEvent("beforeremove",this.ownerTree,this,g)===false){return false}this.childNodes.splice(e,1);if(g.previousSibling){g.previousSibling.nextSibling=g.nextSibling}if(g.nextSibling){g.nextSibling.previousSibling=g.previousSibling}if(this.firstChild==g){this.setFirstChild(g.nextSibling)}if(this.lastChild==g){this.setLastChild(g.previousSibling)}this.fireEvent("remove",this.ownerTree,this,g);if(d){g.destroy(true)}else{g.clear()}return g},clear:function(b){this.setOwnerTree(null,b);this.parentNode=this.previousSibling=this.nextSibling=null;if(b){this.firstChild=this.lastChild=null}},destroy:function(b){if(b===true){this.purgeListeners();this.clear(true);Ext.each(this.childNodes,function(a){a.destroy(true)});this.childNodes=null}else{this.remove(true)}},insertBefore:function(m,i){if(!i){return this.appendChild(m)}if(m==i){return false}if(this.fireEvent("beforeinsert",this.ownerTree,this,m,i)===false){return false}var h=this.childNodes.indexOf(i);var n=m.parentNode;var l=h;if(n==this&&this.childNodes.indexOf(m)<h){l--}if(n){if(m.fireEvent("beforemove",m.getOwnerTree(),m,n,this,h,i)===false){return false}n.removeChild(m)}if(l===0){this.setFirstChild(m)}this.childNodes.splice(l,0,m);m.parentNode=this;var k=this.childNodes[l-1];if(k){m.previousSibling=k;
k.nextSibling=m}else{m.previousSibling=null}m.nextSibling=i;i.previousSibling=m;m.setOwnerTree(this.getOwnerTree());this.fireEvent("insert",this.ownerTree,this,m,i);if(n){m.fireEvent("move",this.ownerTree,m,n,this,l,i)}return m},remove:function(b){if(this.parentNode){this.parentNode.removeChild(this,b)}return this},removeAll:function(e){var g=this.childNodes,d;while((d=g[0])){this.removeChild(d,e)}return this},item:function(b){return this.childNodes[b]},replaceChild:function(e,g){var d=g?g.nextSibling:null;this.removeChild(g);this.insertBefore(e,d);return g},indexOf:function(b){return this.childNodes.indexOf(b)},getOwnerTree:function(){if(!this.ownerTree){var b=this;while(b){if(b.ownerTree){this.ownerTree=b.ownerTree;break}b=b.parentNode}}return this.ownerTree},getDepth:function(){var c=0;var d=this;while(d.parentNode){++c;d=d.parentNode}return c},setOwnerTree:function(d,c){if(d!=this.ownerTree){if(this.ownerTree){this.ownerTree.unregisterNode(this)}this.ownerTree=d;if(c!==true){Ext.each(this.childNodes,function(a){a.setOwnerTree(d)})}if(d){d.registerNode(this)}}},setId:function(c){if(c!==this.id){var d=this.ownerTree;if(d){d.unregisterNode(this)}this.id=this.attributes.id=c;if(d){d.registerNode(this)}this.onIdChange(c)}},onIdChange:Ext.emptyFn,getPath:function(i){i=i||"id";var g=this.parentNode;var b=[this.attributes[i]];while(g){b.unshift(g.attributes[i]);g=g.parentNode}var h=this.getOwnerTree().pathSeparator;return h+b.join(h)},bubble:function(i,e,g){var h=this;while(h){if(i.apply(e||h,g||[h])===false){break}h=h.parentNode}},cascade:function(k,l,h){if(k.apply(l||this,h||[this])!==false){var m=this.childNodes;for(var n=0,i=m.length;n<i;n++){m[n].cascade(k,l,h)}}},eachChild:function(k,l,h){var m=this.childNodes;for(var n=0,i=m.length;n<i;n++){if(k.apply(l||m[n],h||[m[n]])===false){break}}},findChild:function(d,g,e){return this.findChildBy(function(){return this.attributes[d]==g},null,e)},findChildBy:function(n,o,i){var p=this.childNodes,l=p.length,q=0,m,s;for(;q<l;q++){m=p[q];if(n.call(o||m,m)===true){return m}else{if(i){s=m.findChildBy(n,o,i);if(s!=null){return s}}}}return null},sort:function(n,o){var p=this.childNodes;var k=p.length;if(k>0){var m=o?function(){n.apply(o,arguments)}:n;p.sort(m);for(var i=0;i<k;i++){var l=p[i];l.previousSibling=p[i-1];l.nextSibling=p[i+1];if(i===0){this.setFirstChild(l)}if(i==k-1){this.setLastChild(l)}}}},contains:function(b){return b.isAncestor(this)},isAncestor:function(d){var c=this.parentNode;while(c){if(c==d){return true}c=c.parentNode}return false},toString:function(){return"[Node"+(this.id?" "+this.id:"")+"]"}});Ext.tree.TreeNode=Ext.extend(Ext.data.Node,{constructor:function(d){d=d||{};if(Ext.isString(d)){d={text:d}}this.childrenRendered=false;this.rendered=false;Ext.tree.TreeNode.superclass.constructor.call(this,d);this.expanded=d.expanded===true;this.isTarget=d.isTarget!==false;this.draggable=d.draggable!==false&&d.allowDrag!==false;this.allowChildren=d.allowChildren!==false&&d.allowDrop!==false;this.text=d.text;this.disabled=d.disabled===true;this.hidden=d.hidden===true;this.addEvents("textchange","beforeexpand","beforecollapse","expand","disabledchange","collapse","beforeclick","click","checkchange","beforedblclick","dblclick","contextmenu","beforechildrenrendered");var c=this.attributes.uiProvider||this.defaultUI||Ext.tree.TreeNodeUI;this.ui=new c(this)},preventHScroll:true,isExpanded:function(){return this.expanded},getUI:function(){return this.ui},getLoader:function(){var b;return this.loader||((b=this.getOwnerTree())&&b.loader?b.loader:(this.loader=new Ext.tree.TreeLoader()))},setFirstChild:function(d){var c=this.firstChild;Ext.tree.TreeNode.superclass.setFirstChild.call(this,d);if(this.childrenRendered&&c&&d!=c){c.renderIndent(true,true)}if(this.rendered){this.renderIndent(true,true)}},setLastChild:function(c){var d=this.lastChild;Ext.tree.TreeNode.superclass.setLastChild.call(this,c);if(this.childrenRendered&&d&&c!=d){d.renderIndent(true,true)}if(this.rendered){this.renderIndent(true,true)
}},appendChild:function(c){if(!c.render&&!Ext.isArray(c)){c=this.getLoader().createNode(c)}var d=Ext.tree.TreeNode.superclass.appendChild.call(this,c);if(d&&this.childrenRendered){d.render()}this.ui.updateExpandIcon();return d},removeChild:function(d,e){this.ownerTree.getSelectionModel().unselect(d);Ext.tree.TreeNode.superclass.removeChild.apply(this,arguments);if(!e){var g=d.ui.rendered;if(g){d.ui.remove()}if(g&&this.childNodes.length<1){this.collapse(false,false)}else{this.ui.updateExpandIcon()}if(!this.firstChild&&!this.isHiddenRoot()){this.childrenRendered=false}}return d},insertBefore:function(g,e){if(!g.render){g=this.getLoader().createNode(g)}var d=Ext.tree.TreeNode.superclass.insertBefore.call(this,g,e);if(d&&e&&this.childrenRendered){g.render()}this.ui.updateExpandIcon();return d},setText:function(c){var d=this.text;this.text=this.attributes.text=c;if(this.rendered){this.ui.onTextChange(this,c,d)}this.fireEvent("textchange",this,c,d)},setIconCls:function(c){var d=this.attributes.iconCls;this.attributes.iconCls=c;if(this.rendered){this.ui.onIconClsChange(this,c,d)}},setTooltip:function(d,c){this.attributes.qtip=d;this.attributes.qtipTitle=c;if(this.rendered){this.ui.onTipChange(this,d,c)}},setIcon:function(b){this.attributes.icon=b;if(this.rendered){this.ui.onIconChange(this,b)}},setHref:function(d,c){this.attributes.href=d;this.attributes.hrefTarget=c;if(this.rendered){this.ui.onHrefChange(this,d,c)}},setCls:function(c){var d=this.attributes.cls;this.attributes.cls=c;if(this.rendered){this.ui.onClsChange(this,c,d)}},select:function(){var b=this.getOwnerTree();if(b){b.getSelectionModel().select(this)}},unselect:function(d){var c=this.getOwnerTree();if(c){c.getSelectionModel().unselect(this,d)}},isSelected:function(){var b=this.getOwnerTree();return b?b.getSelectionModel().isSelected(this):false},expand:function(g,i,h,e){if(!this.expanded){if(this.fireEvent("beforeexpand",this,g,i)===false){return}if(!this.childrenRendered){this.renderChildren()}this.expanded=true;if(!this.isHiddenRoot()&&(this.getOwnerTree().animate&&i!==false)||i){this.ui.animExpand(function(){this.fireEvent("expand",this);this.runCallback(h,e||this,[this]);if(g===true){this.expandChildNodes(true,true)}}.createDelegate(this));return}else{this.ui.expand();this.fireEvent("expand",this);this.runCallback(h,e||this,[this])}}else{this.runCallback(h,e||this,[this])}if(g===true){this.expandChildNodes(true)}},runCallback:function(e,g,d){if(Ext.isFunction(e)){e.apply(g,d)}},isHiddenRoot:function(){return this.isRoot&&!this.getOwnerTree().rootVisible},collapse:function(i,m,l,n){if(this.expanded&&!this.isHiddenRoot()){if(this.fireEvent("beforecollapse",this,i,m)===false){return}this.expanded=false;if((this.getOwnerTree().animate&&m!==false)||m){this.ui.animCollapse(function(){this.fireEvent("collapse",this);this.runCallback(l,n||this,[this]);if(i===true){this.collapseChildNodes(true)}}.createDelegate(this));return}else{this.ui.collapse();this.fireEvent("collapse",this);this.runCallback(l,n||this,[this])}}else{if(!this.expanded){this.runCallback(l,n||this,[this])}}if(i===true){var o=this.childNodes;for(var p=0,k=o.length;p<k;p++){o[p].collapse(true,false)}}},delayedExpand:function(b){if(!this.expandProcId){this.expandProcId=this.expand.defer(b,this)}},cancelExpand:function(){if(this.expandProcId){clearTimeout(this.expandProcId)}this.expandProcId=false},toggle:function(){if(this.expanded){this.collapse()}else{this.expand()}},ensureVisible:function(g,d){var e=this.getOwnerTree();e.expandPath(this.parentNode?this.parentNode.getPath():this.getPath(),false,function(){var a=e.getNodeById(this.id);e.getTreeEl().scrollChildIntoView(a.ui.anchor);this.runCallback(g,d||this,[this])}.createDelegate(this))},expandChildNodes:function(g,i){var k=this.childNodes,l,h=k.length;for(l=0;l<h;l++){k[l].expand(g,i)}},collapseChildNodes:function(e){var h=this.childNodes;for(var i=0,g=h.length;i<g;i++){h[i].collapse(e)}},disable:function(){this.disabled=true;this.unselect();if(this.rendered&&this.ui.onDisableChange){this.ui.onDisableChange(this,true)
}this.fireEvent("disabledchange",this,true)},enable:function(){this.disabled=false;if(this.rendered&&this.ui.onDisableChange){this.ui.onDisableChange(this,false)}this.fireEvent("disabledchange",this,false)},renderChildren:function(e){if(e!==false){this.fireEvent("beforechildrenrendered",this)}var h=this.childNodes;for(var i=0,g=h.length;i<g;i++){h[i].render(true)}this.childrenRendered=true},sort:function(i,k){Ext.tree.TreeNode.superclass.sort.apply(this,arguments);if(this.childrenRendered){var l=this.childNodes;for(var g=0,h=l.length;g<h;g++){l[g].render(true)}}},render:function(b){this.ui.render(b);if(!this.rendered){this.getOwnerTree().registerNode(this);this.rendered=true;if(this.expanded){this.expanded=false;this.expand(false,false)}}},renderIndent:function(g,i){if(i){this.ui.childIndent=null}this.ui.renderIndent();if(g===true&&this.childrenRendered){var k=this.childNodes;for(var l=0,h=k.length;l<h;l++){k[l].renderIndent(true,i)}}},beginUpdate:function(){this.childrenRendered=false},endUpdate:function(){if(this.expanded&&this.rendered){this.renderChildren()}},destroy:function(b){if(b===true){this.unselect(true)}Ext.tree.TreeNode.superclass.destroy.call(this,b);Ext.destroy(this.ui,this.loader);this.ui=this.loader=null},onIdChange:function(b){this.ui.onIdChange(b)}});Ext.tree.TreePanel.nodeTypes.node=Ext.tree.TreeNode;Ext.tree.AsyncTreeNode=function(b){this.loaded=b&&b.loaded===true;this.loading=false;Ext.tree.AsyncTreeNode.superclass.constructor.apply(this,arguments);this.addEvents("beforeload","load")};Ext.extend(Ext.tree.AsyncTreeNode,Ext.tree.TreeNode,{expand:function(i,n,l,p){if(this.loading){var m;var o=function(){if(!this.loading){clearInterval(m);this.expand(i,n,l,p)}}.createDelegate(this);m=setInterval(o,200);return}if(!this.loaded){if(this.fireEvent("beforeload",this)===false){return}this.loading=true;this.ui.beforeLoad(this);var k=this.loader||this.attributes.loader||this.getOwnerTree().getLoader();if(k){k.load(this,this.loadComplete.createDelegate(this,[i,n,l,p]),this);return}}Ext.tree.AsyncTreeNode.superclass.expand.call(this,i,n,l,p)},isLoading:function(){return this.loading},loadComplete:function(g,i,h,e){this.loading=false;this.loaded=true;this.ui.afterLoad(this);this.fireEvent("load",this);this.expand(g,i,h,e)},isLoaded:function(){return this.loaded},hasChildNodes:function(){if(!this.isLeaf()&&!this.loaded){return true}else{return Ext.tree.AsyncTreeNode.superclass.hasChildNodes.call(this)}},reload:function(c,d){this.collapse(false,false);while(this.firstChild){this.removeChild(this.firstChild).destroy()}this.childrenRendered=false;this.loaded=false;if(this.isHiddenRoot()){this.expanded=false}this.expand(false,false,c,d)}});Ext.tree.TreePanel.nodeTypes.async=Ext.tree.AsyncTreeNode;Ext.tree.TreeNodeUI=Ext.extend(Object,{constructor:function(b){Ext.apply(this,{node:b,rendered:false,animating:false,wasLeaf:true,ecc:"x-tree-ec-icon x-tree-elbow",emptyIcon:Ext.BLANK_IMAGE_URL})},removeChild:function(b){if(this.rendered){this.ctNode.removeChild(b.ui.getEl())}},beforeLoad:function(){this.addClass("x-tree-node-loading")},afterLoad:function(){this.removeClass("x-tree-node-loading")},onTextChange:function(d,g,e){if(this.rendered){this.textNode.innerHTML=g}},onIconClsChange:function(g,e,d){if(this.rendered){Ext.fly(this.iconNode).replaceClass(d,e)}},onIconChange:function(d,e){if(this.rendered){var g=Ext.isEmpty(e);this.iconNode.src=g?this.emptyIcon:e;Ext.fly(this.iconNode)[g?"removeClass":"addClass"]("x-tree-node-inline-icon")}},onTipChange:function(e,i,h){if(this.rendered){var g=Ext.isDefined(h);if(this.textNode.setAttributeNS){this.textNode.setAttributeNS("ext","qtip",i);if(g){this.textNode.setAttributeNS("ext","qtitle",h)}}else{this.textNode.setAttribute("ext:qtip",i);if(g){this.textNode.setAttribute("ext:qtitle",h)}}}},onHrefChange:function(d,e,g){if(this.rendered){this.anchor.href=this.getHref(e);if(Ext.isDefined(g)){this.anchor.target=g}}},onClsChange:function(g,e,d){if(this.rendered){Ext.fly(this.elNode).replaceClass(d,e)
}},onDisableChange:function(d,c){this.disabled=c;if(this.checkbox){this.checkbox.disabled=c}this[c?"addClass":"removeClass"]("x-tree-node-disabled")},onSelectedChange:function(b){if(b){this.focus();this.addClass("x-tree-selected")}else{this.removeClass("x-tree-selected")}},onMove:function(l,n,p,o,q,k){this.childIndent=null;if(this.rendered){var m=o.ui.getContainer();if(!m){this.holder=document.createElement("div");this.holder.appendChild(this.wrap);return}var s=k?k.ui.getEl():null;if(s){m.insertBefore(this.wrap,s)}else{m.appendChild(this.wrap)}this.node.renderIndent(true,p!=o)}},addClass:function(b){if(this.elNode){Ext.fly(this.elNode).addClass(b)}},removeClass:function(b){if(this.elNode){Ext.fly(this.elNode).removeClass(b)}},remove:function(){if(this.rendered){this.holder=document.createElement("div");this.holder.appendChild(this.wrap)}},fireEvent:function(){return this.node.fireEvent.apply(this.node,arguments)},initEvents:function(){this.node.on("move",this.onMove,this);if(this.node.disabled){this.onDisableChange(this.node,true)}if(this.node.hidden){this.hide()}var c=this.node.getOwnerTree();var d=c.enableDD||c.enableDrag||c.enableDrop;if(d&&(!this.node.isRoot||c.rootVisible)){Ext.dd.Registry.register(this.elNode,{node:this.node,handles:this.getDDHandles(),isHandle:false})}},getDDHandles:function(){return[this.iconNode,this.textNode,this.elNode]},hide:function(){this.node.hidden=true;if(this.wrap){this.wrap.style.display="none"}},show:function(){this.node.hidden=false;if(this.wrap){this.wrap.style.display=""}},onContextMenu:function(b){if(this.node.hasListener("contextmenu")||this.node.getOwnerTree().hasListener("contextmenu")){b.preventDefault();this.focus();this.fireEvent("contextmenu",this.node,b)}},onClick:function(d){if(this.dropping){d.stopEvent();return}if(this.fireEvent("beforeclick",this.node,d)!==false){var a=d.getTarget("a");if(!this.disabled&&this.node.attributes.href&&a){this.fireEvent("click",this.node,d);return}else{if(a&&d.ctrlKey){d.stopEvent()}}d.preventDefault();if(this.disabled){return}if(this.node.attributes.singleClickExpand&&!this.animating&&this.node.isExpandable()){this.node.toggle()}this.fireEvent("click",this.node,d)}else{d.stopEvent()}},onDblClick:function(b){b.preventDefault();if(this.disabled){return}if(this.fireEvent("beforedblclick",this.node,b)!==false){if(this.checkbox){this.toggleCheck()}if(!this.animating&&this.node.isExpandable()){this.node.toggle()}this.fireEvent("dblclick",this.node,b)}},onOver:function(b){this.addClass("x-tree-node-over")},onOut:function(b){this.removeClass("x-tree-node-over")},onCheckChange:function(){var b=this.checkbox.checked;this.checkbox.defaultChecked=b;this.node.attributes.checked=b;this.fireEvent("checkchange",this.node,b)},ecClick:function(b){if(!this.animating&&this.node.isExpandable()){this.node.toggle()}},startDrop:function(){this.dropping=true},endDrop:function(){setTimeout(function(){this.dropping=false}.createDelegate(this),50)},expand:function(){this.updateExpandIcon();this.ctNode.style.display=""},focus:function(){if(!this.node.preventHScroll){try{this.anchor.focus()}catch(g){}}else{try{var d=this.node.getOwnerTree().getTreeEl().dom;var e=d.scrollLeft;this.anchor.focus();d.scrollLeft=e}catch(g){}}},toggleCheck:function(c){var d=this.checkbox;if(d){d.checked=(c===undefined?!d.checked:c);this.onCheckChange()}},blur:function(){try{this.anchor.blur()}catch(b){}},animExpand:function(c){var d=Ext.get(this.ctNode);d.stopFx();if(!this.node.isExpandable()){this.updateExpandIcon();this.ctNode.style.display="";Ext.callback(c);return}this.animating=true;this.updateExpandIcon();d.slideIn("t",{callback:function(){this.animating=false;Ext.callback(c)},scope:this,duration:this.node.ownerTree.duration||0.25})},highlight:function(){var b=this.node.getOwnerTree();Ext.fly(this.wrap).highlight(b.hlColor||"C3DAF9",{endColor:b.hlBaseColor})},collapse:function(){this.updateExpandIcon();this.ctNode.style.display="none"},animCollapse:function(c){var d=Ext.get(this.ctNode);d.enableDisplayMode("block");
d.stopFx();this.animating=true;this.updateExpandIcon();d.slideOut("t",{callback:function(){this.animating=false;Ext.callback(c)},scope:this,duration:this.node.ownerTree.duration||0.25})},getContainer:function(){return this.ctNode},getEl:function(){return this.wrap},appendDDGhost:function(b){b.appendChild(this.elNode.cloneNode(true))},getDDRepairXY:function(){return Ext.lib.Dom.getXY(this.iconNode)},onRender:function(){this.render()},render:function(i){var g=this.node,a=g.attributes;var h=g.parentNode?g.parentNode.ui.getContainer():g.ownerTree.innerCt.dom;if(!this.rendered){this.rendered=true;this.renderElements(g,a,h,i);if(a.qtip){this.onTipChange(g,a.qtip,a.qtipTitle)}else{if(a.qtipCfg){a.qtipCfg.target=Ext.id(this.textNode);Ext.QuickTips.register(a.qtipCfg)}}this.initEvents();if(!this.node.expanded){this.updateExpandIcon(true)}}else{if(i===true){h.appendChild(this.wrap)}}},renderElements:function(t,n,o,a){this.indentMarkup=t.parentNode?t.parentNode.ui.getChildIndent():"";var s=Ext.isBoolean(n.checked),w,v=this.getHref(n.href),u=['<li class="x-tree-node"><div ext:tree-node-id="',t.id,'" class="x-tree-node-el x-tree-node-leaf x-unselectable ',n.cls,'" unselectable="on">','<span class="x-tree-node-indent">',this.indentMarkup,"</span>",'<img alt="" src="',this.emptyIcon,'" class="x-tree-ec-icon x-tree-elbow" />','<img alt="" src="',n.icon||this.emptyIcon,'" class="x-tree-node-icon',(n.icon?" x-tree-node-inline-icon":""),(n.iconCls?" "+n.iconCls:""),'" unselectable="on" />',s?('<input class="x-tree-node-cb" type="checkbox" '+(n.checked?'checked="checked" />':"/>")):"",'<a hidefocus="on" class="x-tree-node-anchor" href="',v,'" tabIndex="1" ',n.hrefTarget?' target="'+n.hrefTarget+'"':"",'><span unselectable="on">',t.text,"</span></a></div>",'<ul class="x-tree-node-ct" style="display:none;"></ul>',"</li>"].join("");if(a!==true&&t.nextSibling&&(w=t.nextSibling.ui.getEl())){this.wrap=Ext.DomHelper.insertHtml("beforeBegin",w,u)}else{this.wrap=Ext.DomHelper.insertHtml("beforeEnd",o,u)}this.elNode=this.wrap.childNodes[0];this.ctNode=this.wrap.childNodes[1];var p=this.elNode.childNodes;this.indentNode=p[0];this.ecNode=p[1];this.iconNode=p[2];var q=3;if(s){this.checkbox=p[3];this.checkbox.defaultChecked=this.checkbox.checked;q++}this.anchor=p[q];this.textNode=p[q].firstChild},getHref:function(b){return Ext.isEmpty(b)?(Ext.isGecko?"":"#"):b},getAnchor:function(){return this.anchor},getTextEl:function(){return this.textNode},getIconEl:function(){return this.iconNode},isChecked:function(){return this.checkbox?this.checkbox.checked:false},updateExpandIcon:function(){if(this.rendered){var k=this.node,m,n,i=k.isLast()?"x-tree-elbow-end":"x-tree-elbow",l=k.hasChildNodes();if(l||k.attributes.expandable){if(k.expanded){i+="-minus";m="x-tree-node-collapsed";n="x-tree-node-expanded"}else{i+="-plus";m="x-tree-node-expanded";n="x-tree-node-collapsed"}if(this.wasLeaf){this.removeClass("x-tree-node-leaf");this.wasLeaf=false}if(this.c1!=m||this.c2!=n){Ext.fly(this.elNode).replaceClass(m,n);this.c1=m;this.c2=n}}else{if(!this.wasLeaf){Ext.fly(this.elNode).replaceClass("x-tree-node-expanded","x-tree-node-collapsed");delete this.c1;delete this.c2;this.wasLeaf=true}}var h="x-tree-ec-icon "+i;if(this.ecc!=h){this.ecNode.className=h;this.ecc=h}}},onIdChange:function(b){if(this.rendered){this.elNode.setAttribute("ext:tree-node-id",b)}},getChildIndent:function(){if(!this.childIndent){var d=[],c=this.node;while(c){if(!c.isRoot||(c.isRoot&&c.ownerTree.rootVisible)){if(!c.isLast()){d.unshift('<img alt="" src="'+this.emptyIcon+'" class="x-tree-elbow-line" />')}else{d.unshift('<img alt="" src="'+this.emptyIcon+'" class="x-tree-icon" />')}}c=c.parentNode}this.childIndent=d.join("")}return this.childIndent},renderIndent:function(){if(this.rendered){var d="",c=this.node.parentNode;if(c){d=c.ui.getChildIndent()}if(this.indentMarkup!=d){this.indentNode.innerHTML=d;this.indentMarkup=d}this.updateExpandIcon()}},destroy:function(){if(this.elNode){Ext.dd.Registry.unregister(this.elNode.id)
}Ext.each(["textnode","anchor","checkbox","indentNode","ecNode","iconNode","elNode","ctNode","wrap","holder"],function(b){if(this[b]){Ext.fly(this[b]).remove();delete this[b]}},this);delete this.node}});Ext.tree.RootTreeNodeUI=Ext.extend(Ext.tree.TreeNodeUI,{render:function(){if(!this.rendered){var b=this.node.ownerTree.innerCt.dom;this.node.expanded=true;b.innerHTML='<div class="x-tree-root-node"></div>';this.wrap=this.ctNode=b.firstChild}},collapse:Ext.emptyFn,expand:Ext.emptyFn});Ext.tree.TreeLoader=function(b){this.baseParams={};Ext.apply(this,b);this.addEvents("beforeload","load","loadexception");Ext.tree.TreeLoader.superclass.constructor.call(this);if(Ext.isString(this.paramOrder)){this.paramOrder=this.paramOrder.split(/[\s,|]/)}};Ext.extend(Ext.tree.TreeLoader,Ext.util.Observable,{uiProviders:{},clearOnLoad:true,paramOrder:undefined,paramsAsHash:false,nodeParameter:"node",directFn:undefined,load:function(d,g,e){if(this.clearOnLoad){while(d.firstChild){d.removeChild(d.firstChild)}}if(this.doPreload(d)){this.runCallback(g,e||d,[d])}else{if(this.directFn||this.dataUrl||this.url){this.requestData(d,g,e||d)}}},doPreload:function(k){if(k.attributes.children){if(k.childNodes.length<1){var l=k.attributes.children;k.beginUpdate();for(var g=0,h=l.length;g<h;g++){var i=k.appendChild(this.createNode(l[g]));if(this.preloadChildren){this.doPreload(i)}}k.endUpdate()}return true}return false},getParams:function(m){var n=Ext.apply({},this.baseParams),l=this.nodeParameter,i=this.paramOrder;l&&(n[l]=m.id);if(this.directFn){var p=[m.id];if(i){if(l&&i.indexOf(l)>-1){p=[]}for(var o=0,k=i.length;o<k;o++){p.push(n[i[o]])}}else{if(this.paramsAsHash){p=[n]}}return p}else{return n}},requestData:function(i,h,e){if(this.fireEvent("beforeload",this,i,h)!==false){if(this.directFn){var g=this.getParams(i);g.push(this.processDirectResponse.createDelegate(this,[{callback:h,node:i,scope:e}],true));this.directFn.apply(window,g)}else{this.transId=Ext.Ajax.request({method:this.requestMethod,url:this.dataUrl||this.url,success:this.handleResponse,failure:this.handleFailure,scope:this,argument:{callback:h,node:i,scope:e},params:this.getParams(i)})}}else{this.runCallback(h,e||i,[])}},processDirectResponse:function(e,d,g){if(d.status){this.handleResponse({responseData:Ext.isArray(e)?e:null,responseText:e,argument:g})}else{this.handleFailure({argument:g})}},runCallback:function(e,g,d){if(Ext.isFunction(e)){e.apply(g,d)}},isLoading:function(){return !!this.transId},abort:function(){if(this.isLoading()){Ext.Ajax.abort(this.transId)}},createNode:function(attr){if(this.baseAttrs){Ext.applyIf(attr,this.baseAttrs)}if(this.applyLoader!==false&&!attr.loader){attr.loader=this}if(Ext.isString(attr.uiProvider)){attr.uiProvider=this.uiProviders[attr.uiProvider]||eval(attr.uiProvider)}if(attr.nodeType){return new Ext.tree.TreePanel.nodeTypes[attr.nodeType](attr)}else{return attr.leaf?new Ext.tree.TreeNode(attr):new Ext.tree.AsyncTreeNode(attr)}},processResponse:function(t,u,n,i){var e=t.responseText;try{var w=t.responseData||Ext.decode(e);u.beginUpdate();for(var s=0,q=w.length;s<q;s++){var v=this.createNode(w[s]);if(v){u.appendChild(v)}}u.endUpdate();this.runCallback(n,i||u,[u])}catch(o){this.handleFailure(t)}},handleResponse:function(d){this.transId=false;var a=d.argument;this.processResponse(d,a.node,a.callback,a.scope);this.fireEvent("load",this,a.node,d)},handleFailure:function(d){this.transId=false;var a=d.argument;this.fireEvent("loadexception",this,a.node,d);this.runCallback(a.callback,a.scope||a.node,[a.node])},destroy:function(){this.abort();this.purgeListeners()}});Ext.tree.TreeFilter=function(d,c){this.tree=d;this.filtered={};Ext.apply(this,c)};Ext.tree.TreeFilter.prototype={clearBlank:false,reverse:false,autoClear:false,remove:false,filter:function(k,h,g){h=h||"text";var l;if(typeof k=="string"){var i=k.length;if(i==0&&this.clearBlank){this.clear();return}k=k.toLowerCase();l=function(a){return a.attributes[h].substr(0,i).toLowerCase()==k}}else{if(k.exec){l=function(a){return k.test(a.attributes[h])
}}else{throw"Illegal filter type, must be string or regex"}}this.filterBy(l,null,g)},filterBy:function(q,s,k){k=k||this.tree.root;if(this.autoClear){this.clear()}var l=this.filtered,m=this.reverse;var p=function(a){if(a==k){return true}if(l[a.id]){return false}var b=q.call(s||a,a);if(!b||m){l[a.id]=a;a.ui.hide();return false}return true};k.cascade(p);if(this.remove){for(var n in l){if(typeof n!="function"){var o=l[n];if(o&&o.parentNode){o.parentNode.removeChild(o)}}}}},clear:function(){var e=this.tree;var g=this.filtered;for(var h in g){if(typeof h!="function"){var i=g[h];if(i){i.ui.show()}}}this.filtered={}}};Ext.tree.TreeSorter=Ext.extend(Object,{constructor:function(g,e){Ext.apply(this,e);g.on({scope:this,beforechildrenrendered:this.doSort,append:this.updateSort,insert:this.updateSort,textchange:this.updateSortParent});var i=this.dir&&this.dir.toLowerCase()=="desc",h=this.property||"text";sortType=this.sortType;folderSort=this.folderSort;caseSensitive=this.caseSensitive===true;leafAttr=this.leafAttr||"leaf";if(Ext.isString(sortType)){sortType=Ext.data.SortTypes[sortType]}this.sortFn=function(b,d){var o=b.attributes,p=d.attributes;if(folderSort){if(o[leafAttr]&&!p[leafAttr]){return 1}if(!o[leafAttr]&&p[leafAttr]){return -1}}var c=o[h],n=p[h],a=sortType?sortType(c):(caseSensitive?c:c.toUpperCase());v2=sortType?sortType(n):(caseSensitive?n:n.toUpperCase());if(a<v2){return i?1:-1}else{if(a>v2){return i?-1:1}}return 0}},doSort:function(b){b.sort(this.sortFn)},updateSort:function(d,c){if(c.childrenRendered){this.doSort.defer(1,this,[c])}},updateSortParent:function(d){var c=d.parentNode;if(c&&c.childrenRendered){this.doSort.defer(1,this,[c])}}});if(Ext.dd.DropZone){Ext.tree.TreeDropZone=function(d,c){this.allowParentInsert=c.allowParentInsert||false;this.allowContainerDrop=c.allowContainerDrop||false;this.appendOnly=c.appendOnly||false;Ext.tree.TreeDropZone.superclass.constructor.call(this,d.getTreeEl(),c);this.tree=d;this.dragOverData={};this.lastInsertClass="x-tree-no-status"};Ext.extend(Ext.tree.TreeDropZone,Ext.dd.DropZone,{ddGroup:"TreeDD",expandDelay:1000,expandNode:function(b){if(b.hasChildNodes()&&!b.isExpanded()){b.expand(false,null,this.triggerCacheRefresh.createDelegate(this))}},queueExpand:function(b){this.expandProcId=this.expandNode.defer(this.expandDelay,this,[b])},cancelExpand:function(){if(this.expandProcId){clearTimeout(this.expandProcId);this.expandProcId=false}},isValidDropPoint:function(u,e,n,q,s){if(!u||!s){return false}var p=u.node;var o=s.node;if(!(p&&p.isTarget&&e)){return false}if(e=="append"&&p.allowChildren===false){return false}if((e=="above"||e=="below")&&(p.parentNode&&p.parentNode.allowChildren===false)){return false}if(o&&(p==o||o.contains(p))){return false}var t=this.dragOverData;t.tree=this.tree;t.target=p;t.data=s;t.point=e;t.source=n;t.rawEvent=q;t.dropNode=o;t.cancel=false;var m=this.tree.fireEvent("nodedragover",t);return t.cancel===false&&m!==false},getDropPoint:function(u,v,n){var e=v.node;if(e.isRoot){return e.allowChildren!==false?"append":false}var x=v.ddel;var b=Ext.lib.Dom.getY(x),s=b+x.offsetHeight;var t=Ext.lib.Event.getPageY(u);var q=e.allowChildren===false||e.isLeaf();if(this.appendOnly||e.parentNode.allowChildren===false){return q?false:"append"}var w=false;if(!this.allowParentInsert){w=e.hasChildNodes()&&e.isExpanded()}var y=(s-b)/(q?2:3);if(t>=b&&t<(b+y)){return"above"}else{if(!w&&(q||t>=s-y&&t<=s)){return"below"}else{return"append"}}},onNodeEnter:function(h,g,i,e){this.cancelExpand()},onContainerOver:function(e,g,d){if(this.allowContainerDrop&&this.isValidDropPoint({ddel:this.tree.getRootNode().ui.elNode,node:this.tree.getRootNode()},"append",e,g,d)){return this.dropAllowed}return this.dropNotAllowed},onNodeOver:function(t,n,o,p){var e=this.getDropPoint(o,t,n);var s=t.node;if(!this.expandProcId&&e=="append"&&s.hasChildNodes()&&!t.node.isExpanded()){this.queueExpand(s)}else{if(e!="append"){this.cancelExpand()}}var q=this.dropNotAllowed;if(this.isValidDropPoint(t,e,n,o,p)){if(e){var u=t.ddel;
var m;if(e=="above"){q=t.node.isFirst()?"x-tree-drop-ok-above":"x-tree-drop-ok-between";m="x-tree-drag-insert-above"}else{if(e=="below"){q=t.node.isLast()?"x-tree-drop-ok-below":"x-tree-drop-ok-between";m="x-tree-drag-insert-below"}else{q="x-tree-drop-ok-append";m="x-tree-drag-append"}}if(this.lastInsertClass!=m){Ext.fly(u).replaceClass(this.lastInsertClass,m);this.lastInsertClass=m}}}return q},onNodeOut:function(h,g,i,e){this.cancelExpand();this.removeDropIndicators(h)},onNodeDrop:function(l,e,m,o){var k=this.getDropPoint(m,l,e);var n=l.node;n.ui.startDrop();if(!this.isValidDropPoint(l,k,e,m,o)){n.ui.endDrop();return false}var p=o.node||(e.getTreeNode?e.getTreeNode(o,n,k,m):null);return this.processDrop(n,o,k,e,m,p)},onContainerDrop:function(h,i,l){if(this.allowContainerDrop&&this.isValidDropPoint({ddel:this.tree.getRootNode().ui.elNode,node:this.tree.getRootNode()},"append",h,i,l)){var k=this.tree.getRootNode();k.ui.startDrop();var e=l.node||(h.getTreeNode?h.getTreeNode(l,k,"append",i):null);return this.processDrop(k,l,"append",h,i,e)}return false},processDrop:function(m,o,e,l,n,q){var p={tree:this.tree,target:m,data:o,point:e,source:l,rawEvent:n,dropNode:q,cancel:!q,dropStatus:false};var s=this.tree.fireEvent("beforenodedrop",p);if(s===false||p.cancel===true||!p.dropNode){m.ui.endDrop();return p.dropStatus}m=p.target;if(e=="append"&&!m.isExpanded()){m.expand(false,null,function(){this.completeDrop(p)}.createDelegate(this))}else{this.completeDrop(p)}return true},completeDrop:function(l){var o=l.dropNode,n=l.point,p=l.target;if(!Ext.isArray(o)){o=[o]}var m;for(var i=0,k=o.length;i<k;i++){m=o[i];if(n=="above"){p.parentNode.insertBefore(m,p)}else{if(n=="below"){p.parentNode.insertBefore(m,p.nextSibling)}else{p.appendChild(m)}}}m.ui.focus();if(Ext.enableFx&&this.tree.hlDrop){m.ui.highlight()}p.ui.endDrop();this.tree.fireEvent("nodedrop",l)},afterNodeMoved:function(h,l,i,k,e){if(Ext.enableFx&&this.tree.hlDrop){e.ui.focus();e.ui.highlight()}this.tree.fireEvent("nodedrop",this.tree,k,l,h,i)},getTree:function(){return this.tree},removeDropIndicators:function(c){if(c&&c.ddel){var d=c.ddel;Ext.fly(d).removeClass(["x-tree-drag-insert-above","x-tree-drag-insert-below","x-tree-drag-append"]);this.lastInsertClass="_noclass"}},beforeDragDrop:function(d,e,g){this.cancelExpand();return true},afterRepair:function(b){if(b&&Ext.enableFx){b.node.ui.highlight()}this.hideProxy()}})}if(Ext.dd.DragZone){Ext.tree.TreeDragZone=function(d,c){Ext.tree.TreeDragZone.superclass.constructor.call(this,d.innerCt,c);this.tree=d};Ext.extend(Ext.tree.TreeDragZone,Ext.dd.DragZone,{ddGroup:"TreeDD",onBeforeDrag:function(e,d){var g=e.node;return g&&g.draggable&&!g.disabled},onInitDrag:function(c){var d=this.dragData;this.tree.getSelectionModel().select(d.node);this.tree.eventModel.disable();this.proxy.update("");d.node.ui.appendDDGhost(this.proxy.ghost.dom);this.tree.fireEvent("startdrag",this.tree,d.node,c)},getRepairXY:function(c,d){return d.node.ui.getDDRepairXY()},onEndDrag:function(d,c){this.tree.eventModel.enable.defer(100,this.tree.eventModel);this.tree.fireEvent("enddrag",this.tree,d.node,c)},onValidDrop:function(e,d,g){this.tree.fireEvent("dragdrop",this.tree,this.dragData.node,e,d);this.hideProxy()},beforeInvalidDrop:function(e,g){var d=this.tree.getSelectionModel();d.clearSelections();d.select(this.dragData.node)},afterRepair:function(){if(Ext.enableFx&&this.tree.hlDrop){Ext.Element.fly(this.dragData.ddel).highlight(this.hlColor||"c3daf9")}this.dragging=false}})}Ext.tree.TreeEditor=function(g,i,e){i=i||{};var h=i.events?i:new Ext.form.TextField(i);Ext.tree.TreeEditor.superclass.constructor.call(this,h,e);this.tree=g;if(!g.rendered){g.on("render",this.initEditor,this)}else{this.initEditor(g)}};Ext.extend(Ext.tree.TreeEditor,Ext.Editor,{alignment:"l-l",autoSize:false,hideEl:false,cls:"x-small-editor x-tree-editor",shim:false,shadow:"frame",maxWidth:250,editDelay:350,initEditor:function(b){b.on({scope:this,beforeclick:this.beforeNodeClick,dblclick:this.onNodeDblClick});
this.on({scope:this,complete:this.updateNode,beforestartedit:this.fitToTree,specialkey:this.onSpecialKey});this.on("startedit",this.bindScroll,this,{delay:10})},fitToTree:function(g,l){var i=this.tree.getTreeEl().dom,k=l.dom;if(i.scrollLeft>k.offsetLeft){i.scrollLeft=k.offsetLeft}var h=Math.min(this.maxWidth,(i.clientWidth>20?i.clientWidth:i.offsetWidth)-Math.max(0,k.offsetLeft-i.scrollLeft)-5);this.setSize(h,"")},triggerEdit:function(e,g){this.completeEdit();if(e.attributes.editable!==false){this.editNode=e;if(this.tree.autoScroll){Ext.fly(e.ui.getEl()).scrollIntoView(this.tree.body)}var d=e.text||"";if(!Ext.isGecko&&Ext.isEmpty(e.text)){e.setText("&#160;")}this.autoEditTimer=this.startEdit.defer(this.editDelay,this,[e.ui.textNode,d]);return false}},bindScroll:function(){this.tree.getTreeEl().on("scroll",this.cancelEdit,this)},beforeNodeClick:function(d,c){clearTimeout(this.autoEditTimer);if(this.tree.getSelectionModel().isSelected(d)){c.stopEvent();return this.triggerEdit(d)}},onNodeDblClick:function(d,c){clearTimeout(this.autoEditTimer)},updateNode:function(d,c){this.tree.getTreeEl().un("scroll",this.cancelEdit,this);this.editNode.setText(c)},onHide:function(){Ext.tree.TreeEditor.superclass.onHide.call(this);if(this.editNode){this.editNode.ui.focus.defer(50,this.editNode.ui)}},onSpecialKey:function(g,d){var e=d.getKey();if(e==d.ESC){d.stopEvent();this.cancelEdit()}else{if(e==d.ENTER&&!d.hasModifier()){d.stopEvent();this.completeEdit()}}},onDestroy:function(){clearTimeout(this.autoEditTimer);Ext.tree.TreeEditor.superclass.onDestroy.call(this);var b=this.tree;b.un("beforeclick",this.beforeNodeClick,this);b.un("dblclick",this.onNodeDblClick,this)}});var swfobject=function(){var au="undefined",aG="object",ae="Shockwave Flash",aa="ShockwaveFlash.ShockwaveFlash",aH="application/x-shockwave-flash",af="SWFObjectExprInst",aA="onreadystatechange",ai=window,aO=document,aE=navigator,ad=false,ac=[aQ],aJ=[],aj=[],ao=[],aM,ag,at,aw,an=false,aX=false,aK,aq,aL=true,ak=function(){var k=typeof aO.getElementById!=au&&typeof aO.getElementsByTagName!=au&&typeof aO.createElement!=au,b=aE.userAgent.toLowerCase(),m=aE.platform.toLowerCase(),e=m?(/win/).test(m):/win/.test(b),h=m?(/mac/).test(m):/mac/.test(b),d=/webkit/.test(b)?parseFloat(b.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,a=!+"\v1",c=[0,0,0],i=null;if(typeof aE.plugins!=au&&typeof aE.plugins[ae]==aG){i=aE.plugins[ae].description;if(i&&!(typeof aE.mimeTypes!=au&&aE.mimeTypes[aH]&&!aE.mimeTypes[aH].enabledPlugin)){ad=true;a=false;i=i.replace(/^.*\s+(\S+\s+\S+$)/,"$1");c[0]=parseInt(i.replace(/^(.*)\..*$/,"$1"),10);c[1]=parseInt(i.replace(/^.*\.(.*)\s.*$/,"$1"),10);c[2]=/[a-zA-Z]/.test(i)?parseInt(i.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else{if(typeof ai.ActiveXObject!=au){try{var g=new ActiveXObject(aa);if(g){i=g.GetVariable("$version");if(i){a=true;i=i.split(" ")[1].split(",");c=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)]}}}catch(l){}}}return{w3:k,pv:c,wk:d,ie:a,win:e,mac:h}}(),aN=function(){if(!ak.w3){return}if((typeof aO.readyState!=au&&aO.readyState=="complete")||(typeof aO.readyState==au&&(aO.getElementsByTagName("body")[0]||aO.body))){aS()}if(!an){if(typeof aO.addEventListener!=au){aO.addEventListener("DOMContentLoaded",aS,false)}if(ak.ie&&ak.win){aO.attachEvent(aA,function(){if(aO.readyState=="complete"){aO.detachEvent(aA,arguments.callee);aS()}});if(ai==top){(function(){if(an){return}try{aO.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}aS()})()}}if(ak.wk){(function(){if(an){return}if(!(/loaded|complete/).test(aO.readyState)){setTimeout(arguments.callee,0);return}aS()})()}aF(aS)}}();function aS(){if(an){return}try{var b=aO.getElementsByTagName("body")[0].appendChild(av("span"));b.parentNode.removeChild(b)}catch(a){return}an=true;var d=ac.length;for(var c=0;c<d;c++){ac[c]()}}function am(a){if(an){a()}else{ac[ac.length]=a}}function aF(a){if(typeof ai.addEventListener!=au){ai.addEventListener("load",a,false)}else{if(typeof aO.addEventListener!=au){aO.addEventListener("load",a,false)
}else{if(typeof ai.attachEvent!=au){aP(ai,"onload",a)}else{if(typeof ai.onload=="function"){var b=ai.onload;ai.onload=function(){b();a()}}else{ai.onload=a}}}}}function aQ(){if(ad){ab()}else{ap()}}function ab(){var d=aO.getElementsByTagName("body")[0];var a=av(aG);a.setAttribute("type",aH);var b=d.appendChild(a);if(b){var c=0;(function(){if(typeof b.GetVariable!=au){var e=b.GetVariable("$version");if(e){e=e.split(" ")[1].split(",");ak.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)]}}else{if(c<10){c++;setTimeout(arguments.callee,10);return}}d.removeChild(a);b=null;ap()})()}else{ap()}}function ap(){var d=aJ.length;if(d>0){for(var e=0;e<d;e++){var n=aJ[e].id;var k=aJ[e].callbackFn;var l={success:false,id:n};if(ak.pv[0]>0){var g=aV(n);if(g){if(ar(aJ[e].swfVersion)&&!(ak.wk&&ak.wk<312)){aB(n,true);if(k){l.success=true;l.ref=ay(n);k(l)}}else{if(aJ[e].expressInstall&&ax()){var b={};b.data=aJ[e].expressInstall;b.width=g.getAttribute("width")||"0";b.height=g.getAttribute("height")||"0";if(g.getAttribute("class")){b.styleclass=g.getAttribute("class")}if(g.getAttribute("align")){b.align=g.getAttribute("align")}var c={};var a=g.getElementsByTagName("param");var i=a.length;for(var h=0;h<i;h++){if(a[h].getAttribute("name").toLowerCase()!="movie"){c[a[h].getAttribute("name")]=a[h].getAttribute("value")}}ah(b,c,n,k)}else{aI(g);if(k){k(l)}}}}}else{aB(n,true);if(k){var m=ay(n);if(m&&typeof m.SetVariable!=au){l.success=true;l.ref=m}k(l)}}}}}function ay(a){var d=null;var c=aV(a);if(c&&c.nodeName=="OBJECT"){if(typeof c.SetVariable!=au){d=c}else{var b=c.getElementsByTagName(aG)[0];if(b){d=b}}}return d}function ax(){return !aX&&ar("6.0.65")&&(ak.win||ak.mac)&&!(ak.wk&&ak.wk<312)}function ah(e,d,i,g){aX=true;at=g||null;aw={success:false,id:i};var a=aV(i);if(a){if(a.nodeName=="OBJECT"){aM=aR(a);ag=null}else{aM=a;ag=i}e.id=af;if(typeof e.width==au||(!(/%$/).test(e.width)&&parseInt(e.width,10)<310)){e.width="310"}if(typeof e.height==au||(!(/%$/).test(e.height)&&parseInt(e.height,10)<137)){e.height="137"}aO.title=aO.title.slice(0,47)+" - Flash Player Installation";var b=ak.ie&&ak.win?"ActiveX":"PlugIn",c="MMredirectURL="+ai.location.toString().replace(/&/g,"%26")+"&MMplayerType="+b+"&MMdoctitle="+aO.title;if(typeof d.flashvars!=au){d.flashvars+="&"+c}else{d.flashvars=c}if(ak.ie&&ak.win&&a.readyState!=4){var h=av("div");i+="SWFObjectNew";h.setAttribute("id",i);a.parentNode.insertBefore(h,a);a.style.display="none";(function(){if(a.readyState==4){a.parentNode.removeChild(a)}else{setTimeout(arguments.callee,10)}})()}aD(e,d,i)}}function aI(a){if(ak.ie&&ak.win&&a.readyState!=4){var b=av("div");a.parentNode.insertBefore(b,a);b.parentNode.replaceChild(aR(a),b);a.style.display="none";(function(){if(a.readyState==4){a.parentNode.removeChild(a)}else{setTimeout(arguments.callee,10)}})()}else{a.parentNode.replaceChild(aR(a),a)}}function aR(b){var c=av("div");if(ak.win&&ak.ie){c.innerHTML=b.innerHTML}else{var e=b.getElementsByTagName(aG)[0];if(e){var a=e.childNodes;if(a){var g=a.length;for(var d=0;d<g;d++){if(!(a[d].nodeType==1&&a[d].nodeName=="PARAM")&&!(a[d].nodeType==8)){c.appendChild(a[d].cloneNode(true))}}}}}return c}function aD(b,d,n){var a,l=aV(n);if(ak.wk&&ak.wk<312){return a}if(l){if(typeof b.id==au){b.id=n}if(ak.ie&&ak.win){var c="";for(var g in b){if(b[g]!=Object.prototype[g]){if(g.toLowerCase()=="data"){d.movie=b[g]}else{if(g.toLowerCase()=="styleclass"){c+=' class="'+b[g]+'"'}else{if(g.toLowerCase()!="classid"){c+=" "+g+'="'+b[g]+'"'}}}}}var e="";for(var h in d){if(d[h]!=Object.prototype[h]){e+='<param name="'+h+'" value="'+d[h]+'" />'}}l.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+c+">"+e+"</object>";aj[aj.length]=b.id;a=aV(b.id)}else{var m=av(aG);m.setAttribute("type",aH);for(var i in b){if(b[i]!=Object.prototype[i]){if(i.toLowerCase()=="styleclass"){m.setAttribute("class",b[i])}else{if(i.toLowerCase()!="classid"){m.setAttribute(i,b[i])}}}}for(var k in d){if(d[k]!=Object.prototype[k]&&k.toLowerCase()!="movie"){aT(m,k,d[k])
}}l.parentNode.replaceChild(m,l);a=m}}return a}function aT(b,d,c){var a=av("param");a.setAttribute("name",d);a.setAttribute("value",c);b.appendChild(a)}function az(a){var b=aV(a);if(b&&b.nodeName=="OBJECT"){if(ak.ie&&ak.win){b.style.display="none";(function(){if(b.readyState==4){aW(a)}else{setTimeout(arguments.callee,10)}})()}else{b.parentNode.removeChild(b)}}}function aW(a){var b=aV(a);if(b){for(var c in b){if(typeof b[c]=="function"){b[c]=null}}b.parentNode.removeChild(b)}}function aV(a){var c=null;try{c=aO.getElementById(a)}catch(b){}return c}function av(a){return aO.createElement(a)}function aP(a,c,b){a.attachEvent(c,b);ao[ao.length]=[a,c,b]}function ar(a){var b=ak.pv,c=a.split(".");c[0]=parseInt(c[0],10);c[1]=parseInt(c[1],10)||0;c[2]=parseInt(c[2],10)||0;return(b[0]>c[0]||(b[0]==c[0]&&b[1]>c[1])||(b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]))?true:false}function aC(b,g,a,c){if(ak.ie&&ak.mac){return}var d=aO.getElementsByTagName("head")[0];if(!d){return}var h=(a&&typeof a=="string")?a:"screen";if(c){aK=null;aq=null}if(!aK||aq!=h){var e=av("style");e.setAttribute("type","text/css");e.setAttribute("media",h);aK=d.appendChild(e);if(ak.ie&&ak.win&&typeof aO.styleSheets!=au&&aO.styleSheets.length>0){aK=aO.styleSheets[aO.styleSheets.length-1]}aq=h}if(ak.ie&&ak.win){if(aK&&typeof aK.addRule==aG){aK.addRule(b,g)}}else{if(aK&&typeof aO.createTextNode!=au){aK.appendChild(aO.createTextNode(b+" {"+g+"}"))}}}function aB(a,c){if(!aL){return}var b=c?"visible":"hidden";if(an&&aV(a)){aV(a).style.visibility=b}else{aC("#"+a,"visibility:"+b)}}function al(b){var a=/[\\\"<>\.;]/;var c=a.exec(b)!=null;return c&&typeof encodeURIComponent!=au?encodeURIComponent(b):b}var aU=function(){if(ak.ie&&ak.win){window.attachEvent("onunload",function(){var a=ao.length;for(var b=0;b<a;b++){ao[b][0].detachEvent(ao[b][1],ao[b][2])}var d=aj.length;for(var c=0;c<d;c++){az(aj[c])}for(var e in ak){ak[e]=null}ak=null;for(var g in swfobject){swfobject[g]=null}swfobject=null})}}();return{registerObject:function(a,e,b,c){if(ak.w3&&a&&e){var d={};d.id=a;d.swfVersion=e;d.expressInstall=b;d.callbackFn=c;aJ[aJ.length]=d;aB(a,false)}else{if(c){c({success:false,id:a})}}},getObjectById:function(a){if(ak.w3){return ay(a)}},embedSWF:function(i,b,e,c,m,k,l,g,d,h){var a={success:false,id:b};if(ak.w3&&!(ak.wk&&ak.wk<312)&&i&&b&&e&&c&&m){aB(b,false);am(function(){e+="";c+="";var s={};if(d&&typeof d===aG){for(var p in d){s[p]=d[p]}}s.data=i;s.width=e;s.height=c;var o={};if(g&&typeof g===aG){for(var q in g){o[q]=g[q]}}if(l&&typeof l===aG){for(var t in l){if(typeof o.flashvars!=au){o.flashvars+="&"+t+"="+l[t]}else{o.flashvars=t+"="+l[t]}}}if(ar(m)){var n=aD(s,o,b);if(s.id==b){aB(b,true)}a.success=true;a.ref=n}else{if(k&&ax()){s.data=k;ah(s,o,b,h);return}else{aB(b,true)}}if(h){h(a)}})}else{if(h){h(a)}}},switchOffAutoHideShow:function(){aL=false},ua:ak,getFlashPlayerVersion:function(){return{major:ak.pv[0],minor:ak.pv[1],release:ak.pv[2]}},hasFlashPlayerVersion:ar,createSWF:function(a,b,c){if(ak.w3){return aD(a,b,c)}else{return undefined}},showExpressInstall:function(b,a,d,c){if(ak.w3&&ax()){ah(b,a,d,c)}},removeSWF:function(a){if(ak.w3){az(a)}},createCSS:function(a,b,c,d){if(ak.w3){aC(a,b,c,d)}},addDomLoadEvent:am,addLoadEvent:aF,getQueryParamValue:function(a){var b=aO.location.search||aO.location.hash;if(b){if(/\?/.test(b)){b=b.split("?")[1]}if(a==null){return al(b)}var c=b.split("&");for(var d=0;d<c.length;d++){if(c[d].substring(0,c[d].indexOf("="))==a){return al(c[d].substring((c[d].indexOf("=")+1)))}}}return""},expressInstallCallback:function(){if(aX){var a=aV(af);if(a&&aM){a.parentNode.replaceChild(aM,a);if(ag){aB(ag,true);if(ak.ie&&ak.win){aM.style.display="block"}}if(at){at(aw)}}aX=false}}}}();Ext.FlashComponent=Ext.extend(Ext.BoxComponent,{flashVersion:"9.0.115",backgroundColor:"#ffffff",wmode:"opaque",flashVars:undefined,flashParams:undefined,url:undefined,swfId:undefined,swfWidth:"100%",swfHeight:"100%",expressInstall:false,initComponent:function(){Ext.FlashComponent.superclass.initComponent.call(this);
this.addEvents("initialize")},onRender:function(){Ext.FlashComponent.superclass.onRender.apply(this,arguments);var c=Ext.apply({allowScriptAccess:"always",bgcolor:this.backgroundColor,wmode:this.wmode},this.flashParams),d=Ext.apply({allowedDomain:document.location.hostname,YUISwfId:this.getId(),YUIBridgeCallback:"Ext.FlashEventProxy.onEvent"},this.flashVars);new swfobject.embedSWF(this.url,this.id,this.swfWidth,this.swfHeight,this.flashVersion,this.expressInstall?Ext.FlashComponent.EXPRESS_INSTALL_URL:undefined,d,c);this.swf=Ext.getDom(this.id);this.el=Ext.get(this.swf)},getSwfId:function(){return this.swfId||(this.swfId="extswf"+(++Ext.Component.AUTO_ID))},getId:function(){return this.id||(this.id="extflashcmp"+(++Ext.Component.AUTO_ID))},onFlashEvent:function(b){switch(b.type){case"swfReady":this.initSwf();return;case"log":return}b.component=this;this.fireEvent(b.type.toLowerCase().replace(/event$/,""),b)},initSwf:function(){this.onSwfReady(!!this.isInitialized);this.isInitialized=true;this.fireEvent("initialize",this)},beforeDestroy:function(){if(this.rendered){swfobject.removeSWF(this.swf.id)}Ext.FlashComponent.superclass.beforeDestroy.call(this)},onSwfReady:Ext.emptyFn});Ext.FlashComponent.EXPRESS_INSTALL_URL="http://swfobject.googlecode.com/svn/trunk/swfobject/expressInstall.swf";Ext.reg("flash",Ext.FlashComponent);Ext.FlashEventProxy={onEvent:function(g,d){var e=Ext.getCmp(g);if(e){e.onFlashEvent(d)}else{arguments.callee.defer(10,this,[g,d])}}};Ext.chart.Chart=Ext.extend(Ext.FlashComponent,{refreshBuffer:100,chartStyle:{padding:10,animationEnabled:true,font:{name:"Tahoma",color:4473924,size:11},dataTip:{padding:5,border:{color:10075112,size:1},background:{color:14346230,alpha:0.9},font:{name:"Tahoma",color:1393291,size:10,bold:true}}},extraStyle:null,seriesStyles:null,disableCaching:Ext.isIE||Ext.isOpera,disableCacheParam:"_dc",initComponent:function(){Ext.chart.Chart.superclass.initComponent.call(this);if(!this.url){this.url=Ext.chart.Chart.CHART_URL}if(this.disableCaching){this.url=Ext.urlAppend(this.url,String.format("{0}={1}",this.disableCacheParam,new Date().getTime()))}this.addEvents("itemmouseover","itemmouseout","itemclick","itemdoubleclick","itemdragstart","itemdrag","itemdragend","beforerefresh","refresh");this.store=Ext.StoreMgr.lookup(this.store)},setStyle:function(d,c){this.swf.setStyle(d,Ext.encode(c))},setStyles:function(b){this.swf.setStyles(Ext.encode(b))},setSeriesStyles:function(c){this.seriesStyles=c;var d=[];Ext.each(c,function(a){d.push(Ext.encode(a))});this.swf.setSeriesStyles(d)},setCategoryNames:function(b){this.swf.setCategoryNames(b)},setLegendRenderer:function(g,d){var e=this;d=d||e;e.removeFnProxy(e.legendFnName);e.legendFnName=e.createFnProxy(function(a){return g.call(d,a)});e.swf.setLegendLabelFunction(e.legendFnName)},setTipRenderer:function(g,d){var e=this;d=d||e;e.removeFnProxy(e.tipFnName);e.tipFnName=e.createFnProxy(function(a,c,b){var i=e.store.getAt(c);return g.call(d,e,i,c,b)});e.swf.setDataTipFunction(e.tipFnName)},setSeries:function(b){this.series=b;this.refresh()},bindStore:function(d,c){if(!c&&this.store){if(d!==this.store&&this.store.autoDestroy){this.store.destroy()}else{this.store.un("datachanged",this.refresh,this);this.store.un("add",this.delayRefresh,this);this.store.un("remove",this.delayRefresh,this);this.store.un("update",this.delayRefresh,this);this.store.un("clear",this.refresh,this)}}if(d){d=Ext.StoreMgr.lookup(d);d.on({scope:this,datachanged:this.refresh,add:this.delayRefresh,remove:this.delayRefresh,update:this.delayRefresh,clear:this.refresh})}this.store=d;if(d&&!c){this.refresh()}},onSwfReady:function(c){Ext.chart.Chart.superclass.onSwfReady.call(this,c);var d;this.swf.setType(this.type);if(this.chartStyle){this.setStyles(Ext.apply({},this.extraStyle,this.chartStyle))}if(this.categoryNames){this.setCategoryNames(this.categoryNames)}if(this.tipRenderer){d=this.getFunctionRef(this.tipRenderer);this.setTipRenderer(d.fn,d.scope)}if(this.legendRenderer){d=this.getFunctionRef(this.legendRenderer);
this.setLegendRenderer(d.fn,d.scope)}if(!c){this.bindStore(this.store,true)}this.refresh.defer(10,this)},delayRefresh:function(){if(!this.refreshTask){this.refreshTask=new Ext.util.DelayedTask(this.refresh,this)}this.refreshTask.delay(this.refreshBuffer)},refresh:function(){if(this.fireEvent("beforerefresh",this)!==false){var o=false;var q=[],w=this.store.data.items;for(var t=0,p=w.length;t<p;t++){q[t]=w[t].data}var u=[];var v=0;var i=null;var s=0;if(this.series){v=this.series.length;for(s=0;s<v;s++){i=this.series[s];var x={};for(var y in i){if(y=="style"&&i.style!==null){x.style=Ext.encode(i.style);o=true}else{x[y]=i[y]}}u.push(x)}}if(v>0){for(s=0;s<v;s++){i=u[s];if(!i.type){i.type=this.type}i.dataProvider=q}}else{u.push({type:this.type,dataProvider:q})}this.swf.setDataProvider(u);if(this.seriesStyles){this.setSeriesStyles(this.seriesStyles)}this.fireEvent("refresh",this)}},createFnProxy:function(d){var c="extFnProxy"+(++Ext.chart.Chart.PROXY_FN_ID);Ext.chart.Chart.proxyFunction[c]=d;return"Ext.chart.Chart.proxyFunction."+c},removeFnProxy:function(b){if(!Ext.isEmpty(b)){b=b.replace("Ext.chart.Chart.proxyFunction.","");delete Ext.chart.Chart.proxyFunction[b]}},getFunctionRef:function(b){if(Ext.isFunction(b)){return{fn:b,scope:this}}else{return{fn:b.fn,scope:b.scope||this}}},onDestroy:function(){if(this.refreshTask&&this.refreshTask.cancel){this.refreshTask.cancel()}Ext.chart.Chart.superclass.onDestroy.call(this);this.bindStore(null);this.removeFnProxy(this.tipFnName);this.removeFnProxy(this.legendFnName)}});Ext.reg("chart",Ext.chart.Chart);Ext.chart.Chart.PROXY_FN_ID=0;Ext.chart.Chart.proxyFunction={};Ext.chart.Chart.CHART_URL="http://yui.yahooapis.com/2.8.0/build/charts/assets/charts.swf";Ext.chart.PieChart=Ext.extend(Ext.chart.Chart,{type:"pie",onSwfReady:function(b){Ext.chart.PieChart.superclass.onSwfReady.call(this,b);this.setDataField(this.dataField);this.setCategoryField(this.categoryField)},setDataField:function(b){this.dataField=b;this.swf.setDataField(b)},setCategoryField:function(b){this.categoryField=b;this.swf.setCategoryField(b)}});Ext.reg("piechart",Ext.chart.PieChart);Ext.chart.CartesianChart=Ext.extend(Ext.chart.Chart,{onSwfReady:function(b){Ext.chart.CartesianChart.superclass.onSwfReady.call(this,b);this.labelFn=[];if(this.xField){this.setXField(this.xField)}if(this.yField){this.setYField(this.yField)}if(this.xAxis){this.setXAxis(this.xAxis)}if(this.xAxes){this.setXAxes(this.xAxes)}if(this.yAxis){this.setYAxis(this.yAxis)}if(this.yAxes){this.setYAxes(this.yAxes)}if(Ext.isDefined(this.constrainViewport)){this.swf.setConstrainViewport(this.constrainViewport)}},setXField:function(b){this.xField=b;this.swf.setHorizontalField(b)},setYField:function(b){this.yField=b;this.swf.setVerticalField(b)},setXAxis:function(b){this.xAxis=this.createAxis("xAxis",b);this.swf.setHorizontalAxis(this.xAxis)},setXAxes:function(g){var d;for(var e=0;e<g.length;e++){d=this.createAxis("xAxis"+e,g[e]);this.swf.setHorizontalAxis(d)}},setYAxis:function(b){this.yAxis=this.createAxis("yAxis",b);this.swf.setVerticalAxis(this.yAxis)},setYAxes:function(g){var d;for(var e=0;e<g.length;e++){d=this.createAxis("yAxis"+e,g[e]);this.swf.setVerticalAxis(d)}},createAxis:function(g,k){var i=Ext.apply({},k),l,h;if(this[g]){h=this[g].labelFunction;this.removeFnProxy(h);this.labelFn.remove(h)}if(i.labelRenderer){l=this.getFunctionRef(i.labelRenderer);i.labelFunction=this.createFnProxy(function(a){return l.fn.call(l.scope,a)});delete i.labelRenderer;this.labelFn.push(i.labelFunction)}if(g.indexOf("xAxis")>-1&&i.position=="left"){i.position="bottom"}return i},onDestroy:function(){Ext.chart.CartesianChart.superclass.onDestroy.call(this);Ext.each(this.labelFn,function(b){this.removeFnProxy(b)},this)}});Ext.reg("cartesianchart",Ext.chart.CartesianChart);Ext.chart.LineChart=Ext.extend(Ext.chart.CartesianChart,{type:"line"});Ext.reg("linechart",Ext.chart.LineChart);Ext.chart.ColumnChart=Ext.extend(Ext.chart.CartesianChart,{type:"column"});Ext.reg("columnchart",Ext.chart.ColumnChart);
Ext.chart.StackedColumnChart=Ext.extend(Ext.chart.CartesianChart,{type:"stackcolumn"});Ext.reg("stackedcolumnchart",Ext.chart.StackedColumnChart);Ext.chart.BarChart=Ext.extend(Ext.chart.CartesianChart,{type:"bar"});Ext.reg("barchart",Ext.chart.BarChart);Ext.chart.StackedBarChart=Ext.extend(Ext.chart.CartesianChart,{type:"stackbar"});Ext.reg("stackedbarchart",Ext.chart.StackedBarChart);Ext.chart.Axis=function(b){Ext.apply(this,b)};Ext.chart.Axis.prototype={type:null,orientation:"horizontal",reverse:false,labelFunction:null,hideOverlappingLabels:true,labelSpacing:2};Ext.chart.NumericAxis=Ext.extend(Ext.chart.Axis,{type:"numeric",minimum:NaN,maximum:NaN,majorUnit:NaN,minorUnit:NaN,snapToUnits:true,alwaysShowZero:true,scale:"linear",roundMajorUnit:true,calculateByLabelSize:true,position:"left",adjustMaximumByMajorUnit:true,adjustMinimumByMajorUnit:true});Ext.chart.TimeAxis=Ext.extend(Ext.chart.Axis,{type:"time",minimum:null,maximum:null,majorUnit:NaN,majorTimeUnit:null,minorUnit:NaN,minorTimeUnit:null,snapToUnits:true,stackingEnabled:false,calculateByLabelSize:true});Ext.chart.CategoryAxis=Ext.extend(Ext.chart.Axis,{type:"category",categoryNames:null,calculateCategoryCount:false});Ext.chart.Series=function(b){Ext.apply(this,b)};Ext.chart.Series.prototype={type:null,displayName:null};Ext.chart.CartesianSeries=Ext.extend(Ext.chart.Series,{xField:null,yField:null,showInLegend:true,axis:"primary"});Ext.chart.ColumnSeries=Ext.extend(Ext.chart.CartesianSeries,{type:"column"});Ext.chart.LineSeries=Ext.extend(Ext.chart.CartesianSeries,{type:"line"});Ext.chart.BarSeries=Ext.extend(Ext.chart.CartesianSeries,{type:"bar"});Ext.chart.PieSeries=Ext.extend(Ext.chart.Series,{type:"pie",dataField:null,categoryField:null});Ext.menu.Menu=Ext.extend(Ext.Container,{minWidth:120,shadow:"sides",subMenuAlign:"tl-tr?",defaultAlign:"tl-bl?",allowOtherMenus:false,ignoreParentClicks:false,enableScrolling:true,maxHeight:null,scrollIncrement:24,showSeparator:true,defaultOffsets:[0,0],plain:false,floating:true,zIndex:15000,hidden:true,layout:"menu",hideMode:"offsets",scrollerHeight:8,autoLayout:true,defaultType:"menuitem",bufferResize:false,initComponent:function(){if(Ext.isArray(this.initialConfig)){Ext.apply(this,{items:this.initialConfig})}this.addEvents("click","mouseover","mouseout","itemclick");Ext.menu.MenuMgr.register(this);if(this.floating){Ext.EventManager.onWindowResize(this.hide,this)}else{if(this.initialConfig.hidden!==false){this.hidden=false}this.internalDefaults={hideOnClick:false}}Ext.menu.Menu.superclass.initComponent.call(this);if(this.autoLayout){var b=this.doLayout.createDelegate(this,[]);this.on({add:b,remove:b})}},getLayoutTarget:function(){return this.ul},onRender:function(d,e){if(!d){d=Ext.getBody()}var g={id:this.getId(),cls:"x-menu "+((this.floating)?"x-menu-floating x-layer ":"")+(this.cls||"")+(this.plain?" x-menu-plain":"")+(this.showSeparator?"":" x-menu-nosep"),style:this.style,cn:[{tag:"a",cls:"x-menu-focus",href:"#",onclick:"return false;",tabIndex:"-1"},{tag:"ul",cls:"x-menu-list"}]};if(this.floating){this.el=new Ext.Layer({shadow:this.shadow,dh:g,constrain:false,parentEl:d,zindex:this.zIndex})}else{this.el=d.createChild(g)}Ext.menu.Menu.superclass.onRender.call(this,d,e);if(!this.keyNav){this.keyNav=new Ext.menu.MenuNav(this)}this.focusEl=this.el.child("a.x-menu-focus");this.ul=this.el.child("ul.x-menu-list");this.mon(this.ul,{scope:this,click:this.onClick,mouseover:this.onMouseOver,mouseout:this.onMouseOut});if(this.enableScrolling){this.mon(this.el,{scope:this,delegate:".x-menu-scroller",click:this.onScroll,mouseover:this.deactivateActive})}},findTargetItem:function(c){var d=c.getTarget(".x-menu-list-item",this.ul,true);if(d&&d.menuItemId){return this.items.get(d.menuItemId)}},onClick:function(c){var d=this.findTargetItem(c);if(d){if(d.isFormField){this.setActiveItem(d)}else{if(d instanceof Ext.menu.BaseItem){if(d.menu&&this.ignoreParentClicks){d.expandMenu();c.preventDefault()}else{if(d.onClick){d.onClick(c);this.fireEvent("click",this,d,c)
}}}}}},setActiveItem:function(d,c){if(d!=this.activeItem){this.deactivateActive();if((this.activeItem=d).isFormField){d.focus()}else{d.activate(c)}}else{if(c){d.expandMenu()}}},deactivateActive:function(){var a=this.activeItem;if(a){if(a.isFormField){if(a.collapse){a.collapse()}}else{a.deactivate()}delete this.activeItem}},tryActivate:function(k,l){var h=this.items;for(var n=k,i=h.length;n>=0&&n<i;n+=l){var m=h.get(n);if(m.isVisible()&&!m.disabled&&(m.canActivate||m.isFormField)){this.setActiveItem(m,false);return m}}return false},onMouseOver:function(c){var d=this.findTargetItem(c);if(d){if(d.canActivate&&!d.disabled){this.setActiveItem(d,true)}}this.over=true;this.fireEvent("mouseover",this,c,d)},onMouseOut:function(c){var d=this.findTargetItem(c);if(d){if(d==this.activeItem&&d.shouldDeactivate&&d.shouldDeactivate(c)){this.activeItem.deactivate();delete this.activeItem}}this.over=false;this.fireEvent("mouseout",this,c,d)},onScroll:function(h,e){if(h){h.stopEvent()}var g=this.ul.dom,i=Ext.fly(e).is(".x-menu-scroller-top");g.scrollTop+=this.scrollIncrement*(i?-1:1);if(i?g.scrollTop<=0:g.scrollTop+this.activeMax>=g.scrollHeight){this.onScrollerOut(null,e)}},onScrollerIn:function(h,e){var g=this.ul.dom,i=Ext.fly(e).is(".x-menu-scroller-top");if(i?g.scrollTop>0:g.scrollTop+this.activeMax<g.scrollHeight){Ext.fly(e).addClass(["x-menu-item-active","x-menu-scroller-active"])}},onScrollerOut:function(c,d){Ext.fly(d).removeClass(["x-menu-item-active","x-menu-scroller-active"])},show:function(d,g,e){if(this.floating){this.parentMenu=e;if(!this.el){this.render();this.doLayout(false,true)}this.showAt(this.el.getAlignToXY(d,g||this.defaultAlign,this.defaultOffsets),e)}else{Ext.menu.Menu.superclass.show.call(this)}},showAt:function(c,d){if(this.fireEvent("beforeshow",this)!==false){this.parentMenu=d;if(!this.el){this.render()}if(this.enableScrolling){this.el.setXY(c);c[1]=this.constrainScroll(c[1]);c=[this.el.adjustForConstraints(c)[0],c[1]]}else{c=this.el.adjustForConstraints(c)}this.el.setXY(c);this.el.show();Ext.menu.Menu.superclass.onShow.call(this);if(Ext.isIE){this.fireEvent("autosize",this);if(!Ext.isIE8){this.el.repaint()}}this.hidden=false;this.focus();this.fireEvent("show",this)}},constrainScroll:function(m){var k,q=this.ul.setHeight("auto").getHeight(),l=m,n,p,o,s;if(this.floating){p=Ext.fly(this.el.dom.parentNode);o=p.getScroll().top;s=p.getViewSize().height;n=m-o;k=this.maxHeight?this.maxHeight:s-n;if(q>s){k=s;l=m-n}else{if(k<q){l=m-(q-k);k=q}}}else{k=this.getHeight()}if(this.maxHeight){k=Math.min(this.maxHeight,k)}if(q>k&&k>0){this.activeMax=k-this.scrollerHeight*2-this.el.getFrameWidth("tb")-Ext.num(this.el.shadowOffset,0);this.ul.setHeight(this.activeMax);this.createScrollers();this.el.select(".x-menu-scroller").setDisplayed("")}else{this.ul.setHeight(q);this.el.select(".x-menu-scroller").setDisplayed("none")}this.ul.dom.scrollTop=0;return l},createScrollers:function(){if(!this.scroller){this.scroller={pos:0,top:this.el.insertFirst({tag:"div",cls:"x-menu-scroller x-menu-scroller-top",html:"&#160;"}),bottom:this.el.createChild({tag:"div",cls:"x-menu-scroller x-menu-scroller-bottom",html:"&#160;"})};this.scroller.top.hover(this.onScrollerIn,this.onScrollerOut,this);this.scroller.topRepeater=new Ext.util.ClickRepeater(this.scroller.top,{listeners:{click:this.onScroll.createDelegate(this,[null,this.scroller.top],false)}});this.scroller.bottom.hover(this.onScrollerIn,this.onScrollerOut,this);this.scroller.bottomRepeater=new Ext.util.ClickRepeater(this.scroller.bottom,{listeners:{click:this.onScroll.createDelegate(this,[null,this.scroller.bottom],false)}})}},onLayout:function(){if(this.isVisible()){if(this.enableScrolling){this.constrainScroll(this.el.getTop())}if(this.floating){this.el.sync()}}},focus:function(){if(!this.hidden){this.doFocus.defer(50,this)}},doFocus:function(){if(!this.hidden){this.focusEl.focus()}},hide:function(b){if(!this.isDestroyed){this.deepHide=b;Ext.menu.Menu.superclass.hide.call(this);delete this.deepHide
}},onHide:function(){Ext.menu.Menu.superclass.onHide.call(this);this.deactivateActive();if(this.el&&this.floating){this.el.hide()}var b=this.parentMenu;if(this.deepHide===true&&b){if(b.floating){b.hide(true)}else{b.deactivateActive()}}},lookupComponent:function(b){if(Ext.isString(b)){b=(b=="separator"||b=="-")?new Ext.menu.Separator():new Ext.menu.TextItem(b);this.applyDefaults(b)}else{if(Ext.isObject(b)){b=this.getMenuItem(b)}else{if(b.tagName||b.el){b=new Ext.BoxComponent({el:b})}}}return b},applyDefaults:function(c){if(!Ext.isString(c)){c=Ext.menu.Menu.superclass.applyDefaults.call(this,c);var d=this.internalDefaults;if(d){if(c.events){Ext.applyIf(c.initialConfig,d);Ext.apply(c,d)}else{Ext.applyIf(c,d)}}}return c},getMenuItem:function(b){if(!b.isXType){if(!b.xtype&&Ext.isBoolean(b.checked)){return new Ext.menu.CheckItem(b)}return Ext.create(b,this.defaultType)}return b},addSeparator:function(){return this.add(new Ext.menu.Separator())},addElement:function(b){return this.add(new Ext.menu.BaseItem({el:b}))},addItem:function(b){return this.add(b)},addMenuItem:function(b){return this.add(this.getMenuItem(b))},addText:function(b){return this.add(new Ext.menu.TextItem(b))},onDestroy:function(){Ext.EventManager.removeResizeListener(this.hide,this);var d=this.parentMenu;if(d&&d.activeChild==this){delete d.activeChild}delete this.parentMenu;Ext.menu.Menu.superclass.onDestroy.call(this);Ext.menu.MenuMgr.unregister(this);if(this.keyNav){this.keyNav.disable()}var c=this.scroller;if(c){Ext.destroy(c.topRepeater,c.bottomRepeater,c.top,c.bottom)}Ext.destroy(this.el,this.focusEl,this.ul)}});Ext.reg("menu",Ext.menu.Menu);Ext.menu.MenuNav=Ext.extend(Ext.KeyNav,function(){function d(a,b){if(!b.tryActivate(b.items.indexOf(b.activeItem)-1,-1)){b.tryActivate(b.items.length-1,-1)}}function c(a,b){if(!b.tryActivate(b.items.indexOf(b.activeItem)+1,1)){b.tryActivate(0,1)}}return{constructor:function(a){Ext.menu.MenuNav.superclass.constructor.call(this,a.el);this.scope=this.menu=a},doRelay:function(a,b){var e=a.getKey();if(this.menu.activeItem&&this.menu.activeItem.isFormField&&e!=a.TAB){return false}if(!this.menu.activeItem&&a.isNavKeyPress()&&e!=a.SPACE&&e!=a.RETURN){this.menu.tryActivate(0,1);return false}return b.call(this.scope||this,a,this.menu)},tab:function(a,b){a.stopEvent();if(a.shiftKey){d(a,b)}else{c(a,b)}},up:d,down:c,right:function(a,b){if(b.activeItem){b.activeItem.expandMenu(true)}},left:function(a,b){b.hide();if(b.parentMenu&&b.parentMenu.activeItem){b.parentMenu.activeItem.activate()}},enter:function(a,b){if(b.activeItem){a.stopPropagation();b.activeItem.onClick(a);b.fireEvent("click",this,b.activeItem);return true}}}}());Ext.menu.MenuMgr=function(){var v,x,y={},A=false,q=new Date();function o(){v={};x=new Ext.util.MixedCollection();Ext.getDoc().addKeyListener(27,function(){if(x.length>0){t()}})}function t(){if(x&&x.length>0){var a=x.clone();a.each(function(b){b.hide()});return true}return false}function w(a){x.remove(a);if(x.length<1){Ext.getDoc().un("mousedown",p);A=false}}function s(b){var a=x.last();q=new Date();x.add(b);if(!A){Ext.getDoc().on("mousedown",p);A=true}if(b.parentMenu){b.getEl().setZIndex(parseInt(b.parentMenu.getEl().getStyle("z-index"),10)+3);b.parentMenu.activeChild=b}else{if(a&&!a.isDestroyed&&a.isVisible()){b.getEl().setZIndex(parseInt(a.getEl().getStyle("z-index"),10)+3)}}}function z(a){if(a.activeChild){a.activeChild.hide()}if(a.autoHideTimer){clearTimeout(a.autoHideTimer);delete a.autoHideTimer}}function u(b){var a=b.parentMenu;if(!a&&!b.allowOtherMenus){t()}else{if(a&&a.activeChild){a.activeChild.hide()}}}function p(a){if(q.getElapsed()>50&&x.length>0&&!a.getTarget(".x-menu")){t()}}return{hideAll:function(){return t()},register:function(a){if(!v){o()}v[a.id]=a;a.on({beforehide:z,hide:w,beforeshow:u,show:s})},get:function(a){if(typeof a=="string"){if(!v){return null}return v[a]}else{if(a.events){return a}else{if(typeof a.length=="number"){return new Ext.menu.Menu({items:a})}else{return Ext.create(a,"menu")}}}},unregister:function(a){delete v[a.id];
a.un("beforehide",z);a.un("hide",w);a.un("beforeshow",u);a.un("show",s)},registerCheckable:function(b){var a=b.group;if(a){if(!y[a]){y[a]=[]}y[a].push(b)}},unregisterCheckable:function(b){var a=b.group;if(a){y[a].remove(b)}},onCheckChange:function(d,c){if(d.group&&c){var a=y[d.group],e=0,g=a.length,b;for(;e<g;e++){b=a[e];if(b!=d){b.setChecked(false)}}}},getCheckedItem:function(b){var a=y[b];if(a){for(var c=0,d=a.length;c<d;c++){if(a[c].checked){return a[c]}}}return null},setCheckedItem:function(c,a){var b=y[c];if(b){for(var d=0,e=b.length;d<e;d++){if(b[d].id==a){b[d].setChecked(true)}}}return null}}}();Ext.menu.BaseItem=Ext.extend(Ext.Component,{canActivate:false,activeClass:"x-menu-item-active",hideOnClick:true,clickHideDelay:1,ctype:"Ext.menu.BaseItem",actionMode:"container",initComponent:function(){Ext.menu.BaseItem.superclass.initComponent.call(this);this.addEvents("click","activate","deactivate");if(this.handler){this.on("click",this.handler,this.scope)}},onRender:function(c,d){Ext.menu.BaseItem.superclass.onRender.apply(this,arguments);if(this.ownerCt&&this.ownerCt instanceof Ext.menu.Menu){this.parentMenu=this.ownerCt}else{this.container.addClass("x-menu-list-item");this.mon(this.el,{scope:this,click:this.onClick,mouseenter:this.activate,mouseleave:this.deactivate})}},setHandler:function(c,d){if(this.handler){this.un("click",this.handler,this.scope)}this.on("click",this.handler=c,this.scope=d)},onClick:function(b){if(!this.disabled&&this.fireEvent("click",this,b)!==false&&(this.parentMenu&&this.parentMenu.fireEvent("itemclick",this,b)!==false)){this.handleClick(b)}else{b.stopEvent()}},activate:function(){if(this.disabled){return false}var b=this.container;b.addClass(this.activeClass);this.region=b.getRegion().adjust(2,2,-2,-2);this.fireEvent("activate",this);return true},deactivate:function(){this.container.removeClass(this.activeClass);this.fireEvent("deactivate",this)},shouldDeactivate:function(b){return !this.region||!this.region.contains(b.getPoint())},handleClick:function(c){var d=this.parentMenu;if(this.hideOnClick){if(d.floating){d.hide.defer(this.clickHideDelay,d,[true])}else{d.deactivateActive()}}},expandMenu:Ext.emptyFn,hideMenu:Ext.emptyFn});Ext.reg("menubaseitem",Ext.menu.BaseItem);Ext.menu.TextItem=Ext.extend(Ext.menu.BaseItem,{hideOnClick:false,itemCls:"x-menu-text",constructor:function(b){if(typeof b=="string"){b={text:b}}Ext.menu.TextItem.superclass.constructor.call(this,b)},onRender:function(){var b=document.createElement("span");b.className=this.itemCls;b.innerHTML=this.text;this.el=b;Ext.menu.TextItem.superclass.onRender.apply(this,arguments)}});Ext.reg("menutextitem",Ext.menu.TextItem);Ext.menu.Separator=Ext.extend(Ext.menu.BaseItem,{itemCls:"x-menu-sep",hideOnClick:false,activeClass:"",onRender:function(d){var c=document.createElement("span");c.className=this.itemCls;c.innerHTML="&#160;";this.el=c;d.addClass("x-menu-sep-li");Ext.menu.Separator.superclass.onRender.apply(this,arguments)}});Ext.reg("menuseparator",Ext.menu.Separator);Ext.menu.Item=Ext.extend(Ext.menu.BaseItem,{itemCls:"x-menu-item",canActivate:true,showDelay:200,altText:"",hideDelay:200,ctype:"Ext.menu.Item",initComponent:function(){Ext.menu.Item.superclass.initComponent.call(this);if(this.menu){this.menu=Ext.menu.MenuMgr.get(this.menu);this.menu.ownerCt=this}},onRender:function(e,a){if(!this.itemTpl){this.itemTpl=Ext.menu.Item.prototype.itemTpl=new Ext.XTemplate('<a id="{id}" class="{cls}" hidefocus="true" unselectable="on" href="{href}"','<tpl if="hrefTarget">',' target="{hrefTarget}"',"</tpl>",">",'<img alt="{altText}" src="{icon}" class="x-menu-item-icon {iconCls}"/>','<span class="x-menu-item-text">{text}</span>',"</a>")}var g=this.getTemplateArgs();this.el=a?this.itemTpl.insertBefore(a,g,true):this.itemTpl.append(e,g,true);this.iconEl=this.el.child("img.x-menu-item-icon");this.textEl=this.el.child(".x-menu-item-text");if(!this.href){this.mon(this.el,"click",Ext.emptyFn,null,{preventDefault:true})}Ext.menu.Item.superclass.onRender.call(this,e,a)
},getTemplateArgs:function(){return{id:this.id,cls:this.itemCls+(this.menu?" x-menu-item-arrow":"")+(this.cls?" "+this.cls:""),href:this.href||"#",hrefTarget:this.hrefTarget,icon:this.icon||Ext.BLANK_IMAGE_URL,iconCls:this.iconCls||"",text:this.itemText||this.text||"&#160;",altText:this.altText||""}},setText:function(b){this.text=b||"&#160;";if(this.rendered){this.textEl.update(this.text);this.parentMenu.layout.doAutoSize()}},setIconClass:function(d){var c=this.iconCls;this.iconCls=d;if(this.rendered){this.iconEl.replaceClass(c,this.iconCls)}},beforeDestroy:function(){if(this.menu){delete this.menu.ownerCt;this.menu.destroy()}Ext.menu.Item.superclass.beforeDestroy.call(this)},handleClick:function(b){if(!this.href){b.stopEvent()}Ext.menu.Item.superclass.handleClick.apply(this,arguments)},activate:function(b){if(Ext.menu.Item.superclass.activate.apply(this,arguments)){this.focus();if(b){this.expandMenu()}}return true},shouldDeactivate:function(b){if(Ext.menu.Item.superclass.shouldDeactivate.call(this,b)){if(this.menu&&this.menu.isVisible()){return !this.menu.getEl().getRegion().contains(b.getPoint())}return true}return false},deactivate:function(){Ext.menu.Item.superclass.deactivate.apply(this,arguments);this.hideMenu()},expandMenu:function(b){if(!this.disabled&&this.menu){clearTimeout(this.hideTimer);delete this.hideTimer;if(!this.menu.isVisible()&&!this.showTimer){this.showTimer=this.deferExpand.defer(this.showDelay,this,[b])}else{if(this.menu.isVisible()&&b){this.menu.tryActivate(0,1)}}}},deferExpand:function(b){delete this.showTimer;this.menu.show(this.container,this.parentMenu.subMenuAlign||"tl-tr?",this.parentMenu);if(b){this.menu.tryActivate(0,1)}},hideMenu:function(){clearTimeout(this.showTimer);delete this.showTimer;if(!this.hideTimer&&this.menu&&this.menu.isVisible()){this.hideTimer=this.deferHide.defer(this.hideDelay,this)}},deferHide:function(){delete this.hideTimer;if(this.menu.over){this.parentMenu.setActiveItem(this,false)}else{this.menu.hide()}}});Ext.reg("menuitem",Ext.menu.Item);Ext.menu.CheckItem=Ext.extend(Ext.menu.Item,{itemCls:"x-menu-item x-menu-check-item",groupClass:"x-menu-group-item",checked:false,ctype:"Ext.menu.CheckItem",initComponent:function(){Ext.menu.CheckItem.superclass.initComponent.call(this);this.addEvents("beforecheckchange","checkchange");if(this.checkHandler){this.on("checkchange",this.checkHandler,this.scope)}Ext.menu.MenuMgr.registerCheckable(this)},onRender:function(b){Ext.menu.CheckItem.superclass.onRender.apply(this,arguments);if(this.group){this.el.addClass(this.groupClass)}if(this.checked){this.checked=false;this.setChecked(true,true)}},destroy:function(){Ext.menu.MenuMgr.unregisterCheckable(this);Ext.menu.CheckItem.superclass.destroy.apply(this,arguments)},setChecked:function(d,e){var g=e===true;if(this.checked!=d&&(g||this.fireEvent("beforecheckchange",this,d)!==false)){Ext.menu.MenuMgr.onCheckChange(this,d);if(this.container){this.container[d?"addClass":"removeClass"]("x-menu-item-checked")}this.checked=d;if(!g){this.fireEvent("checkchange",this,d)}}},handleClick:function(b){if(!this.disabled&&!(this.checked&&this.group)){this.setChecked(!this.checked)}Ext.menu.CheckItem.superclass.handleClick.apply(this,arguments)}});Ext.reg("menucheckitem",Ext.menu.CheckItem);Ext.menu.DateMenu=Ext.extend(Ext.menu.Menu,{enableScrolling:false,hideOnClick:true,pickerId:null,cls:"x-date-menu",initComponent:function(){this.on("beforeshow",this.onBeforeShow,this);if(this.strict=(Ext.isIE7&&Ext.isStrict)){this.on("show",this.onShow,this,{single:true,delay:20})}Ext.apply(this,{plain:true,showSeparator:false,items:this.picker=new Ext.DatePicker(Ext.applyIf({internalRender:this.strict||!Ext.isIE,ctCls:"x-menu-date-item",id:this.pickerId},this.initialConfig))});this.picker.purgeListeners();Ext.menu.DateMenu.superclass.initComponent.call(this);this.relayEvents(this.picker,["select"]);this.on("show",this.picker.focus,this.picker);this.on("select",this.menuHide,this);if(this.handler){this.on("select",this.handler,this.scope||this)
}},menuHide:function(){if(this.hideOnClick){this.hide(true)}},onBeforeShow:function(){if(this.picker){this.picker.hideMonthPicker(true)}},onShow:function(){var b=this.picker.getEl();b.setWidth(b.getWidth())}});Ext.reg("datemenu",Ext.menu.DateMenu);Ext.menu.ColorMenu=Ext.extend(Ext.menu.Menu,{enableScrolling:false,hideOnClick:true,cls:"x-color-menu",paletteId:null,initComponent:function(){Ext.apply(this,{plain:true,showSeparator:false,items:this.palette=new Ext.ColorPalette(Ext.applyIf({id:this.paletteId},this.initialConfig))});this.palette.purgeListeners();Ext.menu.ColorMenu.superclass.initComponent.call(this);this.relayEvents(this.palette,["select"]);this.on("select",this.menuHide,this);if(this.handler){this.on("select",this.handler,this.scope||this)}},menuHide:function(){if(this.hideOnClick){this.hide(true)}}});Ext.reg("colormenu",Ext.menu.ColorMenu);Ext.form.Field=Ext.extend(Ext.BoxComponent,{invalidClass:"x-form-invalid",invalidText:"The value in this field is invalid",focusClass:"x-form-focus",validationEvent:"keyup",validateOnBlur:true,validationDelay:250,defaultAutoCreate:{tag:"input",type:"text",size:"20",autocomplete:"off"},fieldClass:"x-form-field",msgTarget:"qtip",msgFx:"normal",readOnly:false,disabled:false,submitValue:true,isFormField:true,msgDisplay:"",hasFocus:false,initComponent:function(){Ext.form.Field.superclass.initComponent.call(this);this.addEvents("focus","blur","specialkey","change","invalid","valid")},getName:function(){return this.rendered&&this.el.dom.name?this.el.dom.name:this.name||this.id||""},onRender:function(i,g){if(!this.el){var e=this.getAutoCreate();if(!e.name){e.name=this.name||this.id}if(this.inputType){e.type=this.inputType}this.autoEl=e}Ext.form.Field.superclass.onRender.call(this,i,g);if(this.submitValue===false){this.el.dom.removeAttribute("name")}var h=this.el.dom.type;if(h){if(h=="password"){h="text"}this.el.addClass("x-form-"+h)}if(this.readOnly){this.setReadOnly(true)}if(this.tabIndex!==undefined){this.el.dom.setAttribute("tabIndex",this.tabIndex)}this.el.addClass([this.fieldClass,this.cls])},getItemCt:function(){return this.itemCt},initValue:function(){if(this.value!==undefined){this.setValue(this.value)}else{if(!Ext.isEmpty(this.el.dom.value)&&this.el.dom.value!=this.emptyText){this.setValue(this.el.dom.value)}}this.originalValue=this.getValue()},isDirty:function(){if(this.disabled||!this.rendered){return false}return String(this.getValue())!==String(this.originalValue)},setReadOnly:function(b){if(this.rendered){this.el.dom.readOnly=b}this.readOnly=b},afterRender:function(){Ext.form.Field.superclass.afterRender.call(this);this.initEvents();this.initValue()},fireKey:function(b){if(b.isSpecialKey()){this.fireEvent("specialkey",this,b)}},reset:function(){this.setValue(this.originalValue);this.clearInvalid()},initEvents:function(){this.mon(this.el,Ext.EventManager.getKeyEvent(),this.fireKey,this);this.mon(this.el,"focus",this.onFocus,this);this.mon(this.el,"blur",this.onBlur,this,this.inEditor?{buffer:10}:null)},preFocus:Ext.emptyFn,onFocus:function(){this.preFocus();if(this.focusClass){this.el.addClass(this.focusClass)}if(!this.hasFocus){this.hasFocus=true;this.startValue=this.getValue();this.fireEvent("focus",this)}},beforeBlur:Ext.emptyFn,onBlur:function(){this.beforeBlur();if(this.focusClass){this.el.removeClass(this.focusClass)}this.hasFocus=false;if(this.validationEvent!==false&&(this.validateOnBlur||this.validationEvent=="blur")){this.validate()}var b=this.getValue();if(String(b)!==String(this.startValue)){this.fireEvent("change",this,b,this.startValue)}this.fireEvent("blur",this);this.postBlur()},postBlur:Ext.emptyFn,isValid:function(e){if(this.disabled){return true}var g=this.preventMark;this.preventMark=e===true;var d=this.validateValue(this.processValue(this.getRawValue()));this.preventMark=g;return d},validate:function(){if(this.disabled||this.validateValue(this.processValue(this.getRawValue()))){this.clearInvalid();return true}return false},processValue:function(b){return b
},validateValue:function(c){var d=this.getErrors(c)[0];if(d==undefined){return true}else{this.markInvalid(d);return false}},getErrors:function(){return[]},getActiveError:function(){return this.activeError||""},markInvalid:function(g){if(this.rendered&&!this.preventMark){g=g||this.invalidText;var e=this.getMessageHandler();if(e){e.mark(this,g)}else{if(this.msgTarget){this.el.addClass(this.invalidClass);var d=Ext.getDom(this.msgTarget);if(d){d.innerHTML=g;d.style.display=this.msgDisplay}}}}this.setActiveError(g)},clearInvalid:function(){if(this.rendered&&!this.preventMark){this.el.removeClass(this.invalidClass);var d=this.getMessageHandler();if(d){d.clear(this)}else{if(this.msgTarget){this.el.removeClass(this.invalidClass);var c=Ext.getDom(this.msgTarget);if(c){c.innerHTML="";c.style.display="none"}}}}this.unsetActiveError()},setActiveError:function(c,d){this.activeError=c;if(d!==true){this.fireEvent("invalid",this,c)}},unsetActiveError:function(b){delete this.activeError;if(b!==true){this.fireEvent("valid",this)}},getMessageHandler:function(){return Ext.form.MessageTargets[this.msgTarget]},getErrorCt:function(){return this.el.findParent(".x-form-element",5,true)||this.el.findParent(".x-form-field-wrap",5,true)},alignErrorEl:function(){this.errorEl.setWidth(this.getErrorCt().getWidth(true)-20)},alignErrorIcon:function(){this.errorIcon.alignTo(this.el,"tl-tr",[2,0])},getRawValue:function(){var b=this.rendered?this.el.getValue():Ext.value(this.value,"");if(b===this.emptyText){b=""}return b},getValue:function(){if(!this.rendered){return this.value}var b=this.el.getValue();if(b===this.emptyText||b===undefined){b=""}return b},setRawValue:function(b){return this.rendered?(this.el.dom.value=(Ext.isEmpty(b)?"":b)):""},setValue:function(b){this.value=b;if(this.rendered){this.el.dom.value=(Ext.isEmpty(b)?"":b);this.validate()}return this},append:function(b){this.setValue([this.getValue(),b].join(""))}});Ext.form.MessageTargets={qtip:{mark:function(d,c){d.el.addClass(d.invalidClass);d.el.dom.qtip=c;d.el.dom.qclass="x-form-invalid-tip";if(Ext.QuickTips){Ext.QuickTips.enable()}},clear:function(b){b.el.removeClass(b.invalidClass);b.el.dom.qtip=""}},title:{mark:function(d,c){d.el.addClass(d.invalidClass);d.el.dom.title=c},clear:function(b){b.el.dom.title=""}},under:{mark:function(d,g){d.el.addClass(d.invalidClass);if(!d.errorEl){var e=d.getErrorCt();if(!e){d.el.dom.title=g;return}d.errorEl=e.createChild({cls:"x-form-invalid-msg"});d.on("resize",d.alignErrorEl,d);d.on("destroy",function(){Ext.destroy(this.errorEl)},d)}d.alignErrorEl();d.errorEl.update(g);Ext.form.Field.msgFx[d.msgFx].show(d.errorEl,d)},clear:function(b){b.el.removeClass(b.invalidClass);if(b.errorEl){Ext.form.Field.msgFx[b.msgFx].hide(b.errorEl,b)}else{b.el.dom.title=""}}},side:{mark:function(d,g){d.el.addClass(d.invalidClass);if(!d.errorIcon){var e=d.getErrorCt();if(!e){d.el.dom.title=g;return}d.errorIcon=e.createChild({cls:"x-form-invalid-icon"});if(d.ownerCt){d.ownerCt.on("afterlayout",d.alignErrorIcon,d);d.ownerCt.on("expand",d.alignErrorIcon,d)}d.on("resize",d.alignErrorIcon,d);d.on("destroy",function(){Ext.destroy(this.errorIcon)},d)}d.alignErrorIcon();d.errorIcon.dom.qtip=g;d.errorIcon.dom.qclass="x-form-invalid-tip";d.errorIcon.show()},clear:function(b){b.el.removeClass(b.invalidClass);if(b.errorIcon){b.errorIcon.dom.qtip="";b.errorIcon.hide()}else{b.el.dom.title=""}}}};Ext.form.Field.msgFx={normal:{show:function(d,c){d.setDisplayed("block")},hide:function(d,c){d.setDisplayed(false).update("")}},slide:{show:function(d,c){d.slideIn("t",{stopFx:true})},hide:function(d,c){d.slideOut("t",{stopFx:true,useDisplay:true})}},slideRight:{show:function(d,c){d.fixDisplay();d.alignTo(c.el,"tl-tr");d.slideIn("l",{stopFx:true})},hide:function(d,c){d.slideOut("l",{stopFx:true,useDisplay:true})}}};Ext.reg("field",Ext.form.Field);Ext.form.TextField=Ext.extend(Ext.form.Field,{grow:false,growMin:30,growMax:800,vtype:null,maskRe:null,disableKeyFilter:false,allowBlank:true,minLength:0,maxLength:Number.MAX_VALUE,minLengthText:"The minimum length for this field is {0}",maxLengthText:"The maximum length for this field is {0}",selectOnFocus:false,blankText:"This field is required",validator:null,regex:null,regexText:"",emptyText:null,emptyClass:"x-form-empty-field",initComponent:function(){Ext.form.TextField.superclass.initComponent.call(this);
this.addEvents("autosize","keydown","keyup","keypress")},initEvents:function(){Ext.form.TextField.superclass.initEvents.call(this);if(this.validationEvent=="keyup"){this.validationTask=new Ext.util.DelayedTask(this.validate,this);this.mon(this.el,"keyup",this.filterValidation,this)}else{if(this.validationEvent!==false&&this.validationEvent!="blur"){this.mon(this.el,this.validationEvent,this.validate,this,{buffer:this.validationDelay})}}if(this.selectOnFocus||this.emptyText){this.mon(this.el,"mousedown",this.onMouseDown,this);if(this.emptyText){this.applyEmptyText()}}if(this.maskRe||(this.vtype&&this.disableKeyFilter!==true&&(this.maskRe=Ext.form.VTypes[this.vtype+"Mask"]))){this.mon(this.el,"keypress",this.filterKeys,this)}if(this.grow){this.mon(this.el,"keyup",this.onKeyUpBuffered,this,{buffer:50});this.mon(this.el,"click",this.autoSize,this)}if(this.enableKeyEvents){this.mon(this.el,{scope:this,keyup:this.onKeyUp,keydown:this.onKeyDown,keypress:this.onKeyPress})}},onMouseDown:function(b){if(!this.hasFocus){this.mon(this.el,"mouseup",Ext.emptyFn,this,{single:true,preventDefault:true})}},processValue:function(d){if(this.stripCharsRe){var c=d.replace(this.stripCharsRe,"");if(c!==d){this.setRawValue(c);return c}}return d},filterValidation:function(b){if(!b.isNavKeyPress()){this.validationTask.delay(this.validationDelay)}},onDisable:function(){Ext.form.TextField.superclass.onDisable.call(this);if(Ext.isIE){this.el.dom.unselectable="on"}},onEnable:function(){Ext.form.TextField.superclass.onEnable.call(this);if(Ext.isIE){this.el.dom.unselectable=""}},onKeyUpBuffered:function(b){if(this.doAutoSize(b)){this.autoSize()}},doAutoSize:function(b){return !b.isNavKeyPress()},onKeyUp:function(b){this.fireEvent("keyup",this,b)},onKeyDown:function(b){this.fireEvent("keydown",this,b)},onKeyPress:function(b){this.fireEvent("keypress",this,b)},reset:function(){Ext.form.TextField.superclass.reset.call(this);this.applyEmptyText()},applyEmptyText:function(){if(this.rendered&&this.emptyText&&this.getRawValue().length<1&&!this.hasFocus){this.setRawValue(this.emptyText);this.el.addClass(this.emptyClass)}},preFocus:function(){var d=this.el,c;if(this.emptyText){if(d.dom.value==this.emptyText){this.setRawValue("");c=true}d.removeClass(this.emptyClass)}if(this.selectOnFocus||c){d.dom.select()}},postBlur:function(){this.applyEmptyText()},filterKeys:function(d){if(d.ctrlKey){return}var e=d.getKey();if(Ext.isGecko&&(d.isNavKeyPress()||e==d.BACKSPACE||(e==d.DELETE&&d.button==-1))){return}var g=String.fromCharCode(d.getCharCode());if(!Ext.isGecko&&d.isSpecialKey()&&!g){return}if(!this.maskRe.test(g)){d.stopEvent()}},setValue:function(b){if(this.emptyText&&this.el&&!Ext.isEmpty(b)){this.el.removeClass(this.emptyClass)}Ext.form.TextField.superclass.setValue.apply(this,arguments);this.applyEmptyText();this.autoSize();return this},getErrors:function(g){var h=Ext.form.TextField.superclass.getErrors.apply(this,arguments);g=Ext.isDefined(g)?g:this.processValue(this.getRawValue());if(Ext.isFunction(this.validator)){var i=this.validator(g);if(i!==true){h.push(i)}}if(g.length<1||g===this.emptyText){if(this.allowBlank){return h}else{h.push(this.blankText)}}if(!this.allowBlank&&(g.length<1||g===this.emptyText)){h.push(this.blankText)}if(g.length<this.minLength){h.push(String.format(this.minLengthText,this.minLength))}if(g.length>this.maxLength){h.push(String.format(this.maxLengthText,this.maxLength))}if(this.vtype){var e=Ext.form.VTypes;if(!e[this.vtype](g,this)){h.push(this.vtypeText||e[this.vtype+"Text"])}}if(this.regex&&!this.regex.test(g)){h.push(this.regexText)}return h},selectText:function(k,i){var n=this.getRawValue();var m=false;if(n.length>0){k=k===undefined?0:k;i=i===undefined?n.length:i;var l=this.el.dom;if(l.setSelectionRange){l.setSelectionRange(k,i)}else{if(l.createTextRange){var d=l.createTextRange();d.moveStart("character",k);d.moveEnd("character",i-n.length);d.select()}}m=Ext.isGecko||Ext.isOpera}else{m=true}if(m){this.focus()}},autoSize:function(){if(!this.grow||!this.rendered){return
}if(!this.metrics){this.metrics=Ext.util.TextMetrics.createInstance(this.el)}var i=this.el;var d=i.dom.value;var h=document.createElement("div");h.appendChild(document.createTextNode(d));d=h.innerHTML;Ext.removeNode(h);h=null;d+="&#160;";var g=Math.min(this.growMax,Math.max(this.metrics.getWidth(d)+10,this.growMin));this.el.setWidth(g);this.fireEvent("autosize",this,g)},onDestroy:function(){if(this.validationTask){this.validationTask.cancel();this.validationTask=null}Ext.form.TextField.superclass.onDestroy.call(this)}});Ext.reg("textfield",Ext.form.TextField);Ext.form.TriggerField=Ext.extend(Ext.form.TextField,{defaultAutoCreate:{tag:"input",type:"text",size:"16",autocomplete:"off"},hideTrigger:false,editable:true,readOnly:false,wrapFocusClass:"x-trigger-wrap-focus",autoSize:Ext.emptyFn,monitorTab:true,deferHeight:true,mimicing:false,actionMode:"wrap",defaultTriggerWidth:17,onResize:function(e,g){Ext.form.TriggerField.superclass.onResize.call(this,e,g);var d=this.getTriggerWidth();if(Ext.isNumber(e)){this.el.setWidth(e-d)}this.wrap.setWidth(this.el.getWidth()+d)},getTriggerWidth:function(){var b=this.trigger.getWidth();if(!this.hideTrigger&&!this.readOnly&&b===0){b=this.defaultTriggerWidth}return b},alignErrorIcon:function(){if(this.wrap){this.errorIcon.alignTo(this.wrap,"tl-tr",[2,0])}},onRender:function(c,d){this.doc=Ext.isIE?Ext.getBody():Ext.getDoc();Ext.form.TriggerField.superclass.onRender.call(this,c,d);this.wrap=this.el.wrap({cls:"x-form-field-wrap x-form-field-trigger-wrap"});this.trigger=this.wrap.createChild(this.triggerConfig||{tag:"img",src:Ext.BLANK_IMAGE_URL,alt:"",cls:"x-form-trigger "+this.triggerClass});this.initTrigger();if(!this.width){this.wrap.setWidth(this.el.getWidth()+this.trigger.getWidth())}this.resizeEl=this.positionEl=this.wrap},getWidth:function(){return(this.el.getWidth()+this.trigger.getWidth())},updateEditState:function(){if(this.rendered){if(this.readOnly){this.el.dom.readOnly=true;this.el.addClass("x-trigger-noedit");this.mun(this.el,"click",this.onTriggerClick,this);this.trigger.setDisplayed(false)}else{if(!this.editable){this.el.dom.readOnly=true;this.el.addClass("x-trigger-noedit");this.mon(this.el,"click",this.onTriggerClick,this)}else{this.el.dom.readOnly=false;this.el.removeClass("x-trigger-noedit");this.mun(this.el,"click",this.onTriggerClick,this)}this.trigger.setDisplayed(!this.hideTrigger)}this.onResize(this.width||this.wrap.getWidth())}},setHideTrigger:function(b){if(b!=this.hideTrigger){this.hideTrigger=b;this.updateEditState()}},setEditable:function(b){if(b!=this.editable){this.editable=b;this.updateEditState()}},setReadOnly:function(b){if(b!=this.readOnly){this.readOnly=b;this.updateEditState()}},afterRender:function(){Ext.form.TriggerField.superclass.afterRender.call(this);this.updateEditState()},initTrigger:function(){this.mon(this.trigger,"click",this.onTriggerClick,this,{preventDefault:true});this.trigger.addClassOnOver("x-form-trigger-over");this.trigger.addClassOnClick("x-form-trigger-click")},onDestroy:function(){Ext.destroy(this.trigger,this.wrap);if(this.mimicing){this.doc.un("mousedown",this.mimicBlur,this)}delete this.doc;Ext.form.TriggerField.superclass.onDestroy.call(this)},onFocus:function(){Ext.form.TriggerField.superclass.onFocus.call(this);if(!this.mimicing){this.wrap.addClass(this.wrapFocusClass);this.mimicing=true;this.doc.on("mousedown",this.mimicBlur,this,{delay:10});if(this.monitorTab){this.on("specialkey",this.checkTab,this)}}},checkTab:function(d,c){if(c.getKey()==c.TAB){this.triggerBlur()}},onBlur:Ext.emptyFn,mimicBlur:function(b){if(!this.isDestroyed&&!this.wrap.contains(b.target)&&this.validateBlur(b)){this.triggerBlur()}},triggerBlur:function(){this.mimicing=false;this.doc.un("mousedown",this.mimicBlur,this);if(this.monitorTab&&this.el){this.un("specialkey",this.checkTab,this)}Ext.form.TriggerField.superclass.onBlur.call(this);if(this.wrap){this.wrap.removeClass(this.wrapFocusClass)}},beforeBlur:Ext.emptyFn,validateBlur:function(b){return true},onTriggerClick:Ext.emptyFn});
Ext.form.TwinTriggerField=Ext.extend(Ext.form.TriggerField,{initComponent:function(){Ext.form.TwinTriggerField.superclass.initComponent.call(this);this.triggerConfig={tag:"span",cls:"x-form-twin-triggers",cn:[{tag:"img",src:Ext.BLANK_IMAGE_URL,alt:"",cls:"x-form-trigger "+this.trigger1Class},{tag:"img",src:Ext.BLANK_IMAGE_URL,alt:"",cls:"x-form-trigger "+this.trigger2Class}]}},getTrigger:function(b){return this.triggers[b]},afterRender:function(){Ext.form.TwinTriggerField.superclass.afterRender.call(this);var g=this.triggers,d=0,e=g.length;for(;d<e;++d){if(this["hideTrigger"+(d+1)]){g[d].hide()}}},initTrigger:function(){var d=this.trigger.select(".x-form-trigger",true),c=this;d.each(function(h,a,i){var b="Trigger"+(i+1);h.hide=function(){var e=c.wrap.getWidth();this.dom.style.display="none";c.el.setWidth(e-c.trigger.getWidth());c["hidden"+b]=true};h.show=function(){var e=c.wrap.getWidth();this.dom.style.display="";c.el.setWidth(e-c.trigger.getWidth());c["hidden"+b]=false};this.mon(h,"click",this["on"+b+"Click"],this,{preventDefault:true});h.addClassOnOver("x-form-trigger-over");h.addClassOnClick("x-form-trigger-click")},this);this.triggers=d.elements},getTriggerWidth:function(){var b=0;Ext.each(this.triggers,function(h,i){var g="Trigger"+(i+1),a=h.getWidth();if(a===0&&!this["hidden"+g]){b+=this.defaultTriggerWidth}else{b+=a}},this);return b},onDestroy:function(){Ext.destroy(this.triggers);Ext.form.TwinTriggerField.superclass.onDestroy.call(this)},onTrigger1Click:Ext.emptyFn,onTrigger2Click:Ext.emptyFn});Ext.reg("trigger",Ext.form.TriggerField);Ext.form.TextArea=Ext.extend(Ext.form.TextField,{growMin:60,growMax:1000,growAppend:"&#160;\n&#160;",enterIsSpecial:false,preventScrollbars:false,onRender:function(c,d){if(!this.el){this.defaultAutoCreate={tag:"textarea",style:"width:100px;height:60px;",autocomplete:"off"}}Ext.form.TextArea.superclass.onRender.call(this,c,d);if(this.grow){this.textSizeEl=Ext.DomHelper.append(document.body,{tag:"pre",cls:"x-form-grow-sizer"});if(this.preventScrollbars){this.el.setStyle("overflow","hidden")}this.el.setHeight(this.growMin)}},onDestroy:function(){Ext.removeNode(this.textSizeEl);Ext.form.TextArea.superclass.onDestroy.call(this)},fireKey:function(b){if(b.isSpecialKey()&&(this.enterIsSpecial||(b.getKey()!=b.ENTER||b.hasModifier()))){this.fireEvent("specialkey",this,b)}},doAutoSize:function(b){return !b.isNavKeyPress()||b.getKey()==b.ENTER},filterValidation:function(b){if(!b.isNavKeyPress()||(!this.enterIsSpecial&&b.keyCode==b.ENTER)){this.validationTask.delay(this.validationDelay)}},autoSize:function(){if(!this.grow||!this.textSizeEl){return}var i=this.el,g=Ext.util.Format.htmlEncode(i.dom.value),h=this.textSizeEl,e;Ext.fly(h).setWidth(this.el.getWidth());if(g.length<1){g="&#160;&#160;"}else{g+=this.growAppend;if(Ext.isIE){g=g.replace(/\n/g,"&#160;<br />")}}h.innerHTML=g;e=Math.min(this.growMax,Math.max(h.offsetHeight,this.growMin));if(e!=this.lastHeight){this.lastHeight=e;this.el.setHeight(e);this.fireEvent("autosize",this,e)}}});Ext.reg("textarea",Ext.form.TextArea);Ext.form.NumberField=Ext.extend(Ext.form.TextField,{fieldClass:"x-form-field x-form-num-field",allowDecimals:true,decimalSeparator:".",decimalPrecision:2,allowNegative:true,minValue:Number.NEGATIVE_INFINITY,maxValue:Number.MAX_VALUE,minText:"The minimum value for this field is {0}",maxText:"The maximum value for this field is {0}",nanText:"{0} is not a valid number",baseChars:"0123456789",autoStripChars:false,initEvents:function(){var b=this.baseChars+"";if(this.allowDecimals){b+=this.decimalSeparator}if(this.allowNegative){b+="-"}b=Ext.escapeRe(b);this.maskRe=new RegExp("["+b+"]");if(this.autoStripChars){this.stripCharsRe=new RegExp("[^"+b+"]","gi")}Ext.form.NumberField.superclass.initEvents.call(this)},getErrors:function(d){var g=Ext.form.NumberField.superclass.getErrors.apply(this,arguments);d=Ext.isDefined(d)?d:this.processValue(this.getRawValue());if(d.length<1){return g}d=String(d).replace(this.decimalSeparator,".");if(isNaN(d)){g.push(String.format(this.nanText,d))
}var e=this.parseValue(d);if(e<this.minValue){g.push(String.format(this.minText,this.minValue))}if(e>this.maxValue){g.push(String.format(this.maxText,this.maxValue))}return g},getValue:function(){return this.fixPrecision(this.parseValue(Ext.form.NumberField.superclass.getValue.call(this)))},setValue:function(b){b=this.fixPrecision(b);b=Ext.isNumber(b)?b:parseFloat(String(b).replace(this.decimalSeparator,"."));b=isNaN(b)?"":String(b).replace(".",this.decimalSeparator);return Ext.form.NumberField.superclass.setValue.call(this,b)},setMinValue:function(b){this.minValue=Ext.num(b,Number.NEGATIVE_INFINITY)},setMaxValue:function(b){this.maxValue=Ext.num(b,Number.MAX_VALUE)},parseValue:function(b){b=parseFloat(String(b).replace(this.decimalSeparator,"."));return isNaN(b)?"":b},fixPrecision:function(c){var d=isNaN(c);if(!this.allowDecimals||this.decimalPrecision==-1||d||!c){return d?"":c}return parseFloat(parseFloat(c).toFixed(this.decimalPrecision))},beforeBlur:function(){var b=this.parseValue(this.getRawValue());if(!Ext.isEmpty(b)){this.setValue(b)}}});Ext.reg("numberfield",Ext.form.NumberField);Ext.form.DateField=Ext.extend(Ext.form.TriggerField,{format:"m/d/Y",altFormats:"m/d/Y|n/j/Y|n/j/y|m/j/y|n/d/y|m/j/Y|n/d/Y|m-d-y|m-d-Y|m/d|m-d|md|mdy|mdY|d|Y-m-d|n-j|n/j",disabledDaysText:"Disabled",disabledDatesText:"Disabled",minText:"The date in this field must be equal to or after {0}",maxText:"The date in this field must be equal to or before {0}",invalidText:"{0} is not a valid date - it must be in the format {1}",triggerClass:"x-form-date-trigger",showToday:true,startDay:0,defaultAutoCreate:{tag:"input",type:"text",size:"10",autocomplete:"off"},initTime:"12",initTimeFormat:"H",safeParse:function(d,g){if(/[gGhH]/.test(g.replace(/(\\.)/g,""))){return Date.parseDate(d,g)}else{var e=Date.parseDate(d+" "+this.initTime,g+" "+this.initTimeFormat);if(e){return e.clearTime()}}},initComponent:function(){Ext.form.DateField.superclass.initComponent.call(this);this.addEvents("select");if(Ext.isString(this.minValue)){this.minValue=this.parseDate(this.minValue)}if(Ext.isString(this.maxValue)){this.maxValue=this.parseDate(this.maxValue)}this.disabledDatesRE=null;this.initDisabledDays()},initEvents:function(){Ext.form.DateField.superclass.initEvents.call(this);this.keyNav=new Ext.KeyNav(this.el,{down:function(b){this.onTriggerClick()},scope:this,forceKeyDown:true})},initDisabledDays:function(){if(this.disabledDates){var d=this.disabledDates,e=d.length-1,g="(?:";Ext.each(d,function(a,b){g+=Ext.isDate(a)?"^"+Ext.escapeRe(a.dateFormat(this.format))+"$":d[b];if(b!=e){g+="|"}},this);this.disabledDatesRE=new RegExp(g+")")}},setDisabledDates:function(b){this.disabledDates=b;this.initDisabledDays();if(this.menu){this.menu.picker.setDisabledDates(this.disabledDatesRE)}},setDisabledDays:function(b){this.disabledDays=b;if(this.menu){this.menu.picker.setDisabledDays(b)}},setMinValue:function(b){this.minValue=(Ext.isString(b)?this.parseDate(b):b);if(this.menu){this.menu.picker.setMinDate(this.minValue)}},setMaxValue:function(b){this.maxValue=(Ext.isString(b)?this.parseDate(b):b);if(this.menu){this.menu.picker.setMaxDate(this.maxValue)}},getErrors:function(n){var l=Ext.form.DateField.superclass.getErrors.apply(this,arguments);n=this.formatDate(n||this.processValue(this.getRawValue()));if(n.length<1){return l}var p=n;n=this.parseDate(n);if(!n){l.push(String.format(this.invalidText,p,this.format));return l}var m=n.getTime();if(this.minValue&&m<this.minValue.clearTime().getTime()){l.push(String.format(this.minText,this.formatDate(this.minValue)))}if(this.maxValue&&m>this.maxValue.clearTime().getTime()){l.push(String.format(this.maxText,this.formatDate(this.maxValue)))}if(this.disabledDays){var k=n.getDay();for(var i=0;i<this.disabledDays.length;i++){if(k===this.disabledDays[i]){l.push(this.disabledDaysText);break}}}var o=this.formatDate(n);if(this.disabledDatesRE&&this.disabledDatesRE.test(o)){l.push(String.format(this.disabledDatesText,o))}return l},validateBlur:function(){return !this.menu||!this.menu.isVisible()
},getValue:function(){return this.parseDate(Ext.form.DateField.superclass.getValue.call(this))||""},setValue:function(b){return Ext.form.DateField.superclass.setValue.call(this,this.formatDate(this.parseDate(b)))},parseDate:function(k){if(!k||Ext.isDate(k)){return k}var h=this.safeParse(k,this.format),n=this.altFormats,l=this.altFormatsArray;if(!h&&n){l=l||n.split("|");for(var m=0,i=l.length;m<i&&!h;m++){h=this.safeParse(k,l[m])}}return h},onDestroy:function(){Ext.destroy(this.menu,this.keyNav);Ext.form.DateField.superclass.onDestroy.call(this)},formatDate:function(b){return Ext.isDate(b)?b.dateFormat(this.format):b},onTriggerClick:function(){if(this.disabled){return}if(this.menu==null){this.menu=new Ext.menu.DateMenu({hideOnClick:false,focusOnSelect:false})}this.onFocus();Ext.apply(this.menu.picker,{minDate:this.minValue,maxDate:this.maxValue,disabledDatesRE:this.disabledDatesRE,disabledDatesText:this.disabledDatesText,disabledDays:this.disabledDays,disabledDaysText:this.disabledDaysText,format:this.format,showToday:this.showToday,startDay:this.startDay,minText:String.format(this.minText,this.formatDate(this.minValue)),maxText:String.format(this.maxText,this.formatDate(this.maxValue))});this.menu.picker.setValue(this.getValue()||new Date());this.menu.show(this.el,"tl-bl?");this.menuEvents("on")},menuEvents:function(b){this.menu[b]("select",this.onSelect,this);this.menu[b]("hide",this.onMenuHide,this);this.menu[b]("show",this.onFocus,this)},onSelect:function(d,c){this.setValue(c);this.fireEvent("select",this,c);this.menu.hide()},onMenuHide:function(){this.focus(false,60);this.menuEvents("un")},beforeBlur:function(){var b=this.parseDate(this.getRawValue());if(b){this.setValue(b)}}});Ext.reg("datefield",Ext.form.DateField);Ext.form.DisplayField=Ext.extend(Ext.form.Field,{validationEvent:false,validateOnBlur:false,defaultAutoCreate:{tag:"div"},fieldClass:"x-form-display-field",htmlEncode:false,initEvents:Ext.emptyFn,isValid:function(){return true},validate:function(){return true},getRawValue:function(){var b=this.rendered?this.el.dom.innerHTML:Ext.value(this.value,"");if(b===this.emptyText){b=""}if(this.htmlEncode){b=Ext.util.Format.htmlDecode(b)}return b},getValue:function(){return this.getRawValue()},getName:function(){return this.name},setRawValue:function(b){if(this.htmlEncode){b=Ext.util.Format.htmlEncode(b)}return this.rendered?(this.el.dom.innerHTML=(Ext.isEmpty(b)?"":b)):(this.value=b)},setValue:function(b){this.setRawValue(b);return this}});Ext.reg("displayfield",Ext.form.DisplayField);Ext.form.ComboBox=Ext.extend(Ext.form.TriggerField,{defaultAutoCreate:{tag:"input",type:"text",size:"24",autocomplete:"off"},listClass:"",selectedClass:"x-combo-selected",listEmptyText:"",triggerClass:"x-form-arrow-trigger",shadow:"sides",listAlign:"tl-bl?",maxHeight:300,minHeight:90,triggerAction:"query",minChars:4,autoSelect:true,typeAhead:false,queryDelay:500,pageSize:0,selectOnFocus:false,queryParam:"query",loadingText:"Loading...",resizable:false,handleHeight:8,allQuery:"",mode:"remote",minListWidth:70,forceSelection:false,typeAheadDelay:250,lazyInit:true,clearFilterOnReset:true,submitValue:undefined,initComponent:function(){Ext.form.ComboBox.superclass.initComponent.call(this);this.addEvents("expand","collapse","beforeselect","select","beforequery");if(this.transform){var p=Ext.getDom(this.transform);if(!this.hiddenName){this.hiddenName=p.name}if(!this.store){this.mode="local";var l=[],o=p.options;for(var d=0,i=o.length;d<i;d++){var m=o[d],n=(m.hasAttribute?m.hasAttribute("value"):m.getAttributeNode("value").specified)?m.value:m.text;if(m.selected&&Ext.isEmpty(this.value,true)){this.value=n}l.push([n,m.text])}this.store=new Ext.data.ArrayStore({idIndex:0,fields:["value","text"],data:l,autoDestroy:true});this.valueField="value";this.displayField="text"}p.name=Ext.id();if(!this.lazyRender){this.target=true;this.el=Ext.DomHelper.insertBefore(p,this.autoCreate||this.defaultAutoCreate);this.render(this.el.parentNode,p)}Ext.removeNode(p)}else{if(this.store){this.store=Ext.StoreMgr.lookup(this.store);
if(this.store.autoCreated){this.displayField=this.valueField="field1";if(!this.store.expandData){this.displayField="field2"}this.mode="local"}}}this.selectedIndex=-1;if(this.mode=="local"){if(!Ext.isDefined(this.initialConfig.queryDelay)){this.queryDelay=10}if(!Ext.isDefined(this.initialConfig.minChars)){this.minChars=0}}},onRender:function(c,d){if(this.hiddenName&&!Ext.isDefined(this.submitValue)){this.submitValue=false}Ext.form.ComboBox.superclass.onRender.call(this,c,d);if(this.hiddenName){this.hiddenField=this.el.insertSibling({tag:"input",type:"hidden",name:this.hiddenName,id:(this.hiddenId||Ext.id())},"before",true)}if(Ext.isGecko){this.el.dom.setAttribute("autocomplete","off")}if(!this.lazyInit){this.initList()}else{this.on("focus",this.initList,this,{single:true})}},initValue:function(){Ext.form.ComboBox.superclass.initValue.call(this);if(this.hiddenField){this.hiddenField.value=Ext.value(Ext.isDefined(this.hiddenValue)?this.hiddenValue:this.value,"")}},getParentZIndex:function(){var b;if(this.ownerCt){this.findParentBy(function(a){b=parseInt(a.getPositionEl().getStyle("z-index"),10);return !!b})}return b},getZIndex:function(c){c=c||Ext.getDom(this.getListParent()||Ext.getBody());var d=parseInt(Ext.fly(c).getStyle("z-index"),10);if(!d){d=this.getParentZIndex()}return(d||12000)+5},initList:function(){if(!this.list){var e="x-combo-list",g=Ext.getDom(this.getListParent()||Ext.getBody());this.list=new Ext.Layer({parentEl:g,shadow:this.shadow,cls:[e,this.listClass].join(" "),constrain:false,zindex:this.getZIndex(g)});var d=this.listWidth||Math.max(this.wrap.getWidth(),this.minListWidth);this.list.setSize(d,0);this.list.swallowEvent("mousewheel");this.assetHeight=0;if(this.syncFont!==false){this.list.setStyle("font-size",this.el.getStyle("font-size"))}if(this.title){this.header=this.list.createChild({cls:e+"-hd",html:this.title});this.assetHeight+=this.header.getHeight()}this.innerList=this.list.createChild({cls:e+"-inner"});this.mon(this.innerList,"mouseover",this.onViewOver,this);this.mon(this.innerList,"mousemove",this.onViewMove,this);this.innerList.setWidth(d-this.list.getFrameWidth("lr"));if(this.pageSize){this.footer=this.list.createChild({cls:e+"-ft"});this.pageTb=new Ext.PagingToolbar({store:this.store,pageSize:this.pageSize,renderTo:this.footer});this.assetHeight+=this.footer.getHeight()}if(!this.tpl){this.tpl='<tpl for="."><div class="'+e+'-item">{'+this.displayField+"}</div></tpl>"}this.view=new Ext.DataView({applyTo:this.innerList,tpl:this.tpl,singleSelect:true,selectedClass:this.selectedClass,itemSelector:this.itemSelector||"."+e+"-item",emptyText:this.listEmptyText,deferEmptyText:false});this.mon(this.view,{containerclick:this.onViewClick,click:this.onViewClick,scope:this});this.bindStore(this.store,true);if(this.resizable){this.resizer=new Ext.Resizable(this.list,{pinned:true,handles:"se"});this.mon(this.resizer,"resize",function(a,c,b){this.maxHeight=b-this.handleHeight-this.list.getFrameWidth("tb")-this.assetHeight;this.listWidth=c;this.innerList.setWidth(c-this.list.getFrameWidth("lr"));this.restrictHeight()},this);this[this.pageSize?"footer":"innerList"].setStyle("margin-bottom",this.handleHeight+"px")}}},getListParent:function(){return document.body},getStore:function(){return this.store},bindStore:function(d,c){if(this.store&&!c){if(this.store!==d&&this.store.autoDestroy){this.store.destroy()}else{this.store.un("beforeload",this.onBeforeLoad,this);this.store.un("load",this.onLoad,this);this.store.un("exception",this.collapse,this)}if(!d){this.store=null;if(this.view){this.view.bindStore(null)}if(this.pageTb){this.pageTb.bindStore(null)}}}if(d){if(!c){this.lastQuery=null;if(this.pageTb){this.pageTb.bindStore(d)}}this.store=Ext.StoreMgr.lookup(d);this.store.on({scope:this,beforeload:this.onBeforeLoad,load:this.onLoad,exception:this.collapse});if(this.view){this.view.bindStore(d)}}},reset:function(){if(this.clearFilterOnReset&&this.mode=="local"){this.store.clearFilter()}Ext.form.ComboBox.superclass.reset.call(this)
},initEvents:function(){Ext.form.ComboBox.superclass.initEvents.call(this);this.keyNav=new Ext.KeyNav(this.el,{up:function(b){this.inKeyMode=true;this.selectPrev()},down:function(b){if(!this.isExpanded()){this.onTriggerClick()}else{this.inKeyMode=true;this.selectNext()}},enter:function(b){this.onViewClick()},esc:function(b){this.collapse()},tab:function(b){if(this.forceSelection===true){this.collapse()}else{this.onViewClick(false)}return true},scope:this,doRelay:function(i,e,g){if(g=="down"||this.scope.isExpanded()){var h=Ext.KeyNav.prototype.doRelay.apply(this,arguments);if(!Ext.isIE&&Ext.EventManager.useKeydown){this.scope.fireKey(i)}return h}return true},forceKeyDown:true,defaultEventAction:"stopEvent"});this.queryDelay=Math.max(this.queryDelay||10,this.mode=="local"?10:250);this.dqTask=new Ext.util.DelayedTask(this.initQuery,this);if(this.typeAhead){this.taTask=new Ext.util.DelayedTask(this.onTypeAhead,this)}if(!this.enableKeyEvents){this.mon(this.el,"keyup",this.onKeyUp,this)}},onDestroy:function(){if(this.dqTask){this.dqTask.cancel();this.dqTask=null}this.bindStore(null);Ext.destroy(this.resizer,this.view,this.pageTb,this.list);Ext.destroyMembers(this,"hiddenField");Ext.form.ComboBox.superclass.onDestroy.call(this)},fireKey:function(b){if(!this.isExpanded()){Ext.form.ComboBox.superclass.fireKey.call(this,b)}},onResize:function(d,c){Ext.form.ComboBox.superclass.onResize.apply(this,arguments);if(!isNaN(d)&&this.isVisible()&&this.list){this.doResize(d)}else{this.bufferSize=d}},doResize:function(d){if(!Ext.isDefined(this.listWidth)){var c=Math.max(d,this.minListWidth);this.list.setWidth(c);this.innerList.setWidth(c-this.list.getFrameWidth("lr"))}},onEnable:function(){Ext.form.ComboBox.superclass.onEnable.apply(this,arguments);if(this.hiddenField){this.hiddenField.disabled=false}},onDisable:function(){Ext.form.ComboBox.superclass.onDisable.apply(this,arguments);if(this.hiddenField){this.hiddenField.disabled=true}},onBeforeLoad:function(){if(!this.hasFocus){return}this.innerList.update(this.loadingText?'<div class="loading-indicator">'+this.loadingText+"</div>":"");this.restrictHeight();this.selectedIndex=-1},onLoad:function(){if(!this.hasFocus){return}if(this.store.getCount()>0||this.listEmptyText){this.expand();this.restrictHeight();if(this.lastQuery==this.allQuery){if(this.editable){this.el.dom.select()}if(this.autoSelect!==false&&!this.selectByValue(this.value,true)){this.select(0,true)}}else{if(this.autoSelect!==false){this.selectNext()}if(this.typeAhead&&this.lastKey!=Ext.EventObject.BACKSPACE&&this.lastKey!=Ext.EventObject.DELETE){this.taTask.delay(this.typeAheadDelay)}}}else{this.collapse()}},onTypeAhead:function(){if(this.store.getCount()>0){var e=this.store.getAt(0);var i=e.data[this.displayField];var g=i.length;var h=this.getRawValue().length;if(h!=g){this.setRawValue(i);this.selectText(h,i.length)}}},assertValue:function(){var c=this.getRawValue(),d=this.findRecord(this.displayField,c);if(!d&&this.forceSelection){if(c.length>0&&c!=this.emptyText){this.el.dom.value=Ext.value(this.lastSelectionText,"");this.applyEmptyText()}else{this.clearValue()}}else{if(d){if(c==d.get(this.displayField)&&this.value==d.get(this.valueField)){return}c=d.get(this.valueField||this.displayField)}this.setValue(c)}},onSelect:function(d,c){if(this.fireEvent("beforeselect",this,d,c)!==false){this.setValue(d.data[this.valueField||this.displayField]);this.collapse();this.fireEvent("select",this,d,c)}},getName:function(){var b=this.hiddenField;return b&&b.name?b.name:this.hiddenName||Ext.form.ComboBox.superclass.getName.call(this)},getValue:function(){if(this.valueField){return Ext.isDefined(this.value)?this.value:""}else{return Ext.form.ComboBox.superclass.getValue.call(this)}},clearValue:function(){if(this.hiddenField){this.hiddenField.value=""}this.setRawValue("");this.lastSelectionText="";this.applyEmptyText();this.value=""},setValue:function(e){var g=e;if(this.valueField){var d=this.findRecord(this.valueField,e);if(d){g=d.data[this.displayField]
}else{if(Ext.isDefined(this.valueNotFoundText)){g=this.valueNotFoundText}}}this.lastSelectionText=g;if(this.hiddenField){this.hiddenField.value=Ext.value(e,"")}Ext.form.ComboBox.superclass.setValue.call(this,g);this.value=e;return this},findRecord:function(g,d){var e;if(this.store.getCount()>0){this.store.each(function(a){if(a.data[g]==d){e=a;return false}})}return e},onViewMove:function(c,d){this.inKeyMode=false},onViewOver:function(h,e){if(this.inKeyMode){return}var i=this.view.findItemFromChild(e);if(i){var g=this.view.indexOf(i);this.select(g,false)}},onViewClick:function(e){var g=this.view.getSelectedIndexes()[0],i=this.store,h=i.getAt(g);if(h){this.onSelect(h,g)}else{this.collapse()}if(e!==false){this.el.focus()}},restrictHeight:function(){this.innerList.dom.style.height="";var h=this.innerList.dom,l=this.list.getFrameWidth("tb")+(this.resizable?this.handleHeight:0)+this.assetHeight,n=Math.max(h.clientHeight,h.offsetHeight,h.scrollHeight),i=this.getPosition()[1]-Ext.getBody().getScroll().top,k=Ext.lib.Dom.getViewHeight()-i-this.getSize().height,m=Math.max(i,k,this.minHeight||0)-this.list.shadowOffset-l-5;n=Math.min(n,m,this.maxHeight);this.innerList.setHeight(n);this.list.beginUpdate();this.list.setHeight(n+l);this.list.alignTo.apply(this.list,[this.el].concat(this.listAlign));this.list.endUpdate()},isExpanded:function(){return this.list&&this.list.isVisible()},selectByValue:function(e,g){if(!Ext.isEmpty(e,true)){var d=this.findRecord(this.valueField||this.displayField,e);if(d){this.select(this.store.indexOf(d),g);return true}}return false},select:function(e,g){this.selectedIndex=e;this.view.select(e);if(g!==false){var d=this.view.getNode(e);if(d){this.innerList.scrollChildIntoView(d,false)}}},selectNext:function(){var b=this.store.getCount();if(b>0){if(this.selectedIndex==-1){this.select(0)}else{if(this.selectedIndex<b-1){this.select(this.selectedIndex+1)}}}},selectPrev:function(){var b=this.store.getCount();if(b>0){if(this.selectedIndex==-1){this.select(0)}else{if(this.selectedIndex!==0){this.select(this.selectedIndex-1)}}}},onKeyUp:function(c){var d=c.getKey();if(this.editable!==false&&this.readOnly!==true&&(d==c.BACKSPACE||!c.isSpecialKey())){this.lastKey=d;this.dqTask.delay(this.queryDelay)}Ext.form.ComboBox.superclass.onKeyUp.call(this,c)},validateBlur:function(){return !this.list||!this.list.isVisible()},initQuery:function(){this.doQuery(this.getRawValue())},beforeBlur:function(){this.assertValue()},postBlur:function(){Ext.form.ComboBox.superclass.postBlur.call(this);this.collapse();this.inKeyMode=false},doQuery:function(g,d){g=Ext.isEmpty(g)?"":g;var e={query:g,forceAll:d,combo:this,cancel:false};if(this.fireEvent("beforequery",e)===false||e.cancel){return false}g=e.query;d=e.forceAll;if(d===true||(g.length>=this.minChars)){if(this.lastQuery!==g){this.lastQuery=g;if(this.mode=="local"){this.selectedIndex=-1;if(d){this.store.clearFilter()}else{this.store.filter(this.displayField,g)}this.onLoad()}else{this.store.baseParams[this.queryParam]=g;this.store.load({params:this.getParams(g)});this.expand()}}else{this.selectedIndex=-1;this.onLoad()}}},getParams:function(e){var d={},g=this.store.paramNames;if(this.pageSize){d[g.start]=0;d[g.limit]=this.pageSize}return d},collapse:function(){if(!this.isExpanded()){return}this.list.hide();Ext.getDoc().un("mousewheel",this.collapseIf,this);Ext.getDoc().un("mousedown",this.collapseIf,this);this.fireEvent("collapse",this)},collapseIf:function(b){if(!this.isDestroyed&&!b.within(this.wrap)&&!b.within(this.list)){this.collapse()}},expand:function(){if(this.isExpanded()||!this.hasFocus){return}if(this.title||this.pageSize){this.assetHeight=0;if(this.title){this.assetHeight+=this.header.getHeight()}if(this.pageSize){this.assetHeight+=this.footer.getHeight()}}if(this.bufferSize){this.doResize(this.bufferSize);delete this.bufferSize}this.list.alignTo.apply(this.list,[this.el].concat(this.listAlign));this.list.setZIndex(this.getZIndex());this.list.show();if(Ext.isGecko2){this.innerList.setOverflow("auto")
}this.mon(Ext.getDoc(),{scope:this,mousewheel:this.collapseIf,mousedown:this.collapseIf});this.fireEvent("expand",this)},onTriggerClick:function(){if(this.readOnly||this.disabled){return}if(this.isExpanded()){this.collapse();this.el.focus()}else{this.onFocus({});if(this.triggerAction=="all"){this.doQuery(this.allQuery,true)}else{this.doQuery(this.getRawValue())}this.el.focus()}}});Ext.reg("combo",Ext.form.ComboBox);Ext.form.Checkbox=Ext.extend(Ext.form.Field,{focusClass:undefined,fieldClass:"x-form-field",checked:false,boxLabel:"&#160;",defaultAutoCreate:{tag:"input",type:"checkbox",autocomplete:"off"},actionMode:"wrap",initComponent:function(){Ext.form.Checkbox.superclass.initComponent.call(this);this.addEvents("check")},onResize:function(){Ext.form.Checkbox.superclass.onResize.apply(this,arguments);if(!this.boxLabel&&!this.fieldLabel){this.el.alignTo(this.wrap,"c-c")}},initEvents:function(){Ext.form.Checkbox.superclass.initEvents.call(this);this.mon(this.el,{scope:this,click:this.onClick,change:this.onClick})},markInvalid:Ext.emptyFn,clearInvalid:Ext.emptyFn,onRender:function(c,d){Ext.form.Checkbox.superclass.onRender.call(this,c,d);if(this.inputValue!==undefined){this.el.dom.value=this.inputValue}this.wrap=this.el.wrap({cls:"x-form-check-wrap"});if(this.boxLabel){this.wrap.createChild({tag:"label",htmlFor:this.el.id,cls:"x-form-cb-label",html:this.boxLabel})}if(this.checked){this.setValue(true)}else{this.checked=this.el.dom.checked}if(Ext.isIE&&!Ext.isStrict){this.wrap.repaint()}this.resizeEl=this.positionEl=this.wrap},onDestroy:function(){Ext.destroy(this.wrap);Ext.form.Checkbox.superclass.onDestroy.call(this)},initValue:function(){this.originalValue=this.getValue()},getValue:function(){if(this.rendered){return this.el.dom.checked}return this.checked},onClick:function(){if(this.el.dom.checked!=this.checked){this.setValue(this.el.dom.checked)}},setValue:function(e){var g=this.checked,d=this.inputValue;this.checked=(e===true||e==="true"||e=="1"||(d?e==d:String(e).toLowerCase()=="on"));if(this.rendered){this.el.dom.checked=this.checked;this.el.dom.defaultChecked=this.checked}if(g!=this.checked){this.fireEvent("check",this,this.checked);if(this.handler){this.handler.call(this.scope||this,this,this.checked)}}return this}});Ext.reg("checkbox",Ext.form.Checkbox);Ext.form.CheckboxGroup=Ext.extend(Ext.form.Field,{columns:"auto",vertical:false,allowBlank:true,blankText:"You must select at least one item in this group",defaultType:"checkbox",groupCls:"x-form-check-group",initComponent:function(){this.addEvents("change");this.on("change",this.validate,this);Ext.form.CheckboxGroup.superclass.initComponent.call(this)},onRender:function(x,z){if(!this.el){var i={autoEl:{id:this.id},cls:this.groupCls,layout:"column",renderTo:x,bufferResize:false};var E={xtype:"container",defaultType:this.defaultType,layout:"form",defaults:{hideLabel:true,anchor:"100%"}};if(this.items[0].items){Ext.apply(i,{layoutConfig:{columns:this.items.length},defaults:this.defaults,items:this.items});for(var A=0,v=this.items.length;A<v;A++){Ext.applyIf(this.items[A],E)}}else{var B,u=[];if(typeof this.columns=="string"){this.columns=this.items.length}if(!Ext.isArray(this.columns)){var w=[];for(var A=0;A<this.columns;A++){w.push((100/this.columns)*0.01)}this.columns=w}B=this.columns.length;for(var A=0;A<B;A++){var D=Ext.apply({items:[]},E);D[this.columns[A]<=1?"columnWidth":"width"]=this.columns[A];if(this.defaults){D.defaults=Ext.apply(D.defaults||{},this.defaults)}u.push(D)}if(this.vertical){var F=Math.ceil(this.items.length/B),l=0;for(var A=0,v=this.items.length;A<v;A++){if(A>0&&A%F==0){l++}if(this.items[A].fieldLabel){this.items[A].hideLabel=false}u[l].items.push(this.items[A])}}else{for(var A=0,v=this.items.length;A<v;A++){var G=A%B;if(this.items[A].fieldLabel){this.items[A].hideLabel=false}u[G].items.push(this.items[A])}}Ext.apply(i,{layoutConfig:{columns:B},items:u})}this.panel=new Ext.Container(i);this.panel.ownerCt=this;this.el=this.panel.getEl();if(this.forId&&this.itemCls){var C=this.el.up(this.itemCls).child("label",true);
if(C){C.setAttribute("htmlFor",this.forId)}}var y=this.panel.findBy(function(a){return a.isFormField},this);this.items=new Ext.util.MixedCollection();this.items.addAll(y)}Ext.form.CheckboxGroup.superclass.onRender.call(this,x,z)},initValue:function(){if(this.value){this.setValue.apply(this,this.buffered?this.value:[this.value]);delete this.buffered;delete this.value}},afterRender:function(){Ext.form.CheckboxGroup.superclass.afterRender.call(this);this.eachItem(function(b){b.on("check",this.fireChecked,this);b.inGroup=true})},doLayout:function(){if(this.rendered){this.panel.forceLayout=this.ownerCt.forceLayout;this.panel.doLayout()}},fireChecked:function(){var b=[];this.eachItem(function(a){if(a.checked){b.push(a)}});this.fireEvent("change",this,b)},getErrors:function(){var c=Ext.form.CheckboxGroup.superclass.getErrors.apply(this,arguments);if(!this.allowBlank){var d=true;this.eachItem(function(a){if(a.checked){return(d=false)}});if(d){c.push(this.blankText)}}return c},isDirty:function(){if(this.disabled||!this.rendered){return false}var b=false;this.eachItem(function(a){if(a.isDirty()){b=true;return false}});return b},setReadOnly:function(b){if(this.rendered){this.eachItem(function(a){a.setReadOnly(b)})}this.readOnly=b},onDisable:function(){this.eachItem(function(b){b.disable()})},onEnable:function(){this.eachItem(function(b){b.enable()})},onResize:function(d,c){this.panel.setSize(d,c);this.panel.doLayout()},reset:function(){if(this.originalValue){this.eachItem(function(b){if(b.setValue){b.setValue(false);b.originalValue=b.getValue()}});this.resetOriginal=true;this.setValue(this.originalValue);delete this.resetOriginal}else{this.eachItem(function(b){if(b.reset){b.reset()}})}(function(){this.clearInvalid()}).defer(50,this)},setValue:function(){if(this.rendered){this.onSetValue.apply(this,arguments)}else{this.buffered=true;this.value=arguments}return this},onSetValue:function(h,i){if(arguments.length==1){if(Ext.isArray(h)){Ext.each(h,function(a,c){if(Ext.isObject(a)&&a.setValue){a.setValue(true);if(this.resetOriginal===true){a.originalValue=a.getValue()}}else{var b=this.items.itemAt(c);if(b){b.setValue(a)}}},this)}else{if(Ext.isObject(h)){for(var g in h){var e=this.getBox(g);if(e){e.setValue(h[g])}}}else{this.setValueForItem(h)}}}else{var e=this.getBox(h);if(e){e.setValue(i)}}},beforeDestroy:function(){Ext.destroy(this.panel);if(!this.rendered){Ext.destroy(this.items)}Ext.form.CheckboxGroup.superclass.beforeDestroy.call(this)},setValueForItem:function(b){b=String(b).split(",");this.eachItem(function(a){if(b.indexOf(a.inputValue)>-1){a.setValue(true)}})},getBox:function(c){var d=null;this.eachItem(function(a){if(c==a||a.dataIndex==c||a.id==c||a.getName()==c){d=a;return false}});return d},getValue:function(){var b=[];this.eachItem(function(a){if(a.checked){b.push(a)}});return b},eachItem:function(c,d){if(this.items&&this.items.each){this.items.each(c,d||this)}},getRawValue:Ext.emptyFn,setRawValue:Ext.emptyFn});Ext.reg("checkboxgroup",Ext.form.CheckboxGroup);Ext.form.CompositeField=Ext.extend(Ext.form.Field,{defaultMargins:"0 5 0 0",skipLastItemMargin:true,isComposite:true,combineErrors:true,labelConnector:", ",initComponent:function(){var k=[],h=this.items,l;for(var m=0,n=h.length;m<n;m++){l=h[m];k.push(l.fieldLabel);Ext.applyIf(l,this.defaults);if(!(m==n-1&&this.skipLastItemMargin)){Ext.applyIf(l,{margins:this.defaultMargins})}}this.fieldLabel=this.fieldLabel||this.buildLabel(k);this.fieldErrors=new Ext.util.MixedCollection(true,function(a){return a.field});this.fieldErrors.on({scope:this,add:this.updateInvalidMark,remove:this.updateInvalidMark,replace:this.updateInvalidMark});Ext.form.CompositeField.superclass.initComponent.apply(this,arguments);this.innerCt=new Ext.Container({layout:"hbox",items:this.items,cls:"x-form-composite",defaultMargins:"0 3 0 0"});var i=this.innerCt.findBy(function(a){return a.isFormField},this);this.items=new Ext.util.MixedCollection();this.items.addAll(i)},onRender:function(i,g){if(!this.el){var h=this.innerCt;
h.render(i);this.el=h.getEl();if(this.combineErrors){this.eachItem(function(a){Ext.apply(a,{markInvalid:this.onFieldMarkInvalid.createDelegate(this,[a],0),clearInvalid:this.onFieldClearInvalid.createDelegate(this,[a],0)})})}var e=this.el.parent().parent().child("label",true);if(e){e.setAttribute("for",this.items.items[0].id)}}Ext.form.CompositeField.superclass.onRender.apply(this,arguments)},onFieldMarkInvalid:function(h,i){var e=h.getName(),g={field:e,errorName:h.fieldLabel||e,error:i};this.fieldErrors.replace(e,g);h.el.addClass(h.invalidClass)},onFieldClearInvalid:function(b){this.fieldErrors.removeKey(b.getName());b.el.removeClass(b.invalidClass)},updateInvalidMark:function(){var d=Ext.isIE6&&Ext.isStrict;if(this.fieldErrors.length==0){this.clearInvalid();if(d){this.clearInvalid.defer(50,this)}}else{var c=this.buildCombinedErrorMessage(this.fieldErrors.items);this.sortErrors();this.markInvalid(c);if(d){this.markInvalid(c)}}},validateValue:function(){var b=true;this.eachItem(function(a){if(!a.isValid()){b=false}});return b},buildCombinedErrorMessage:function(i){var k=[],g;for(var l=0,h=i.length;l<h;l++){g=i[l];k.push(String.format("{0}: {1}",g.errorName,g.error))}return k.join("<br />")},sortErrors:function(){var b=this.items;this.fieldErrors.sort("ASC",function(i,l){var m=function(c){return function(d){return d.getName()==c}};var a=b.findIndexBy(m(i.field)),k=b.findIndexBy(m(l.field));return a<k?-1:1})},reset:function(){this.eachItem(function(b){b.reset()});(function(){this.clearInvalid()}).defer(50,this)},clearInvalidChildren:function(){this.eachItem(function(b){b.clearInvalid()})},buildLabel:function(b){return Ext.clean(b).join(this.labelConnector)},isDirty:function(){if(this.disabled||!this.rendered){return false}var b=false;this.eachItem(function(a){if(a.isDirty()){b=true;return false}});return b},eachItem:function(c,d){if(this.items&&this.items.each){this.items.each(c,d||this)}},onResize:function(i,l,h,k){var g=this.innerCt;if(this.rendered&&g.rendered){g.setSize(i,l)}Ext.form.CompositeField.superclass.onResize.apply(this,arguments)},doLayout:function(g,d){if(this.rendered){var e=this.innerCt;e.forceLayout=this.ownerCt.forceLayout;e.doLayout(g,d)}},beforeDestroy:function(){Ext.destroy(this.innerCt);Ext.form.CompositeField.superclass.beforeDestroy.call(this)},setReadOnly:function(b){if(b==undefined){b=true}b=!!b;if(this.rendered){this.eachItem(function(a){a.setReadOnly(b)})}this.readOnly=b},onShow:function(){Ext.form.CompositeField.superclass.onShow.call(this);this.doLayout()},onDisable:function(){this.eachItem(function(b){b.disable()})},onEnable:function(){this.eachItem(function(b){b.enable()})}});Ext.reg("compositefield",Ext.form.CompositeField);Ext.form.Radio=Ext.extend(Ext.form.Checkbox,{inputType:"radio",markInvalid:Ext.emptyFn,clearInvalid:Ext.emptyFn,getGroupValue:function(){var d=this.el.up("form")||Ext.getBody();var c=d.child("input[name="+this.el.dom.name+"]:checked",true);return c?c.value:null},setValue:function(e){var g,h,i;if(typeof e=="boolean"){Ext.form.Radio.superclass.setValue.call(this,e)}else{if(this.rendered){g=this.getCheckEl();i=g.child("input[name="+this.el.dom.name+"][value="+e+"]",true);if(i){Ext.getCmp(i.id).setValue(true)}}}if(this.rendered&&this.checked){g=g||this.getCheckEl();h=this.getCheckEl().select("input[name="+this.el.dom.name+"]");h.each(function(a){if(a.dom.id!=this.id){Ext.getCmp(a.dom.id).setValue(false)}},this)}return this},getCheckEl:function(){if(this.inGroup){return this.el.up(".x-form-radio-group")}return this.el.up("form")||Ext.getBody()}});Ext.reg("radio",Ext.form.Radio);Ext.form.RadioGroup=Ext.extend(Ext.form.CheckboxGroup,{allowBlank:true,blankText:"You must select one item in this group",defaultType:"radio",groupCls:"x-form-radio-group",getValue:function(){var b=null;this.eachItem(function(a){if(a.checked){b=a;return false}});return b},onSetValue:function(g,d){if(arguments.length>1){var e=this.getBox(g);if(e){e.setValue(d);if(e.checked){this.eachItem(function(a){if(a!==e){a.setValue(false)
}})}}}else{this.setValueForItem(g)}},setValueForItem:function(b){b=String(b).split(",")[0];this.eachItem(function(a){a.setValue(b==a.inputValue)})},fireChecked:function(){if(!this.checkTask){this.checkTask=new Ext.util.DelayedTask(this.bufferChecked,this)}this.checkTask.delay(10)},bufferChecked:function(){var b=null;this.eachItem(function(a){if(a.checked){b=a;return false}});this.fireEvent("change",this,b)},onDestroy:function(){if(this.checkTask){this.checkTask.cancel();this.checkTask=null}Ext.form.RadioGroup.superclass.onDestroy.call(this)}});Ext.reg("radiogroup",Ext.form.RadioGroup);Ext.form.Hidden=Ext.extend(Ext.form.Field,{inputType:"hidden",shouldLayout:false,onRender:function(){Ext.form.Hidden.superclass.onRender.apply(this,arguments)},initEvents:function(){this.originalValue=this.getValue()},setSize:Ext.emptyFn,setWidth:Ext.emptyFn,setHeight:Ext.emptyFn,setPosition:Ext.emptyFn,setPagePosition:Ext.emptyFn,markInvalid:Ext.emptyFn,clearInvalid:Ext.emptyFn});Ext.reg("hidden",Ext.form.Hidden);Ext.form.BasicForm=Ext.extend(Ext.util.Observable,{constructor:function(c,d){Ext.apply(this,d);if(Ext.isString(this.paramOrder)){this.paramOrder=this.paramOrder.split(/[\s,|]/)}this.items=new Ext.util.MixedCollection(false,function(a){return a.getItemId()});this.addEvents("beforeaction","actionfailed","actioncomplete");if(c){this.initEl(c)}Ext.form.BasicForm.superclass.constructor.call(this)},timeout:30,paramOrder:undefined,paramsAsHash:false,waitTitle:"Please Wait...",activeAction:null,trackResetOnLoad:false,initEl:function(b){this.el=Ext.get(b);this.id=this.el.id||Ext.id();if(!this.standardSubmit){this.el.on("submit",this.onSubmit,this)}this.el.addClass("x-form")},getEl:function(){return this.el},onSubmit:function(b){b.stopEvent()},destroy:function(b){if(b!==true){this.items.each(function(a){Ext.destroy(a)});Ext.destroy(this.el)}this.items.clear();this.purgeListeners()},isValid:function(){var b=true;this.items.each(function(a){if(!a.validate()){b=false}});return b},isDirty:function(){var b=false;this.items.each(function(a){if(a.isDirty()){b=true;return false}});return b},doAction:function(c,d){if(Ext.isString(c)){c=new Ext.form.Action.ACTION_TYPES[c](this,d)}if(this.fireEvent("beforeaction",this,c)!==false){this.beforeAction(c);c.run.defer(100,c)}return this},submit:function(e){e=e||{};if(this.standardSubmit){var g=e.clientValidation===false||this.isValid();if(g){var i=this.el.dom;if(this.url&&Ext.isEmpty(i.action)){i.action=this.url}i.submit()}return g}var h=String.format("{0}submit",this.api?"direct":"");this.doAction(h,e);return this},load:function(d){var c=String.format("{0}load",this.api?"direct":"");this.doAction(c,d);return this},updateRecord:function(c){c.beginEdit();var d=c.fields;d.each(function(b){var a=this.findField(b.name);if(a){var g=a.getValue();if(g.getGroupValue){g=g.getGroupValue()}else{if(a.eachItem){g=[];a.eachItem(function(e){g.push(e.getValue())})}}c.set(b.name,g)}},this);c.endEdit();return this},loadRecord:function(b){this.setValues(b.data);return this},beforeAction:function(d){this.items.each(function(a){if(a.isFormField&&a.syncValue){a.syncValue()}});var c=d.options;if(c.waitMsg){if(this.waitMsgTarget===true){this.el.mask(c.waitMsg,"x-mask-loading")}else{if(this.waitMsgTarget){this.waitMsgTarget=Ext.get(this.waitMsgTarget);this.waitMsgTarget.mask(c.waitMsg,"x-mask-loading")}else{Ext.MessageBox.wait(c.waitMsg,c.waitTitle||this.waitTitle)}}}},afterAction:function(e,g){this.activeAction=null;var d=e.options;if(d.waitMsg){if(this.waitMsgTarget===true){this.el.unmask()}else{if(this.waitMsgTarget){this.waitMsgTarget.unmask()}else{Ext.MessageBox.updateProgress(1);Ext.MessageBox.hide()}}}if(g){if(d.reset){this.reset()}Ext.callback(d.success,d.scope,[this,e]);this.fireEvent("actioncomplete",this,e)}else{Ext.callback(d.failure,d.scope,[this,e]);this.fireEvent("actionfailed",this,e)}},findField:function(g){var d=this.items.get(g);if(!Ext.isObject(d)){var e=function(a){if(a.isFormField){if(a.dataIndex==g||a.id==g||a.getName()==g){d=a;
return false}else{if(a.isComposite){return a.items.each(e)}else{if(a instanceof Ext.form.CheckboxGroup&&a.rendered){return a.eachItem(e)}}}}};this.items.each(e)}return d||null},markInvalid:function(l){if(Ext.isArray(l)){for(var p=0,k=l.length;p<k;p++){var i=l[p];var o=this.findField(i.id);if(o){o.markInvalid(i.msg)}}}else{var n,m;for(m in l){if(!Ext.isFunction(l[m])&&(n=this.findField(m))){n.markInvalid(l[m])}}}return this},setValues:function(p){if(Ext.isArray(p)){for(var o=0,k=p.length;o<k;o++){var i=p[o];var n=this.findField(i.id);if(n){n.setValue(i.value);if(this.trackResetOnLoad){n.originalValue=n.getValue()}}}}else{var m,l;for(l in p){if(!Ext.isFunction(p[l])&&(m=this.findField(l))){m.setValue(p[l]);if(this.trackResetOnLoad){m.originalValue=m.getValue()}}}}return this},getValues:function(c){var d=Ext.lib.Ajax.serializeForm(this.el.dom);if(c===true){return d}return Ext.urlDecode(d)},getFieldValues:function(h){var k={},i,g,l;this.items.each(function(a){if(!a.disabled&&(h!==true||a.isDirty())){i=a.getName();g=k[i];l=a.getValue();if(Ext.isDefined(g)){if(Ext.isArray(g)){k[i].push(l)}else{k[i]=[g,l]}}else{k[i]=l}}});return k},clearInvalid:function(){this.items.each(function(b){b.clearInvalid()});return this},reset:function(){this.items.each(function(b){b.reset()});return this},add:function(){this.items.addAll(Array.prototype.slice.call(arguments,0));return this},remove:function(b){this.items.remove(b);return this},cleanDestroyed:function(){this.items.filterBy(function(b){return !!b.isDestroyed}).each(this.remove,this)},render:function(){this.items.each(function(b){if(b.isFormField&&!b.rendered&&document.getElementById(b.id)){b.applyToMarkup(b.id)}});return this},applyToFields:function(b){this.items.each(function(a){Ext.apply(a,b)});return this},applyIfToFields:function(b){this.items.each(function(a){Ext.applyIf(a,b)});return this},callFieldMethod:function(c,d){d=d||[];this.items.each(function(a){if(Ext.isFunction(a[c])){a[c].apply(a,d)}});return this}});Ext.BasicForm=Ext.form.BasicForm;Ext.FormPanel=Ext.extend(Ext.Panel,{minButtonWidth:75,labelAlign:"left",monitorValid:false,monitorPoll:200,layout:"form",initComponent:function(){this.form=this.createForm();Ext.FormPanel.superclass.initComponent.call(this);this.bodyCfg={tag:"form",cls:this.baseCls+"-body",method:this.method||"POST",id:this.formId||Ext.id()};if(this.fileUpload){this.bodyCfg.enctype="multipart/form-data"}this.initItems();this.addEvents("clientvalidation");this.relayEvents(this.form,["beforeaction","actionfailed","actioncomplete"])},createForm:function(){var b=Ext.applyIf({listeners:{}},this.initialConfig);return new Ext.form.BasicForm(null,b)},initFields:function(){var g=this.form;var e=this;var d=function(a){if(e.isField(a)){g.add(a)}else{if(a.findBy&&a!=e){e.applySettings(a);if(a.items&&a.items.each){a.items.each(d,this)}}}};this.items.each(d,this)},applySettings:function(c){var d=c.ownerCt;Ext.applyIf(c,{labelAlign:d.labelAlign,labelWidth:d.labelWidth,itemCls:d.itemCls})},getLayoutTarget:function(){return this.form.el},getForm:function(){return this.form},onRender:function(c,d){this.initFields();Ext.FormPanel.superclass.onRender.call(this,c,d);this.form.initEl(this.body)},beforeDestroy:function(){this.stopMonitoring();this.form.destroy(true);Ext.FormPanel.superclass.beforeDestroy.call(this)},isField:function(b){return !!b.setValue&&!!b.getValue&&!!b.markInvalid&&!!b.clearInvalid},initEvents:function(){Ext.FormPanel.superclass.initEvents.call(this);this.on({scope:this,add:this.onAddEvent,remove:this.onRemoveEvent});if(this.monitorValid){this.startMonitoring()}},onAdd:function(b){Ext.FormPanel.superclass.onAdd.call(this,b);this.processAdd(b)},onAddEvent:function(d,c){if(d!==this){this.processAdd(c)}},processAdd:function(b){if(this.isField(b)){this.form.add(b)}else{if(b.findBy){this.applySettings(b);this.form.add.apply(this.form,b.findBy(this.isField))}}},onRemove:function(b){Ext.FormPanel.superclass.onRemove.call(this,b);this.processRemove(b)},onRemoveEvent:function(d,c){if(d!==this){this.processRemove(c)
}},processRemove:function(b){if(!this.destroying){if(this.isField(b)){this.form.remove(b)}else{if(b.findBy){Ext.each(b.findBy(this.isField),this.form.remove,this.form);this.form.cleanDestroyed()}}}},startMonitoring:function(){if(!this.validTask){this.validTask=new Ext.util.TaskRunner();this.validTask.start({run:this.bindHandler,interval:this.monitorPoll||200,scope:this})}},stopMonitoring:function(){if(this.validTask){this.validTask.stopAll();this.validTask=null}},load:function(){this.form.load.apply(this.form,arguments)},onDisable:function(){Ext.FormPanel.superclass.onDisable.call(this);if(this.form){this.form.items.each(function(){this.disable()})}},onEnable:function(){Ext.FormPanel.superclass.onEnable.call(this);if(this.form){this.form.items.each(function(){this.enable()})}},bindHandler:function(){var i=true;this.form.items.each(function(a){if(!a.isValid(true)){i=false;return false}});if(this.fbar){var g=this.fbar.items.items;for(var k=0,h=g.length;k<h;k++){var l=g[k];if(l.formBind===true&&l.disabled===i){l.setDisabled(!i)}}}this.fireEvent("clientvalidation",this,i)}});Ext.reg("form",Ext.FormPanel);Ext.form.FormPanel=Ext.FormPanel;Ext.form.FieldSet=Ext.extend(Ext.Panel,{baseCls:"x-fieldset",layout:"form",animCollapse:false,onRender:function(d,e){if(!this.el){this.el=document.createElement("fieldset");this.el.id=this.id;if(this.title||this.header||this.checkboxToggle){this.el.appendChild(document.createElement("legend")).className=this.baseCls+"-header"}}Ext.form.FieldSet.superclass.onRender.call(this,d,e);if(this.checkboxToggle){var g=typeof this.checkboxToggle=="object"?this.checkboxToggle:{tag:"input",type:"checkbox",name:this.checkboxName||this.id+"-checkbox"};this.checkbox=this.header.insertFirst(g);this.checkbox.dom.checked=!this.collapsed;this.mon(this.checkbox,"click",this.onCheckClick,this)}},onCollapse:function(d,c){if(this.checkbox){this.checkbox.dom.checked=false}Ext.form.FieldSet.superclass.onCollapse.call(this,d,c)},onExpand:function(d,c){if(this.checkbox){this.checkbox.dom.checked=true}Ext.form.FieldSet.superclass.onExpand.call(this,d,c)},onCheckClick:function(){this[this.checkbox.dom.checked?"expand":"collapse"]()}});Ext.reg("fieldset",Ext.form.FieldSet);Ext.form.HtmlEditor=Ext.extend(Ext.form.Field,{enableFormat:true,enableFontSize:true,enableColors:true,enableAlignments:true,enableLists:true,enableSourceEdit:true,enableLinks:true,enableFont:true,createLinkText:"Please enter the URL for the link:",defaultLinkValue:"http://",fontFamilies:["Arial","Courier New","Tahoma","Times New Roman","Verdana"],defaultFont:"tahoma",defaultValue:(Ext.isOpera||Ext.isIE6)?"&#160;":"&#8203;",actionMode:"wrap",validationEvent:false,deferHeight:true,initialized:false,activated:false,sourceEditMode:false,onFocus:Ext.emptyFn,iframePad:3,hideMode:"offsets",defaultAutoCreate:{tag:"textarea",style:"width:500px;height:300px;",autocomplete:"off"},initComponent:function(){this.addEvents("initialize","activate","beforesync","beforepush","sync","push","editmodechange");Ext.form.HtmlEditor.superclass.initComponent.call(this)},createFontOptions:function(){var m=[],h=this.fontFamilies,n,k;for(var l=0,i=h.length;l<i;l++){n=h[l];k=n.toLowerCase();m.push('<option value="',k,'" style="font-family:',n,';"',(this.defaultFont==k?' selected="true">':">"),n,"</option>")}return m.join("")},createToolbar:function(l){var n=[];var i=Ext.QuickTips&&Ext.QuickTips.isEnabled();function m(a,c,b){return{itemId:a,cls:"x-btn-icon",iconCls:"x-edit-"+a,enableToggle:c!==false,scope:l,handler:b||l.relayBtnCmd,clickEvent:"mousedown",tooltip:i?l.buttonTips[a]||undefined:undefined,overflowText:l.buttonTips[a].title||undefined,tabIndex:-1}}if(this.enableFont&&!Ext.isSafari2){var k=new Ext.Toolbar.Item({autoEl:{tag:"select",cls:"x-font-select",html:this.createFontOptions()}});n.push(k,"-")}if(this.enableFormat){n.push(m("bold"),m("italic"),m("underline"))}if(this.enableFontSize){n.push("-",m("increasefontsize",false,this.adjustFont),m("decreasefontsize",false,this.adjustFont))
}if(this.enableColors){n.push("-",{itemId:"forecolor",cls:"x-btn-icon",iconCls:"x-edit-forecolor",clickEvent:"mousedown",tooltip:i?l.buttonTips.forecolor||undefined:undefined,tabIndex:-1,menu:new Ext.menu.ColorMenu({allowReselect:true,focus:Ext.emptyFn,value:"000000",plain:true,listeners:{scope:this,select:function(a,b){this.execCmd("forecolor",Ext.isWebKit||Ext.isIE?"#"+b:b);this.deferFocus()}},clickEvent:"mousedown"})},{itemId:"backcolor",cls:"x-btn-icon",iconCls:"x-edit-backcolor",clickEvent:"mousedown",tooltip:i?l.buttonTips.backcolor||undefined:undefined,tabIndex:-1,menu:new Ext.menu.ColorMenu({focus:Ext.emptyFn,value:"FFFFFF",plain:true,allowReselect:true,listeners:{scope:this,select:function(a,b){if(Ext.isGecko){this.execCmd("useCSS",false);this.execCmd("hilitecolor",b);this.execCmd("useCSS",true);this.deferFocus()}else{this.execCmd(Ext.isOpera?"hilitecolor":"backcolor",Ext.isWebKit||Ext.isIE?"#"+b:b);this.deferFocus()}}},clickEvent:"mousedown"})})}if(this.enableAlignments){n.push("-",m("justifyleft"),m("justifycenter"),m("justifyright"))}if(!Ext.isSafari2){if(this.enableLinks){n.push("-",m("createlink",false,this.createLink))}if(this.enableLists){n.push("-",m("insertorderedlist"),m("insertunorderedlist"))}if(this.enableSourceEdit){n.push("-",m("sourceedit",true,function(a){this.toggleSourceEdit(!this.sourceEditMode)}))}}var h=new Ext.Toolbar({renderTo:this.wrap.dom.firstChild,items:n});if(k){this.fontSelect=k.el;this.mon(this.fontSelect,"change",function(){var a=this.fontSelect.dom.value;this.relayCmd("fontname",a);this.deferFocus()},this)}this.mon(h.el,"click",function(a){a.preventDefault()});this.tb=h;this.tb.doLayout()},onDisable:function(){this.wrap.mask();Ext.form.HtmlEditor.superclass.onDisable.call(this)},onEnable:function(){this.wrap.unmask();Ext.form.HtmlEditor.superclass.onEnable.call(this)},setReadOnly:function(c){Ext.form.HtmlEditor.superclass.setReadOnly.call(this,c);if(this.initialized){if(Ext.isIE){this.getEditorBody().contentEditable=!c}else{this.setDesignMode(!c)}var d=this.getEditorBody();if(d){d.style.cursor=this.readOnly?"default":"text"}this.disableItems(c)}},getDocMarkup:function(){var b=Ext.fly(this.iframe).getHeight()-this.iframePad*2;return String.format('<html><head><style type="text/css">body{border: 0; margin: 0; padding: {0}px; height: {1}px; cursor: text}</style></head><body></body></html>',this.iframePad,b)},getEditorBody:function(){var b=this.getDoc();return b.body||b.documentElement},getDoc:function(){return Ext.isIE?this.getWin().document:(this.iframe.contentDocument||this.getWin().document)},getWin:function(){return Ext.isIE?this.iframe.contentWindow:window.frames[this.iframe.name]},onRender:function(d,e){Ext.form.HtmlEditor.superclass.onRender.call(this,d,e);this.el.dom.style.border="0 none";this.el.dom.setAttribute("tabIndex",-1);this.el.addClass("x-hidden");if(Ext.isIE){this.el.applyStyles("margin-top:-1px;margin-bottom:-1px;")}this.wrap=this.el.wrap({cls:"x-html-editor-wrap",cn:{cls:"x-html-editor-tb"}});this.createToolbar(this);this.disableItems(true);this.tb.doLayout();this.createIFrame();if(!this.width){var g=this.el.getSize();this.setSize(g.width,this.height||g.height)}this.resizeEl=this.positionEl=this.wrap},createIFrame:function(){var b=document.createElement("iframe");b.name=Ext.id();b.frameBorder="0";b.style.overflow="auto";b.src=Ext.SSL_SECURE_URL;this.wrap.dom.appendChild(b);this.iframe=b;this.monitorTask=Ext.TaskMgr.start({run:this.checkDesignMode,scope:this,interval:100})},initFrame:function(){Ext.TaskMgr.stop(this.monitorTask);var c=this.getDoc();this.win=this.getWin();c.open();c.write(this.getDocMarkup());c.close();var d={run:function(){var a=this.getDoc();if(a.body||a.readyState=="complete"){Ext.TaskMgr.stop(d);this.setDesignMode(true);this.initEditor.defer(10,this)}},interval:10,duration:10000,scope:this};Ext.TaskMgr.start(d)},checkDesignMode:function(){if(this.wrap&&this.wrap.dom.offsetWidth){var b=this.getDoc();if(!b){return}if(!b.editorInitialized||this.getDesignMode()!="on"){this.initFrame()
}}},setDesignMode:function(c){var d=this.getDoc();if(d){if(this.readOnly){c=false}d.designMode=(/on|true/i).test(String(c).toLowerCase())?"on":"off"}},getDesignMode:function(){var b=this.getDoc();if(!b){return""}return String(b.designMode).toLowerCase()},disableItems:function(b){if(this.fontSelect){this.fontSelect.dom.disabled=b}this.tb.items.each(function(a){if(a.getItemId()!="sourceedit"){a.setDisabled(b)}})},onResize:function(g,l){Ext.form.HtmlEditor.superclass.onResize.apply(this,arguments);if(this.el&&this.iframe){if(Ext.isNumber(g)){var i=g-this.wrap.getFrameWidth("lr");this.el.setWidth(i);this.tb.setWidth(i);this.iframe.style.width=Math.max(i,0)+"px"}if(Ext.isNumber(l)){var h=l-this.wrap.getFrameWidth("tb")-this.tb.el.getHeight();this.el.setHeight(h);this.iframe.style.height=Math.max(h,0)+"px";var k=this.getEditorBody();if(k){k.style.height=Math.max((h-(this.iframePad*2)),0)+"px"}}}},toggleSourceEdit:function(e){var h,g;if(e===undefined){e=!this.sourceEditMode}this.sourceEditMode=e===true;var i=this.tb.getComponent("sourceedit");if(i.pressed!==this.sourceEditMode){i.toggle(this.sourceEditMode);if(!i.xtbHidden){return}}if(this.sourceEditMode){this.previousSize=this.getSize();h=Ext.get(this.iframe).getHeight();this.disableItems(true);this.syncValue();this.iframe.className="x-hidden";this.el.removeClass("x-hidden");this.el.dom.removeAttribute("tabIndex");this.el.focus();this.el.dom.style.height=h+"px"}else{g=parseInt(this.el.dom.style.height,10);if(this.initialized){this.disableItems(this.readOnly)}this.pushValue();this.iframe.className="";this.el.addClass("x-hidden");this.el.dom.setAttribute("tabIndex",-1);this.deferFocus();this.setSize(this.previousSize);delete this.previousSize;this.iframe.style.height=g+"px"}this.fireEvent("editmodechange",this,this.sourceEditMode)},createLink:function(){var b=prompt(this.createLinkText,this.defaultLinkValue);if(b&&b!="http://"){this.relayCmd("createlink",b)}},initEvents:function(){this.originalValue=this.getValue()},markInvalid:Ext.emptyFn,clearInvalid:Ext.emptyFn,setValue:function(b){Ext.form.HtmlEditor.superclass.setValue.call(this,b);this.pushValue();return this},cleanHtml:function(b){b=String(b);if(Ext.isWebKit){b=b.replace(/\sclass="(?:Apple-style-span|khtml-block-placeholder)"/gi,"")}if(b.charCodeAt(0)==this.defaultValue.replace(/\D/g,"")){b=b.substring(1)}return b},syncValue:function(){if(this.initialized){var h=this.getEditorBody();var i=h.innerHTML;if(Ext.isWebKit){var e=h.getAttribute("style");var g=e.match(/text-align:(.*?);/i);if(g&&g[1]){i='<div style="'+g[0]+'">'+i+"</div>"}}i=this.cleanHtml(i);if(this.fireEvent("beforesync",this,i)!==false){this.el.dom.value=i;this.fireEvent("sync",this,i)}}},getValue:function(){this[this.sourceEditMode?"pushValue":"syncValue"]();return Ext.form.HtmlEditor.superclass.getValue.call(this)},pushValue:function(){if(this.initialized){var b=this.el.dom.value;if(!this.activated&&b.length<1){b=this.defaultValue}if(this.fireEvent("beforepush",this,b)!==false){this.getEditorBody().innerHTML=b;if(Ext.isGecko){this.setDesignMode(false);this.setDesignMode(true)}this.fireEvent("push",this,b)}}},deferFocus:function(){this.focus.defer(10,this)},focus:function(){if(this.win&&!this.sourceEditMode){this.win.focus()}else{this.el.focus()}},initEditor:function(){try{var l=this.getEditorBody(),h=this.el.getStyles("font-size","font-family","background-image","background-repeat","background-color","color"),i,e;h["background-attachment"]="fixed";l.bgProperties="fixed";Ext.DomHelper.applyStyles(l,h);i=this.getDoc();if(i){try{Ext.EventManager.removeAll(i)}catch(k){}}e=this.onEditorEvent.createDelegate(this);Ext.EventManager.on(i,{mousedown:e,dblclick:e,click:e,keyup:e,buffer:100});if(Ext.isGecko){Ext.EventManager.on(i,"keypress",this.applyCommand,this)}if(Ext.isIE||Ext.isWebKit||Ext.isOpera){Ext.EventManager.on(i,"keydown",this.fixKeys,this)}i.editorInitialized=true;this.initialized=true;this.pushValue();this.setReadOnly(this.readOnly);this.fireEvent("initialize",this)
}catch(k){}},beforeDestroy:function(){if(this.monitorTask){Ext.TaskMgr.stop(this.monitorTask)}if(this.rendered){Ext.destroy(this.tb);var d=this.getDoc();if(d){try{Ext.EventManager.removeAll(d);for(var g in d){delete d[g]}}catch(e){}}if(this.wrap){this.wrap.dom.innerHTML="";this.wrap.remove()}}Ext.form.HtmlEditor.superclass.beforeDestroy.call(this)},onFirstFocus:function(){this.activated=true;this.disableItems(this.readOnly);if(Ext.isGecko){this.win.focus();var e=this.win.getSelection();if(!e.focusNode||e.focusNode.nodeType!=3){var d=e.getRangeAt(0);d.selectNodeContents(this.getEditorBody());d.collapse(true);this.deferFocus()}try{this.execCmd("useCSS",true);this.execCmd("styleWithCSS",false)}catch(g){}}this.fireEvent("activate",this)},adjustFont:function(e){var h=e.getItemId()=="increasefontsize"?1:-1,i=this.getDoc(),g=parseInt(i.queryCommandValue("FontSize")||2,10);if((Ext.isSafari&&!Ext.isSafari2)||Ext.isChrome||Ext.isAir){if(g<=10){g=1+h}else{if(g<=13){g=2+h}else{if(g<=16){g=3+h}else{if(g<=18){g=4+h}else{if(g<=24){g=5+h}else{g=6+h}}}}}g=g.constrain(1,6)}else{if(Ext.isSafari){h*=2}g=Math.max(1,g+h)+(Ext.isSafari?"px":0)}this.execCmd("FontSize",g)},onEditorEvent:function(b){this.updateToolbar()},updateToolbar:function(){if(this.readOnly){return}if(!this.activated){this.onFirstFocus();return}var d=this.tb.items.map,g=this.getDoc();if(this.enableFont&&!Ext.isSafari2){var e=(g.queryCommandValue("FontName")||this.defaultFont).toLowerCase();if(e!=this.fontSelect.dom.value){this.fontSelect.dom.value=e}}if(this.enableFormat){d.bold.toggle(g.queryCommandState("bold"));d.italic.toggle(g.queryCommandState("italic"));d.underline.toggle(g.queryCommandState("underline"))}if(this.enableAlignments){d.justifyleft.toggle(g.queryCommandState("justifyleft"));d.justifycenter.toggle(g.queryCommandState("justifycenter"));d.justifyright.toggle(g.queryCommandState("justifyright"))}if(!Ext.isSafari2&&this.enableLists){d.insertorderedlist.toggle(g.queryCommandState("insertorderedlist"));d.insertunorderedlist.toggle(g.queryCommandState("insertunorderedlist"))}Ext.menu.MenuMgr.hideAll();this.syncValue()},relayBtnCmd:function(b){this.relayCmd(b.getItemId())},relayCmd:function(c,d){(function(){this.focus();this.execCmd(c,d);this.updateToolbar()}).defer(10,this)},execCmd:function(d,e){var g=this.getDoc();g.execCommand(d,false,e===undefined?null:e);this.syncValue()},applyCommand:function(c){if(c.ctrlKey){var g=c.getCharCode(),e;if(g>0){g=String.fromCharCode(g);switch(g){case"b":e="bold";break;case"i":e="italic";break;case"u":e="underline";break}if(e){this.win.focus();this.execCmd(e);this.deferFocus();c.preventDefault()}}}},insertAtCursor:function(g){if(!this.activated){return}if(Ext.isIE){this.win.focus();var d=this.getDoc(),e=d.selection.createRange();if(e){e.pasteHTML(g);this.syncValue();this.deferFocus()}}else{this.win.focus();this.execCmd("InsertHTML",g);this.deferFocus()}},fixKeys:function(){if(Ext.isIE){return function(i){var h=i.getKey(),k=this.getDoc(),e;if(h==i.TAB){i.stopEvent();e=k.selection.createRange();if(e){e.collapse(true);e.pasteHTML("&nbsp;&nbsp;&nbsp;&nbsp;");this.deferFocus()}}else{if(h==i.ENTER){e=k.selection.createRange();if(e){var l=e.parentElement();if(!l||l.tagName.toLowerCase()!="li"){i.stopEvent();e.pasteHTML("<br />");e.collapse(false);e.select()}}}}}}else{if(Ext.isOpera){return function(c){var d=c.getKey();if(d==c.TAB){c.stopEvent();this.win.focus();this.execCmd("InsertHTML","&nbsp;&nbsp;&nbsp;&nbsp;");this.deferFocus()}}}else{if(Ext.isWebKit){return function(c){var d=c.getKey();if(d==c.TAB){c.stopEvent();this.execCmd("InsertText","\t");this.deferFocus()}else{if(d==c.ENTER){c.stopEvent();this.execCmd("InsertHtml","<br /><br />");this.deferFocus()}}}}}}}(),getToolbar:function(){return this.tb},buttonTips:{bold:{title:"Bold (Ctrl+B)",text:"Make the selected text bold.",cls:"x-html-editor-tip"},italic:{title:"Italic (Ctrl+I)",text:"Make the selected text italic.",cls:"x-html-editor-tip"},underline:{title:"Underline (Ctrl+U)",text:"Underline the selected text.",cls:"x-html-editor-tip"},increasefontsize:{title:"Grow Text",text:"Increase the font size.",cls:"x-html-editor-tip"},decreasefontsize:{title:"Shrink Text",text:"Decrease the font size.",cls:"x-html-editor-tip"},backcolor:{title:"Text Highlight Color",text:"Change the background color of the selected text.",cls:"x-html-editor-tip"},forecolor:{title:"Font Color",text:"Change the color of the selected text.",cls:"x-html-editor-tip"},justifyleft:{title:"Align Text Left",text:"Align text to the left.",cls:"x-html-editor-tip"},justifycenter:{title:"Center Text",text:"Center text in the editor.",cls:"x-html-editor-tip"},justifyright:{title:"Align Text Right",text:"Align text to the right.",cls:"x-html-editor-tip"},insertunorderedlist:{title:"Bullet List",text:"Start a bulleted list.",cls:"x-html-editor-tip"},insertorderedlist:{title:"Numbered List",text:"Start a numbered list.",cls:"x-html-editor-tip"},createlink:{title:"Hyperlink",text:"Make the selected text a hyperlink.",cls:"x-html-editor-tip"},sourceedit:{title:"Source Edit",text:"Switch to source editing mode.",cls:"x-html-editor-tip"}}});
Ext.reg("htmleditor",Ext.form.HtmlEditor);Ext.form.TimeField=Ext.extend(Ext.form.ComboBox,{minValue:undefined,maxValue:undefined,minText:"The time in this field must be equal to or after {0}",maxText:"The time in this field must be equal to or before {0}",invalidText:"{0} is not a valid time",format:"g:i A",altFormats:"g:ia|g:iA|g:i a|g:i A|h:i|g:i|H:i|ga|ha|gA|h a|g a|g A|gi|hi|gia|hia|g|H|gi a|hi a|giA|hiA|gi A|hi A",increment:15,mode:"local",triggerAction:"all",typeAhead:false,initDate:"1/1/2008",initDateFormat:"j/n/Y",initComponent:function(){if(Ext.isDefined(this.minValue)){this.setMinValue(this.minValue,true)}if(Ext.isDefined(this.maxValue)){this.setMaxValue(this.maxValue,true)}if(!this.store){this.generateStore(true)}Ext.form.TimeField.superclass.initComponent.call(this)},setMinValue:function(c,d){this.setLimit(c,true,d);return this},setMaxValue:function(c,d){this.setLimit(c,false,d);return this},generateStore:function(e){var i=this.minValue||new Date(this.initDate).clearTime(),g=this.maxValue||new Date(this.initDate).clearTime().add("mi",(24*60)-1),h=[];while(i<=g){h.push(i.dateFormat(this.format));i=i.add("mi",this.increment)}this.bindStore(h,e)},setLimit:function(d,i,h){var k;if(Ext.isString(d)){k=this.parseDate(d)}else{if(Ext.isDate(d)){k=d}}if(k){var l=new Date(this.initDate).clearTime();l.setHours(k.getHours(),k.getMinutes(),k.getSeconds(),k.getMilliseconds());this[i?"minValue":"maxValue"]=l;if(!h){this.generateStore()}}},getValue:function(){var b=Ext.form.TimeField.superclass.getValue.call(this);return this.formatDate(this.parseDate(b))||""},setValue:function(b){return Ext.form.TimeField.superclass.setValue.call(this,this.formatDate(this.parseDate(b)))},validateValue:Ext.form.DateField.prototype.validateValue,formatDate:Ext.form.DateField.prototype.formatDate,parseDate:function(n){if(!n||Ext.isDate(n)){return n}var m=this.initDate+" ",o=this.initDateFormat+" ",i=Date.parseDate(m+n,o+this.format),s=this.altFormats;if(!i&&s){if(!this.altFormatsArray){this.altFormatsArray=s.split("|")}for(var p=0,q=this.altFormatsArray,l=q.length;p<l&&!i;p++){i=Date.parseDate(m+n,o+q[p])}}return i}});Ext.reg("timefield",Ext.form.TimeField);Ext.form.SliderField=Ext.extend(Ext.form.Field,{useTips:true,tipText:null,actionMode:"wrap",initComponent:function(){var c=Ext.copyTo({id:this.id+"-slider"},this.initialConfig,["vertical","minValue","maxValue","decimalPrecision","keyIncrement","increment","clickToChange","animate"]);if(this.useTips){var d=this.tipText?{getText:this.tipText}:{};c.plugins=[new Ext.slider.Tip(d)]}this.slider=new Ext.Slider(c);Ext.form.SliderField.superclass.initComponent.call(this)},onRender:function(c,d){this.autoCreate={id:this.id,name:this.name,type:"hidden",tag:"input"};Ext.form.SliderField.superclass.onRender.call(this,c,d);this.wrap=this.el.wrap({cls:"x-form-field-wrap"});this.resizeEl=this.positionEl=this.wrap;this.slider.render(this.wrap)},onResize:function(e,i,h,g){Ext.form.SliderField.superclass.onResize.call(this,e,i,h,g);this.slider.setSize(e,i)},initEvents:function(){Ext.form.SliderField.superclass.initEvents.call(this);this.slider.on("change",this.onChange,this)},onChange:function(c,d){this.setValue(d,undefined,true)},onEnable:function(){Ext.form.SliderField.superclass.onEnable.call(this);this.slider.enable()},onDisable:function(){Ext.form.SliderField.superclass.onDisable.call(this);this.slider.disable()},beforeDestroy:function(){Ext.destroy(this.slider);Ext.form.SliderField.superclass.beforeDestroy.call(this)},alignErrorIcon:function(){this.errorIcon.alignTo(this.slider.el,"tl-tr",[2,0])},setMinValue:function(b){this.slider.setMinValue(b);return this},setMaxValue:function(b){this.slider.setMaxValue(b);return this},setValue:function(g,d,e){if(!e){this.slider.setValue(g,d)}return Ext.form.SliderField.superclass.setValue.call(this,this.slider.getValue())},getValue:function(){return this.slider.getValue()}});Ext.reg("sliderfield",Ext.form.SliderField);Ext.form.Label=Ext.extend(Ext.BoxComponent,{onRender:function(c,d){if(!this.el){this.el=document.createElement("label");
this.el.id=this.getId();this.el.innerHTML=this.text?Ext.util.Format.htmlEncode(this.text):(this.html||"");if(this.forId){this.el.setAttribute("for",this.forId)}}Ext.form.Label.superclass.onRender.call(this,c,d)},setText:function(e,d){var g=d===false;this[!g?"text":"html"]=e;delete this[g?"text":"html"];if(this.rendered){this.el.dom.innerHTML=d!==false?Ext.util.Format.htmlEncode(e):e}return this}});Ext.reg("label",Ext.form.Label);Ext.form.Action=function(c,d){this.form=c;this.options=d||{}};Ext.form.Action.CLIENT_INVALID="client";Ext.form.Action.SERVER_INVALID="server";Ext.form.Action.CONNECT_FAILURE="connect";Ext.form.Action.LOAD_FAILURE="load";Ext.form.Action.prototype={type:"default",run:function(b){},success:function(b){},handleResponse:function(b){},failure:function(b){this.response=b;this.failureType=Ext.form.Action.CONNECT_FAILURE;this.form.afterAction(this,false)},processResponse:function(b){this.response=b;if(!b.responseText&&!b.responseXML){return true}this.result=this.handleResponse(b);return this.result},getUrl:function(g){var e=this.options.url||this.form.url||this.form.el.dom.action;if(g){var d=this.getParams();if(d){e=Ext.urlAppend(e,d)}}return e},getMethod:function(){return(this.options.method||this.form.method||this.form.el.dom.method||"POST").toUpperCase()},getParams:function(){var d=this.form.baseParams;var c=this.options.params;if(c){if(typeof c=="object"){c=Ext.urlEncode(Ext.applyIf(c,d))}else{if(typeof c=="string"&&d){c+="&"+Ext.urlEncode(d)}}}else{if(d){c=Ext.urlEncode(d)}}return c},createCallback:function(b){var b=b||{};return{success:this.success,failure:this.failure,scope:this,timeout:(b.timeout*1000)||(this.form.timeout*1000),upload:this.form.fileUpload?this.success:undefined}}};Ext.form.Action.Submit=function(c,d){Ext.form.Action.Submit.superclass.constructor.call(this,c,d)};Ext.extend(Ext.form.Action.Submit,Ext.form.Action,{type:"submit",run:function(){var l=this.options,k=this.getMethod(),m=k=="GET";if(l.clientValidation===false||this.form.isValid()){if(l.submitEmptyText===false){var i=this.form.items,n=[],h=function(a){if(a.el.getValue()==a.emptyText){n.push(a);a.el.dom.value=""}if(a.isComposite&&a.rendered){a.items.each(h)}};i.each(h)}Ext.Ajax.request(Ext.apply(this.createCallback(l),{form:this.form.el.dom,url:this.getUrl(m),method:k,headers:l.headers,params:!m?this.getParams():null,isUpload:this.form.fileUpload}));if(l.submitEmptyText===false){Ext.each(n,function(a){if(a.applyEmptyText){a.applyEmptyText()}})}}else{if(l.clientValidation!==false){this.failureType=Ext.form.Action.CLIENT_INVALID;this.form.afterAction(this,false)}}},success:function(c){var d=this.processResponse(c);if(d===true||d.success){this.form.afterAction(this,true);return}if(d.errors){this.form.markInvalid(d.errors)}this.failureType=Ext.form.Action.SERVER_INVALID;this.form.afterAction(this,false)},handleResponse:function(n){if(this.form.errorReader){var h=this.form.errorReader.read(n);var k=[];if(h.records){for(var m=0,i=h.records.length;m<i;m++){var l=h.records[m];k[m]=l.data}}if(k.length<1){k=null}return{success:h.success,errors:k}}return Ext.decode(n.responseText)}});Ext.form.Action.Load=function(c,d){Ext.form.Action.Load.superclass.constructor.call(this,c,d);this.reader=this.form.reader};Ext.extend(Ext.form.Action.Load,Ext.form.Action,{type:"load",run:function(){Ext.Ajax.request(Ext.apply(this.createCallback(this.options),{method:this.getMethod(),url:this.getUrl(false),headers:this.options.headers,params:this.getParams()}))},success:function(c){var d=this.processResponse(c);if(d===true||!d.success||!d.data){this.failureType=Ext.form.Action.LOAD_FAILURE;this.form.afterAction(this,false);return}this.form.clearInvalid();this.form.setValues(d.data);this.form.afterAction(this,true)},handleResponse:function(d){if(this.form.reader){var e=this.form.reader.read(d);var g=e.records&&e.records[0]?e.records[0].data:null;return{success:e.success,data:g}}return Ext.decode(d.responseText)}});Ext.form.Action.DirectLoad=Ext.extend(Ext.form.Action.Load,{constructor:function(c,d){Ext.form.Action.DirectLoad.superclass.constructor.call(this,c,d)
},type:"directload",run:function(){var b=this.getParams();b.push(this.success,this);this.form.api.load.apply(window,b)},getParams:function(){var p=[],l={};var n=this.form.baseParams;var m=this.options.params;Ext.apply(l,m,n);var i=this.form.paramOrder;if(i){for(var o=0,k=i.length;o<k;o++){p.push(l[i[o]])}}else{if(this.form.paramsAsHash){p.push(l)}}return p},processResponse:function(b){this.result=b;return b},success:function(d,c){if(c.type==Ext.Direct.exceptions.SERVER){d={}}Ext.form.Action.DirectLoad.superclass.success.call(this,d)}});Ext.form.Action.DirectSubmit=Ext.extend(Ext.form.Action.Submit,{constructor:function(c,d){Ext.form.Action.DirectSubmit.superclass.constructor.call(this,c,d)},type:"directsubmit",run:function(){var b=this.options;if(b.clientValidation===false||this.form.isValid()){this.success.params=this.getParams();this.form.api.submit(this.form.el.dom,this.success,this)}else{if(b.clientValidation!==false){this.failureType=Ext.form.Action.CLIENT_INVALID;this.form.afterAction(this,false)}}},getParams:function(){var g={};var e=this.form.baseParams;var d=this.options.params;Ext.apply(g,d,e);return g},processResponse:function(b){this.result=b;return b},success:function(d,c){if(c.type==Ext.Direct.exceptions.SERVER){d={}}Ext.form.Action.DirectSubmit.superclass.success.call(this,d)}});Ext.form.Action.ACTION_TYPES={load:Ext.form.Action.Load,submit:Ext.form.Action.Submit,directload:Ext.form.Action.DirectLoad,directsubmit:Ext.form.Action.DirectSubmit};Ext.form.VTypes=function(){var i=/^[a-zA-Z_]+$/,h=/^[a-zA-Z0-9_]+$/,e=/^(\w+)([\-+.][\w]+)*@(\w[\-\w]*\.){1,5}([A-Za-z]){2,6}$/,g=/(((^https?)|(^ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i;return{email:function(a){return e.test(a)},emailText:'This field should be an e-mail address in the format "user@example.com"',emailMask:/[a-z0-9_\.\-@\+]/i,url:function(a){return g.test(a)},urlText:'This field should be a URL in the format "http://www.example.com"',alpha:function(a){return i.test(a)},alphaText:"This field should only contain letters and _",alphaMask:/[a-z_]/i,alphanum:function(a){return h.test(a)},alphanumText:"This field should only contain letters, numbers and _",alphanumMask:/[a-z0-9_]/i}}();Ext.grid.GridPanel=Ext.extend(Ext.Panel,{autoExpandColumn:false,autoExpandMax:1000,autoExpandMin:50,columnLines:false,ddText:"{0} selected row{1}",deferRowRender:true,enableColumnHide:true,enableColumnMove:true,enableDragDrop:false,enableHdMenu:true,loadMask:false,minColumnWidth:25,stripeRows:false,trackMouseOver:true,stateEvents:["columnmove","columnresize","sortchange","groupchange"],view:null,bubbleEvents:[],rendered:false,viewReady:false,initComponent:function(){Ext.grid.GridPanel.superclass.initComponent.call(this);if(this.columnLines){this.cls=(this.cls||"")+" x-grid-with-col-lines"}this.autoScroll=false;this.autoWidth=false;if(Ext.isArray(this.columns)){this.colModel=new Ext.grid.ColumnModel(this.columns);delete this.columns}if(this.ds){this.store=this.ds;delete this.ds}if(this.cm){this.colModel=this.cm;delete this.cm}if(this.sm){this.selModel=this.sm;delete this.sm}this.store=Ext.StoreMgr.lookup(this.store);this.addEvents("click","dblclick","contextmenu","mousedown","mouseup","mouseover","mouseout","keypress","keydown","cellmousedown","rowmousedown","headermousedown","groupmousedown","rowbodymousedown","containermousedown","cellclick","celldblclick","rowclick","rowdblclick","headerclick","headerdblclick","groupclick","groupdblclick","containerclick","containerdblclick","rowbodyclick","rowbodydblclick","rowcontextmenu","cellcontextmenu","headercontextmenu","groupcontextmenu","containercontextmenu","rowbodycontextmenu","bodyscroll","columnresize","columnmove","sortchange","groupchange","reconfigure","viewready")},onRender:function(i,g){Ext.grid.GridPanel.superclass.onRender.apply(this,arguments);var h=this.getGridEl();this.el.addClass("x-grid-panel");this.mon(h,{scope:this,mousedown:this.onMouseDown,click:this.onClick,dblclick:this.onDblClick,contextmenu:this.onContextMenu});
this.relayEvents(h,["mousedown","mouseup","mouseover","mouseout","keypress","keydown"]);var c=this.getView();c.init(this);c.render();this.getSelectionModel().init(this)},initEvents:function(){Ext.grid.GridPanel.superclass.initEvents.call(this);if(this.loadMask){this.loadMask=new Ext.LoadMask(this.bwrap,Ext.apply({store:this.store},this.loadMask))}},initStateEvents:function(){Ext.grid.GridPanel.superclass.initStateEvents.call(this);this.mon(this.colModel,"hiddenchange",this.saveState,this,{delay:100})},applyState:function(w){var i=this.colModel,s=w.columns,o=this.store,c,q,p;if(s){for(var u=0,t=s.length;u<t;u++){c=s[u];q=i.getColumnById(c.id);if(q){i.setState(c.id,{hidden:c.hidden,width:c.width});p=i.getIndexById(c.id);if(p!=u){i.moveColumn(p,u)}}}}if(o){c=w.sort;if(c){o[o.remoteSort?"setDefaultSort":"sort"](c.field,c.direction)}c=w.group;if(o.groupBy){if(c){o.groupBy(c)}else{o.clearGrouping()}}}var v=Ext.apply({},w);delete v.columns;delete v.sort;Ext.grid.GridPanel.superclass.applyState.call(this,v)},getState:function(){var l={columns:[]},c=this.store,m,i;for(var n=0,k;(k=this.colModel.config[n]);n++){l.columns[n]={id:k.id,width:k.width};if(k.hidden){l.columns[n].hidden=true}}if(c){m=c.getSortState();if(m){l.sort=m}if(c.getGroupState){i=c.getGroupState();if(i){l.group=i}}}return l},afterRender:function(){Ext.grid.GridPanel.superclass.afterRender.call(this);var b=this.view;this.on("bodyresize",b.layout,b);b.layout(true);if(this.deferRowRender){if(!this.deferRowRenderTask){this.deferRowRenderTask=new Ext.util.DelayedTask(b.afterRender,this.view)}this.deferRowRenderTask.delay(10)}else{b.afterRender()}this.viewReady=true},reconfigure:function(e,d){var g=this.rendered;if(g){if(this.loadMask){this.loadMask.destroy();this.loadMask=new Ext.LoadMask(this.bwrap,Ext.apply({},{store:e},this.initialConfig.loadMask))}}if(this.view){this.view.initData(e,d)}this.store=e;this.colModel=d;if(g){this.view.refresh(true)}this.fireEvent("reconfigure",this,e,d)},onDestroy:function(){if(this.deferRowRenderTask&&this.deferRowRenderTask.cancel){this.deferRowRenderTask.cancel()}if(this.rendered){Ext.destroy(this.view,this.loadMask)}else{if(this.store&&this.store.autoDestroy){this.store.destroy()}}Ext.destroy(this.colModel,this.selModel);this.store=this.selModel=this.colModel=this.view=this.loadMask=null;Ext.grid.GridPanel.superclass.onDestroy.call(this)},processEvent:function(d,c){this.view.processEvent(d,c)},onClick:function(b){this.processEvent("click",b)},onMouseDown:function(b){this.processEvent("mousedown",b)},onContextMenu:function(c,d){this.processEvent("contextmenu",c)},onDblClick:function(b){this.processEvent("dblclick",b)},walkCells:function(m,u,v,s,n){var o=this.colModel,q=o.getColumnCount(),w=this.store,p=w.getCount(),t=true;if(v<0){if(u<0){m--;t=false}while(m>=0){if(!t){u=q-1}t=false;while(u>=0){if(s.call(n||this,m,u,o)===true){return[m,u]}u--}m--}}else{if(u>=q){m++;t=false}while(m<p){if(!t){u=0}t=false;while(u<q){if(s.call(n||this,m,u,o)===true){return[m,u]}u++}m++}}return null},getGridEl:function(){return this.body},stopEditing:Ext.emptyFn,getSelectionModel:function(){if(!this.selModel){this.selModel=new Ext.grid.RowSelectionModel(this.disableSelection?{selectRow:Ext.emptyFn}:null)}return this.selModel},getStore:function(){return this.store},getColumnModel:function(){return this.colModel},getView:function(){if(!this.view){this.view=new Ext.grid.GridView(this.viewConfig)}return this.view},getDragDropText:function(){var b=this.selModel.getCount();return String.format(this.ddText,b,b==1?"":"s")}});Ext.reg("grid",Ext.grid.GridPanel);Ext.grid.PivotGrid=Ext.extend(Ext.grid.GridPanel,{aggregator:"sum",renderer:undefined,initComponent:function(){Ext.grid.PivotGrid.superclass.initComponent.apply(this,arguments);this.initAxes();this.enableColumnResize=false;this.viewConfig=Ext.apply(this.viewConfig||{},{forceFit:true});this.colModel=new Ext.grid.ColumnModel({})},getAggregator:function(){if(typeof this.aggregator=="string"){return Ext.grid.PivotAggregatorMgr.types[this.aggregator]
}else{return this.aggregator}},setAggregator:function(b){this.aggregator=b},setMeasure:function(b){this.measure=b},setLeftAxis:function(c,d){this.leftAxis=c;if(d){this.view.refresh()}},setTopAxis:function(c,d){this.topAxis=c;if(d){this.view.refresh()}},initAxes:function(){var b=Ext.grid.PivotAxis;if(!(this.leftAxis instanceof b)){this.setLeftAxis(new b({orientation:"vertical",dimensions:this.leftAxis||[],store:this.store}))}if(!(this.topAxis instanceof b)){this.setTopAxis(new b({orientation:"horizontal",dimensions:this.topAxis||[],store:this.store}))}},extractData:function(){var C=this.store.data.items,F=C.length,i=[],y,z,A,B;if(F==0){return[]}var x=this.leftAxis.getTuples(),u=x.length,w=this.topAxis.getTuples(),E=w.length,D=this.getAggregator();for(z=0;z<F;z++){y=C[z];for(A=0;A<u;A++){i[A]=i[A]||[];if(x[A].matcher(y)===true){for(B=0;B<E;B++){i[A][B]=i[A][B]||[];if(w[B].matcher(y)){i[A][B].push(y)}}}}}var v=i.length,k,G;for(z=0;z<v;z++){G=i[z];k=G.length;for(A=0;A<k;A++){i[z][A]=D(i[z][A],this.measure)}}return i},getView:function(){if(!this.view){this.view=new Ext.grid.PivotGridView(this.viewConfig)}return this.view}});Ext.reg("pivotgrid",Ext.grid.PivotGrid);Ext.grid.PivotAggregatorMgr=new Ext.AbstractManager();Ext.grid.PivotAggregatorMgr.registerType("sum",function(h,l){var i=h.length,k=0,g;for(g=0;g<i;g++){k+=h[g].get(l)}return k});Ext.grid.PivotAggregatorMgr.registerType("avg",function(h,l){var i=h.length,k=0,g;for(g=0;g<i;g++){k+=h[g].get(l)}return(k/i)||"n/a"});Ext.grid.PivotAggregatorMgr.registerType("min",function(h,l){var i=[],k=h.length,g;for(g=0;g<k;g++){i.push(h[g].get(l))}return Math.min.apply(this,i)||"n/a"});Ext.grid.PivotAggregatorMgr.registerType("max",function(h,l){var i=[],k=h.length,g;for(g=0;g<k;g++){i.push(h[g].get(l))}return Math.max.apply(this,i)||"n/a"});Ext.grid.PivotAggregatorMgr.registerType("count",function(d,c){return d.length});Ext.grid.GridView=Ext.extend(Ext.util.Observable,{deferEmptyText:true,scrollOffset:undefined,autoFill:false,forceFit:false,sortClasses:["sort-asc","sort-desc"],sortAscText:"Sort Ascending",sortDescText:"Sort Descending",columnsText:"Columns",selectedRowClass:"x-grid3-row-selected",borderWidth:2,tdClass:"x-grid3-cell",hdCls:"x-grid3-hd",markDirty:true,cellSelectorDepth:4,rowSelectorDepth:10,rowBodySelectorDepth:10,cellSelector:"td.x-grid3-cell",rowSelector:"div.x-grid3-row",rowBodySelector:"div.x-grid3-row-body",firstRowCls:"x-grid3-row-first",lastRowCls:"x-grid3-row-last",rowClsRe:/(?:^|\s+)x-grid3-row-(first|last|alt)(?:\s+|$)/g,headerMenuOpenCls:"x-grid3-hd-menu-open",rowOverCls:"x-grid3-row-over",constructor:function(b){Ext.apply(this,b);this.addEvents("beforerowremoved","beforerowsinserted","beforerefresh","rowremoved","rowsinserted","rowupdated","refresh");Ext.grid.GridView.superclass.constructor.call(this)},masterTpl:new Ext.Template('<div class="x-grid3" hidefocus="true">','<div class="x-grid3-viewport">','<div class="x-grid3-header">','<div class="x-grid3-header-inner">','<div class="x-grid3-header-offset" style="{ostyle}">{header}</div>',"</div>",'<div class="x-clear"></div>',"</div>",'<div class="x-grid3-scroller">','<div class="x-grid3-body" style="{bstyle}">{body}</div>','<a href="#" class="x-grid3-focus" tabIndex="-1"></a>',"</div>","</div>",'<div class="x-grid3-resize-marker">&#160;</div>','<div class="x-grid3-resize-proxy">&#160;</div>',"</div>"),headerTpl:new Ext.Template('<table border="0" cellspacing="0" cellpadding="0" style="{tstyle}">',"<thead>",'<tr class="x-grid3-hd-row">{cells}</tr>',"</thead>","</table>"),bodyTpl:new Ext.Template("{rows}"),cellTpl:new Ext.Template('<td class="x-grid3-col x-grid3-cell x-grid3-td-{id} {css}" style="{style}" tabIndex="0" {cellAttr}>','<div class="x-grid3-cell-inner x-grid3-col-{id}" unselectable="on" {attr}>{value}</div>',"</td>"),initTemplates:function(){var n=this.templates||{},m,h,k=new Ext.Template('<td class="x-grid3-hd x-grid3-cell x-grid3-td-{id} {css}" style="{style}">','<div {tooltip} {attr} class="x-grid3-hd-inner x-grid3-hd-{id}" unselectable="on" style="{istyle}">',this.grid.enableHdMenu?'<a class="x-grid3-hd-btn" href="#"></a>':"","{value}",'<img alt="" class="x-grid3-sort-icon" src="',Ext.BLANK_IMAGE_URL,'" />',"</div>","</td>"),i=['<tr class="x-grid3-row-body-tr" style="{bodyStyle}">','<td colspan="{cols}" class="x-grid3-body-cell" tabIndex="0" hidefocus="on">','<div class="x-grid3-row-body">{body}</div>',"</td>","</tr>"].join(""),l=['<table class="x-grid3-row-table" border="0" cellspacing="0" cellpadding="0" style="{tstyle}">',"<tbody>","<tr>{cells}</tr>",this.enableRowBody?i:"","</tbody>","</table>"].join("");
Ext.applyIf(n,{hcell:k,cell:this.cellTpl,body:this.bodyTpl,header:this.headerTpl,master:this.masterTpl,row:new Ext.Template('<div class="x-grid3-row {alt}" style="{tstyle}">'+l+"</div>"),rowInner:new Ext.Template(l)});for(h in n){m=n[h];if(m&&Ext.isFunction(m.compile)&&!m.compiled){m.disableFormats=true;m.compile()}}this.templates=n;this.colRe=new RegExp("x-grid3-td-([^\\s]+)","")},fly:function(b){if(!this._flyweight){this._flyweight=new Ext.Element.Flyweight(document.body)}this._flyweight.dom=b;return this._flyweight},getEditorParent:function(){return this.scroller.dom},initElements:function(){var g=Ext.Element,k=Ext.get(this.grid.getGridEl().dom.firstChild),i=new g(k.child("div.x-grid3-viewport")),l=new g(i.child("div.x-grid3-header")),h=new g(i.child("div.x-grid3-scroller"));if(this.grid.hideHeaders){l.setDisplayed(false)}if(this.forceFit){h.setStyle("overflow-x","hidden")}Ext.apply(this,{el:k,mainWrap:i,scroller:h,mainHd:l,innerHd:l.child("div.x-grid3-header-inner").dom,mainBody:new g(g.fly(h).child("div.x-grid3-body")),focusEl:new g(g.fly(h).child("a")),resizeMarker:new g(k.child("div.x-grid3-resize-marker")),resizeProxy:new g(k.child("div.x-grid3-resize-proxy"))});this.focusEl.swallowEvent("click",true)},getRows:function(){return this.hasRows()?this.mainBody.dom.childNodes:[]},findCell:function(b){if(!b){return false}return this.fly(b).findParent(this.cellSelector,this.cellSelectorDepth)},findCellIndex:function(h,i){var e=this.findCell(h),g;if(e){g=this.fly(e).hasClass(i);if(!i||g){return this.getCellIndex(e)}}return false},getCellIndex:function(c){if(c){var d=c.className.match(this.colRe);if(d&&d[1]){return this.cm.getIndexById(d[1])}}return false},findHeaderCell:function(c){var d=this.findCell(c);return d&&this.fly(d).hasClass(this.hdCls)?d:null},findHeaderIndex:function(b){return this.findCellIndex(b,this.hdCls)},findRow:function(b){if(!b){return false}return this.fly(b).findParent(this.rowSelector,this.rowSelectorDepth)},findRowIndex:function(d){var c=this.findRow(d);return c?c.rowIndex:false},findRowBody:function(b){if(!b){return false}return this.fly(b).findParent(this.rowBodySelector,this.rowBodySelectorDepth)},getRow:function(b){return this.getRows()[b]},getCell:function(c,d){return Ext.fly(this.getRow(c)).query(this.cellSelector)[d]},getHeaderCell:function(b){return this.mainHd.dom.getElementsByTagName("td")[b]},addRowClass:function(d,e){var g=this.getRow(d);if(g){this.fly(g).addClass(e)}},removeRowClass:function(g,e){var d=this.getRow(g);if(d){this.fly(d).removeClass(e)}},removeRow:function(b){Ext.removeNode(this.getRow(b));this.syncFocusEl(b)},removeRows:function(i,g){var e=this.mainBody.dom,h;for(h=i;h<=g;h++){Ext.removeNode(e.childNodes[i])}this.syncFocusEl(i)},getScrollState:function(){var b=this.scroller.dom;return{left:b.scrollLeft,top:b.scrollTop}},restoreScroll:function(d){var c=this.scroller.dom;c.scrollLeft=d.left;c.scrollTop=d.top},scrollToTop:function(){var b=this.scroller.dom;b.scrollTop=0;b.scrollLeft=0},syncScroll:function(){this.syncHeaderScroll();var b=this.scroller.dom;this.grid.fireEvent("bodyscroll",b.scrollLeft,b.scrollTop)},syncHeaderScroll:function(){var d=this.innerHd,c=this.scroller.dom.scrollLeft;d.scrollLeft=c;d.scrollLeft=c},updateSortIcon:function(k,l){var h=this.sortClasses,g=h[l=="DESC"?1:0],i=this.mainHd.select("td").removeClass(h);i.item(k).addClass(g)},updateAllColumnWidths:function(){var s=this.getTotalWidth(),o=this.cm.getColumnCount(),i=this.getRows(),q=i.length,v=[],n,w,p,t,u;for(t=0;t<o;t++){v[t]=this.getColumnWidth(t);this.getHeaderCell(t).style.width=v[t]}this.updateHeaderWidth();for(t=0;t<q;t++){n=i[t];n.style.width=s;w=n.firstChild;if(w){w.style.width=s;p=w.rows[0];for(u=0;u<o;u++){p.childNodes[u].style.width=v[u]}}}this.onAllColumnWidthsUpdated(v,s)},updateColumnWidth:function(t,v){var u=this.getColumnWidth(t),o=this.getTotalWidth(),p=this.getHeaderCell(t),w=this.getRows(),s=w.length,i,q,n;this.updateHeaderWidth();p.style.width=u;for(q=0;q<s;q++){i=w[q];n=i.firstChild;
i.style.width=o;if(n){n.style.width=o;n.rows[0].childNodes[t].style.width=u}}this.onColumnWidthUpdated(t,u,o)},updateColumnHidden:function(v,o){var p=this.getTotalWidth(),n=o?"none":"",q=this.getHeaderCell(v),w=this.getRows(),t=w.length,i,u,s;this.updateHeaderWidth();q.style.display=n;for(s=0;s<t;s++){i=w[s];i.style.width=p;u=i.firstChild;if(u){u.style.width=p;u.rows[0].childNodes[v].style.display=n}}this.onColumnHiddenUpdated(v,o,p);delete this.lastViewWidth;this.layout()},doRender:function(R,C,L,U,G,E){var O=this.templates,S=O.cell,i=O.row,J=G-1,T="width:"+this.getTotalWidth()+";",N=[],M=[],K={tstyle:T},H={},B=C.length,A,P,Q,D,F,I;for(F=0;F<B;F++){Q=C[F];M=[];I=F+U;for(D=0;D<G;D++){P=R[D];H.id=P.id;H.css=D===0?"x-grid3-cell-first ":(D==J?"x-grid3-cell-last ":"");H.attr=H.cellAttr="";H.style=P.style;H.value=P.renderer.call(P.scope,Q.data[P.name],H,Q,I,D,L);if(Ext.isEmpty(H.value)){H.value="&#160;"}if(this.markDirty&&Q.dirty&&typeof Q.modified[P.name]!="undefined"){H.css+=" x-grid3-dirty-cell"}M[M.length]=S.apply(H)}A=[];if(E&&((I+1)%2===0)){A[0]="x-grid3-row-alt"}if(Q.dirty){A[1]=" x-grid3-dirty-row"}K.cols=G;if(this.getRowClass){A[2]=this.getRowClass(Q,I,K,L)}K.alt=A.join(" ");K.cells=M.join("");N[N.length]=i.apply(K)}return N.join("")},processRows:function(i,k){if(!this.ds||this.ds.getCount()<1){return}var m=this.getRows(),n=m.length,l,h;k=k||!this.grid.stripeRows;i=i||0;for(h=0;h<n;h++){l=m[h];if(l){l.rowIndex=h;if(!k){l.className=l.className.replace(this.rowClsRe," ");if((h+1)%2===0){l.className+=" x-grid3-row-alt"}}}}if(i===0){Ext.fly(m[0]).addClass(this.firstRowCls)}Ext.fly(m[n-1]).addClass(this.lastRowCls)},afterRender:function(){if(!this.ds||!this.cm){return}this.mainBody.dom.innerHTML=this.renderBody()||"&#160;";this.processRows(0,true);if(this.deferEmptyText!==true){this.applyEmptyText()}this.grid.fireEvent("viewready",this.grid)},afterRenderUI:function(){var b=this.grid;this.initElements();Ext.fly(this.innerHd).on("click",this.handleHdDown,this);this.mainHd.on({scope:this,mouseover:this.handleHdOver,mouseout:this.handleHdOut,mousemove:this.handleHdMove});this.scroller.on("scroll",this.syncScroll,this);if(b.enableColumnResize!==false){this.splitZone=new Ext.grid.GridView.SplitDragZone(b,this.mainHd.dom)}if(b.enableColumnMove){this.columnDrag=new Ext.grid.GridView.ColumnDragZone(b,this.innerHd);this.columnDrop=new Ext.grid.HeaderDropZone(b,this.mainHd.dom)}if(b.enableHdMenu!==false){this.hmenu=new Ext.menu.Menu({id:b.id+"-hctx"});this.hmenu.add({itemId:"asc",text:this.sortAscText,cls:"xg-hmenu-sort-asc"},{itemId:"desc",text:this.sortDescText,cls:"xg-hmenu-sort-desc"});if(b.enableColumnHide!==false){this.colMenu=new Ext.menu.Menu({id:b.id+"-hcols-menu"});this.colMenu.on({scope:this,beforeshow:this.beforeColMenuShow,itemclick:this.handleHdMenuClick});this.hmenu.add("-",{itemId:"columns",hideOnClick:false,text:this.columnsText,menu:this.colMenu,iconCls:"x-cols-icon"})}this.hmenu.on("itemclick",this.handleHdMenuClick,this)}if(b.trackMouseOver){this.mainBody.on({scope:this,mouseover:this.onRowOver,mouseout:this.onRowOut})}if(b.enableDragDrop||b.enableDrag){this.dragZone=new Ext.grid.GridDragZone(b,{ddGroup:b.ddGroup||"GridDD"})}this.updateHeaderSortState()},renderUI:function(){var b=this.templates;return b.master.apply({body:b.body.apply({rows:"&#160;"}),header:this.renderHeaders(),ostyle:"width:"+this.getOffsetWidth()+";",bstyle:"width:"+this.getTotalWidth()+";"})},processEvent:function(t,o){var n=o.getTarget(),u=this.grid,q=this.findHeaderIndex(n),e,m,s,p;u.fireEvent(t,o);if(q!==false){u.fireEvent("header"+t,u,q,o)}else{e=this.findRowIndex(n);if(e!==false){m=this.findCellIndex(n);if(m!==false){s=u.colModel.getColumnAt(m);if(u.fireEvent("cell"+t,u,e,m,o)!==false){if(!s||(s.processEvent&&(s.processEvent(t,o,u,e,m)!==false))){u.fireEvent("row"+t,u,e,o)}}}else{if(u.fireEvent("row"+t,u,e,o)!==false){(p=this.findRowBody(n))&&u.fireEvent("rowbody"+t,u,e,o)}}}else{u.fireEvent("container"+t,u,o)}}},layout:function(n){if(!this.mainBody){return
}var w=this.grid,t=w.getGridEl(),u=t.getSize(true),o=u.width,v=u.height,p=this.scroller,q,s,m;if(o<20||v<20){return}if(w.autoHeight){q=p.dom.style;q.overflow="visible";if(Ext.isWebKit){q.position="static"}}else{this.el.setSize(o,v);s=this.mainHd.getHeight();m=v-s;p.setSize(o,m);if(this.innerHd){this.innerHd.style.width=(o)+"px"}}if(this.forceFit||(n===true&&this.autoFill)){if(this.lastViewWidth!=o){this.fitColumns(false,false);this.lastViewWidth=o}}else{this.autoExpand();this.syncHeaderScroll()}this.onLayout(o,m)},onLayout:function(d,c){},onColumnWidthUpdated:function(g,e,d){},onAllColumnWidthsUpdated:function(d,c){},onColumnHiddenUpdated:function(d,g,e){},updateColumnText:function(d,c){},afterMove:function(b){},init:function(b){this.grid=b;this.initTemplates();this.initData(b.store,b.colModel);this.initUI(b)},getColumnId:function(b){return this.cm.getColumnId(b)},getOffsetWidth:function(){return(this.cm.getTotalWidth()+this.getScrollOffset())+"px"},getScrollOffset:function(){return Ext.num(this.scrollOffset,Ext.getScrollBarWidth())},renderHeaders:function(){var p=this.cm,o=this.templates,u=o.hcell,q={},n=p.getColumnCount(),m=n-1,i=[],s,t;for(s=0;s<n;s++){if(s==0){t="x-grid3-cell-first "}else{t=s==m?"x-grid3-cell-last ":""}q={id:p.getColumnId(s),value:p.getColumnHeader(s)||"",style:this.getColumnStyle(s,true),css:t,tooltip:this.getColumnTooltip(s)};if(p.config[s].align=="right"){q.istyle="padding-right: 16px;"}else{delete q.istyle}i[s]=u.apply(q)}return o.header.apply({cells:i.join(""),tstyle:String.format("width: {0};",this.getTotalWidth())})},getColumnTooltip:function(d){var c=this.cm.getColumnTooltip(d);if(c){if(Ext.QuickTips.isEnabled()){return'ext:qtip="'+c+'"'}else{return'title="'+c+'"'}}return""},beforeUpdate:function(){this.grid.stopEditing(true)},updateHeaders:function(){this.innerHd.firstChild.innerHTML=this.renderHeaders();this.updateHeaderWidth(false)},updateHeaderWidth:function(g){var d=this.innerHd.firstChild,e=this.getTotalWidth();d.style.width=this.getOffsetWidth();d.firstChild.style.width=e;if(g!==false){this.mainBody.dom.style.width=e}},focusRow:function(b){this.focusCell(b,0,false)},focusCell:function(h,e,i){this.syncFocusEl(this.ensureVisible(h,e,i));var g=this.focusEl;if(Ext.isGecko){g.focus()}else{g.focus.defer(1,g)}},resolveCell:function(l,o,m){if(!Ext.isNumber(l)){l=l.rowIndex}if(!this.ds){return null}if(l<0||l>=this.ds.getCount()){return null}o=(o!==undefined?o:0);var p=this.getRow(l),i=this.cm,n=i.getColumnCount(),k;if(!(m===false&&o===0)){while(o<n&&i.isHidden(o)){o++}k=this.getCell(l,o)}return{row:p,cell:k}},getResolvedXY:function(d){if(!d){return null}var e=d.cell,g=d.row;if(e){return Ext.fly(e).getXY()}else{return[this.el.getX(),Ext.fly(g).getY()]}},syncFocusEl:function(h,g,i){var e=h;if(!Ext.isArray(e)){h=Math.min(h,Math.max(0,this.getRows().length-1));if(isNaN(h)){return}e=this.getResolvedXY(this.resolveCell(h,g,i))}this.focusEl.setXY(e||this.scroller.getXY())},ensureVisible:function(H,C,D){var J=this.resolveCell(H,C,D);if(!J||!J.row){return null}var y=J.row,B=J.cell,p=this.scroller.dom,E=y,I=0,c=this.el.dom;while(E&&E!=c){I+=E.offsetTop;E=E.offsetParent}I-=this.mainHd.dom.offsetHeight;c=parseInt(p.scrollTop,10);var K=I+y.offsetHeight,G=p.clientHeight,w=c+G;if(I<c){p.scrollTop=I}else{if(K>w){p.scrollTop=K-G}}if(D!==false){var x=parseInt(B.offsetLeft,10),z=x+B.offsetWidth,A=parseInt(p.scrollLeft,10),F=A+p.clientWidth;if(x<A){p.scrollLeft=x}else{if(z>F){p.scrollLeft=z-p.clientWidth}}}return this.getResolvedXY(J)},insertRows:function(l,m,p,n){var q=l.getCount()-1;if(!n&&m===0&&p>=q){this.fireEvent("beforerowsinserted",this,m,p);this.refresh();this.fireEvent("rowsinserted",this,m,p)}else{if(!n){this.fireEvent("beforerowsinserted",this,m,p)}var k=this.renderRows(m,p),o=this.getRow(m);if(o){if(m===0){Ext.fly(this.getRow(0)).removeClass(this.firstRowCls)}Ext.DomHelper.insertHtml("beforeBegin",o,k)}else{var s=this.getRow(q-1);if(s){Ext.fly(s).removeClass(this.lastRowCls)}Ext.DomHelper.insertHtml("beforeEnd",this.mainBody.dom,k)
}if(!n){this.fireEvent("rowsinserted",this,m,p);this.processRows(m)}else{if(m===0||m>=q){Ext.fly(this.getRow(m)).addClass(m===0?this.firstRowCls:this.lastRowCls)}}}this.syncFocusEl(m)},deleteRows:function(e,g,d){if(e.getRowCount()<1){this.refresh()}else{this.fireEvent("beforerowsdeleted",this,g,d);this.removeRows(g,d);this.processRows(g);this.fireEvent("rowsdeleted",this,g,d)}},getColumnStyle:function(h,m){var i=this.cm,k=i.config,n=m?"":k[h].css||"",l=k[h].align;n+=String.format("width: {0};",this.getColumnWidth(h));if(i.isHidden(h)){n+="display: none; "}if(l){n+=String.format("text-align: {0};",l)}return n},getColumnWidth:function(d){var g=this.cm.getColumnWidth(d),e=this.borderWidth;if(Ext.isNumber(g)){if(Ext.isBorderBox||(Ext.isWebKit&&!Ext.isSafari2)){return g+"px"}else{return Math.max(g-e,0)+"px"}}else{return g}},getTotalWidth:function(){return this.cm.getTotalWidth()+"px"},fitColumns:function(J,H,I){var O=this.grid,F=this.cm,y=F.getTotalWidth(false),A=this.getGridInnerWidth(),z=A-y,M=[],C=0,D=0,i,L,B;if(A<20||z===0){return false}var K=F.getColumnCount(true),E=F.getColumnCount(false),N=K-(Ext.isNumber(I)?1:0);if(N===0){N=1;I=undefined}for(B=0;B<E;B++){if(!F.isFixed(B)&&B!==I){i=F.getColumnWidth(B);M.push(B,i);if(!F.isHidden(B)){C=B;D+=i}}}L=(A-F.getTotalWidth())/D;while(M.length){i=M.pop();B=M.pop();F.setColumnWidth(B,Math.max(O.minColumnWidth,Math.floor(i+i*L)),true)}y=F.getTotalWidth(false);if(y>A){var x=(N==K)?C:I,G=Math.max(1,F.getColumnWidth(x)-(y-A));F.setColumnWidth(x,G,true)}if(J!==true){this.updateAllColumnWidths()}return true},autoExpand:function(m){var w=this.grid,o=this.cm,s=this.getGridInnerWidth(),u=o.getTotalWidth(false),q=w.autoExpandColumn;if(!this.userResized&&q){if(s!=u){var n=o.getIndexById(q),v=o.getColumnWidth(n),p=s-u+v,t=Math.min(Math.max(p,w.autoExpandMin),w.autoExpandMax);if(v!=t){o.setColumnWidth(n,t,true);if(m!==true){this.updateColumnWidth(n,t)}}}}},getGridInnerWidth:function(){return this.grid.getGridEl().getWidth(true)-this.getScrollOffset()},getColumnData:function(){var l=[],n=this.cm,k=n.getColumnCount(),i=this.ds.fields,m,h;for(m=0;m<k;m++){h=n.getDataIndex(m);l[m]={name:Ext.isDefined(h)?h:(i.get(m)?i.get(m).name:undefined),renderer:n.getRenderer(m),scope:n.getRendererScope(m),id:n.getColumnId(m),style:this.getColumnStyle(m)}}return l},renderRows:function(m,s){var u=this.grid,o=u.store,l=u.stripeRows,p=u.colModel,n=p.getColumnCount(),q=o.getCount(),t;if(q<1){return""}m=m||0;s=Ext.isDefined(s)?s:q-1;t=o.getRange(m,s);return this.doRender(this.getColumnData(),t,o,m,n,l)},renderBody:function(){var b=this.renderRows()||"&#160;";return this.templates.body.apply({rows:b})},refreshRow:function(A){var w=this.ds,v=this.cm.getColumnCount(),D=this.getColumnData(),u=v-1,i=["x-grid3-row"],B={tstyle:String.format("width: {0};",this.getTotalWidth())},F=[],x=this.templates.cell,y,G,E,t,z,C;if(Ext.isNumber(A)){y=A;A=w.getAt(y)}else{y=w.indexOf(A)}if(!A||y<0){return}for(C=0;C<v;C++){E=D[C];if(C==0){z="x-grid3-cell-first"}else{z=(C==u)?"x-grid3-cell-last ":""}t={id:E.id,style:E.style,css:z,attr:"",cellAttr:""};t.value=E.renderer.call(E.scope,A.data[E.name],t,A,y,C,w);if(Ext.isEmpty(t.value)){t.value="&#160;"}if(this.markDirty&&A.dirty&&typeof A.modified[E.name]!="undefined"){t.css+=" x-grid3-dirty-cell"}F[C]=x.apply(t)}G=this.getRow(y);G.className="";if(this.grid.stripeRows&&((y+1)%2===0)){i.push("x-grid3-row-alt")}if(this.getRowClass){B.cols=v;i.push(this.getRowClass(A,y,B,w))}this.fly(G).addClass(i).setStyle(B.tstyle);B.cells=F.join("");G.innerHTML=this.templates.rowInner.apply(B);this.fireEvent("rowupdated",this,y,A)},refresh:function(c){this.fireEvent("beforerefresh",this);this.grid.stopEditing(true);var d=this.renderBody();this.mainBody.update(d).setWidth(this.getTotalWidth());if(c===true){this.updateHeaders();this.updateHeaderSortState()}this.processRows(0,true);this.layout();this.applyEmptyText();this.fireEvent("refresh",this)},applyEmptyText:function(){if(this.emptyText&&!this.hasRows()){this.mainBody.update('<div class="x-grid-empty">'+this.emptyText+"</div>")
}},updateHeaderSortState:function(){var d=this.ds.getSortState();if(!d){return}if(!this.sortState||(this.sortState.field!=d.field||this.sortState.direction!=d.direction)){this.grid.fireEvent("sortchange",this.grid,d)}this.sortState=d;var g=this.cm.findColumnIndex(d.field);if(g!=-1){var e=d.direction;this.updateSortIcon(g,e)}},clearHeaderSortState:function(){if(!this.sortState){return}this.grid.fireEvent("sortchange",this.grid,null);this.mainHd.select("td").removeClass(this.sortClasses);delete this.sortState},destroy:function(){var n=this,w=n.grid,t=w.getGridEl(),o=n.dragZone,q=n.splitZone,p=n.columnDrag,s=n.columnDrop,m=n.scrollToTopTask,u,v;if(m&&m.cancel){m.cancel()}Ext.destroyMembers(n,"colMenu","hmenu");n.initData(null,null);n.purgeListeners();Ext.fly(n.innerHd).un("click",n.handleHdDown,n);if(w.enableColumnMove){u=p.dragData;v=p.proxy;Ext.destroy(p.el,v.ghost,v.el,s.el,s.proxyTop,s.proxyBottom,u.ddel,u.header);if(v.anim){Ext.destroy(v.anim)}delete v.ghost;delete u.ddel;delete u.header;p.destroy();delete Ext.dd.DDM.locationCache[p.id];delete p._domRef;delete s.proxyTop;delete s.proxyBottom;s.destroy();delete Ext.dd.DDM.locationCache["gridHeader"+t.id];delete s._domRef;delete Ext.dd.DDM.ids[s.ddGroup]}if(q){q.destroy();delete q._domRef;delete Ext.dd.DDM.ids["gridSplitters"+t.id]}Ext.fly(n.innerHd).removeAllListeners();Ext.removeNode(n.innerHd);delete n.innerHd;Ext.destroy(n.el,n.mainWrap,n.mainHd,n.scroller,n.mainBody,n.focusEl,n.resizeMarker,n.resizeProxy,n.activeHdBtn,n._flyweight,o,q);delete w.container;if(o){o.destroy()}Ext.dd.DDM.currentTarget=null;delete Ext.dd.DDM.locationCache[t.id];Ext.EventManager.removeResizeListener(n.onWindowResize,n)},onDenyColumnHide:function(){},render:function(){if(this.autoFill){var b=this.grid.ownerCt;if(b&&b.getLayout()){b.on("afterlayout",function(){this.fitColumns(true,true);this.updateHeaders();this.updateHeaderSortState()},this,{single:true})}}else{if(this.forceFit){this.fitColumns(true,false)}else{if(this.grid.autoExpandColumn){this.autoExpand(true)}}}this.grid.getGridEl().dom.innerHTML=this.renderUI();this.afterRenderUI()},initData:function(h,i){var g=this;if(g.ds){var k=g.ds;k.un("add",g.onAdd,g);k.un("load",g.onLoad,g);k.un("clear",g.onClear,g);k.un("remove",g.onRemove,g);k.un("update",g.onUpdate,g);k.un("datachanged",g.onDataChange,g);if(k!==h&&k.autoDestroy){k.destroy()}}if(h){h.on({scope:g,load:g.onLoad,add:g.onAdd,remove:g.onRemove,update:g.onUpdate,clear:g.onClear,datachanged:g.onDataChange})}if(g.cm){var l=g.cm;l.un("configchange",g.onColConfigChange,g);l.un("widthchange",g.onColWidthChange,g);l.un("headerchange",g.onHeaderChange,g);l.un("hiddenchange",g.onHiddenChange,g);l.un("columnmoved",g.onColumnMove,g)}if(i){delete g.lastViewWidth;i.on({scope:g,configchange:g.onColConfigChange,widthchange:g.onColWidthChange,headerchange:g.onHeaderChange,hiddenchange:g.onHiddenChange,columnmoved:g.onColumnMove})}g.ds=h;g.cm=i},onDataChange:function(){this.refresh(true);this.updateHeaderSortState();this.syncFocusEl(0)},onClear:function(){this.refresh();this.syncFocusEl(0)},onUpdate:function(c,d){this.refreshRow(d)},onAdd:function(d,e,g){this.insertRows(d,g,g+(e.length-1))},onRemove:function(e,g,i,h){if(h!==true){this.fireEvent("beforerowremoved",this,i,g)}this.removeRow(i);if(h!==true){this.processRows(i);this.applyEmptyText();this.fireEvent("rowremoved",this,i,g)}},onLoad:function(){if(Ext.isGecko){if(!this.scrollToTopTask){this.scrollToTopTask=new Ext.util.DelayedTask(this.scrollToTop,this)}this.scrollToTopTask.delay(1)}else{this.scrollToTop()}},onColWidthChange:function(e,d,g){this.updateColumnWidth(d,g)},onHeaderChange:function(e,d,g){this.updateHeaders()},onHiddenChange:function(e,d,g){this.updateColumnHidden(d,g)},onColumnMove:function(e,g,d){this.indexMap=null;this.refresh(true);this.restoreScroll(this.getScrollState());this.afterMove(d);this.grid.fireEvent("columnmove",g,d)},onColConfigChange:function(){delete this.lastViewWidth;this.indexMap=null;this.refresh(true)},initUI:function(b){b.on("headerclick",this.onHeaderClick,this)
},initEvents:Ext.emptyFn,onHeaderClick:function(c,d){if(this.headersDisabled||!this.cm.isSortable(d)){return}c.stopEditing(true);c.store.sort(this.cm.getDataIndex(d))},onRowOver:function(d,e){var g=this.findRowIndex(e);if(g!==false){this.addRowClass(g,this.rowOverCls)}},onRowOut:function(d,e){var g=this.findRowIndex(e);if(g!==false&&!d.within(this.getRow(g),true)){this.removeRowClass(g,this.rowOverCls)}},onRowSelect:function(b){this.addRowClass(b,this.selectedRowClass)},onRowDeselect:function(b){this.removeRowClass(b,this.selectedRowClass)},onCellSelect:function(g,d){var e=this.getCell(g,d);if(e){this.fly(e).addClass("x-grid3-cell-selected")}},onCellDeselect:function(g,d){var e=this.getCell(g,d);if(e){this.fly(e).removeClass("x-grid3-cell-selected")}},handleWheel:function(b){b.stopPropagation()},onColumnSplitterMoved:function(d,c){this.userResized=true;this.grid.colModel.setColumnWidth(d,c,true);if(this.forceFit){this.fitColumns(true,false,d);this.updateAllColumnWidths()}else{this.updateColumnWidth(d,c);this.syncHeaderScroll()}this.grid.fireEvent("columnresize",d,c)},beforeColMenuShow:function(){var e=this.cm,h=e.getColumnCount(),g=this.colMenu,i;g.removeAll();for(i=0;i<h;i++){if(e.config[i].hideable!==false){g.add(new Ext.menu.CheckItem({text:e.getColumnHeader(i),itemId:"col-"+e.getColumnId(i),checked:!e.isHidden(i),disabled:e.config[i].hideable===false,hideOnClick:false}))}}},handleHdMenuClick:function(g){var e=this.ds,d=this.cm.getDataIndex(this.hdCtxIndex);switch(g.getItemId()){case"asc":e.sort(d,"ASC");break;case"desc":e.sort(d,"DESC");break;default:this.handleHdMenuClickDefault(g)}return true},handleHdMenuClickDefault:function(i){var e=this.cm,h=i.getItemId(),g=e.getIndexById(h.substr(4));if(g!=-1){if(i.checked&&e.getColumnsBy(this.isHideableColumn,this).length<=1){this.onDenyColumnHide();return}e.setHidden(g,i.checked)}},handleHdDown:function(n,m){if(Ext.fly(m).hasClass("x-grid3-hd-btn")){n.stopEvent();var e=this.cm,p=this.findHeaderCell(m),o=this.getCellIndex(p),q=e.isSortable(o),s=this.hmenu,t=s.items,u=this.headerMenuOpenCls;this.hdCtxIndex=o;Ext.fly(p).addClass(u);t.get("asc").setDisabled(!q);t.get("desc").setDisabled(!q);s.on("hide",function(){Ext.fly(p).removeClass(u)},this,{single:true});s.show(m,"tl-bl?")}},handleHdMove:function(w){var y=this.findHeaderCell(this.activeHdRef);if(y&&!this.headersDisabled){var v=this.splitHandleWidth||5,x=this.activeHdRegion,e=y.style,u=this.cm,s="",A=w.getPageX();if(this.grid.enableColumnResize!==false){var E=this.activeHdIndex,D=this.getPreviousVisible(E),t=u.isResizable(E),C=D&&u.isResizable(D),B=A-x.left<=v,z=x.right-A<=(!this.activeHdBtn?v:2);if(B&&C){s=Ext.isAir?"move":Ext.isWebKit?"e-resize":"col-resize"}else{if(z&&t){s=Ext.isAir?"move":Ext.isWebKit?"w-resize":"col-resize"}}}e.cursor=s}},getPreviousVisible:function(b){while(b>0){if(!this.cm.isHidden(b-1)){return b}b--}return undefined},handleHdOver:function(i,e){var h=this.findHeaderCell(e);if(h&&!this.headersDisabled){var g=this.fly(h);this.activeHdRef=e;this.activeHdIndex=this.getCellIndex(h);this.activeHdRegion=g.getRegion();if(!this.isMenuDisabled(this.activeHdIndex,g)){g.addClass("x-grid3-hd-over");this.activeHdBtn=g.child(".x-grid3-hd-btn");if(this.activeHdBtn){this.activeHdBtn.dom.style.height=(h.firstChild.offsetHeight-1)+"px"}}}},handleHdOut:function(d,e){var g=this.findHeaderCell(e);if(g&&(!Ext.isIE||!d.within(g,true))){this.activeHdRef=null;this.fly(g).removeClass("x-grid3-hd-over");g.style.cursor=""}},isMenuDisabled:function(d,c){return this.cm.isMenuDisabled(d)},hasRows:function(){var b=this.mainBody.dom.firstChild;return b&&b.nodeType==1&&b.className!="x-grid-empty"},isHideableColumn:function(b){return !b.hidden},bind:function(d,c){this.initData(d,c)}});Ext.grid.GridView.SplitDragZone=Ext.extend(Ext.dd.DDProxy,{constructor:function(d,c){this.grid=d;this.view=d.getView();this.marker=this.view.resizeMarker;this.proxy=this.view.resizeProxy;Ext.grid.GridView.SplitDragZone.superclass.constructor.call(this,c,"gridSplitters"+this.grid.getGridEl().id,{dragElId:Ext.id(this.proxy.dom),resizeFrame:false});
this.scroll=false;this.hw=this.view.splitHandleWidth||5},b4StartDrag:function(h,i){this.dragHeadersDisabled=this.view.headersDisabled;this.view.headersDisabled=true;var k=this.view.mainWrap.getHeight();this.marker.setHeight(k);this.marker.show();this.marker.alignTo(this.view.getHeaderCell(this.cellIndex),"tl-tl",[-2,0]);this.proxy.setHeight(k);var g=this.cm.getColumnWidth(this.cellIndex),l=Math.max(g-this.grid.minColumnWidth,0);this.resetConstraints();this.setXConstraint(l,1000);this.setYConstraint(0,0);this.minX=h-l;this.maxX=h+1000;this.startPos=h;Ext.dd.DDProxy.prototype.b4StartDrag.call(this,h,i)},allowHeaderDrag:function(b){return true},handleMouseDown:function(u){var o=this.view.findHeaderCell(u.getTarget());if(o&&this.allowHeaderDrag(u)){var e=this.view.fly(o).getXY(),s=e[0],n=u.getXY(),t=n[0],p=o.offsetWidth,q=false;if((t-s)<=this.hw){q=-1}else{if((s+p)-t<=this.hw){q=0}}if(q!==false){this.cm=this.grid.colModel;var m=this.view.getCellIndex(o);if(q==-1){if(m+q<0){return}while(this.cm.isHidden(m+q)){--q;if(m+q<0){return}}}this.cellIndex=m+q;this.split=o.dom;if(this.cm.isResizable(this.cellIndex)&&!this.cm.isFixed(this.cellIndex)){Ext.grid.GridView.SplitDragZone.superclass.handleMouseDown.apply(this,arguments)}}else{if(this.view.columnDrag){this.view.columnDrag.callHandleMouseDown(u)}}}},endDrag:function(i){this.marker.hide();var h=this.view,l=Math.max(this.minX,i.getPageX()),k=l-this.startPos,e=this.dragHeadersDisabled;h.onColumnSplitterMoved(this.cellIndex,this.cm.getColumnWidth(this.cellIndex)+k);setTimeout(function(){h.headersDisabled=e},50)},autoOffset:function(){this.setDelta(0,0)}});Ext.grid.PivotGridView=Ext.extend(Ext.grid.GridView,{colHeaderCellCls:"grid-hd-group-cell",title:"",getColumnHeaders:function(){return this.grid.topAxis.buildHeaders()},getRowHeaders:function(){return this.grid.leftAxis.buildHeaders()},renderRows:function(M,y){var L=this.grid,C=L.extractData(),B=C.length,I=this.templates,z=L.renderer,G=typeof z=="function",w=this.getCellCls,D=typeof w=="function",J=I.cell,i=I.row,F=[],A={},K="width:"+this.getGridInnerWidth()+"px;",E,H,x;M=M||0;y=Ext.isDefined(y)?y:B-1;for(x=0;x<B;x++){row=C[x];colCount=row.length;E=[];rowIndex=M+x;for(j=0;j<colCount;j++){cell=row[j];A.css=j===0?"x-grid3-cell-first ":(j==(colCount-1)?"x-grid3-cell-last ":"");A.attr=A.cellAttr="";A.value=cell;if(Ext.isEmpty(A.value)){A.value="&#160;"}if(G){A.value=z(A.value)}if(D){A.css+=w(A.value)+" "}E[E.length]=J.apply(A)}F[F.length]=i.apply({tstyle:K,cols:colCount,cells:E.join(""),alt:""})}return F.join("")},masterTpl:new Ext.Template('<div class="x-grid3 x-pivotgrid" hidefocus="true">','<div class="x-grid3-viewport">','<div class="x-grid3-header">','<div class="x-grid3-header-title"><span>{title}</span></div>','<div class="x-grid3-header-inner">','<div class="x-grid3-header-offset" style="{ostyle}"></div>',"</div>",'<div class="x-clear"></div>',"</div>",'<div class="x-grid3-scroller">','<div class="x-grid3-row-headers"></div>','<div class="x-grid3-body" style="{bstyle}">{body}</div>','<a href="#" class="x-grid3-focus" tabIndex="-1"></a>',"</div>","</div>",'<div class="x-grid3-resize-marker">&#160;</div>','<div class="x-grid3-resize-proxy">&#160;</div>',"</div>"),initTemplates:function(){Ext.grid.PivotGridView.superclass.initTemplates.apply(this,arguments);var b=this.templates||{};if(!b.gcell){b.gcell=new Ext.XTemplate('<td class="x-grid3-hd x-grid3-gcell x-grid3-td-{id} ux-grid-hd-group-row-{row} '+this.colHeaderCellCls+'" style="{style}">','<div {tooltip} class="x-grid3-hd-inner x-grid3-hd-{id}" unselectable="on" style="{istyle}">',this.grid.enableHdMenu?'<a class="x-grid3-hd-btn" href="#"></a>':"","{value}","</div>","</td>")}this.templates=b;this.hrowRe=new RegExp("ux-grid-hd-group-row-(\\d+)","")},initElements:function(){Ext.grid.PivotGridView.superclass.initElements.apply(this,arguments);this.rowHeadersEl=new Ext.Element(this.scroller.child("div.x-grid3-row-headers"));this.headerTitleEl=new Ext.Element(this.mainHd.child("div.x-grid3-header-title"))
},getGridInnerWidth:function(){var b=Ext.grid.PivotGridView.superclass.getGridInnerWidth.apply(this,arguments);return b-this.getTotalRowHeaderWidth()},getTotalRowHeaderWidth:function(){var h=this.getRowHeaders(),i=h.length,e=0,g;for(g=0;g<i;g++){e+=h[g].width}return e},getTotalColumnHeaderHeight:function(){return this.getColumnHeaders().length*21},renderUI:function(){var c=this.templates,d=this.getGridInnerWidth();return c.master.apply({body:c.body.apply({rows:"&#160;"}),ostyle:"width:"+d+"px",bstyle:"width:"+d+"px"})},onLayout:function(c,d){Ext.grid.PivotGridView.superclass.onLayout.apply(this,arguments);var c=this.getGridInnerWidth();this.resizeColumnHeaders(c);this.resizeAllRows(c)},refresh:function(c){this.fireEvent("beforerefresh",this);this.grid.stopEditing(true);var d=this.renderBody();this.mainBody.update(d).setWidth(this.getGridInnerWidth());if(c===true){this.updateHeaders();this.updateHeaderSortState()}this.processRows(0,true);this.layout();this.applyEmptyText();this.fireEvent("refresh",this)},renderHeaders:Ext.emptyFn,fitColumns:Ext.emptyFn,resizeColumnHeaders:function(c){var d=this.grid.topAxis;if(d.rendered){d.el.setWidth(c)}},resizeRowHeaders:function(){var d=this.getTotalRowHeaderWidth(),c=String.format("margin-left: {0}px;",d);this.rowHeadersEl.setWidth(d);this.mainBody.applyStyles(c);Ext.fly(this.innerHd).applyStyles(c);this.headerTitleEl.setWidth(d);this.headerTitleEl.setHeight(this.getTotalColumnHeaderHeight())},resizeAllRows:function(e){var h=this.getRows(),i=h.length,g;for(g=0;g<i;g++){Ext.fly(h[g]).setWidth(e);Ext.fly(h[g]).child("table").setWidth(e)}},updateHeaders:function(){this.renderGroupRowHeaders();this.renderGroupColumnHeaders()},renderGroupRowHeaders:function(){var b=this.grid.leftAxis;this.resizeRowHeaders();b.rendered=false;b.render(this.rowHeadersEl);this.setTitle(this.title)},setTitle:function(b){this.headerTitleEl.child("span").dom.innerHTML=b},renderGroupColumnHeaders:function(){var b=this.grid.topAxis;b.rendered=false;b.render(this.innerHd.firstChild)},isMenuDisabled:function(d,c){return true}});Ext.grid.PivotAxis=Ext.extend(Ext.Component,{orientation:"horizontal",defaultHeaderWidth:80,paddingWidth:7,setDimensions:function(b){this.dimensions=b},onRender:function(d,e){var g=this.orientation=="horizontal"?this.renderHorizontalRows():this.renderVerticalRows();this.el=Ext.DomHelper.overwrite(d.dom,{tag:"table",cn:g},true)},renderHorizontalRows:function(){var m=this.buildHeaders(),l=m.length,o=[],s,n,p,q,i;for(q=0;q<l;q++){s=[];n=m[q].items;p=n.length;for(i=0;i<p;i++){s.push({tag:"td",html:n[i].header,colspan:n[i].span})}o[q]={tag:"tr",cn:s}}return o},renderVerticalRows:function(){var v=this.buildHeaders(),o=v.length,w=[],i=[],p,u,n,q,s,t;for(s=0;s<o;s++){u=v[s];q=u.width||80;p=u.items.length;for(t=0;t<p;t++){n=u.items[t];w[n.start]=w[n.start]||[];w[n.start].push({tag:"td",html:n.header,rowspan:n.span,width:Ext.isBorderBox?q:q-this.paddingWidth})}}p=w.length;for(s=0;s<p;s++){i[s]={tag:"tr",cn:w[s]}}return i},getTuples:function(){var B=new Ext.data.Store({});B.data=this.store.data.clone();B.fields=this.store.fields;var t=[],C=this.dimensions,A=C.length,v;for(v=0;v<A;v++){t.push({field:C[v].dataIndex,direction:C[v].direction||"ASC"})}B.sort(t);var y=B.data.items,q=[],u=[],i,w,z,x,s;A=y.length;for(v=0;v<A;v++){z=this.getRecordInfo(y[v]);x=z.data;w="";for(s in x){w+=x[s]+"---"}if(q.indexOf(w)==-1){q.push(w);u.push(z)}}B.destroy();return u},getRecordInfo:function(l){var p=this.dimensions,q=p.length,n={},m,s,i;for(i=0;i<q;i++){m=p[i];s=m.dataIndex;n[s]=l.get(s)}var o=function(a){return function(c){for(var b in a){if(c.get(b)!=a[b]){return false}}return true}};return{data:n,matcher:o(n)}},buildHeaders:function(){var y=this.getTuples(),x=y.length,F=this.dimensions,i=F.length,D=[],v,G,w,t,u,E,z,A,B,C;for(B=0;B<i;B++){dimension=F[B];G=[];u=0;E=0;for(C=0;C<x;C++){v=y[C];z=C==(x-1);w=v.data[dimension.dataIndex];A=t!=undefined&&t!=w;if(B>0&&C>0){A=A||v.data[F[B-1].dataIndex]!=y[C-1].data[F[B-1].dataIndex]}if(A){G.push({header:t,span:u,start:E});
E+=u;u=0}if(z){G.push({header:w,span:u+1,start:E});E+=u;u=0}t=w;u++}D.push({items:G,width:dimension.width||this.defaultHeaderWidth});t=undefined}return D}});Ext.grid.HeaderDragZone=Ext.extend(Ext.dd.DragZone,{maxDragWidth:120,constructor:function(e,g,d){this.grid=e;this.view=e.getView();this.ddGroup="gridHeader"+this.grid.getGridEl().id;Ext.grid.HeaderDragZone.superclass.constructor.call(this,g);if(d){this.setHandleElId(Ext.id(g));this.setOuterHandleElId(Ext.id(d))}this.scroll=false},getDragData:function(g){var e=Ext.lib.Event.getTarget(g),d=this.view.findHeaderCell(e);if(d){return{ddel:d.firstChild,header:d}}return false},onInitDrag:function(d){this.dragHeadersDisabled=this.view.headersDisabled;this.view.headersDisabled=true;var c=this.dragData.ddel.cloneNode(true);c.id=Ext.id();c.style.width=Math.min(this.dragData.header.offsetWidth,this.maxDragWidth)+"px";this.proxy.update(c);return true},afterValidDrop:function(){this.completeDrop()},afterInvalidDrop:function(){this.completeDrop()},completeDrop:function(){var d=this.view,c=this.dragHeadersDisabled;setTimeout(function(){d.headersDisabled=c},50)}});Ext.grid.HeaderDropZone=Ext.extend(Ext.dd.DropZone,{proxyOffsets:[-4,-9],fly:Ext.Element.fly,constructor:function(e,g,d){this.grid=e;this.view=e.getView();this.proxyTop=Ext.DomHelper.append(document.body,{cls:"col-move-top",html:"&#160;"},true);this.proxyBottom=Ext.DomHelper.append(document.body,{cls:"col-move-bottom",html:"&#160;"},true);this.proxyTop.hide=this.proxyBottom.hide=function(){this.setLeftTop(-100,-100);this.setStyle("visibility","hidden")};this.ddGroup="gridHeader"+this.grid.getGridEl().id;Ext.grid.HeaderDropZone.superclass.constructor.call(this,e.getGridEl().dom)},getTargetFromEvent:function(g){var e=Ext.lib.Event.getTarget(g),d=this.view.findCellIndex(e);if(d!==false){return this.view.getHeaderCell(d)}},nextVisible:function(g){var d=this.view,e=this.grid.colModel;g=g.nextSibling;while(g){if(!e.isHidden(d.getCellIndex(g))){return g}g=g.nextSibling}return null},prevVisible:function(g){var d=this.view,e=this.grid.colModel;g=g.prevSibling;while(g){if(!e.isHidden(d.getCellIndex(g))){return g}g=g.prevSibling}return null},positionIndicator:function(q,m,n){var h=Ext.lib.Event.getPageX(n),p=Ext.lib.Dom.getRegion(m.firstChild),s,o,e=p.top+this.proxyOffsets[1];if((p.right-h)<=(p.right-p.left)/2){s=p.right+this.view.borderWidth;o="after"}else{s=p.left;o="before"}if(this.grid.colModel.isFixed(this.view.getCellIndex(m))){return false}s+=this.proxyOffsets[0];this.proxyTop.setLeftTop(s,e);this.proxyTop.show();if(!this.bottomOffset){this.bottomOffset=this.view.mainHd.getHeight()}this.proxyBottom.setLeftTop(s,e+this.proxyTop.dom.offsetHeight+this.bottomOffset);this.proxyBottom.show();return o},onNodeEnter:function(h,g,i,e){if(e.header!=h){this.positionIndicator(e.header,h,i)}},onNodeOver:function(i,e,k,l){var h=false;if(l.header!=i){h=this.positionIndicator(l.header,i,k)}if(!h){this.proxyTop.hide();this.proxyBottom.hide()}return h?this.dropAllowed:this.dropNotAllowed},onNodeOut:function(h,g,i,e){this.proxyTop.hide();this.proxyBottom.hide()},onNodeDrop:function(x,h,u,w){var v=w.header;if(v!=x){var q=this.grid.colModel,s=Ext.lib.Event.getPageX(u),y=Ext.lib.Dom.getRegion(x.firstChild),e=(y.right-s)<=((y.right-y.left)/2)?"after":"before",t=this.view.getCellIndex(v),n=this.view.getCellIndex(x);if(e=="after"){n++}if(t<n){n--}q.moveColumn(t,n);return true}return false}});Ext.grid.GridView.ColumnDragZone=Ext.extend(Ext.grid.HeaderDragZone,{constructor:function(d,c){Ext.grid.GridView.ColumnDragZone.superclass.constructor.call(this,d,c,null);this.proxy.el.addClass("x-grid3-col-dd")},handleMouseDown:function(b){},callHandleMouseDown:function(b){Ext.grid.GridView.ColumnDragZone.superclass.handleMouseDown.call(this,b)}});Ext.grid.SplitDragZone=Ext.extend(Ext.dd.DDProxy,{fly:Ext.Element.fly,constructor:function(e,g,d){this.grid=e;this.view=e.getView();this.proxy=this.view.resizeProxy;Ext.grid.SplitDragZone.superclass.constructor.call(this,g,"gridSplitters"+this.grid.getGridEl().id,{dragElId:Ext.id(this.proxy.dom),resizeFrame:false});
this.setHandleElId(Ext.id(g));this.setOuterHandleElId(Ext.id(d));this.scroll=false},b4StartDrag:function(g,h){this.view.headersDisabled=true;this.proxy.setHeight(this.view.mainWrap.getHeight());var e=this.cm.getColumnWidth(this.cellIndex);var i=Math.max(e-this.grid.minColumnWidth,0);this.resetConstraints();this.setXConstraint(i,1000);this.setYConstraint(0,0);this.minX=g-i;this.maxX=g+1000;this.startPos=g;Ext.dd.DDProxy.prototype.b4StartDrag.call(this,g,h)},handleMouseDown:function(g){var d=Ext.EventObject.setEvent(g);var e=this.fly(d.getTarget());if(e.hasClass("x-grid-split")){this.cellIndex=this.view.getCellIndex(e.dom);this.split=e.dom;this.cm=this.grid.colModel;if(this.cm.isResizable(this.cellIndex)&&!this.cm.isFixed(this.cellIndex)){Ext.grid.SplitDragZone.superclass.handleMouseDown.apply(this,arguments)}}},endDrag:function(g){this.view.headersDisabled=false;var e=Math.max(this.minX,Ext.lib.Event.getPageX(g));var d=e-this.startPos;this.view.onColumnSplitterMoved(this.cellIndex,this.cm.getColumnWidth(this.cellIndex)+d)},autoOffset:function(){this.setDelta(0,0)}});Ext.grid.GridDragZone=function(c,d){this.view=c.getView();Ext.grid.GridDragZone.superclass.constructor.call(this,this.view.mainBody.dom,d);this.scroll=false;this.grid=c;this.ddel=document.createElement("div");this.ddel.className="x-grid-dd-wrap"};Ext.extend(Ext.grid.GridDragZone,Ext.dd.DragZone,{ddGroup:"GridDD",getDragData:function(e){var g=Ext.lib.Event.getTarget(e);var h=this.view.findRowIndex(g);if(h!==false){var i=this.grid.selModel;if(!i.isSelected(h)||e.hasModifier()){i.handleMouseDown(this.grid,h,e)}return{grid:this.grid,ddel:this.ddel,rowIndex:h,selections:i.getSelections()}}return false},onInitDrag:function(c){var d=this.dragData;this.ddel.innerHTML=this.grid.getDragDropText();this.proxy.update(this.ddel)},afterRepair:function(){this.dragging=false},getRepairXY:function(c,d){return false},onEndDrag:function(d,c){},onValidDrop:function(e,d,g){this.hideProxy()},beforeInvalidDrop:function(d,c){}});Ext.grid.ColumnModel=Ext.extend(Ext.util.Observable,{defaultWidth:100,defaultSortable:false,constructor:function(b){if(b.columns){Ext.apply(this,b);this.setConfig(b.columns,true)}else{this.setConfig(b,true)}this.addEvents("widthchange","headerchange","hiddenchange","columnmoved","configchange");Ext.grid.ColumnModel.superclass.constructor.call(this)},getColumnId:function(b){return this.config[b].id},getColumnAt:function(b){return this.config[b]},setConfig:function(n,c){var m,k,i;if(!c){delete this.totalWidth;for(m=0,i=this.config.length;m<i;m++){k=this.config[m];if(k.setEditor){k.setEditor(null)}}}this.defaults=Ext.apply({width:this.defaultWidth,sortable:this.defaultSortable},this.defaults);this.config=n;this.lookup={};for(m=0,i=n.length;m<i;m++){k=Ext.applyIf(n[m],this.defaults);if(Ext.isEmpty(k.id)){k.id=m}if(!k.isColumn){var l=Ext.grid.Column.types[k.xtype||"gridcolumn"];k=new l(k);n[m]=k}this.lookup[k.id]=k}if(!c){this.fireEvent("configchange",this)}},getColumnById:function(b){return this.lookup[b]},getIndexById:function(g){for(var d=0,e=this.config.length;d<e;d++){if(this.config[d].id==g){return d}}return -1},moveColumn:function(h,c){var g=this.config,i=g[h];g.splice(h,1);g.splice(c,0,i);this.dataMap=null;this.fireEvent("columnmoved",this,h,c)},getColumnCount:function(c){var i=this.config.length,h=0,g;if(c===true){for(g=0;g<i;g++){if(!this.isHidden(g)){h++}}return h}return i},getColumnsBy:function(n,o){var c=this.config,m=c.length,i=[],p,l;for(p=0;p<m;p++){l=c[p];if(n.call(o||this,l,p)===true){i[i.length]=l}}return i},isSortable:function(b){return !!this.config[b].sortable},isMenuDisabled:function(b){return !!this.config[b].menuDisabled},getRenderer:function(b){return this.config[b].renderer||Ext.grid.ColumnModel.defaultRenderer},getRendererScope:function(b){return this.config[b].scope},setRenderer:function(d,c){this.config[d].renderer=c},getColumnWidth:function(d){var c=this.config[d].width;if(typeof c!="number"){c=this.defaultWidth}return c},setColumnWidth:function(d,g,e){this.config[d].width=g;
this.totalWidth=null;if(!e){this.fireEvent("widthchange",this,d,g)}},getTotalWidth:function(d){if(!this.totalWidth){this.totalWidth=0;for(var g=0,e=this.config.length;g<e;g++){if(d||!this.isHidden(g)){this.totalWidth+=this.getColumnWidth(g)}}}return this.totalWidth},getColumnHeader:function(b){return this.config[b].header},setColumnHeader:function(d,c){this.config[d].header=c;this.fireEvent("headerchange",this,d,c)},getColumnTooltip:function(b){return this.config[b].tooltip},setColumnTooltip:function(d,c){this.config[d].tooltip=c},getDataIndex:function(b){return this.config[b].dataIndex},setDataIndex:function(d,c){this.config[d].dataIndex=c},findColumnIndex:function(i){var h=this.config;for(var c=0,g=h.length;c<g;c++){if(h[c].dataIndex==i){return c}}return -1},isCellEditable:function(c,h){var i=this.config[c],g=i.editable;return !!(g||(!Ext.isDefined(g)&&i.editor))},getCellEditor:function(d,c){return this.config[d].getCellEditor(c)},setEditable:function(d,c){this.config[d].editable=c},isHidden:function(b){return !!this.config[b].hidden},isFixed:function(b){return !!this.config[b].fixed},isResizable:function(b){return b>=0&&this.config[b].resizable!==false&&this.config[b].fixed!==true},setHidden:function(e,c){var g=this.config[e];if(g.hidden!==c){g.hidden=c;this.totalWidth=null;this.fireEvent("hiddenchange",this,e,c)}},setEditor:function(d,c){this.config[d].setEditor(c)},destroy:function(){var c=this.config.length,d=0;for(;d<c;d++){this.config[d].destroy()}delete this.config;delete this.lookup;this.purgeListeners()},setState:function(d,c){c=Ext.applyIf(c,this.defaults);Ext.apply(this.config[d],c)}});Ext.grid.ColumnModel.defaultRenderer=function(b){if(typeof b=="string"&&b.length<1){return"&#160;"}return b};Ext.grid.AbstractSelectionModel=Ext.extend(Ext.util.Observable,{constructor:function(){this.locked=false;Ext.grid.AbstractSelectionModel.superclass.constructor.call(this)},init:function(b){this.grid=b;if(this.lockOnInit){delete this.lockOnInit;this.locked=false;this.lock()}this.initEvents()},lock:function(){if(!this.locked){this.locked=true;var b=this.grid;if(b){b.getView().on({scope:this,beforerefresh:this.sortUnLock,refresh:this.sortLock})}else{this.lockOnInit=true}}},sortLock:function(){this.locked=true},sortUnLock:function(){this.locked=false},unlock:function(){if(this.locked){this.locked=false;var d=this.grid,c;if(d){c=d.getView();c.un("beforerefresh",this.sortUnLock,this);c.un("refresh",this.sortLock,this)}else{delete this.lockOnInit}}},isLocked:function(){return this.locked},destroy:function(){this.unlock();this.purgeListeners()}});Ext.grid.RowSelectionModel=Ext.extend(Ext.grid.AbstractSelectionModel,{singleSelect:false,constructor:function(b){Ext.apply(this,b);this.selections=new Ext.util.MixedCollection(false,function(a){return a.id});this.last=false;this.lastActive=false;this.addEvents("selectionchange","beforerowselect","rowselect","rowdeselect");Ext.grid.RowSelectionModel.superclass.constructor.call(this)},initEvents:function(){if(!this.grid.enableDragDrop&&!this.grid.enableDrag){this.grid.on("rowmousedown",this.handleMouseDown,this)}this.rowNav=new Ext.KeyNav(this.grid.getGridEl(),{up:this.onKeyPress,down:this.onKeyPress,scope:this});this.grid.getView().on({scope:this,refresh:this.onRefresh,rowupdated:this.onRowUpdated,rowremoved:this.onRemove})},onKeyPress:function(l,e){var i=e=="up",k=i?"selectPrevious":"selectNext",m=i?-1:1,n;if(!l.shiftKey||this.singleSelect){this[k](false)}else{if(this.last!==false&&this.lastActive!==false){n=this.last;this.selectRange(this.last,this.lastActive+m);this.grid.getView().focusRow(this.lastActive);if(n!==false){this.last=n}}else{this.selectFirstRow()}}},onRefresh:function(){var i=this.grid.store,k=this.getSelections(),l=0,h=k.length,g;this.silent=true;this.clearSelections(true);for(;l<h;l++){r=k[l];if((g=i.indexOfId(r.id))!=-1){this.selectRow(g,true)}}if(k.length!=this.selections.getCount()){this.fireEvent("selectionchange",this)}this.silent=false},onRemove:function(e,d,g){if(this.selections.remove(g)!==false){this.fireEvent("selectionchange",this)
}},onRowUpdated:function(e,d,g){if(this.isSelected(g)){e.onRowSelect(d)}},selectRecords:function(g,i){if(!i){this.clearSelections()}var k=this.grid.store,l=0,h=g.length;for(;l<h;l++){this.selectRow(k.indexOf(g[l]),true)}},getCount:function(){return this.selections.length},selectFirstRow:function(){this.selectRow(0)},selectLastRow:function(b){this.selectRow(this.grid.store.getCount()-1,b)},selectNext:function(b){if(this.hasNext()){this.selectRow(this.last+1,b);this.grid.getView().focusRow(this.last);return true}return false},selectPrevious:function(b){if(this.hasPrevious()){this.selectRow(this.last-1,b);this.grid.getView().focusRow(this.last);return true}return false},hasNext:function(){return this.last!==false&&(this.last+1)<this.grid.store.getCount()},hasPrevious:function(){return !!this.last},getSelections:function(){return[].concat(this.selections.items)},getSelected:function(){return this.selections.itemAt(0)},each:function(i,k){var l=this.getSelections(),g=0,h=l.length;for(;g<h;g++){if(i.call(k||this,l[g],g)===false){return false}}return true},clearSelections:function(e){if(this.isLocked()){return}if(e!==true){var g=this.grid.store,d=this.selections;d.each(function(a){this.deselectRow(g.indexOfId(a.id))},this);d.clear()}else{this.selections.clear()}this.last=false},selectAll:function(){if(this.isLocked()){return}this.selections.clear();for(var c=0,d=this.grid.store.getCount();c<d;c++){this.selectRow(c,true)}},hasSelection:function(){return this.selections.length>0},isSelected:function(d){var c=Ext.isNumber(d)?this.grid.store.getAt(d):d;return(c&&this.selections.key(c.id)?true:false)},isIdSelected:function(b){return(this.selections.key(b)?true:false)},handleMouseDown:function(m,k,l){if(l.button!==0||this.isLocked()){return}var g=this.grid.getView();if(l.shiftKey&&!this.singleSelect&&this.last!==false){var n=this.last;this.selectRange(n,k,l.ctrlKey);this.last=n;g.focusRow(k)}else{var e=this.isSelected(k);if(l.ctrlKey&&e){this.deselectRow(k)}else{if(!e||this.getCount()>1){this.selectRow(k,l.ctrlKey||l.shiftKey);g.focusRow(k)}}}},selectRows:function(i,h){if(!h){this.clearSelections()}for(var e=0,g=i.length;e<g;e++){this.selectRow(i[e],true)}},selectRange:function(e,g,h){var i;if(this.isLocked()){return}if(!h){this.clearSelections()}if(e<=g){for(i=e;i<=g;i++){this.selectRow(i,true)}}else{for(i=e;i>=g;i--){this.selectRow(i,true)}}},deselectRange:function(i,e,g){if(this.isLocked()){return}for(var h=i;h<=e;h++){this.deselectRow(h,g)}},selectRow:function(e,h,g){if(this.isLocked()||(e<0||e>=this.grid.store.getCount())||(h&&this.isSelected(e))){return}var i=this.grid.store.getAt(e);if(i&&this.fireEvent("beforerowselect",this,e,h,i)!==false){if(!h||this.singleSelect){this.clearSelections()}this.selections.add(i);this.last=this.lastActive=e;if(!g){this.grid.getView().onRowSelect(e)}if(!this.silent){this.fireEvent("rowselect",this,e,i);this.fireEvent("selectionchange",this)}}},deselectRow:function(d,e){if(this.isLocked()){return}if(this.last==d){this.last=false}if(this.lastActive==d){this.lastActive=false}var g=this.grid.store.getAt(d);if(g){this.selections.remove(g);if(!e){this.grid.getView().onRowDeselect(d)}this.fireEvent("rowdeselect",this,d,g);this.fireEvent("selectionchange",this)}},acceptsNav:function(g,d,e){return !e.isHidden(d)&&e.isCellEditable(d,g)},onEditorKey:function(g,s){var w=s.getKey(),v,u=this.grid,c=u.lastEdit,t=u.activeEditor,x=s.shiftKey,e,c,y,k;if(w==s.TAB){s.stopEvent();t.completeEdit();if(x){v=u.walkCells(t.row,t.col-1,-1,this.acceptsNav,this)}else{v=u.walkCells(t.row,t.col+1,1,this.acceptsNav,this)}}else{if(w==s.ENTER){if(this.moveEditorOnEnter!==false){if(x){v=u.walkCells(c.row-1,c.col,-1,this.acceptsNav,this)}else{v=u.walkCells(c.row+1,c.col,1,this.acceptsNav,this)}}}}if(v){y=v[0];k=v[1];if(c.row!=y){this.selectRow(y)}if(u.isEditor&&u.editing){e=u.activeEditor;if(e&&e.field.triggerBlur){e.field.triggerBlur()}}u.startEditing(y,k)}},destroy:function(){Ext.destroy(this.rowNav);this.rowNav=null;Ext.grid.RowSelectionModel.superclass.destroy.call(this)
}});Ext.grid.Column=Ext.extend(Ext.util.Observable,{isColumn:true,constructor:function(c){Ext.apply(this,c);if(Ext.isString(this.renderer)){this.renderer=Ext.util.Format[this.renderer]}else{if(Ext.isObject(this.renderer)){this.scope=this.renderer.scope;this.renderer=this.renderer.fn}}if(!this.scope){this.scope=this}var d=this.editor;delete this.editor;this.setEditor(d);this.addEvents("click","contextmenu","dblclick","mousedown");Ext.grid.Column.superclass.constructor.call(this)},processEvent:function(e,k,l,i,h){return this.fireEvent(e,this,l,i,k)},destroy:function(){if(this.setEditor){this.setEditor(null)}this.purgeListeners()},renderer:function(b){return b},getEditor:function(b){return this.editable!==false?this.editor:null},setEditor:function(c){var d=this.editor;if(d){if(d.gridEditor){d.gridEditor.destroy();delete d.gridEditor}else{d.destroy()}}this.editor=null;if(c){if(!c.isXType){c=Ext.create(c,"textfield")}this.editor=c}},getCellEditor:function(c){var d=this.getEditor(c);if(d){if(!d.startEdit){if(!d.gridEditor){d.gridEditor=new Ext.grid.GridEditor(d)}d=d.gridEditor}}return d}});Ext.grid.BooleanColumn=Ext.extend(Ext.grid.Column,{trueText:"true",falseText:"false",undefinedText:"&#160;",constructor:function(g){Ext.grid.BooleanColumn.superclass.constructor.call(this,g);var i=this.trueText,h=this.falseText,e=this.undefinedText;this.renderer=function(a){if(a===undefined){return e}if(!a||a==="false"){return h}return i}}});Ext.grid.NumberColumn=Ext.extend(Ext.grid.Column,{format:"0,000.00",constructor:function(b){Ext.grid.NumberColumn.superclass.constructor.call(this,b);this.renderer=Ext.util.Format.numberRenderer(this.format)}});Ext.grid.DateColumn=Ext.extend(Ext.grid.Column,{format:"m/d/Y",constructor:function(b){Ext.grid.DateColumn.superclass.constructor.call(this,b);this.renderer=Ext.util.Format.dateRenderer(this.format)}});Ext.grid.TemplateColumn=Ext.extend(Ext.grid.Column,{constructor:function(d){Ext.grid.TemplateColumn.superclass.constructor.call(this,d);var c=(!Ext.isPrimitive(this.tpl)&&this.tpl.compile)?this.tpl:new Ext.XTemplate(this.tpl);this.renderer=function(b,a,g){return c.apply(g.data)};this.tpl=c}});Ext.grid.ActionColumn=Ext.extend(Ext.grid.Column,{header:"&#160;",actionIdRe:/x-action-col-(\d+)/,altText:"",constructor:function(h){var k=this,n=h.items||(k.items=[k]),i=n.length,m,l;Ext.grid.ActionColumn.superclass.constructor.call(k,h);k.renderer=function(b,a){b=Ext.isFunction(h.renderer)?h.renderer.apply(this,arguments)||"":"";a.css+=" x-action-col-cell";for(m=0;m<i;m++){l=n[m];b+='<img alt="'+k.altText+'" src="'+(l.icon||Ext.BLANK_IMAGE_URL)+'" class="x-action-col-icon x-action-col-'+String(m)+" "+(l.iconCls||"")+" "+(Ext.isFunction(l.getClass)?l.getClass.apply(l.scope||this.scope||this,arguments):"")+'"'+((l.tooltip)?' ext:qtip="'+l.tooltip+'"':"")+" />"}return b}},destroy:function(){delete this.items;delete this.renderer;return Ext.grid.ActionColumn.superclass.destroy.apply(this,arguments)},processEvent:function(s,n,q,m,e){var l=n.getTarget().className.match(this.actionIdRe),o,p;if(l&&(o=this.items[parseInt(l[1],10)])){if(s=="click"){(p=o.handler||this.handler)&&p.call(o.scope||this.scope||this,q,m,e,o,n)}else{if((s=="mousedown")&&(o.stopSelection!==false)){return false}}}return Ext.grid.ActionColumn.superclass.processEvent.apply(this,arguments)}});Ext.grid.Column.types={gridcolumn:Ext.grid.Column,booleancolumn:Ext.grid.BooleanColumn,numbercolumn:Ext.grid.NumberColumn,datecolumn:Ext.grid.DateColumn,templatecolumn:Ext.grid.TemplateColumn,actioncolumn:Ext.grid.ActionColumn};Ext.grid.RowNumberer=Ext.extend(Object,{header:"",width:23,sortable:false,constructor:function(b){Ext.apply(this,b);if(this.rowspan){this.renderer=this.renderer.createDelegate(this)}},fixed:true,hideable:false,menuDisabled:true,dataIndex:"",id:"numberer",rowspan:undefined,renderer:function(e,i,g,h){if(this.rowspan){i.cellAttr='rowspan="'+this.rowspan+'"'}return h+1}});Ext.grid.CheckboxSelectionModel=Ext.extend(Ext.grid.RowSelectionModel,{header:'<div class="x-grid3-hd-checker">&#160;</div>',width:20,sortable:false,menuDisabled:true,fixed:true,hideable:false,dataIndex:"",id:"checker",isColumn:true,constructor:function(){Ext.grid.CheckboxSelectionModel.superclass.constructor.apply(this,arguments);
if(this.checkOnly){this.handleMouseDown=Ext.emptyFn}},initEvents:function(){Ext.grid.CheckboxSelectionModel.superclass.initEvents.call(this);this.grid.on("render",function(){Ext.fly(this.grid.getView().innerHd).on("mousedown",this.onHdMouseDown,this)},this)},processEvent:function(e,k,l,i,h){if(e=="mousedown"){this.onMouseDown(k,k.getTarget());return false}else{return Ext.grid.Column.prototype.processEvent.apply(this,arguments)}},onMouseDown:function(i,e){if(i.button===0&&e.className=="x-grid3-row-checker"){i.stopEvent();var h=i.getTarget(".x-grid3-row");if(h){var g=h.rowIndex;if(this.isSelected(g)){this.deselectRow(g)}else{this.selectRow(g,true);this.grid.getView().focusRow(g)}}}},onHdMouseDown:function(i,g){if(g.className=="x-grid3-hd-checker"){i.stopEvent();var e=Ext.fly(g.parentNode);var h=e.hasClass("x-grid3-hd-checker-on");if(h){e.removeClass("x-grid3-hd-checker-on");this.clearSelections()}else{e.addClass("x-grid3-hd-checker-on");this.selectAll()}}},renderer:function(d,g,e){return'<div class="x-grid3-row-checker">&#160;</div>'}});Ext.grid.CellSelectionModel=Ext.extend(Ext.grid.AbstractSelectionModel,{constructor:function(b){Ext.apply(this,b);this.selection=null;this.addEvents("beforecellselect","cellselect","selectionchange");Ext.grid.CellSelectionModel.superclass.constructor.call(this)},initEvents:function(){this.grid.on("cellmousedown",this.handleMouseDown,this);this.grid.on(Ext.EventManager.getKeyEvent(),this.handleKeyDown,this);this.grid.getView().on({scope:this,refresh:this.onViewChange,rowupdated:this.onRowUpdated,beforerowremoved:this.clearSelections,beforerowsinserted:this.clearSelections});if(this.grid.isEditor){this.grid.on("beforeedit",this.beforeEdit,this)}},beforeEdit:function(b){this.select(b.row,b.column,false,true,b.record)},onRowUpdated:function(e,d,g){if(this.selection&&this.selection.record==g){e.onCellSelect(d,this.selection.cell[1])}},onViewChange:function(){this.clearSelections(true)},getSelectedCell:function(){return this.selection?this.selection.cell:null},clearSelections:function(c){var d=this.selection;if(d){if(c!==true){this.grid.view.onCellDeselect(d.cell[0],d.cell[1])}this.selection=null;this.fireEvent("selectionchange",this,null)}},hasSelection:function(){return this.selection?true:false},handleMouseDown:function(e,h,g,i){if(i.button!==0||this.isLocked()){return}this.select(h,g)},select:function(k,n,h,l,m){if(this.fireEvent("beforecellselect",this,k,n)!==false){this.clearSelections();m=m||this.grid.store.getAt(k);this.selection={record:m,cell:[k,n]};if(!h){var i=this.grid.getView();i.onCellSelect(k,n);if(l!==true){i.focusCell(k,n)}}this.fireEvent("cellselect",this,k,n);this.fireEvent("selectionchange",this,this.selection)}},isSelectable:function(g,d,e){return !e.isHidden(d)},onEditorKey:function(c,d){if(d.getKey()==d.TAB){this.handleKeyDown(d)}},handleKeyDown:function(t){if(!t.isNavKeyPress()){return}var w=t.getKey(),u=this.grid,c=this.selection,x=this,k=function(a,d,b){return u.walkCells(a,d,b,u.isEditor&&u.editing?x.acceptsNav:x.isSelectable,x)},e,v,y,s,g;switch(w){case t.ESC:case t.PAGE_UP:case t.PAGE_DOWN:break;default:t.stopEvent();break}if(!c){e=k(0,0,1);if(e){this.select(e[0],e[1])}return}e=c.cell;y=e[0];s=e[1];switch(w){case t.TAB:if(t.shiftKey){v=k(y,s-1,-1)}else{v=k(y,s+1,1)}break;case t.DOWN:v=k(y+1,s,1);break;case t.UP:v=k(y-1,s,-1);break;case t.RIGHT:v=k(y,s+1,1);break;case t.LEFT:v=k(y,s-1,-1);break;case t.ENTER:if(u.isEditor&&!u.editing){u.startEditing(y,s);return}break}if(v){y=v[0];s=v[1];this.select(y,s);if(u.isEditor&&u.editing){g=u.activeEditor;if(g&&g.field.triggerBlur){g.field.triggerBlur()}u.startEditing(y,s)}}},acceptsNav:function(g,d,e){return !e.isHidden(d)&&e.isCellEditable(d,g)}});Ext.grid.EditorGridPanel=Ext.extend(Ext.grid.GridPanel,{clicksToEdit:2,forceValidation:false,isEditor:true,detectEdit:false,autoEncode:false,trackMouseOver:false,initComponent:function(){Ext.grid.EditorGridPanel.superclass.initComponent.call(this);if(!this.selModel){this.selModel=new Ext.grid.CellSelectionModel()
}this.activeEditor=null;this.addEvents("beforeedit","afteredit","validateedit")},initEvents:function(){Ext.grid.EditorGridPanel.superclass.initEvents.call(this);this.getGridEl().on("mousewheel",this.stopEditing.createDelegate(this,[true]),this);this.on("columnresize",this.stopEditing,this,[true]);if(this.clicksToEdit==1){this.on("cellclick",this.onCellDblClick,this)}else{var b=this.getView();if(this.clicksToEdit=="auto"&&b.mainBody){b.mainBody.on("mousedown",this.onAutoEditClick,this)}this.on("celldblclick",this.onCellDblClick,this)}},onResize:function(){Ext.grid.EditorGridPanel.superclass.onResize.apply(this,arguments);var b=this.activeEditor;if(this.editing&&b){b.realign(true)}},onCellDblClick:function(d,g,e){this.startEditing(g,e)},onAutoEditClick:function(l,e){if(l.button!==0){return}var i=this.view.findRowIndex(e),h=this.view.findCellIndex(e);if(i!==false&&h!==false){this.stopEditing();if(this.selModel.getSelectedCell){var k=this.selModel.getSelectedCell();if(k&&k[0]===i&&k[1]===h){this.startEditing(i,h)}}else{if(this.selModel.isSelected(i)){this.startEditing(i,h)}}}},onEditComplete:function(e,m,i){this.editing=false;this.lastActiveEditor=this.activeEditor;this.activeEditor=null;var n=e.record,k=this.colModel.getDataIndex(e.col);m=this.postEditValue(m,i,n,k);if(this.forceValidation===true||String(m)!==String(i)){var l={grid:this,record:n,field:k,originalValue:i,value:m,row:e.row,column:e.col,cancel:false};if(this.fireEvent("validateedit",l)!==false&&!l.cancel&&String(m)!==String(i)){n.set(k,l.value);delete l.cancel;this.fireEvent("afteredit",l)}}this.view.focusCell(e.row,e.col)},startEditing:function(l,p){this.stopEditing();if(this.colModel.isCellEditable(p,l)){this.view.ensureVisible(l,p,true);var o=this.store.getAt(l),m=this.colModel.getDataIndex(p),n={grid:this,record:o,field:m,value:o.data[m],row:l,column:p,cancel:false};if(this.fireEvent("beforeedit",n)!==false&&!n.cancel){this.editing=true;var e=this.colModel.getCellEditor(p,l);if(!e){return}if(!e.rendered){e.parentEl=this.view.getEditorParent(e);e.on({scope:this,render:{fn:function(a){a.field.focus(false,true)},single:true,scope:this},specialkey:function(a,b){this.getSelectionModel().onEditorKey(a,b)},complete:this.onEditComplete,canceledit:this.stopEditing.createDelegate(this,[true])})}Ext.apply(e,{row:l,col:p,record:o});this.lastEdit={row:l,col:p};this.activeEditor=e;e.selectSameEditor=(this.activeEditor==this.lastActiveEditor);var k=this.preEditValue(o,m);e.startEdit(this.view.getCell(l,p).firstChild,Ext.isDefined(k)?k:"");(function(){delete e.selectSameEditor}).defer(50)}}},preEditValue:function(e,g){var d=e.data[g];return this.autoEncode&&Ext.isString(d)?Ext.util.Format.htmlDecode(d):d},postEditValue:function(i,g,e,h){return this.autoEncode&&Ext.isString(i)?Ext.util.Format.htmlEncode(i):i},stopEditing:function(c){if(this.editing){var d=this.lastActiveEditor=this.activeEditor;if(d){d[c===true?"cancelEdit":"completeEdit"]();this.view.focusCell(d.row,d.col)}this.activeEditor=null}this.editing=false}});Ext.reg("editorgrid",Ext.grid.EditorGridPanel);Ext.grid.GridEditor=function(c,d){Ext.grid.GridEditor.superclass.constructor.call(this,c,d);c.monitorTab=false};Ext.extend(Ext.grid.GridEditor,Ext.Editor,{alignment:"tl-tl",autoSize:"width",hideEl:false,cls:"x-small-editor x-grid-editor",shim:false,shadow:false});Ext.grid.PropertyRecord=Ext.data.Record.create([{name:"name",type:"string"},"value"]);Ext.grid.PropertyStore=Ext.extend(Ext.util.Observable,{constructor:function(d,c){this.grid=d;this.store=new Ext.data.Store({recordType:Ext.grid.PropertyRecord});this.store.on("update",this.onUpdate,this);if(c){this.setSource(c)}Ext.grid.PropertyStore.superclass.constructor.call(this)},setSource:function(g){this.source=g;this.store.removeAll();var d=[];for(var e in g){if(this.isEditableValue(g[e])){d.push(new Ext.grid.PropertyRecord({name:e,value:g[e]},e))}}this.store.loadRecords({records:d},{},true)},onUpdate:function(i,h,k){if(k==Ext.data.Record.EDIT){var g=h.data.value;var l=h.modified.value;
if(this.grid.fireEvent("beforepropertychange",this.source,h.id,g,l)!==false){this.source[h.id]=g;h.commit();this.grid.fireEvent("propertychange",this.source,h.id,g,l)}else{h.reject()}}},getProperty:function(b){return this.store.getAt(b)},isEditableValue:function(b){return Ext.isPrimitive(b)||Ext.isDate(b)},setValue:function(h,i,g){var e=this.getRec(h);if(e){e.set("value",i);this.source[h]=i}else{if(g){this.source[h]=i;e=new Ext.grid.PropertyRecord({name:h,value:i},h);this.store.add(e)}}},remove:function(c){var d=this.getRec(c);if(d){this.store.remove(d);delete this.source[c]}},getRec:function(b){return this.store.getById(b)},getSource:function(){return this.source}});Ext.grid.PropertyColumnModel=Ext.extend(Ext.grid.ColumnModel,{nameText:"Name",valueText:"Value",dateFormat:"m/j/Y",trueText:"true",falseText:"false",constructor:function(l,g){var k=Ext.grid,i=Ext.form;this.grid=l;k.PropertyColumnModel.superclass.constructor.call(this,[{header:this.nameText,width:50,sortable:true,dataIndex:"name",id:"name",menuDisabled:true},{header:this.valueText,width:50,resizable:false,dataIndex:"value",id:"value",menuDisabled:true}]);this.store=g;var h=new i.Field({autoCreate:{tag:"select",children:[{tag:"option",value:"true",html:this.trueText},{tag:"option",value:"false",html:this.falseText}]},getValue:function(){return this.el.dom.value=="true"}});this.editors={date:new k.GridEditor(new i.DateField({selectOnFocus:true})),string:new k.GridEditor(new i.TextField({selectOnFocus:true})),number:new k.GridEditor(new i.NumberField({selectOnFocus:true,style:"text-align:left;"})),"boolean":new k.GridEditor(h,{autoSize:"both"})};this.renderCellDelegate=this.renderCell.createDelegate(this);this.renderPropDelegate=this.renderProp.createDelegate(this)},renderDate:function(b){return b.dateFormat(this.dateFormat)},renderBool:function(b){return this[b?"trueText":"falseText"]},isCellEditable:function(d,c){return d==1},getRenderer:function(b){return b==1?this.renderCellDelegate:this.renderPropDelegate},renderProp:function(b){return this.getPropertyName(b)},renderCell:function(k,g,l){var h=this.grid.customRenderers[l.get("name")];if(h){return h.apply(this,arguments)}var i=k;if(Ext.isDate(k)){i=this.renderDate(k)}else{if(typeof k=="boolean"){i=this.renderBool(k)}}return Ext.util.Format.htmlEncode(i)},getPropertyName:function(c){var d=this.grid.propertyNames;return d&&d[c]?d[c]:c},getCellEditor:function(h,i){var g=this.store.getProperty(i),k=g.data.name,l=g.data.value;if(this.grid.customEditors[k]){return this.grid.customEditors[k]}if(Ext.isDate(l)){return this.editors.date}else{if(typeof l=="number"){return this.editors.number}else{if(typeof l=="boolean"){return this.editors["boolean"]}else{return this.editors.string}}}},destroy:function(){Ext.grid.PropertyColumnModel.superclass.destroy.call(this);this.destroyEditors(this.editors);this.destroyEditors(this.grid.customEditors)},destroyEditors:function(c){for(var d in c){Ext.destroy(c[d])}}});Ext.grid.PropertyGrid=Ext.extend(Ext.grid.EditorGridPanel,{enableColumnMove:false,stripeRows:false,trackMouseOver:false,clicksToEdit:1,enableHdMenu:false,viewConfig:{forceFit:true},initComponent:function(){this.customRenderers=this.customRenderers||{};this.customEditors=this.customEditors||{};this.lastEditRow=null;var c=new Ext.grid.PropertyStore(this);this.propStore=c;var d=new Ext.grid.PropertyColumnModel(this,c);c.store.sort("name","ASC");this.addEvents("beforepropertychange","propertychange");this.cm=d;this.ds=c.store;Ext.grid.PropertyGrid.superclass.initComponent.call(this);this.mon(this.selModel,"beforecellselect",function(a,b,g){if(g===0){this.startEditing.defer(200,this,[b,1]);return false}},this)},onRender:function(){Ext.grid.PropertyGrid.superclass.onRender.apply(this,arguments);this.getGridEl().addClass("x-props-grid")},afterRender:function(){Ext.grid.PropertyGrid.superclass.afterRender.apply(this,arguments);if(this.source){this.setSource(this.source)}},setSource:function(b){this.propStore.setSource(b)},getSource:function(){return this.propStore.getSource()
},setProperty:function(g,d,e){this.propStore.setValue(g,d,e)},removeProperty:function(b){this.propStore.remove(b)}});Ext.reg("propertygrid",Ext.grid.PropertyGrid);Ext.grid.GroupingView=Ext.extend(Ext.grid.GridView,{groupByText:"Group By This Field",showGroupsText:"Show in Groups",hideGroupedColumn:false,showGroupName:true,startCollapsed:false,enableGrouping:true,enableGroupingMenu:true,enableNoGroups:true,emptyGroupText:"(None)",ignoreAdd:false,groupTextTpl:"{text}",groupMode:"value",cancelEditOnToggle:true,initTemplates:function(){Ext.grid.GroupingView.superclass.initTemplates.call(this);this.state={};var b=this.grid.getSelectionModel();b.on(b.selectRow?"beforerowselect":"beforecellselect",this.onBeforeRowSelect,this);if(!this.startGroup){this.startGroup=new Ext.XTemplate('<div id="{groupId}" class="x-grid-group {cls}">','<div id="{groupId}-hd" class="x-grid-group-hd" style="{style}"><div class="x-grid-group-title">',this.groupTextTpl,"</div></div>",'<div id="{groupId}-bd" class="x-grid-group-body">')}this.startGroup.compile();if(!this.endGroup){this.endGroup="</div></div>"}},findGroup:function(b){return Ext.fly(b).up(".x-grid-group",this.mainBody.dom)},getGroups:function(){return this.hasRows()?this.mainBody.dom.childNodes:[]},onAdd:function(h,g,e){if(this.canGroup()&&!this.ignoreAdd){var i=this.getScrollState();this.fireEvent("beforerowsinserted",h,e,e+(g.length-1));this.refresh();this.restoreScroll(i);this.fireEvent("rowsinserted",h,e,e+(g.length-1))}else{if(!this.canGroup()){Ext.grid.GroupingView.superclass.onAdd.apply(this,arguments)}}},onRemove:function(i,h,g,k){Ext.grid.GroupingView.superclass.onRemove.apply(this,arguments);var l=document.getElementById(h._groupId);if(l&&l.childNodes[1].childNodes.length<1){Ext.removeNode(l)}this.applyEmptyText()},refreshRow:function(b){if(this.ds.getCount()==1){this.refresh()}else{this.isUpdating=true;Ext.grid.GroupingView.superclass.refreshRow.apply(this,arguments);this.isUpdating=false}},beforeMenuShow:function(){var g,e=this.hmenu.items,d=this.cm.config[this.hdCtxIndex].groupable===false;if((g=e.get("groupBy"))){g.setDisabled(d)}if((g=e.get("showGroups"))){g.setDisabled(d);g.setChecked(this.canGroup(),true)}},renderUI:function(){var b=Ext.grid.GroupingView.superclass.renderUI.call(this);if(this.enableGroupingMenu&&this.hmenu){this.hmenu.add("-",{itemId:"groupBy",text:this.groupByText,handler:this.onGroupByClick,scope:this,iconCls:"x-group-by-icon"});if(this.enableNoGroups){this.hmenu.add({itemId:"showGroups",text:this.showGroupsText,checked:true,checkHandler:this.onShowGroupsClick,scope:this})}this.hmenu.on("beforeshow",this.beforeMenuShow,this)}return b},processEvent:function(e,l){Ext.grid.GroupingView.superclass.processEvent.call(this,e,l);var m=l.getTarget(".x-grid-group-hd",this.mainBody);if(m){var n=this.getGroupField(),o=this.getPrefix(n),k=m.id.substring(o.length),p=new RegExp("gp-"+Ext.escapeRe(n)+"--hd");k=k.substr(0,k.length-3);if(k||p.test(m.id)){this.grid.fireEvent("group"+e,this.grid,n,k,l)}if(e=="mousedown"&&l.button==0){this.toggleGroup(m.parentNode)}}},onGroupByClick:function(){this.enableGrouping=true;this.grid.store.groupBy(this.cm.getDataIndex(this.hdCtxIndex));this.grid.fireEvent("groupchange",this,this.grid.store.getGroupState());this.beforeMenuShow();this.refresh()},onShowGroupsClick:function(d,c){this.enableGrouping=c;if(c){this.onGroupByClick()}else{this.grid.store.clearGrouping();this.grid.fireEvent("groupchange",this,null)}},toggleRowIndex:function(g,e){if(!this.canGroup()){return}var d=this.getRow(g);if(d){this.toggleGroup(this.findGroup(d),e)}},toggleGroup:function(g,d){var e=Ext.get(g);d=Ext.isDefined(d)?d:e.hasClass("x-grid-group-collapsed");if(this.state[e.id]!==d){if(this.cancelEditOnToggle!==false){this.grid.stopEditing(true)}this.state[e.id]=d;e[d?"removeClass":"addClass"]("x-grid-group-collapsed")}},toggleAllGroups:function(i){var e=this.getGroups();for(var h=0,g=e.length;h<g;h++){this.toggleGroup(e[h],i)}},expandAllGroups:function(){this.toggleAllGroups(true)
},collapseAllGroups:function(){this.toggleAllGroups(false)},getGroup:function(l,p,n,m,g,o){var s=this.cm.config[g],q=n?n.call(s.scope,l,{},p,m,g,o):String(l);if(q===""||q==="&#160;"){q=s.emptyGroupText||this.emptyGroupText}return q},getGroupField:function(){return this.grid.store.getGroupState()},afterRender:function(){if(!this.ds||!this.cm){return}Ext.grid.GroupingView.superclass.afterRender.call(this);if(this.grid.deferRowRender){this.updateGroupWidths()}},afterRenderUI:function(){Ext.grid.GroupingView.superclass.afterRenderUI.call(this);if(this.enableGroupingMenu&&this.hmenu){this.hmenu.add("-",{itemId:"groupBy",text:this.groupByText,handler:this.onGroupByClick,scope:this,iconCls:"x-group-by-icon"});if(this.enableNoGroups){this.hmenu.add({itemId:"showGroups",text:this.showGroupsText,checked:true,checkHandler:this.onShowGroupsClick,scope:this})}this.hmenu.on("beforeshow",this.beforeMenuShow,this)}},renderRows:function(){var h=this.getGroupField();var i=!!h;if(this.hideGroupedColumn){var g=this.cm.findColumnIndex(h),k=Ext.isDefined(this.lastGroupField);if(!i&&k){this.mainBody.update("");this.cm.setHidden(this.cm.findColumnIndex(this.lastGroupField),false);delete this.lastGroupField}else{if(i&&!k){this.lastGroupField=h;this.cm.setHidden(g,true)}else{if(i&&k&&h!==this.lastGroupField){this.mainBody.update("");var l=this.cm.findColumnIndex(this.lastGroupField);this.cm.setHidden(l,false);this.lastGroupField=h;this.cm.setHidden(g,true)}}}}return Ext.grid.GroupingView.superclass.renderRows.apply(this,arguments)},doRender:function(S,P,G,U,H,F){if(P.length<1){return""}if(!this.canGroup()||this.isUpdating){return Ext.grid.GroupingView.superclass.doRender.apply(this,arguments)}var I=this.getGroupField(),J=this.cm.findColumnIndex(I),B,O="width:"+this.getTotalWidth()+";",Q=this.cm.config[J],T=Q.groupRenderer||Q.renderer,E=this.showGroupName?(Q.groupName||Q.header)+": ":"",g=[],M,D,C,K;for(D=0,C=P.length;D<C;D++){var N=U+D,L=P[D],R=L.data[I];B=this.getGroup(R,L,T,N,J,G);if(!M||M.group!=B){K=this.constructId(R,I,J);this.state[K]=!(Ext.isDefined(this.state[K])?!this.state[K]:this.startCollapsed);M={group:B,gvalue:R,text:E+B,groupId:K,startRow:N,rs:[L],cls:this.state[K]?"":"x-grid-group-collapsed",style:O};g.push(M)}else{M.rs.push(L)}L._groupId=K}var i=[];for(D=0,C=g.length;D<C;D++){B=g[D];this.doGroupStart(i,B,S,G,H);i[i.length]=Ext.grid.GroupingView.superclass.doRender.call(this,S,B.rs,G,B.startRow,H,F);this.doGroupEnd(i,B,S,G,H)}return i.join("")},getGroupId:function(d){var c=this.getGroupField();return this.constructId(d,c,this.cm.findColumnIndex(c))},constructId:function(n,l,i){var h=this.cm.config[i],m=h.groupRenderer||h.renderer,k=(this.groupMode=="value")?n:this.getGroup(n,{data:{}},m,0,i,this.ds);return this.getPrefix(l)+Ext.util.Format.htmlEncode(k)},canGroup:function(){return this.enableGrouping&&!!this.getGroupField()},getPrefix:function(b){return this.grid.getGridEl().id+"-gp-"+b+"-"},doGroupStart:function(h,k,g,i,l){h[h.length]=this.startGroup.apply(k)},doGroupEnd:function(h,k,g,i,l){h[h.length]=this.endGroup},getRows:function(){if(!this.canGroup()){return Ext.grid.GroupingView.superclass.getRows.call(this)}var l=[],p=this.getGroups(),m,n=0,i=p.length,o,g;for(;n<i;++n){m=p[n].childNodes[1];if(m){m=m.childNodes;for(o=0,g=m.length;o<g;++o){l[l.length]=m[o]}}}return l},updateGroupWidths:function(){if(!this.canGroup()||!this.hasRows()){return}var i=Math.max(this.cm.getTotalWidth(),this.el.dom.offsetWidth-this.getScrollOffset())+"px";var e=this.getGroups();for(var h=0,g=e.length;h<g;h++){e[h].firstChild.style.width=i}},onColumnWidthUpdated:function(g,e,d){Ext.grid.GroupingView.superclass.onColumnWidthUpdated.call(this,g,e,d);this.updateGroupWidths()},onAllColumnWidthsUpdated:function(d,c){Ext.grid.GroupingView.superclass.onAllColumnWidthsUpdated.call(this,d,c);this.updateGroupWidths()},onColumnHiddenUpdated:function(d,g,e){Ext.grid.GroupingView.superclass.onColumnHiddenUpdated.call(this,d,g,e);this.updateGroupWidths()},onLayout:function(){this.updateGroupWidths()
},onBeforeRowSelect:function(c,d){this.toggleRowIndex(d,true)}});Ext.grid.GroupingView.GROUP_ID=1000;var OpenLayers={singleFile:true};(function(){var j=(typeof OpenLayers=="object"&&OpenLayers.singleFile);var a;window.OpenLayers={_scriptName:(!j)?"lib/OpenLayers.js":"OpenLayers.js",_getScriptLocation:function(){if(a!=undefined){return a}a="";var r=new RegExp("(^|(.*?\\/))("+OpenLayers._scriptName+")(\\?|$)");var n=document.getElementsByTagName("script");for(var p=0,h=n.length;p<h;p++){var q=n[p].getAttribute("src");if(q){var o=q.match(r);if(o){a=o[1];break}}}return a}};if(!j){var k=new Array("OpenLayers/Util.js","OpenLayers/BaseTypes.js","OpenLayers/BaseTypes/Class.js","OpenLayers/BaseTypes/Bounds.js","OpenLayers/BaseTypes/Element.js","OpenLayers/BaseTypes/LonLat.js","OpenLayers/BaseTypes/Pixel.js","OpenLayers/BaseTypes/Size.js","OpenLayers/Console.js","OpenLayers/Tween.js","Rico/Corner.js","Rico/Color.js","OpenLayers/Ajax.js","OpenLayers/Events.js","OpenLayers/Request.js","OpenLayers/Request/XMLHttpRequest.js","OpenLayers/Projection.js","OpenLayers/Map.js","OpenLayers/Layer.js","OpenLayers/Icon.js","OpenLayers/Marker.js","OpenLayers/Marker/Box.js","OpenLayers/Popup.js","OpenLayers/Tile.js","OpenLayers/Tile/Image.js","OpenLayers/Tile/Image/IFrame.js","OpenLayers/Tile/WFS.js","OpenLayers/Layer/Image.js","OpenLayers/Layer/SphericalMercator.js","OpenLayers/Layer/EventPane.js","OpenLayers/Layer/FixedZoomLevels.js","OpenLayers/Layer/Google.js","OpenLayers/Layer/Google/v3.js","OpenLayers/Layer/VirtualEarth.js","OpenLayers/Layer/Yahoo.js","OpenLayers/Layer/HTTPRequest.js","OpenLayers/Layer/Grid.js","OpenLayers/Layer/MapGuide.js","OpenLayers/Layer/MapServer.js","OpenLayers/Layer/MapServer/Untiled.js","OpenLayers/Layer/KaMap.js","OpenLayers/Layer/KaMapCache.js","OpenLayers/Layer/MultiMap.js","OpenLayers/Layer/Markers.js","OpenLayers/Layer/Text.js","OpenLayers/Layer/WorldWind.js","OpenLayers/Layer/ArcGIS93Rest.js","OpenLayers/Layer/WMS.js","OpenLayers/Layer/WMS/Untiled.js","OpenLayers/Layer/WMS/Post.js","OpenLayers/Layer/WMTS.js","OpenLayers/Layer/ArcIMS.js","OpenLayers/Layer/GeoRSS.js","OpenLayers/Layer/Boxes.js","OpenLayers/Layer/XYZ.js","OpenLayers/Layer/TMS.js","OpenLayers/Layer/TileCache.js","OpenLayers/Layer/Zoomify.js","OpenLayers/Popup/Anchored.js","OpenLayers/Popup/AnchoredBubble.js","OpenLayers/Popup/Framed.js","OpenLayers/Popup/FramedCloud.js","OpenLayers/Feature.js","OpenLayers/Feature/Vector.js","OpenLayers/Feature/WFS.js","OpenLayers/Handler.js","OpenLayers/Handler/Click.js","OpenLayers/Handler/Hover.js","OpenLayers/Handler/Point.js","OpenLayers/Handler/Path.js","OpenLayers/Handler/Polygon.js","OpenLayers/Handler/Feature.js","OpenLayers/Handler/Drag.js","OpenLayers/Handler/RegularPolygon.js","OpenLayers/Handler/Box.js","OpenLayers/Handler/MouseWheel.js","OpenLayers/Handler/Keyboard.js","OpenLayers/Control.js","OpenLayers/Control/Attribution.js","OpenLayers/Control/Button.js","OpenLayers/Control/ZoomBox.js","OpenLayers/Control/ZoomToMaxExtent.js","OpenLayers/Control/DragPan.js","OpenLayers/Control/Navigation.js","OpenLayers/Control/MouseDefaults.js","OpenLayers/Control/MousePosition.js","OpenLayers/Control/OverviewMap.js","OpenLayers/Control/KeyboardDefaults.js","OpenLayers/Control/PanZoom.js","OpenLayers/Control/PanZoomBar.js","OpenLayers/Control/ArgParser.js","OpenLayers/Control/Permalink.js","OpenLayers/Control/Scale.js","OpenLayers/Control/ScaleLine.js","OpenLayers/Control/Snapping.js","OpenLayers/Control/Split.js","OpenLayers/Control/LayerSwitcher.js","OpenLayers/Control/DrawFeature.js","OpenLayers/Control/DragFeature.js","OpenLayers/Control/ModifyFeature.js","OpenLayers/Control/Panel.js","OpenLayers/Control/SelectFeature.js","OpenLayers/Control/NavigationHistory.js","OpenLayers/Control/Measure.js","OpenLayers/Control/WMSGetFeatureInfo.js","OpenLayers/Control/WMTSGetFeatureInfo.js","OpenLayers/Control/Graticule.js","OpenLayers/Control/TransformFeature.js","OpenLayers/Control/SLDSelect.js","OpenLayers/Geometry.js","OpenLayers/Geometry/Rectangle.js","OpenLayers/Geometry/Collection.js","OpenLayers/Geometry/Point.js","OpenLayers/Geometry/MultiPoint.js","OpenLayers/Geometry/Curve.js","OpenLayers/Geometry/LineString.js","OpenLayers/Geometry/LinearRing.js","OpenLayers/Geometry/Polygon.js","OpenLayers/Geometry/MultiLineString.js","OpenLayers/Geometry/MultiPolygon.js","OpenLayers/Geometry/Surface.js","OpenLayers/Renderer.js","OpenLayers/Renderer/Elements.js","OpenLayers/Renderer/SVG.js","OpenLayers/Renderer/Canvas.js","OpenLayers/Renderer/VML.js","OpenLayers/Layer/Vector.js","OpenLayers/Layer/Vector/RootContainer.js","OpenLayers/Strategy.js","OpenLayers/Strategy/Filter.js","OpenLayers/Strategy/Fixed.js","OpenLayers/Strategy/Cluster.js","OpenLayers/Strategy/Paging.js","OpenLayers/Strategy/BBOX.js","OpenLayers/Strategy/Save.js","OpenLayers/Strategy/Refresh.js","OpenLayers/Filter.js","OpenLayers/Filter/FeatureId.js","OpenLayers/Filter/Logical.js","OpenLayers/Filter/Comparison.js","OpenLayers/Filter/Spatial.js","OpenLayers/Protocol.js","OpenLayers/Protocol/HTTP.js","OpenLayers/Protocol/SQL.js","OpenLayers/Protocol/SQL/Gears.js","OpenLayers/Protocol/WFS.js","OpenLayers/Protocol/WFS/v1.js","OpenLayers/Protocol/WFS/v1_0_0.js","OpenLayers/Protocol/WFS/v1_1_0.js","OpenLayers/Protocol/SOS.js","OpenLayers/Protocol/SOS/v1_0_0.js","OpenLayers/Layer/PointTrack.js","OpenLayers/Layer/GML.js","OpenLayers/Style.js","OpenLayers/Style2.js","OpenLayers/StyleMap.js","OpenLayers/Rule.js","OpenLayers/Format.js","OpenLayers/Format/XML.js","OpenLayers/Format/Context.js","OpenLayers/Format/ArcXML.js","OpenLayers/Format/ArcXML/Features.js","OpenLayers/Format/GML.js","OpenLayers/Format/GML/Base.js","OpenLayers/Format/GML/v2.js","OpenLayers/Format/GML/v3.js","OpenLayers/Format/Atom.js","OpenLayers/Format/KML.js","OpenLayers/Format/GeoRSS.js","OpenLayers/Format/WFS.js","OpenLayers/Format/WFSCapabilities.js","OpenLayers/Format/WFSCapabilities/v1.js","OpenLayers/Format/WFSCapabilities/v1_0_0.js","OpenLayers/Format/WFSCapabilities/v1_1_0.js","OpenLayers/Format/WFSDescribeFeatureType.js","OpenLayers/Format/WMSDescribeLayer.js","OpenLayers/Format/WMSDescribeLayer/v1_1.js","OpenLayers/Format/WKT.js","OpenLayers/Format/OSM.js","OpenLayers/Format/GPX.js","OpenLayers/Format/Filter.js","OpenLayers/Format/Filter/v1.js","OpenLayers/Format/Filter/v1_0_0.js","OpenLayers/Format/Filter/v1_1_0.js","OpenLayers/Format/SLD.js","OpenLayers/Format/SLD/v1.js","OpenLayers/Format/SLD/v1_0_0.js","OpenLayers/Format/OWSCommon/v1.js","OpenLayers/Format/OWSCommon/v1_0_0.js","OpenLayers/Format/OWSCommon/v1_1_0.js","OpenLayers/Format/CSWGetDomain.js","OpenLayers/Format/CSWGetDomain/v2_0_2.js","OpenLayers/Format/CSWGetRecords.js","OpenLayers/Format/CSWGetRecords/v2_0_2.js","OpenLayers/Format/WFST.js","OpenLayers/Format/WFST/v1.js","OpenLayers/Format/WFST/v1_0_0.js","OpenLayers/Format/WFST/v1_1_0.js","OpenLayers/Format/Text.js","OpenLayers/Format/JSON.js","OpenLayers/Format/GeoJSON.js","OpenLayers/Format/WMC.js","OpenLayers/Format/WMC/v1.js","OpenLayers/Format/WMC/v1_0_0.js","OpenLayers/Format/WMC/v1_1_0.js","OpenLayers/Format/WMSCapabilities.js","OpenLayers/Format/WMSCapabilities/v1.js","OpenLayers/Format/WMSCapabilities/v1_1.js","OpenLayers/Format/WMSCapabilities/v1_1_0.js","OpenLayers/Format/WMSCapabilities/v1_1_1.js","OpenLayers/Format/WMSCapabilities/v1_3.js","OpenLayers/Format/WMSCapabilities/v1_3_0.js","OpenLayers/Format/WMSGetFeatureInfo.js","OpenLayers/Format/SOSCapabilities.js","OpenLayers/Format/SOSCapabilities/v1_0_0.js","OpenLayers/Format/SOSGetObservation.js","OpenLayers/Format/SOSGetFeatureOfInterest.js","OpenLayers/Format/OWSContext.js","OpenLayers/Format/OWSContext/v0_3_1.js","OpenLayers/Format/WMTSCapabilities.js","OpenLayers/Format/WMTSCapabilities/v1_0_0.js","OpenLayers/Layer/WFS.js","OpenLayers/Control/GetFeature.js","OpenLayers/Control/MouseToolbar.js","OpenLayers/Control/NavToolbar.js","OpenLayers/Control/PanPanel.js","OpenLayers/Control/Pan.js","OpenLayers/Control/ZoomIn.js","OpenLayers/Control/ZoomOut.js","OpenLayers/Control/ZoomPanel.js","OpenLayers/Control/EditingToolbar.js","OpenLayers/Symbolizer.js","OpenLayers/Symbolizer/Point.js","OpenLayers/Symbolizer/Line.js","OpenLayers/Symbolizer/Polygon.js","OpenLayers/Symbolizer/Text.js","OpenLayers/Symbolizer/Raster.js","OpenLayers/Lang.js","OpenLayers/Lang/en.js");
var c=navigator.userAgent;var e=(c.match("MSIE")||c.match("Safari"));if(e){var b=new Array(k.length)}var l=OpenLayers._getScriptLocation()+"lib/";for(var d=0,g=k.length;d<g;d++){if(e){b[d]="<script src='"+l+k[d]+"'><\/script>"}else{var m=document.createElement("script");m.src=l+k[d];var f=document.getElementsByTagName("head").length?document.getElementsByTagName("head")[0]:document.body;f.appendChild(m)}}if(e){document.write(b.join(""))}}})();OpenLayers.VERSION_NUMBER="OpenLayers 2.10 -- $Revision: 10721 $";OpenLayers.String={startsWith:function(b,a){return(b.indexOf(a)==0)},contains:function(b,a){return(b.indexOf(a)!=-1)},trim:function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},camelize:function(f){var d=f.split("-");var b=d[0];for(var c=1,a=d.length;c<a;c++){var e=d[c];b+=e.charAt(0).toUpperCase()+e.substring(1)}return b},format:function(d,c,a){if(!c){c=window}var b=function(j,e){var h;var g=e.split(/\.+/);for(var f=0;f<g.length;f++){if(f==0){h=c}h=h[g[f]]}if(typeof h=="function"){h=a?h.apply(null,a):h()}if(typeof h=="undefined"){return"undefined"}else{return h}};return d.replace(OpenLayers.String.tokenRegEx,b)},tokenRegEx:/\$\{([\w.]+?)\}/g,numberRegEx:/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/,isNumeric:function(a){return OpenLayers.String.numberRegEx.test(a)},numericIf:function(a){return OpenLayers.String.isNumeric(a)?parseFloat(a):a}};if(!String.prototype.startsWith){String.prototype.startsWith=function(a){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.String.startsWith"}));return OpenLayers.String.startsWith(this,a)}}if(!String.prototype.contains){String.prototype.contains=function(a){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.String.contains"}));return OpenLayers.String.contains(this,a)}}if(!String.prototype.trim){String.prototype.trim=function(){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.String.trim"}));return OpenLayers.String.trim(this)}}if(!String.prototype.camelize){String.prototype.camelize=function(){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.String.camelize"}));return OpenLayers.String.camelize(this)}}OpenLayers.Number={decimalSeparator:".",thousandsSeparator:",",limitSigDigs:function(a,c){var b=0;if(c>0){b=parseFloat(a.toPrecision(c))}return b},format:function(c,a,g,i){a=(typeof a!="undefined")?a:0;g=(typeof g!="undefined")?g:OpenLayers.Number.thousandsSeparator;i=(typeof i!="undefined")?i:OpenLayers.Number.decimalSeparator;if(a!=null){c=parseFloat(c.toFixed(a))}var b=c.toString().split(".");if(b.length==1&&a==null){a=0}var d=b[0];if(g){var e=/(-?[0-9]+)([0-9]{3})/;while(e.test(d)){d=d.replace(e,"$1"+g+"$2")}}var f;if(a==0){f=d}else{var h=b.length>1?b[1]:"0";if(a!=null){h=h+new Array(a-h.length+1).join("0")}f=d+i+h}return f}};if(!Number.prototype.limitSigDigs){Number.prototype.limitSigDigs=function(a){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.Number.limitSigDigs"}));return OpenLayers.Number.limitSigDigs(this,a)}}OpenLayers.Function={bind:function(c,b){var a=Array.prototype.slice.apply(arguments,[2]);return function(){var d=a.concat(Array.prototype.slice.apply(arguments,[0]));return c.apply(b,d)}},bindAsEventListener:function(b,a){return function(c){return b.call(a,c||window.event)}},False:function(){return false},True:function(){return true}};if(!Function.prototype.bind){Function.prototype.bind=function(){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.Function.bind"}));Array.prototype.unshift.apply(arguments,[this]);return OpenLayers.Function.bind.apply(null,arguments)}}if(!Function.prototype.bindAsEventListener){Function.prototype.bindAsEventListener=function(a){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.Function.bindAsEventListener"}));return OpenLayers.Function.bindAsEventListener(this,a)}}OpenLayers.Array={filter:function(g,f,b){var d=[];
if(Array.prototype.filter){d=g.filter(f,b)}else{var a=g.length;if(typeof f!="function"){throw new TypeError()}for(var c=0;c<a;c++){if(c in g){var e=g[c];if(f.call(b,e,c,g)){d.push(e)}}}}return d}};OpenLayers.Date={toISOString:(function(){if("toISOString" in Date.prototype){return function(b){return b.toISOString()}}else{function a(c,b){var d=c+"";while(d.length<b){d="0"+d}return d}return function(b){var c;if(isNaN(b.getTime())){c="Invalid Date"}else{c=b.getUTCFullYear()+"-"+a(b.getUTCMonth()+1,2)+"-"+a(b.getUTCDate(),2)+"T"+a(b.getUTCHours(),2)+":"+a(b.getUTCMinutes(),2)+":"+a(b.getUTCSeconds(),2)+"."+a(b.getUTCMilliseconds(),3)+"Z"}return c}}})(),parse:function(j){var b;var p=Date.parse(j);if(!isNaN(p)){b=new Date(p)}else{var h=j.match(/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{1,2}):(\d{2}):(\d{2}(?:\.\d+)?)(Z|(?:[+-]\d{1,2}(?::(\d{2}))?)))?$/);var b;if(h&&(h[1]||h[7])){var k=parseInt(h[1],10)||0;var i=(parseInt(h[2],10)-1)||0;var m=parseInt(h[3],10)||1;b=new Date(Date.UTC(k,i,m));var l=h[7];if(l){var n=parseInt(h[4],10);var d=parseInt(h[5],10);var a=parseFloat(h[6]);var o=a|0;var c=Math.round(1000*(a-o));b.setUTCHours(n,d,o,c);if(l!=="Z"){var g=parseInt(l,10);var f=parseInt(h[8])||0;var e=-1000*(60*(g*60)+f*60);b=new Date(b.getTime()+e)}}}else{b=new Date("invalid")}}return b}};OpenLayers.Class=function(){var e=function(){if(arguments&&arguments[0]!=OpenLayers.Class.isPrototype){this.initialize.apply(this,arguments)}};var c={};var g,b,d;for(var f=0,a=arguments.length;f<a;++f){d=arguments[f];if(typeof d=="function"){if(f==0&&a>1){b=d.prototype.initialize;d.prototype.initialize=function(){};c=new d();if(b===undefined){delete d.prototype.initialize}else{d.prototype.initialize=b}}g=d.prototype}else{g=d}OpenLayers.Util.extend(c,g)}e.prototype=c;return e};OpenLayers.Class.isPrototype=function(){};OpenLayers.Class.create=function(){return function(){if(arguments&&arguments[0]!=OpenLayers.Class.isPrototype){this.initialize.apply(this,arguments)}}};OpenLayers.Class.inherit=function(){var d=arguments[0];var e=new d(OpenLayers.Class.isPrototype);for(var c=1,a=arguments.length;c<a;c++){if(typeof arguments[c]=="function"){var b=arguments[c];arguments[c]=new b(OpenLayers.Class.isPrototype)}OpenLayers.Util.extend(e,arguments[c])}return e};OpenLayers.Util={};OpenLayers.Util.getElement=function(){var d=[];for(var c=0,a=arguments.length;c<a;c++){var b=arguments[c];if(typeof b=="string"){b=document.getElementById(b)}if(arguments.length==1){return b}d.push(b)}return d};OpenLayers.Util.isElement=function(a){return !!(a&&a.nodeType===1)};if(typeof window.$==="undefined"){window.$=OpenLayers.Util.getElement}OpenLayers.Util.extend=function(a,e){a=a||{};if(e){for(var d in e){var c=e[d];if(c!==undefined){a[d]=c}}var b=typeof window.Event=="function"&&e instanceof window.Event;if(!b&&e.hasOwnProperty&&e.hasOwnProperty("toString")){a.toString=e.toString}}return a};OpenLayers.Util.removeItem=function(c,b){for(var a=c.length-1;a>=0;a--){if(c[a]==b){c.splice(a,1)}}return c};OpenLayers.Util.clearArray=function(a){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"array = []"}));a.length=0};OpenLayers.Util.indexOf=function(d,c){if(typeof d.indexOf=="function"){return d.indexOf(c)}else{for(var b=0,a=d.length;b<a;b++){if(d[b]==c){return b}}return -1}};OpenLayers.Util.modifyDOMElement=function(e,h,d,f,a,c,g,b){if(h){e.id=h}if(d){e.style.left=d.x+"px";e.style.top=d.y+"px"}if(f){e.style.width=f.w+"px";e.style.height=f.h+"px"}if(a){e.style.position=a}if(c){e.style.border=c}if(g){e.style.overflow=g}if(parseFloat(b)>=0&&parseFloat(b)<1){e.style.filter="alpha(opacity="+(b*100)+")";e.style.opacity=b}else{if(parseFloat(b)==1){e.style.filter="";e.style.opacity=""}}};OpenLayers.Util.createDiv=function(a,i,h,f,e,c,b,g){var d=document.createElement("div");if(f){d.style.backgroundImage="url("+f+")"}if(!a){a=OpenLayers.Util.createUniqueID("OpenLayersDiv")}if(!e){e="absolute"}OpenLayers.Util.modifyDOMElement(d,a,i,h,e,c,b,g);return d};OpenLayers.Util.createImage=function(a,h,g,e,d,c,f,i){var b=document.createElement("img");
if(!a){a=OpenLayers.Util.createUniqueID("OpenLayersDiv")}if(!d){d="relative"}OpenLayers.Util.modifyDOMElement(b,a,h,g,d,c,null,f);if(i){b.style.display="none";OpenLayers.Event.observe(b,"load",OpenLayers.Function.bind(OpenLayers.Util.onImageLoad,b));OpenLayers.Event.observe(b,"error",OpenLayers.Function.bind(OpenLayers.Util.onImageLoadError,b))}b.style.alt=a;b.galleryImg="no";if(e){b.src=e}return b};OpenLayers.Util.setOpacity=function(b,a){OpenLayers.Util.modifyDOMElement(b,null,null,null,null,null,null,a)};OpenLayers.Util.onImageLoad=function(){if(!this.viewRequestID||(this.map&&this.viewRequestID==this.map.viewRequestID)){this.style.display=""}OpenLayers.Element.removeClass(this,"olImageLoadError")};OpenLayers.IMAGE_RELOAD_ATTEMPTS=0;OpenLayers.Util.onImageLoadError=function(){this._attempts=(this._attempts)?(this._attempts+1):1;if(this._attempts<=OpenLayers.IMAGE_RELOAD_ATTEMPTS){var d=this.urls;if(d&&d instanceof Array&&d.length>1){var e=this.src.toString();var c,a;for(a=0;c=d[a];a++){if(e.indexOf(c)!=-1){break}}var f=Math.floor(d.length*Math.random());var b=d[f];a=0;while(b==c&&a++<4){f=Math.floor(d.length*Math.random());b=d[f]}this.src=e.replace(c,b)}else{this.src=this.src}}else{OpenLayers.Element.addClass(this,"olImageLoadError")}this.style.display=""};OpenLayers.Util.alphaHackNeeded=null;OpenLayers.Util.alphaHack=function(){if(OpenLayers.Util.alphaHackNeeded==null){var d=navigator.appVersion.split("MSIE");var a=parseFloat(d[1]);var b=false;try{b=!!(document.body.filters)}catch(c){}OpenLayers.Util.alphaHackNeeded=(b&&(a>=5.5)&&(a<7))}return OpenLayers.Util.alphaHackNeeded};OpenLayers.Util.modifyAlphaImageDiv=function(a,b,j,i,g,f,c,d,h){OpenLayers.Util.modifyDOMElement(a,b,j,i,f,null,null,h);var e=a.childNodes[0];if(g){e.src=g}OpenLayers.Util.modifyDOMElement(e,a.id+"_innerImage",null,i,"relative",c);if(OpenLayers.Util.alphaHack()){if(a.style.display!="none"){a.style.display="inline-block"}if(d==null){d="scale"}a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+e.src+"', sizingMethod='"+d+"')";if(parseFloat(a.style.opacity)>=0&&parseFloat(a.style.opacity)<1){a.style.filter+=" alpha(opacity="+a.style.opacity*100+")"}e.style.filter="alpha(opacity=0)"}};OpenLayers.Util.createAlphaImageDiv=function(b,j,i,g,f,c,d,h,k){var a=OpenLayers.Util.createDiv();var e=OpenLayers.Util.createImage(null,null,null,null,null,null,null,false);a.appendChild(e);if(k){e.style.display="none";OpenLayers.Event.observe(e,"load",OpenLayers.Function.bind(OpenLayers.Util.onImageLoad,a));OpenLayers.Event.observe(e,"error",OpenLayers.Function.bind(OpenLayers.Util.onImageLoadError,a))}OpenLayers.Util.modifyAlphaImageDiv(a,b,j,i,g,f,c,d,h);return a};OpenLayers.Util.upperCaseObject=function(b){var a={};for(var c in b){a[c.toUpperCase()]=b[c]}return a};OpenLayers.Util.applyDefaults=function(d,c){d=d||{};var b=typeof window.Event=="function"&&c instanceof window.Event;for(var a in c){if(d[a]===undefined||(!b&&c.hasOwnProperty&&c.hasOwnProperty(a)&&!d.hasOwnProperty(a))){d[a]=c[a]}}if(!b&&c&&c.hasOwnProperty&&c.hasOwnProperty("toString")&&!d.hasOwnProperty("toString")){d.toString=c.toString}return d};OpenLayers.Util.getParameterString=function(c){var b=[];for(var h in c){var g=c[h];if((g!=null)&&(typeof g!="function")){var d;if(typeof g=="object"&&g.constructor==Array){var e=[];var i;for(var a=0,f=g.length;a<f;a++){i=g[a];e.push(encodeURIComponent((i===null||i===undefined)?"":i))}d=e.join(",")}else{d=encodeURIComponent(g)}b.push(encodeURIComponent(h)+"="+d)}}return b.join("&")};OpenLayers.Util.urlAppend=function(a,b){var d=a;if(b){var c=(a+" ").split(/[?&]/);d+=(c.pop()===" "?b:c.length?"&"+b:"?"+b)}return d};OpenLayers.ImgPath="";OpenLayers.Util.getImagesLocation=function(){return OpenLayers.ImgPath||(OpenLayers._getScriptLocation()+"img/")};OpenLayers.Util.Try=function(){var d=null;for(var c=0,a=arguments.length;c<a;c++){var b=arguments[c];try{d=b();break}catch(f){}}return d};OpenLayers.Util.getNodes=function(c,b){var a=OpenLayers.Util.Try(function(){return OpenLayers.Util._getNodes(c.documentElement.childNodes,b)
},function(){return OpenLayers.Util._getNodes(c.childNodes,b)});return a};OpenLayers.Util._getNodes=function(c,e){var b=[];for(var d=0,a=c.length;d<a;d++){if(c[d].nodeName==e){b.push(c[d])}}return b};OpenLayers.Util.getTagText=function(c,d,b){var a=OpenLayers.Util.getNodes(c,d);if(a&&(a.length>0)){if(!b){b=0}if(a[b].childNodes.length>1){return a.childNodes[1].nodeValue}else{if(a[b].childNodes.length==1){return a[b].firstChild.nodeValue}}}else{return""}};OpenLayers.Util.getXmlNodeValue=function(a){var b=null;OpenLayers.Util.Try(function(){b=a.text;if(!b){b=a.textContent}if(!b){b=a.firstChild.nodeValue}},function(){b=a.textContent});return b};OpenLayers.Util.mouseLeft=function(a,c){var b=(a.relatedTarget)?a.relatedTarget:a.toElement;while(b!=c&&b!=null){b=b.parentNode}return(b!=c)};OpenLayers.Util.DEFAULT_PRECISION=14;OpenLayers.Util.toFloat=function(b,a){if(a==null){a=OpenLayers.Util.DEFAULT_PRECISION}var b;if(a==0){b=parseFloat(b)}else{b=parseFloat(parseFloat(b).toPrecision(a))}return b};OpenLayers.Util.rad=function(a){return a*Math.PI/180};OpenLayers.Util.deg=function(a){return a*180/Math.PI};OpenLayers.Util.VincentyConstants={a:6378137,b:6356752.3142,f:1/298.257223563};OpenLayers.Util.distVincenty=function(g,e){var k=OpenLayers.Util.VincentyConstants;var M=k.a,K=k.b,G=k.f;var n=OpenLayers.Util.rad(e.lon-g.lon);var J=Math.atan((1-G)*Math.tan(OpenLayers.Util.rad(g.lat)));var I=Math.atan((1-G)*Math.tan(OpenLayers.Util.rad(e.lat)));var m=Math.sin(J),i=Math.cos(J);var l=Math.sin(I),h=Math.cos(I);var r=n,o=2*Math.PI;var q=20;while(Math.abs(r-o)>1e-12&&--q>0){var z=Math.sin(r),c=Math.cos(r);var N=Math.sqrt((h*z)*(h*z)+(i*l-m*h*c)*(i*l-m*h*c));if(N==0){return 0}var E=m*l+i*h*c;var y=Math.atan2(N,E);var j=Math.asin(i*h*z/N);var F=Math.cos(j)*Math.cos(j);var p=E-2*m*l/F;var v=G/16*F*(4+G*(4-3*F));o=r;r=n+(1-v)*G*Math.sin(j)*(y+v*N*(p+v*E*(-1+2*p*p)))}if(q==0){return NaN}var u=F*(M*M-K*K)/(K*K);var x=1+u/16384*(4096+u*(-768+u*(320-175*u)));var w=u/1024*(256+u*(-128+u*(74-47*u)));var D=w*N*(p+w/4*(E*(-1+2*p*p)-w/6*p*(-3+4*N*N)*(-3+4*p*p)));var t=K*x*(y-D);var H=t.toFixed(3)/1000;return H};OpenLayers.Util.destinationVincenty=function(l,P,E){var o=OpenLayers.Util;var i=o.VincentyConstants;var Q=i.a,O=i.b,J=i.f;var N=l.lon;var g=l.lat;var q=E;var D=o.rad(P);var G=Math.sin(D);var h=Math.cos(D);var F=(1-J)*Math.tan(o.rad(g));var c=1/Math.sqrt((1+F*F)),j=F*c;var p=Math.atan2(F,h);var y=c*G;var I=1-y*y;var t=I*(Q*Q-O*O)/(O*O);var x=1+t/16384*(4096+t*(-768+t*(320-175*t)));var v=t/1024*(256+t*(-128+t*(74-47*t)));var w=q/(O*x),K=2*Math.PI;while(Math.abs(w-K)>1e-12){var m=Math.cos(2*p+w);var R=Math.sin(w);var H=Math.cos(w);var z=v*R*(m+v/4*(H*(-1+2*m*m)-v/6*m*(-3+4*R*R)*(-3+4*m*m)));K=w;w=q/(O*x)+z}var M=j*R-c*H*h;var d=Math.atan2(j*H+c*R*h,(1-J)*Math.sqrt(y*y+M*M));var n=Math.atan2(R*G,c*H-j*R*h);var r=J/16*I*(4+J*(4-3*I));var k=n-(1-r)*J*y*(w+r*R*(m+r*H*(-1+2*m*m)));var e=Math.atan2(y,-M);return new OpenLayers.LonLat(N+o.deg(k),o.deg(d))};OpenLayers.Util.getParameters=function(b){b=b||window.location.href;var a="";if(OpenLayers.String.contains(b,"?")){var c=b.indexOf("?")+1;var e=OpenLayers.String.contains(b,"#")?b.indexOf("#"):b.length;a=b.substring(c,e)}var l={};var d=a.split(/[&;]/);for(var g=0,h=d.length;g<h;++g){var f=d[g].split("=");if(f[0]){var k=decodeURIComponent(f[0]);var j=f[1]||"";j=decodeURIComponent(j.replace(/\+/g," ")).split(",");if(j.length==1){j=j[0]}l[k]=j}}return l};OpenLayers.Util.getArgs=function(a){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.Util.getParameters"}));return OpenLayers.Util.getParameters(a)};OpenLayers.Util.lastSeqID=0;OpenLayers.Util.createUniqueID=function(a){if(a==null){a="id_"}OpenLayers.Util.lastSeqID+=1;return a+OpenLayers.Util.lastSeqID};OpenLayers.INCHES_PER_UNIT={inches:1,ft:12,mi:63360,m:39.3701,km:39370.1,dd:4374754,yd:36};OpenLayers.INCHES_PER_UNIT["in"]=OpenLayers.INCHES_PER_UNIT.inches;OpenLayers.INCHES_PER_UNIT.degrees=OpenLayers.INCHES_PER_UNIT.dd;OpenLayers.INCHES_PER_UNIT.nmi=1852*OpenLayers.INCHES_PER_UNIT.m;
OpenLayers.METERS_PER_INCH=0.0254000508001016;OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{Inch:OpenLayers.INCHES_PER_UNIT.inches,Meter:1/OpenLayers.METERS_PER_INCH,Foot:0.3048006096012192/OpenLayers.METERS_PER_INCH,IFoot:0.3048/OpenLayers.METERS_PER_INCH,ClarkeFoot:0.3047972651151/OpenLayers.METERS_PER_INCH,SearsFoot:0.30479947153867626/OpenLayers.METERS_PER_INCH,GoldCoastFoot:0.3047997101815088/OpenLayers.METERS_PER_INCH,IInch:0.0254/OpenLayers.METERS_PER_INCH,MicroInch:0.0000254/OpenLayers.METERS_PER_INCH,Mil:2.54e-8/OpenLayers.METERS_PER_INCH,Centimeter:0.01/OpenLayers.METERS_PER_INCH,Kilometer:1000/OpenLayers.METERS_PER_INCH,Yard:0.9144018288036576/OpenLayers.METERS_PER_INCH,SearsYard:0.914398414616029/OpenLayers.METERS_PER_INCH,IndianYard:0.9143985307444408/OpenLayers.METERS_PER_INCH,IndianYd37:0.91439523/OpenLayers.METERS_PER_INCH,IndianYd62:0.9143988/OpenLayers.METERS_PER_INCH,IndianYd75:0.9143985/OpenLayers.METERS_PER_INCH,IndianFoot:0.30479951/OpenLayers.METERS_PER_INCH,IndianFt37:0.30479841/OpenLayers.METERS_PER_INCH,IndianFt62:0.3047996/OpenLayers.METERS_PER_INCH,IndianFt75:0.3047995/OpenLayers.METERS_PER_INCH,Mile:1609.3472186944373/OpenLayers.METERS_PER_INCH,IYard:0.9144/OpenLayers.METERS_PER_INCH,IMile:1609.344/OpenLayers.METERS_PER_INCH,NautM:1852/OpenLayers.METERS_PER_INCH,"Lat-66":110943.31648893273/OpenLayers.METERS_PER_INCH,"Lat-83":110946.25736872235/OpenLayers.METERS_PER_INCH,Decimeter:0.1/OpenLayers.METERS_PER_INCH,Millimeter:0.001/OpenLayers.METERS_PER_INCH,Dekameter:10/OpenLayers.METERS_PER_INCH,Decameter:10/OpenLayers.METERS_PER_INCH,Hectometer:100/OpenLayers.METERS_PER_INCH,GermanMeter:1.0000135965/OpenLayers.METERS_PER_INCH,CaGrid:0.999738/OpenLayers.METERS_PER_INCH,ClarkeChain:20.1166194976/OpenLayers.METERS_PER_INCH,GunterChain:20.11684023368047/OpenLayers.METERS_PER_INCH,BenoitChain:20.116782494375872/OpenLayers.METERS_PER_INCH,SearsChain:20.11676512155/OpenLayers.METERS_PER_INCH,ClarkeLink:0.201166194976/OpenLayers.METERS_PER_INCH,GunterLink:0.2011684023368047/OpenLayers.METERS_PER_INCH,BenoitLink:0.20116782494375873/OpenLayers.METERS_PER_INCH,SearsLink:0.2011676512155/OpenLayers.METERS_PER_INCH,Rod:5.02921005842012/OpenLayers.METERS_PER_INCH,IntnlChain:20.1168/OpenLayers.METERS_PER_INCH,IntnlLink:0.201168/OpenLayers.METERS_PER_INCH,Perch:5.02921005842012/OpenLayers.METERS_PER_INCH,Pole:5.02921005842012/OpenLayers.METERS_PER_INCH,Furlong:201.1684023368046/OpenLayers.METERS_PER_INCH,Rood:3.778266898/OpenLayers.METERS_PER_INCH,CapeFoot:0.3047972615/OpenLayers.METERS_PER_INCH,Brealey:375/OpenLayers.METERS_PER_INCH,ModAmFt:0.304812252984506/OpenLayers.METERS_PER_INCH,Fathom:1.8288/OpenLayers.METERS_PER_INCH,"NautM-UK":1853.184/OpenLayers.METERS_PER_INCH,"50kilometers":50000/OpenLayers.METERS_PER_INCH,"150kilometers":150000/OpenLayers.METERS_PER_INCH});OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{mm:OpenLayers.INCHES_PER_UNIT.Meter/1000,cm:OpenLayers.INCHES_PER_UNIT.Meter/100,dm:OpenLayers.INCHES_PER_UNIT.Meter*100,km:OpenLayers.INCHES_PER_UNIT.Meter*1000,kmi:OpenLayers.INCHES_PER_UNIT.nmi,fath:OpenLayers.INCHES_PER_UNIT.Fathom,ch:OpenLayers.INCHES_PER_UNIT.IntnlChain,link:OpenLayers.INCHES_PER_UNIT.IntnlLink,"us-in":OpenLayers.INCHES_PER_UNIT.inches,"us-ft":OpenLayers.INCHES_PER_UNIT.Foot,"us-yd":OpenLayers.INCHES_PER_UNIT.Yard,"us-ch":OpenLayers.INCHES_PER_UNIT.GunterChain,"us-mi":OpenLayers.INCHES_PER_UNIT.Mile,"ind-yd":OpenLayers.INCHES_PER_UNIT.IndianYd37,"ind-ft":OpenLayers.INCHES_PER_UNIT.IndianFt37,"ind-ch":20.11669506/OpenLayers.METERS_PER_INCH});OpenLayers.DOTS_PER_INCH=72;OpenLayers.Util.normalizeScale=function(b){var a=(b>1)?(1/b):b;return a};OpenLayers.Util.getResolutionFromScale=function(d,a){var b;if(d){if(a==null){a="degrees"}var c=OpenLayers.Util.normalizeScale(d);b=1/(c*OpenLayers.INCHES_PER_UNIT[a]*OpenLayers.DOTS_PER_INCH)}return b};OpenLayers.Util.getScaleFromResolution=function(b,a){if(a==null){a="degrees"}var c=b*OpenLayers.INCHES_PER_UNIT[a]*OpenLayers.DOTS_PER_INCH;
return c};OpenLayers.Util.safeStopPropagation=function(a){OpenLayers.Event.stop(a,true)};OpenLayers.Util.pagePosition=function(f){var a=0,d=0;var b=f;var g=f;while(b){if(b==document.body){if(OpenLayers.Element.getStyle(g,"position")=="absolute"){break}}a+=b.offsetTop||0;d+=b.offsetLeft||0;g=b;try{b=b.offsetParent}catch(c){OpenLayers.Console.error(OpenLayers.i18n("pagePositionFailed",{elemId:b.id}));break}}b=f;while(b){a-=b.scrollTop||0;d-=b.scrollLeft||0;b=b.parentNode}return[d,a]};OpenLayers.Util.isEquivalentUrl=function(f,e,c){c=c||{};OpenLayers.Util.applyDefaults(c,{ignoreCase:true,ignorePort80:true,ignoreHash:true});var b=OpenLayers.Util.createUrlObject(f,c);var a=OpenLayers.Util.createUrlObject(e,c);for(var d in b){if(d!=="args"){if(b[d]!=a[d]){return false}}}for(var d in b.args){if(b.args[d]!=a.args[d]){return false}delete a.args[d]}for(var d in a.args){return false}return true};OpenLayers.Util.createUrlObject=function(c,k){k=k||{};if(!(/^\w+:\/\//).test(c)){var g=window.location;var e=g.port?":"+g.port:"";var h=g.protocol+"//"+g.host.split(":").shift()+e;if(c.indexOf("/")===0){c=h+c}else{var f=g.pathname.split("/");f.pop();c=h+f.join("/")+"/"+c}}if(k.ignoreCase){c=c.toLowerCase()}var i=document.createElement("a");i.href=c;var d={};d.host=i.host.split(":").shift();d.protocol=i.protocol;if(k.ignorePort80){d.port=(i.port=="80"||i.port=="0")?"":i.port}else{d.port=(i.port==""||i.port=="0")?"80":i.port}d.hash=(k.ignoreHash||i.hash==="#")?"":i.hash;var b=i.search;if(!b){var j=c.indexOf("?");b=(j!=-1)?c.substr(j):""}d.args=OpenLayers.Util.getParameters(b);d.pathname=(i.pathname.charAt(0)=="/")?i.pathname:"/"+i.pathname;return d};OpenLayers.Util.removeTail=function(b){var c=null;var a=b.indexOf("?");var d=b.indexOf("#");if(a==-1){c=(d!=-1)?b.substr(0,d):b}else{c=(d!=-1)?b.substr(0,Math.min(a,d)):b.substr(0,a)}return c};OpenLayers.Util.getBrowserName=function(){var b="";var a=navigator.userAgent.toLowerCase();if(a.indexOf("opera")!=-1){b="opera"}else{if(a.indexOf("msie")!=-1){b="msie"}else{if(a.indexOf("safari")!=-1){b="safari"}else{if(a.indexOf("mozilla")!=-1){if(a.indexOf("firefox")!=-1){b="firefox"}else{b="mozilla"}}}}}return b};OpenLayers.Util.getRenderedDimensions=function(b,o,p){var k,e;var a=document.createElement("div");a.style.visibility="hidden";var n=(p&&p.containerElement)?p.containerElement:document.body;if(o){if(o.w){k=o.w;a.style.width=k+"px"}else{if(o.h){e=o.h;a.style.height=e+"px"}}}if(p&&p.displayClass){a.className=p.displayClass}var f=document.createElement("div");f.innerHTML=b;f.style.overflow="visible";if(f.childNodes){for(var d=0,c=f.childNodes.length;d<c;d++){if(!f.childNodes[d].style){continue}f.childNodes[d].style.overflow="visible"}}a.appendChild(f);n.appendChild(a);var m=false;var j=a.parentNode;while(j&&j.tagName.toLowerCase()!="body"){var g=OpenLayers.Element.getStyle(j,"position");if(g=="absolute"){m=true;break}else{if(g&&g!="static"){break}}j=j.parentNode}if(!m){a.style.position="absolute"}if(!k){k=parseInt(f.scrollWidth);a.style.width=k+"px"}if(!e){e=parseInt(f.scrollHeight)}a.removeChild(f);n.removeChild(a);return new OpenLayers.Size(k,e)};OpenLayers.Util.getScrollbarWidth=function(){var c=OpenLayers.Util._scrollbarWidth;if(c==null){var e=null;var d=null;var a=0;var b=0;e=document.createElement("div");e.style.position="absolute";e.style.top="-1000px";e.style.left="-1000px";e.style.width="100px";e.style.height="50px";e.style.overflow="hidden";d=document.createElement("div");d.style.width="100%";d.style.height="200px";e.appendChild(d);document.body.appendChild(e);a=d.offsetWidth;e.style.overflow="scroll";b=d.offsetWidth;document.body.removeChild(document.body.lastChild);OpenLayers.Util._scrollbarWidth=(a-b);c=OpenLayers.Util._scrollbarWidth}return c};OpenLayers.Util.getFormattedLonLat=function(h,b,e){if(!e){e="dms"}var d=Math.abs(h);var i=Math.floor(d);var a=(d-i)/(1/60);var c=a;a=Math.floor(a);var g=(c-a)/(1/60);g=Math.round(g*10);g/=10;if(i<10){i="0"+i}var f=i+"\u00B0";if(e.indexOf("dm")>=0){if(a<10){a="0"+a
}f+=a+"'";if(e.indexOf("dms")>=0){if(g<10){g="0"+g}f+=g+'"'}}if(b=="lon"){f+=h<0?OpenLayers.i18n("W"):OpenLayers.i18n("E")}else{f+=h<0?OpenLayers.i18n("S"):OpenLayers.i18n("N")}return f};OpenLayers.Rico=new Object();OpenLayers.Rico.Corner={round:function(d,b){d=OpenLayers.Util.getElement(d);this._setOptions(b);var a=this.options.color;if(this.options.color=="fromElement"){a=this._background(d)}var c=this.options.bgColor;if(this.options.bgColor=="fromParent"){c=this._background(d.offsetParent)}this._roundCornersImpl(d,a,c)},changeColor:function(c,b){c.style.backgroundColor=b;var a=c.parentNode.getElementsByTagName("span");for(var d=0;d<a.length;d++){a[d].style.backgroundColor=b}},changeOpacity:function(c,f){var d=f;var a="alpha(opacity="+f*100+")";c.style.opacity=d;c.style.filter=a;var b=c.parentNode.getElementsByTagName("span");for(var e=0;e<b.length;e++){b[e].style.opacity=d;b[e].style.filter=a}},reRound:function(d,c){var b=d.parentNode.childNodes[0];var a=d.parentNode.childNodes[2];d.parentNode.removeChild(b);d.parentNode.removeChild(a);this.round(d.parentNode,c)},_roundCornersImpl:function(c,a,b){if(this.options.border){this._renderBorder(c,b)}if(this._isTopRounded()){this._roundTopCorners(c,a,b)}if(this._isBottomRounded()){this._roundBottomCorners(c,a,b)}},_renderBorder:function(d,e){var b="1px solid "+this._borderColor(e);var a="border-left: "+b;var f="border-right: "+b;var c="style='"+a+";"+f+"'";d.innerHTML="<div "+c+">"+d.innerHTML+"</div>"},_roundTopCorners:function(c,a,e){var d=this._createCorner(e);for(var b=0;b<this.options.numSlices;b++){d.appendChild(this._createCornerSlice(a,e,b,"top"))}c.style.paddingTop=0;c.insertBefore(d,c.firstChild)},_roundBottomCorners:function(c,a,e){var d=this._createCorner(e);for(var b=(this.options.numSlices-1);b>=0;b--){d.appendChild(this._createCornerSlice(a,e,b,"bottom"))}c.style.paddingBottom=0;c.appendChild(d)},_createCorner:function(b){var a=document.createElement("div");a.style.backgroundColor=(this._isTransparent()?"transparent":b);return a},_createCornerSlice:function(c,d,g,a){var e=document.createElement("span");var b=e.style;b.backgroundColor=c;b.display="block";b.height="1px";b.overflow="hidden";b.fontSize="1px";var f=this._borderColor(c,d);if(this.options.border&&g==0){b.borderTopStyle="solid";b.borderTopWidth="1px";b.borderLeftWidth="0px";b.borderRightWidth="0px";b.borderBottomWidth="0px";b.height="0px";b.borderColor=f}else{if(f){b.borderColor=f;b.borderStyle="solid";b.borderWidth="0px 1px"}}if(!this.options.compact&&(g==(this.options.numSlices-1))){b.height="2px"}this._setMargin(e,g,a);this._setBorder(e,g,a);return e},_setOptions:function(a){this.options={corners:"all",color:"fromElement",bgColor:"fromParent",blend:true,border:false,compact:false};OpenLayers.Util.extend(this.options,a||{});this.options.numSlices=this.options.compact?2:4;if(this._isTransparent()){this.options.blend=false}},_whichSideTop:function(){if(this._hasString(this.options.corners,"all","top")){return""}if(this.options.corners.indexOf("tl")>=0&&this.options.corners.indexOf("tr")>=0){return""}if(this.options.corners.indexOf("tl")>=0){return"left"}else{if(this.options.corners.indexOf("tr")>=0){return"right"}}return""},_whichSideBottom:function(){if(this._hasString(this.options.corners,"all","bottom")){return""}if(this.options.corners.indexOf("bl")>=0&&this.options.corners.indexOf("br")>=0){return""}if(this.options.corners.indexOf("bl")>=0){return"left"}else{if(this.options.corners.indexOf("br")>=0){return"right"}}return""},_borderColor:function(a,b){if(a=="transparent"){return b}else{if(this.options.border){return this.options.border}else{if(this.options.blend){return this._blend(b,a)}else{return""}}}},_setMargin:function(d,e,b){var c=this._marginSize(e);var a=b=="top"?this._whichSideTop():this._whichSideBottom();if(a=="left"){d.style.marginLeft=c+"px";d.style.marginRight="0px"}else{if(a=="right"){d.style.marginRight=c+"px";d.style.marginLeft="0px"}else{d.style.marginLeft=c+"px";d.style.marginRight=c+"px"
}}},_setBorder:function(d,e,b){var c=this._borderSize(e);var a=b=="top"?this._whichSideTop():this._whichSideBottom();if(a=="left"){d.style.borderLeftWidth=c+"px";d.style.borderRightWidth="0px"}else{if(a=="right"){d.style.borderRightWidth=c+"px";d.style.borderLeftWidth="0px"}else{d.style.borderLeftWidth=c+"px";d.style.borderRightWidth=c+"px"}}if(this.options.border!=false){d.style.borderLeftWidth=c+"px";d.style.borderRightWidth=c+"px"}},_marginSize:function(e){if(this._isTransparent()){return 0}var d=[5,3,2,1];var a=[3,2,1,0];var c=[2,1];var b=[1,0];if(this.options.compact&&this.options.blend){return b[e]}else{if(this.options.compact){return c[e]}else{if(this.options.blend){return a[e]}else{return d[e]}}}},_borderSize:function(e){var d=[5,3,2,1];var b=[2,1,1,1];var a=[1,0];var c=[0,2,0,0];if(this.options.compact&&(this.options.blend||this._isTransparent())){return 1}else{if(this.options.compact){return a[e]}else{if(this.options.blend){return b[e]}else{if(this.options.border){return c[e]}else{if(this._isTransparent()){return d[e]}}}}}return 0},_hasString:function(b){for(var a=1;a<arguments.length;a++){if(b.indexOf(arguments[a])>=0){return true}}return false},_blend:function(c,a){var b=OpenLayers.Rico.Color.createFromHex(c);b.blend(OpenLayers.Rico.Color.createFromHex(a));return b},_background:function(a){try{return OpenLayers.Rico.Color.createColorFromBackground(a).asHex()}catch(b){return"#ffffff"}},_isTransparent:function(){return this.options.color=="transparent"},_isTopRounded:function(){return this._hasString(this.options.corners,"all","top","tl","tr")},_isBottomRounded:function(){return this._hasString(this.options.corners,"all","bottom","bl","br")},_hasSingleTextChild:function(a){return a.childNodes.length==1&&a.childNodes[0].nodeType==3}};(function(){if(window.google&&google.gears){return}var a=null;if(typeof GearsFactory!="undefined"){a=new GearsFactory()}else{try{a=new ActiveXObject("Gears.Factory");if(a.getBuildInfo().indexOf("ie_mobile")!=-1){a.privateSetGlobalObject(this)}}catch(b){if((typeof navigator.mimeTypes!="undefined")&&navigator.mimeTypes["application/x-googlegears"]){a=document.createElement("object");a.style.display="none";a.width=0;a.height=0;a.type="application/x-googlegears";document.documentElement.appendChild(a)}}}if(!a){return}if(!window.google){google={}}if(!google.gears){google.gears={factory:a}}})();OpenLayers.Element={visible:function(a){return OpenLayers.Util.getElement(a).style.display!="none"},toggle:function(){for(var c=0,a=arguments.length;c<a;c++){var b=OpenLayers.Util.getElement(arguments[c]);var d=OpenLayers.Element.visible(b)?"hide":"show";OpenLayers.Element[d](b)}},hide:function(){for(var c=0,a=arguments.length;c<a;c++){var b=OpenLayers.Util.getElement(arguments[c]);if(b){b.style.display="none"}}},show:function(){for(var c=0,a=arguments.length;c<a;c++){var b=OpenLayers.Util.getElement(arguments[c]);if(b){b.style.display=""}}},remove:function(a){a=OpenLayers.Util.getElement(a);a.parentNode.removeChild(a)},getHeight:function(a){a=OpenLayers.Util.getElement(a);return a.offsetHeight},getDimensions:function(c){c=OpenLayers.Util.getElement(c);if(OpenLayers.Element.getStyle(c,"display")!="none"){return{width:c.offsetWidth,height:c.offsetHeight}}var b=c.style;var f=b.visibility;var d=b.position;var a=b.display;b.visibility="hidden";b.position="absolute";b.display="";var g=c.clientWidth;var e=c.clientHeight;b.display=a;b.position=d;b.visibility=f;return{width:g,height:e}},hasClass:function(b,a){var c=b.className;return(!!c&&new RegExp("(^|\\s)"+a+"(\\s|$)").test(c))},addClass:function(b,a){if(!OpenLayers.Element.hasClass(b,a)){b.className+=(b.className?" ":"")+a}return b},removeClass:function(b,a){var c=b.className;if(c){b.className=OpenLayers.String.trim(c.replace(new RegExp("(^|\\s+)"+a+"(\\s+|$)")," "))}return b},toggleClass:function(b,a){if(OpenLayers.Element.hasClass(b,a)){OpenLayers.Element.removeClass(b,a)}else{OpenLayers.Element.addClass(b,a)}return b},getStyle:function(c,d){c=OpenLayers.Util.getElement(c);
var e=null;if(c&&c.style){e=c.style[OpenLayers.String.camelize(d)];if(!e){if(document.defaultView&&document.defaultView.getComputedStyle){var b=document.defaultView.getComputedStyle(c,null);e=b?b.getPropertyValue(d):null}else{if(c.currentStyle){e=c.currentStyle[OpenLayers.String.camelize(d)]}}}var a=["left","top","right","bottom"];if(window.opera&&(OpenLayers.Util.indexOf(a,d)!=-1)&&(OpenLayers.Element.getStyle(c,"position")=="static")){e="auto"}}return e=="auto"?null:e}};OpenLayers.Size=OpenLayers.Class({w:0,h:0,initialize:function(a,b){this.w=parseFloat(a);this.h=parseFloat(b)},toString:function(){return("w="+this.w+",h="+this.h)},clone:function(){return new OpenLayers.Size(this.w,this.h)},equals:function(b){var a=false;if(b!=null){a=((this.w==b.w&&this.h==b.h)||(isNaN(this.w)&&isNaN(this.h)&&isNaN(b.w)&&isNaN(b.h)))}return a},CLASS_NAME:"OpenLayers.Size"});OpenLayers.Console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){},userError:function(a){alert(a)},assert:function(){},dir:function(){},dirxml:function(){},trace:function(){},group:function(){},groupEnd:function(){},time:function(){},timeEnd:function(){},profile:function(){},profileEnd:function(){},count:function(){},CLASS_NAME:"OpenLayers.Console"};(function(){var b=document.getElementsByTagName("script");for(var c=0,a=b.length;c<a;++c){if(b[c].src.indexOf("firebug.js")!=-1){if(console){OpenLayers.Util.extend(OpenLayers.Console,console);break}}}})();OpenLayers.Icon=OpenLayers.Class({url:null,size:null,offset:null,calculateOffset:null,imageDiv:null,px:null,initialize:function(a,b,d,c){this.url=a;this.size=(b)?b:new OpenLayers.Size(20,20);this.offset=d?d:new OpenLayers.Pixel(-(this.size.w/2),-(this.size.h/2));this.calculateOffset=c;var e=OpenLayers.Util.createUniqueID("OL_Icon_");this.imageDiv=OpenLayers.Util.createAlphaImageDiv(e)},destroy:function(){this.erase();OpenLayers.Event.stopObservingElement(this.imageDiv.firstChild);this.imageDiv.innerHTML="";this.imageDiv=null},clone:function(){return new OpenLayers.Icon(this.url,this.size,this.offset,this.calculateOffset)},setSize:function(a){if(a!=null){this.size=a}this.draw()},setUrl:function(a){if(a!=null){this.url=a}this.draw()},draw:function(a){OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,this.size,this.url,"absolute");this.moveTo(a);return this.imageDiv},erase:function(){if(this.imageDiv!=null&&this.imageDiv.parentNode!=null){OpenLayers.Element.remove(this.imageDiv)}},setOpacity:function(a){OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,null,null,null,null,null,a)},moveTo:function(a){if(a!=null){this.px=a}if(this.imageDiv!=null){if(this.px==null){this.display(false)}else{if(this.calculateOffset){this.offset=this.calculateOffset(this.size)}var b=this.px.offset(this.offset);OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,b)}}},display:function(a){this.imageDiv.style.display=(a)?"":"none"},isDrawn:function(){var a=(this.imageDiv&&this.imageDiv.parentNode&&(this.imageDiv.parentNode.nodeType!=11));return a},CLASS_NAME:"OpenLayers.Icon"});OpenLayers.Popup=OpenLayers.Class({events:null,id:"",lonlat:null,div:null,contentSize:null,size:null,contentHTML:null,backgroundColor:"",opacity:"",border:"",contentDiv:null,groupDiv:null,closeDiv:null,autoSize:false,minSize:null,maxSize:null,displayClass:"olPopup",contentDisplayClass:"olPopupContent",padding:0,disableFirefoxOverflowHack:false,fixPadding:function(){if(typeof this.padding=="number"){this.padding=new OpenLayers.Bounds(this.padding,this.padding,this.padding,this.padding)}},panMapIfOutOfView:false,keepInMap:false,closeOnMove:false,map:null,initialize:function(g,c,f,b,e,d){if(g==null){g=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")}this.id=g;this.lonlat=c;this.contentSize=(f!=null)?f:new OpenLayers.Size(OpenLayers.Popup.WIDTH,OpenLayers.Popup.HEIGHT);if(b!=null){this.contentHTML=b}this.backgroundColor=OpenLayers.Popup.COLOR;this.opacity=OpenLayers.Popup.OPACITY;this.border=OpenLayers.Popup.BORDER;this.div=OpenLayers.Util.createDiv(this.id,null,null,null,null,null,"hidden");
this.div.className=this.displayClass;var a=this.id+"_GroupDiv";this.groupDiv=OpenLayers.Util.createDiv(a,null,null,null,"relative",null,"hidden");var g=this.div.id+"_contentDiv";this.contentDiv=OpenLayers.Util.createDiv(g,null,this.contentSize.clone(),null,"relative");this.contentDiv.className=this.contentDisplayClass;this.groupDiv.appendChild(this.contentDiv);this.div.appendChild(this.groupDiv);if(e){this.addCloseBox(d)}this.registerEvents()},destroy:function(){this.id=null;this.lonlat=null;this.size=null;this.contentHTML=null;this.backgroundColor=null;this.opacity=null;this.border=null;if(this.closeOnMove&&this.map){this.map.events.unregister("movestart",this,this.hide)}this.events.destroy();this.events=null;if(this.closeDiv){OpenLayers.Event.stopObservingElement(this.closeDiv);this.groupDiv.removeChild(this.closeDiv)}this.closeDiv=null;this.div.removeChild(this.groupDiv);this.groupDiv=null;if(this.map!=null){this.map.removePopup(this)}this.map=null;this.div=null;this.autoSize=null;this.minSize=null;this.maxSize=null;this.padding=null;this.panMapIfOutOfView=null},draw:function(a){if(a==null){if((this.lonlat!=null)&&(this.map!=null)){a=this.map.getLayerPxFromLonLat(this.lonlat)}}if(this.closeOnMove){this.map.events.register("movestart",this,this.hide)}if(!this.disableFirefoxOverflowHack&&OpenLayers.Util.getBrowserName()=="firefox"){this.map.events.register("movestart",this,function(){var b=document.defaultView.getComputedStyle(this.contentDiv,null);var c=b.getPropertyValue("overflow");if(c!="hidden"){this.contentDiv._oldOverflow=c;this.contentDiv.style.overflow="hidden"}});this.map.events.register("moveend",this,function(){var b=this.contentDiv._oldOverflow;if(b){this.contentDiv.style.overflow=b;this.contentDiv._oldOverflow=null}})}this.moveTo(a);if(!this.autoSize&&!this.size){this.setSize(this.contentSize)}this.setBackgroundColor();this.setOpacity();this.setBorder();this.setContentHTML();if(this.panMapIfOutOfView){this.panIntoView()}return this.div},updatePosition:function(){if((this.lonlat)&&(this.map)){var a=this.map.getLayerPxFromLonLat(this.lonlat);if(a){this.moveTo(a)}}},moveTo:function(a){if((a!=null)&&(this.div!=null)){this.div.style.left=a.x+"px";this.div.style.top=a.y+"px"}},visible:function(){return OpenLayers.Element.visible(this.div)},toggle:function(){if(this.visible()){this.hide()}else{this.show()}},show:function(){OpenLayers.Element.show(this.div);if(this.panMapIfOutOfView){this.panIntoView()}},hide:function(){OpenLayers.Element.hide(this.div)},setSize:function(c){this.size=c.clone();var b=this.getContentDivPadding();var a=b.left+b.right;var e=b.top+b.bottom;this.fixPadding();a+=this.padding.left+this.padding.right;e+=this.padding.top+this.padding.bottom;if(this.closeDiv){var d=parseInt(this.closeDiv.style.width);a+=d+b.right}this.size.w+=a;this.size.h+=e;if(OpenLayers.Util.getBrowserName()=="msie"){this.contentSize.w+=b.left+b.right;this.contentSize.h+=b.bottom+b.top}if(this.div!=null){this.div.style.width=this.size.w+"px";this.div.style.height=this.size.h+"px"}if(this.contentDiv!=null){this.contentDiv.style.width=c.w+"px";this.contentDiv.style.height=c.h+"px"}},updateSize:function(){var e="<div class='"+this.contentDisplayClass+"'>"+this.contentDiv.innerHTML+"</div>";var h=(this.map)?this.map.layerContainerDiv:document.body;var i=OpenLayers.Util.getRenderedDimensions(e,null,{displayClass:this.displayClass,containerElement:h});var g=this.getSafeContentSize(i);var f=null;if(g.equals(i)){f=i}else{var b=new OpenLayers.Size();b.w=(g.w<i.w)?g.w:null;b.h=(g.h<i.h)?g.h:null;if(b.w&&b.h){f=g}else{var d=OpenLayers.Util.getRenderedDimensions(e,b,{displayClass:this.contentDisplayClass,containerElement:h});var c=OpenLayers.Element.getStyle(this.contentDiv,"overflow");if((c!="hidden")&&(d.equals(g))){var a=OpenLayers.Util.getScrollbarWidth();if(b.w){d.h+=a}else{d.w+=a}}f=this.getSafeContentSize(d)}}this.setSize(f)},setBackgroundColor:function(a){if(a!=undefined){this.backgroundColor=a}if(this.div!=null){this.div.style.backgroundColor=this.backgroundColor
}},setOpacity:function(a){if(a!=undefined){this.opacity=a}if(this.div!=null){this.div.style.opacity=this.opacity;this.div.style.filter="alpha(opacity="+this.opacity*100+")"}},setBorder:function(a){if(a!=undefined){this.border=a}if(this.div!=null){this.div.style.border=this.border}},setContentHTML:function(a){if(a!=null){this.contentHTML=a}if((this.contentDiv!=null)&&(this.contentHTML!=null)&&(this.contentHTML!=this.contentDiv.innerHTML)){this.contentDiv.innerHTML=this.contentHTML;if(this.autoSize){this.registerImageListeners();this.updateSize()}}},registerImageListeners:function(){var f=function(){this.popup.updateSize();if(this.popup.visible()&&this.popup.panMapIfOutOfView){this.popup.panIntoView()}OpenLayers.Event.stopObserving(this.img,"load",this.img._onImageLoad)};var b=this.contentDiv.getElementsByTagName("img");for(var e=0,a=b.length;e<a;e++){var c=b[e];if(c.width==0||c.height==0){var d={popup:this,img:c};c._onImgLoad=OpenLayers.Function.bind(f,d);OpenLayers.Event.observe(c,"load",c._onImgLoad)}}},getSafeContentSize:function(k){var d=k.clone();var i=this.getContentDivPadding();var j=i.left+i.right;var g=i.top+i.bottom;this.fixPadding();j+=this.padding.left+this.padding.right;g+=this.padding.top+this.padding.bottom;if(this.closeDiv){var c=parseInt(this.closeDiv.style.width);j+=c+i.right}if(this.minSize){d.w=Math.max(d.w,(this.minSize.w-j));d.h=Math.max(d.h,(this.minSize.h-g))}if(this.maxSize){d.w=Math.min(d.w,(this.maxSize.w-j));d.h=Math.min(d.h,(this.maxSize.h-g))}if(this.map&&this.map.size){var f=0,e=0;if(this.keepInMap&&!this.panMapIfOutOfView){var h=this.map.getPixelFromLonLat(this.lonlat);switch(this.relativePosition){case"tr":f=h.x;e=this.map.size.h-h.y;break;case"tl":f=this.map.size.w-h.x;e=this.map.size.h-h.y;break;case"bl":f=this.map.size.w-h.x;e=h.y;break;case"br":f=h.x;e=h.y;break;default:f=h.x;e=this.map.size.h-h.y;break}}var a=this.map.size.h-this.map.paddingForPopups.top-this.map.paddingForPopups.bottom-g-e;var b=this.map.size.w-this.map.paddingForPopups.left-this.map.paddingForPopups.right-j-f;d.w=Math.min(d.w,b);d.h=Math.min(d.h,a)}return d},getContentDivPadding:function(){var a=this._contentDivPadding;if(!a){if(this.div.parentNode==null){this.div.style.display="none";document.body.appendChild(this.div)}a=new OpenLayers.Bounds(OpenLayers.Element.getStyle(this.contentDiv,"padding-left"),OpenLayers.Element.getStyle(this.contentDiv,"padding-bottom"),OpenLayers.Element.getStyle(this.contentDiv,"padding-right"),OpenLayers.Element.getStyle(this.contentDiv,"padding-top"));this._contentDivPadding=a;if(this.div.parentNode==document.body){document.body.removeChild(this.div);this.div.style.display=""}}return a},addCloseBox:function(c){this.closeDiv=OpenLayers.Util.createDiv(this.id+"_close",null,new OpenLayers.Size(17,17));this.closeDiv.className="olPopupCloseBox";var b=this.getContentDivPadding();this.closeDiv.style.right=b.right+"px";this.closeDiv.style.top=b.top+"px";this.groupDiv.appendChild(this.closeDiv);var a=c||function(d){this.hide();OpenLayers.Event.stop(d)};OpenLayers.Event.observe(this.closeDiv,"click",OpenLayers.Function.bindAsEventListener(a,this))},panIntoView:function(){var e=this.map.getSize();var d=this.map.getViewPortPxFromLayerPx(new OpenLayers.Pixel(parseInt(this.div.style.left),parseInt(this.div.style.top)));var c=d.clone();if(d.x<this.map.paddingForPopups.left){c.x=this.map.paddingForPopups.left}else{if((d.x+this.size.w)>(e.w-this.map.paddingForPopups.right)){c.x=e.w-this.map.paddingForPopups.right-this.size.w}}if(d.y<this.map.paddingForPopups.top){c.y=this.map.paddingForPopups.top}else{if((d.y+this.size.h)>(e.h-this.map.paddingForPopups.bottom)){c.y=e.h-this.map.paddingForPopups.bottom-this.size.h}}var b=d.x-c.x;var a=d.y-c.y;this.map.pan(b,a)},registerEvents:function(){this.events=new OpenLayers.Events(this,this.div,null,true);this.events.on({mousedown:this.onmousedown,mousemove:this.onmousemove,mouseup:this.onmouseup,click:this.onclick,mouseout:this.onmouseout,dblclick:this.ondblclick,scope:this})
},onmousedown:function(a){this.mousedown=true;OpenLayers.Event.stop(a,true)},onmousemove:function(a){if(this.mousedown){OpenLayers.Event.stop(a,true)}},onmouseup:function(a){if(this.mousedown){this.mousedown=false;OpenLayers.Event.stop(a,true)}},onclick:function(a){OpenLayers.Event.stop(a,true)},onmouseout:function(a){this.mousedown=false},ondblclick:function(a){OpenLayers.Event.stop(a,true)},CLASS_NAME:"OpenLayers.Popup"});OpenLayers.Popup.WIDTH=200;OpenLayers.Popup.HEIGHT=200;OpenLayers.Popup.COLOR="white";OpenLayers.Popup.OPACITY=1;OpenLayers.Popup.BORDER="0px";OpenLayers.Protocol=OpenLayers.Class({format:null,options:null,autoDestroy:true,defaultFilter:null,initialize:function(a){a=a||{};OpenLayers.Util.extend(this,a);this.options=a},mergeWithDefaultFilter:function(b){var a;if(b&&this.defaultFilter){a=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,filters:[this.defaultFilter,b]})}else{a=b||this.defaultFilter||undefined}return a},destroy:function(){this.options=null;this.format=null},read:function(a){a=a||{};a.filter=this.mergeWithDefaultFilter(a.filter)},create:function(){},update:function(){},"delete":function(){},commit:function(){},abort:function(a){},createCallback:function(c,a,b){return OpenLayers.Function.bind(function(){c.apply(this,[a,b])},this)},CLASS_NAME:"OpenLayers.Protocol"});OpenLayers.Protocol.Response=OpenLayers.Class({code:null,requestType:null,last:true,features:null,reqFeatures:null,priv:null,initialize:function(a){OpenLayers.Util.extend(this,a)},success:function(){return this.code>0},CLASS_NAME:"OpenLayers.Protocol.Response"});OpenLayers.Protocol.Response.SUCCESS=1;OpenLayers.Protocol.Response.FAILURE=0;OpenLayers.Renderer=OpenLayers.Class({container:null,root:null,extent:null,locked:false,size:null,resolution:null,map:null,initialize:function(a,b){this.container=OpenLayers.Util.getElement(a)},destroy:function(){this.container=null;this.extent=null;this.size=null;this.resolution=null;this.map=null},supported:function(){return false},setExtent:function(a,b){this.extent=a.clone();if(b){this.resolution=null}},setSize:function(a){this.size=a.clone();this.resolution=null},getResolution:function(){this.resolution=this.resolution||this.map.getResolution();return this.resolution},drawFeature:function(c,d){if(d==null){d=c.style}if(c.geometry){var e=c.geometry.getBounds();if(e){if(!e.intersectsBounds(this.extent)){d={display:"none"}}var f=this.drawGeometry(c.geometry,d,c.id);if(d.display!="none"&&d.label&&f!==false){var a=c.geometry.getCentroid();if(d.labelXOffset||d.labelYOffset){xOffset=isNaN(d.labelXOffset)?0:d.labelXOffset;yOffset=isNaN(d.labelYOffset)?0:d.labelYOffset;var b=this.getResolution();a.move(xOffset*b,yOffset*b)}this.drawText(c.id,d,a)}else{this.removeText(c.id)}return f}}},drawGeometry:function(c,a,b){},drawText:function(c,b,a){},removeText:function(a){},clear:function(){},getFeatureIdFromEvent:function(a){},eraseFeatures:function(d){if(!(d instanceof Array)){d=[d]}for(var c=0,a=d.length;c<a;++c){var b=d[c];this.eraseGeometry(b.geometry,b.id);this.removeText(b.id)}},eraseGeometry:function(b,a){},moveRoot:function(a){},getRenderLayerId:function(){return this.container.id},applyDefaultSymbolizer:function(b){var a=OpenLayers.Util.extend({},OpenLayers.Renderer.defaultSymbolizer);if(b.stroke===false){delete a.strokeWidth;delete a.strokeColor}if(b.fill===false){delete a.fillColor}OpenLayers.Util.extend(a,b);return a},CLASS_NAME:"OpenLayers.Renderer"});OpenLayers.Renderer.defaultSymbolizer={fillColor:"#000000",strokeColor:"#000000",strokeWidth:2,fillOpacity:1,strokeOpacity:1,pointRadius:0};OpenLayers.Strategy=OpenLayers.Class({layer:null,options:null,active:null,autoActivate:true,autoDestroy:true,initialize:function(a){OpenLayers.Util.extend(this,a);this.options=a;this.active=false},destroy:function(){this.deactivate();this.layer=null;this.options=null},setLayer:function(a){this.layer=a},activate:function(){if(!this.active){this.active=true;return true}return false},deactivate:function(){if(this.active){this.active=false;
return true}return false},CLASS_NAME:"OpenLayers.Strategy"});OpenLayers.Symbolizer=OpenLayers.Class({zIndex:0,initialize:function(a){OpenLayers.Util.extend(this,a)},clone:function(){var Type=eval(this.CLASS_NAME);return new Type(OpenLayers.Util.extend({},this))},CLASS_NAME:"OpenLayers.Symbolizer"});OpenLayers.Rico.Color=OpenLayers.Class({initialize:function(c,b,a){this.rgb={r:c,g:b,b:a}},setRed:function(a){this.rgb.r=a},setGreen:function(a){this.rgb.g=a},setBlue:function(a){this.rgb.b=a},setHue:function(b){var a=this.asHSB();a.h=b;this.rgb=OpenLayers.Rico.Color.HSBtoRGB(a.h,a.s,a.b)},setSaturation:function(b){var a=this.asHSB();a.s=b;this.rgb=OpenLayers.Rico.Color.HSBtoRGB(a.h,a.s,a.b)},setBrightness:function(a){var c=this.asHSB();c.b=a;this.rgb=OpenLayers.Rico.Color.HSBtoRGB(c.h,c.s,c.b)},darken:function(b){var a=this.asHSB();this.rgb=OpenLayers.Rico.Color.HSBtoRGB(a.h,a.s,Math.max(a.b-b,0))},brighten:function(b){var a=this.asHSB();this.rgb=OpenLayers.Rico.Color.HSBtoRGB(a.h,a.s,Math.min(a.b+b,1))},blend:function(a){this.rgb.r=Math.floor((this.rgb.r+a.rgb.r)/2);this.rgb.g=Math.floor((this.rgb.g+a.rgb.g)/2);this.rgb.b=Math.floor((this.rgb.b+a.rgb.b)/2)},isBright:function(){var a=this.asHSB();return this.asHSB().b>0.5},isDark:function(){return !this.isBright()},asRGB:function(){return"rgb("+this.rgb.r+","+this.rgb.g+","+this.rgb.b+")"},asHex:function(){return"#"+this.rgb.r.toColorPart()+this.rgb.g.toColorPart()+this.rgb.b.toColorPart()},asHSB:function(){return OpenLayers.Rico.Color.RGBtoHSB(this.rgb.r,this.rgb.g,this.rgb.b)},toString:function(){return this.asHex()}});OpenLayers.Rico.Color.createFromHex=function(d){if(d.length==4){var b=d;var d="#";for(var c=1;c<4;c++){d+=(b.charAt(c)+b.charAt(c))}}if(d.indexOf("#")==0){d=d.substring(1)}var f=d.substring(0,2);var e=d.substring(2,4);var a=d.substring(4,6);return new OpenLayers.Rico.Color(parseInt(f,16),parseInt(e,16),parseInt(a,16))};OpenLayers.Rico.Color.createColorFromBackground=function(d){var b=RicoUtil.getElementsComputedStyle(OpenLayers.Util.getElement(d),"backgroundColor","background-color");if(b=="transparent"&&d.parentNode){return OpenLayers.Rico.Color.createColorFromBackground(d.parentNode)}if(b==null){return new OpenLayers.Rico.Color(255,255,255)}if(b.indexOf("rgb(")==0){var a=b.substring(4,b.length-1);var c=a.split(",");return new OpenLayers.Rico.Color(parseInt(c[0]),parseInt(c[1]),parseInt(c[2]))}else{if(b.indexOf("#")==0){return OpenLayers.Rico.Color.createFromHex(b)}else{return new OpenLayers.Rico.Color(255,255,255)}}};OpenLayers.Rico.Color.HSBtoRGB=function(i,e,k){var c=0;var d=0;var l=0;if(e==0){c=parseInt(k*255+0.5);d=c;l=c}else{var g=(i-Math.floor(i))*6;var j=g-Math.floor(g);var b=k*(1-e);var a=k*(1-e*j);var m=k*(1-(e*(1-j)));switch(parseInt(g)){case 0:c=(k*255+0.5);d=(m*255+0.5);l=(b*255+0.5);break;case 1:c=(a*255+0.5);d=(k*255+0.5);l=(b*255+0.5);break;case 2:c=(b*255+0.5);d=(k*255+0.5);l=(m*255+0.5);break;case 3:c=(b*255+0.5);d=(a*255+0.5);l=(k*255+0.5);break;case 4:c=(m*255+0.5);d=(b*255+0.5);l=(k*255+0.5);break;case 5:c=(k*255+0.5);d=(b*255+0.5);l=(a*255+0.5);break}}return{r:parseInt(c),g:parseInt(d),b:parseInt(l)}};OpenLayers.Rico.Color.RGBtoHSB=function(a,f,l){var h;var e;var k;var m=(a>f)?a:f;if(l>m){m=l}var i=(a<f)?a:f;if(l<i){i=l}k=m/255;if(m!=0){e=(m-i)/m}else{e=0}if(e==0){h=0}else{var c=(m-a)/(m-i);var j=(m-f)/(m-i);var d=(m-l)/(m-i);if(a==m){h=d-j}else{if(f==m){h=2+c-d}else{h=4+j-c}}h=h/6;if(h<0){h=h+1}}return{h:h,s:e,b:k}};OpenLayers.Bounds=OpenLayers.Class({left:null,bottom:null,right:null,top:null,centerLonLat:null,initialize:function(d,a,b,c){if(d!=null){this.left=OpenLayers.Util.toFloat(d)}if(a!=null){this.bottom=OpenLayers.Util.toFloat(a)}if(b!=null){this.right=OpenLayers.Util.toFloat(b)}if(c!=null){this.top=OpenLayers.Util.toFloat(c)}},clone:function(){return new OpenLayers.Bounds(this.left,this.bottom,this.right,this.top)},equals:function(b){var a=false;if(b!=null){a=((this.left==b.left)&&(this.right==b.right)&&(this.top==b.top)&&(this.bottom==b.bottom))
}return a},toString:function(){return("left-bottom=("+this.left+","+this.bottom+") right-top=("+this.right+","+this.top+")")},toArray:function(a){if(a===true){return[this.bottom,this.left,this.top,this.right]}else{return[this.left,this.bottom,this.right,this.top]}},toBBOX:function(b,e){if(b==null){b=6}var g=Math.pow(10,b);var f=Math.round(this.left*g)/g;var d=Math.round(this.bottom*g)/g;var c=Math.round(this.right*g)/g;var a=Math.round(this.top*g)/g;if(e===true){return d+","+f+","+a+","+c}else{return f+","+d+","+c+","+a}},toGeometry:function(){return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(this.left,this.bottom),new OpenLayers.Geometry.Point(this.right,this.bottom),new OpenLayers.Geometry.Point(this.right,this.top),new OpenLayers.Geometry.Point(this.left,this.top)])])},getWidth:function(){return(this.right-this.left)},getHeight:function(){return(this.top-this.bottom)},getSize:function(){return new OpenLayers.Size(this.getWidth(),this.getHeight())},getCenterPixel:function(){return new OpenLayers.Pixel((this.left+this.right)/2,(this.bottom+this.top)/2)},getCenterLonLat:function(){if(!this.centerLonLat){this.centerLonLat=new OpenLayers.LonLat((this.left+this.right)/2,(this.bottom+this.top)/2)}return this.centerLonLat},scale:function(e,c){if(c==null){c=this.getCenterLonLat()}var a,h;if(c.CLASS_NAME=="OpenLayers.LonLat"){a=c.lon;h=c.lat}else{a=c.x;h=c.y}var g=(this.left-a)*e+a;var b=(this.bottom-h)*e+h;var d=(this.right-a)*e+a;var f=(this.top-h)*e+h;return new OpenLayers.Bounds(g,b,d,f)},add:function(a,c){if((a==null)||(c==null)){var b=OpenLayers.i18n("boundsAddError");OpenLayers.Console.error(b);return null}return new OpenLayers.Bounds(this.left+a,this.bottom+c,this.right+a,this.top+c)},extend:function(a){var b=null;if(a){switch(a.CLASS_NAME){case"OpenLayers.LonLat":b=new OpenLayers.Bounds(a.lon,a.lat,a.lon,a.lat);break;case"OpenLayers.Geometry.Point":b=new OpenLayers.Bounds(a.x,a.y,a.x,a.y);break;case"OpenLayers.Bounds":b=a;break}if(b){this.centerLonLat=null;if((this.left==null)||(b.left<this.left)){this.left=b.left}if((this.bottom==null)||(b.bottom<this.bottom)){this.bottom=b.bottom}if((this.right==null)||(b.right>this.right)){this.right=b.right}if((this.top==null)||(b.top>this.top)){this.top=b.top}}}},containsLonLat:function(b,a){return this.contains(b.lon,b.lat,a)},containsPixel:function(b,a){return this.contains(b.x,b.y,a)},contains:function(b,d,a){if(a==null){a=true}if(b==null||d==null){return false}b=OpenLayers.Util.toFloat(b);d=OpenLayers.Util.toFloat(d);var c=false;if(a){c=((b>=this.left)&&(b<=this.right)&&(d>=this.bottom)&&(d<=this.top))}else{c=((b>this.left)&&(b<this.right)&&(d>this.bottom)&&(d<this.top))}return c},intersectsBounds:function(e,b){if(b==null){b=true}var d=false;var h=(this.left==e.right||this.right==e.left||this.top==e.bottom||this.bottom==e.top);if(b||!h){var g=(((e.bottom>=this.bottom)&&(e.bottom<=this.top))||((this.bottom>=e.bottom)&&(this.bottom<=e.top)));var f=(((e.top>=this.bottom)&&(e.top<=this.top))||((this.top>e.bottom)&&(this.top<e.top)));var c=(((e.left>=this.left)&&(e.left<=this.right))||((this.left>=e.left)&&(this.left<=e.right)));var a=(((e.right>=this.left)&&(e.right<=this.right))||((this.right>=e.left)&&(this.right<=e.right)));d=((g||f)&&(c||a))}return d},containsBounds:function(g,b,a){if(b==null){b=false}if(a==null){a=true}var c=this.contains(g.left,g.bottom,a);var d=this.contains(g.right,g.bottom,a);var f=this.contains(g.left,g.top,a);var e=this.contains(g.right,g.top,a);return(b)?(c||d||f||e):(c&&d&&f&&e)},determineQuadrant:function(c){var b="";var a=this.getCenterLonLat();b+=(c.lat<a.lat)?"b":"t";b+=(c.lon<a.lon)?"l":"r";return b},transform:function(d,b){this.centerLonLat=null;var e=OpenLayers.Projection.transform({x:this.left,y:this.bottom},d,b);var a=OpenLayers.Projection.transform({x:this.right,y:this.bottom},d,b);var c=OpenLayers.Projection.transform({x:this.left,y:this.top},d,b);var f=OpenLayers.Projection.transform({x:this.right,y:this.top},d,b);
this.left=Math.min(e.x,c.x);this.bottom=Math.min(e.y,a.y);this.right=Math.max(a.x,f.x);this.top=Math.max(c.y,f.y);return this},wrapDateLine:function(a,c){c=c||{};var d=c.leftTolerance||0;var b=c.rightTolerance||0;var e=this.clone();if(a){while(e.left<a.left&&(e.right-b)<=a.left){e=e.add(a.getWidth(),0)}while((e.left+d)>=a.right&&e.right>a.right){e=e.add(-a.getWidth(),0)}}return e},CLASS_NAME:"OpenLayers.Bounds"});OpenLayers.Bounds.fromString=function(b){var a=b.split(",");return OpenLayers.Bounds.fromArray(a)};OpenLayers.Bounds.fromArray=function(a){return new OpenLayers.Bounds(parseFloat(a[0]),parseFloat(a[1]),parseFloat(a[2]),parseFloat(a[3]))};OpenLayers.Bounds.fromSize=function(a){return new OpenLayers.Bounds(0,a.h,a.w,0)};OpenLayers.Bounds.oppositeQuadrant=function(a){var b="";b+=(a.charAt(0)=="t")?"b":"t";b+=(a.charAt(1)=="l")?"r":"l";return b};OpenLayers.LonLat=OpenLayers.Class({lon:0,lat:0,initialize:function(b,a){this.lon=OpenLayers.Util.toFloat(b);this.lat=OpenLayers.Util.toFloat(a)},toString:function(){return("lon="+this.lon+",lat="+this.lat)},toShortString:function(){return(this.lon+", "+this.lat)},clone:function(){return new OpenLayers.LonLat(this.lon,this.lat)},add:function(c,a){if((c==null)||(a==null)){var b=OpenLayers.i18n("lonlatAddError");OpenLayers.Console.error(b);return null}return new OpenLayers.LonLat(this.lon+OpenLayers.Util.toFloat(c),this.lat+OpenLayers.Util.toFloat(a))},equals:function(b){var a=false;if(b!=null){a=((this.lon==b.lon&&this.lat==b.lat)||(isNaN(this.lon)&&isNaN(this.lat)&&isNaN(b.lon)&&isNaN(b.lat)))}return a},transform:function(c,b){var a=OpenLayers.Projection.transform({x:this.lon,y:this.lat},c,b);this.lon=a.x;this.lat=a.y;return this},wrapDateLine:function(a){var b=this.clone();if(a){while(b.lon<a.left){b.lon+=a.getWidth()}while(b.lon>a.right){b.lon-=a.getWidth()}}return b},CLASS_NAME:"OpenLayers.LonLat"});OpenLayers.LonLat.fromString=function(b){var a=b.split(",");return new OpenLayers.LonLat(a[0],a[1])};OpenLayers.Pixel=OpenLayers.Class({x:0,y:0,initialize:function(a,b){this.x=parseFloat(a);this.y=parseFloat(b)},toString:function(){return("x="+this.x+",y="+this.y)},clone:function(){return new OpenLayers.Pixel(this.x,this.y)},equals:function(a){var b=false;if(a!=null){b=((this.x==a.x&&this.y==a.y)||(isNaN(this.x)&&isNaN(this.y)&&isNaN(a.x)&&isNaN(a.y)))}return b},add:function(a,c){if((a==null)||(c==null)){var b=OpenLayers.i18n("pixelAddError");OpenLayers.Console.error(b);return null}return new OpenLayers.Pixel(this.x+a,this.y+c)},offset:function(a){var b=this.clone();if(a){b=this.add(a.x,a.y)}return b},CLASS_NAME:"OpenLayers.Pixel"});OpenLayers.Control=OpenLayers.Class({id:null,map:null,div:null,type:null,allowSelection:false,displayClass:"",title:"",autoActivate:false,active:null,handler:null,eventListeners:null,events:null,EVENT_TYPES:["activate","deactivate"],initialize:function(a){this.displayClass=this.CLASS_NAME.replace("OpenLayers.","ol").replace(/\./g,"");OpenLayers.Util.extend(this,a);this.events=new OpenLayers.Events(this,null,this.EVENT_TYPES);if(this.eventListeners instanceof Object){this.events.on(this.eventListeners)}if(this.id==null){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")}},destroy:function(){if(this.events){if(this.eventListeners){this.events.un(this.eventListeners)}this.events.destroy();this.events=null}this.eventListeners=null;if(this.handler){this.handler.destroy();this.handler=null}if(this.handlers){for(var a in this.handlers){if(this.handlers.hasOwnProperty(a)&&typeof this.handlers[a].destroy=="function"){this.handlers[a].destroy()}}this.handlers=null}if(this.map){this.map.removeControl(this);this.map=null}},setMap:function(a){this.map=a;if(this.handler){this.handler.setMap(a)}},draw:function(a){if(this.div==null){this.div=OpenLayers.Util.createDiv(this.id);this.div.className=this.displayClass;if(!this.allowSelection){this.div.className+=" olControlNoSelect";this.div.setAttribute("unselectable","on",0);this.div.onselectstart=OpenLayers.Function.False
}if(this.title!=""){this.div.title=this.title}}if(a!=null){this.position=a.clone()}this.moveTo(this.position);return this.div},moveTo:function(a){if((a!=null)&&(this.div!=null)){this.div.style.left=a.x+"px";this.div.style.top=a.y+"px"}},activate:function(){if(this.active){return false}if(this.handler){this.handler.activate()}this.active=true;if(this.map){OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active")}this.events.triggerEvent("activate");return true},deactivate:function(){if(this.active){if(this.handler){this.handler.deactivate()}this.active=false;if(this.map){OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active")}this.events.triggerEvent("deactivate");return true}return false},CLASS_NAME:"OpenLayers.Control"});OpenLayers.Control.TYPE_BUTTON=1;OpenLayers.Control.TYPE_TOGGLE=2;OpenLayers.Control.TYPE_TOOL=3;OpenLayers.Lang={code:null,defaultCode:"en",getCode:function(){if(!OpenLayers.Lang.code){OpenLayers.Lang.setCode()}return OpenLayers.Lang.code},setCode:function(b){var d;if(!b){b=(OpenLayers.Util.getBrowserName()=="msie")?navigator.userLanguage:navigator.language}var c=b.split("-");c[0]=c[0].toLowerCase();if(typeof OpenLayers.Lang[c[0]]=="object"){d=c[0]}if(c[1]){var a=c[0]+"-"+c[1].toUpperCase();if(typeof OpenLayers.Lang[a]=="object"){d=a}}if(!d){OpenLayers.Console.warn("Failed to find OpenLayers.Lang."+c.join("-")+" dictionary, falling back to default language");d=OpenLayers.Lang.defaultCode}OpenLayers.Lang.code=d},translate:function(b,a){var d=OpenLayers.Lang[OpenLayers.Lang.getCode()];var c=d[b];if(!c){c=b}if(a){c=OpenLayers.String.format(c,a)}return c}};OpenLayers.i18n=OpenLayers.Lang.translate;OpenLayers.Popup.Anchored=OpenLayers.Class(OpenLayers.Popup,{relativePosition:null,keepInMap:true,anchor:null,initialize:function(h,d,g,c,b,f,e){var a=[h,d,g,c,f,e];OpenLayers.Popup.prototype.initialize.apply(this,a);this.anchor=(b!=null)?b:{size:new OpenLayers.Size(0,0),offset:new OpenLayers.Pixel(0,0)}},destroy:function(){this.anchor=null;this.relativePosition=null;OpenLayers.Popup.prototype.destroy.apply(this,arguments)},show:function(){this.updatePosition();OpenLayers.Popup.prototype.show.apply(this,arguments)},moveTo:function(c){var b=this.relativePosition;this.relativePosition=this.calculateRelativePosition(c);var d=this.calculateNewPx(c);var a=new Array(d);OpenLayers.Popup.prototype.moveTo.apply(this,a);if(this.relativePosition!=b){this.updateRelativePosition()}},setSize:function(b){OpenLayers.Popup.prototype.setSize.apply(this,arguments);if((this.lonlat)&&(this.map)){var a=this.map.getLayerPxFromLonLat(this.lonlat);this.moveTo(a)}},calculateRelativePosition:function(b){var d=this.map.getLonLatFromLayerPx(b);var c=this.map.getExtent();var a=c.determineQuadrant(d);return OpenLayers.Bounds.oppositeQuadrant(a)},updateRelativePosition:function(){},calculateNewPx:function(b){var e=b.offset(this.anchor.offset);var a=this.size||this.contentSize;var d=(this.relativePosition.charAt(0)=="t");e.y+=(d)?-(a.h+this.anchor.size.h):this.anchor.size.h;var c=(this.relativePosition.charAt(1)=="l");e.x+=(c)?-(a.w+this.anchor.size.w):this.anchor.size.w;return e},CLASS_NAME:"OpenLayers.Popup.Anchored"});OpenLayers.Protocol.SOS=function(b){b=OpenLayers.Util.applyDefaults(b,OpenLayers.Protocol.SOS.DEFAULTS);var a=OpenLayers.Protocol.SOS["v"+b.version.replace(/\./g,"_")];if(!a){throw"Unsupported SOS version: "+b.version}return new a(b)};OpenLayers.Protocol.SOS.DEFAULTS={version:"1.0.0"};OpenLayers.Protocol.SQL=OpenLayers.Class(OpenLayers.Protocol,{databaseName:"ol",tableName:"ol_vector_features",postReadFiltering:true,initialize:function(a){OpenLayers.Protocol.prototype.initialize.apply(this,[a])},destroy:function(){OpenLayers.Protocol.prototype.destroy.apply(this)},supported:function(){return false},evaluateFilter:function(a,b){return b&&this.postReadFiltering?b.evaluate(a):true},CLASS_NAME:"OpenLayers.Protocol.SQL"});OpenLayers.Protocol.WFS=function(b){b=OpenLayers.Util.applyDefaults(b,OpenLayers.Protocol.WFS.DEFAULTS);
var a=OpenLayers.Protocol.WFS["v"+b.version.replace(/\./g,"_")];if(!a){throw"Unsupported WFS version: "+b.version}return new a(b)};OpenLayers.Protocol.WFS.fromWMSLayer=function(d,c){var a,e;var g=d.params.LAYERS;var f=(g instanceof Array?g[0]:g).split(":");if(f.length>1){e=f[0]}a=f.pop();var b={url:d.url,featureType:a,featurePrefix:e,srsName:d.projection&&d.projection.getCode()||d.map&&d.map.getProjectionObject().getCode(),version:"1.1.0"};return new OpenLayers.Protocol.WFS(OpenLayers.Util.applyDefaults(c,b))};OpenLayers.Protocol.WFS.DEFAULTS={version:"1.0.0"};OpenLayers.Renderer.Canvas=OpenLayers.Class(OpenLayers.Renderer,{canvas:null,features:null,initialize:function(a){OpenLayers.Renderer.prototype.initialize.apply(this,arguments);this.root=document.createElement("canvas");this.container.appendChild(this.root);this.canvas=this.root.getContext("2d");this.features={}},eraseGeometry:function(b,a){this.eraseFeatures(this.features[a][0])},supported:function(){var a=document.createElement("canvas");return !!a.getContext},setExtent:function(a){this.extent=a.clone();this.resolution=null;this.redraw()},setSize:function(a){this.size=a.clone();this.root.style.width=a.w+"px";this.root.style.height=a.h+"px";this.root.width=a.w;this.root.height=a.h;this.resolution=null},drawFeature:function(a,b){b=b||a.style;b=this.applyDefaultSymbolizer(b);this.features[a.id]=[a,b];this.redraw()},drawGeometry:function(d,c){var b=d.CLASS_NAME;if((b=="OpenLayers.Geometry.Collection")||(b=="OpenLayers.Geometry.MultiPoint")||(b=="OpenLayers.Geometry.MultiLineString")||(b=="OpenLayers.Geometry.MultiPolygon")){for(var a=0;a<d.components.length;a++){this.drawGeometry(d.components[a],c)}return}switch(d.CLASS_NAME){case"OpenLayers.Geometry.Point":this.drawPoint(d,c);break;case"OpenLayers.Geometry.LineString":this.drawLineString(d,c);break;case"OpenLayers.Geometry.LinearRing":this.drawLinearRing(d,c);break;case"OpenLayers.Geometry.Polygon":this.drawPolygon(d,c);break;default:break}},drawExternalGraphic:function(g,f){var b=new Image();if(f.graphicTitle){b.title=f.graphicTitle}var e=f.graphicWidth||f.graphicHeight;var a=f.graphicHeight||f.graphicWidth;e=e?e:f.pointRadius*2;a=a?a:f.pointRadius*2;var d=(f.graphicXOffset!=undefined)?f.graphicXOffset:-(0.5*e);var h=(f.graphicYOffset!=undefined)?f.graphicYOffset:-(0.5*a);var c={img:b,x:(g[0]+d),y:(g[1]+h),width:e,height:a,opacity:f.graphicOpacity||f.fillOpacity,canvas:this.canvas};b.onload=OpenLayers.Function.bind(function(){this.canvas.globalAlpha=this.opacity;this.canvas.drawImage(this.img,this.x,this.y,this.width,this.height)},c);b.src=f.externalGraphic},setCanvasStyle:function(b,a){if(b=="fill"){this.canvas.globalAlpha=a.fillOpacity;this.canvas.fillStyle=a.fillColor}else{if(b=="stroke"){this.canvas.globalAlpha=a.strokeOpacity;this.canvas.strokeStyle=a.strokeColor;this.canvas.lineWidth=a.strokeWidth}else{this.canvas.globalAlpha=0;this.canvas.lineWidth=1}}},drawPoint:function(c,a){if(a.graphic!==false){var b=this.getLocalXY(c);if(a.externalGraphic){this.drawExternalGraphic(b,a)}else{if(a.fill!==false){this.setCanvasStyle("fill",a);this.canvas.beginPath();this.canvas.arc(b[0],b[1],a.pointRadius,0,Math.PI*2,true);this.canvas.fill()}if(a.stroke!==false){this.setCanvasStyle("stroke",a);this.canvas.beginPath();this.canvas.arc(b[0],b[1],a.pointRadius,0,Math.PI*2,true);this.canvas.stroke();this.setCanvasStyle("reset")}}}},drawLineString:function(d,b){if(b.stroke!==false){this.setCanvasStyle("stroke",b);this.canvas.beginPath();var e=this.getLocalXY(d.components[0]);this.canvas.moveTo(e[0],e[1]);for(var a=1;a<d.components.length;a++){var c=this.getLocalXY(d.components[a]);this.canvas.lineTo(c[0],c[1])}this.canvas.stroke()}this.setCanvasStyle("reset")},drawLinearRing:function(d,b){if(b.fill!==false){this.setCanvasStyle("fill",b);this.canvas.beginPath();var e=this.getLocalXY(d.components[0]);this.canvas.moveTo(e[0],e[1]);for(var a=1;a<d.components.length-1;a++){var c=this.getLocalXY(d.components[a]);this.canvas.lineTo(c[0],c[1])}this.canvas.fill()
}if(b.stroke!==false){this.setCanvasStyle("stroke",b);this.canvas.beginPath();var e=this.getLocalXY(d.components[0]);this.canvas.moveTo(e[0],e[1]);for(var a=1;a<d.components.length;a++){var c=this.getLocalXY(d.components[a]);this.canvas.lineTo(c[0],c[1])}this.canvas.stroke()}this.setCanvasStyle("reset")},drawPolygon:function(c,b){this.drawLinearRing(c.components[0],b);for(var a=1;a<c.components.length;a++){this.drawLinearRing(c.components[a],{fillOpacity:0,strokeWidth:0,strokeOpacity:0,strokeColor:"#000000",fillColor:"#000000"})}},drawText:function(b,d){d=OpenLayers.Util.extend({fontColor:"#000000",labelAlign:"cm"},d);var e=this.getLocalXY(b);this.setCanvasStyle("reset");this.canvas.fillStyle=d.fontColor;this.canvas.globalAlpha=d.fontOpacity||1;var f=d.fontWeight+" "+d.fontSize+" "+d.fontFamily;if(this.canvas.fillText){var c=OpenLayers.Renderer.Canvas.LABEL_ALIGN[d.labelAlign[0]]||"center";this.canvas.font=f;this.canvas.textAlign=c;this.canvas.fillText(d.label,e[0],e[1])}else{if(this.canvas.mozDrawText){this.canvas.mozTextStyle=f;var a=this.canvas.mozMeasureText(d.label);switch(d.labelAlign[0]){case"l":break;case"r":e[0]-=a;break;case"c":default:e[0]-=a/2}this.canvas.translate(e[0],e[1]);this.canvas.mozDrawText(d.label);this.canvas.translate(-1*e[0],-1*e[1])}}this.setCanvasStyle("reset")},getLocalXY:function(b){var c=this.getResolution();var d=this.extent;var a=(b.x/c+(-d.left/c));var e=((d.top/c)-b.y/c);return[a,e]},clear:function(){this.canvas.clearRect(0,0,this.root.width,this.root.height);this.features={}},getFeatureIdFromEvent:function(a){var f=this.map.getLonLatFromPixel(a.xy);var b=this.getResolution();var e=new OpenLayers.Bounds(f.lon-b*5,f.lat-b*5,f.lon+b*5,f.lat+b*5);var c=e.toGeometry();for(var d in this.features){if(!this.features.hasOwnProperty(d)){continue}if(this.features[d][0].geometry.intersects(c)){return d}}return null},eraseFeatures:function(b){if(!(b instanceof Array)){b=[b]}for(var a=0;a<b.length;++a){delete this.features[b[a].id]}this.redraw()},redraw:function(){if(!this.locked){this.canvas.clearRect(0,0,this.root.width,this.root.height);var f=[];var c,d;for(var g in this.features){if(!this.features.hasOwnProperty(g)){continue}c=this.features[g][0];d=this.features[g][1];if(!c.geometry){continue}this.drawGeometry(c.geometry,d);if(d.label){f.push([c,d])}}var e;for(var b=0,a=f.length;b<a;++b){e=f[b];this.drawText(e[0].geometry.getCentroid(),e[1])}}},CLASS_NAME:"OpenLayers.Renderer.Canvas"});OpenLayers.Renderer.Canvas.LABEL_ALIGN={l:"left",r:"right"};OpenLayers.ElementsIndexer=OpenLayers.Class({maxZIndex:null,order:null,indices:null,compare:null,initialize:function(a){this.compare=a?OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_Y_ORDER:OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_DRAWING_ORDER;this.order=[];this.indices={};this.maxZIndex=0},insert:function(c){if(this.exists(c)){this.remove(c)}var f=c.id;this.determineZIndex(c);var d=-1;var e=this.order.length;var a;while(e-d>1){a=parseInt((d+e)/2);var b=this.compare(this,c,OpenLayers.Util.getElement(this.order[a]));if(b>0){d=a}else{e=a}}this.order.splice(e,0,f);this.indices[f]=this.getZIndex(c);return this.getNextElement(e)},remove:function(b){var d=b.id;var a=OpenLayers.Util.indexOf(this.order,d);if(a>=0){this.order.splice(a,1);delete this.indices[d];if(this.order.length>0){var c=this.order[this.order.length-1];this.maxZIndex=this.indices[c]}else{this.maxZIndex=0}}},clear:function(){this.order=[];this.indices={};this.maxZIndex=0},exists:function(a){return(this.indices[a.id]!=null)},getZIndex:function(a){return a._style.graphicZIndex},determineZIndex:function(a){var b=a._style.graphicZIndex;if(b==null){b=this.maxZIndex;a._style.graphicZIndex=b}else{if(b>this.maxZIndex){this.maxZIndex=b}}},getNextElement:function(b){var a=b+1;if(a<this.order.length){var c=OpenLayers.Util.getElement(this.order[a]);if(c==undefined){c=this.getNextElement(a)}return c}else{return null}},CLASS_NAME:"OpenLayers.ElementsIndexer"});OpenLayers.ElementsIndexer.IndexingMethods={Z_ORDER:function(e,d,b){var a=e.getZIndex(d);
var f=0;if(b){var c=e.getZIndex(b);f=a-c}return f},Z_ORDER_DRAWING_ORDER:function(c,b,a){var d=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(c,b,a);if(a&&d==0){d=1}return d},Z_ORDER_Y_ORDER:function(d,c,b){var e=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(d,c,b);if(b&&e===0){var a=b._boundsBottom-c._boundsBottom;e=(a===0)?1:a}return e}};OpenLayers.Renderer.Elements=OpenLayers.Class(OpenLayers.Renderer,{rendererRoot:null,root:null,vectorRoot:null,textRoot:null,xmlns:null,indexer:null,BACKGROUND_ID_SUFFIX:"_background",LABEL_ID_SUFFIX:"_label",initialize:function(a,b){OpenLayers.Renderer.prototype.initialize.apply(this,arguments);this.rendererRoot=this.createRenderRoot();this.root=this.createRoot("_root");this.vectorRoot=this.createRoot("_vroot");this.textRoot=this.createRoot("_troot");this.root.appendChild(this.vectorRoot);this.root.appendChild(this.textRoot);this.rendererRoot.appendChild(this.root);this.container.appendChild(this.rendererRoot);if(b&&(b.zIndexing||b.yOrdering)){this.indexer=new OpenLayers.ElementsIndexer(b.yOrdering)}},destroy:function(){this.clear();this.rendererRoot=null;this.root=null;this.xmlns=null;OpenLayers.Renderer.prototype.destroy.apply(this,arguments)},clear:function(){var b;var a=this.vectorRoot;if(a){while(b=a.firstChild){a.removeChild(b)}}a=this.textRoot;if(a){while(b=a.firstChild){a.removeChild(b)}}if(this.indexer){this.indexer.clear()}},getNodeType:function(b,a){},drawGeometry:function(g,d,f){var c=g.CLASS_NAME;var h=true;if((c=="OpenLayers.Geometry.Collection")||(c=="OpenLayers.Geometry.MultiPoint")||(c=="OpenLayers.Geometry.MultiLineString")||(c=="OpenLayers.Geometry.MultiPolygon")){for(var b=0,a=g.components.length;b<a;b++){h=this.drawGeometry(g.components[b],d,f)&&h}return h}h=false;if(d.display!="none"){if(d.backgroundGraphic){this.redrawBackgroundNode(g.id,g,d,f)}h=this.redrawNode(g.id,g,d,f)}if(h==false){var e=document.getElementById(g.id);if(e){if(e._style.backgroundGraphic){e.parentNode.removeChild(document.getElementById(g.id+this.BACKGROUND_ID_SUFFIX))}e.parentNode.removeChild(e)}}return h},redrawNode:function(g,f,b,e){b=this.applyDefaultSymbolizer(b);var c=this.nodeFactory(g,this.getNodeType(f,b));c._featureId=e;c._boundsBottom=f.getBounds().bottom;c._geometryClass=f.CLASS_NAME;c._style=b;var a=this.drawGeometryNode(c,f,b);if(a===false){return false}c=a.node;if(this.indexer){var d=this.indexer.insert(c);if(d){this.vectorRoot.insertBefore(c,d)}else{this.vectorRoot.appendChild(c)}}else{if(c.parentNode!==this.vectorRoot){this.vectorRoot.appendChild(c)}}this.postDraw(c);return a.complete},redrawBackgroundNode:function(e,d,b,c){var a=OpenLayers.Util.extend({},b);a.externalGraphic=a.backgroundGraphic;a.graphicXOffset=a.backgroundXOffset;a.graphicYOffset=a.backgroundYOffset;a.graphicZIndex=a.backgroundGraphicZIndex;a.graphicWidth=a.backgroundWidth||a.graphicWidth;a.graphicHeight=a.backgroundHeight||a.graphicHeight;a.backgroundGraphic=null;a.backgroundXOffset=null;a.backgroundYOffset=null;a.backgroundGraphicZIndex=null;return this.redrawNode(e+this.BACKGROUND_ID_SUFFIX,d,a,null)},drawGeometryNode:function(c,e,b){b=b||c._style;var a={isFilled:b.fill===undefined?true:b.fill,isStroked:b.stroke===undefined?!!b.strokeWidth:b.stroke};var d;switch(e.CLASS_NAME){case"OpenLayers.Geometry.Point":if(b.graphic===false){a.isFilled=false;a.isStroked=false}d=this.drawPoint(c,e);break;case"OpenLayers.Geometry.LineString":a.isFilled=false;d=this.drawLineString(c,e);break;case"OpenLayers.Geometry.LinearRing":d=this.drawLinearRing(c,e);break;case"OpenLayers.Geometry.Polygon":d=this.drawPolygon(c,e);break;case"OpenLayers.Geometry.Surface":d=this.drawSurface(c,e);break;case"OpenLayers.Geometry.Rectangle":d=this.drawRectangle(c,e);break;default:break}c._options=a;if(d!=false){return{node:this.setStyle(c,b,a,e),complete:d}}else{return false}},postDraw:function(a){},drawPoint:function(a,b){},drawLineString:function(a,b){},drawLinearRing:function(a,b){},drawPolygon:function(a,b){},drawRectangle:function(a,b){},drawCircle:function(a,b){},drawSurface:function(a,b){},removeText:function(b){var a=document.getElementById(b+this.LABEL_ID_SUFFIX);
if(a){this.textRoot.removeChild(a)}},getFeatureIdFromEvent:function(a){var d=a.target;var b=d&&d.correspondingUseElement;var c=b?b:(d||a.srcElement);var e=c._featureId;return e},eraseGeometry:function(g,f){if((g.CLASS_NAME=="OpenLayers.Geometry.MultiPoint")||(g.CLASS_NAME=="OpenLayers.Geometry.MultiLineString")||(g.CLASS_NAME=="OpenLayers.Geometry.MultiPolygon")||(g.CLASS_NAME=="OpenLayers.Geometry.Collection")){for(var d=0,a=g.components.length;d<a;d++){this.eraseGeometry(g.components[d],f)}}else{var c=OpenLayers.Util.getElement(g.id);if(c&&c.parentNode){if(c.geometry){c.geometry.destroy();c.geometry=null}c.parentNode.removeChild(c);if(this.indexer){this.indexer.remove(c)}if(c._style.backgroundGraphic){var b=g.id+this.BACKGROUND_ID_SUFFIX;var e=OpenLayers.Util.getElement(b);if(e&&e.parentNode){e.parentNode.removeChild(e)}}}}},nodeFactory:function(c,a){var b=OpenLayers.Util.getElement(c);if(b){if(!this.nodeTypeCompare(b,a)){b.parentNode.removeChild(b);b=this.nodeFactory(c,a)}}else{b=this.createNode(a,c)}return b},nodeTypeCompare:function(b,a){},createNode:function(a,b){},moveRoot:function(b){var a=this.root;if(b.root.parentNode==this.rendererRoot){a=b.root}a.parentNode.removeChild(a);b.rendererRoot.appendChild(a)},getRenderLayerId:function(){return this.root.parentNode.parentNode.id},isComplexSymbol:function(a){return(a!="circle")&&!!a},CLASS_NAME:"OpenLayers.Renderer.Elements"});OpenLayers.Renderer.symbol={star:[350,75,379,161,469,161,397,215,423,301,350,250,277,301,303,215,231,161,321,161,350,75],cross:[4,0,6,0,6,4,10,4,10,6,6,6,6,10,4,10,4,6,0,6,0,4,4,4,4,0],x:[0,0,25,0,50,35,75,0,100,0,65,50,100,100,75,100,50,65,25,100,0,100,35,50,0,0],square:[0,0,0,1,1,1,1,0,0,0],triangle:[0,10,10,10,5,0,0,10]};OpenLayers.Strategy.Cluster=OpenLayers.Class(OpenLayers.Strategy,{distance:20,threshold:null,features:null,clusters:null,clustering:false,resolution:null,initialize:function(a){OpenLayers.Strategy.prototype.initialize.apply(this,[a])},activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);if(a){this.layer.events.on({beforefeaturesadded:this.cacheFeatures,moveend:this.cluster,scope:this})}return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);if(a){this.clearCache();this.layer.events.un({beforefeaturesadded:this.cacheFeatures,moveend:this.cluster,scope:this})}return a},cacheFeatures:function(b){var a=true;if(!this.clustering){this.clearCache();this.features=b.features;this.cluster();a=false}return a},clearCache:function(){this.features=null},cluster:function(a){if((!a||a.zoomChanged)&&this.features){var c=this.layer.map.getResolution();if(c!=this.resolution||!this.clustersExist()){this.resolution=c;var h=[];var m,b,k;for(var e=0;e<this.features.length;++e){m=this.features[e];if(m.geometry){b=false;for(var d=h.length-1;d>=0;--d){k=h[d];if(this.shouldCluster(k,m)){this.addToCluster(k,m);b=true;break}}if(!b){h.push(this.createCluster(this.features[e]))}}}this.layer.removeAllFeatures();if(h.length>0){if(this.threshold>1){var g=h.slice();h=[];var l;for(var e=0,f=g.length;e<f;++e){l=g[e];if(l.attributes.count<this.threshold){Array.prototype.push.apply(h,l.cluster)}else{h.push(l)}}}this.clustering=true;this.layer.addFeatures(h);this.clustering=false}this.clusters=h}}},clustersExist:function(){var b=false;if(this.clusters&&this.clusters.length>0&&this.clusters.length==this.layer.features.length){b=true;for(var a=0;a<this.clusters.length;++a){if(this.clusters[a]!=this.layer.features[a]){b=false;break}}}return b},shouldCluster:function(a,b){var e=a.geometry.getBounds().getCenterLonLat();var c=b.geometry.getBounds().getCenterLonLat();var d=(Math.sqrt(Math.pow((e.lon-c.lon),2)+Math.pow((e.lat-c.lat),2))/this.resolution);return(d<=this.distance)},addToCluster:function(a,b){a.cluster.push(b);a.attributes.count+=1},createCluster:function(c){var b=c.geometry.getBounds().getCenterLonLat();var a=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(b.lon,b.lat),{count:1});a.cluster=[c];return a
},CLASS_NAME:"OpenLayers.Strategy.Cluster"});OpenLayers.Strategy.Fixed=OpenLayers.Class(OpenLayers.Strategy,{preload:false,initialize:function(a){OpenLayers.Strategy.prototype.initialize.apply(this,[a])},destroy:function(){OpenLayers.Strategy.prototype.destroy.apply(this,arguments)},activate:function(){if(OpenLayers.Strategy.prototype.activate.apply(this,arguments)){this.layer.events.on({refresh:this.load,scope:this});if(this.layer.visibility==true||this.preload){this.load()}else{this.layer.events.on({visibilitychanged:this.load,scope:this})}return true}return false},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);if(a){this.layer.events.un({refresh:this.load,visibilitychanged:this.load,scope:this})}return a},load:function(a){this.layer.events.triggerEvent("loadstart");this.layer.protocol.read(OpenLayers.Util.applyDefaults({callback:this.merge,filter:this.layer.filter,scope:this},a));this.layer.events.un({visibilitychanged:this.load,scope:this})},merge:function(g){this.layer.destroyFeatures();var e=g.features;if(e&&e.length>0){var f=this.layer.projection;var d=this.layer.map.getProjectionObject();if(!d.equals(f)){var c;for(var b=0,a=e.length;b<a;++b){c=e[b].geometry;if(c){c.transform(f,d)}}}this.layer.addFeatures(e)}this.layer.events.triggerEvent("loadend")},CLASS_NAME:"OpenLayers.Strategy.Fixed"});OpenLayers.Strategy.Paging=OpenLayers.Class(OpenLayers.Strategy,{features:null,length:10,num:null,paging:false,initialize:function(a){OpenLayers.Strategy.prototype.initialize.apply(this,[a])},activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);if(a){this.layer.events.on({beforefeaturesadded:this.cacheFeatures,scope:this})}return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);if(a){this.clearCache();this.layer.events.un({beforefeaturesadded:this.cacheFeatures,scope:this})}return a},cacheFeatures:function(a){if(!this.paging){this.clearCache();this.features=a.features;this.pageNext(a)}},clearCache:function(){if(this.features){for(var a=0;a<this.features.length;++a){this.features[a].destroy()}}this.features=null;this.num=null},pageCount:function(){var a=this.features?this.features.length:0;return Math.ceil(a/this.length)},pageNum:function(){return this.num},pageLength:function(a){if(a&&a>0){this.length=a}return this.length},pageNext:function(a){var b=false;if(this.features){if(this.num===null){this.num=-1}var c=(this.num+1)*this.length;b=this.page(c,a)}return b},pagePrevious:function(){var a=false;if(this.features){if(this.num===null){this.num=this.pageCount()}var b=(this.num-1)*this.length;a=this.page(b)}return a},page:function(e,c){var d=false;if(this.features){if(e>=0&&e<this.features.length){var a=Math.floor(e/this.length);if(a!=this.num){this.paging=true;var b=this.features.slice(e,e+this.length);this.layer.removeFeatures(this.layer.features);this.num=a;if(c&&c.features){c.features=b}else{this.layer.addFeatures(b)}this.paging=false;d=true}}}return d},CLASS_NAME:"OpenLayers.Strategy.Paging"});OpenLayers.Strategy.Refresh=OpenLayers.Class(OpenLayers.Strategy,{force:false,interval:0,timer:null,initialize:function(a){OpenLayers.Strategy.prototype.initialize.apply(this,[a])},activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);if(a){if(this.layer.visibility===true){this.start()}this.layer.events.on({visibilitychanged:this.reset,scope:this})}return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);if(a){this.stop()}return a},reset:function(){if(this.layer.visibility===true){this.start()}else{this.stop()}},start:function(){if(this.interval&&typeof this.interval==="number"&&this.interval>0){this.timer=window.setInterval(OpenLayers.Function.bind(this.refresh,this),this.interval)}},refresh:function(){if(this.layer&&this.layer.refresh&&typeof this.layer.refresh=="function"){this.layer.refresh({force:this.force})}},stop:function(){if(this.timer!==null){window.clearInterval(this.timer);this.timer=null
}},CLASS_NAME:"OpenLayers.Strategy.Refresh"});OpenLayers.Strategy.Save=OpenLayers.Class(OpenLayers.Strategy,{EVENT_TYPES:["start","success","fail"],events:null,auto:false,timer:null,initialize:function(a){OpenLayers.Strategy.prototype.initialize.apply(this,[a]);this.events=new OpenLayers.Events(this,null,this.EVENT_TYPES)},activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);if(a){if(this.auto){if(typeof this.auto==="number"){this.timer=window.setInterval(OpenLayers.Function.bind(this.save,this),this.auto*1000)}else{this.layer.events.on({featureadded:this.triggerSave,afterfeaturemodified:this.triggerSave,scope:this})}}}return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);if(a){if(this.auto){if(typeof this.auto==="number"){window.clearInterval(this.timer)}else{this.layer.events.un({featureadded:this.triggerSave,afterfeaturemodified:this.triggerSave,scope:this})}}}return a},triggerSave:function(b){var a=b.feature;if(a.state===OpenLayers.State.INSERT||a.state===OpenLayers.State.UPDATE||a.state===OpenLayers.State.DELETE){this.save([b.feature])}},save:function(d){if(!d){d=this.layer.features}this.events.triggerEvent("start",{features:d});var f=this.layer.projection;var c=this.layer.map.getProjectionObject();if(!c.equals(f)){var a=d.length;var e=new Array(a);var h,g;for(var b=0;b<a;++b){h=d[b];g=h.clone();g.fid=h.fid;g.state=h.state;if(h.url){g.url=h.url}g._original=h;g.geometry.transform(c,f);e[b]=g}d=e}this.layer.protocol.commit(d,{callback:this.onCommit,scope:this})},onCommit:function(d){var k={response:d};if(d.success()){var b=d.reqFeatures;var a,l;var c=[];var h=d.insertIds||[];var e=0;for(var f=0,g=b.length;f<g;++f){l=b[f];l=l._original||l;a=l.state;if(a){if(a==OpenLayers.State.DELETE){c.push(l)}else{if(a==OpenLayers.State.INSERT){l.fid=h[e];++e}}l.state=null}}if(c.length>0){this.layer.destroyFeatures(c)}this.events.triggerEvent("success",k)}else{this.events.triggerEvent("fail",k)}},CLASS_NAME:"OpenLayers.Strategy.Save"});OpenLayers.Symbolizer.Line=OpenLayers.Class(OpenLayers.Symbolizer,{strokeColor:null,strokeOpacity:null,strokeWidth:null,strokeLinecap:null,strokeDashstyle:null,initialize:function(a){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Line"});OpenLayers.Symbolizer.Point=OpenLayers.Class(OpenLayers.Symbolizer,{strokeColor:null,strokeOpacity:null,strokeWidth:null,strokeLinecap:null,strokeDashstyle:null,fillColor:null,fillOpacity:null,pointRadius:null,externalGraphic:null,graphicWidth:null,graphicHeight:null,graphicOpacity:null,graphicXOffset:null,graphicYOffset:null,rotation:null,graphicName:null,initialize:function(a){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Point"});OpenLayers.Symbolizer.Polygon=OpenLayers.Class(OpenLayers.Symbolizer,{strokeColor:null,strokeOpacity:null,strokeWidth:null,strokeLinecap:null,strokeDashstyle:null,fillColor:null,fillOpacity:null,initialize:function(a){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Polygon"});OpenLayers.Symbolizer.Raster=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(a){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Raster"});OpenLayers.Symbolizer.Text=OpenLayers.Class(OpenLayers.Symbolizer,{label:null,fontFamily:null,fontSize:null,fontWeight:null,fontStyle:null,initialize:function(a){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Text"});OpenLayers.Tween=OpenLayers.Class({INTERVAL:10,easing:null,begin:null,finish:null,duration:null,callbacks:null,time:null,interval:null,playing:false,initialize:function(a){this.easing=(a)?a:OpenLayers.Easing.Expo.easeOut},start:function(c,b,d,a){this.playing=true;this.begin=c;this.finish=b;this.duration=d;this.callbacks=a.callbacks;this.time=0;if(this.interval){window.clearInterval(this.interval);this.interval=null
}if(this.callbacks&&this.callbacks.start){this.callbacks.start.call(this,this.begin)}this.interval=window.setInterval(OpenLayers.Function.bind(this.play,this),this.INTERVAL)},stop:function(){if(!this.playing){return}if(this.callbacks&&this.callbacks.done){this.callbacks.done.call(this,this.finish)}window.clearInterval(this.interval);this.interval=null;this.playing=false},play:function(){var g={};for(var d in this.begin){var a=this.begin[d];var e=this.finish[d];if(a==null||e==null||isNaN(a)||isNaN(e)){OpenLayers.Console.error("invalid value for Tween")}var h=e-a;g[d]=this.easing.apply(this,[this.time,a,h,this.duration])}this.time++;if(this.callbacks&&this.callbacks.eachStep){this.callbacks.eachStep.call(this,g)}if(this.time>this.duration){this.stop()}},CLASS_NAME:"OpenLayers.Tween"});OpenLayers.Easing={CLASS_NAME:"OpenLayers.Easing"};OpenLayers.Easing.Linear={easeIn:function(e,a,g,f){return g*e/f+a},easeOut:function(e,a,g,f){return g*e/f+a},easeInOut:function(e,a,g,f){return g*e/f+a},CLASS_NAME:"OpenLayers.Easing.Linear"};OpenLayers.Easing.Expo={easeIn:function(e,a,g,f){return(e==0)?a:g*Math.pow(2,10*(e/f-1))+a},easeOut:function(e,a,g,f){return(e==f)?a+g:g*(-Math.pow(2,-10*e/f)+1)+a},easeInOut:function(e,a,g,f){if(e==0){return a}if(e==f){return a+g}if((e/=f/2)<1){return g/2*Math.pow(2,10*(e-1))+a}return g/2*(-Math.pow(2,-10*--e)+2)+a},CLASS_NAME:"OpenLayers.Easing.Expo"};OpenLayers.Easing.Quad={easeIn:function(e,a,g,f){return g*(e/=f)*e+a},easeOut:function(e,a,g,f){return -g*(e/=f)*(e-2)+a},easeInOut:function(e,a,g,f){if((e/=f/2)<1){return g/2*e*e+a}return -g/2*((--e)*(e-2)-1)+a},CLASS_NAME:"OpenLayers.Easing.Quad"};OpenLayers.Control.ArgParser=OpenLayers.Class(OpenLayers.Control,{center:null,zoom:null,layers:null,displayProjection:null,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,arguments)},setMap:function(e){OpenLayers.Control.prototype.setMap.apply(this,arguments);for(var c=0,a=this.map.controls.length;c<a;c++){var d=this.map.controls[c];if((d!=this)&&(d.CLASS_NAME=="OpenLayers.Control.ArgParser")){if(d.displayProjection!=this.displayProjection){this.displayProjection=d.displayProjection}break}}if(c==this.map.controls.length){var b=OpenLayers.Util.getParameters();if(b.layers){this.layers=b.layers;this.map.events.register("addlayer",this,this.configureLayers);this.configureLayers()}if(b.lat&&b.lon){this.center=new OpenLayers.LonLat(parseFloat(b.lon),parseFloat(b.lat));if(b.zoom){this.zoom=parseInt(b.zoom)}this.map.events.register("changebaselayer",this,this.setCenter);this.setCenter()}}},setCenter:function(){if(this.map.baseLayer){this.map.events.unregister("changebaselayer",this,this.setCenter);if(this.displayProjection){this.center.transform(this.displayProjection,this.map.getProjectionObject())}this.map.setCenter(this.center,this.zoom)}},configureLayers:function(){if(this.layers.length==this.map.layers.length){this.map.events.unregister("addlayer",this,this.configureLayers);for(var d=0,a=this.layers.length;d<a;d++){var b=this.map.layers[d];var e=this.layers.charAt(d);if(e=="B"){this.map.setBaseLayer(b)}else{if((e=="T")||(e=="F")){b.setVisibility(e=="T")}}}}},CLASS_NAME:"OpenLayers.Control.ArgParser"});OpenLayers.Control.Attribution=OpenLayers.Class(OpenLayers.Control,{separator:", ",initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.map.events.un({removelayer:this.updateAttribution,addlayer:this.updateAttribution,changelayer:this.updateAttribution,changebaselayer:this.updateAttribution,scope:this});OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.map.events.on({changebaselayer:this.updateAttribution,changelayer:this.updateAttribution,addlayer:this.updateAttribution,removelayer:this.updateAttribution,scope:this});this.updateAttribution();return this.div},updateAttribution:function(){var d=[];if(this.map&&this.map.layers){for(var c=0,a=this.map.layers.length;
c<a;c++){var b=this.map.layers[c];if(b.attribution&&b.getVisibility()){if(OpenLayers.Util.indexOf(d,b.attribution)===-1){d.push(b.attribution)}}}this.div.innerHTML=d.join(this.separator)}},CLASS_NAME:"OpenLayers.Control.Attribution"});OpenLayers.Control.Button=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){},CLASS_NAME:"OpenLayers.Control.Button"});OpenLayers.Control.Graticule=OpenLayers.Class(OpenLayers.Control,{autoActivate:true,intervals:[45,30,20,10,5,2,1,0.5,0.2,0.1,0.05,0.01,0.005,0.002,0.001],displayInLayerSwitcher:true,visible:true,numPoints:50,targetSize:200,layerName:null,labelled:true,labelFormat:"dm",lineSymbolizer:{strokeColor:"#333",strokeWidth:1,strokeOpacity:0.5},labelSymbolizer:{},gratLayer:null,initialize:function(a){a=a||{};a.layerName=a.layerName||OpenLayers.i18n("graticule");OpenLayers.Control.prototype.initialize.apply(this,[a]);this.labelSymbolizer.stroke=false;this.labelSymbolizer.fill=false;this.labelSymbolizer.label="${label}";this.labelSymbolizer.labelAlign="${labelAlign}";this.labelSymbolizer.labelXOffset="${xOffset}";this.labelSymbolizer.labelYOffset="${yOffset}"},destroy:function(){this.deactivate();OpenLayers.Control.prototype.destroy.apply(this,arguments);if(this.gratLayer){this.gratLayer.destroy();this.gratLayer=null}},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.gratLayer){var a=new OpenLayers.Style({},{rules:[new OpenLayers.Rule({symbolizer:{Point:this.labelSymbolizer,Line:this.lineSymbolizer}})]});this.gratLayer=new OpenLayers.Layer.Vector(this.layerName,{styleMap:new OpenLayers.StyleMap({"default":a}),visibility:this.visible,displayInLayerSwitcher:this.displayInLayerSwitcher})}return this.div},activate:function(){if(OpenLayers.Control.prototype.activate.apply(this,arguments)){this.map.addLayer(this.gratLayer);this.map.events.register("moveend",this,this.update);this.update();return true}else{return false}},deactivate:function(){if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){this.map.events.unregister("moveend",this,this.update);this.map.removeLayer(this.gratLayer);return true}else{return false}},update:function(){var k=this.map.getExtent();if(!k){return}this.gratLayer.destroyFeatures();var l=new OpenLayers.Projection("EPSG:4326");var G=this.map.getProjectionObject();var g=this.map.getResolution();if(G.proj&&G.proj.projName=="longlat"){this.numPoints=1}var J=this.map.getCenter();var C=new OpenLayers.Pixel(J.lon,J.lat);OpenLayers.Projection.transform(C,G,l);var x=this.targetSize*g;x*=x;var p;for(var B=0;B<this.intervals.length;++B){p=this.intervals[B];var H=p/2;var d=C.offset(new OpenLayers.Pixel(-H,-H));var b=C.offset(new OpenLayers.Pixel(H,H));OpenLayers.Projection.transform(d,l,G);OpenLayers.Projection.transform(b,l,G);var e=(d.x-b.x)*(d.x-b.x)+(d.y-b.y)*(d.y-b.y);if(e<=x){break}}C.x=Math.floor(C.x/p)*p;C.y=Math.floor(C.y/p)*p;var A=0;var q=[C.clone()];var o=C.clone();var y;do{o=o.offset(new OpenLayers.Pixel(0,p));y=OpenLayers.Projection.transform(o.clone(),l,G);q.unshift(o)}while(k.containsPixel(y)&&++A<1000);o=C.clone();do{o=o.offset(new OpenLayers.Pixel(0,-p));y=OpenLayers.Projection.transform(o.clone(),l,G);q.push(o)}while(k.containsPixel(y)&&++A<1000);A=0;var v=[C.clone()];o=C.clone();do{o=o.offset(new OpenLayers.Pixel(-p,0));y=OpenLayers.Projection.transform(o.clone(),l,G);v.unshift(o)}while(k.containsPixel(y)&&++A<1000);o=C.clone();do{o=o.offset(new OpenLayers.Pixel(p,0));y=OpenLayers.Projection.transform(o.clone(),l,G);v.push(o)}while(k.containsPixel(y)&&++A<1000);var a=[];for(var B=0;B<v.length;++B){var f=v[B].x;var u=[];var I=null;var D=Math.min(q[0].y,90);var n=Math.max(q[q.length-1].y,-90);var c=(D-n)/this.numPoints;var h=n;for(var z=0;z<=this.numPoints;++z){var E=new OpenLayers.Geometry.Point(f,h);E.transform(l,G);u.push(E);h+=c;if(E.y>=k.bottom&&!I){I=E}}if(this.labelled){var s=new OpenLayers.Geometry.Point(I.x,k.bottom);var F={value:f,label:this.labelled?OpenLayers.Util.getFormattedLonLat(f,"lon",this.labelFormat):"",labelAlign:"cb",xOffset:0,yOffset:2};
this.gratLayer.addFeatures(new OpenLayers.Feature.Vector(s,F))}var t=new OpenLayers.Geometry.LineString(u);a.push(new OpenLayers.Feature.Vector(t))}for(var z=0;z<q.length;++z){h=q[z].y;if(h<-90||h>90){continue}var u=[];var w=v[0].x;var r=v[v.length-1].x;var m=(r-w)/this.numPoints;var f=w;var I=null;for(var B=0;B<=this.numPoints;++B){var E=new OpenLayers.Geometry.Point(f,h);E.transform(l,G);u.push(E);f+=m;if(E.x<k.right){I=E}}if(this.labelled){var s=new OpenLayers.Geometry.Point(k.right,I.y);var F={value:h,label:this.labelled?OpenLayers.Util.getFormattedLonLat(h,"lat",this.labelFormat):"",labelAlign:"rb",xOffset:-2,yOffset:2};this.gratLayer.addFeatures(new OpenLayers.Feature.Vector(s,F))}var t=new OpenLayers.Geometry.LineString(u);a.push(new OpenLayers.Feature.Vector(t))}this.gratLayer.addFeatures(a)},CLASS_NAME:"OpenLayers.Control.Graticule"});OpenLayers.Control.LayerSwitcher=OpenLayers.Class(OpenLayers.Control,{roundedCorner:true,roundedCornerColor:"darkblue",layerStates:null,layersDiv:null,baseLayersDiv:null,baseLayers:null,dataLbl:null,dataLayersDiv:null,dataLayers:null,minimizeDiv:null,maximizeDiv:null,ascending:true,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,arguments);this.layerStates=[]},destroy:function(){OpenLayers.Event.stopObservingElement(this.div);OpenLayers.Event.stopObservingElement(this.minimizeDiv);OpenLayers.Event.stopObservingElement(this.maximizeDiv);this.clearLayersArray("base");this.clearLayersArray("data");this.map.events.un({addlayer:this.redraw,changelayer:this.redraw,removelayer:this.redraw,changebaselayer:this.redraw,scope:this});OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);this.map.events.on({addlayer:this.redraw,changelayer:this.redraw,removelayer:this.redraw,changebaselayer:this.redraw,scope:this})},draw:function(){OpenLayers.Control.prototype.draw.apply(this);this.loadContents();if(!this.outsideViewport){this.minimizeControl()}this.redraw();return this.div},clearLayersArray:function(d){var e=this[d+"Layers"];if(e){for(var c=0,a=e.length;c<a;c++){var b=e[c];OpenLayers.Event.stopObservingElement(b.inputElem);OpenLayers.Event.stopObservingElement(b.labelSpan)}}this[d+"LayersDiv"].innerHTML="";this[d+"Layers"]=[]},checkRedraw:function(){var e=false;if(!this.layerStates.length||(this.map.layers.length!=this.layerStates.length)){e=true}else{for(var c=0,a=this.layerStates.length;c<a;c++){var d=this.layerStates[c];var b=this.map.layers[c];if((d.name!=b.name)||(d.inRange!=b.inRange)||(d.id!=b.id)||(d.visibility!=b.visibility)){e=true;break}}}return e},redraw:function(){if(!this.checkRedraw()){return this.div}this.clearLayersArray("base");this.clearLayersArray("data");var d=false;var m=false;var h=this.map.layers.length;this.layerStates=new Array(h);for(var f=0;f<h;f++){var g=this.map.layers[f];this.layerStates[f]={name:g.name,visibility:g.visibility,inRange:g.inRange,id:g.id}}var e=this.map.layers.slice();if(!this.ascending){e.reverse()}for(var f=0,h=e.length;f<h;f++){var g=e[f];var j=g.isBaseLayer;if(g.displayInLayerSwitcher){if(j){m=true}else{d=true}var l=(j)?(g==this.map.baseLayer):g.getVisibility();var k=document.createElement("input");k.id=this.id+"_input_"+g.name;k.name=(j)?this.id+"_baseLayers":g.name;k.type=(j)?"radio":"checkbox";k.value=g.name;k.checked=l;k.defaultChecked=l;if(!j&&!g.inRange){k.disabled=true}var a={inputElem:k,layer:g,layerSwitcher:this};OpenLayers.Event.observe(k,"mouseup",OpenLayers.Function.bindAsEventListener(this.onInputClick,a));var b=document.createElement("span");OpenLayers.Element.addClass(b,"labelSpan");if(!j&&!g.inRange){b.style.color="gray"}b.innerHTML=g.name;b.style.verticalAlign=(j)?"bottom":"baseline";OpenLayers.Event.observe(b,"click",OpenLayers.Function.bindAsEventListener(this.onInputClick,a));var o=document.createElement("br");var n=(j)?this.baseLayers:this.dataLayers;n.push({layer:g,inputElem:k,labelSpan:b});var c=(j)?this.baseLayersDiv:this.dataLayersDiv;
c.appendChild(k);c.appendChild(b);c.appendChild(o)}}this.dataLbl.style.display=(d)?"":"none";this.baseLbl.style.display=(m)?"":"none";return this.div},onInputClick:function(a){if(!this.inputElem.disabled){if(this.inputElem.type=="radio"){this.inputElem.checked=true;this.layer.map.setBaseLayer(this.layer)}else{this.inputElem.checked=!this.inputElem.checked;this.layerSwitcher.updateMap()}}OpenLayers.Event.stop(a)},onLayerClick:function(a){this.updateMap()},updateMap:function(){for(var b=0,a=this.baseLayers.length;b<a;b++){var c=this.baseLayers[b];if(c.inputElem.checked){this.map.setBaseLayer(c.layer,false)}}for(var b=0,a=this.dataLayers.length;b<a;b++){var c=this.dataLayers[b];c.layer.setVisibility(c.inputElem.checked)}},maximizeControl:function(a){this.div.style.width="";this.div.style.height="";this.showControls(false);if(a!=null){OpenLayers.Event.stop(a)}},minimizeControl:function(a){this.div.style.width="0px";this.div.style.height="0px";this.showControls(true);if(a!=null){OpenLayers.Event.stop(a)}},showControls:function(a){this.maximizeDiv.style.display=a?"":"none";this.minimizeDiv.style.display=a?"none":"";this.layersDiv.style.display=a?"none":""},loadContents:function(){OpenLayers.Event.observe(this.div,"mouseup",OpenLayers.Function.bindAsEventListener(this.mouseUp,this));OpenLayers.Event.observe(this.div,"click",this.ignoreEvent);OpenLayers.Event.observe(this.div,"mousedown",OpenLayers.Function.bindAsEventListener(this.mouseDown,this));OpenLayers.Event.observe(this.div,"dblclick",this.ignoreEvent);this.layersDiv=document.createElement("div");this.layersDiv.id=this.id+"_layersDiv";OpenLayers.Element.addClass(this.layersDiv,"layersDiv");this.baseLbl=document.createElement("div");this.baseLbl.innerHTML=OpenLayers.i18n("baseLayer");OpenLayers.Element.addClass(this.baseLbl,"baseLbl");this.baseLayersDiv=document.createElement("div");OpenLayers.Element.addClass(this.baseLayersDiv,"baseLayersDiv");this.dataLbl=document.createElement("div");this.dataLbl.innerHTML=OpenLayers.i18n("overlays");OpenLayers.Element.addClass(this.dataLbl,"dataLbl");this.dataLayersDiv=document.createElement("div");OpenLayers.Element.addClass(this.dataLayersDiv,"dataLayersDiv");if(this.ascending){this.layersDiv.appendChild(this.baseLbl);this.layersDiv.appendChild(this.baseLayersDiv);this.layersDiv.appendChild(this.dataLbl);this.layersDiv.appendChild(this.dataLayersDiv)}else{this.layersDiv.appendChild(this.dataLbl);this.layersDiv.appendChild(this.dataLayersDiv);this.layersDiv.appendChild(this.baseLbl);this.layersDiv.appendChild(this.baseLayersDiv)}this.div.appendChild(this.layersDiv);if(this.roundedCorner){OpenLayers.Rico.Corner.round(this.div,{corners:"tl bl",bgColor:"transparent",color:this.roundedCornerColor,blend:false});OpenLayers.Rico.Corner.changeOpacity(this.layersDiv,0.75)}var c=OpenLayers.Util.getImagesLocation();var b=new OpenLayers.Size(18,18);var a=c+"layer-switcher-maximize.png";this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MaximizeDiv",null,b,a,"absolute");OpenLayers.Element.addClass(this.maximizeDiv,"maximizeDiv");this.maximizeDiv.style.display="none";OpenLayers.Event.observe(this.maximizeDiv,"click",OpenLayers.Function.bindAsEventListener(this.maximizeControl,this));this.div.appendChild(this.maximizeDiv);var a=c+"layer-switcher-minimize.png";var b=new OpenLayers.Size(18,18);this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MinimizeDiv",null,b,a,"absolute");OpenLayers.Element.addClass(this.minimizeDiv,"minimizeDiv");this.minimizeDiv.style.display="none";OpenLayers.Event.observe(this.minimizeDiv,"click",OpenLayers.Function.bindAsEventListener(this.minimizeControl,this));this.div.appendChild(this.minimizeDiv)},ignoreEvent:function(a){OpenLayers.Event.stop(a)},mouseDown:function(a){this.isMouseDown=true;this.ignoreEvent(a)},mouseUp:function(a){if(this.isMouseDown){this.isMouseDown=false;this.ignoreEvent(a)}},CLASS_NAME:"OpenLayers.Control.LayerSwitcher"});OpenLayers.Control.MouseDefaults=OpenLayers.Class(OpenLayers.Control,{performedDrag:false,wheelObserver:null,initialize:function(){OpenLayers.Control.prototype.initialize.apply(this,arguments)
},destroy:function(){if(this.handler){this.handler.destroy()}this.handler=null;this.map.events.un({click:this.defaultClick,dblclick:this.defaultDblClick,mousedown:this.defaultMouseDown,mouseup:this.defaultMouseUp,mousemove:this.defaultMouseMove,mouseout:this.defaultMouseOut,scope:this});OpenLayers.Event.stopObserving(window,"DOMMouseScroll",this.wheelObserver);OpenLayers.Event.stopObserving(window,"mousewheel",this.wheelObserver);OpenLayers.Event.stopObserving(document,"mousewheel",this.wheelObserver);this.wheelObserver=null;OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){this.map.events.on({click:this.defaultClick,dblclick:this.defaultDblClick,mousedown:this.defaultMouseDown,mouseup:this.defaultMouseUp,mousemove:this.defaultMouseMove,mouseout:this.defaultMouseOut,scope:this});this.registerWheelEvents()},registerWheelEvents:function(){this.wheelObserver=OpenLayers.Function.bindAsEventListener(this.onWheelEvent,this);OpenLayers.Event.observe(window,"DOMMouseScroll",this.wheelObserver);OpenLayers.Event.observe(window,"mousewheel",this.wheelObserver);OpenLayers.Event.observe(document,"mousewheel",this.wheelObserver)},defaultClick:function(b){if(!OpenLayers.Event.isLeftClick(b)){return}var a=!this.performedDrag;this.performedDrag=false;return a},defaultDblClick:function(b){var a=this.map.getLonLatFromViewPortPx(b.xy);this.map.setCenter(a,this.map.zoom+1);OpenLayers.Event.stop(b);return false},defaultMouseDown:function(a){if(!OpenLayers.Event.isLeftClick(a)){return}this.mouseDragStart=a.xy.clone();this.performedDrag=false;if(a.shiftKey){this.map.div.style.cursor="crosshair";this.zoomBox=OpenLayers.Util.createDiv("zoomBox",this.mouseDragStart,null,null,"absolute","2px solid red");this.zoomBox.style.backgroundColor="white";this.zoomBox.style.filter="alpha(opacity=50)";this.zoomBox.style.opacity="0.50";this.zoomBox.style.fontSize="1px";this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1;this.map.viewPortDiv.appendChild(this.zoomBox)}document.onselectstart=OpenLayers.Function.False;OpenLayers.Event.stop(a)},defaultMouseMove:function(e){this.mousePosition=e.xy.clone();if(this.mouseDragStart!=null){if(this.zoomBox){var d=Math.abs(this.mouseDragStart.x-e.xy.x);var b=Math.abs(this.mouseDragStart.y-e.xy.y);this.zoomBox.style.width=Math.max(1,d)+"px";this.zoomBox.style.height=Math.max(1,b)+"px";if(e.xy.x<this.mouseDragStart.x){this.zoomBox.style.left=e.xy.x+"px"}if(e.xy.y<this.mouseDragStart.y){this.zoomBox.style.top=e.xy.y+"px"}}else{var d=this.mouseDragStart.x-e.xy.x;var b=this.mouseDragStart.y-e.xy.y;var f=this.map.getSize();var a=new OpenLayers.Pixel(f.w/2+d,f.h/2+b);var c=this.map.getLonLatFromViewPortPx(a);this.map.setCenter(c,null,true);this.mouseDragStart=e.xy.clone();this.map.div.style.cursor="move"}this.performedDrag=true}},defaultMouseUp:function(a){if(!OpenLayers.Event.isLeftClick(a)){return}if(this.zoomBox){this.zoomBoxEnd(a)}else{if(this.performedDrag){this.map.setCenter(this.map.center)}}document.onselectstart=null;this.mouseDragStart=null;this.map.div.style.cursor=""},defaultMouseOut:function(a){if(this.mouseDragStart!=null&&OpenLayers.Util.mouseLeft(a,this.map.div)){if(this.zoomBox){this.removeZoomBox()}this.mouseDragStart=null}},defaultWheelUp:function(a){if(this.map.getZoom()<=this.map.getNumZoomLevels()){this.map.setCenter(this.map.getLonLatFromPixel(a.xy),this.map.getZoom()+1)}},defaultWheelDown:function(a){if(this.map.getZoom()>0){this.map.setCenter(this.map.getLonLatFromPixel(a.xy),this.map.getZoom()-1)}},zoomBoxEnd:function(b){if(this.mouseDragStart!=null){if(Math.abs(this.mouseDragStart.x-b.xy.x)>5||Math.abs(this.mouseDragStart.y-b.xy.y)>5){var h=this.map.getLonLatFromViewPortPx(this.mouseDragStart);var a=this.map.getLonLatFromViewPortPx(b.xy);var g=Math.max(h.lat,a.lat);var c=Math.min(h.lat,a.lat);var f=Math.min(h.lon,a.lon);var d=Math.max(h.lon,a.lon);var e=new OpenLayers.Bounds(f,c,d,g);this.map.zoomToExtent(e)}else{var a=this.map.getLonLatFromViewPortPx(b.xy);this.map.setCenter(new OpenLayers.LonLat((a.lon),(a.lat)),this.map.getZoom()+1)
}this.removeZoomBox()}},removeZoomBox:function(){this.map.viewPortDiv.removeChild(this.zoomBox);this.zoomBox=null},onWheelEvent:function(c){var b=false;var a=OpenLayers.Event.element(c);while(a!=null){if(this.map&&a==this.map.div){b=true;break}a=a.parentNode}if(b){var d=0;if(!c){c=window.event}if(c.wheelDelta){d=c.wheelDelta/120;if(window.opera&&window.opera.version()<9.2){d=-d}}else{if(c.detail){d=-c.detail/3}}if(d){c.xy=this.mousePosition;if(d<0){this.defaultWheelDown(c)}else{this.defaultWheelUp(c)}}OpenLayers.Event.stop(c)}},CLASS_NAME:"OpenLayers.Control.MouseDefaults"});OpenLayers.Control.MousePosition=OpenLayers.Class(OpenLayers.Control,{autoActivate:true,element:null,prefix:"",separator:", ",suffix:"",numDigits:5,granularity:10,emptyString:null,lastXy:null,displayProjection:null,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate();OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){if(OpenLayers.Control.prototype.activate.apply(this,arguments)){this.map.events.register("mousemove",this,this.redraw);this.map.events.register("mouseout",this,this.reset);this.redraw();return true}else{return false}},deactivate:function(){if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){this.map.events.unregister("mousemove",this,this.redraw);this.map.events.unregister("mouseout",this,this.reset);this.element.innerHTML="";return true}else{return false}},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.element){this.div.left="";this.div.top="";this.element=this.div}return this.div},redraw:function(a){var c;if(a==null){this.reset();return}else{if(this.lastXy==null||Math.abs(a.xy.x-this.lastXy.x)>this.granularity||Math.abs(a.xy.y-this.lastXy.y)>this.granularity){this.lastXy=a.xy;return}c=this.map.getLonLatFromPixel(a.xy);if(!c){return}if(this.displayProjection){c.transform(this.map.getProjectionObject(),this.displayProjection)}this.lastXy=a.xy}var b=this.formatOutput(c);if(b!=this.element.innerHTML){this.element.innerHTML=b}},reset:function(a){if(this.emptyString!=null){this.element.innerHTML=this.emptyString}},formatOutput:function(b){var c=parseInt(this.numDigits);var a=this.prefix+b.lon.toFixed(c)+this.separator+b.lat.toFixed(c)+this.suffix;return a},CLASS_NAME:"OpenLayers.Control.MousePosition"});OpenLayers.Control.Pan=OpenLayers.Class(OpenLayers.Control,{slideFactor:50,direction:null,type:OpenLayers.Control.TYPE_BUTTON,initialize:function(b,a){this.direction=b;this.CLASS_NAME+=this.direction;OpenLayers.Control.prototype.initialize.apply(this,[a])},trigger:function(){switch(this.direction){case OpenLayers.Control.Pan.NORTH:this.map.pan(0,-this.slideFactor);break;case OpenLayers.Control.Pan.SOUTH:this.map.pan(0,this.slideFactor);break;case OpenLayers.Control.Pan.WEST:this.map.pan(-this.slideFactor,0);break;case OpenLayers.Control.Pan.EAST:this.map.pan(this.slideFactor,0);break}},CLASS_NAME:"OpenLayers.Control.Pan"});OpenLayers.Control.Pan.NORTH="North";OpenLayers.Control.Pan.SOUTH="South";OpenLayers.Control.Pan.EAST="East";OpenLayers.Control.Pan.WEST="West";OpenLayers.Control.PanZoom=OpenLayers.Class(OpenLayers.Control,{slideFactor:50,slideRatio:null,buttons:null,position:null,initialize:function(a){this.position=new OpenLayers.Pixel(OpenLayers.Control.PanZoom.X,OpenLayers.Control.PanZoom.Y);OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){OpenLayers.Control.prototype.destroy.apply(this,arguments);this.removeButtons();this.buttons=null;this.position=null},draw:function(b){OpenLayers.Control.prototype.draw.apply(this,arguments);b=this.position;this.buttons=[];var c=new OpenLayers.Size(18,18);var a=new OpenLayers.Pixel(b.x+c.w/2,b.y);this._addButton("panup","north-mini.png",a,c);b.y=a.y+c.h;this._addButton("panleft","west-mini.png",b,c);this._addButton("panright","east-mini.png",b.add(c.w,0),c);this._addButton("pandown","south-mini.png",a.add(0,c.h*2),c);this._addButton("zoomin","zoom-plus-mini.png",a.add(0,c.h*3+5),c);
this._addButton("zoomworld","zoom-world-mini.png",a.add(0,c.h*4+5),c);this._addButton("zoomout","zoom-minus-mini.png",a.add(0,c.h*5+5),c);return this.div},_addButton:function(a,d,i,g){var f=OpenLayers.Util.getImagesLocation()+d;var b=OpenLayers.Util.createAlphaImageDiv(this.id+"_"+a,i,g,f,"absolute");this.div.appendChild(b);OpenLayers.Event.observe(b,"mousedown",OpenLayers.Function.bindAsEventListener(this.buttonDown,b));OpenLayers.Event.observe(b,"dblclick",OpenLayers.Function.bindAsEventListener(this.doubleClick,b));OpenLayers.Event.observe(b,"click",OpenLayers.Function.bindAsEventListener(this.doubleClick,b));b.action=a;b.map=this.map;if(!this.slideRatio){var c=this.slideFactor;var e=function(){return c}}else{var h=this.slideRatio;var e=function(j){return this.map.getSize()[j]*h}}b.getSlideFactor=e;this.buttons.push(b);return b},_removeButton:function(a){OpenLayers.Event.stopObservingElement(a);a.map=null;a.getSlideFactor=null;this.div.removeChild(a);OpenLayers.Util.removeItem(this.buttons,a)},removeButtons:function(){for(var a=this.buttons.length-1;a>=0;--a){this._removeButton(this.buttons[a])}},doubleClick:function(a){OpenLayers.Event.stop(a);return false},buttonDown:function(a){if(!OpenLayers.Event.isLeftClick(a)){return}switch(this.action){case"panup":this.map.pan(0,-this.getSlideFactor("h"));break;case"pandown":this.map.pan(0,this.getSlideFactor("h"));break;case"panleft":this.map.pan(-this.getSlideFactor("w"),0);break;case"panright":this.map.pan(this.getSlideFactor("w"),0);break;case"zoomin":this.map.zoomIn();break;case"zoomout":this.map.zoomOut();break;case"zoomworld":this.map.zoomToMaxExtent();break}OpenLayers.Event.stop(a)},CLASS_NAME:"OpenLayers.Control.PanZoom"});OpenLayers.Control.PanZoom.X=4;OpenLayers.Control.PanZoom.Y=4;OpenLayers.Control.Panel=OpenLayers.Class(OpenLayers.Control,{controls:null,autoActivate:true,defaultControl:null,saveState:false,activeState:null,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,[a]);this.controls=[];this.activeState={}},destroy:function(){OpenLayers.Control.prototype.destroy.apply(this,arguments);for(var a=this.controls.length-1;a>=0;a--){if(this.controls[a].events){this.controls[a].events.un({activate:this.redraw,deactivate:this.redraw,scope:this})}OpenLayers.Event.stopObservingElement(this.controls[a].panel_div);this.controls[a].panel_div=null}this.activeState=null},activate:function(){if(OpenLayers.Control.prototype.activate.apply(this,arguments)){var c;for(var b=0,a=this.controls.length;b<a;b++){c=this.controls[b];if(c===this.defaultControl||(this.saveState&&this.activeState[c.id])){c.activate()}}if(this.saveState===true){this.defaultControl=null}this.redraw();return true}else{return false}},deactivate:function(){if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){var c;for(var b=0,a=this.controls.length;b<a;b++){c=this.controls[b];this.activeState[c.id]=c.deactivate()}return true}else{return false}},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.addControlsToMap(this.controls);return this.div},redraw:function(){if(this.div.children.length>0){for(var b=this.div.children.length,d=b-1;d>=0;d--){this.div.removeChild(this.div.children[d])}}this.div.innerHTML="";if(this.active){for(var d=0,a=this.controls.length;d<a;d++){var c=this.controls[d].panel_div;if(this.controls[d].active){c.className=this.controls[d].displayClass+"ItemActive"}else{c.className=this.controls[d].displayClass+"ItemInactive"}this.div.appendChild(c)}}},activateControl:function(d){if(!this.active){return false}if(d.type==OpenLayers.Control.TYPE_BUTTON){d.trigger();this.redraw();return}if(d.type==OpenLayers.Control.TYPE_TOGGLE){if(d.active){d.deactivate()}else{d.activate()}this.redraw();return}var e;for(var b=0,a=this.controls.length;b<a;b++){e=this.controls[b];if(e!=d&&(e.type===OpenLayers.Control.TYPE_TOOL||e.type==null)){e.deactivate()}}d.activate()},addControls:function(b){if(!(b instanceof Array)){b=[b]}this.controls=this.controls.concat(b);
for(var d=0,a=b.length;d<a;d++){var c=document.createElement("div");b[d].panel_div=c;if(b[d].title!=""){b[d].panel_div.title=b[d].title}OpenLayers.Event.observe(b[d].panel_div,"click",OpenLayers.Function.bind(this.onClick,this,b[d]));OpenLayers.Event.observe(b[d].panel_div,"dblclick",OpenLayers.Function.bind(this.onDoubleClick,this,b[d]));OpenLayers.Event.observe(b[d].panel_div,"mousedown",OpenLayers.Function.bindAsEventListener(OpenLayers.Event.stop))}if(this.map){this.addControlsToMap(b);this.redraw()}},addControlsToMap:function(b){var d;for(var c=0,a=b.length;c<a;c++){d=b[c];if(d.autoActivate===true){d.autoActivate=false;this.map.addControl(d);d.autoActivate=true}else{this.map.addControl(d);d.deactivate()}d.events.on({activate:this.redraw,deactivate:this.redraw,scope:this})}},onClick:function(b,a){OpenLayers.Event.stop(a?a:window.event);this.activateControl(b)},onDoubleClick:function(b,a){OpenLayers.Event.stop(a?a:window.event)},getControlsBy:function(c,a){var d=(typeof a.test=="function");var b=OpenLayers.Array.filter(this.controls,function(e){return e[c]==a||(d&&a.test(e[c]))});return b},getControlsByName:function(a){return this.getControlsBy("name",a)},getControlsByClass:function(a){return this.getControlsBy("CLASS_NAME",a)},CLASS_NAME:"OpenLayers.Control.Panel"});OpenLayers.Control.Scale=OpenLayers.Class(OpenLayers.Control,{element:null,geodesic:false,initialize:function(b,a){OpenLayers.Control.prototype.initialize.apply(this,[a]);this.element=OpenLayers.Util.getElement(b)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.element){this.element=document.createElement("div");this.div.appendChild(this.element)}this.map.events.register("moveend",this,this.updateScale);this.updateScale();return this.div},updateScale:function(){var c;if(this.geodesic===true){var a=this.map.getUnits();if(!a){return}var b=OpenLayers.INCHES_PER_UNIT;c=(this.map.getGeodesicPixelSize().w||0.000001)*b.km*OpenLayers.DOTS_PER_INCH}else{c=this.map.getScale()}if(!c){return}if(c>=9500&&c<=950000){c=Math.round(c/1000)+"K"}else{if(c>=950000){c=Math.round(c/1000000)+"M"}else{c=Math.round(c)}}this.element.innerHTML=OpenLayers.i18n("scale",{scaleDenom:c})},CLASS_NAME:"OpenLayers.Control.Scale"});OpenLayers.Control.ScaleLine=OpenLayers.Class(OpenLayers.Control,{maxWidth:100,topOutUnits:"km",topInUnits:"m",bottomOutUnits:"mi",bottomInUnits:"ft",eTop:null,eBottom:null,geodesic:false,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,[a])},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.eTop){this.eTop=document.createElement("div");this.eTop.className=this.displayClass+"Top";var a=this.topInUnits.length;this.div.appendChild(this.eTop);if((this.topOutUnits=="")||(this.topInUnits=="")){this.eTop.style.visibility="hidden"}else{this.eTop.style.visibility="visible"}this.eBottom=document.createElement("div");this.eBottom.className=this.displayClass+"Bottom";this.div.appendChild(this.eBottom);if((this.bottomOutUnits=="")||(this.bottomInUnits=="")){this.eBottom.style.visibility="hidden"}else{this.eBottom.style.visibility="visible"}}this.map.events.register("moveend",this,this.update);this.update();return this.div},getBarLen:function(b){var d=parseInt(Math.log(b)/Math.log(10));var a=Math.pow(10,d);var c=parseInt(b/a);var e;if(c>5){e=5}else{if(c>2){e=2}else{e=1}}return e*a},update:function(){var j=this.map.getResolution();if(!j){return}var o=this.map.getUnits();var e=OpenLayers.INCHES_PER_UNIT;var l=this.maxWidth*j*e[o];var n=1;if(this.geodesic===true){var b=(this.map.getGeodesicPixelSize().w||0.000001)*this.maxWidth;var f=l/e.km;n=b/f;l*=n}var a;var d;if(l>100000){a=this.topOutUnits;d=this.bottomOutUnits}else{a=this.topInUnits;d=this.bottomInUnits}var h=l/e[a];var k=l/e[d];var i=this.getBarLen(h);var g=this.getBarLen(k);h=i/e[o]*e[a];k=g/e[o]*e[d];var c=h/j/n;var m=k/j/n;if(this.eBottom.style.visibility=="visible"){this.eBottom.style.width=Math.round(m)+"px";this.eBottom.innerHTML=g+" "+d
}if(this.eTop.style.visibility=="visible"){this.eTop.style.width=Math.round(c)+"px";this.eTop.innerHTML=i+" "+a}},CLASS_NAME:"OpenLayers.Control.ScaleLine"});OpenLayers.Control.ZoomIn=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){this.map.zoomIn()},CLASS_NAME:"OpenLayers.Control.ZoomIn"});OpenLayers.Control.ZoomOut=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){this.map.zoomOut()},CLASS_NAME:"OpenLayers.Control.ZoomOut"});OpenLayers.Control.ZoomToMaxExtent=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){if(this.map){this.map.zoomToMaxExtent()}},CLASS_NAME:"OpenLayers.Control.ZoomToMaxExtent"});OpenLayers.Event={observers:false,KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,element:function(a){return a.target||a.srcElement},isLeftClick:function(a){return(((a.which)&&(a.which==1))||((a.button)&&(a.button==1)))},isRightClick:function(a){return(((a.which)&&(a.which==3))||((a.button)&&(a.button==2)))},stop:function(b,a){if(!a){if(b.preventDefault){b.preventDefault()}else{b.returnValue=false}}if(b.stopPropagation){b.stopPropagation()}else{b.cancelBubble=true}},findElement:function(c,b){var a=OpenLayers.Event.element(c);while(a.parentNode&&(!a.tagName||(a.tagName.toUpperCase()!=b.toUpperCase()))){a=a.parentNode}return a},observe:function(b,d,c,a){var e=OpenLayers.Util.getElement(b);a=a||false;if(d=="keypress"&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||e.attachEvent)){d="keydown"}if(!this.observers){this.observers={}}if(!e._eventCacheID){var f="eventCacheID_";if(e.id){f=e.id+"_"+f}e._eventCacheID=OpenLayers.Util.createUniqueID(f)}var g=e._eventCacheID;if(!this.observers[g]){this.observers[g]=[]}this.observers[g].push({element:e,name:d,observer:c,useCapture:a});if(e.addEventListener){e.addEventListener(d,c,a)}else{if(e.attachEvent){e.attachEvent("on"+d,c)}}},stopObservingElement:function(a){var b=OpenLayers.Util.getElement(a);var c=b._eventCacheID;this._removeElementObservers(OpenLayers.Event.observers[c])},_removeElementObservers:function(e){if(e){for(var b=e.length-1;b>=0;b--){var c=e[b];var a=new Array(c.element,c.name,c.observer,c.useCapture);var d=OpenLayers.Event.stopObserving.apply(this,a)}}},stopObserving:function(h,a,g,b){b=b||false;var f=OpenLayers.Util.getElement(h);var d=f._eventCacheID;if(a=="keypress"){if(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||f.detachEvent){a="keydown"}}var k=false;var c=OpenLayers.Event.observers[d];if(c){var e=0;while(!k&&e<c.length){var j=c[e];if((j.name==a)&&(j.observer==g)&&(j.useCapture==b)){c.splice(e,1);if(c.length==0){delete OpenLayers.Event.observers[d]}k=true;break}e++}}if(k){if(f.removeEventListener){f.removeEventListener(a,g,b)}else{if(f&&f.detachEvent){f.detachEvent("on"+a,g)}}}return k},unloadCache:function(){if(OpenLayers.Event&&OpenLayers.Event.observers){for(var a in OpenLayers.Event.observers){var b=OpenLayers.Event.observers[a];OpenLayers.Event._removeElementObservers.apply(this,[b])}OpenLayers.Event.observers=false}},CLASS_NAME:"OpenLayers.Event"};OpenLayers.Event.observe(window,"unload",OpenLayers.Event.unloadCache,false);if(window.Event){OpenLayers.Util.applyDefaults(window.Event,OpenLayers.Event)}else{var Event=OpenLayers.Event}OpenLayers.Events=OpenLayers.Class({BROWSER_EVENTS:["mouseover","mouseout","mousedown","mouseup","mousemove","click","dblclick","rightclick","dblrightclick","resize","focus","blur"],listeners:null,object:null,element:null,eventTypes:null,eventHandler:null,fallThrough:null,includeXY:false,clearMouseListener:null,initialize:function(c,e,g,f,b){OpenLayers.Util.extend(this,b);this.object=c;this.fallThrough=f;this.listeners={};this.eventHandler=OpenLayers.Function.bindAsEventListener(this.handleBrowserEvent,this);this.clearMouseListener=OpenLayers.Function.bind(this.clearMouseCache,this);this.eventTypes=[];if(g!=null){for(var d=0,a=g.length;
d<a;d++){this.addEventType(g[d])}}if(e!=null){this.attachToElement(e)}},destroy:function(){if(this.element){OpenLayers.Event.stopObservingElement(this.element);if(this.element.hasScrollEvent){OpenLayers.Event.stopObserving(window,"scroll",this.clearMouseListener)}}this.element=null;this.listeners=null;this.object=null;this.eventTypes=null;this.fallThrough=null;this.eventHandler=null},addEventType:function(a){if(!this.listeners[a]){this.eventTypes.push(a);this.listeners[a]=[]}},attachToElement:function(d){if(this.element){OpenLayers.Event.stopObservingElement(this.element)}this.element=d;for(var c=0,a=this.BROWSER_EVENTS.length;c<a;c++){var b=this.BROWSER_EVENTS[c];this.addEventType(b);OpenLayers.Event.observe(d,b,this.eventHandler)}OpenLayers.Event.observe(d,"dragstart",OpenLayers.Event.stop)},on:function(a){for(var b in a){if(b!="scope"){this.register(b,a.scope,a[b])}}},register:function(b,d,c){if((c!=null)&&(OpenLayers.Util.indexOf(this.eventTypes,b)!=-1)){if(d==null){d=this.object}var a=this.listeners[b];a.push({obj:d,func:c})}},registerPriority:function(b,d,c){if(c!=null){if(d==null){d=this.object}var a=this.listeners[b];if(a!=null){a.unshift({obj:d,func:c})}}},un:function(a){for(var b in a){if(b!="scope"){this.unregister(b,a.scope,a[b])}}},unregister:function(d,f,e){if(f==null){f=this.object}var c=this.listeners[d];if(c!=null){for(var b=0,a=c.length;b<a;b++){if(c[b].obj==f&&c[b].func==e){c.splice(b,1);break}}}},remove:function(a){if(this.listeners[a]!=null){this.listeners[a]=[]}},triggerEvent:function(e,b){var d=this.listeners[e];if(!d||d.length==0){return}if(b==null){b={}}b.object=this.object;b.element=this.element;if(!b.type){b.type=e}var d=d.slice(),f;for(var c=0,a=d.length;c<a;c++){var g=d[c];f=g.func.apply(g.obj,[b]);if((f!=undefined)&&(f==false)){break}}if(!this.fallThrough){OpenLayers.Event.stop(b,true)}return f},handleBrowserEvent:function(a){if(this.includeXY){a.xy=this.getMousePosition(a)}this.triggerEvent(a.type,a)},clearMouseCache:function(){this.element.scrolls=null;this.element.lefttop=null;this.element.offsets=null},getMousePosition:function(a){if(!this.includeXY){this.clearMouseCache()}else{if(!this.element.hasScrollEvent){OpenLayers.Event.observe(window,"scroll",this.clearMouseListener);this.element.hasScrollEvent=true}}if(!this.element.scrolls){this.element.scrolls=[(document.documentElement.scrollLeft||document.body.scrollLeft),(document.documentElement.scrollTop||document.body.scrollTop)]}if(!this.element.lefttop){this.element.lefttop=[(document.documentElement.clientLeft||0),(document.documentElement.clientTop||0)]}if(!this.element.offsets){this.element.offsets=OpenLayers.Util.pagePosition(this.element);this.element.offsets[0]+=this.element.scrolls[0];this.element.offsets[1]+=this.element.scrolls[1]}return new OpenLayers.Pixel((a.clientX+this.element.scrolls[0])-this.element.offsets[0]-this.element.lefttop[0],(a.clientY+this.element.scrolls[1])-this.element.offsets[1]-this.element.lefttop[1])},CLASS_NAME:"OpenLayers.Events"});OpenLayers.Format=OpenLayers.Class({options:null,externalProjection:null,internalProjection:null,data:null,keepData:false,initialize:function(a){OpenLayers.Util.extend(this,a);this.options=a},destroy:function(){},read:function(a){OpenLayers.Console.userError(OpenLayers.i18n("readNotImplemented"))},write:function(a){OpenLayers.Console.userError(OpenLayers.i18n("writeNotImplemented"))},CLASS_NAME:"OpenLayers.Format"});OpenLayers.Lang.ar=OpenLayers.Util.applyDefaults({permalink:" ",baseLayer:" ",readNotImplemented:"  .",writeNotImplemented:"  ",errorLoadingGML:"       ${url}",scale:" = 1 : ${scaleDenom}",W:"",E:"",N:"",S:""});OpenLayers.Lang["be-tarask"]=OpenLayers.Util.applyDefaults({unhandledRequest:"   ${statusText}",permalink:" ",overlays:"",baseLayer:" ",sameProjection:"         ,    ",readNotImplemented:"   .",writeNotImplemented:"   .",noFID:"  ,     FID.",errorLoadingGML:"   GML ${url}",browserNotSupported:"     .    : ${renderers}",componentShouldBe:"addFeatures :    ${geomType}",getFeatureError:"getFeatureFromEvent     .   ,    ,      .",minZoomLevelError:" minZoomLevel         FixedZoomLevels. ,    wfs-   minZoomLevel   .       ,         OL .   ,  minZoomLevel     3.0.  ,     / ,   : http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"WFS-:  ${response}",commitFailed:"WFS-:  ${response}",googleWarning:"    Google. \x3cbr\x3e\x3cbr\x3e   ,          .\x3cbr\x3e\x3cbr\x3e   ,   ,    Google Maps        API-   .\x3cbr\x3e\x3cbr\x3e:  ,     ,   , \x3ca href='http://trac.openlayers.org/wiki/Google' target='_blank'\x3e \x3c/a\x3e",getLayerWarning:"   ${layerType}.\x3cbr\x3e\x3cbr\x3e   ,          .\x3cbr\x3e\x3cbr\x3e  ,   ,    ${layerLib}    .\x3cbr\x3e\x3cbr\x3e:  ,     ,   , \x3ca href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'\x3e \x3c/a\x3e",scale:" = 1 : ${scaleDenom}",W:"",E:"",N:"",S:"",layerAlreadyAdded:"    ${layerName}  ,    ",reprojectDeprecated:"   'reproject'   ${layerName}.    :          ,           .     http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"        3.0.  ,    ${newMethod}.",boundsAddError:"     x  y   .",lonlatAddError:"     lon  lat   .",pixelAddError:"     x  y   .",unsupportedGeometryType:"   : ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition failed:     ${elemId}   .",filterEvaluateNotImplemented:"evaluate      ."});
OpenLayers.Lang.bg=OpenLayers.Util.applyDefaults({permalink:" ",baseLayer:" ",errorLoadingGML:"    GML  ${url}",scale:" = 1 : ${scaleDenom}",layerAlreadyAdded:"    ${layerName}  ,     ",methodDeprecated:"         3.0.    ${newMethod}."});OpenLayers.Lang.br=OpenLayers.Util.applyDefaults({unhandledRequest:"Distro evel reked anveret ${statusText}",permalink:"Peurliamm",overlays:"Gwiskado",baseLayer:"Gwiskad diazez",sameProjection:"Ne'z ar gartenn lec'hia en-dro nemet pa vez hevel ar banndres anezhi ha hini ar gartenn benna",readNotImplemented:"N'eo ket emplementet al lenn.",writeNotImplemented:"N'eo ket emplementet ar skriva.",noFID:"N'haller ket hizivaat un elfenn ma n'eus ket a niverenn-anaout (FID) eviti.",errorLoadingGML:"Fazi e-ser karga ar restr GML ${url}",browserNotSupported:"N'eo ket skoret an daskor vektorel gant ho merdeer. Setu aze an daskorerio skoret evit ar poent :\n${renderers}",componentShouldBe:"addFeatures : bez' e tlefe ar parzh besa eus ar seurt ${geomType}",getFeatureError:"Galvet eo bet getFeatureFromEvent called war ur gwiskad hep daskorer. Kement-se a dalvez ez eus bet freuzet ur gwiskad hag hoc'h eus miret un embreger bennak stag outa.",minZoomLevelError:"Ne zleer implijout ar perzh minZoomLevel nemet evit gwiskado FixedZoomLevels-descendent. Ar fed ma wiria ar gwiskad WHS-se hag-e ez eus eus minZoomLevel zo un aspadenn gozh. Koulskoude n'omp ket evit e ziverka kuit da derri arloado diazezet war OL a c'hallfe beza stag outa. Setu perak eo dispredet -- Lamet kuit e vo ar gwiria minZoomLevel a-is er stumm 3.0. Ober gant an arventenno bihana/brasa evel deskrivet ama e plas : http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"Treuzgread WFS : MAT EO ${response}",commitFailed:"Treuzgread WFS Transaction: C'HWITET ${response}",googleWarning:"N'eus ket bet gallet karga ar gwiskad Google ent reizh.\x3cbr\x3e\x3cbr\x3eEvit en em zizober eus ar c'hemenn-ma, dibabit ur BaseLayer nevez en diuzer gwiskado er c'horn deho el laez.\x3cbr\x3e\x3cbr\x3eSur a-walc'h eo peogwir n'eo ket bet ensoc'het levraoueg Google Maps pe neuze ne glot ket an alc'hwez API gant ho lec'hienn.\x3cbr\x3e\x3cbr\x3eDiorroerien : Evit reizha an dra-se, \x3ca href='http://trac.openlayers.org/wiki/Google' target='_blank'\x3eclick here\x3c/a\x3e",getLayerWarning:"N'haller ket karga ar gwiskad ${layerType} ent reizh.\x3cbr\x3e\x3cbr\x3eEvit en em zizober eus ar c'hemenn-ma, dibabit ur BaseLayer nevez en diuzer gwiskado er c'horn deho el laez.\x3cbr\x3e\x3cbr\x3eSur a-walc'h eo peogwir n'eo ket bet ensoc'het mat al levraoueg ${layerLib}.\x3cbr\x3e\x3cbr\x3eDiorroerien : Evit gouzout penaos reizha an dra-se, \x3ca href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'\x3eclick here\x3c/a\x3e",scale:"Skeul = 1 : ${scaleDenom}",W:"K",E:"R",N:"N",S:"S",layerAlreadyAdded:"Klasket hoc'h eus ouzhpenna ar gwiskad : ${layerName} d'ar gartenn, met ouzhpennet e oa bet c'hoazh",reprojectDeprecated:"Emaoc'h oc'h implijout an dibarzh 'reproject' war ar gwiskad ${layerName}. Dispredet eo an dibarzh-ma : bet eo hag e talveze da ziskwel roadenno war-c'horre kartenno diazez kenwerzhel, un dra hag a c'haller ober brema gant an arc'hwel dre skor banndres boullek Mercator. Muioc'h a ditouro a c'haller da gaout war http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"Dispredet eo an daore-se ha tennet e vo kuit eus ar stumm 3.0. Grit gant ${newMethod} e plas.",boundsAddError:"Rekis eo tremen an div dalvoudenn x ha y d'an arc'hwel add.",lonlatAddError:"Rekis eo tremen an div dalvoudenn hedred ha ledred d'an arc'hwel add.",pixelAddError:"Rekis eo tremen an div dalvoudenn x ha y d'an arc'hwel add.",unsupportedGeometryType:"Seurt mentoniezh anskoret : ${geomType}",pagePositionFailed:"C'hwitet eo OpenLayers.Util.pagePosition : marteze ema lec'hiet fall an elfenn id ${elemId}.",filterEvaluateNotImplemented:"N'eo ket bet emplementet ar prizia evit seurt silo c'hoazh."});
OpenLayers.Lang.el=OpenLayers.Util.applyDefaults({scale:" ~ 1 : ${scaleDenom}"});OpenLayers.Lang.en={unhandledRequest:"Unhandled request return ${statusText}",permalink:"Permalink",overlays:"Overlays",baseLayer:"Base Layer",sameProjection:"The overview map only works when it is in the same projection as the main map",readNotImplemented:"Read not implemented.",writeNotImplemented:"Write not implemented.",noFID:"Can't update a feature for which there is no FID.",errorLoadingGML:"Error in loading GML file ${url}",browserNotSupported:"Your browser does not support vector rendering. Currently supported renderers are:\n${renderers}",componentShouldBe:"addFeatures : component should be an ${geomType}",getFeatureError:"getFeatureFromEvent called on layer with no renderer. This usually means you destroyed a layer, but not some handler which is associated with it.",minZoomLevelError:"The minZoomLevel property is only intended for use with the FixedZoomLevels-descendent layers. That this wfs layer checks for minZoomLevel is a relic of thepast. We cannot, however, remove it without possibly breaking OL based applications that may depend on it. Therefore we are deprecating it -- the minZoomLevel check below will be removed at 3.0. Please instead use min/max resolution setting as described here: http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"WFS Transaction: SUCCESS ${response}",commitFailed:"WFS Transaction: FAILED ${response}",googleWarning:"The Google Layer was unable to load correctly.<br><br>To get rid of this message, select a new BaseLayer in the layer switcher in the upper-right corner.<br><br>Most likely, this is because the Google Maps library script was either not included, or does not contain the correct API key for your site.<br><br>Developers: For help getting this working correctly, <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>click here</a>",getLayerWarning:"The ${layerType} Layer was unable to load correctly.<br><br>To get rid of this message, select a new BaseLayer in the layer switcher in the upper-right corner.<br><br>Most likely, this is because the ${layerLib} library script was not correctly included.<br><br>Developers: For help getting this working correctly, <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>click here</a>",scale:"Scale = 1 : ${scaleDenom}",W:"W",E:"E",N:"N",S:"S",graticule:"Graticule",layerAlreadyAdded:"You tried to add the layer: ${layerName} to the map, but it has already been added",reprojectDeprecated:"You are using the 'reproject' option on the ${layerName} layer. This option is deprecated: its use was designed to support displaying data over commercial basemaps, but that functionality should now be achieved by using Spherical Mercator support. More information is available from http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"This method has been deprecated and will be removed in 3.0. Please use ${newMethod} instead.",boundsAddError:"You must pass both x and y values to the add function.",lonlatAddError:"You must pass both lon and lat values to the add function.",pixelAddError:"You must pass both x and y values to the add function.",unsupportedGeometryType:"Unsupported geometry type: ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition failed: element with id ${elemId} may be misplaced.",filterEvaluateNotImplemented:"evaluate is not implemented for this filter type.",end:""};OpenLayers.Lang.fi=OpenLayers.Util.applyDefaults({permalink:"Ikilinkki",overlays:"Kerrokset",baseLayer:"Peruskerros",sameProjection:"Yleiskuvakarttaa voi kytt vain, kun sill on sama projektio kuin pkartalla.",W:"L",E:"I",N:"P",S:"E"});OpenLayers.Lang.fur=OpenLayers.Util.applyDefaults({permalink:"Leam Permanent",overlays:"Livei parsore",baseLayer:"Livel di base",browserNotSupported:"Il to sgarfadr nol supuarte la renderizazion vetoril. Al moment a son supuartts:\n${renderers}",scale:"Scjale = 1 : ${scaleDenom}",W:"O",E:"E",N:"N",S:"S"});
OpenLayers.Lang.gl=OpenLayers.Util.applyDefaults({unhandledRequest:"Solicitude non xerada; a resposta foi: ${statusText}",permalink:"Ligazn permanente",overlays:"Capas superpostas",baseLayer:"Capa base",sameProjection:"A vista xeral do mapa s funciona cando est na mesma proxeccin c mapa principal",readNotImplemented:"Lectura non implementada.",writeNotImplemented:"Escritura non implementada.",noFID:"Non se pode actualizar a funcionalidade para a que non hai FID.",errorLoadingGML:"Erro ao cargar o ficheiro GML ${url}",browserNotSupported:"O seu navegador non soporta a renderizacin de vectores. Os renderizadores soportados actualmente son:\n${renderers}",componentShouldBe:"addFeatures: o compoente debera ser de tipo ${geomType}",getFeatureError:"getFeatureFromEvent ten sido chamado a unha capa sen renderizador. Isto normalmente significa que destruu unha capa, mais non o executador que est asociado con ela.",minZoomLevelError:"A propiedade minZoomLevel  s para uso conxuntamente coas capas FixedZoomLevels-descendent. O feito de que esa capa wfs verifique o minZoomLevel  unha reliquia do pasado. Non podemos, con todo, eliminala sen a posibilidade de non romper as aplicacins baseadas en OL que poidan depender dela. Por iso a estamos deixando obsoleta (a comprobacin minZoomLevel de embaixo ser eliminada na versin 3.0). Por favor, no canto diso use o axuste de resolucin mn/mx tal e como est descrito aqu: http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"Transaccin WFS: XITO ${response}",commitFailed:"Transaccin WFS: FALLIDA ${response}",googleWarning:"A capa do Google non puido cargarse correctamente.\x3cbr\x3e\x3cbr\x3ePara evitar esta mensaxe, escolla unha nova capa base no seleccionador de capas na marxe superior dereita.\x3cbr\x3e\x3cbr\x3eProbablemente, isto acontece porque a escritura da librara do Google Maps ou ben non foi includa ou ben non contn a clave API correcta para o seu sitio.\x3cbr\x3e\x3cbr\x3eDesenvolvedores: para axudar a facer funcionar isto correctamente, \x3ca href='http://trac.openlayers.org/wiki/Google' target='_blank'\x3epremede aqu\x3c/a\x3e",getLayerWarning:"A capa ${layerType} foi incapaz de cargarse correctamente.\x3cbr\x3e\x3cbr\x3ePara evitar esta mensaxe, escolla unha nova capa base no seleccionador de capas na marxe superior dereita.\x3cbr\x3e\x3cbr\x3eProbablemente, isto acontece porque a escritura da librara ${layerLib} non foi ben includa.\x3cbr\x3e\x3cbr\x3eDesenvolvedores: para axudar a facer funcionar isto correctamente, \x3ca href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'\x3epremede aqu\x3c/a\x3e",scale:"Escala = 1 : ${scaleDenom}",W:"O",E:"L",N:"N",S:"S",layerAlreadyAdded:"Intentou engadir a capa: ${layerName} ao mapa, pero xa fora engadida",reprojectDeprecated:'Est usando a opcin "reproject" na capa ${layerName}. Esta opcin est obsoleta: o seu uso foi deseado para a visualizacin de datos sobre mapas base comerciais, pero esta funcionalidade debera agora ser obtida utilizando a proxeccin Spherical Mercator. Hai dispoible mis informacin en http://trac.openlayers.org/wiki/SphericalMercator.',methodDeprecated:"Este mtodo est obsoleto e ser eliminado na versin 3.0. Por favor, no canto deste use ${newMethod}.",boundsAddError:"Debe achegar os valores x e y  funcin add.",lonlatAddError:"Debe achegar tanto o valor lon coma o lat  funcin add.",pixelAddError:"Debe achegar os valores x e y  funcin add.",unsupportedGeometryType:"Tipo xeomtrico non soportado: ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition fallou: o elemento con id ${elemId} pode non estar na sa posicin.",filterEvaluateNotImplemented:"avaliar non est implementado para este tipo de filtro."});OpenLayers.Lang.gsw=OpenLayers.Util.applyDefaults({unhandledRequest:"Nit behandleti Aafrogsruckmldig ${statusText}",permalink:"Permalink",overlays:"Iberlagerige",baseLayer:"Grundcharte",sameProjection:"D Ibersichts-Charte funktioniert nume, wnn si di glych Projktion brucht wie d Hauptcharte",readNotImplemented:"Lse nit implementiert.",writeNotImplemented:"Schrybe nit implementiert.",noFID:"E Feature, wu s kei FID derfir git, cha nit aktualisiert wre.",errorLoadingGML:"Fhler bim Lade vu dr GML-Datei ${url}",browserNotSupported:"Dyy Browser unterstitzt kei Vektordarstellig. Aktull unterstitzti Renderer:\n${renderers}",componentShouldBe:"addFeatures : Komponnt sott dr Typ ${geomType} syy",getFeatureError:"getFeatureFromEvent isch uf eme Layer ohni Renderer ufgruefe wore. Des heisst normalerwys, ass Du e Layer kaputt gmacht hesch, aber nit dr Handler, wu derzue ghert.",minZoomLevelError:"D minZoomLevel-Eigeschaft isch nume dnk fir d Layer, wu vu dr FixedZoomLevels abstamme. Ass d wfs-Layer minZoomLevel prieft, scih e Relikt us dr Vergangeheit. Mir chenne s aber nit ndere ohni OL_basierti Aawndige villicht kaputt gehn, wu dervu abhnge.  Us dm Grund het die Funktion d Eigeschaft 'deprecated' iberchuu. D minZoomLevel-Priefig unte wird in dr Version 3.0 usegnuu. Bitte verwnd statt dm e min/max-Uflesig wie s do bschriben isch: http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"WFS-Transaktion: ERFOLGRYCH ${response}",commitFailed:"WFS-Transaktion: FHLGSCHLAA ${response}",googleWarning:"Dr Google-Layer het nit korrkt chenne glade wre.\x3cbr\x3e\x3cbr\x3eGo die Mldig nimi z kriege, wehl e andere Hintergrundlayer us em LayerSwitcher im rchte obere Ecke.\x3cbr\x3e\x3cbr\x3eD Fhler git s seli hyfig, wel s Skript vu dr Google-Maps-Bibliothek nit yybunde woren isch oder wel s kei giltige API-Schlissel fir Dyy URL din het.\x3cbr\x3e\x3cbr\x3eEntwickler: Fir Hilf zum korrkte Yybinde vum Google-Layer \x3ca href='http://trac.openlayers.org/wiki/Google' target='_blank'\x3edoo drucke\x3c/a\x3e",getLayerWarning:"Dr ${layerType}-Layer het nit korrkt chenne glade wre.\x3cbr\x3e\x3cbr\x3eGo die Mldig nimi z kriege, wehl e andere Hintergrundlayer us em LayerSwitcher im rchte obere Ecke.\x3cbr\x3e\x3cbr\x3eD Fhler git s seli hyfig, wel s Skript vu dr '${layerLib}'-Bibliothek nit yybunde woren isch oder wel s kei giltige API-Schlissel fir Dyy URL din het.\x3cbr\x3e\x3cbr\x3eEntwickler: Fir Hilf zum korrkte Yybinde vu Layer \x3ca href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'\x3edoo drucke\x3c/a\x3e",scale:"Mastab = 1 : ${scaleDenom}",W:"W",E:"O",N:"N",S:"S",layerAlreadyAdded:"Du hesch versuecht d Layer in d Charte yyzfiege: ${layerName}, aber r isch schoi yygfiegt",reprojectDeprecated:"Du bruchsch d 'reproject'-Option bim ${layerName}-Layer. Die Option isch nimi giltig: si isch aagleit wore go   Date iber kommerzilli Grundcharte lege, aber des sott mer jetz mache mit dr Unterstitzig vu Spherical Mercator. Meh Informatione git s uf http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"Die Methode isch veraltet un wird us dr Version 3.0 usegnuu. Bitte verwbnd statt dm ${newMethod}.",boundsAddError:"Du muesch e x-Wrt un e y-Wrt yygee bi dr Zuefieg-Funktion",lonlatAddError:"Du meusch e Lengi- un e Breiti-Grad yygee bi dr Zuefieg-Funktion.",pixelAddError:"Du muesch x- un y-Wrt aagee bi dr Zuefieg-Funktion.",unsupportedGeometryType:"Nit unterstitze Geometrii-Typ: ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition fhlgschlaa: Elemnt mit ID ${elemId} isch villicht falsch gsetzt.",filterEvaluateNotImplemented:"evaluiere isch nit implemntiert in dm Filtertyp."});
OpenLayers.Lang.hr=OpenLayers.Util.applyDefaults({unhandledRequest:"Nepodrani zahtjev ${statusText}",permalink:"Permalink",overlays:"Overlays",baseLayer:"Osnovna karta",sameProjection:"Pregledna karta radi jedino kao je u istoj projekciji kao i glava karta",readNotImplemented:"itanje nije implementirano.",writeNotImplemented:"Pisanje nije implementirano.",noFID:"Ne mogu aurirati znaajku za koju ne postoji FID.",errorLoadingGML:"Greka u uitavanju GML datoteke ${url}",browserNotSupported:"Va preglednik ne podrava vektorsko renderiranje. Trenutno podrani rendereri su: ${renderers}",componentShouldBe:"addFeatures : komponenta bi trebala biti ${geomType}",getFeatureError:"getFeatureFromEvent je pozvao Layer bez renderera. Ovo obino znai da ste unitiili Layer, a ne neki Handler koji je povezan s njim.",commitSuccess:"WFS Transakcija: USPJENA ${response}",commitFailed:"WFS Transakcija: NEUSPJENA ${response}",scale:"Mjerilo = 1 : ${scaleDenom}",layerAlreadyAdded:"Pokuali ste dodati layer:  ${layerName} na kartu, ali je ve dodan",methodDeprecated:"Ova metoda nije odobrena i biti e maknuta u 3.0. Koristite ${newMethod}.",boundsAddError:"Morate dati obje vrijednosti ,  x i y  da bi dodali funkciju.",lonlatAddError:"Morate dati obje vrijednosti , (lon i lat) da bi dodali funkciju.",pixelAddError:"Morate dati obje vrijednosti ,  x i y  da bi dodali funkciju.",unsupportedGeometryType:"Nepodrani tip geometrije: ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition nije uspjelo: element sa id ${elemId} moe biti krivo smjeten."});OpenLayers.Lang.hsb=OpenLayers.Util.applyDefaults({unhandledRequest:"Wotmowa njewobdaneho napraowanja ${statusText}",permalink:"Trajny wotkaz",overlays:"Nawortowanja",baseLayer:"Zakadna runina",sameProjection:"Pehladowa karta jeno funguje, hdy je w samsnej projekciji ka howna karta",readNotImplemented:"itanje njeimplementowane.",writeNotImplemented:"Pisanje njeimplementowane.",noFID:"Funkcija, za kotru FID njeje, njeda so aktualizowa.",errorLoadingGML:"Zmylk pi zaitowanju dataje ${url}",browserNotSupported:"Twj wobhladowak wektorowe rysowanje njepodpruje. Tuchwilu podprowane rysowaki su:\n${renderers}",componentShouldBe:"addFeatures: komponenta ma ${geomType} by",getFeatureError:"getFeatureFromEvent bu na wore bjez rysowak zawoany. To zwjeta woznamjenja, zo sy wortu znii, ale nic wobdak, kotry je z njej zwjazany.",minZoomLevelError:"Kajkos minZoomLevel je jeno za wuiwanje z wortami myslena, kotre wot FixedZoomLevels pochadeja. Zo tuta worta wfs za minZoomLevel pepruwuje, je relikt zadenose. Njememy wak ju wotstroni, bjeztoho zo aplikacije, kotre na OpenLayers bazruja a snano tutu kajkos wuiwaja, hio njefunguja. Tohodla smy ju jako zestarjenu woznamjenili -- pepruwowanje za minZoomLevel budu so we wersiji 3.0 wotstronje. Prou wuij msto toho nastajenje min/max, ka je tu wopisane: http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"WFS-Transakcija: WUSPNA ${response}",commitFailed:"WFS-Transakcija: NJEPORADENA ${response}",googleWarning:"Worta Google njemee so korektnje zaita.\x3cbr\x3e\x3cbr\x3eZo by tutu zdlenku wotby, wubjer nowy BaseLayer z wubra wortow horjeka naprawo.\x3cbr\x3e\x3cbr\x3eNajskerje so to stawa, dokel skript biblioteki Google Maps pak njebu zapijaty pak njewobsahuje korektny klu API za twoje sydo.\x3cbr\x3e\x3cbr\x3eWuwiwarjo: Za pomoc ke korektnemu fungowanju wortow\n\x3ca href='http://trac.openlayers.org/wiki/Google' target='_blank'\x3etu klikny\x3c/a\x3e",getLayerWarning:"Worta ${layerType} njemee so korektnje zaita.\x3cbr\x3e\x3cbr\x3eZo by tutu zdlenku wotby, wubjer nowy BaseLayer z wubra wortow horjeka naprawo.\x3cbr\x3e\x3cbr\x3eNajskerje so to stawa, dokel skript biblioteki ${layerLib} njebu korektnje zapijaty.\x3cbr\x3e\x3cbr\x3eWuwiwarjo: Za pomoc ke korektnemu fungowanju wortow\n\x3ca href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'\x3etu klikny\x3c/a\x3e",scale:"Mritko = 1 : ${scaleDenom}",W:"Z",E:"W",N:"S",S:"J",layerAlreadyAdded:"Sy spyta runinu ${layerName} kare doda, ale je so hio dodaa",reprojectDeprecated:'Wuiwa opciju "reproject" woty ${layerName}. Tuta opcija je zestarjena: jeje wuiwanje b myslene, zo by zwobraznjenje datow nad komercielnymi bazowymi kartami podprao, ale funkcionalnos ma so ntko z pomocu Sperical Mercator docp. Dale informacije steja na http://trac.openlayers.org/wiki/SphericalMercator k dispoziciji.',methodDeprecated:"Tuta metoda je so njeschwalia a bude so w 3.0 wotstronje. Prou wuij ${newMethod} msto toho.",boundsAddError:'Dyrbi hdnotu x ka te y funkciji "add" pepoda.',lonlatAddError:'Dyrbi hdnotu lon ka te lat funkciji "add" pepoda.',pixelAddError:'Dyrbi hdnotu x ka te y funkciji "add" pepoda.',unsupportedGeometryType:"Njepodprowany geometrijowy typ: ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition je so njeporadi: element z id ${elemId} bu snano wopak zamstnjeny.",filterEvaluateNotImplemented:"wuhdnoenje njeje za tutn filtrowy typ implementowany."});
OpenLayers.Lang.hu=OpenLayers.Util.applyDefaults({unhandledRequest:"Nem kezelt krs visszatrse ${statusText}",permalink:"Permalink",overlays:"Rvettsek",baseLayer:"Alaprteg",sameProjection:"Az ttekint trkp csak abban az esetben mkdik, ha ugyanazon a vetleten van, mint a f trkp.",readNotImplemented:"Olvass nincs vgrehajtva.",writeNotImplemented:"rs nincs vgrehajtva.",noFID:"Nem frissthet olyan jellemz, amely nem rendelkezik FID-del.",errorLoadingGML:"Hiba GML-fjl betltsekor ${url}",browserNotSupported:"A bngszje nem tmogatja a vektoros renderelst. A jelenleg tmogatott renderelk:\n${renderers}",componentShouldBe:"addFeatures : az sszetevnek ilyen tpusnak kell lennie: ${geomType}",getFeatureError:"getFeatureFromEvent rteget hvott meg renderel nlkl. Ez rendszerint azt jelenti, hogy megsemmistett egy flit, de nhny ahhoz trstott kezelt nem.",minZoomLevelError:"A minZoomLevel tulajdonsgot csak a kvetkezvel val hasznlatra szntk: FixedZoomLevels-leszrmazott flik. Ez azt jelenti, hogy a minZoomLevel wfs flia jellngyzetei mr a mlt. Mi azonban nem tvolthatjuk el annak a veszlye nlkl, hogy az esetlegesen ettl fgg OL alap alkalmazsokat tnkretennnk. Ezrt ezt rvnytelentjk -- a minZoomLevel az alul lev jellngyzet a 3.0-s verzibl el lesz tvoltva. Krjk, helyette hasznlja a  min/max felbonts belltst, amelyrl az albbi helyen tall lerst: http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"WFS tranzakci: SIKERES ${response}",commitFailed:"WFS tranzakci: SIKERTELEN ${response}",googleWarning:"A Google flia betltse sikertelen.\x3cbr\x3e\x3cbr\x3eAhhoz, hogy ez az zenet eltnjn, vlasszon egy j BaseLayer flit a jobb fels sarokban tallhat fliakapcsol segtsgvel.\x3cbr\x3e\x3cbr\x3eNagy valsznsggel ez azrt van, mert a Google Maps knyvtr parancsfjlja nem tallhat, vagy nem tartalmazza az n oldalhoz tartoz megfelel API-kulcsot.\x3cbr\x3e\x3cbr\x3eFejlesztknek: A helyes mkdtetsre vonatkoz segtsg az albbi helyen rhet el, \x3ca href='http://trac.openlayers.org/wiki/Google' target='_blank'\x3ekattintson ide\x3c/a\x3e",getLayerWarning:"A(z) ${layerType} flia nem tltdtt be helyesen.\x3cbr\x3e\x3cbr\x3eAhhoz, hogy ez az zenet eltnjn, vlasszon egy j BaseLayer flit a jobb fels sarokban tallhat fliakapcsol segtsgvel.\x3cbr\x3e\x3cbr\x3eNagy valsznsggel ez azrt van, mert a(z) ${layerLib} knyvtr parancsfjlja helytelen.\x3cbr\x3e\x3cbr\x3eFejlesztknek: A helyes mkdtetsre vonatkoz segtsg az albbi helyen rhet el, \x3ca href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'\x3ekattintson ide\x3c/a\x3e",scale:"Lptk = 1 : ${scaleDenom}",W:"Ny",E:"K",N:"",S:"D",layerAlreadyAdded:"Megprblta hozzadni a(z) ${layerName} flit a trkphez, de az mr hozz van adva",reprojectDeprecated:"n a 'reproject' belltst hasznlja a(z) ${layerName} flin. Ez a bellts rvnytelen: hasznlata az zleti alaptrkpek fltti adatok megjelentsnek tmogatsra szolglt, de ezt a funkci ezentl a Gmbi Mercator hasznlatval rhet el. Tovbbi informci az albbi helyen rhet el: http://trac.openlayers.org/wiki/SphericalMercator",methodDeprecated:"Ez a mdszer rvnytelentve lett s a 3.0-s verzibl el lesz tvoltva. Hasznlja a(z) ${newMethod} mdszert helyette.",boundsAddError:"Az x s y rtkeknek egyarnt meg kell felelnie, hogy a funkcit hozzadhassa.",lonlatAddError:"A hossz. s szl. rtkeknek egyarnt meg kell felelnie, hogy a funkcit hozzadhassa.",pixelAddError:"Az x s y rtkeknek egyarnt meg kell felelnie, hogy a funkcit hozzadhassa.",unsupportedGeometryType:"Nem tmogatott geometriatpus: ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition sikertelen: lehetsges, hogy a(z) ${elemId} azonostj elem tves helyre kerlt.",filterEvaluateNotImplemented:"ennl a szrtpusnl kirtkels nem hajtdik vgre."});OpenLayers.Lang.ia=OpenLayers.Util.applyDefaults({unhandledRequest:"Le responsa a un requesta non esseva maneate: ${statusText}",permalink:"Permaligamine",overlays:"Superpositiones",baseLayer:"Strato de base",sameProjection:"Le mini-carta functiona solmente si illo es in le mesme projection que le carta principal",readNotImplemented:"Lectura non implementate.",writeNotImplemented:"Scriptura non implementate.",noFID:"Non pote actualisar un elemento sin FID.",errorLoadingGML:"Error al cargamento del file GML ${url}",browserNotSupported:"Tu navigator non supporta le rendition de vectores. Le renditores actualmente supportate es:\n${renderers}",componentShouldBe:"addFeatures: le componente debe esser del typo ${geomType}",getFeatureError:"getFeatureFromEvent ha essite appellate in un strato sin renditor. Isto significa generalmente que tu ha destruite un strato, ma lassava un gestor associate con illo.",minZoomLevelError:"Le proprietate minZoomLevel es solmente pro uso con le stratos descendente de FixedZoomLevels. Le facto que iste strato WFS verifica minZoomLevel es un reliquia del passato. Nonobstante, si nos lo remove immediatemente, nos pote rumper applicationes a base de OL que depende de illo. Ergo nos lo declara obsolete; le verification de minZoomLevel in basso essera removite in version 3.0. Per favor usa in su loco le configuration de resolutiones min/max como describite a: http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"Transaction WFS: SUCCESSO ${response}",commitFailed:"Transaction WFS: FALLEVA ${response}",googleWarning:"Le strato Google non poteva esser cargate correctemente.\x3cbr\x3e\x3cbr\x3ePro disfacer te de iste message, selige un nove BaseLayer in le selector de strato in alto a dextra.\x3cbr\x3e\x3cbr\x3eMulto probabilemente, isto es proque le script del libreria de Google Maps non esseva includite o non contine le clave API correcte pro tu sito.\x3cbr\x3e\x3cbr\x3eDisveloppatores: Pro adjuta de corriger isto, \x3ca href='http://trac.openlayers.org/wiki/Google' target='_blank'\x3eclicca hic\x3c/a",getLayerWarning:"Le strato ${layerType} non poteva esser cargate correctemente.\x3cbr\x3e\x3cbr\x3ePro disfacer te de iste message, selige un nove BaseLayer in le selector de strato in alto a dextra.\x3cbr\x3e\x3cbr\x3eMulto probabilemente, isto es proque le script del libreria de ${layerLib} non esseva correctemente includite.\x3cbr\x3e\x3cbr\x3eDisveloppatores: Pro adjuta de corriger isto, \x3ca href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'\x3eclicca hic\x3c/a\x3e",scale:"Scala = 1 : ${scaleDenom}",W:"W",E:"E",N:"N",S:"S",layerAlreadyAdded:"Tu tentava adder le strato: ${layerName} al carta, ma illo es ja presente",reprojectDeprecated:"Tu usa le option 'reproject' in le strato ${layerName} layer. Iste option es obsolescente: illo esseva pro poter monstrar datos super cartas de base commercial, ma iste functionalitate pote ora esser attingite con le uso de Spherical Mercator. Ulterior information es disponibile a http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"Iste methodo ha essite declarate obsolescente e essera removite in version 3.0. Per favor usa ${newMethod} in su loco.",boundsAddError:"Tu debe passar le duo valores x e y al function add.",lonlatAddError:"Tu debe passar le duo valores lon e lat al function add.",pixelAddError:"Tu debe passar le duo valores x e y al function add.",unsupportedGeometryType:"Typo de geometria non supportate: ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition falleva: le elemento con id ${elemId} pote esser mal placiate.",filterEvaluateNotImplemented:'"evaluate" non es implementate pro iste typo de filtro.'});
OpenLayers.Lang.id=OpenLayers.Util.applyDefaults({unhandledRequest:"Permintaan yang tak tertangani menghasilkan ${statusText}",permalink:"Pranala permanen",overlays:"Hamparan",baseLayer:"Lapisan Dasar",sameProjection:"Peta tinjauan hanya bekerja bila dalam proyeksi yang sama dengan peta utama",readNotImplemented:"Membaca tidak diterapkan.",writeNotImplemented:"Menyimpan tidak diterapkan.",noFID:"Tidak dapat memperbarui fitur yang tidak memiliki FID.",errorLoadingGML:"Kesalahan dalam memuat berkas GML ${url}",browserNotSupported:"Peramban Anda tidak mendukung penggambaran vektor. Penggambar yang didukung saat ini adalah:\n${renderers}",componentShouldBe:"addFeatures : komponen harus berupa ${geomType}",getFeatureError:"getFeatureFromEvent diterapkan pada lapisan tanpa penggambar. Ini biasanya berarti Anda menghapus sebuah lapisan, tetapi tidak menghapus penangan yang terkait dengannya.",minZoomLevelError:"Properti minZoomLevel hanya ditujukan bekerja dengan lapisan FixedZoomLevels-descendent. Pengecekan minZoomLevel oleh lapisan wfs adalah peninggalan masa lalu. Kami tidak dapat menghapusnya tanpa kemungkinan merusak aplikasi berbasis OL yang mungkin bergantung padanya. Karenanya, kami menganggapnya tidak berlaku -- Cek minZoomLevel di bawah ini akan dihapus pada 3.0. Silakan gunakan penyetelan resolusi min/maks seperti dijabarkan di sini: http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"WFS Transaksi: BERHASIL ${respon}",commitFailed:"WFS Transaksi: GAGAL ${respon}",googleWarning:"Lapisan Google tidak dapat dimuat dengan benar.\x3cbr\x3e\x3cbr\x3eUntuk menghilangkan pesan ini, pilih suatu BaseLayer baru melalui penukar lapisan (layer switcher) di ujung kanan atas.\x3cbr\x3e\x3cbr\x3eKemungkinan besar ini karena pustaka skrip Google Maps tidak disertakan atau tidak mengandung kunci API yang tepat untuk situs Anda.\x3cbr\x3e\x3cbr\x3ePengembang: Untuk bantuan mengatasi masalah ini, \x3ca href='http://trac.openlayers.org/wiki/Google' target='_blank'\x3eklik di sini\x3c/a\x3e",getLayerWarning:"Lapisan ${layerType} tidak dapat dimuat dengan benar.\x3cbr\x3e\x3cbr\x3eUntuk menghilangkan pesan ini, pilih suatu BaseLayer baru melalui penukar lapisan (layer switcher) di ujung kanan atas.\x3cbr\x3e\x3cbr\x3eKemungkinan besar ini karena pustaka skrip Google Maps tidak disertakan dengan benar.\x3cbr\x3e\x3cbr\x3ePengembang: Untuk bantuan mengatasi masalah ini, \x3ca href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'\x3eklik di sini\x3c/a\x3e",scale:"Sekala = 1 : ${scaleDenom}",W:"B",E:"T",N:"U",S:"S",layerAlreadyAdded:"Anda mencoba menambahkan lapisan: ${layerName} ke dalam peta, tapi lapisan itu telah ditambahkan",reprojectDeprecated:"Anda menggunakan opsi 'reproject' pada lapisan ${layerName}. Opsi ini telah ditinggalkan: penggunaannya dirancang untuk mendukung tampilan data melalui peta dasar komersial, tapi fungsionalitas tersebut saat ini harus dilakukan dengan menggunakan dukungan Spherical Mercator. Informasi lebih lanjut tersedia di http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"Metode ini telah usang dan akan dihapus di 3.0. Sebaliknya, harap gunakan ${newMethod}.",boundsAddError:"Anda harus memberikan kedua nilai x dan y ke fungsi penambah.",lonlatAddError:"Anda harus memberikan kedua nilai lon dan lat ke fungsi penambah.",pixelAddError:"Anda harus memberikan kedua nilai x dan y ke fungsi penambah.",unsupportedGeometryType:"Tipe geometri tak didukung: ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition gagal: elemen dengan id ${elemId} mungkin salah tempat.",filterEvaluateNotImplemented:"evaluasi tidak tersedia untuk tipe filter ini."});OpenLayers.Lang.io=OpenLayers.Util.applyDefaults({scale:"Skalo = 1 : ${scaleDenom}"});OpenLayers.Lang.is=OpenLayers.Util.applyDefaults({permalink:"Varanlegur tengill",overlays:"ekjur",baseLayer:"Grunnlag",sameProjection:"Yfirlitskorti virkar aeins ef a er  smu vrpun og aalkorti",readNotImplemented:"Skrifun er tfr.",writeNotImplemented:"Lestur er tfrur.",errorLoadingGML:"Villa kom upp vi a hlaa inn GML skrnni ${url}",scale:"Skali = 1 : ${scaleDenom}",layerAlreadyAdded:" reyndir a bta laginu ${layerName}  korti en a er egar bi a bta v vi",methodDeprecated:"etta fall hefur veri relt og verur fjarlgt  3.0. Notau ${newMethod}  stain."});
OpenLayers.Lang.ja=OpenLayers.Util.applyDefaults({unhandledRequest:" ${statusText} ",permalink:"",overlays:"",baseLayer:"",sameProjection:"",readNotImplemented:"",writeNotImplemented:"",noFID:"FID ",errorLoadingGML:"GML  ${url} ",browserNotSupported:"\n${renderers}",componentShouldBe:"addFeatures:  ${geomType} ",getFeatureError:"getFeatureFromEvent ",minZoomLevelError:"minZoomLevel  FixedZoomLevels  minZoomLevel  WFS  OpenLayers  minZoomLevel 3.0http://trac.openlayers.org/wiki/SettingZoomLevels ",commitSuccess:"WFS :  ${response}",commitFailed:"WFS :  ${response}",googleWarning:"Google \x3cbr\x3e\x3cbr\x3e\x3cbr\x3e\x3cbr\x3e Google  API \x3cbr\x3e\x3cbr\x3e: \x3ca href='http://trac.openlayers.org/wiki/Google' target='_blank'\x3e\x3c/a\x3e",getLayerWarning:"${layerType} \x3cbr\x3e\x3cbr\x3e\x3cbr\x3e\x3cbr\x3e ${layerLib} \x3cbr\x3e\x3cbr\x3e: \x3ca href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'\x3e\x3c/a\x3e",scale:" = 1 : ${scaleDenom}",W:"",E:"",N:"",S:"",layerAlreadyAdded:"${layerName}",reprojectDeprecated:"${layerName} reproject  Spherical Mercator  http://trac.openlayers.org/wiki/SphericalMercator ",methodDeprecated:"3.0 ${newMethod} ",boundsAddError:"x  y  add ",lonlatAddError:"lon  lat  add ",pixelAddError:"x  y  add ",unsupportedGeometryType:": ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition : id ${elemId} ",filterEvaluateNotImplemented:" evaluate "});OpenLayers.Lang.km=OpenLayers.Util.applyDefaults({permalink:"",baseLayer:"",errorLoadingGML:" GML ${url}",scale:" =   ${scaleDenom}"});OpenLayers.Lang.ksh=OpenLayers.Util.applyDefaults({unhandledRequest:"Met d Antwoot op en Aanfrooch ham_mer nix aanjefange: ${statusText}",permalink:"Lengk op Duuer",overlays:"Drvver jelaat",baseLayer:"Jrund-Nivoh",sameProjection:"De vverseeschs_Kaat deiht et blo, wann se de slve Projxjuhn bruche deiht, wi de Houp_Kaat",readNotImplemented:'\x3ccode lang="en"\x3eread\x3c/code\x3e is em Projramm nit frjesinn.',writeNotImplemented:'\x3ccode lang="en"\x3ewrite\x3c/code\x3e is em Projramm nit frjesinn.',noFID:'En Saach, woh kein \x3ci lang="en"\x3eFID\x3c/i\x3e fr doh es, lht sesch nit ndere.',errorLoadingGML:'Fhler beim \x3ci lang="en"\x3eGML\x3c/i\x3e-Datei-Laade vun \x3ccode\x3e${url}\x3c/code\x3e',browserNotSupported:"Dinge Brauser kann kein Vktore ujvve. De Zoote Ujaabe, di em Momang jon, sen:\n${renderers}",componentShouldBe:'\x3ccode lang="en"\x3eaddFeatures\x3c/code\x3e: d Aandeil sullt vun d Zoot \x3ccode lang="en"\x3e${geomType}\x3c/code\x3e sin.',getFeatureError:'\x3ccode lang="en"\x3egetFeatureFromEvent\x3c/code\x3e es vun enem Nivoh opjeroofe woode, woh et kei Projramm zom Ujvve jit. Dat bedgg fr jewhnlesch, dat De e Nivoh kapott jemaat hs, vver nit e Projramm fr domet mzejonn, wat domet verbonge es.',minZoomLevelError:'De Eijeschaff \x3ccode lang="en"\x3eminZoomLevel\x3c/code\x3e es blo dofr jedaach, dat mer se met d Nivvoh bruch, di vun \x3ccode lang="en"\x3eFixedZoomLevels\x3c/code\x3e affhange don. Dat dat \x3ci lang="en"\x3eWFS\x3c/i\x3e-Nivvoh vverhoup de Eijeschaff \x3ccode lang="en"\x3eminZoomLevel\x3c/code\x3e prhfe deiht, es noch vveresch vun frhjer. Mer knne dat vver jez nit fott lohe, oohne dat mer Jevaa loufe, dat Aanwendunge vun OpenLayers nit mieh loufe, di sesch doh velleijsch noch drop am verlohe sin. Drm sare mer, dat mer et nit mieh han welle, un de \x3ccode lang="en"\x3eminZoomLevel\x3c/code\x3e-Eijeschaff weed hee vun de Version 3.0 af nit mieh jeprf wde. Nemm dofr de Enstellung fr de hhte un de kleinte Oplhsung, esu wi et en http://trac.openlayers.org/wiki/SettingZoomLevels opjeschrevve es.',commitSuccess:'D \x3ci lang="en"\x3eWFS\x3c/i\x3e-Vrjang es joot jeloufe: ${response}',commitFailed:'D \x3ci lang="en"\x3eWFS\x3c/i\x3e-Vrjang es scheif jejange: ${response}',googleWarning:'Dat Nivvoh \x3ccode lang="en"\x3eGoogle\x3c/code\x3e kunnt nit reschtesch jelaade wde.\x3cbr /\x3e\x3cbr /\x3em hee di Nohreesch lo ze krijje, donn en ander Jrund-Nivvoh ushke, rh bovve en de k.\x3cbr /\x3e\x3cbr /\x3eWascheinlesch es dat wiel dat \x3ci lang="en"\x3eGoogle-Maps\x3c/i\x3e-Skrepp entweeder nit reschtesch enjebonge wood, udder nit d reschtejje \x3ci lang="en"\x3eAPI\x3c/i\x3e-Schlel fr Ding Web-ait scheke deiht.\x3cbr /\x3e\x3cbr /\x3eFr Projrammierer jidd_et Hlp do_drvver, \x3ca href="http://trac.openlayers.org/wiki/Google" target="_blank"\x3ewi mer dat aan et Loufe brengk\x3c/a\x3e.',getLayerWarning:'Dat Nivvoh \x3ccode\x3e${layerType}\x3c/code\x3e kunnt nit reschtesch jelaade wde.\x3cbr /\x3e\x3cbr /\x3em hee di Nohreesch lo ze krijje, donn en ander Jrund-Nivvoh ushkre, rh bovve en de k.\x3cbr /\x3e\x3cbr /\x3eWascheinlesch es dat, wiel dat Skrepp \x3ccode\x3e${layerLib}\x3c/code\x3e nit reschtesch enjebonge wood.\x3cbr /\x3e\x3cbr /\x3eFr Projrammierer jidd_Et Hlp do_drvver, \x3ca href="http://trac.openlayers.org/wiki/${layerLib}" target="_blank"\x3ewi mer dat aan et Loufe brengk\x3c/a\x3e.',scale:"Mohshtaab = 1 : ${scaleDenom}",W:"W",E:"O",N:"N",S:"S",layerAlreadyAdded:"Do h vershk, dat Nivvoh \x3ccode\x3e${layerName}\x3c/code\x3e en di Kaat eren ze brnge, et wohr vver ald do dren.",reprojectDeprecated:"Do bruchs de Uwahl \x3ccode\x3ereproject\x3c/code\x3e op dm Nivvoh \x3ccode\x3e${layerName}\x3c/code\x3e. Di Uwahl es nit mieh jhn jesinn. Se wohr dofr jedaach, m Date op jeschfsmesch eru jejovve Kaate bovve drop ze moole, wat vver enzwesche besser met d ngershtzung fr de fresche Mkaator Beldscher jeiht. Doh kanns De mieh drvver fenge op d Sigg: http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"Hee di Metood es nim_mih aktoll un et weed se en d Version 3.0 nit mieh jvve. Nemm \x3ccode\x3e${newMethod}\x3c/code\x3e dofr.",boundsAddError:"Do mo beeds vun de \x3ccode\x3ex\x3c/code\x3e un \x3ccode\x3ey\x3c/code\x3e Wte aan de Fungkjohn \x3ccode\x3eadd\x3c/code\x3e jvve.",lonlatAddError:"Do mo beeds \x3ccode\x3elon\x3c/code\x3e un \x3ccode\x3elat\x3c/code\x3e aan de Fungkjohn \x3ccode\x3eadd\x3c/code\x3e jvve.",pixelAddError:"Do mo beeds \x3ccode\x3ex\x3c/code\x3e un \x3ccode\x3ey\x3c/code\x3e aan de Fungkjohn \x3ccode\x3eadd\x3c/code\x3e jvve.",unsupportedGeometryType:"De Zoot Jommetrii dom_mer nit ongershtze: \x3ccode\x3e${geomType}\x3c/code\x3e",pagePositionFailed:'\x3ccode lang="en"\x3eOpenLayers.Util.pagePosition\x3c/code\x3e es donevve jejange: dat Denge met d Knnong \x3ccode\x3e${elemId}\x3c/code\x3e knnt am verkeehte Plaz sin.',filterEvaluateNotImplemented:'\x3ccode lang="en"\x3eevaluate\x3c/code\x3e es fr di Zoot Fellter nit enjereschdt.'});
OpenLayers.Lang.nds=OpenLayers.Util.applyDefaults({unhandledRequest:"Unbehannelt Trchmellels fr de Anfraag ${statusText}",permalink:"Permalink",overlays:"Overlays",baseLayer:"Achtergrundkoort",sameProjection:"De versichtskoort geiht blot, wenn de slve Projekschoon as bi de Hftkoort bruukt warrt",readNotImplemented:"Lesen is nich inricht.",writeNotImplemented:"Schrieven is nich inricht.",noFID:"En Feature, dat keen FID hett, kann nich aktuell maakt warrn.",errorLoadingGML:"Fehler bit Laden vun de GML-Datei ${url}",browserNotSupported:"Dien Browser nnersttt keen Vektorbiller. nnersttt Renderers:\n${renderers}",componentShouldBe:"addFeatures : Kumponent schull man den Typ ${geomType} hebben",getFeatureError:"getFeatureFromEvent is von en Laag ahn Render opropen worrn. Dat beddt normalerwies, dat en Laag wegmaakt worrn is, aver nich de Handler, de dor op verwiest.",commitSuccess:"WFS-Transakschoon: hett klappt ${response}",commitFailed:"WFS-Transakschoon: hett nich klappt ${response}",scale:"Skaal = 1 : ${scaleDenom}",layerAlreadyAdded:"Du verschst de Laag ${layerName} to de Koort totofgen, man de is al tofgt",methodDeprecated:"Disse Methood is oold un schall dat in 3.0 nich mehr geven. Bruuk dor man beter ${newMethod} fr.",boundsAddError:"De Weert x un y, de mt all beid an de add-Funkschoon vergeven warrn.",lonlatAddError:"De Weert lon un lat, de mt all beid an de add-Funkschoon vergeven warrn.",pixelAddError:"De Weert x un y, de mt all beid an de add-Funkschoon vergeven warrn.",unsupportedGeometryType:"Nich nnersttt Geometrie-Typ: ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition gng nich: Element mit de Id ${elemId} is villicht ann verkehrten Platz."});OpenLayers.Lang.nn=OpenLayers.Util.applyDefaults({scale:"Skala = 1 : ${scaleDenom}",layerAlreadyAdded:"Du freista  leggja til laget ${layerName} p kartet, men det har alt vorte lagt til.",boundsAddError:"Du er nydd til  gje bde ein x- og ein y-verdi til add-funksjonen.",lonlatAddError:"Du er nydd til  gje bde lon- og lat-verdiar til add-funksjonen.",pixelAddError:"Du er nydd til  gje bde ein x- og ein y-verdi til add-funksjonen."});OpenLayers.Lang.oc=OpenLayers.Util.applyDefaults({unhandledRequest:"Requsta pas gerida, retorna ${statusText}",permalink:"Permaligam",overlays:"Calques",baseLayer:"Calc de basa",sameProjection:"La carta de situacion fonciona pas que quora sa projeccion es la meteissa que la de la carta principala",readNotImplemented:"Lectura pas implementada.",writeNotImplemented:"Escritura pas implementada.",noFID:"Impossible de metre a jorn un objcte sens identificant (fid).",errorLoadingGML:"Error al cargament del fichir GML ${url}",browserNotSupported:"Vstre navegidor suprta pas lo rendut vectorial. Los renderers actualament suportats son : \n${renderers}",componentShouldBe:"addFeatures : lo compausant deuri sser de tipe ${geomType}",getFeatureError:"getFeatureFromEvent es estat apelat sus un calc sens renderer. Aqu significa generalament qu'avtz destruch aqueste ja, mas qu'avtz conservat un handler que li ra associat.",minZoomLevelError:"La proprietat minZoomLevel deu sser utilizada solament per de jaces FixedZoomLevels-descendent. Lo fach qu'aqueste ja WFS verifique la presncia de minZoomLevel es una relica del passat. aquel, la podm suprimir sens copar d'aplicacions que ne poirin dependre. Es per aqu que la depreciam -- la verificacion del minZoomLevel ser suprimida en version 3.0. A la plaa, mercs d'utilizar los paramtres de resolucions min/max tal coma descrich sus : http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"Transaccion WFS : SUCCES ${response}",commitFailed:"Transaccion WFS : FRACAS ${response}",googleWarning:"Lo ja Google es pas estat en mesura de se cargar corrctament.\x3cbr\x3e\x3cbr\x3ePer suprimir aqueste messatge, causisstz una BaseLayer novla dins lo selector de ja en naut a drecha.\x3cbr\x3e\x3cbr\x3eAqu es possiblament causat par la non-inclusion de la librari Google Maps, o alara perque que la clau de l'API correspond pas a vstre site.\x3cbr\x3e\x3cbr\x3eDesvolopaires : per saber coss corregir aqu, \x3ca href='http://trac.openlayers.org/wiki/Google' target='_blank'\x3eclicatz aic\x3c/a\x3e",getLayerWarning:"Lo ja ${layerType} es pas en mesura de se cargar corrctament.\x3cbr\x3e\x3cbr\x3ePer suprimir aqueste messatge, causisstz una  BaseLayer novla dins lo selector de ja en naut a drecha.\x3cbr\x3e\x3cbr\x3eAqu es possiblament causat per la non-inclusion de la librari ${layerLib}.\x3cbr\x3e\x3cbr\x3eDesvolopaires : per saber coss corregir aqu, \x3ca href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'\x3eclicatz aic\x3c/a\x3e",scale:"Escala ~ 1 : ${scaleDenom}",W:"O",E:"",N:"N",S:"S",layerAlreadyAdded:"Avtz ensajat d'apondre a la carta lo calc : ${layerName}, mas ja es present",reprojectDeprecated:"Utilizatz l'opcion 'reproject' sul ja ${layerName}. Aquesta opcion es despreciada : Son usatge permeti d'afichar de donadas al desss de jaces raster comercials. Aquesta foncionalitat ara es suportada en utilizant lo suprt de la projeccion Mercator Esferica. Mai d'informacion es disponibla sus http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"Aqueste metde es despreciada, e ser suprimida a la version 3.0. Mercs d'utilizar ${newMethod} a la plaa.",boundsAddError:"Vos cal passar las doas valors x e y a la foncion add.",lonlatAddError:"Vos cal passar las doas valors lon e lat a la foncion add.",pixelAddError:"Vos cal passar las doas valors x e y a la foncion add.",unsupportedGeometryType:"Tipe de geometria pas suportat : ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition a fracassat : l'element d'id ${elemId} poiri sser mal posicionat.",filterEvaluateNotImplemented:"evaluar es pas encara estat implementat per aqueste tipe de filtre."});
OpenLayers.Lang.pt=OpenLayers.Util.applyDefaults({unhandledRequest:"Servidor devolveu erro no contemplado ${statusText}",permalink:"Ligao permanente",overlays:"Sobreposies",baseLayer:"Camada Base",sameProjection:"O mapa panormico s funciona quando est na mesma projeo que o mapa principal",readNotImplemented:"Leitura no implementada.",writeNotImplemented:"Escrita no implementada.",noFID:"No  possvel atualizar um elemento para a qual no h FID.",errorLoadingGML:"Erro ao carregar ficheiro GML ${url}",browserNotSupported:"O seu navegador no suporta renderizao vetorial. Actualmente os renderizadores suportados so:\n${renderers}",componentShouldBe:"addFeatures: componente deve ser um(a) ${geomType}",getFeatureError:"getFeatureFromEvent foi chamado numa camada sem renderizador. Isto normalmente significa que destruiu uma camada, mas no um manipulador ''(handler)'' que lhe est associado.",minZoomLevelError:"A propriedade minZoomLevel s deve ser usada com as camadas descendentes da FixedZoomLevels. A verificao da propriedade por esta camada wfs  uma relquia do passado. No entanto, no podemos remov-la sem correr o risco de afectar aplicaes OL que dependam dela. Portanto, estamos a torn-la obsoleta -- a verificao minZoomLevel ser removida na verso 3.0. Em vez dela, por favor, use as opes de resoluo min/max descritas aqui: http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"Transaco WFS: SUCESSO ${response}",commitFailed:"Transaco WFS: FALHOU ${response}",googleWarning:"A Camada Google no foi correctamente carregada.\x3cbr\x3e\x3cbr\x3ePara deixar de receber esta mensagem, seleccione uma nova Camada-Base no ''switcher'' de camadas no canto superior direito.\x3cbr\x3e\x3cbr\x3eProvavelmente, isto acontece porque o ''script'' da biblioteca do Google Maps no foi includo ou no contm a chave API correcta para o seu stio.\x3cbr\x3e\x3cbr\x3eProgramadores: Para ajuda sobre como solucionar o problema \x3ca href='http://trac.openlayers.org/wiki/Google' target='_blank'\x3eclique aqui\x3c/a\x3e .",getLayerWarning:"A camada ${layerType} no foi correctamente carregada.\x3cbr\x3e\x3cbr\x3ePara desactivar esta mensagem, seleccione uma nova Camada-Base no ''switcher'' de camadas no canto superior direito.\x3cbr\x3e\x3cbr\x3eProvavelmente, isto acontece porque o ''script'' da biblioteca ${layerLib} no foi includo correctamente.\x3cbr\x3e\x3cbr\x3eProgramadores: Para ajuda sobre como solucionar o problema \x3ca href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'\x3eclique aqui\x3c/a\x3e .",scale:"Escala = 1 : ${scaleDenom}",W:"O",E:"E",N:"N",S:"S",layerAlreadyAdded:"Voc tentou adicionar a camada: ${layerName} ao mapa, mas ela j tinha sido adicionada antes",reprojectDeprecated:"Est usando a opo 'reproject' na camada ${layerName}. Esta opo  obsoleta: foi concebida para permitir a apresentao de dados sobre mapas-base comerciais, mas esta funcionalidade  agora suportada pelo Mercator Esfrico. Mais informao est disponvel em http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"Este mtodo foi declarado obsoleto e ser removido na verso 3.0. Por favor, use ${newMethod} em vez disso.",boundsAddError:"Voc deve passar tanto o valor x como o y  funo de adio.",lonlatAddError:"Voc deve passar tanto o valor lon como o lat  funo de adio.",pixelAddError:"Voc deve passar tanto o valor x como o y  funo de adio.",unsupportedGeometryType:"Tipo de geometria no suportado: ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition falhou: o elemento com o id ${elemId} poder estar mal-posicionado.",filterEvaluateNotImplemented:"avaliar no est implementado para este tipo de filtro."});OpenLayers.Lang.ru=OpenLayers.Util.applyDefaults({unhandledRequest:"   ${statusText}",permalink:" ",overlays:"",baseLayer:" ",sameProjection:"    ,     ,   ",readNotImplemented:"  .",writeNotImplemented:"  .",noFID:"  ,    FID.",errorLoadingGML:"    GML ${url}",browserNotSupported:"     .    :\n${renderers}",componentShouldBe:"addFeatures:    ${geomType}",getFeatureError:"getFeatureFromEvent     .     ,    ,      .",minZoomLevelError:" minZoomLevel      ,   FixedZoomLevels. ,   WFS-   minZoomLevel   .       ,  , ,       OpenLayers .      minZoomLevel    3.0. ,     / ,  : http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:" WFS:  ${response}",commitFailed:" WFS:  ${response}",googleWarning:" Google    .\x3cbr\x3e\x3cbr\x3e    ,          .\x3cbr\x3e\x3cbr\x3e ,   ,   Google Maps        API-   .\x3cbr\x3e\x3cbr\x3e:  ,  ,   , \x3ca href='http://trac.openlayers.org/wiki/Google' target='_blank'\x3e \x3c/a\x3e",getLayerWarning:" ${layerType}    . \x3cbr\x3e\x3cbr\x3e    ,          .\x3cbr\x3e\x3cbr\x3e ,   ,   ${layerLib}       .\x3cbr\x3e\x3cbr\x3e:  ,  ,   , \x3ca href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'\x3e \x3c/a\x3e",scale:" = 1 : ${scaleDenom}",W:"",E:"",N:"",S:"",layerAlreadyAdded:"    ${layerName}  ,     ",reprojectDeprecated:"   'reproject'   ${layerName}.    :           ,          .     http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"         3.0. ,  ${newMethod}.",boundsAddError:" add    , x  y.",lonlatAddError:" add    , lon  lat.",pixelAddError:" add    , x  y.",unsupportedGeometryType:"  : ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition failed:   id ${elemId}      .",filterEvaluateNotImplemented:"evaluate      ."});
OpenLayers.Lang.sk=OpenLayers.Util.applyDefaults({unhandledRequest:"Neobslen poiadavky vracaj ${statusText}",permalink:"Trval odkaz",overlays:"Prekrytia",baseLayer:"Zkladn vrstva",sameProjection:"Prehadov mapka funguje iba vtedy, ke je v rovnakej projekcii ako hlavn mapa",readNotImplemented:"tanie nie je implementovan.",writeNotImplemented:"Zpis nie je implementovan.",noFID:"Nie je mon aktualizova vlastnos, pre ktor neexistuje FID.",errorLoadingGML:"Chyba pri natan sboru GML ${url}",browserNotSupported:"V prehliada nepodporuje vykresovanie vektorov. Momentlne podporovan vykresovae s:\n${renderers}",componentShouldBe:"addFeatures: komponent by mal by ${geomType}",getFeatureError:"getFeatureFromEvent bola zavolan na vrstve bez vykresovaa. To zvyajne znamen, e ste odstrnili vrstvu, ale nie niektor z obslh, ktor je s ou asociovan.",minZoomLevelError:"Vlastnos minZoomLevel je uren iba na pouitie s vrstvami odvodenmi od FixedZoomLevels. To, e tto wfs vrstva kontroluje minZoomLevel je pozostatok z minulosti. Nememe ho vak odstrni, aby sme sa vyhli monmu porueniu aplikci zaloench na Open Layers, ktor na tomto me zvisie. Preto ho oznaujeme ako zavrhovan - dolu uveden kontrola minZoomLevel bude odstrnen vo verzii 3.0. Pouite prosm namiesto toho kontrolu min./max. rozlenia poda tu uvedenho popisu: http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"Transakcia WFS: SPEN ${response}",commitFailed:"Transakcia WFS: ZLYHALA ${response}",googleWarning:"Vrstvu Google nebolo mon sprvne nata.\x3cbr\x3e\x3cbr\x3eAby ste sa tejto sprvy zbavili vyberte nov BaseLayer v prepnai vrstiev v pravom hornom rohu.\x3cbr\x3e\x3cbr\x3eToto sa stalo pravdepodobne preto, e skript kninice Google Maps bu nebol natan alebo neobsahuje sprvny k API pre vau lokalitu.\x3cbr\x3e\x3cbr\x3eVvojri: Tu mete zska \x3ca href='http://trac.openlayers.org/wiki/Google' target='_blank'\x3epomoc so sfunknenm\x3c/a\x3e",getLayerWarning:"Vrstvu ${layerType} nebolo mon sprvne nata.\x3cbr\x3e\x3cbr\x3eAby ste sa tejto sprvy zbavili vyberte nov BaseLayer v prepnai vrstiev v pravom hornom rohu.\x3cbr\x3e\x3cbr\x3eToto sa stalo pravdepodobne preto, e skript kninice ${layerType} bu nebol natan alebo neobsahuje sprvny k API pre vau lokalitu.\x3cbr\x3e\x3cbr\x3eVvojri: Tu mete zska \x3ca href='http://trac.openlayers.org/wiki/${layerType}' target='_blank'\x3epomoc so sfunknenm\x3c/a\x3e",scale:"Mierka = 1 : ${scaleDenom}",layerAlreadyAdded:"Poksili ste sa do mapy prida vrstvu ${layerName}, ale t u bola pridan",reprojectDeprecated:"Pouvate voby reproject vrstvy ${layerType}. Tto voba je zzavrhovan: jej pouitie bolo navrhnut na podporu zobrazovania dajov nad komernmi zkladovmi mapami, ale tto funkcionalitu je teraz mon dosiahnu pomocou Spherical Mercator. alie informcie zskate na strnke http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"Tto metda je zavrhovan a bude odstrnen vo verzii 3.0. Pouite prosm namiesto nej metdu ${newMethod}.",boundsAddError:"Stacej funkcii muste da hodnoty x aj y.",lonlatAddError:"Stacej funkcii muste da hodnoty lon (zem. dka) aj lat (zem. rka).",pixelAddError:"Stacej funkcii muste da hodnoty x aj y.",unsupportedGeometryType:"Nepodporovan typ geometrie: ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition zlyhalo: prvok s id ${elemId} me by zle umiestnen.",filterEvaluateNotImplemented:"evaluate nie je implementovan pre tento typ filtra"});OpenLayers.Lang.te=OpenLayers.Util.applyDefaults({permalink:"",W:"",E:"",N:"",S:""});OpenLayers.Lang.vi=OpenLayers.Util.applyDefaults({unhandledRequest:"Khng x l c phn hi ${statusText} cho yu cu",permalink:"Lin kt thng trc",overlays:"Lp bn ",baseLayer:"Lp nn",sameProjection:"Bn  ton cnh ch hot ng khi cng php chiu vi bn  chnh",readNotImplemented:"Cha h tr chc nng c.",writeNotImplemented:"Cha h tr chc nng vit.",noFID:"Khng th cp nht tnh nng thiu FID.",errorLoadingGML:"Li ti tp tin GML ti ${url}",browserNotSupported:"Trnh duyt ca bn khng h tr chc nng v bng vect. Hin h tr cc b kt xut:\n${renderers}",componentShouldBe:"addFeatures: b phn cn phi l ${geomType}",getFeatureError:"getFeatureFromEvent c gi t lp khng c b kt xut. Thng th c l lp b xa nhng mt phn x l ca n vn cn.",minZoomLevelError:"Ch nn s dng thuc tnh minZoomLevel vi cc lp FixedZoomLevels-descendent. Vic lp wfs ny tm cho minZoomLevel l di tch cn li t xa. Tuy nhin, nu chng ti di n th s v cc chng trnh OpenLayers m da trn n. Bi vy chng ti phn i s dng n\x26nbsp; bc tm cho minZoomLevel s c di vo phin bn 3.0. Xin s dng thit lp  phn tch ti thiu / ti a thay th, theo hng dn ny: http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"Giao dch WFS: THNH CNG ${response}",commitFailed:"Giao dch WFS: THT BI ${response}",googleWarning:"Khng th ti lp Google ng n.\x3cbr\x3e\x3cbr\x3e trnh thng bo ny ln sau, hy chn BaseLayer mi dng iu khin chn lp  gc trn phi.\x3cbr\x3e\x3cbr\x3eChc script th vin Google Maps hoc khng c bao gm hoc khng cha kha API hp vi website ca bn.\x3cbr\x3e\x3cbr\x3e\x3ca href='http://trac.openlayers.org/wiki/Google' target='_blank'\x3eTr gip v tnh nng ny\x3c/a\x3e cho ngi pht trin.",getLayerWarning:"Khng th ti lp ${layerType} ng n.\x3cbr\x3e\x3cbr\x3e trnh thng bo ny ln sau, hy chn BaseLayer mi dng iu khin chn lp  gc trn phi.\x3cbr\x3e\x3cbr\x3eChc script th vin ${layerLib} khng c bao gm ng kiu.\x3cbr\x3e\x3cbr\x3e\x3ca href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'\x3eTr gip v tnh nng ny\x3c/a\x3e cho ngi pht trin.",scale:"T l = 1 : ${scaleDenom}",W:"T",E:"",N:"B",S:"N",layerAlreadyAdded:"Bn mun thm lp ${layerName} vo bn , nhng lp ny  c thm",reprojectDeprecated:"Bn ang p dng ch  reproject vo lp ${layerName}. Ch  ny  b phn i: n c mc ch h tr lp d liu trn cc nn bn  thng mi; nn thc hin hiu ng  dng tnh nng Mercator Hnh cu. C sn thm chi tit ti http://trac.openlayers.org/wiki/SphericalMercator .",methodDeprecated:"Phng thc ny  b phn i v s b di vo phin bn 3.0. Xin hy s dng ${newMethod} thay th.",boundsAddError:"Cn phi cho c gi tr x v y vo hm add.",lonlatAddError:"Cn phi cho c gi tr lon v lat vo hm add.",pixelAddError:"Cn phi cho c gi tr x v y vo hm add.",unsupportedGeometryType:"Khng h tr kiu a l: ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition b tht bi: nguyn t vi ID ${elemId} c th  ch sai.",filterEvaluateNotImplemented:"cha h tr evaluate cho loi b lc ny."});
OpenLayers.Popup.AnchoredBubble=OpenLayers.Class(OpenLayers.Popup.Anchored,{rounded:false,initialize:function(g,c,f,b,a,e,d){this.padding=new OpenLayers.Bounds(0,OpenLayers.Popup.AnchoredBubble.CORNER_SIZE,0,OpenLayers.Popup.AnchoredBubble.CORNER_SIZE);OpenLayers.Popup.Anchored.prototype.initialize.apply(this,arguments)},draw:function(a){OpenLayers.Popup.Anchored.prototype.draw.apply(this,arguments);this.setContentHTML();this.setBackgroundColor();this.setOpacity();return this.div},updateRelativePosition:function(){this.setRicoCorners()},setSize:function(a){OpenLayers.Popup.Anchored.prototype.setSize.apply(this,arguments);this.setRicoCorners()},setBackgroundColor:function(a){if(a!=undefined){this.backgroundColor=a}if(this.div!=null){if(this.contentDiv!=null){this.div.style.background="transparent";OpenLayers.Rico.Corner.changeColor(this.groupDiv,this.backgroundColor)}}},setOpacity:function(a){OpenLayers.Popup.Anchored.prototype.setOpacity.call(this,a);if(this.div!=null){if(this.groupDiv!=null){OpenLayers.Rico.Corner.changeOpacity(this.groupDiv,this.opacity)}}},setBorder:function(a){this.border=0},setRicoCorners:function(){var a=this.getCornersToRound(this.relativePosition);var b={corners:a,color:this.backgroundColor,bgColor:"transparent",blend:false};if(!this.rounded){OpenLayers.Rico.Corner.round(this.div,b);this.rounded=true}else{OpenLayers.Rico.Corner.reRound(this.groupDiv,b);this.setBackgroundColor();this.setOpacity()}},getCornersToRound:function(){var a=["tl","tr","bl","br"];var b=OpenLayers.Bounds.oppositeQuadrant(this.relativePosition);OpenLayers.Util.removeItem(a,b);return a.join(" ")},CLASS_NAME:"OpenLayers.Popup.AnchoredBubble"});OpenLayers.Popup.AnchoredBubble.CORNER_SIZE=5;OpenLayers.Popup.Framed=OpenLayers.Class(OpenLayers.Popup.Anchored,{imageSrc:null,imageSize:null,isAlphaImage:false,positionBlocks:null,blocks:null,fixedRelativePosition:false,initialize:function(g,c,f,b,a,e,d){OpenLayers.Popup.Anchored.prototype.initialize.apply(this,arguments);if(this.fixedRelativePosition){this.updateRelativePosition();this.calculateRelativePosition=function(h){return this.relativePosition}}this.contentDiv.style.position="absolute";this.contentDiv.style.zIndex=1;if(e){this.closeDiv.style.zIndex=1}this.groupDiv.style.position="absolute";this.groupDiv.style.top="0px";this.groupDiv.style.left="0px";this.groupDiv.style.height="100%";this.groupDiv.style.width="100%"},destroy:function(){this.imageSrc=null;this.imageSize=null;this.isAlphaImage=null;this.fixedRelativePosition=false;this.positionBlocks=null;for(var a=0;a<this.blocks.length;a++){var b=this.blocks[a];if(b.image){b.div.removeChild(b.image)}b.image=null;if(b.div){this.groupDiv.removeChild(b.div)}b.div=null}this.blocks=null;OpenLayers.Popup.Anchored.prototype.destroy.apply(this,arguments)},setBackgroundColor:function(a){},setBorder:function(){},setOpacity:function(a){},setSize:function(a){OpenLayers.Popup.Anchored.prototype.setSize.apply(this,arguments);this.updateBlocks()},updateRelativePosition:function(){this.padding=this.positionBlocks[this.relativePosition].padding;if(this.closeDiv){var a=this.getContentDivPadding();this.closeDiv.style.right=a.right+this.padding.right+"px";this.closeDiv.style.top=a.top+this.padding.top+"px"}this.updateBlocks()},calculateNewPx:function(a){var b=OpenLayers.Popup.Anchored.prototype.calculateNewPx.apply(this,arguments);b=b.offset(this.positionBlocks[this.relativePosition].offset);return b},createBlocks:function(){this.blocks=[];var f=null;for(var e in this.positionBlocks){f=e;break}var a=this.positionBlocks[f];for(var d=0;d<a.blocks.length;d++){var h={};this.blocks.push(h);var b=this.id+"_FrameDecorationDiv_"+d;h.div=OpenLayers.Util.createDiv(b,null,null,null,"absolute",null,"hidden",null);var c=this.id+"_FrameDecorationImg_"+d;var g=(this.isAlphaImage)?OpenLayers.Util.createAlphaImageDiv:OpenLayers.Util.createImage;h.image=g(c,null,this.imageSize,this.imageSrc,"absolute",null,null,null);h.div.appendChild(h.image);this.groupDiv.appendChild(h.div)
}},updateBlocks:function(){if(!this.blocks){this.createBlocks()}if(this.size&&this.relativePosition){var j=this.positionBlocks[this.relativePosition];for(var f=0;f<j.blocks.length;f++){var c=j.blocks[f];var e=this.blocks[f];var d=c.anchor.left;var k=c.anchor.bottom;var a=c.anchor.right;var n=c.anchor.top;var m=(isNaN(c.size.w))?this.size.w-(a+d):c.size.w;var g=(isNaN(c.size.h))?this.size.h-(k+n):c.size.h;e.div.style.width=(m<0?0:m)+"px";e.div.style.height=(g<0?0:g)+"px";e.div.style.left=(d!=null)?d+"px":"";e.div.style.bottom=(k!=null)?k+"px":"";e.div.style.right=(a!=null)?a+"px":"";e.div.style.top=(n!=null)?n+"px":"";e.image.style.left=c.position.x+"px";e.image.style.top=c.position.y+"px"}this.contentDiv.style.left=this.padding.left+"px";this.contentDiv.style.top=this.padding.top+"px"}},CLASS_NAME:"OpenLayers.Popup.Framed"});OpenLayers.Projection=OpenLayers.Class({proj:null,projCode:null,initialize:function(b,a){OpenLayers.Util.extend(this,a);this.projCode=b;if(window.Proj4js){this.proj=new Proj4js.Proj(b)}},getCode:function(){return this.proj?this.proj.srsCode:this.projCode},getUnits:function(){return this.proj?this.proj.units:null},toString:function(){return this.getCode()},equals:function(a){if(a&&a.getCode){return this.getCode()==a.getCode()}else{return false}},destroy:function(){delete this.proj;delete this.projCode},CLASS_NAME:"OpenLayers.Projection"});OpenLayers.Projection.transforms={};OpenLayers.Projection.addTransform=function(c,b,a){if(!OpenLayers.Projection.transforms[c]){OpenLayers.Projection.transforms[c]={}}OpenLayers.Projection.transforms[c][b]=a};OpenLayers.Projection.transform=function(a,c,b){if(c.proj&&b.proj){a=Proj4js.transform(c.proj,b.proj,a)}else{if(c&&b&&OpenLayers.Projection.transforms[c.getCode()]&&OpenLayers.Projection.transforms[c.getCode()][b.getCode()]){OpenLayers.Projection.transforms[c.getCode()][b.getCode()](a)}}return a};OpenLayers.Protocol.WFS.v1=OpenLayers.Class(OpenLayers.Protocol,{version:null,srsName:"EPSG:4326",featureType:null,featureNS:null,geometryName:"the_geom",schema:null,featurePrefix:"feature",formatOptions:null,readFormat:null,initialize:function(b){OpenLayers.Protocol.prototype.initialize.apply(this,[b]);if(!b.format){this.format=OpenLayers.Format.WFST(OpenLayers.Util.extend({version:this.version,featureType:this.featureType,featureNS:this.featureNS,featurePrefix:this.featurePrefix,geometryName:this.geometryName,srsName:this.srsName,schema:this.schema},this.formatOptions))}if(!this.featureNS&&this.featurePrefix){var a=this.format.readNode;this.format.readNode=function(c,d){if(!this.featureNS&&c.prefix==this.featurePrefix){this.featureNS=c.namespaceURI;this.setNamespace("feature",this.featureNS)}return a.apply(this,arguments)}}},destroy:function(){if(this.options&&!this.options.format){this.format.destroy()}this.format=null;OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(b){OpenLayers.Protocol.prototype.read.apply(this,arguments);b=OpenLayers.Util.extend({},b);OpenLayers.Util.applyDefaults(b,this.options||{});var a=new OpenLayers.Protocol.Response({requestType:"read"});var c=OpenLayers.Format.XML.prototype.write.apply(this.format,[this.format.writeNode("wfs:GetFeature",b)]);a.priv=OpenLayers.Request.POST({url:b.url,callback:this.createCallback(this.handleRead,a,b),params:b.params,headers:b.headers,data:c});return a},handleRead:function(a,b){if(b.callback){var c=a.priv;if(c.status>=200&&c.status<300){a.features=this.parseFeatures(c);a.code=OpenLayers.Protocol.Response.SUCCESS}else{a.code=OpenLayers.Protocol.Response.FAILURE}b.callback.call(b.scope,a)}},parseFeatures:function(a){var b=a.responseXML;if(!b||!b.documentElement){b=a.responseText}if(!b||b.length<=0){return null}return(this.readFormat!==null)?this.readFormat.read(b):this.format.read(b)},commit:function(c,b){b=OpenLayers.Util.extend({},b);OpenLayers.Util.applyDefaults(b,this.options);var a=new OpenLayers.Protocol.Response({requestType:"commit",reqFeatures:c});a.priv=OpenLayers.Request.POST({url:b.url,data:this.format.write(c,b),callback:this.createCallback(this.handleCommit,a,b)});
return a},handleCommit:function(a,b){if(b.callback){var c=a.priv;var d=c.responseXML;if(!d||!d.documentElement){d=c.responseText}var e=this.format.read(d)||{};a.insertIds=e.insertIds||[];a.code=(e.success)?OpenLayers.Protocol.Response.SUCCESS:OpenLayers.Protocol.Response.FAILURE;b.callback.call(b.scope,a)}},filterDelete:function(e,c){c=OpenLayers.Util.extend({},c);OpenLayers.Util.applyDefaults(c,this.options);var b=new OpenLayers.Protocol.Response({requestType:"commit"});var a=this.format.createElementNSPlus("wfs:Transaction",{attributes:{service:"WFS",version:this.version}});var d=this.format.createElementNSPlus("wfs:Delete",{attributes:{typeName:(c.featureNS?this.featurePrefix+":":"")+c.featureType}});if(c.featureNS){d.setAttribute("xmlns:"+this.featurePrefix,c.featureNS)}var g=this.format.writeNode("ogc:Filter",e);d.appendChild(g);a.appendChild(d);var f=OpenLayers.Format.XML.prototype.write.apply(this.format,[a]);return OpenLayers.Request.POST({url:this.url,callback:c.callback||function(){},data:f})},abort:function(a){if(a){a.priv.abort()}},CLASS_NAME:"OpenLayers.Protocol.WFS.v1"});OpenLayers.Renderer.SVG=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"http://www.w3.org/2000/svg",xlinkns:"http://www.w3.org/1999/xlink",MAX_PIXEL:15000,translationParameters:null,symbolMetrics:null,isGecko:null,supportUse:null,initialize:function(a){if(!this.supported()){return}OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments);this.translationParameters={x:0,y:0};this.supportUse=(navigator.userAgent.toLowerCase().indexOf("applewebkit/5")==-1);this.isGecko=(navigator.userAgent.toLowerCase().indexOf("gecko/")!=-1);this.symbolMetrics={}},destroy:function(){OpenLayers.Renderer.Elements.prototype.destroy.apply(this,arguments)},supported:function(){var a="http://www.w3.org/TR/SVG11/feature#";return(document.implementation&&(document.implementation.hasFeature("org.w3c.svg","1.0")||document.implementation.hasFeature(a+"SVG","1.1")||document.implementation.hasFeature(a+"BasicStructure","1.1")))},inValidRange:function(a,e,b){var d=a+(b?0:this.translationParameters.x);var c=e+(b?0:this.translationParameters.y);return(d>=-this.MAX_PIXEL&&d<=this.MAX_PIXEL&&c>=-this.MAX_PIXEL&&c<=this.MAX_PIXEL)},setExtent:function(b,d){OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments);var a=this.getResolution();var f=-b.left/a;var e=b.top/a;if(d){this.left=f;this.top=e;var c="0 0 "+this.size.w+" "+this.size.h;this.rendererRoot.setAttributeNS(null,"viewBox",c);this.translate(0,0);return true}else{var g=this.translate(f-this.left,e-this.top);if(!g){this.setExtent(b,true)}return g}},translate:function(a,c){if(!this.inValidRange(a,c,true)){return false}else{var b="";if(a||c){b="translate("+a+","+c+")"}this.root.setAttributeNS(null,"transform",b);this.translationParameters={x:a,y:c};return true}},setSize:function(a){OpenLayers.Renderer.prototype.setSize.apply(this,arguments);this.rendererRoot.setAttributeNS(null,"width",this.size.w);this.rendererRoot.setAttributeNS(null,"height",this.size.h)},getNodeType:function(c,b){var a=null;switch(c.CLASS_NAME){case"OpenLayers.Geometry.Point":if(b.externalGraphic){a="image"}else{if(this.isComplexSymbol(b.graphicName)){a=this.supportUse===false?"svg":"use"}else{a="circle"}}break;case"OpenLayers.Geometry.Rectangle":a="rect";break;case"OpenLayers.Geometry.LineString":a="polyline";break;case"OpenLayers.Geometry.LinearRing":a="polygon";break;case"OpenLayers.Geometry.Polygon":case"OpenLayers.Geometry.Curve":case"OpenLayers.Geometry.Surface":a="path";break;default:break}return a},setStyle:function(o,s,b){s=s||o._style;b=b||o._options;var j=parseFloat(o.getAttributeNS(null,"r"));var i=1;var d;if(o._geometryClass=="OpenLayers.Geometry.Point"&&j){o.style.visibility="";if(s.graphic===false){o.style.visibility="hidden"}else{if(s.externalGraphic){d=this.getPosition(o);if(s.graphicTitle){o.setAttributeNS(null,"title",s.graphicTitle)}if(s.graphicWidth&&s.graphicHeight){o.setAttributeNS(null,"preserveAspectRatio","none")
}var n=s.graphicWidth||s.graphicHeight;var l=s.graphicHeight||s.graphicWidth;n=n?n:s.pointRadius*2;l=l?l:s.pointRadius*2;var t=(s.graphicXOffset!=undefined)?s.graphicXOffset:-(0.5*n);var f=(s.graphicYOffset!=undefined)?s.graphicYOffset:-(0.5*l);var a=s.graphicOpacity||s.fillOpacity;o.setAttributeNS(null,"x",(d.x+t).toFixed());o.setAttributeNS(null,"y",(d.y+f).toFixed());o.setAttributeNS(null,"width",n);o.setAttributeNS(null,"height",l);o.setAttributeNS(this.xlinkns,"href",s.externalGraphic);o.setAttributeNS(null,"style","opacity: "+a)}else{if(this.isComplexSymbol(s.graphicName)){var c=s.pointRadius*3;var k=c*2;var m=this.importSymbol(s.graphicName);d=this.getPosition(o);i=this.symbolMetrics[m][0]*3/k;var g=o.parentNode;var h=o.nextSibling;if(g){g.removeChild(o)}if(this.supportUse===false){var e=document.getElementById(m);o.firstChild&&o.removeChild(o.firstChild);o.appendChild(e.firstChild.cloneNode(true));o.setAttributeNS(null,"viewBox",e.getAttributeNS(null,"viewBox"))}else{o.setAttributeNS(this.xlinkns,"href","#"+m)}o.setAttributeNS(null,"width",k);o.setAttributeNS(null,"height",k);o.setAttributeNS(null,"x",d.x-c);o.setAttributeNS(null,"y",d.y-c);if(h){g.insertBefore(o,h)}else{if(g){g.appendChild(o)}}}else{o.setAttributeNS(null,"r",s.pointRadius)}}}var q=s.rotation;if((q!==undefined||o._rotation!==undefined)&&d){o._rotation=q;q|=0;if(o.nodeName!=="svg"){o.setAttributeNS(null,"transform","rotate("+q+" "+d.x+" "+d.y+")")}else{var p=this.symbolMetrics[m];o.firstChild.setAttributeNS(null,"transform","rotate("+s.rotation+" "+p[1]+" "+p[2]+")")}}}if(b.isFilled){o.setAttributeNS(null,"fill",s.fillColor);o.setAttributeNS(null,"fill-opacity",s.fillOpacity)}else{o.setAttributeNS(null,"fill","none")}if(b.isStroked){o.setAttributeNS(null,"stroke",s.strokeColor);o.setAttributeNS(null,"stroke-opacity",s.strokeOpacity);o.setAttributeNS(null,"stroke-width",s.strokeWidth*i);o.setAttributeNS(null,"stroke-linecap",s.strokeLinecap||"round");o.setAttributeNS(null,"stroke-linejoin","round");s.strokeDashstyle&&o.setAttributeNS(null,"stroke-dasharray",this.dashStyle(s,i))}else{o.setAttributeNS(null,"stroke","none")}if(s.pointerEvents){o.setAttributeNS(null,"pointer-events",s.pointerEvents)}if(s.cursor!=null){o.setAttributeNS(null,"cursor",s.cursor)}return o},dashStyle:function(c,b){var a=c.strokeWidth*b;var d=c.strokeDashstyle;switch(d){case"solid":return"none";case"dot":return[1,4*a].join();case"dash":return[4*a,4*a].join();case"dashdot":return[4*a,4*a,1,4*a].join();case"longdash":return[8*a,4*a].join();case"longdashdot":return[8*a,4*a,1,4*a].join();default:return OpenLayers.String.trim(d).replace(/\s+/g,",")}},createNode:function(a,c){var b=document.createElementNS(this.xmlns,a);if(c){b.setAttributeNS(null,"id",c)}return b},nodeTypeCompare:function(b,a){return(a==b.nodeName)},createRenderRoot:function(){return this.nodeFactory(this.container.id+"_svgRoot","svg")},createRoot:function(a){return this.nodeFactory(this.container.id+a,"g")},createDefs:function(){var a=this.nodeFactory(this.container.id+"_defs","defs");this.rendererRoot.appendChild(a);return a},drawPoint:function(a,b){return this.drawCircle(a,b,1)},drawCircle:function(d,e,b){var c=this.getResolution();var a=(e.x/c+this.left);var f=(this.top-e.y/c);if(this.inValidRange(a,f)){d.setAttributeNS(null,"cx",a);d.setAttributeNS(null,"cy",f);d.setAttributeNS(null,"r",b);return d}else{return false}},drawLineString:function(b,c){var a=this.getComponentsString(c.components);if(a.path){b.setAttributeNS(null,"points",a.path);return(a.complete?b:null)}else{return false}},drawLinearRing:function(b,c){var a=this.getComponentsString(c.components);if(a.path){b.setAttributeNS(null,"points",a.path);return(a.complete?b:null)}else{return false}},drawPolygon:function(b,h){var g="";var i=true;var a=true;var c,k;for(var e=0,f=h.components.length;e<f;e++){g+=" M";c=this.getComponentsString(h.components[e].components," ");k=c.path;if(k){g+=" "+k;a=c.complete&&a}else{i=false}}g+=" z";if(i){b.setAttributeNS(null,"d",g);
b.setAttributeNS(null,"fill-rule","evenodd");return a?b:null}else{return false}},drawRectangle:function(c,d){var b=this.getResolution();var a=(d.x/b+this.left);var e=(this.top-d.y/b);if(this.inValidRange(a,e)){c.setAttributeNS(null,"x",a);c.setAttributeNS(null,"y",e);c.setAttributeNS(null,"width",d.width/b);c.setAttributeNS(null,"height",d.height/b);return c}else{return false}},drawSurface:function(f,h){var g=null;var b=true;for(var e=0,a=h.components.length;e<a;e++){if((e%3)==0&&(e/3)==0){var c=this.getShortString(h.components[e]);if(!c){b=false}g="M "+c}else{if((e%3)==1){var c=this.getShortString(h.components[e]);if(!c){b=false}g+=" C "+c}else{var c=this.getShortString(h.components[e]);if(!c){b=false}g+=" "+c}}}g+=" Z";if(b){f.setAttributeNS(null,"d",g);return f}else{return false}},drawText:function(c,a,i){var b=this.getResolution();var h=(i.x/b+this.left);var e=(i.y/b-this.top);var g=this.nodeFactory(c+this.LABEL_ID_SUFFIX,"text");var f=this.nodeFactory(c+this.LABEL_ID_SUFFIX+"_tspan","tspan");g.setAttributeNS(null,"x",h);g.setAttributeNS(null,"y",-e);if(a.fontColor){g.setAttributeNS(null,"fill",a.fontColor)}if(a.fontOpacity){g.setAttributeNS(null,"opacity",a.fontOpacity)}if(a.fontFamily){g.setAttributeNS(null,"font-family",a.fontFamily)}if(a.fontSize){g.setAttributeNS(null,"font-size",a.fontSize)}if(a.fontWeight){g.setAttributeNS(null,"font-weight",a.fontWeight)}if(a.labelSelect===true){g.setAttributeNS(null,"pointer-events","visible");g._featureId=c;f._featureId=c;f._geometry=i;f._geometryClass=i.CLASS_NAME}else{g.setAttributeNS(null,"pointer-events","none")}var d=a.labelAlign||"cm";g.setAttributeNS(null,"text-anchor",OpenLayers.Renderer.SVG.LABEL_ALIGN[d[0]]||"middle");if(this.isGecko){g.setAttributeNS(null,"dominant-baseline",OpenLayers.Renderer.SVG.LABEL_ALIGN[d[1]]||"central")}else{f.setAttributeNS(null,"baseline-shift",OpenLayers.Renderer.SVG.LABEL_VSHIFT[d[1]]||"-35%")}f.textContent=a.label;if(!g.parentNode){g.appendChild(f);this.textRoot.appendChild(g)}},getComponentsString:function(d,c){var f=[];var a=true;var e=d.length;var j=[];var g,h;for(var b=0;b<e;b++){h=d[b];f.push(h);g=this.getShortString(h);if(g){j.push(g)}else{if(b>0){if(this.getShortString(d[b-1])){j.push(this.clipLine(d[b],d[b-1]))}}if(b<e-1){if(this.getShortString(d[b+1])){j.push(this.clipLine(d[b],d[b+1]))}}a=false}}return{path:j.join(c||","),complete:a}},clipLine:function(e,h){if(h.equals(e)){return""}var f=this.getResolution();var b=this.MAX_PIXEL-this.translationParameters.x;var a=this.MAX_PIXEL-this.translationParameters.y;var d=h.x/f+this.left;var j=this.top-h.y/f;var c=e.x/f+this.left;var i=this.top-e.y/f;var g;if(c<-b||c>b){g=(i-j)/(c-d);c=c<0?-b:b;i=j+(c-d)*g}if(i<-a||i>a){g=(c-d)/(i-j);i=i<0?-a:a;c=d+(i-j)*g}return c+","+i},getShortString:function(b){var c=this.getResolution();var a=(b.x/c+this.left);var d=(this.top-b.y/c);if(this.inValidRange(a,d)){return a+","+d}else{return false}},getPosition:function(a){return({x:parseFloat(a.getAttributeNS(null,"cx")),y:parseFloat(a.getAttributeNS(null,"cy"))})},importSymbol:function(e){if(!this.defs){this.defs=this.createDefs()}var b=this.container.id+"-"+e;if(document.getElementById(b)!=null){return b}var d=OpenLayers.Renderer.symbol[e];if(!d){throw new Error(e+" is not a valid symbol name")}var g=this.nodeFactory(b,"symbol");var c=this.nodeFactory(null,"polygon");g.appendChild(c);var m=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0);var k=[];var j,h;for(var f=0;f<d.length;f=f+2){j=d[f];h=d[f+1];m.left=Math.min(m.left,j);m.bottom=Math.min(m.bottom,h);m.right=Math.max(m.right,j);m.top=Math.max(m.top,h);k.push(j,",",h)}c.setAttributeNS(null,"points",k.join(" "));var a=m.getWidth();var l=m.getHeight();var n=[m.left-a,m.bottom-l,a*3,l*3];g.setAttributeNS(null,"viewBox",n.join(" "));this.symbolMetrics[b]=[Math.max(a,l),m.getCenterLonLat().lon,m.getCenterLonLat().lat];this.defs.appendChild(g);return g.id},getFeatureIdFromEvent:function(a){var c=OpenLayers.Renderer.Elements.prototype.getFeatureIdFromEvent.apply(this,arguments);
if(this.supportUse===false&&!c){var b=a.target;c=b.parentNode&&b!=this.rendererRoot&&b.parentNode._featureId}return c},CLASS_NAME:"OpenLayers.Renderer.SVG"});OpenLayers.Renderer.SVG.LABEL_ALIGN={l:"start",r:"end",b:"bottom",t:"hanging"};OpenLayers.Renderer.SVG.LABEL_VSHIFT={t:"-70%",b:"0"};OpenLayers.Renderer.VML=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"urn:schemas-microsoft-com:vml",symbolCache:{},offset:null,initialize:function(b){if(!this.supported()){return}if(!document.namespaces.olv){document.namespaces.add("olv",this.xmlns);var e=document.createStyleSheet();var c=["shape","rect","oval","fill","stroke","imagedata","group","textbox"];for(var d=0,a=c.length;d<a;d++){e.addRule("olv\\:"+c[d],"behavior: url(#default#VML); position: absolute; display: inline-block;")}}OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments)},destroy:function(){OpenLayers.Renderer.Elements.prototype.destroy.apply(this,arguments)},supported:function(){return !!(document.namespaces)},setExtent:function(j,a){OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments);var c=this.getResolution();var b=(j.left/c)|0;var f=(j.top/c-this.size.h)|0;if(a||!this.offset){this.offset={x:b,y:f};b=0;f=0}else{b=b-this.offset.x;f=f-this.offset.y}var l=b+" "+f;this.root.coordorigin=l;var h=[this.root,this.vectorRoot,this.textRoot];var g;for(var d=0,e=h.length;d<e;++d){g=h[d];var k=this.size.w+" "+this.size.h;g.coordsize=k}this.root.style.flip="y";return true},setSize:function(f){OpenLayers.Renderer.prototype.setSize.apply(this,arguments);var d=[this.rendererRoot,this.root,this.vectorRoot,this.textRoot];var c=this.size.w+"px";var g=this.size.h+"px";var b;for(var e=0,a=d.length;e<a;++e){b=d[e];b.style.width=c;b.style.height=g}},getNodeType:function(c,b){var a=null;switch(c.CLASS_NAME){case"OpenLayers.Geometry.Point":if(b.externalGraphic){a="olv:rect"}else{if(this.isComplexSymbol(b.graphicName)){a="olv:shape"}else{a="olv:oval"}}break;case"OpenLayers.Geometry.Rectangle":a="olv:rect";break;case"OpenLayers.Geometry.LineString":case"OpenLayers.Geometry.LinearRing":case"OpenLayers.Geometry.Polygon":case"OpenLayers.Geometry.Curve":case"OpenLayers.Geometry.Surface":a="olv:shape";break;default:break}return a},setStyle:function(e,b,q,k){b=b||e._style;q=q||e._options;var c=b.fillColor;if(e._geometryClass==="OpenLayers.Geometry.Point"){if(b.externalGraphic){if(b.graphicTitle){e.title=b.graphicTitle}var d=b.graphicWidth||b.graphicHeight;var l=b.graphicHeight||b.graphicWidth;d=d?d:b.pointRadius*2;l=l?l:b.pointRadius*2;var g=this.getResolution();var i=(b.graphicXOffset!=undefined)?b.graphicXOffset:-(0.5*d);var f=(b.graphicYOffset!=undefined)?b.graphicYOffset:-(0.5*l);e.style.left=(((k.x/g-this.offset.x)+i)|0)+"px";e.style.top=(((k.y/g-this.offset.y)-(f+l))|0)+"px";e.style.width=d+"px";e.style.height=l+"px";e.style.flip="y";c="none";q.isStroked=false}else{if(this.isComplexSymbol(b.graphicName)){var a=this.importSymbol(b.graphicName);e.path=a.path;e.coordorigin=a.left+","+a.bottom;var p=a.size;e.coordsize=p+","+p;this.drawCircle(e,k,b.pointRadius);e.style.flip="y"}else{this.drawCircle(e,k,b.pointRadius)}}}if(q.isFilled){e.fillcolor=c}else{e.filled="false"}var j=e.getElementsByTagName("fill");var o=(j.length==0)?null:j[0];if(!q.isFilled){if(o){e.removeChild(o)}}else{if(!o){o=this.createNode("olv:fill",e.id+"_fill")}o.opacity=b.fillOpacity;if(e._geometryClass==="OpenLayers.Geometry.Point"&&b.externalGraphic){if(b.graphicOpacity){o.opacity=b.graphicOpacity}o.src=b.externalGraphic;o.type="frame";if(!(b.graphicWidth&&b.graphicHeight)){o.aspect="atmost"}}if(o.parentNode!=e){e.appendChild(o)}}var n=b.rotation;if((n!==undefined||e._rotation!==undefined)){e._rotation=n;if(b.externalGraphic){this.graphicRotate(e,i,f,b);o.opacity=0}else{if(e._geometryClass==="OpenLayers.Geometry.Point"){e.style.rotation=n||0}}}var h=e.getElementsByTagName("stroke");var m=(h.length==0)?null:h[0];if(!q.isStroked){e.stroked=false;if(m){m.on=false}}else{if(!m){m=this.createNode("olv:stroke",e.id+"_stroke");
e.appendChild(m)}m.on=true;m.color=b.strokeColor;m.weight=b.strokeWidth+"px";m.opacity=b.strokeOpacity;m.endcap=b.strokeLinecap=="butt"?"flat":(b.strokeLinecap||"round");if(b.strokeDashstyle){m.dashstyle=this.dashStyle(b)}}if(b.cursor!="inherit"&&b.cursor!=null){e.style.cursor=b.cursor}return e},graphicRotate:function(n,r,e,q){var q=q||n._style;var o=q.rotation||0;var a,j;if(!(q.graphicWidth&&q.graphicHeight)){var s=new Image();s.onreadystatechange=OpenLayers.Function.bind(function(){if(s.readyState=="complete"||s.readyState=="interactive"){a=s.width/s.height;j=Math.max(q.pointRadius*2,q.graphicWidth||0,q.graphicHeight||0);r=r*a;q.graphicWidth=j*a;q.graphicHeight=j;this.graphicRotate(n,r,e,q)}},this);s.src=q.externalGraphic;return}else{j=Math.max(q.graphicWidth,q.graphicHeight);a=q.graphicWidth/q.graphicHeight}var m=Math.round(q.graphicWidth||j*a);var k=Math.round(q.graphicHeight||j);n.style.width=m+"px";n.style.height=k+"px";var l=document.getElementById(n.id+"_image");if(!l){l=this.createNode("olv:imagedata",n.id+"_image");n.appendChild(l)}l.style.width=m+"px";l.style.height=k+"px";l.src=q.externalGraphic;l.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='', sizingMethod='scale')";var f=o*Math.PI/180;var h=Math.sin(f);var d=Math.cos(f);var g="progid:DXImageTransform.Microsoft.Matrix(M11="+d+",M12="+(-h)+",M21="+h+",M22="+d+",SizingMethod='auto expand')\n";var b=q.graphicOpacity||q.fillOpacity;if(b&&b!=1){g+="progid:DXImageTransform.Microsoft.BasicImage(opacity="+b+")\n"}n.style.filter=g;var p=new OpenLayers.Geometry.Point(-r,-e);var c=new OpenLayers.Bounds(0,0,m,k).toGeometry();c.rotate(q.rotation,p);var i=c.getBounds();n.style.left=Math.round(parseInt(n.style.left)+i.left)+"px";n.style.top=Math.round(parseInt(n.style.top)-i.bottom)+"px"},postDraw:function(a){a.style.visibility="visible";var c=a._style.fillColor;var b=a._style.strokeColor;if(c=="none"&&a.fillcolor!=c){a.fillcolor=c}if(b=="none"&&a.strokecolor!=b){a.strokecolor=b}},setNodeDimension:function(b,e){var d=e.getBounds();if(d){var a=this.getResolution();var c=new OpenLayers.Bounds((d.left/a-this.offset.x)|0,(d.bottom/a-this.offset.y)|0,(d.right/a-this.offset.x)|0,(d.top/a-this.offset.y)|0);b.style.left=c.left+"px";b.style.top=c.top+"px";b.style.width=c.getWidth()+"px";b.style.height=c.getHeight()+"px";b.coordorigin=c.left+" "+c.top;b.coordsize=c.getWidth()+" "+c.getHeight()}},dashStyle:function(a){var c=a.strokeDashstyle;switch(c){case"solid":case"dot":case"dash":case"dashdot":case"longdash":case"longdashdot":return c;default:var b=c.split(/[ ,]/);if(b.length==2){if(1*b[0]>=2*b[1]){return"longdash"}return(b[0]==1||b[1]==1)?"dot":"dash"}else{if(b.length==4){return(1*b[0]>=2*b[1])?"longdashdot":"dashdot"}}return"solid"}},createNode:function(a,c){var b=document.createElement(a);if(c){b.id=c}b.unselectable="on";b.onselectstart=OpenLayers.Function.False;return b},nodeTypeCompare:function(c,b){var d=b;var a=d.indexOf(":");if(a!=-1){d=d.substr(a+1)}var e=c.nodeName;a=e.indexOf(":");if(a!=-1){e=e.substr(a+1)}return(d==e)},createRenderRoot:function(){return this.nodeFactory(this.container.id+"_vmlRoot","div")},createRoot:function(a){return this.nodeFactory(this.container.id+a,"olv:group")},drawPoint:function(a,b){return this.drawCircle(a,b,1)},drawCircle:function(d,e,a){if(!isNaN(e.x)&&!isNaN(e.y)){var b=this.getResolution();d.style.left=(((e.x/b-this.offset.x)|0)-a)+"px";d.style.top=(((e.y/b-this.offset.y)|0)-a)+"px";var c=a*2;d.style.width=c+"px";d.style.height=c+"px";return d}return false},drawLineString:function(a,b){return this.drawLine(a,b,false)},drawLinearRing:function(a,b){return this.drawLine(a,b,true)},drawLine:function(b,k,g){this.setNodeDimension(b,k);var c=this.getResolution();var a=k.components.length;var e=new Array(a);var h,l,j;for(var f=0;f<a;f++){h=k.components[f];l=(h.x/c-this.offset.x)|0;j=(h.y/c-this.offset.y)|0;e[f]=" "+l+","+j+" l "}var d=(g)?" x e":" e";b.path="m"+e.join("")+d;return b},drawPolygon:function(b,l){this.setNodeDimension(b,l);
var c=this.getResolution();var n=[];var f,e,d,h,a,g,m,k;for(d=0,h=l.components.length;d<h;d++){f=l.components[d];n.push("m");for(e=0,a=f.components.length;e<a;e++){g=f.components[e];m=(g.x/c-this.offset.x)|0;k=(g.y/c-this.offset.y)|0;n.push(" "+m+","+k);if(e==0){n.push(" l")}}n.push(" x ")}n.push("e");b.path=n.join("");return b},drawRectangle:function(b,c){var a=this.getResolution();b.style.left=((c.x/a-this.offset.x)|0)+"px";b.style.top=((c.y/a-this.offset.y)|0)+"px";b.style.width=((c.width/a)|0)+"px";b.style.height=((c.height/a)|0)+"px";return b},drawText:function(d,a,h){var g=this.nodeFactory(d+this.LABEL_ID_SUFFIX,"olv:rect");var f=this.nodeFactory(d+this.LABEL_ID_SUFFIX+"_textbox","olv:textbox");var c=this.getResolution();g.style.left=((h.x/c-this.offset.x)|0)+"px";g.style.top=((h.y/c-this.offset.y)|0)+"px";g.style.flip="y";f.innerText=a.label;if(a.fontColor){f.style.color=a.fontColor}if(a.fontOpacity){f.style.filter="alpha(opacity="+(a.fontOpacity*100)+")"}if(a.fontFamily){f.style.fontFamily=a.fontFamily}if(a.fontSize){f.style.fontSize=a.fontSize}if(a.fontWeight){f.style.fontWeight=a.fontWeight}if(a.labelSelect===true){g._featureId=d;f._featureId=d;f._geometry=h;f._geometryClass=h.CLASS_NAME}f.style.whiteSpace="nowrap";f.inset="1px,0px,0px,0px";if(!g.parentNode){g.appendChild(f);this.textRoot.appendChild(g)}var e=a.labelAlign||"cm";if(e.length==1){e+="m"}var i=f.clientWidth*(OpenLayers.Renderer.VML.LABEL_SHIFT[e.substr(0,1)]);var b=f.clientHeight*(OpenLayers.Renderer.VML.LABEL_SHIFT[e.substr(1,1)]);g.style.left=parseInt(g.style.left)-i-1+"px";g.style.top=parseInt(g.style.top)+b+"px"},drawSurface:function(a,g){this.setNodeDimension(a,g);var b=this.getResolution();var j=[];var d,h,f;for(var c=0,e=g.components.length;c<e;c++){d=g.components[c];h=(d.x/b-this.offset.x)|0;f=(d.y/b-this.offset.y)|0;if((c%3)==0&&(c/3)==0){j.push("m")}else{if((c%3)==1){j.push(" c")}}j.push(" "+h+","+f)}j.push(" x e");a.path=j.join("");return a},moveRoot:function(b){var a=this.map.getLayer(b.container.id);if(a instanceof OpenLayers.Layer.Vector.RootContainer){a=this.map.getLayer(this.container.id)}a&&a.renderer.clear();OpenLayers.Renderer.Elements.prototype.moveRoot.apply(this,arguments);a&&a.redraw()},importSymbol:function(d){var b=this.container.id+"-"+d;var a=this.symbolCache[b];if(a){return a}var c=OpenLayers.Renderer.symbol[d];if(!c){throw new Error(d+" is not a valid symbol name")}var k=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0);var e=["m"];for(var f=0;f<c.length;f=f+2){var h=c[f];var g=c[f+1];k.left=Math.min(k.left,h);k.bottom=Math.min(k.bottom,g);k.right=Math.max(k.right,h);k.top=Math.max(k.top,g);e.push(h);e.push(g);if(f==0){e.push("l")}}e.push("x e");var l=e.join(" ");var j=(k.getWidth()-k.getHeight())/2;if(j>0){k.bottom=k.bottom-j;k.top=k.top+j}else{k.left=k.left+j;k.right=k.right-j}a={path:l,size:k.getWidth(),left:k.left,bottom:k.bottom};this.symbolCache[b]=a;return a},CLASS_NAME:"OpenLayers.Renderer.VML"});OpenLayers.Renderer.VML.LABEL_SHIFT={l:0,c:0.5,r:1,t:0,m:0.5,b:1};OpenLayers.Tile=OpenLayers.Class({EVENT_TYPES:["loadstart","loadend","reload","unload"],events:null,id:null,layer:null,url:null,bounds:null,size:null,position:null,isLoading:false,initialize:function(d,a,e,b,c){this.layer=d;this.position=a.clone();this.bounds=e.clone();this.url=b;this.size=c.clone();this.id=OpenLayers.Util.createUniqueID("Tile_");this.events=new OpenLayers.Events(this,null,this.EVENT_TYPES)},unload:function(){if(this.isLoading){this.isLoading=false;this.events.triggerEvent("unload")}},destroy:function(){this.layer=null;this.bounds=null;this.size=null;this.position=null;this.events.destroy();this.events=null},clone:function(a){if(a==null){a=new OpenLayers.Tile(this.layer,this.position,this.bounds,this.url,this.size)}OpenLayers.Util.applyDefaults(a,this);return a},draw:function(){var a=this.layer.maxExtent;var b=(a&&this.bounds.intersectsBounds(a,false));this.shouldDraw=(b||this.layer.displayOutsideMaxExtent);this.clear();return this.shouldDraw
},moveTo:function(b,a,c){if(c==null){c=true}this.bounds=b.clone();this.position=a.clone();if(c){this.draw()}},clear:function(){},getBoundsFromBaseLayer:function(a){var f=OpenLayers.i18n("reprojectDeprecated",{layerName:this.layer.name});OpenLayers.Console.warn(f);var d=this.layer.map.getLonLatFromLayerPx(a);var c=a.clone();c.x+=this.size.w;c.y+=this.size.h;var b=this.layer.map.getLonLatFromLayerPx(c);if(d.lon>b.lon){if(d.lon<0){d.lon=-180-(d.lon+180)}else{b.lon=180+b.lon+180}}var e=new OpenLayers.Bounds(d.lon,b.lat,b.lon,d.lat);return e},showTile:function(){if(this.shouldDraw){this.show()}},show:function(){},hide:function(){},CLASS_NAME:"OpenLayers.Tile"});OpenLayers.Control.MouseToolbar=OpenLayers.Class(OpenLayers.Control.MouseDefaults,{mode:null,buttons:null,direction:"vertical",buttonClicked:null,initialize:function(a,b){OpenLayers.Control.prototype.initialize.apply(this,arguments);this.position=new OpenLayers.Pixel(OpenLayers.Control.MouseToolbar.X,OpenLayers.Control.MouseToolbar.Y);if(a){this.position=a}if(b){this.direction=b}this.measureDivs=[]},destroy:function(){for(var b in this.buttons){var a=this.buttons[b];a.map=null;a.events.destroy()}OpenLayers.Control.MouseDefaults.prototype.destroy.apply(this,arguments)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);OpenLayers.Control.MouseDefaults.prototype.draw.apply(this,arguments);this.buttons={};var b=new OpenLayers.Size(28,28);var a=new OpenLayers.Pixel(OpenLayers.Control.MouseToolbar.X,0);this._addButton("zoombox","drag-rectangle-off.png","drag-rectangle-on.png",a,b,"Shift->Drag to zoom to area");a=a.add((this.direction=="vertical"?0:b.w),(this.direction=="vertical"?b.h:0));this._addButton("pan","panning-hand-off.png","panning-hand-on.png",a,b,"Drag the map to pan.");a=a.add((this.direction=="vertical"?0:b.w),(this.direction=="vertical"?b.h:0));this.switchModeTo("pan");return this.div},_addButton:function(a,e,d,i,g,h){var f=OpenLayers.Util.getImagesLocation()+e;var c=OpenLayers.Util.getImagesLocation()+d;var b=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MouseToolbar_"+a,i,g,f,"absolute");this.div.appendChild(b);b.imgLocation=f;b.activeImgLocation=c;b.events=new OpenLayers.Events(this,b,null,true);b.events.on({mousedown:this.buttonDown,mouseup:this.buttonUp,dblclick:OpenLayers.Event.stop,scope:this});b.action=a;b.title=h;b.alt=h;b.map=this.map;this.buttons[a]=b;return b},buttonDown:function(a){if(!OpenLayers.Event.isLeftClick(a)){return}this.buttonClicked=a.element.action;OpenLayers.Event.stop(a)},buttonUp:function(a){if(!OpenLayers.Event.isLeftClick(a)){return}if(this.buttonClicked!=null){if(this.buttonClicked==a.element.action){this.switchModeTo(a.element.action)}OpenLayers.Event.stop(a);this.buttonClicked=null}},defaultDblClick:function(b){this.switchModeTo("pan");this.performedDrag=false;var a=this.map.getLonLatFromViewPortPx(b.xy);this.map.setCenter(a,this.map.zoom+1);OpenLayers.Event.stop(b);return false},defaultMouseDown:function(a){if(!OpenLayers.Event.isLeftClick(a)){return}this.mouseDragStart=a.xy.clone();this.performedDrag=false;this.startViaKeyboard=false;if(a.shiftKey&&this.mode!="zoombox"){this.switchModeTo("zoombox");this.startViaKeyboard=true}else{if(a.altKey&&this.mode!="measure"){this.switchModeTo("measure")}else{if(!this.mode){this.switchModeTo("pan")}}}switch(this.mode){case"zoombox":this.map.div.style.cursor="crosshair";this.zoomBox=OpenLayers.Util.createDiv("zoomBox",this.mouseDragStart,null,null,"absolute","2px solid red");this.zoomBox.style.backgroundColor="white";this.zoomBox.style.filter="alpha(opacity=50)";this.zoomBox.style.opacity="0.50";this.zoomBox.style.fontSize="1px";this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1;this.map.viewPortDiv.appendChild(this.zoomBox);this.performedDrag=true;break;case"measure":var c="";if(this.measureStart){var b=this.map.getLonLatFromViewPortPx(this.mouseDragStart);c=OpenLayers.Util.distVincenty(this.measureStart,b);c=Math.round(c*100)/100;c=c+"km";this.measureStartBox=this.measureBox
}this.measureStart=this.map.getLonLatFromViewPortPx(this.mouseDragStart);this.measureBox=OpenLayers.Util.createDiv(null,this.mouseDragStart.add(-2-parseInt(this.map.layerContainerDiv.style.left),-2-parseInt(this.map.layerContainerDiv.style.top)),null,null,"absolute");this.measureBox.style.width="4px";this.measureBox.style.height="4px";this.measureBox.style.fontSize="1px";this.measureBox.style.backgroundColor="red";this.measureBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1;this.map.layerContainerDiv.appendChild(this.measureBox);if(c){this.measureBoxDistance=OpenLayers.Util.createDiv(null,this.mouseDragStart.add(-2-parseInt(this.map.layerContainerDiv.style.left),2-parseInt(this.map.layerContainerDiv.style.top)),null,null,"absolute");this.measureBoxDistance.innerHTML=c;this.measureBoxDistance.style.zIndex=this.map.Z_INDEX_BASE.Popup-1;this.map.layerContainerDiv.appendChild(this.measureBoxDistance);this.measureDivs.push(this.measureBoxDistance)}this.measureBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1;this.map.layerContainerDiv.appendChild(this.measureBox);this.measureDivs.push(this.measureBox);break;default:this.map.div.style.cursor="move";break}document.onselectstart=OpenLayers.Function.False;OpenLayers.Event.stop(a)},switchModeTo:function(c){if(c!=this.mode){if(this.mode&&this.buttons[this.mode]){OpenLayers.Util.modifyAlphaImageDiv(this.buttons[this.mode],null,null,null,this.buttons[this.mode].imgLocation)}if(this.mode=="measure"&&c!="measure"){for(var b=0,a=this.measureDivs.length;b<a;b++){if(this.measureDivs[b]){this.map.layerContainerDiv.removeChild(this.measureDivs[b])}}this.measureDivs=[];this.measureStart=null}this.mode=c;if(this.buttons[c]){OpenLayers.Util.modifyAlphaImageDiv(this.buttons[c],null,null,null,this.buttons[c].activeImgLocation)}switch(this.mode){case"zoombox":this.map.div.style.cursor="crosshair";break;default:this.map.div.style.cursor="";break}}},leaveMode:function(){this.switchModeTo("pan")},defaultMouseMove:function(e){if(this.mouseDragStart!=null){switch(this.mode){case"zoombox":var d=Math.abs(this.mouseDragStart.x-e.xy.x);var b=Math.abs(this.mouseDragStart.y-e.xy.y);this.zoomBox.style.width=Math.max(1,d)+"px";this.zoomBox.style.height=Math.max(1,b)+"px";if(e.xy.x<this.mouseDragStart.x){this.zoomBox.style.left=e.xy.x+"px"}if(e.xy.y<this.mouseDragStart.y){this.zoomBox.style.top=e.xy.y+"px"}break;default:var d=this.mouseDragStart.x-e.xy.x;var b=this.mouseDragStart.y-e.xy.y;var f=this.map.getSize();var a=new OpenLayers.Pixel(f.w/2+d,f.h/2+b);var c=this.map.getLonLatFromViewPortPx(a);this.map.setCenter(c,null,true);this.mouseDragStart=e.xy.clone()}this.performedDrag=true}},defaultMouseUp:function(a){if(!OpenLayers.Event.isLeftClick(a)){return}switch(this.mode){case"zoombox":this.zoomBoxEnd(a);if(this.startViaKeyboard){this.leaveMode()}break;case"pan":if(this.performedDrag){this.map.setCenter(this.map.center)}}document.onselectstart=null;this.mouseDragStart=null;this.map.div.style.cursor="default"},defaultMouseOut:function(a){if(this.mouseDragStart!=null&&OpenLayers.Util.mouseLeft(a,this.map.div)){if(this.zoomBox){this.removeZoomBox();if(this.startViaKeyboard){this.leaveMode()}}this.mouseDragStart=null;this.map.div.style.cursor="default"}},defaultClick:function(a){if(this.performedDrag){this.performedDrag=false;return false}},CLASS_NAME:"OpenLayers.Control.MouseToolbar"});OpenLayers.Control.MouseToolbar.X=6;OpenLayers.Control.MouseToolbar.Y=300;OpenLayers.Control.NavigationHistory=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOGGLE,previous:null,previousOptions:null,next:null,nextOptions:null,limit:50,autoActivate:true,clearOnDeactivate:false,registry:null,nextStack:null,previousStack:null,listeners:null,restoring:false,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,[a]);this.registry=OpenLayers.Util.extend({moveend:this.getState},this.registry);var b={trigger:OpenLayers.Function.bind(this.previousTrigger,this),displayClass:this.displayClass+" "+this.displayClass+"Previous"};
OpenLayers.Util.extend(b,this.previousOptions);this.previous=new OpenLayers.Control.Button(b);var c={trigger:OpenLayers.Function.bind(this.nextTrigger,this),displayClass:this.displayClass+" "+this.displayClass+"Next"};OpenLayers.Util.extend(c,this.nextOptions);this.next=new OpenLayers.Control.Button(c);this.clear()},onPreviousChange:function(b,a){if(b&&!this.previous.active){this.previous.activate()}else{if(!b&&this.previous.active){this.previous.deactivate()}}},onNextChange:function(b,a){if(b&&!this.next.active){this.next.activate()}else{if(!b&&this.next.active){this.next.deactivate()}}},destroy:function(){OpenLayers.Control.prototype.destroy.apply(this);this.previous.destroy();this.next.destroy();this.deactivate();for(var a in this){this[a]=null}},setMap:function(a){this.map=a;this.next.setMap(a);this.previous.setMap(a)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.next.draw();this.previous.draw()},previousTrigger:function(){var b=this.previousStack.shift();var a=this.previousStack.shift();if(a!=undefined){this.nextStack.unshift(b);this.previousStack.unshift(a);this.restoring=true;this.restore(a);this.restoring=false;this.onNextChange(this.nextStack[0],this.nextStack.length);this.onPreviousChange(this.previousStack[1],this.previousStack.length-1)}else{this.previousStack.unshift(b)}return a},nextTrigger:function(){var a=this.nextStack.shift();if(a!=undefined){this.previousStack.unshift(a);this.restoring=true;this.restore(a);this.restoring=false;this.onNextChange(this.nextStack[0],this.nextStack.length);this.onPreviousChange(this.previousStack[1],this.previousStack.length-1)}return a},clear:function(){this.previousStack=[];this.previous.deactivate();this.nextStack=[];this.next.deactivate()},getState:function(){return{center:this.map.getCenter(),resolution:this.map.getResolution(),projection:this.map.getProjectionObject(),units:this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units}},restore:function(e){var a,d;if(this.map.getProjectionObject()==e.projection){d=this.map.getZoomForResolution(e.resolution);a=e.center}else{a=e.center.clone();a.transform(e.projection,this.map.getProjectionObject());var f=e.units;var b=this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units;var c=f&&b?OpenLayers.INCHES_PER_UNIT[f]/OpenLayers.INCHES_PER_UNIT[b]:1;d=this.map.getZoomForResolution(c*e.resolution)}this.map.setCenter(a,d)},setListeners:function(){this.listeners={};for(var a in this.registry){this.listeners[a]=OpenLayers.Function.bind(function(){if(!this.restoring){var b=this.registry[a].apply(this,arguments);this.previousStack.unshift(b);if(this.previousStack.length>1){this.onPreviousChange(this.previousStack[1],this.previousStack.length-1)}if(this.previousStack.length>(this.limit+1)){this.previousStack.pop()}if(this.nextStack.length>0){this.nextStack=[];this.onNextChange(null,0)}}return true},this)}},activate:function(){var a=false;if(this.map){if(OpenLayers.Control.prototype.activate.apply(this)){if(this.listeners==null){this.setListeners()}for(var b in this.listeners){this.map.events.register(b,this,this.listeners[b])}a=true;if(this.previousStack.length==0){this.initStack()}}}return a},initStack:function(){if(this.map.getCenter()){this.listeners.moveend()}},deactivate:function(){var b=false;if(this.map){if(OpenLayers.Control.prototype.deactivate.apply(this)){for(var a in this.listeners){this.map.events.unregister(a,this,this.listeners[a])}if(this.clearOnDeactivate){this.clear()}b=true}}return b},CLASS_NAME:"OpenLayers.Control.NavigationHistory"});OpenLayers.Control.PanPanel=OpenLayers.Class(OpenLayers.Control.Panel,{slideFactor:50,initialize:function(a){OpenLayers.Control.Panel.prototype.initialize.apply(this,[a]);this.addControls([new OpenLayers.Control.Pan(OpenLayers.Control.Pan.NORTH,{slideFactor:this.slideFactor}),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.SOUTH,{slideFactor:this.slideFactor}),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.EAST,{slideFactor:this.slideFactor}),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.WEST,{slideFactor:this.slideFactor})])
},CLASS_NAME:"OpenLayers.Control.PanPanel"});OpenLayers.Control.PanZoomBar=OpenLayers.Class(OpenLayers.Control.PanZoom,{zoomStopWidth:18,zoomStopHeight:11,slider:null,sliderEvents:null,zoombarDiv:null,divEvents:null,zoomWorldIcon:false,forceFixedZoomLevel:false,mouseDragStart:null,zoomStart:null,initialize:function(){OpenLayers.Control.PanZoom.prototype.initialize.apply(this,arguments)},destroy:function(){this._removeZoomBar();this.map.events.un({changebaselayer:this.redraw,scope:this});OpenLayers.Control.PanZoom.prototype.destroy.apply(this,arguments);delete this.mouseDragStart;delete this.zoomStart},setMap:function(a){OpenLayers.Control.PanZoom.prototype.setMap.apply(this,arguments);this.map.events.register("changebaselayer",this,this.redraw)},redraw:function(){if(this.div!=null){this.removeButtons();this._removeZoomBar()}this.draw()},draw:function(b){OpenLayers.Control.prototype.draw.apply(this,arguments);b=this.position.clone();this.buttons=[];var d=new OpenLayers.Size(18,18);var a=new OpenLayers.Pixel(b.x+d.w/2,b.y);var c=d.w;if(this.zoomWorldIcon){a=new OpenLayers.Pixel(b.x+d.w,b.y)}this._addButton("panup","north-mini.png",a,d);b.y=a.y+d.h;this._addButton("panleft","west-mini.png",b,d);if(this.zoomWorldIcon){this._addButton("zoomworld","zoom-world-mini.png",b.add(d.w,0),d);c*=2}this._addButton("panright","east-mini.png",b.add(c,0),d);this._addButton("pandown","south-mini.png",a.add(0,d.h*2),d);this._addButton("zoomin","zoom-plus-mini.png",a.add(0,d.h*3+5),d);a=this._addZoomBar(a.add(0,d.h*4+5));this._addButton("zoomout","zoom-minus-mini.png",a,d);return this.div},_addZoomBar:function(a){var e=OpenLayers.Util.getImagesLocation();var g=this.id+"_"+this.map.id;var b=this.map.getNumZoomLevels()-1-this.map.getZoom();var c=OpenLayers.Util.createAlphaImageDiv(g,a.add(-1,b*this.zoomStopHeight),new OpenLayers.Size(20,9),e+"slider.png","absolute");this.slider=c;this.sliderEvents=new OpenLayers.Events(this,c,null,true,{includeXY:true});this.sliderEvents.on({mousedown:this.zoomBarDown,mousemove:this.zoomBarDrag,mouseup:this.zoomBarUp,dblclick:this.doubleClick,click:this.doubleClick});var d=new OpenLayers.Size();d.h=this.zoomStopHeight*this.map.getNumZoomLevels();d.w=this.zoomStopWidth;var f=null;if(OpenLayers.Util.alphaHack()){var g=this.id+"_"+this.map.id;f=OpenLayers.Util.createAlphaImageDiv(g,a,new OpenLayers.Size(d.w,this.zoomStopHeight),e+"zoombar.png","absolute",null,"crop");f.style.height=d.h+"px"}else{f=OpenLayers.Util.createDiv("OpenLayers_Control_PanZoomBar_Zoombar"+this.map.id,a,d,e+"zoombar.png")}this.zoombarDiv=f;this.divEvents=new OpenLayers.Events(this,f,null,true,{includeXY:true});this.divEvents.on({mousedown:this.divClick,mousemove:this.passEventToSlider,dblclick:this.doubleClick,click:this.doubleClick});this.div.appendChild(f);this.startTop=parseInt(f.style.top);this.div.appendChild(c);this.map.events.register("zoomend",this,this.moveZoomBar);a=a.add(0,this.zoomStopHeight*this.map.getNumZoomLevels());return a},_removeZoomBar:function(){this.sliderEvents.un({mousedown:this.zoomBarDown,mousemove:this.zoomBarDrag,mouseup:this.zoomBarUp,dblclick:this.doubleClick,click:this.doubleClick});this.sliderEvents.destroy();this.divEvents.un({mousedown:this.divClick,mousemove:this.passEventToSlider,dblclick:this.doubleClick,click:this.doubleClick});this.divEvents.destroy();this.div.removeChild(this.zoombarDiv);this.zoombarDiv=null;this.div.removeChild(this.slider);this.slider=null;this.map.events.unregister("zoomend",this,this.moveZoomBar)},passEventToSlider:function(a){this.sliderEvents.handleBrowserEvent(a)},divClick:function(a){if(!OpenLayers.Event.isLeftClick(a)){return}var e=a.xy.y;var d=OpenLayers.Util.pagePosition(a.object)[1];var c=(e-d)/this.zoomStopHeight;if(this.forceFixedZoomLevel||!this.map.fractionalZoom){c=Math.floor(c)}var b=(this.map.getNumZoomLevels()-1)-c;b=Math.min(Math.max(b,0),this.map.getNumZoomLevels()-1);this.map.zoomTo(b);OpenLayers.Event.stop(a)},zoomBarDown:function(a){if(!OpenLayers.Event.isLeftClick(a)){return
}this.map.events.on({mousemove:this.passEventToSlider,mouseup:this.passEventToSlider,scope:this});this.mouseDragStart=a.xy.clone();this.zoomStart=a.xy.clone();this.div.style.cursor="move";this.zoombarDiv.offsets=null;OpenLayers.Event.stop(a)},zoomBarDrag:function(b){if(this.mouseDragStart!=null){var a=this.mouseDragStart.y-b.xy.y;var d=OpenLayers.Util.pagePosition(this.zoombarDiv);if((b.clientY-d[1])>0&&(b.clientY-d[1])<parseInt(this.zoombarDiv.style.height)-2){var c=parseInt(this.slider.style.top)-a;this.slider.style.top=c+"px";this.mouseDragStart=b.xy.clone()}OpenLayers.Event.stop(b)}},zoomBarUp:function(b){if(!OpenLayers.Event.isLeftClick(b)){return}if(this.mouseDragStart){this.div.style.cursor="";this.map.events.un({mouseup:this.passEventToSlider,mousemove:this.passEventToSlider,scope:this});var a=this.zoomStart.y-b.xy.y;var c=this.map.zoom;if(!this.forceFixedZoomLevel&&this.map.fractionalZoom){c+=a/this.zoomStopHeight;c=Math.min(Math.max(c,0),this.map.getNumZoomLevels()-1)}else{c+=Math.round(a/this.zoomStopHeight)}this.map.zoomTo(c);this.mouseDragStart=null;this.zoomStart=null;OpenLayers.Event.stop(b)}},moveZoomBar:function(){var a=((this.map.getNumZoomLevels()-1)-this.map.getZoom())*this.zoomStopHeight+this.startTop+1;this.slider.style.top=a+"px"},CLASS_NAME:"OpenLayers.Control.PanZoomBar"});OpenLayers.Control.Permalink=OpenLayers.Class(OpenLayers.Control,{argParserClass:OpenLayers.Control.ArgParser,element:null,base:"",displayProjection:null,initialize:function(b,c,a){OpenLayers.Control.prototype.initialize.apply(this,[a]);this.element=OpenLayers.Util.getElement(b);this.base=c||document.location.href},destroy:function(){if(this.element.parentNode==this.div){this.div.removeChild(this.element)}this.element=null;this.map.events.unregister("moveend",this,this.updateLink);OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(d){OpenLayers.Control.prototype.setMap.apply(this,arguments);for(var b=0,a=this.map.controls.length;b<a;b++){var c=this.map.controls[b];if(c.CLASS_NAME==this.argParserClass.CLASS_NAME){if(c.displayProjection!=this.displayProjection){this.displayProjection=c.displayProjection}break}}if(b==this.map.controls.length){this.map.addControl(new this.argParserClass({displayProjection:this.displayProjection}))}},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.element){this.div.className=this.displayClass;this.element=document.createElement("a");this.element.innerHTML=OpenLayers.i18n("permalink");this.element.href="";this.div.appendChild(this.element)}this.map.events.on({moveend:this.updateLink,changelayer:this.updateLink,changebaselayer:this.updateLink,scope:this});this.updateLink();return this.div},updateLink:function(){var a=this.base;if(a.indexOf("?")!=-1){a=a.substring(0,a.indexOf("?"))}a+="?"+OpenLayers.Util.getParameterString(this.createParams());this.element.href=a},createParams:function(a,k,e){a=a||this.map.getCenter();var d=OpenLayers.Util.getParameters(this.base);if(a){d.zoom=k||this.map.getZoom();var j=a.lat;var b=a.lon;if(this.displayProjection){var c=OpenLayers.Projection.transform({x:b,y:j},this.map.getProjectionObject(),this.displayProjection);b=c.x;j=c.y}d.lat=Math.round(j*100000)/100000;d.lon=Math.round(b*100000)/100000;e=e||this.map.layers;d.layers="";for(var f=0,h=e.length;f<h;f++){var g=e[f];if(g.isBaseLayer){d.layers+=(g==this.map.baseLayer)?"B":"0"}else{d.layers+=(g.getVisibility())?"T":"F"}}}return d},CLASS_NAME:"OpenLayers.Control.Permalink"});OpenLayers.Control.ZoomPanel=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(a){OpenLayers.Control.Panel.prototype.initialize.apply(this,[a]);this.addControls([new OpenLayers.Control.ZoomIn(),new OpenLayers.Control.ZoomToMaxExtent(),new OpenLayers.Control.ZoomOut()])},CLASS_NAME:"OpenLayers.Control.ZoomPanel"});OpenLayers.Format.CSWGetDomain=function(b){b=OpenLayers.Util.applyDefaults(b,OpenLayers.Format.CSWGetDomain.DEFAULTS);var a=OpenLayers.Format.CSWGetDomain["v"+b.version.replace(/\./g,"_")];
if(!a){throw"Unsupported CSWGetDomain version: "+b.version}return new a(b)};OpenLayers.Format.CSWGetDomain.DEFAULTS={version:"2.0.2"};OpenLayers.Format.CSWGetRecords=function(b){b=OpenLayers.Util.applyDefaults(b,OpenLayers.Format.CSWGetRecords.DEFAULTS);var a=OpenLayers.Format.CSWGetRecords["v"+b.version.replace(/\./g,"_")];if(!a){throw"Unsupported CSWGetRecords version: "+b.version}return new a(b)};OpenLayers.Format.CSWGetRecords.DEFAULTS={version:"2.0.2"};OpenLayers.Format.JSON=OpenLayers.Class(OpenLayers.Format,{indent:"    ",space:" ",newline:"\n",level:0,pretty:false,initialize:function(a){OpenLayers.Format.prototype.initialize.apply(this,[a])},read:function(json,filter){try{if(/^[\],:{}\s]*$/.test(json.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){var object=eval("("+json+")");if(typeof filter==="function"){function walk(k,v){if(v&&typeof v==="object"){for(var i in v){if(v.hasOwnProperty(i)){v[i]=walk(i,v[i])}}}return filter(k,v)}object=walk("",object)}if(this.keepData){this.data=object}return object}}catch(e){}return null},write:function(e,c){this.pretty=!!c;var a=null;var b=typeof e;if(this.serialize[b]){try{a=this.serialize[b].apply(this,[e])}catch(d){OpenLayers.Console.error("Trouble serializing: "+d)}}return a},writeIndent:function(){var b=[];if(this.pretty){for(var a=0;a<this.level;++a){b.push(this.indent)}}return b.join("")},writeNewline:function(){return(this.pretty)?this.newline:""},writeSpace:function(){return(this.pretty)?this.space:""},serialize:{object:function(c){if(c==null){return"null"}if(c.constructor==Date){return this.serialize.date.apply(this,[c])}if(c.constructor==Array){return this.serialize.array.apply(this,[c])}var f=["{"];this.level+=1;var d,b,e;var a=false;for(d in c){if(c.hasOwnProperty(d)){b=OpenLayers.Format.JSON.prototype.write.apply(this,[d,this.pretty]);e=OpenLayers.Format.JSON.prototype.write.apply(this,[c[d],this.pretty]);if(b!=null&&e!=null){if(a){f.push(",")}f.push(this.writeNewline(),this.writeIndent(),b,":",this.writeSpace(),e);a=true}}}this.level-=1;f.push(this.writeNewline(),this.writeIndent(),"}");return f.join("")},array:function(e){var c;var d=["["];this.level+=1;for(var b=0,a=e.length;b<a;++b){c=OpenLayers.Format.JSON.prototype.write.apply(this,[e[b],this.pretty]);if(c!=null){if(b>0){d.push(",")}d.push(this.writeNewline(),this.writeIndent(),c)}}this.level-=1;d.push(this.writeNewline(),this.writeIndent(),"]");return d.join("")},string:function(b){var a={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};if(/["\\\x00-\x1f]/.test(b)){return'"'+b.replace(/([\x00-\x1f\\"])/g,function(e,d){var f=a[d];if(f){return f}f=d.charCodeAt();return"\\u00"+Math.floor(f/16).toString(16)+(f%16).toString(16)})+'"'}return'"'+b+'"'},number:function(a){return isFinite(a)?String(a):"null"},"boolean":function(a){return String(a)},date:function(a){function b(c){return(c<10)?"0"+c:c}return'"'+a.getFullYear()+"-"+b(a.getMonth()+1)+"-"+b(a.getDate())+"T"+b(a.getHours())+":"+b(a.getMinutes())+":"+b(a.getSeconds())+'"'}},CLASS_NAME:"OpenLayers.Format.JSON"});OpenLayers.Format.WFST=function(b){b=OpenLayers.Util.applyDefaults(b,OpenLayers.Format.WFST.DEFAULTS);var a=OpenLayers.Format.WFST["v"+b.version.replace(/\./g,"_")];if(!a){throw"Unsupported WFST version: "+b.version}return new a(b)};OpenLayers.Format.WFST.DEFAULTS={version:"1.0.0"};OpenLayers.Format.XML=OpenLayers.Class(OpenLayers.Format,{namespaces:null,namespaceAlias:null,defaultPrefix:null,readers:{},writers:{},xmldom:null,initialize:function(a){if(window.ActiveXObject){this.xmldom=new ActiveXObject("Microsoft.XMLDOM")}OpenLayers.Format.prototype.initialize.apply(this,[a]);this.namespaces=OpenLayers.Util.extend({},this.namespaces);this.namespaceAlias={};for(var b in this.namespaces){this.namespaceAlias[this.namespaces[b]]=b}},destroy:function(){this.xmldom=null;OpenLayers.Format.prototype.destroy.apply(this,arguments)},setNamespace:function(a,b){this.namespaces[a]=b;
this.namespaceAlias[b]=a},read:function(c){var a=c.indexOf("<");if(a>0){c=c.substring(a)}var b=OpenLayers.Util.Try(OpenLayers.Function.bind((function(){var d;if(window.ActiveXObject&&!this.xmldom){d=new ActiveXObject("Microsoft.XMLDOM")}else{d=this.xmldom}d.loadXML(c);return d}),this),function(){return new DOMParser().parseFromString(c,"text/xml")},function(){var d=new XMLHttpRequest();d.open("GET","data:text/xml;charset=utf-8,"+encodeURIComponent(c),false);if(d.overrideMimeType){d.overrideMimeType("text/xml")}d.send(null);return d.responseXML});if(this.keepData){this.data=b}return b},write:function(b){var c;if(this.xmldom){c=b.xml}else{var a=new XMLSerializer();if(b.nodeType==1){var d=document.implementation.createDocument("","",null);if(d.importNode){b=d.importNode(b,true)}d.appendChild(b);c=a.serializeToString(d)}else{c=a.serializeToString(b)}}return c},createElementNS:function(c,a){var b;if(this.xmldom){if(typeof c=="string"){b=this.xmldom.createNode(1,a,c)}else{b=this.xmldom.createNode(1,a,"")}}else{b=document.createElementNS(c,a)}return b},createTextNode:function(b){var a;if(typeof b!=="string"){b=String(b)}if(this.xmldom){a=this.xmldom.createTextNode(b)}else{a=document.createTextNode(b)}return a},getElementsByTagNameNS:function(e,d,c){var a=[];if(e.getElementsByTagNameNS){a=e.getElementsByTagNameNS(d,c)}else{var b=e.getElementsByTagName("*");var j,f;for(var g=0,h=b.length;g<h;++g){j=b[g];f=(j.prefix)?(j.prefix+":"+c):c;if((c=="*")||(f==j.nodeName)){if((d=="*")||(d==j.namespaceURI)){a.push(j)}}}}return a},getAttributeNodeNS:function(c,b,a){var j=null;if(c.getAttributeNodeNS){j=c.getAttributeNodeNS(b,a)}else{var e=c.attributes;var h,d;for(var f=0,g=e.length;f<g;++f){h=e[f];if(h.namespaceURI==b){d=(h.prefix)?(h.prefix+":"+a):a;if(d==h.nodeName){j=h;break}}}}return j},getAttributeNS:function(e,d,a){var b="";if(e.getAttributeNS){b=e.getAttributeNS(d,a)||""}else{var c=this.getAttributeNodeNS(e,d,a);if(c){b=c.nodeValue}}return b},getChildValue:function(a,c){var b=c||"";if(a){for(var d=a.firstChild;d;d=d.nextSibling){switch(d.nodeType){case 3:case 4:b+=d.nodeValue}}}return b},concatChildValues:function(b,d){var c="";var e=b.firstChild;var a;while(e){a=e.nodeValue;if(a){c+=a}e=e.nextSibling}if(c==""&&d!=undefined){c=d}return c},isSimpleContent:function(a){var c=true;for(var b=a.firstChild;b;b=b.nextSibling){if(b.nodeType===1){c=false;break}}return c},contentType:function(c){var e=false,b=false;var a=OpenLayers.Format.XML.CONTENT_TYPE.EMPTY;for(var d=c.firstChild;d;d=d.nextSibling){switch(d.nodeType){case 1:b=true;break;case 8:break;default:e=true}if(b&&e){break}}if(b&&e){a=OpenLayers.Format.XML.CONTENT_TYPE.MIXED}else{if(b){return OpenLayers.Format.XML.CONTENT_TYPE.COMPLEX}else{if(e){return OpenLayers.Format.XML.CONTENT_TYPE.SIMPLE}}}return a},hasAttributeNS:function(c,b,a){var d=false;if(c.hasAttributeNS){d=c.hasAttributeNS(b,a)}else{d=!!this.getAttributeNodeNS(c,b,a)}return d},setAttributeNS:function(d,c,a,e){if(d.setAttributeNS){d.setAttributeNS(c,a,e)}else{if(this.xmldom){if(c){var b=d.ownerDocument.createNode(2,a,c);b.nodeValue=e;d.setAttributeNode(b)}else{d.setAttribute(a,e)}}else{throw"setAttributeNS not implemented"}}},createElementNSPlus:function(b,a){a=a||{};var d=a.uri||this.namespaces[a.prefix];if(!d){var f=b.indexOf(":");d=this.namespaces[b.substring(0,f)]}if(!d){d=this.namespaces[this.defaultPrefix]}var c=this.createElementNS(d,b);if(a.attributes){this.setAttributes(c,a.attributes)}var e=a.value;if(e!=null){c.appendChild(this.createTextNode(e))}return c},setAttributes:function(c,e){var d,b;for(var a in e){if(e[a]!=null&&e[a].toString){d=e[a].toString();b=this.namespaces[a.substring(0,a.indexOf(":"))]||null;this.setAttributeNS(c,b,a,d)}}},readNode:function(c,e){if(!e){e={}}var d=this.readers[c.namespaceURI?this.namespaceAlias[c.namespaceURI]:this.defaultPrefix];if(d){var b=c.localName||c.nodeName.split(":").pop();var a=d[b]||d["*"];if(a){a.apply(this,[c,e])}}return e},readChildNodes:function(d,e){if(!e){e={}}var c=d.childNodes;
var f;for(var b=0,a=c.length;b<a;++b){f=c[b];if(f.nodeType==1){this.readNode(f,e)}}return e},writeNode:function(a,f,d){var e,c;var b=a.indexOf(":");if(b>0){e=a.substring(0,b);c=a.substring(b+1)}else{if(d){e=this.namespaceAlias[d.namespaceURI]}else{e=this.defaultPrefix}c=a}var g=this.writers[e][c].apply(this,[f]);if(d){d.appendChild(g)}return g},getChildEl:function(c,a,b){return c&&this.getThisOrNextEl(c.firstChild,a,b)},getNextEl:function(c,a,b){return c&&this.getThisOrNextEl(c.nextSibling,a,b)},getThisOrNextEl:function(d,a,c){outer:for(var b=d;b;b=b.nextSibling){switch(b.nodeType){case 1:if((!a||a===(b.localName||b.nodeName.split(":").pop()))&&(!c||c===b.namespaceURI)){break outer}b=null;break outer;case 3:if(/^\s*$/.test(b.nodeValue)){break}case 4:case 6:case 12:case 10:case 11:b=null;break outer}}return b||null},lookupNamespaceURI:function(e,f){var d=null;if(e){if(e.lookupNamespaceURI){d=e.lookupNamespaceURI(f)}else{outer:switch(e.nodeType){case 1:if(e.namespaceURI!==null&&e.prefix===f){d=e.namespaceURI;break outer}var b=e.attributes.length;if(b){var a;for(var c=0;c<b;++c){a=e.attributes[c];if(a.prefix==="xmlns"&&a.name==="xmlns:"+f){d=a.value||null;break outer}else{if(a.name==="xmlns"&&f===null){d=a.value||null;break outer}}}}d=this.lookupNamespaceURI(e.parentNode,f);break outer;case 2:d=this.lookupNamespaceURI(e.ownerElement,f);break outer;case 9:d=this.lookupNamespaceURI(e.documentElement,f);break outer;case 6:case 12:case 10:case 11:break outer;default:d=this.lookupNamespaceURI(e.parentNode,f);break outer}}}return d},CLASS_NAME:"OpenLayers.Format.XML"});OpenLayers.Format.XML.CONTENT_TYPE={EMPTY:0,SIMPLE:1,COMPLEX:2,MIXED:3};OpenLayers.Format.XML.lookupNamespaceURI=OpenLayers.Function.bind(OpenLayers.Format.XML.prototype.lookupNamespaceURI,OpenLayers.Format.XML.prototype);OpenLayers.Handler=OpenLayers.Class({id:null,control:null,map:null,keyMask:null,active:false,evt:null,initialize:function(d,b,a){OpenLayers.Util.extend(this,a);this.control=d;this.callbacks=b;var c=this.map||d.map;if(c){this.setMap(c)}this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},setMap:function(a){this.map=a},checkModifiers:function(a){if(this.keyMask==null){return true}var b=(a.shiftKey?OpenLayers.Handler.MOD_SHIFT:0)|(a.ctrlKey?OpenLayers.Handler.MOD_CTRL:0)|(a.altKey?OpenLayers.Handler.MOD_ALT:0);return(b==this.keyMask)},activate:function(){if(this.active){return false}var c=OpenLayers.Events.prototype.BROWSER_EVENTS;for(var b=0,a=c.length;b<a;b++){if(this[c[b]]){this.register(c[b],this[c[b]])}}this.active=true;return true},deactivate:function(){if(!this.active){return false}var c=OpenLayers.Events.prototype.BROWSER_EVENTS;for(var b=0,a=c.length;b<a;b++){if(this[c[b]]){this.unregister(c[b],this[c[b]])}}this.active=false;return true},callback:function(b,a){if(b&&this.callbacks[b]){this.callbacks[b].apply(this.control,a)}},register:function(a,b){this.map.events.registerPriority(a,this,b);this.map.events.registerPriority(a,this,this.setEvent)},unregister:function(a,b){this.map.events.unregister(a,this,b);this.map.events.unregister(a,this,this.setEvent)},setEvent:function(a){this.evt=a;return true},destroy:function(){this.deactivate();this.control=this.map=null},CLASS_NAME:"OpenLayers.Handler"});OpenLayers.Handler.MOD_NONE=0;OpenLayers.Handler.MOD_SHIFT=1;OpenLayers.Handler.MOD_CTRL=2;OpenLayers.Handler.MOD_ALT=4;OpenLayers.Map=OpenLayers.Class({Z_INDEX_BASE:{BaseLayer:100,Overlay:325,Feature:725,Popup:750,Control:1000},EVENT_TYPES:["preaddlayer","addlayer","removelayer","changelayer","movestart","move","moveend","zoomend","popupopen","popupclose","addmarker","removemarker","clearmarkers","mouseover","mouseout","mousemove","dragstart","drag","dragend","changebaselayer"],id:null,fractionalZoom:false,events:null,allOverlays:false,div:null,dragging:false,size:null,viewPortDiv:null,layerContainerOrigin:null,layerContainerDiv:null,layers:null,controls:null,popups:null,baseLayer:null,center:null,resolution:null,zoom:0,panRatio:1.5,viewRequestID:0,tileSize:null,projection:"EPSG:4326",units:"degrees",resolutions:null,maxResolution:1.40625,minResolution:null,maxScale:null,minScale:null,maxExtent:null,minExtent:null,restrictedExtent:null,numZoomLevels:16,theme:null,displayProjection:null,fallThrough:true,panTween:null,eventListeners:null,panMethod:OpenLayers.Easing.Expo.easeOut,panDuration:50,paddingForPopups:null,initialize:function(h,d){if(arguments.length===1&&typeof h==="object"){d=h;
h=d&&d.div}this.tileSize=new OpenLayers.Size(OpenLayers.Map.TILE_WIDTH,OpenLayers.Map.TILE_HEIGHT);this.maxExtent=new OpenLayers.Bounds(-180,-90,180,90);this.paddingForPopups=new OpenLayers.Bounds(15,15,15,15);this.theme=OpenLayers._getScriptLocation()+"../resources/css/style.css";OpenLayers.Util.extend(this,d);this.layers=[];this.id=OpenLayers.Util.createUniqueID("OpenLayers.Map_");this.div=OpenLayers.Util.getElement(h);if(!this.div){this.div=document.createElement("div");this.div.style.height="1px";this.div.style.width="1px"}OpenLayers.Element.addClass(this.div,"olMap");var g=this.id+"_OpenLayers_ViewPort";this.viewPortDiv=OpenLayers.Util.createDiv(g,null,null,null,"relative",null,"hidden");this.viewPortDiv.style.width="100%";this.viewPortDiv.style.height="100%";this.viewPortDiv.className="olMapViewport";this.div.appendChild(this.viewPortDiv);g=this.id+"_OpenLayers_Container";this.layerContainerDiv=OpenLayers.Util.createDiv(g);this.layerContainerDiv.style.zIndex=this.Z_INDEX_BASE.Popup-1;this.viewPortDiv.appendChild(this.layerContainerDiv);this.events=new OpenLayers.Events(this,this.div,this.EVENT_TYPES,this.fallThrough,{includeXY:true});this.updateSize();if(this.eventListeners instanceof Object){this.events.on(this.eventListeners)}this.events.register("movestart",this,this.updateSize);if(OpenLayers.String.contains(navigator.appName,"Microsoft")){this.events.register("resize",this,this.updateSize)}else{this.updateSizeDestroy=OpenLayers.Function.bind(this.updateSize,this);OpenLayers.Event.observe(window,"resize",this.updateSizeDestroy)}if(this.theme){var f=true;var c=document.getElementsByTagName("link");for(var e=0,a=c.length;e<a;++e){if(OpenLayers.Util.isEquivalentUrl(c.item(e).href,this.theme)){f=false;break}}if(f){var b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",this.theme);document.getElementsByTagName("head")[0].appendChild(b)}}if(this.controls==null){if(OpenLayers.Control!=null){this.controls=[new OpenLayers.Control.Navigation(),new OpenLayers.Control.PanZoom(),new OpenLayers.Control.ArgParser(),new OpenLayers.Control.Attribution()]}else{this.controls=[]}}for(var e=0,a=this.controls.length;e<a;e++){this.addControlToMap(this.controls[e])}this.popups=[];this.unloadDestroy=OpenLayers.Function.bind(this.destroy,this);OpenLayers.Event.observe(window,"unload",this.unloadDestroy);if(d&&d.layers){this.addLayers(d.layers);if(d.center){this.setCenter(d.center,d.zoom)}}},render:function(a){this.div=OpenLayers.Util.getElement(a);OpenLayers.Element.addClass(this.div,"olMap");this.events.attachToElement(this.div);this.viewPortDiv.parentNode.removeChild(this.viewPortDiv);this.div.appendChild(this.viewPortDiv);this.updateSize()},unloadDestroy:null,updateSizeDestroy:null,destroy:function(){if(!this.unloadDestroy){return false}if(this.panTween){this.panTween.stop();this.panTween=null}OpenLayers.Event.stopObserving(window,"unload",this.unloadDestroy);this.unloadDestroy=null;if(this.updateSizeDestroy){OpenLayers.Event.stopObserving(window,"resize",this.updateSizeDestroy)}else{this.events.unregister("resize",this,this.updateSize)}this.paddingForPopups=null;if(this.controls!=null){for(var a=this.controls.length-1;a>=0;--a){this.controls[a].destroy()}this.controls=null}if(this.layers!=null){for(var a=this.layers.length-1;a>=0;--a){this.layers[a].destroy(false)}this.layers=null}if(this.viewPortDiv){this.div.removeChild(this.viewPortDiv)}this.viewPortDiv=null;if(this.eventListeners){this.events.un(this.eventListeners);this.eventListeners=null}this.events.destroy();this.events=null},setOptions:function(a){OpenLayers.Util.extend(this,a)},getTileSize:function(){return this.tileSize},getBy:function(e,c,a){var d=(typeof a.test=="function");var b=OpenLayers.Array.filter(this[e],function(f){return f[c]==a||(d&&a.test(f[c]))});return b},getLayersBy:function(b,a){return this.getBy("layers",b,a)},getLayersByName:function(a){return this.getLayersBy("name",a)},getLayersByClass:function(a){return this.getLayersBy("CLASS_NAME",a)
},getControlsBy:function(b,a){return this.getBy("controls",b,a)},getControlsByClass:function(a){return this.getControlsBy("CLASS_NAME",a)},getLayer:function(e){var b=null;for(var d=0,a=this.layers.length;d<a;d++){var c=this.layers[d];if(c.id==e){b=c;break}}return b},setLayerZIndex:function(b,a){b.setZIndex(this.Z_INDEX_BASE[b.isBaseLayer?"BaseLayer":"Overlay"]+a*5)},resetLayersZIndex:function(){for(var c=0,a=this.layers.length;c<a;c++){var b=this.layers[c];this.setLayerZIndex(b,c)}},addLayer:function(c){for(var b=0,a=this.layers.length;b<a;b++){if(this.layers[b]==c){var d=OpenLayers.i18n("layerAlreadyAdded",{layerName:c.name});OpenLayers.Console.warn(d);return false}}if(this.allOverlays){c.isBaseLayer=false}if(this.events.triggerEvent("preaddlayer",{layer:c})===false){return}c.div.className="olLayerDiv";c.div.style.overflow="";this.setLayerZIndex(c,this.layers.length);if(c.isFixed){this.viewPortDiv.appendChild(c.div)}else{this.layerContainerDiv.appendChild(c.div)}this.layers.push(c);c.setMap(this);if(c.isBaseLayer||(this.allOverlays&&!this.baseLayer)){if(this.baseLayer==null){this.setBaseLayer(c)}else{c.setVisibility(false)}}else{c.redraw()}this.events.triggerEvent("addlayer",{layer:c});c.afterAdd()},addLayers:function(c){for(var b=0,a=c.length;b<a;b++){this.addLayer(c[b])}},removeLayer:function(c,e){if(e==null){e=true}if(c.isFixed){this.viewPortDiv.removeChild(c.div)}else{this.layerContainerDiv.removeChild(c.div)}OpenLayers.Util.removeItem(this.layers,c);c.removeMap(this);c.map=null;if(this.baseLayer==c){this.baseLayer=null;if(e){for(var b=0,a=this.layers.length;b<a;b++){var d=this.layers[b];if(d.isBaseLayer||this.allOverlays){this.setBaseLayer(d);break}}}}this.resetLayersZIndex();this.events.triggerEvent("removelayer",{layer:c})},getNumLayers:function(){return this.layers.length},getLayerIndex:function(a){return OpenLayers.Util.indexOf(this.layers,a)},setLayerIndex:function(d,b){var e=this.getLayerIndex(d);if(b<0){b=0}else{if(b>this.layers.length){b=this.layers.length}}if(e!=b){this.layers.splice(e,1);this.layers.splice(b,0,d);for(var c=0,a=this.layers.length;c<a;c++){this.setLayerZIndex(this.layers[c],c)}this.events.triggerEvent("changelayer",{layer:d,property:"order"});if(this.allOverlays){if(b===0){this.setBaseLayer(d)}else{if(this.baseLayer!==this.layers[0]){this.setBaseLayer(this.layers[0])}}}}},raiseLayer:function(b,c){var a=this.getLayerIndex(b)+c;this.setLayerIndex(b,a)},setBaseLayer:function(c){if(c!=this.baseLayer){if(OpenLayers.Util.indexOf(this.layers,c)!=-1){var a=this.getCenter();var d=OpenLayers.Util.getResolutionFromScale(this.getScale(),c.units);if(this.baseLayer!=null&&!this.allOverlays){this.baseLayer.setVisibility(false)}this.baseLayer=c;this.viewRequestID++;if(!this.allOverlays||this.baseLayer.visibility){this.baseLayer.setVisibility(true)}if(a!=null){var b=this.getZoomForResolution(d||this.resolution,true);this.setCenter(a,b,false,true)}this.events.triggerEvent("changebaselayer",{layer:this.baseLayer})}}},addControl:function(b,a){this.controls.push(b);this.addControlToMap(b,a)},addControls:function(b,g){var e=(arguments.length===1)?[]:g;for(var d=0,a=b.length;d<a;d++){var f=b[d];var c=(e[d])?e[d]:null;this.addControl(f,c)}},addControlToMap:function(b,a){b.outsideViewport=(b.div!=null);if(this.displayProjection&&!b.displayProjection){b.displayProjection=this.displayProjection}b.setMap(this);var c=b.draw(a);if(c){if(!b.outsideViewport){c.style.zIndex=this.Z_INDEX_BASE.Control+this.controls.length;this.viewPortDiv.appendChild(c)}}if(b.autoActivate){b.activate()}},getControl:function(e){var b=null;for(var c=0,a=this.controls.length;c<a;c++){var d=this.controls[c];if(d.id==e){b=d;break}}return b},removeControl:function(a){if((a)&&(a==this.getControl(a.id))){if(a.div&&(a.div.parentNode==this.viewPortDiv)){this.viewPortDiv.removeChild(a.div)}OpenLayers.Util.removeItem(this.controls,a)}},addPopup:function(a,d){if(d){for(var b=this.popups.length-1;b>=0;--b){this.removePopup(this.popups[b])}}a.map=this;this.popups.push(a);
var c=a.draw();if(c){c.style.zIndex=this.Z_INDEX_BASE.Popup+this.popups.length;this.layerContainerDiv.appendChild(c)}},removePopup:function(a){OpenLayers.Util.removeItem(this.popups,a);if(a.div){try{this.layerContainerDiv.removeChild(a.div)}catch(b){}}a.map=null},getSize:function(){var a=null;if(this.size!=null){a=this.size.clone()}return a},updateSize:function(){var c=this.getCurrentSize();if(c&&!isNaN(c.h)&&!isNaN(c.w)){this.events.clearMouseCache();var f=this.getSize();if(f==null){this.size=f=c}if(!c.equals(f)){this.size=c;for(var d=0,b=this.layers.length;d<b;d++){this.layers[d].onMapResize()}var a=this.getCenter();if(this.baseLayer!=null&&a!=null){var e=this.getZoom();this.zoom=null;this.setCenter(a,e)}}}},getCurrentSize:function(){var a=new OpenLayers.Size(this.div.clientWidth,this.div.clientHeight);if(a.w==0&&a.h==0||isNaN(a.w)&&isNaN(a.h)){a.w=this.div.offsetWidth;a.h=this.div.offsetHeight}if(a.w==0&&a.h==0||isNaN(a.w)&&isNaN(a.h)){a.w=parseInt(this.div.style.width);a.h=parseInt(this.div.style.height)}return a},calculateBounds:function(a,b){var e=null;if(a==null){a=this.getCenter()}if(b==null){b=this.getResolution()}if((a!=null)&&(b!=null)){var d=this.getSize();var f=d.w*b;var c=d.h*b;e=new OpenLayers.Bounds(a.lon-f/2,a.lat-c/2,a.lon+f/2,a.lat+c/2)}return e},getCenter:function(){var a=null;if(this.center){a=this.center.clone()}return a},getZoom:function(){return this.zoom},pan:function(d,c,e){e=OpenLayers.Util.applyDefaults(e,{animate:true,dragging:false});var f=this.getViewPortPxFromLonLat(this.getCenter());var b=f.add(d,c);if(!e.dragging||!b.equals(f)){var a=this.getLonLatFromViewPortPx(b);if(e.animate){this.panTo(a)}else{this.setCenter(a,null,e.dragging)}}},panTo:function(b){if(this.panMethod&&this.getExtent().scale(this.panRatio).containsLonLat(b)){if(!this.panTween){this.panTween=new OpenLayers.Tween(this.panMethod)}var a=this.getCenter();if(b.lon==a.lon&&b.lat==a.lat){return}var d={lon:a.lon,lat:a.lat};var c={lon:b.lon,lat:b.lat};this.panTween.start(d,c,this.panDuration,{callbacks:{start:OpenLayers.Function.bind(function(e){this.events.triggerEvent("movestart")},this),eachStep:OpenLayers.Function.bind(function(e){e=new OpenLayers.LonLat(e.lon,e.lat);this.moveTo(e,this.zoom,{dragging:true,noEvent:true})},this),done:OpenLayers.Function.bind(function(e){e=new OpenLayers.LonLat(e.lon,e.lat);this.moveTo(e,this.zoom,{noEvent:true});this.events.triggerEvent("moveend")},this)}})}else{this.setCenter(b)}},setCenter:function(c,a,b,d){this.moveTo(c,a,{dragging:b,forceZoomChange:d,caller:"setCenter"})},moveTo:function(g,n,q){if(!q){q={}}if(n!=null){n=parseFloat(n);if(!this.fractionalZoom){n=Math.round(n)}}var m=q.dragging;var c=q.forceZoomChange;var h=q.noEvent;if(this.panTween&&q.caller=="setCenter"){this.panTween.stop()}if(!this.center&&!this.isValidLonLat(g)){g=this.maxExtent.getCenterLonLat()}if(this.restrictedExtent!=null){if(g==null){g=this.getCenter()}if(n==null){n=this.getZoom()}var d=this.getResolutionForZoom(n);var o=this.calculateBounds(g,d);if(!this.restrictedExtent.containsBounds(o)){var p=this.restrictedExtent.getCenterLonLat();if(o.getWidth()>this.restrictedExtent.getWidth()){g=new OpenLayers.LonLat(p.lon,g.lat)}else{if(o.left<this.restrictedExtent.left){g=g.add(this.restrictedExtent.left-o.left,0)}else{if(o.right>this.restrictedExtent.right){g=g.add(this.restrictedExtent.right-o.right,0)}}}if(o.getHeight()>this.restrictedExtent.getHeight()){g=new OpenLayers.LonLat(g.lon,p.lat)}else{if(o.bottom<this.restrictedExtent.bottom){g=g.add(0,this.restrictedExtent.bottom-o.bottom)}else{if(o.top>this.restrictedExtent.top){g=g.add(0,this.restrictedExtent.top-o.top)}}}}}var b=c||((this.isValidZoomLevel(n))&&(n!=this.getZoom()));var e=(this.isValidLonLat(g))&&(!g.equals(this.center));if(b||e||!m){if(!this.dragging&&!h){this.events.triggerEvent("movestart")}if(e){if((!b)&&(this.center)){this.centerLayerContainer(g)}this.center=g.clone()}if((b)||(this.layerContainerOrigin==null)){this.layerContainerOrigin=this.center.clone();this.layerContainerDiv.style.left="0px";
this.layerContainerDiv.style.top="0px"}if(b){this.zoom=n;this.resolution=this.getResolutionForZoom(n);this.viewRequestID++}var a=this.getExtent();if(this.baseLayer.visibility){this.baseLayer.moveTo(a,b,m);if(m){this.baseLayer.events.triggerEvent("move")}else{this.baseLayer.events.triggerEvent("moveend",{zoomChanged:b})}}a=this.baseLayer.getExtent();for(var f=0,k=this.layers.length;f<k;f++){var j=this.layers[f];if(j!==this.baseLayer&&!j.isBaseLayer){var l=j.calculateInRange();if(j.inRange!=l){j.inRange=l;if(!l){j.display(false)}this.events.triggerEvent("changelayer",{layer:j,property:"visibility"})}if(l&&j.visibility){j.moveTo(a,b,m);if(m){j.events.triggerEvent("move")}else{j.events.triggerEvent("moveend",{zoomChanged:b})}}}}if(b){for(var f=0,k=this.popups.length;f<k;f++){this.popups[f].updatePosition()}}this.events.triggerEvent("move");if(b){this.events.triggerEvent("zoomend")}}if(!m&&!h){this.events.triggerEvent("moveend")}this.dragging=!!m},centerLayerContainer:function(b){var a=this.getViewPortPxFromLonLat(this.layerContainerOrigin);var c=this.getViewPortPxFromLonLat(b);if((a!=null)&&(c!=null)){this.layerContainerDiv.style.left=Math.round(a.x-c.x)+"px";this.layerContainerDiv.style.top=Math.round(a.y-c.y)+"px"}},isValidZoomLevel:function(a){return((a!=null)&&(a>=0)&&(a<this.getNumZoomLevels()))},isValidLonLat:function(c){var b=false;if(c!=null){var a=this.getMaxExtent();b=a.containsLonLat(c)}return b},getProjection:function(){var a=this.getProjectionObject();return a?a.getCode():null},getProjectionObject:function(){var a=null;if(this.baseLayer!=null){a=this.baseLayer.projection}return a},getMaxResolution:function(){var a=null;if(this.baseLayer!=null){a=this.baseLayer.maxResolution}return a},getMaxExtent:function(b){var a=null;if(b&&b.restricted&&this.restrictedExtent){a=this.restrictedExtent}else{if(this.baseLayer!=null){a=this.baseLayer.maxExtent}}return a},getNumZoomLevels:function(){var a=null;if(this.baseLayer!=null){a=this.baseLayer.numZoomLevels}return a},getExtent:function(){var a=null;if(this.baseLayer!=null){a=this.baseLayer.getExtent()}return a},getResolution:function(){var a=null;if(this.baseLayer!=null){a=this.baseLayer.getResolution()}else{if(this.allOverlays===true&&this.layers.length>0){a=this.layers[0].getResolution()}}return a},getUnits:function(){var a=null;if(this.baseLayer!=null){a=this.baseLayer.units}return a},getScale:function(){var c=null;if(this.baseLayer!=null){var b=this.getResolution();var a=this.baseLayer.units;c=OpenLayers.Util.getScaleFromResolution(b,a)}return c},getZoomForExtent:function(c,b){var a=null;if(this.baseLayer!=null){a=this.baseLayer.getZoomForExtent(c,b)}return a},getResolutionForZoom:function(b){var a=null;if(this.baseLayer){a=this.baseLayer.getResolutionForZoom(b)}return a},getZoomForResolution:function(a,c){var b=null;if(this.baseLayer!=null){b=this.baseLayer.getZoomForResolution(a,c)}return b},zoomTo:function(a){if(this.isValidZoomLevel(a)){this.setCenter(null,a)}},zoomIn:function(){this.zoomTo(this.getZoom()+1)},zoomOut:function(){this.zoomTo(this.getZoom()-1)},zoomToExtent:function(d,c){var b=d.getCenterLonLat();if(this.baseLayer.wrapDateLine){var a=this.getMaxExtent();d=d.clone();while(d.right<d.left){d.right+=a.getWidth()}b=d.getCenterLonLat().wrapDateLine(a)}this.setCenter(b,this.getZoomForExtent(d,c))},zoomToMaxExtent:function(c){var b=(c)?c.restricted:true;var a=this.getMaxExtent({restricted:b});this.zoomToExtent(a)},zoomToScale:function(h,g){var d=OpenLayers.Util.getResolutionFromScale(h,this.baseLayer.units);var c=this.getSize();var f=c.w*d;var b=c.h*d;var a=this.getCenter();var e=new OpenLayers.Bounds(a.lon-f/2,a.lat-b/2,a.lon+f/2,a.lat+b/2);this.zoomToExtent(e,g)},getLonLatFromViewPortPx:function(a){var b=null;if(this.baseLayer!=null){b=this.baseLayer.getLonLatFromViewPortPx(a)}return b},getViewPortPxFromLonLat:function(b){var a=null;if(this.baseLayer!=null){a=this.baseLayer.getViewPortPxFromLonLat(b)}return a},getLonLatFromPixel:function(a){return this.getLonLatFromViewPortPx(a)
},getPixelFromLonLat:function(b){var a=this.getViewPortPxFromLonLat(b);a.x=Math.round(a.x);a.y=Math.round(a.y);return a},getGeodesicPixelSize:function(g){var d=g?this.getLonLatFromPixel(g):(this.getCenter()||new OpenLayers.LonLat(0,0));var e=this.getResolution();var c=d.add(-e/2,0);var i=d.add(e/2,0);var b=d.add(0,-e/2);var f=d.add(0,e/2);var h=new OpenLayers.Projection("EPSG:4326");var a=this.getProjectionObject()||h;if(!a.equals(h)){c.transform(a,h);i.transform(a,h);b.transform(a,h);f.transform(a,h)}return new OpenLayers.Size(OpenLayers.Util.distVincenty(c,i),OpenLayers.Util.distVincenty(b,f))},getViewPortPxFromLayerPx:function(d){var c=null;if(d!=null){var b=parseInt(this.layerContainerDiv.style.left);var a=parseInt(this.layerContainerDiv.style.top);c=d.add(b,a)}return c},getLayerPxFromViewPortPx:function(c){var d=null;if(c!=null){var b=-parseInt(this.layerContainerDiv.style.left);var a=-parseInt(this.layerContainerDiv.style.top);d=c.add(b,a);if(isNaN(d.x)||isNaN(d.y)){d=null}}return d},getLonLatFromLayerPx:function(a){a=this.getViewPortPxFromLayerPx(a);return this.getLonLatFromViewPortPx(a)},getLayerPxFromLonLat:function(b){var a=this.getPixelFromLonLat(b);return this.getLayerPxFromViewPortPx(a)},CLASS_NAME:"OpenLayers.Map"});OpenLayers.Map.TILE_WIDTH=256;OpenLayers.Map.TILE_HEIGHT=256;OpenLayers.Marker=OpenLayers.Class({icon:null,lonlat:null,events:null,map:null,initialize:function(c,b){this.lonlat=c;var a=(b)?b:OpenLayers.Marker.defaultIcon();if(this.icon==null){this.icon=a}else{this.icon.url=a.url;this.icon.size=a.size;this.icon.offset=a.offset;this.icon.calculateOffset=a.calculateOffset}this.events=new OpenLayers.Events(this,this.icon.imageDiv,null)},destroy:function(){this.erase();this.map=null;this.events.destroy();this.events=null;if(this.icon!=null){this.icon.destroy();this.icon=null}},draw:function(a){return this.icon.draw(a)},erase:function(){if(this.icon!=null){this.icon.erase()}},moveTo:function(a){if((a!=null)&&(this.icon!=null)){this.icon.moveTo(a)}this.lonlat=this.map.getLonLatFromLayerPx(a)},isDrawn:function(){var a=(this.icon&&this.icon.isDrawn());return a},onScreen:function(){var b=false;if(this.map){var a=this.map.getExtent();b=a.containsLonLat(this.lonlat)}return b},inflate:function(b){if(this.icon){var a=new OpenLayers.Size(this.icon.size.w*b,this.icon.size.h*b);this.icon.setSize(a)}},setOpacity:function(a){this.icon.setOpacity(a)},setUrl:function(a){this.icon.setUrl(a)},display:function(a){this.icon.display(a)},CLASS_NAME:"OpenLayers.Marker"});OpenLayers.Marker.defaultIcon=function(){var a=OpenLayers.Util.getImagesLocation()+"marker.png";var b=new OpenLayers.Size(21,25);var c=function(d){return new OpenLayers.Pixel(-(d.w/2),-d.h)};return new OpenLayers.Icon(a,b,null,c)};OpenLayers.Popup.FramedCloud=OpenLayers.Class(OpenLayers.Popup.Framed,{contentDisplayClass:"olFramedCloudPopupContent",autoSize:true,panMapIfOutOfView:true,imageSize:new OpenLayers.Size(1276,736),isAlphaImage:false,fixedRelativePosition:false,positionBlocks:{tl:{offset:new OpenLayers.Pixel(44,0),padding:new OpenLayers.Bounds(8,40,8,9),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,51,22,0),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,50,0,0),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",19),anchor:new OpenLayers.Bounds(0,32,22,null),position:new OpenLayers.Pixel(0,-631)},{size:new OpenLayers.Size(22,18),anchor:new OpenLayers.Bounds(null,32,0,null),position:new OpenLayers.Pixel(-1238,-632)},{size:new OpenLayers.Size(81,35),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(0,-688)}]},tr:{offset:new OpenLayers.Pixel(-45,0),padding:new OpenLayers.Bounds(8,40,8,9),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,51,22,0),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,50,0,0),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",19),anchor:new OpenLayers.Bounds(0,32,22,null),position:new OpenLayers.Pixel(0,-631)},{size:new OpenLayers.Size(22,19),anchor:new OpenLayers.Bounds(null,32,0,null),position:new OpenLayers.Pixel(-1238,-631)},{size:new OpenLayers.Size(81,35),anchor:new OpenLayers.Bounds(0,0,null,null),position:new OpenLayers.Pixel(-215,-687)}]},bl:{offset:new OpenLayers.Pixel(45,0),padding:new OpenLayers.Bounds(8,9,8,40),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,21,22,32),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,21,0,32),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",21),anchor:new OpenLayers.Bounds(0,0,22,null),position:new OpenLayers.Pixel(0,-629)},{size:new OpenLayers.Size(22,21),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(-1238,-629)},{size:new OpenLayers.Size(81,33),anchor:new OpenLayers.Bounds(null,null,0,0),position:new OpenLayers.Pixel(-101,-674)}]},br:{offset:new OpenLayers.Pixel(-44,0),padding:new OpenLayers.Bounds(8,9,8,40),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,21,22,32),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,21,0,32),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",21),anchor:new OpenLayers.Bounds(0,0,22,null),position:new OpenLayers.Pixel(0,-629)},{size:new OpenLayers.Size(22,21),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(-1238,-629)},{size:new OpenLayers.Size(81,33),anchor:new OpenLayers.Bounds(0,null,null,0),position:new OpenLayers.Pixel(-311,-674)}]}},minSize:new OpenLayers.Size(105,10),maxSize:new OpenLayers.Size(1200,660),initialize:function(g,c,f,b,a,e,d){this.imageSrc=OpenLayers.Util.getImagesLocation()+"cloud-popup-relative.png";
OpenLayers.Popup.Framed.prototype.initialize.apply(this,arguments);this.contentDiv.className=this.contentDisplayClass},destroy:function(){OpenLayers.Popup.Framed.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Popup.FramedCloud"});OpenLayers.Request={DEFAULT_CONFIG:{method:"GET",url:window.location.href,async:true,user:undefined,password:undefined,params:null,proxy:OpenLayers.ProxyHost,headers:{},data:null,callback:function(){},success:null,failure:null,scope:null},events:new OpenLayers.Events(this,null,["complete","success","failure"]),issue:function(b){var e=OpenLayers.Util.extend(this.DEFAULT_CONFIG,{proxy:OpenLayers.ProxyHost});b=OpenLayers.Util.applyDefaults(b,e);var d=new OpenLayers.Request.XMLHttpRequest();var a=b.url;if(b.params){var c=OpenLayers.Util.getParameterString(b.params);if(c.length>0){var g=(a.indexOf("?")>-1)?"&":"?";a+=g+c}}if(b.proxy&&(a.indexOf("http")==0)){if(typeof b.proxy=="function"){a=b.proxy(a)}else{a=b.proxy+encodeURIComponent(a)}}d.open(b.method,a,b.async,b.user,b.password);for(var f in b.headers){d.setRequestHeader(f,b.headers[f])}var i=this.events;var h=this;d.onreadystatechange=function(){if(d.readyState==OpenLayers.Request.XMLHttpRequest.DONE){var j=i.triggerEvent("complete",{request:d,config:b,requestUrl:a});if(j!==false){h.runCallbacks({request:d,config:b,requestUrl:a})}}};if(b.async===false){d.send(b.data)}else{window.setTimeout(function(){if(d._aborted!==true){d.send(b.data)}},0)}return d},runCallbacks:function(d){var e=d.request;var c=d.config;var a=(c.scope)?OpenLayers.Function.bind(c.callback,c.scope):c.callback;var f;if(c.success){f=(c.scope)?OpenLayers.Function.bind(c.success,c.scope):c.success}var b;if(c.failure){b=(c.scope)?OpenLayers.Function.bind(c.failure,c.scope):c.failure}a(e);if(!e.status||(e.status>=200&&e.status<300)){this.events.triggerEvent("success",d);if(f){f(e)}}if(e.status&&(e.status<200||e.status>=300)){this.events.triggerEvent("failure",d);if(b){b(e)}}},GET:function(a){a=OpenLayers.Util.extend(a,{method:"GET"});return OpenLayers.Request.issue(a)},POST:function(a){a=OpenLayers.Util.extend(a,{method:"POST"});a.headers=a.headers?a.headers:{};if(!("CONTENT-TYPE" in OpenLayers.Util.upperCaseObject(a.headers))){a.headers["Content-Type"]="application/xml"}return OpenLayers.Request.issue(a)},PUT:function(a){a=OpenLayers.Util.extend(a,{method:"PUT"});a.headers=a.headers?a.headers:{};if(!("CONTENT-TYPE" in OpenLayers.Util.upperCaseObject(a.headers))){a.headers["Content-Type"]="application/xml"}return OpenLayers.Request.issue(a)},DELETE:function(a){a=OpenLayers.Util.extend(a,{method:"DELETE"});return OpenLayers.Request.issue(a)},HEAD:function(a){a=OpenLayers.Util.extend(a,{method:"HEAD"});return OpenLayers.Request.issue(a)},OPTIONS:function(a){a=OpenLayers.Util.extend(a,{method:"OPTIONS"});return OpenLayers.Request.issue(a)}};OpenLayers.Tile.Image=OpenLayers.Class(OpenLayers.Tile,{url:null,imgDiv:null,frame:null,layerAlphaHack:null,isBackBuffer:false,lastRatio:1,isFirstDraw:true,backBufferTile:null,initialize:function(d,a,e,b,c){OpenLayers.Tile.prototype.initialize.apply(this,arguments);this.url=b;this.frame=document.createElement("div");this.frame.style.overflow="hidden";this.frame.style.position="absolute";this.layerAlphaHack=this.layer.alpha&&OpenLayers.Util.alphaHack()},destroy:function(){if(this.imgDiv!=null){if(this.layerAlphaHack){OpenLayers.Event.stopObservingElement(this.imgDiv.childNodes[0])}OpenLayers.Event.stopObservingElement(this.imgDiv);if(this.imgDiv.parentNode==this.frame){this.frame.removeChild(this.imgDiv);this.imgDiv.map=null}this.imgDiv.urls=null;this.imgDiv.src=OpenLayers.Util.getImagesLocation()+"blank.gif"}this.imgDiv=null;if((this.frame!=null)&&(this.frame.parentNode==this.layer.div)){this.layer.div.removeChild(this.frame)}this.frame=null;if(this.backBufferTile){this.backBufferTile.destroy();this.backBufferTile=null}this.layer.events.unregister("loadend",this,this.resetBackBuffer);OpenLayers.Tile.prototype.destroy.apply(this,arguments)},clone:function(a){if(a==null){a=new OpenLayers.Tile.Image(this.layer,this.position,this.bounds,this.url,this.size)
}a=OpenLayers.Tile.prototype.clone.apply(this,[a]);a.imgDiv=null;return a},draw:function(){if(this.layer!=this.layer.map.baseLayer&&this.layer.reproject){this.bounds=this.getBoundsFromBaseLayer(this.position)}var a=OpenLayers.Tile.prototype.draw.apply(this,arguments);if((OpenLayers.Util.indexOf(this.layer.SUPPORTED_TRANSITIONS,this.layer.transitionEffect)!=-1)||this.layer.singleTile){if(a){if(!this.backBufferTile){this.backBufferTile=this.clone();this.backBufferTile.hide();this.backBufferTile.isBackBuffer=true;this.events.register("loadend",this,this.resetBackBuffer);this.layer.events.register("loadend",this,this.resetBackBuffer)}this.startTransition()}else{if(this.backBufferTile){this.backBufferTile.clear()}}}else{if(a&&this.isFirstDraw){this.events.register("loadend",this,this.showTile);this.isFirstDraw=false}}if(!a){return false}if(this.isLoading){this.events.triggerEvent("reload")}else{this.isLoading=true;this.events.triggerEvent("loadstart")}return this.renderTile()},resetBackBuffer:function(){this.showTile();if(this.backBufferTile&&(this.isFirstDraw||!this.layer.numLoadingTiles)){this.isFirstDraw=false;var a=this.layer.maxExtent;var b=(a&&this.bounds.intersectsBounds(a,false));if(b){this.backBufferTile.position=this.position;this.backBufferTile.bounds=this.bounds;this.backBufferTile.size=this.size;this.backBufferTile.imageSize=this.layer.getImageSize(this.bounds)||this.size;this.backBufferTile.imageOffset=this.layer.imageOffset;this.backBufferTile.resolution=this.layer.getResolution();this.backBufferTile.renderTile()}this.backBufferTile.hide()}},renderTile:function(){if(this.imgDiv==null){this.initImgDiv()}this.imgDiv.viewRequestID=this.layer.map.viewRequestID;if(this.layer.async){this.layer.getURLasync(this.bounds,this,"url",this.positionImage)}else{if(this.layer.url instanceof Array){this.imgDiv.urls=this.layer.url.slice()}this.url=this.layer.getURL(this.bounds);this.positionImage()}return true},positionImage:function(){if(this.layer===null){return}OpenLayers.Util.modifyDOMElement(this.frame,null,this.position,this.size);var a=this.layer.getImageSize(this.bounds);if(this.layerAlphaHack){OpenLayers.Util.modifyAlphaImageDiv(this.imgDiv,null,null,a,this.url)}else{OpenLayers.Util.modifyDOMElement(this.imgDiv,null,null,a);this.imgDiv.src=this.url}},clear:function(){if(this.imgDiv){this.hide();if(OpenLayers.Tile.Image.useBlankTile){this.imgDiv.src=OpenLayers.Util.getImagesLocation()+"blank.gif"}}},initImgDiv:function(){var d=this.layer.imageOffset;var b=this.layer.getImageSize(this.bounds);if(this.layerAlphaHack){this.imgDiv=OpenLayers.Util.createAlphaImageDiv(null,d,b,null,"relative",null,null,null,true)}else{this.imgDiv=OpenLayers.Util.createImage(null,d,b,null,"relative",null,null,true)}this.imgDiv.className="olTileImage";this.frame.style.zIndex=this.isBackBuffer?0:1;this.frame.appendChild(this.imgDiv);this.layer.div.appendChild(this.frame);if(this.layer.opacity!=null){OpenLayers.Util.modifyDOMElement(this.imgDiv,null,null,null,null,null,null,this.layer.opacity)}this.imgDiv.map=this.layer.map;var c=function(){if(this.isLoading){this.isLoading=false;this.events.triggerEvent("loadend")}};if(this.layerAlphaHack){OpenLayers.Event.observe(this.imgDiv.childNodes[0],"load",OpenLayers.Function.bind(c,this))}else{OpenLayers.Event.observe(this.imgDiv,"load",OpenLayers.Function.bind(c,this))}var a=function(){if(this.imgDiv._attempts>OpenLayers.IMAGE_RELOAD_ATTEMPTS){c.call(this)}};OpenLayers.Event.observe(this.imgDiv,"error",OpenLayers.Function.bind(a,this))},checkImgURL:function(){if(this.layer){var a=this.layerAlphaHack?this.imgDiv.firstChild.src:this.imgDiv.src;if(!OpenLayers.Util.isEquivalentUrl(a,this.url)){this.hide()}}},startTransition:function(){if(!this.backBufferTile||!this.backBufferTile.imgDiv){return}var d=1;if(this.backBufferTile.resolution){d=this.backBufferTile.resolution/this.layer.getResolution()}if(d!=this.lastRatio){if(this.layer.transitionEffect=="resize"){var c=new OpenLayers.LonLat(this.backBufferTile.bounds.left,this.backBufferTile.bounds.top);
var b=new OpenLayers.Size(this.backBufferTile.size.w*d,this.backBufferTile.size.h*d);var a=this.layer.map.getLayerPxFromLonLat(c);OpenLayers.Util.modifyDOMElement(this.backBufferTile.frame,null,a,b);var e=this.backBufferTile.imageSize;e=new OpenLayers.Size(e.w*d,e.h*d);var f=this.backBufferTile.imageOffset;if(f){f=new OpenLayers.Pixel(f.x*d,f.y*d)}OpenLayers.Util.modifyDOMElement(this.backBufferTile.imgDiv,null,f,e);this.backBufferTile.show()}}else{if(this.layer.singleTile){this.backBufferTile.show()}else{this.backBufferTile.hide()}}this.lastRatio=d},show:function(){this.frame.style.display="";if(OpenLayers.Util.indexOf(this.layer.SUPPORTED_TRANSITIONS,this.layer.transitionEffect)!=-1){if(navigator.userAgent.toLowerCase().indexOf("gecko")!=-1){this.frame.scrollLeft=this.frame.scrollLeft}}},hide:function(){this.frame.style.display="none"},CLASS_NAME:"OpenLayers.Tile.Image"});OpenLayers.Tile.Image.useBlankTile=(OpenLayers.Util.getBrowserName()=="safari"||OpenLayers.Util.getBrowserName()=="opera");OpenLayers.Control.OverviewMap=OpenLayers.Class(OpenLayers.Control,{element:null,ovmap:null,size:new OpenLayers.Size(180,90),layers:null,minRectSize:15,minRectDisplayClass:"RectReplacement",minRatio:8,maxRatio:32,mapOptions:null,autoPan:false,handlers:null,resolutionFactor:1,maximized:false,initialize:function(a){this.layers=[];this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,[a])},destroy:function(){if(!this.mapDiv){return}if(this.handlers.click){this.handlers.click.destroy()}if(this.handlers.drag){this.handlers.drag.destroy()}this.mapDiv.removeChild(this.extentRectangle);this.extentRectangle=null;if(this.rectEvents){this.rectEvents.destroy();this.rectEvents=null}if(this.ovmap){this.ovmap.destroy();this.ovmap=null}this.element.removeChild(this.mapDiv);this.mapDiv=null;this.div.removeChild(this.element);this.element=null;if(this.maximizeDiv){OpenLayers.Event.stopObservingElement(this.maximizeDiv);this.div.removeChild(this.maximizeDiv);this.maximizeDiv=null}if(this.minimizeDiv){OpenLayers.Event.stopObservingElement(this.minimizeDiv);this.div.removeChild(this.minimizeDiv);this.minimizeDiv=null}this.map.events.un({moveend:this.update,changebaselayer:this.baseLayerDraw,scope:this});OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!(this.layers.length>0)){if(this.map.baseLayer){var d=this.map.baseLayer.clone();this.layers=[d]}else{this.map.events.register("changebaselayer",this,this.baseLayerDraw);return this.div}}this.element=document.createElement("div");this.element.className=this.displayClass+"Element";this.element.style.display="none";this.mapDiv=document.createElement("div");this.mapDiv.style.width=this.size.w+"px";this.mapDiv.style.height=this.size.h+"px";this.mapDiv.style.position="relative";this.mapDiv.style.overflow="hidden";this.mapDiv.id=OpenLayers.Util.createUniqueID("overviewMap");this.extentRectangle=document.createElement("div");this.extentRectangle.style.position="absolute";this.extentRectangle.style.zIndex=1000;this.extentRectangle.className=this.displayClass+"ExtentRectangle";this.mapDiv.appendChild(this.extentRectangle);this.element.appendChild(this.mapDiv);this.div.appendChild(this.element);if(!this.outsideViewport){this.div.className+=" "+this.displayClass+"Container";var e=OpenLayers.Util.getImagesLocation();var b=e+"layer-switcher-maximize.png";this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv(this.displayClass+"MaximizeButton",null,new OpenLayers.Size(18,18),b,"absolute");this.maximizeDiv.style.display="none";this.maximizeDiv.className=this.displayClass+"MaximizeButton";OpenLayers.Event.observe(this.maximizeDiv,"click",OpenLayers.Function.bindAsEventListener(this.maximizeControl,this));this.div.appendChild(this.maximizeDiv);var b=e+"layer-switcher-minimize.png";this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_minimizeDiv",null,new OpenLayers.Size(18,18),b,"absolute");this.minimizeDiv.style.display="none";
this.minimizeDiv.className=this.displayClass+"MinimizeButton";OpenLayers.Event.observe(this.minimizeDiv,"click",OpenLayers.Function.bindAsEventListener(this.minimizeControl,this));this.div.appendChild(this.minimizeDiv);var f=["dblclick","mousedown"];for(var c=0,a=f.length;c<a;c++){OpenLayers.Event.observe(this.maximizeDiv,f[c],OpenLayers.Event.stop);OpenLayers.Event.observe(this.minimizeDiv,f[c],OpenLayers.Event.stop)}this.minimizeControl()}else{this.element.style.display=""}if(this.map.getExtent()){this.update()}this.map.events.register("moveend",this,this.update);if(this.maximized){this.maximizeControl()}return this.div},baseLayerDraw:function(){this.draw();this.map.events.unregister("changebaselayer",this,this.baseLayerDraw)},rectDrag:function(i){var d=this.handlers.drag.last.x-i.x;var b=this.handlers.drag.last.y-i.y;if(d!=0||b!=0){var g=this.rectPxBounds.top;var a=this.rectPxBounds.left;var e=Math.abs(this.rectPxBounds.getHeight());var c=this.rectPxBounds.getWidth();var f=Math.max(0,(g-b));f=Math.min(f,this.ovmap.size.h-this.hComp-e);var h=Math.max(0,(a-d));h=Math.min(h,this.ovmap.size.w-this.wComp-c);this.setRectPxBounds(new OpenLayers.Bounds(h,f+e,h+c,f))}},mapDivClick:function(i){var b=this.rectPxBounds.getCenterPixel();var e=i.xy.x-b.x;var d=i.xy.y-b.y;var g=this.rectPxBounds.top;var c=this.rectPxBounds.left;var j=Math.abs(this.rectPxBounds.getHeight());var a=this.rectPxBounds.getWidth();var f=Math.max(0,(g+d));f=Math.min(f,this.ovmap.size.h-j);var h=Math.max(0,(c+e));h=Math.min(h,this.ovmap.size.w-a);this.setRectPxBounds(new OpenLayers.Bounds(h,f+j,h+a,f));this.updateMapToRect()},maximizeControl:function(a){this.element.style.display="";this.showToggle(false);if(a!=null){OpenLayers.Event.stop(a)}},minimizeControl:function(a){this.element.style.display="none";this.showToggle(true);if(a!=null){OpenLayers.Event.stop(a)}},showToggle:function(a){this.maximizeDiv.style.display=a?"":"none";this.minimizeDiv.style.display=a?"none":""},update:function(){if(this.ovmap==null){this.createMap()}if(this.autoPan||!this.isSuitableOverview()){this.updateOverview()}this.updateRectToMap()},isSuitableOverview:function(){var b=this.map.getExtent();var a=this.map.maxExtent;var c=new OpenLayers.Bounds(Math.max(b.left,a.left),Math.max(b.bottom,a.bottom),Math.min(b.right,a.right),Math.min(b.top,a.top));if(this.ovmap.getProjection()!=this.map.getProjection()){c=c.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject())}var d=this.ovmap.getResolution()/this.map.getResolution();return((d>this.minRatio)&&(d<=this.maxRatio)&&(this.ovmap.getExtent().containsBounds(c)))},updateOverview:function(){var c=this.map.getResolution();var b=this.ovmap.getResolution();var d=b/c;if(d>this.maxRatio){b=this.minRatio*c}else{if(d<=this.minRatio){b=this.maxRatio*c}}var a;if(this.ovmap.getProjection()!=this.map.getProjection()){a=this.map.center.clone();a.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject())}else{a=this.map.center}this.ovmap.setCenter(a,this.ovmap.getZoomForResolution(b*this.resolutionFactor));this.updateRectToMap()},createMap:function(){var b=OpenLayers.Util.extend({controls:[],maxResolution:"auto",fallThrough:false},this.mapOptions);this.ovmap=new OpenLayers.Map(this.mapDiv,b);OpenLayers.Event.stopObserving(window,"unload",this.ovmap.unloadDestroy);this.ovmap.addLayers(this.layers);this.ovmap.zoomToMaxExtent();this.wComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-left-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-right-width"));this.wComp=(this.wComp)?this.wComp:2;this.hComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-top-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-bottom-width"));this.hComp=(this.hComp)?this.hComp:2;this.handlers.drag=new OpenLayers.Handler.Drag(this,{move:this.rectDrag,done:this.updateMapToRect},{map:this.ovmap});this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.mapDivClick},{single:true,"double":false,stopSingle:true,stopDouble:true,pixelTolerance:1,map:this.ovmap});
this.handlers.click.activate();this.rectEvents=new OpenLayers.Events(this,this.extentRectangle,null,true);this.rectEvents.register("mouseover",this,function(d){if(!this.handlers.drag.active&&!this.map.dragging){this.handlers.drag.activate()}});this.rectEvents.register("mouseout",this,function(d){if(!this.handlers.drag.dragging){this.handlers.drag.deactivate()}});if(this.ovmap.getProjection()!=this.map.getProjection()){var c=this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units;var a=this.ovmap.getProjectionObject().getUnits()||this.ovmap.units||this.ovmap.baseLayer.units;this.resolutionFactor=c&&a?OpenLayers.INCHES_PER_UNIT[c]/OpenLayers.INCHES_PER_UNIT[a]:1}},updateRectToMap:function(){var b;if(this.ovmap.getProjection()!=this.map.getProjection()){b=this.map.getExtent().transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject())}else{b=this.map.getExtent()}var a=this.getRectBoundsFromMapBounds(b);if(a){this.setRectPxBounds(a)}},updateMapToRect:function(){var a=this.getMapBoundsFromRectBounds(this.rectPxBounds);if(this.ovmap.getProjection()!=this.map.getProjection()){a=a.transform(this.ovmap.getProjectionObject(),this.map.getProjectionObject())}this.map.panTo(a.getCenterLonLat())},setRectPxBounds:function(d){var g=Math.max(d.top,0);var e=Math.max(d.left,0);var b=Math.min(d.top+Math.abs(d.getHeight()),this.ovmap.size.h-this.hComp);var h=Math.min(d.left+d.getWidth(),this.ovmap.size.w-this.wComp);var c=Math.max(h-e,0);var i=Math.max(b-g,0);if(c<this.minRectSize||i<this.minRectSize){this.extentRectangle.className=this.displayClass+this.minRectDisplayClass;var f=e+(c/2)-(this.minRectSize/2);var a=g+(i/2)-(this.minRectSize/2);this.extentRectangle.style.top=Math.round(a)+"px";this.extentRectangle.style.left=Math.round(f)+"px";this.extentRectangle.style.height=this.minRectSize+"px";this.extentRectangle.style.width=this.minRectSize+"px"}else{this.extentRectangle.className=this.displayClass+"ExtentRectangle";this.extentRectangle.style.top=Math.round(g)+"px";this.extentRectangle.style.left=Math.round(e)+"px";this.extentRectangle.style.height=Math.round(i)+"px";this.extentRectangle.style.width=Math.round(c)+"px"}this.rectPxBounds=new OpenLayers.Bounds(Math.round(e),Math.round(b),Math.round(h),Math.round(g))},getRectBoundsFromMapBounds:function(d){var a=new OpenLayers.LonLat(d.left,d.bottom);var f=new OpenLayers.LonLat(d.right,d.top);var c=this.getOverviewPxFromLonLat(a);var b=this.getOverviewPxFromLonLat(f);var e=null;if(c&&b){e=new OpenLayers.Bounds(c.x,c.y,b.x,b.y)}return e},getMapBoundsFromRectBounds:function(d){var c=new OpenLayers.Pixel(d.left,d.bottom);var b=new OpenLayers.Pixel(d.right,d.top);var a=this.getLonLatFromOverviewPx(c);var e=this.getLonLatFromOverviewPx(b);return new OpenLayers.Bounds(a.lon,a.lat,e.lon,e.lat)},getLonLatFromOverviewPx:function(f){var c=this.ovmap.size;var b=this.ovmap.getResolution();var a=this.ovmap.getExtent().getCenterLonLat();var e=f.x-(c.w/2);var d=f.y-(c.h/2);return new OpenLayers.LonLat(a.lon+e*b,a.lat-d*b)},getOverviewPxFromLonLat:function(d){var b=this.ovmap.getResolution();var c=this.ovmap.getExtent();var a=null;if(c){a=new OpenLayers.Pixel(Math.round(1/b*(d.lon-c.left)),Math.round(1/b*(c.top-d.lat)))}return a},CLASS_NAME:"OpenLayers.Control.OverviewMap"});OpenLayers.Feature=OpenLayers.Class({layer:null,id:null,lonlat:null,data:null,marker:null,popupClass:OpenLayers.Popup.AnchoredBubble,popup:null,initialize:function(a,c,b){this.layer=a;this.lonlat=c;this.data=(b!=null)?b:{};this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){if((this.layer!=null)&&(this.layer.map!=null)){if(this.popup!=null){this.layer.map.removePopup(this.popup)}}if(this.layer!=null&&this.marker!=null){this.layer.removeMarker(this.marker)}this.layer=null;this.id=null;this.lonlat=null;this.data=null;if(this.marker!=null){this.destroyMarker(this.marker);this.marker=null}if(this.popup!=null){this.destroyPopup(this.popup);this.popup=null}},onScreen:function(){var b=false;
if((this.layer!=null)&&(this.layer.map!=null)){var a=this.layer.map.getExtent();b=a.containsLonLat(this.lonlat)}return b},createMarker:function(){if(this.lonlat!=null){this.marker=new OpenLayers.Marker(this.lonlat,this.data.icon)}return this.marker},destroyMarker:function(){this.marker.destroy()},createPopup:function(b){if(this.lonlat!=null){var c=this.id+"_popup";var a=(this.marker)?this.marker.icon:null;if(!this.popup){this.popup=new this.popupClass(c,this.lonlat,this.data.popupSize,this.data.popupContentHTML,a,b)}if(this.data.overflow!=null){this.popup.contentDiv.style.overflow=this.data.overflow}this.popup.feature=this}return this.popup},destroyPopup:function(){if(this.popup){this.popup.feature=null;this.popup.destroy();this.popup=null}},CLASS_NAME:"OpenLayers.Feature"});OpenLayers.Format.CSWGetDomain.v2_0_2=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",csw:"http://www.opengis.net/cat/csw/2.0.2"},defaultPrefix:"csw",version:"2.0.2",schemaLocation:"http://www.opengis.net/cat/csw/2.0.2 http://schemas.opengis.net/csw/2.0.2/CSW-discovery.xsd",PropertyName:null,ParameterName:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){if(typeof a=="string"){a=OpenLayers.Format.XML.prototype.read.apply(this,[a])}if(a&&a.nodeType==9){a=a.documentElement}var b={};this.readNode(a,b);return b},readers:{csw:{GetDomainResponse:function(a,b){this.readChildNodes(a,b)},DomainValues:function(d,e){if(!(e.DomainValues instanceof Array)){e.DomainValues=[]}var b=d.attributes;var f={};for(var c=0,a=b.length;c<a;++c){f[b[c].name]=b[c].nodeValue}this.readChildNodes(d,f);e.DomainValues.push(f)},PropertyName:function(a,b){b.PropertyName=this.getChildValue(a)},ParameterName:function(a,b){b.ParameterName=this.getChildValue(a)},ListOfValues:function(a,b){if(!(b.ListOfValues instanceof Array)){b.ListOfValues=[]}this.readChildNodes(a,b.ListOfValues)},Value:function(d,f){var b=d.attributes;var e={};for(var c=0,a=b.length;c<a;++c){e[b[c].name]=b[c].nodeValue}e.value=this.getChildValue(d);f.push({Value:e})},ConceptualScheme:function(a,b){b.ConceptualScheme={};this.readChildNodes(a,b.ConceptualScheme)},Name:function(a,b){b.Name=this.getChildValue(a)},Document:function(a,b){b.Document=this.getChildValue(a)},Authority:function(a,b){b.Authority=this.getChildValue(a)},RangeOfValues:function(a,b){b.RangeOfValues={};this.readChildNodes(a,b.RangeOfValues)},MinValue:function(d,f){var b=d.attributes;var e={};for(var c=0,a=b.length;c<a;++c){e[b[c].name]=b[c].nodeValue}e.value=this.getChildValue(d);f.MinValue=e},MaxValue:function(d,f){var b=d.attributes;var e={};for(var c=0,a=b.length;c<a;++c){e[b[c].name]=b[c].nodeValue}e.value=this.getChildValue(d);f.MaxValue=e}}},write:function(a){var b=this.writeNode("csw:GetDomain",a);return OpenLayers.Format.XML.prototype.write.apply(this,[b])},writers:{csw:{GetDomain:function(a){var b=this.createElementNSPlus("csw:GetDomain",{attributes:{service:"CSW",version:this.version}});if(a.PropertyName||this.PropertyName){this.writeNode("csw:PropertyName",a.PropertyName||this.PropertyName,b)}else{if(a.ParameterName||this.ParameterName){this.writeNode("csw:ParameterName",a.ParameterName||this.ParameterName,b)}}this.readChildNodes(b,a);return b},PropertyName:function(b){var a=this.createElementNSPlus("csw:PropertyName",{value:b});return a},ParameterName:function(b){var a=this.createElementNSPlus("csw:ParameterName",{value:b});return a}}},CLASS_NAME:"OpenLayers.Format.CSWGetDomain.v2_0_2"});OpenLayers.Format.Context=OpenLayers.Class({version:null,layerOptions:null,layerParams:null,parser:null,initialize:function(a){OpenLayers.Util.extend(this,a);this.options=a},read:function(f,d){if(typeof f=="string"){f=OpenLayers.Format.XML.prototype.read.apply(this,[f])}var b=f.documentElement;var a=this.version;if(!a){a=b.getAttribute("version")}var h=this.getParser(a);var e=h.read(f,d);var g;if(d&&d.map){this.context=e;
if(d.map instanceof OpenLayers.Map){g=this.mergeContextToMap(e,d.map)}else{var c=d.map;if(OpenLayers.Util.isElement(c)||typeof c=="string"){c={div:c}}g=this.contextToMap(e,c)}}else{g=e}return g},getLayerFromContext:function(g){var c,f;var j={queryable:g.queryable,visibility:g.visibility,maxExtent:g.maxExtent,metadata:OpenLayers.Util.applyDefaults(g.metadata,{styles:g.styles}),numZoomLevels:g.numZoomLevels,units:g.units,isBaseLayer:g.isBaseLayer,opacity:g.opacity,displayInLayerSwitcher:g.displayInLayerSwitcher,singleTile:g.singleTile,tileSize:(g.tileSize)?new OpenLayers.Size(g.tileSize.width,g.tileSize.height):undefined,minScale:g.minScale||g.maxScaleDenominator,maxScale:g.maxScale||g.minScaleDenominator};if(this.layerOptions){OpenLayers.Util.applyDefaults(j,this.layerOptions)}var b={layers:g.name,transparent:g.transparent,version:g.version};if(g.formats&&g.formats.length>0){b.format=g.formats[0].value;for(c=0,f=g.formats.length;c<f;c++){var h=g.formats[c];if(h.current==true){b.format=h.value;break}}}if(g.styles&&g.styles.length>0){for(c=0,f=g.styles.length;c<f;c++){var a=g.styles[c];if(a.current==true){if(a.href){b.sld=a.href}else{if(a.body){b.sld_body=a.body}else{b.styles=a.name}}break}}}if(this.layerParams){OpenLayers.Util.applyDefaults(b,this.layerParams)}var d=null;var e=g.service;if(e==OpenLayers.Format.Context.serviceTypes.WFS){j.strategies=[new OpenLayers.Strategy.BBOX()];j.protocol=new OpenLayers.Protocol.WFS({url:g.url,featurePrefix:g.name.split(":")[0],featureType:g.name.split(":").pop()});d=new OpenLayers.Layer.Vector(g.title||g.name,j)}else{if(e==OpenLayers.Format.Context.serviceTypes.KML){j.strategies=[new OpenLayers.Strategy.Fixed()];j.protocol=new OpenLayers.Protocol.HTTP({url:g.url,format:new OpenLayers.Format.KML()});d=new OpenLayers.Layer.Vector(g.title||g.name,j)}else{if(e==OpenLayers.Format.Context.serviceTypes.GML){j.strategies=[new OpenLayers.Strategy.Fixed()];j.protocol=new OpenLayers.Protocol.HTTP({url:g.url,format:new OpenLayers.Format.GML()});d=new OpenLayers.Layer.Vector(g.title||g.name,j)}else{if(g.features){d=new OpenLayers.Layer.Vector(g.title||g.name,j);d.addFeatures(g.features)}else{if(g.categoryLayer!==true){d=new OpenLayers.Layer.WMS(g.title||g.name,g.url,b,j)}}}}}return d},getLayersFromContext:function(d){var e=[];for(var c=0,a=d.length;c<a;c++){var b=this.getLayerFromContext(d[c]);if(b!==null){e.push(b)}}return e},contextToMap:function(b,a){a=OpenLayers.Util.applyDefaults({maxExtent:b.maxExtent,projection:b.projection},a);var c=new OpenLayers.Map(a);c.addLayers(this.getLayersFromContext(b.layersContext));c.setCenter(b.bounds.getCenterLonLat(),c.getZoomForExtent(b.bounds,true));return c},mergeContextToMap:function(a,b){b.addLayers(this.getLayersFromContext(a.layersContext));return b},write:function(d,b){d=this.toContext(d);var a=b&&b.version;var e=this.getParser(a);var c=e.write(d,b);return c},CLASS_NAME:"OpenLayers.Format.Context"});OpenLayers.Format.Context.serviceTypes={WMS:"urn:ogc:serviceType:WMS",WFS:"urn:ogc:serviceType:WFS",WCS:"urn:ogc:serviceType:WCS",GML:"urn:ogc:serviceType:GML",SLD:"urn:ogc:serviceType:SLD",FES:"urn:ogc:serviceType:FES",KML:"urn:ogc:serviceType:KML"};if(!OpenLayers.Format.OWSCommon){OpenLayers.Format.OWSCommon={}}OpenLayers.Format.OWSCommon.v1=OpenLayers.Class(OpenLayers.Format.XML,{regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},readers:{ows:{ServiceIdentification:function(a,b){b.serviceIdentification={};this.readChildNodes(a,b.serviceIdentification)},Title:function(a,b){b.title=this.getChildValue(a)},Abstract:function(a,b){b["abstract"]=this.getChildValue(a)},Keywords:function(a,b){b.keywords={};this.readChildNodes(a,b.keywords)},Keyword:function(b,a){a[this.getChildValue(b)]=true},ServiceType:function(a,b){b.serviceType={codeSpace:a.getAttribute("codeSpace"),value:this.getChildValue(a)}},ServiceTypeVersion:function(a,b){b.serviceTypeVersion=this.getChildValue(a)},Fees:function(a,b){b.fees=this.getChildValue(a)},AccessConstraints:function(a,b){b.accessConstraints=this.getChildValue(a)
},ServiceProvider:function(a,b){b.serviceProvider={};this.readChildNodes(a,b.serviceProvider)},ProviderName:function(a,b){b.providerName=this.getChildValue(a)},ProviderSite:function(a,b){b.providerSite=this.getAttributeNS(a,this.namespaces.xlink,"href")},ServiceContact:function(a,b){b.serviceContact={};this.readChildNodes(a,b.serviceContact)},IndividualName:function(b,a){a.individualName=this.getChildValue(b)},PositionName:function(b,a){a.positionName=this.getChildValue(b)},ContactInfo:function(b,a){a.contactInfo={};this.readChildNodes(b,a.contactInfo)},Phone:function(b,a){a.phone={};this.readChildNodes(b,a.phone)},Voice:function(b,a){a.voice=this.getChildValue(b)},Address:function(b,a){a.address={};this.readChildNodes(b,a.address)},DeliveryPoint:function(b,a){a.deliveryPoint=this.getChildValue(b)},City:function(b,a){a.city=this.getChildValue(b)},AdministrativeArea:function(b,a){a.administrativeArea=this.getChildValue(b)},PostalCode:function(b,a){a.postalCode=this.getChildValue(b)},Country:function(b,a){a.country=this.getChildValue(b)},ElectronicMailAddress:function(b,a){a.electronicMailAddress=this.getChildValue(b)},Role:function(b,a){a.role=this.getChildValue(b)},OperationsMetadata:function(a,b){b.operationsMetadata={};this.readChildNodes(a,b.operationsMetadata)},Operation:function(c,b){var a=c.getAttribute("name");b[a]={};this.readChildNodes(c,b[a])},DCP:function(b,a){a.dcp={};this.readChildNodes(b,a.dcp)},HTTP:function(b,a){a.http={};this.readChildNodes(b,a.http)},Get:function(b,a){a.get=this.getAttributeNS(b,this.namespaces.xlink,"href")},Post:function(b,a){a.post=this.getAttributeNS(b,this.namespaces.xlink,"href")},Parameter:function(c,a){if(!a.parameters){a.parameters={}}var b=c.getAttribute("name");a.parameters[b]={};this.readChildNodes(c,a.parameters[b])},Value:function(a,b){b[this.getChildValue(a)]=true},OutputFormat:function(a,b){b.formats.push({value:this.getChildValue(a)});this.readChildNodes(a,b)},WGS84BoundingBox:function(b,c){var a={};a.crs=b.getAttribute("crs");if(c.BoundingBox){c.BoundingBox.push(a)}else{c.projection=a.crs;a=c}this.readChildNodes(b,a)},BoundingBox:function(a,b){this.readers.ows["WGS84BoundingBox"].apply(this,[a,b])},LowerCorner:function(b,c){var d=this.getChildValue(b).replace(this.regExes.trimSpace,"");d=d.replace(this.regExes.trimComma,",");var a=d.split(this.regExes.splitSpace);c.left=a[0];c.bottom=a[1]},UpperCorner:function(b,c){var d=this.getChildValue(b).replace(this.regExes.trimSpace,"");d=d.replace(this.regExes.trimComma,",");var a=d.split(this.regExes.splitSpace);c.right=a[0];c.top=a[1];c.bounds=new OpenLayers.Bounds(c.left,c.bottom,c.right,c.top);delete c.left;delete c.bottom;delete c.right;delete c.top}}},writers:{ows:{BoundingBox:function(a){var b=this.createElementNSPlus("ows:BoundingBox",{attributes:{crs:a.projection}});this.writeNode("ows:LowerCorner",a,b);this.writeNode("ows:UpperCorner",a,b);return b},LowerCorner:function(a){var b=this.createElementNSPlus("ows:LowerCorner",{value:a.bounds.left+" "+a.bounds.bottom});return b},UpperCorner:function(a){var b=this.createElementNSPlus("ows:UpperCorner",{value:a.bounds.right+" "+a.bounds.top});return b},Title:function(b){var a=this.createElementNSPlus("ows:Title",{value:b});return a},OutputFormat:function(b){var a=this.createElementNSPlus("ows:OutputFormat",{value:b});return a}}},CLASS_NAME:"OpenLayers.Format.OWSCommon.v1"});OpenLayers.Format.SOSCapabilities=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:"1.0.0",version:null,parser:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);this.options=a},read:function(e){if(typeof e=="string"){e=OpenLayers.Format.XML.prototype.read.apply(this,[e])}var c=e.documentElement;var b=this.version||c.getAttribute("version")||this.defaultVersion;if(!this.parser||this.parser.version!==b){var d=OpenLayers.Format.SOSCapabilities["v"+b.replace(/\./g,"_")];if(!d){throw"Can't find a SOS capabilities parser for version "+b}var f=new d(this.options)}var a=f.read(e);
a.version=b;return a},CLASS_NAME:"OpenLayers.Format.SOSCapabilities"});OpenLayers.Format.WFSCapabilities=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:"1.1.0",version:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);this.options=a},read:function(e){if(typeof e=="string"){e=OpenLayers.Format.XML.prototype.read.apply(this,[e])}var c=e.documentElement;var b=this.version;if(!b){b=c.getAttribute("version");if(!b){b=this.defaultVersion}}var d=OpenLayers.Format.WFSCapabilities["v"+b.replace(/\./g,"_")];if(!d){throw"Can't find a WFS capabilities parser for version "+b}var f=new d(this.options);var a=f.read(e);a.version=b;return a},CLASS_NAME:"OpenLayers.Format.WFSCapabilities"});OpenLayers.Format.WFSDescribeFeatureType=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xsd:"http://www.w3.org/2001/XMLSchema"},initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},readers:{xsd:{schema:function(d,j){var e=[];var b={};var f={complexTypes:e,customTypes:b};this.readChildNodes(d,f);var g=d.attributes;var l,a;for(var h=0,k=g.length;h<k;++h){l=g[h];a=l.name;if(a.indexOf("xmlns")==0){this.setNamespace(a.split(":")[1]||"",l.value)}else{j[a]=l.value}}j.featureTypes=e;j.targetPrefix=this.namespaceAlias[j.targetNamespace];var m,c;for(var h=0,k=e.length;h<k;++h){m=e[h];c=b[m.typeName];if(b[m.typeName]){m.typeName=c.name}}},complexType:function(b,c){var a={typeName:b.getAttribute("name")};this.readChildNodes(b,a);c.complexTypes.push(a)},complexContent:function(a,b){this.readChildNodes(a,b)},extension:function(a,b){this.readChildNodes(a,b)},sequence:function(a,b){var c={elements:[]};this.readChildNodes(a,c);b.properties=c.elements},element:function(a,c){if(c.elements){var d={};var b=a.attributes;var g;for(var e=0,f=b.length;e<f;++e){g=b[e];d[g.name]=g.value}var h=d.type;if(!h){h={};this.readChildNodes(a,h);d.restriction=h;d.type=h.base}var k=h.base||h;d.localType=k.split(":").pop();c.elements.push(d)}if(c.complexTypes){var h=a.getAttribute("type");var j=h.split(":").pop();c.customTypes[j]={name:a.getAttribute("name"),type:h}}},simpleType:function(a,b){this.readChildNodes(a,b)},restriction:function(a,b){b.base=a.getAttribute("base");this.readRestriction(a,b)}}},readRestriction:function(d,f){var c=d.childNodes;var h,g,e;for(var b=0,a=c.length;b<a;++b){h=c[b];if(h.nodeType==1){g=h.nodeName.split(":").pop();e=h.getAttribute("value");if(!f[g]){f[g]=e}else{if(typeof f[g]=="string"){f[g]=[f[g]]}f[g].push(e)}}}},read:function(b){if(typeof b=="string"){b=OpenLayers.Format.XML.prototype.read.apply(this,[b])}if(b&&b.nodeType==9){b=b.documentElement}var a={};this.readNode(b,a);return a},CLASS_NAME:"OpenLayers.Format.WFSDescribeFeatureType"});OpenLayers.Format.WFST.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",wfs:"http://www.opengis.net/wfs",gml:"http://www.opengis.net/gml",ogc:"http://www.opengis.net/ogc"},defaultPrefix:"wfs",version:null,schemaLocations:null,srsName:null,extractAttributes:true,xy:true,stateName:null,initialize:function(a){this.stateName={};this.stateName[OpenLayers.State.INSERT]="wfs:Insert";this.stateName[OpenLayers.State.UPDATE]="wfs:Update";this.stateName[OpenLayers.State.DELETE]="wfs:Delete";OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},getSrsName:function(c,b){var a=b&&b.srsName;if(!a){if(c&&c.layer){a=c.layer.projection.getCode()}else{a=this.srsName}}return a},read:function(b,a){a=a||{};OpenLayers.Util.applyDefaults(a,{output:"features"});if(typeof b=="string"){b=OpenLayers.Format.XML.prototype.read.apply(this,[b])}if(b&&b.nodeType==9){b=b.documentElement}var c={};if(b){this.readNode(b,c)}if(c.features&&a.output==="features"){c=c.features}return c},readers:{wfs:{FeatureCollection:function(a,b){b.features=[];this.readChildNodes(a,b)}}},write:function(a){var b=this.writeNode("wfs:Transaction",a);var c=this.schemaLocationAttr();if(c){this.setAttributeNS(b,this.namespaces.xsi,"xsi:schemaLocation",c)
}return OpenLayers.Format.XML.prototype.write.apply(this,[b])},writers:{wfs:{GetFeature:function(b){var d=this.createElementNSPlus("wfs:GetFeature",{attributes:{service:"WFS",version:this.version,outputFormat:b&&b.outputFormat,maxFeatures:b&&b.maxFeatures,"xsi:schemaLocation":this.schemaLocationAttr(b)}});if(typeof this.featureType=="string"){this.writeNode("Query",b,d)}else{for(var c=0,a=this.featureType.length;c<a;c++){b.featureType=this.featureType[c];this.writeNode("Query",b,d)}}return d},Transaction:function(e){var f=this.createElementNSPlus("wfs:Transaction",{attributes:{service:"WFS",version:this.version}});if(e){var b,d;for(var c=0,a=e.length;c<a;++c){d=e[c];b=this.stateName[d.state];if(b){this.writeNode(b,d,f)}}}return f},Insert:function(a){var b=this.createElementNSPlus("wfs:Insert");this.srsName=this.getSrsName(a);this.writeNode("feature:_typeName",a,b);return b},Update:function(b){var c=this.createElementNSPlus("wfs:Update",{attributes:{typeName:(this.featureNS?this.featurePrefix+":":"")+this.featureType}});if(this.featureNS){c.setAttribute("xmlns:"+this.featurePrefix,this.featureNS)}if(this.geometryName!==null){this.writeNode("Property",{name:this.geometryName,value:b},c)}for(var a in b.attributes){if(b.attributes[a]!==undefined){this.writeNode("Property",{name:a,value:b.attributes[a]},c)}}this.writeNode("ogc:Filter",new OpenLayers.Filter.FeatureId({fids:[b.fid]}),c);return c},Property:function(b){var a=this.createElementNSPlus("wfs:Property");this.writeNode("Name",b.name,a);if(b.value!==null){this.writeNode("Value",b.value,a)}return a},Name:function(a){return this.createElementNSPlus("wfs:Name",{value:a})},Value:function(c){var b;if(c instanceof OpenLayers.Feature.Vector){b=this.createElementNSPlus("wfs:Value");this.srsName=this.getSrsName(c);var a=this.writeNode("feature:_geometry",c.geometry).firstChild;b.appendChild(a)}else{b=this.createElementNSPlus("wfs:Value",{value:c})}return b},Delete:function(a){var b=this.createElementNSPlus("wfs:Delete",{attributes:{typeName:(this.featureNS?this.featurePrefix+":":"")+this.featureType}});if(this.featureNS){b.setAttribute("xmlns:"+this.featurePrefix,this.featureNS)}this.writeNode("ogc:Filter",new OpenLayers.Filter.FeatureId({fids:[a.fid]}),b);return b}}},schemaLocationAttr:function(a){a=OpenLayers.Util.extend({featurePrefix:this.featurePrefix,schema:this.schema},a);var f=OpenLayers.Util.extend({},this.schemaLocations);if(a.schema){f[a.featurePrefix]=a.schema}var e=[];var c;for(var b in f){c=this.namespaces[b];if(c){e.push(c+" "+f[b])}}var d=e.join(" ")||undefined;return d},setFilterProperty:function(c){if(c.filters){for(var b=0,a=c.filters.length;b<a;++b){this.setFilterProperty(c.filters[b])}}else{if(c instanceof OpenLayers.Filter.Spatial){c.property=this.geometryName}}},CLASS_NAME:"OpenLayers.Format.WFST.v1"});OpenLayers.Format.WMSCapabilities=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:"1.1.1",version:null,parser:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);this.options=a},read:function(e){if(typeof e=="string"){e=OpenLayers.Format.XML.prototype.read.apply(this,[e])}var c=e.documentElement;var b=this.version||c.getAttribute("version")||this.defaultVersion;if(!this.parser||this.parser.version!==b){var d=OpenLayers.Format.WMSCapabilities["v"+b.replace(/\./g,"_")];if(!d){throw"Can't find a WMS capabilities parser for version "+b}this.parser=new d(this.options)}var a=this.parser.read(e);a.version=b;return a},CLASS_NAME:"OpenLayers.Format.WMSCapabilities"});OpenLayers.Format.WMSDescribeLayer=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:"1.1.1",version:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);this.options=a},read:function(e){if(typeof e=="string"){e=OpenLayers.Format.XML.prototype.read.apply(this,[e])}var c=e.documentElement;var b=this.version;if(!b){b=c.getAttribute("version");if(!b){b=this.defaultVersion}}if(b=="1.1.1"||b=="1.1.0"){b="1.1"}var d=OpenLayers.Format.WMSDescribeLayer["v"+b.replace(/\./g,"_")];
if(!d){throw"Can't find a WMS DescribeLayer parser for version "+b}var f=new d(this.options);var a=f.read(e);a.version=b;return a},CLASS_NAME:"OpenLayers.Format.WMSDescribeLayer"});OpenLayers.Format.WMSGetFeatureInfo=OpenLayers.Class(OpenLayers.Format.XML,{layerIdentifier:"_layer",featureIdentifier:"_feature",regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},gmlFormat:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,arguments);OpenLayers.Util.extend(this,a);this.options=a},read:function(e){var a;if(typeof e=="string"){e=OpenLayers.Format.XML.prototype.read.apply(this,[e])}var b=e.documentElement;if(b){var c=this;var d=this["read_"+b.nodeName];if(d){a=d.call(this,b)}else{a=new OpenLayers.Format.GML((this.options?this.options:{})).read(e)}}else{a=e}return a},read_msGMLOutput:function(h){var e=[];var b=this.getSiblingNodesByTagCriteria(h,this.layerIdentifier);if(b){for(var k=0,n=b.length;k<n;++k){var c=b[k];var l=c.nodeName;if(c.prefix){l=l.split(":")[1]}var l=l.replace(this.layerIdentifier,"");var m=this.getSiblingNodesByTagCriteria(c,this.featureIdentifier);if(m){for(var g=0;g<m.length;g++){var a=m[g];var d=this.parseGeometry(a);var f=this.parseAttributes(a);var o=new OpenLayers.Feature.Vector(d.geometry,f,null);o.bounds=d.bounds;o.type=l;e.push(o)}}}}return e},read_FeatureInfoResponse:function(f){var c=[];var h=this.getElementsByTagNameNS(f,"*","FIELDS");for(var g=0,k=h.length;g<k;g++){var a=h[g];var l=null;var e={};for(var d=0,m=a.attributes.length;d<m;d++){var b=a.attributes[d];e[b.nodeName]=b.nodeValue}c.push(new OpenLayers.Feature.Vector(l,e,null))}return c},getSiblingNodesByTagCriteria:function(f,i){var a=[];var c,e,d,g,b;if(f&&f.hasChildNodes()){c=f.childNodes;d=c.length;for(var h=0;h<d;h++){b=c[h];while(b&&b.nodeType!=1){b=b.nextSibling;h++}e=(b?b.nodeName:"");if(e.length>0&&e.indexOf(i)>-1){a.push(b)}else{g=this.getSiblingNodesByTagCriteria(b,i);if(g.length>0){(a.length==0)?a=g:a.push(g)}}}}return a},parseAttributes:function(e){var f={};if(e.nodeType==1){var c=e.childNodes;var d=c.length;for(var g=0;g<d;++g){var b=c[g];if(b.nodeType==1){var k=b.childNodes;if(k.length==1){var j=k[0];if(j.nodeType==3||j.nodeType==4){var a=(b.prefix)?b.nodeName.split(":")[1]:b.nodeName;var h=j.nodeValue.replace(this.regExes.trimSpace,"");f[a]=h}}}}}return f},parseGeometry:function(c){if(!this.gmlFormat){this.gmlFormat=new OpenLayers.Format.GML()}var a=this.gmlFormat.parseFeature(c);var d,b=null;if(a){d=a.geometry&&a.geometry.clone();b=a.bounds&&a.bounds.clone();a.destroy()}return{geometry:d,bounds:b}},CLASS_NAME:"OpenLayers.Format.WMSGetFeatureInfo"});OpenLayers.Format.WMTSCapabilities=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:"1.0.0",version:null,parser:null,yx:{"urn:ogc:def:crs:EPSG::4326":true},initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);this.options=a},read:function(d){if(typeof d=="string"){d=OpenLayers.Format.XML.prototype.read.apply(this,[d])}var b=d.documentElement;var a=this.version||b.getAttribute("version")||this.defaultVersion;if(!this.parser||this.parser.version!==a){var c=OpenLayers.Format.WMTSCapabilities["v"+a.replace(/\./g,"_")];if(!c){throw new Error("Can't find a WMTS capabilities parser for version "+a)}this.parser=new c(this.options)}return this.parser.read(d)},createLayer:function(e,f){var k;var l={layer:true,matrixSet:true};for(var c in l){if(!(c in f)){throw new Error("Missing property '"+c+"' in layer configuration.")}}var g=e.contents;var d=g.tileMatrixSets[f.matrixSet];var j=g.layers;var b;for(var h=0,m=g.layers.length;h<m;++h){if(g.layers[h].identifier===f.layer){b=g.layers[h];break}}if(b&&d){var a;for(var h=0,m=b.styles.length;h<m;++h){a=b.styles[h];if(a.isDefault){break}}k=new OpenLayers.Layer.WMTS(OpenLayers.Util.applyDefaults(f,{url:e.operationsMetadata.GetTile.dcp.http.get,name:b.title,style:a,matrixIds:d.matrixIds}))}return k},CLASS_NAME:"OpenLayers.Format.WMTSCapabilities"});
OpenLayers.Handler.Click=OpenLayers.Class(OpenLayers.Handler,{delay:300,single:true,"double":false,pixelTolerance:0,stopSingle:false,stopDouble:false,timerId:null,down:null,rightclickTimerId:null,initialize:function(c,b,a){OpenLayers.Handler.prototype.initialize.apply(this,arguments);if(this.pixelTolerance!=null){this.mousedown=function(d){this.down=d.xy;return true}}},mousedown:null,mouseup:function(b){var a=true;if(this.checkModifiers(b)&&this.control.handleRightClicks&&OpenLayers.Event.isRightClick(b)){a=this.rightclick(b)}return a},rightclick:function(b){if(this.passesTolerance(b)){if(this.rightclickTimerId!=null){this.clearTimer();this.callback("dblrightclick",[b]);return !this.stopDouble}else{var a=this["double"]?OpenLayers.Util.extend({},b):this.callback("rightclick",[b]);var c=OpenLayers.Function.bind(this.delayedRightCall,this,a);this.rightclickTimerId=window.setTimeout(c,this.delay)}}return !this.stopSingle},delayedRightCall:function(a){this.rightclickTimerId=null;if(a){this.callback("rightclick",[a])}return !this.stopSingle},dblclick:function(a){if(this.passesTolerance(a)){if(this["double"]){this.callback("dblclick",[a])}this.clearTimer()}return !this.stopDouble},click:function(b){if(this.passesTolerance(b)){if(this.timerId!=null){this.clearTimer()}else{var a=this.single?OpenLayers.Util.extend({},b):null;this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,a),this.delay)}}return !this.stopSingle},passesTolerance:function(b){var c=true;if(this.pixelTolerance!=null&&this.down){var a=Math.sqrt(Math.pow(this.down.x-b.xy.x,2)+Math.pow(this.down.y-b.xy.y,2));if(a>this.pixelTolerance){c=false}}return c},clearTimer:function(){if(this.timerId!=null){window.clearTimeout(this.timerId);this.timerId=null}if(this.rightclickTimerId!=null){window.clearTimeout(this.rightclickTimerId);this.rightclickTimerId=null}},delayedCall:function(a){this.timerId=null;if(a){this.callback("click",[a])}},deactivate:function(){var a=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.clearTimer();this.down=null;a=true}return a},CLASS_NAME:"OpenLayers.Handler.Click"});OpenLayers.Handler.Drag=OpenLayers.Class(OpenLayers.Handler,{started:false,stopDown:true,dragging:false,last:null,start:null,oldOnselectstart:null,interval:0,timeoutId:null,documentDrag:false,documentEvents:null,initialize:function(c,b,a){OpenLayers.Handler.prototype.initialize.apply(this,arguments)},down:function(a){},move:function(a){},up:function(a){},out:function(a){},mousedown:function(b){var a=true;this.dragging=false;if(this.checkModifiers(b)&&OpenLayers.Event.isLeftClick(b)){this.started=true;this.start=b.xy;this.last=b.xy;OpenLayers.Element.addClass(this.map.viewPortDiv,"olDragDown");this.down(b);this.callback("down",[b.xy]);OpenLayers.Event.stop(b);if(!this.oldOnselectstart){this.oldOnselectstart=(document.onselectstart)?document.onselectstart:OpenLayers.Function.True}document.onselectstart=OpenLayers.Function.False;a=!this.stopDown}else{this.started=false;this.start=null;this.last=null}return a},mousemove:function(a){if(this.started&&!this.timeoutId&&(a.xy.x!=this.last.x||a.xy.y!=this.last.y)){if(this.documentDrag===true&&this.documentEvents){if(a.element===document){this.adjustXY(a);this.setEvent(a)}else{this.destroyDocumentEvents()}}if(this.interval>0){this.timeoutId=setTimeout(OpenLayers.Function.bind(this.removeTimeout,this),this.interval)}this.dragging=true;this.move(a);this.callback("move",[a.xy]);if(!this.oldOnselectstart){this.oldOnselectstart=document.onselectstart;document.onselectstart=OpenLayers.Function.False}this.last=this.evt.xy}return true},removeTimeout:function(){this.timeoutId=null},mouseup:function(b){if(this.started){if(this.documentDrag===true&&this.documentEvents){this.adjustXY(b);this.destroyDocumentEvents()}var a=(this.start!=this.last);this.started=false;this.dragging=false;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown");this.up(b);this.callback("up",[b.xy]);if(a){this.callback("done",[b.xy])
}document.onselectstart=this.oldOnselectstart}return true},mouseout:function(b){if(this.started&&OpenLayers.Util.mouseLeft(b,this.map.div)){if(this.documentDrag===true){this.documentEvents=new OpenLayers.Events(this,document,null,null,{includeXY:true});this.documentEvents.on({mousemove:this.mousemove,mouseup:this.mouseup});OpenLayers.Element.addClass(document.body,"olDragDown")}else{var a=(this.start!=this.last);this.started=false;this.dragging=false;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown");this.out(b);this.callback("out",[]);if(a){this.callback("done",[b.xy])}if(document.onselectstart){document.onselectstart=this.oldOnselectstart}}}return true},click:function(a){return(this.start==this.last)},activate:function(){var a=false;if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.dragging=false;a=true}return a},deactivate:function(){var a=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.started=false;this.dragging=false;this.start=null;this.last=null;a=true;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown")}return a},adjustXY:function(a){var b=OpenLayers.Util.pagePosition(this.map.div);a.xy.x-=b[0];a.xy.y-=b[1]},destroyDocumentEvents:function(){OpenLayers.Element.removeClass(document.body,"olDragDown");this.documentEvents.destroy();this.documentEvents=null},CLASS_NAME:"OpenLayers.Handler.Drag"});OpenLayers.Handler.Feature=OpenLayers.Class(OpenLayers.Handler,{EVENTMAP:{click:{"in":"click",out:"clickout"},mousemove:{"in":"over",out:"out"},dblclick:{"in":"dblclick",out:null},mousedown:{"in":null,out:null},mouseup:{"in":null,out:null}},feature:null,lastFeature:null,down:null,up:null,clickTolerance:4,geometryTypes:null,stopClick:true,stopDown:true,stopUp:false,initialize:function(d,b,c,a){OpenLayers.Handler.prototype.initialize.apply(this,[d,c,a]);this.layer=b},mousedown:function(a){this.down=a.xy;return this.handle(a)?!this.stopDown:true},mouseup:function(a){this.up=a.xy;return this.handle(a)?!this.stopUp:true},click:function(a){return this.handle(a)?!this.stopClick:true},mousemove:function(a){if(!this.callbacks.over&&!this.callbacks.out){return true}this.handle(a);return true},dblclick:function(a){return !this.handle(a)},geometryTypeMatches:function(a){return this.geometryTypes==null||OpenLayers.Util.indexOf(this.geometryTypes,a.geometry.CLASS_NAME)>-1},handle:function(a){if(this.feature&&!this.feature.layer){this.feature=null}var c=a.type;var f=false;var e=!!(this.feature);var d=(c=="click"||c=="dblclick");this.feature=this.layer.getFeatureFromEvent(a);if(this.feature&&!this.feature.layer){this.feature=null}if(this.lastFeature&&!this.lastFeature.layer){this.lastFeature=null}if(this.feature){var b=(this.feature!=this.lastFeature);if(this.geometryTypeMatches(this.feature)){if(e&&b){if(this.lastFeature){this.triggerCallback(c,"out",[this.lastFeature])}this.triggerCallback(c,"in",[this.feature])}else{if(!e||d){this.triggerCallback(c,"in",[this.feature])}}this.lastFeature=this.feature;f=true}else{if(this.lastFeature&&(e&&b||d)){this.triggerCallback(c,"out",[this.lastFeature])}this.feature=null}}else{if(this.lastFeature&&(e||d)){this.triggerCallback(c,"out",[this.lastFeature])}}return f},triggerCallback:function(d,e,b){var c=this.EVENTMAP[d][e];if(c){if(d=="click"&&this.up&&this.down){var a=Math.sqrt(Math.pow(this.up.x-this.down.x,2)+Math.pow(this.up.y-this.down.y,2));if(a<=this.clickTolerance){this.callback(c,b)}}else{this.callback(c,b)}}},activate:function(){var a=false;if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.moveLayerToTop();this.map.events.on({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this});a=true}return a},deactivate:function(){var a=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.moveLayerBack();this.feature=null;this.lastFeature=null;this.down=null;this.up=null;this.map.events.un({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this});a=true
}return a},handleMapEvents:function(a){if(!a.property||a.property=="order"){this.moveLayerToTop()}},moveLayerToTop:function(){var a=Math.max(this.map.Z_INDEX_BASE.Feature-1,this.layer.getZIndex())+1;this.layer.setZIndex(a)},moveLayerBack:function(){var a=this.layer.getZIndex()-1;if(a>=this.map.Z_INDEX_BASE.Feature){this.layer.setZIndex(a)}else{this.map.setLayerZIndex(this.layer,this.map.getLayerIndex(this.layer))}},CLASS_NAME:"OpenLayers.Handler.Feature"});OpenLayers.Handler.Hover=OpenLayers.Class(OpenLayers.Handler,{delay:500,pixelTolerance:null,stopMove:false,px:null,timerId:null,initialize:function(c,b,a){OpenLayers.Handler.prototype.initialize.apply(this,arguments)},mousemove:function(a){if(this.passesTolerance(a.xy)){this.clearTimer();this.callback("move",[a]);this.px=a.xy;a=OpenLayers.Util.extend({},a);this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,a),this.delay)}return !this.stopMove},mouseout:function(a){if(OpenLayers.Util.mouseLeft(a,this.map.div)){this.clearTimer();this.callback("move",[a])}return true},passesTolerance:function(b){var c=true;if(this.pixelTolerance&&this.px){var a=Math.sqrt(Math.pow(this.px.x-b.x,2)+Math.pow(this.px.y-b.y,2));if(a<this.pixelTolerance){c=false}}return c},clearTimer:function(){if(this.timerId!=null){window.clearTimeout(this.timerId);this.timerId=null}},delayedCall:function(a){this.callback("pause",[a])},deactivate:function(){var a=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.clearTimer();a=true}return a},CLASS_NAME:"OpenLayers.Handler.Hover"});OpenLayers.Handler.Keyboard=OpenLayers.Class(OpenLayers.Handler,{KEY_EVENTS:["keydown","keyup"],eventListener:null,initialize:function(c,b,a){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.eventListener=OpenLayers.Function.bindAsEventListener(this.handleKeyEvent,this)},destroy:function(){this.deactivate();this.eventListener=null;OpenLayers.Handler.prototype.destroy.apply(this,arguments)},activate:function(){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){for(var b=0,a=this.KEY_EVENTS.length;b<a;b++){OpenLayers.Event.observe(document,this.KEY_EVENTS[b],this.eventListener)}return true}else{return false}},deactivate:function(){var c=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){for(var b=0,a=this.KEY_EVENTS.length;b<a;b++){OpenLayers.Event.stopObserving(document,this.KEY_EVENTS[b],this.eventListener)}c=true}return c},handleKeyEvent:function(a){if(this.checkModifiers(a)){this.callback(a.type,[a])}},CLASS_NAME:"OpenLayers.Handler.Keyboard"});OpenLayers.Handler.MouseWheel=OpenLayers.Class(OpenLayers.Handler,{wheelListener:null,mousePosition:null,interval:0,delta:0,cumulative:true,initialize:function(c,b,a){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.wheelListener=OpenLayers.Function.bindAsEventListener(this.onWheelEvent,this)},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments);this.wheelListener=null},onWheelEvent:function(k){if(!this.map||!this.checkModifiers(k)){return}var g=false;var m=false;var f=false;var b=OpenLayers.Event.element(k);while((b!=null)&&!f&&!g){if(!g){try{if(b.currentStyle){c=b.currentStyle.overflow}else{var a=document.defaultView.getComputedStyle(b,null);var c=a.getPropertyValue("overflow")}g=(c&&(c=="auto")||(c=="scroll"))}catch(d){}}if(!m){for(var h=0,j=this.map.layers.length;h<j;h++){if(b==this.map.layers[h].div||b==this.map.layers[h].pane){m=true;break}}}f=(b==this.map.div);b=b.parentNode}if(!g&&f){if(m){var l=0;if(!k){k=window.event}if(k.wheelDelta){l=k.wheelDelta/120;if(window.opera&&window.opera.version()<9.2){l=-l}}else{if(k.detail){l=-k.detail/3}}this.delta=this.delta+l;if(this.interval){window.clearTimeout(this._timeoutId);this._timeoutId=window.setTimeout(OpenLayers.Function.bind(function(){this.wheelZoom(k)},this),this.interval)}else{this.wheelZoom(k)}}OpenLayers.Event.stop(k)}},wheelZoom:function(a){var b=this.delta;this.delta=0;if(b){if(this.mousePosition){a.xy=this.mousePosition
}if(!a.xy){a.xy=this.map.getPixelFromLonLat(this.map.getCenter())}if(b<0){this.callback("down",[a,this.cumulative?b:-1])}else{this.callback("up",[a,this.cumulative?b:1])}}},mousemove:function(a){this.mousePosition=a.xy},activate:function(a){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){var b=this.wheelListener;OpenLayers.Event.observe(window,"DOMMouseScroll",b);OpenLayers.Event.observe(window,"mousewheel",b);OpenLayers.Event.observe(document,"mousewheel",b);return true}else{return false}},deactivate:function(a){if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){var b=this.wheelListener;OpenLayers.Event.stopObserving(window,"DOMMouseScroll",b);OpenLayers.Event.stopObserving(window,"mousewheel",b);OpenLayers.Event.stopObserving(document,"mousewheel",b);return true}else{return false}},CLASS_NAME:"OpenLayers.Handler.MouseWheel"});OpenLayers.Layer=OpenLayers.Class({id:null,name:null,div:null,opacity:null,alwaysInRange:null,EVENT_TYPES:["loadstart","loadend","loadcancel","visibilitychanged","move","moveend"],RESOLUTION_PROPERTIES:["scales","resolutions","maxScale","minScale","maxResolution","minResolution","numZoomLevels","maxZoomLevel"],events:null,map:null,isBaseLayer:false,alpha:false,displayInLayerSwitcher:true,visibility:true,attribution:null,inRange:false,imageSize:null,imageOffset:null,options:null,eventListeners:null,gutter:0,projection:null,units:null,scales:null,resolutions:null,maxExtent:null,minExtent:null,maxResolution:null,minResolution:null,numZoomLevels:null,minScale:null,maxScale:null,displayOutsideMaxExtent:false,wrapDateLine:false,transitionEffect:null,SUPPORTED_TRANSITIONS:["resize"],metadata:{},initialize:function(b,a){this.addOptions(a);this.name=b;if(this.id==null){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_");this.div=OpenLayers.Util.createDiv(this.id);this.div.style.width="100%";this.div.style.height="100%";this.div.dir="ltr";this.events=new OpenLayers.Events(this,this.div,this.EVENT_TYPES);if(this.eventListeners instanceof Object){this.events.on(this.eventListeners)}}if(this.wrapDateLine){this.displayOutsideMaxExtent=true}},destroy:function(a){if(a==null){a=true}if(this.map!=null){this.map.removeLayer(this,a)}this.projection=null;this.map=null;this.name=null;this.div=null;this.options=null;if(this.events){if(this.eventListeners){this.events.un(this.eventListeners)}this.events.destroy()}this.eventListeners=null;this.events=null},clone:function(a){if(a==null){a=new OpenLayers.Layer(this.name,this.getOptions())}OpenLayers.Util.applyDefaults(a,this);a.map=null;return a},getOptions:function(){var a={};for(var b in this.options){a[b]=this[b]}return a},setName:function(a){if(a!=this.name){this.name=a;if(this.map!=null){this.map.events.triggerEvent("changelayer",{layer:this,property:"name"})}}},addOptions:function(c){if(this.options==null){this.options={}}OpenLayers.Util.extend(this.options,c);OpenLayers.Util.extend(this,c);if(typeof this.projection=="string"){this.projection=new OpenLayers.Projection(this.projection)}if(this.projection&&this.projection.getUnits()){this.units=this.projection.getUnits()}if(this.map){var a=this.RESOLUTION_PROPERTIES.concat(["projection","units","minExtent","maxExtent"]);for(var b in c){if(c.hasOwnProperty(b)&&OpenLayers.Util.indexOf(a,b)>=0){this.initResolutions();break}}}},onMapResize:function(){},redraw:function(){var b=false;if(this.map){this.inRange=this.calculateInRange();var c=this.getExtent();if(c&&this.inRange&&this.visibility){var a=true;this.moveTo(c,a,false);this.events.triggerEvent("moveend",{zoomChanged:a});b=true}}return b},moveTo:function(b,a,c){var d=this.visibility;if(!this.isBaseLayer){d=d&&this.inRange}this.display(d)},setMap:function(b){if(this.map==null){this.map=b;this.maxExtent=this.maxExtent||this.map.maxExtent;this.minExtent=this.minExtent||this.map.minExtent;this.projection=this.projection||this.map.projection;if(typeof this.projection=="string"){this.projection=new OpenLayers.Projection(this.projection)}this.units=this.projection.getUnits()||this.units||this.map.units;
this.initResolutions();if(!this.isBaseLayer){this.inRange=this.calculateInRange();var a=((this.visibility)&&(this.inRange));this.div.style.display=a?"":"none"}this.setTileSize()}},afterAdd:function(){},removeMap:function(a){},getImageSize:function(a){return(this.imageSize||this.tileSize)},setTileSize:function(a){var b=(a)?a:((this.tileSize)?this.tileSize:this.map.getTileSize());this.tileSize=b;if(this.gutter){this.imageOffset=new OpenLayers.Pixel(-this.gutter,-this.gutter);this.imageSize=new OpenLayers.Size(b.w+(2*this.gutter),b.h+(2*this.gutter))}},getVisibility:function(){return this.visibility},setVisibility:function(a){if(a!=this.visibility){this.visibility=a;this.display(a);this.redraw();if(this.map!=null){this.map.events.triggerEvent("changelayer",{layer:this,property:"visibility"})}this.events.triggerEvent("visibilitychanged")}},display:function(a){if(a!=(this.div.style.display!="none")){this.div.style.display=(a&&this.calculateInRange())?"block":"none"}},calculateInRange:function(){var b=false;if(this.alwaysInRange){b=true}else{if(this.map){var a=this.map.getResolution();b=((a>=this.minResolution)&&(a<=this.maxResolution))}}return b},setIsBaseLayer:function(a){if(a!=this.isBaseLayer){this.isBaseLayer=a;if(this.map!=null){this.map.events.triggerEvent("changebaselayer",{layer:this})}}},initResolutions:function(){var e,a;var f={},d=true;for(e=0,a=this.RESOLUTION_PROPERTIES.length;e<a;e++){var h=this.RESOLUTION_PROPERTIES[e];f[h]=this.options[h];if(d&&this.options[h]){d=false}}if(this.alwaysInRange==null){this.alwaysInRange=d}if(f.resolutions==null){f.resolutions=this.resolutionsFromScales(f.scales)}if(f.resolutions==null){f.resolutions=this.calculateResolutions(f)}if(f.resolutions==null){for(e=0,a=this.RESOLUTION_PROPERTIES.length;e<a;e++){var h=this.RESOLUTION_PROPERTIES[e];f[h]=this.options[h]!=null?this.options[h]:this.map[h]}if(f.resolutions==null){f.resolutions=this.resolutionsFromScales(f.scales)}if(f.resolutions==null){f.resolutions=this.calculateResolutions(f)}}var c;if(this.options.maxResolution&&this.options.maxResolution!=="auto"){c=this.options.maxResolution}if(this.options.minScale){c=OpenLayers.Util.getResolutionFromScale(this.options.minScale,this.units)}var b;if(this.options.minResolution&&this.options.minResolution!=="auto"){b=this.options.minResolution}if(this.options.maxScale){b=OpenLayers.Util.getResolutionFromScale(this.options.maxScale,this.units)}if(f.resolutions){f.resolutions.sort(function(j,i){return(i-j)});if(!c){c=f.resolutions[0]}if(!b){var g=f.resolutions.length-1;b=f.resolutions[g]}}this.resolutions=f.resolutions;if(this.resolutions){a=this.resolutions.length;this.scales=new Array(a);for(e=0;e<a;e++){this.scales[e]=OpenLayers.Util.getScaleFromResolution(this.resolutions[e],this.units)}this.numZoomLevels=a}this.minResolution=b;if(b){this.maxScale=OpenLayers.Util.getScaleFromResolution(b,this.units)}this.maxResolution=c;if(c){this.minScale=OpenLayers.Util.getScaleFromResolution(c,this.units)}},resolutionsFromScales:function(d){if(d==null){return}var b,c,a;a=d.length;b=new Array(a);for(c=0;c<a;c++){b[c]=OpenLayers.Util.getResolutionFromScale(d[c],this.units)}return b},calculateResolutions:function(k){var m=k.maxResolution;if(k.minScale!=null){m=OpenLayers.Util.getResolutionFromScale(k.minScale,this.units)}else{if(m=="auto"&&this.maxExtent!=null){var l=this.map.getSize();var j=this.maxExtent.getWidth()/l.w;var g=this.maxExtent.getHeight()/l.h;m=Math.max(j,g)}}var f=k.minResolution;if(k.maxScale!=null){f=OpenLayers.Util.getResolutionFromScale(k.maxScale,this.units)}else{if(k.minResolution=="auto"&&this.minExtent!=null){var l=this.map.getSize();var j=this.minExtent.getWidth()/l.w;var g=this.minExtent.getHeight()/l.h;f=Math.max(j,g)}}var a=k.maxZoomLevel;var b=k.numZoomLevels;if(typeof f==="number"&&typeof m==="number"&&b===undefined){var h=m/f;b=Math.floor(Math.log(h)/Math.log(2))+1}else{if(b===undefined&&a!=null){b=a+1}}if(typeof b!=="number"||b<=0||(typeof m!=="number"&&typeof f!=="number")){return
}var d=new Array(b);var c=2;if(typeof f=="number"&&typeof m=="number"){c=Math.pow((m/f),(1/(b-1)))}var e;if(typeof m==="number"){for(e=0;e<b;e++){d[e]=m/Math.pow(c,e)}}else{for(e=0;e<b;e++){d[b-1-e]=f*Math.pow(c,e)}}return d},getResolution:function(){var a=this.map.getZoom();return this.getResolutionForZoom(a)},getExtent:function(){return this.map.calculateBounds()},getZoomForExtent:function(b,c){var d=this.map.getSize();var a=Math.max(b.getWidth()/d.w,b.getHeight()/d.h);return this.getZoomForResolution(a,c)},getDataExtent:function(){},getResolutionForZoom:function(c){c=Math.max(0,Math.min(c,this.resolutions.length-1));var b;if(this.map.fractionalZoom){var a=Math.floor(c);var d=Math.ceil(c);b=this.resolutions[a]-((c-a)*(this.resolutions[a]-this.resolutions[d]))}else{b=this.resolutions[Math.round(c)]}return b},getZoomForResolution:function(e,a){var n;if(this.map.fractionalZoom){var k=0;var c=this.resolutions.length-1;var d=this.resolutions[k];var b=this.resolutions[c];var j;for(var f=0,g=this.resolutions.length;f<g;++f){j=this.resolutions[f];if(j>=e){d=j;k=f}if(j<=e){b=j;c=f;break}}var h=d-b;if(h>0){n=k+((d-e)/h)}else{n=k}}else{var l;var m=Number.POSITIVE_INFINITY;for(var f=0,g=this.resolutions.length;f<g;f++){if(a){l=Math.abs(this.resolutions[f]-e);if(l>m){break}m=l}else{if(this.resolutions[f]<e){break}}}n=Math.max(0,f-1)}return n},getLonLatFromViewPortPx:function(b){var e=null;if(b!=null){var d=this.map.getSize();var a=this.map.getCenter();if(a){var c=this.map.getResolution();var g=b.x-(d.w/2);var f=b.y-(d.h/2);e=new OpenLayers.LonLat(a.lon+g*c,a.lat-f*c);if(this.wrapDateLine){e=e.wrapDateLine(this.maxExtent)}}}return e},getViewPortPxFromLonLat:function(d){var b=null;if(d!=null){var a=this.map.getResolution();var c=this.map.getExtent();b=new OpenLayers.Pixel((1/a*(d.lon-c.left)),(1/a*(c.top-d.lat)))}return b},setOpacity:function(b){if(b!=this.opacity){this.opacity=b;for(var d=0,a=this.div.childNodes.length;d<a;++d){var c=this.div.childNodes[d].firstChild;OpenLayers.Util.modifyDOMElement(c,null,null,null,null,null,null,b)}if(this.map!=null){this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"})}}},getZIndex:function(){return this.div.style.zIndex},setZIndex:function(a){this.div.style.zIndex=a},adjustBounds:function(b){if(this.gutter){var a=this.gutter*this.map.getResolution();b=new OpenLayers.Bounds(b.left-a,b.bottom-a,b.right+a,b.top+a)}if(this.wrapDateLine){var c={rightTolerance:this.getResolution()};b=b.wrapDateLine(this.maxExtent,c)}return b},CLASS_NAME:"OpenLayers.Layer"});OpenLayers.Marker.Box=OpenLayers.Class(OpenLayers.Marker,{bounds:null,div:null,initialize:function(b,c,a){this.bounds=b;this.div=OpenLayers.Util.createDiv();this.div.style.overflow="hidden";this.events=new OpenLayers.Events(this,this.div,null);this.setBorder(c,a)},destroy:function(){this.bounds=null;this.div=null;OpenLayers.Marker.prototype.destroy.apply(this,arguments)},setBorder:function(a,b){if(!a){a="red"}if(!b){b=2}this.div.style.border=b+"px solid "+a},draw:function(a,b){OpenLayers.Util.modifyDOMElement(this.div,null,a,b);return this.div},onScreen:function(){var b=false;if(this.map){var a=this.map.getExtent();b=a.containsBounds(this.bounds,true,true)}return b},display:function(a){this.div.style.display=(a)?"":"none"},CLASS_NAME:"OpenLayers.Marker.Box"});(function(){var e=window.XMLHttpRequest;var a=!!window.controllers,h=window.document.all&&!window.opera,i=h&&window.navigator.userAgent.match(/MSIE ([\.0-9]+)/)&&RegExp.$1==7;function c(){this._object=e&&!i?new e:new window.ActiveXObject("Microsoft.XMLHTTP");this._listeners=[]}if(a&&e.wrapped){c.wrapped=e.wrapped}c.UNSENT=0;c.OPENED=1;c.HEADERS_RECEIVED=2;c.LOADING=3;c.DONE=4;c.prototype.readyState=c.UNSENT;c.prototype.responseText="";c.prototype.responseXML=null;c.prototype.status=0;c.prototype.statusText="";c.prototype.onreadystatechange=null;c.onreadystatechange=null;c.onopen=null;c.onsend=null;c.onabort=null;c.prototype.open=function(m,p,l,q,k){delete this._headers;if(arguments.length<3){l=true
}this._async=l;var o=this,n=this.readyState,j;if(h&&l){j=function(){if(n!=c.DONE){d(o);o.abort()}};window.attachEvent("onunload",j)}if(c.onopen){c.onopen.apply(this,arguments)}if(arguments.length>4){this._object.open(m,p,l,q,k)}else{if(arguments.length>3){this._object.open(m,p,l,q)}else{this._object.open(m,p,l)}}if(!a&&!h){this.readyState=c.OPENED;b(this)}this._object.onreadystatechange=function(){if(a&&!l){return}o.readyState=o._object.readyState;f(o);if(o._aborted){o.readyState=c.UNSENT;return}if(o.readyState==c.DONE){d(o);if(h&&l){window.detachEvent("onunload",j)}}if(n!=o.readyState){b(o)}n=o.readyState}};c.prototype.send=function(j){if(c.onsend){c.onsend.apply(this,arguments)}if(j&&j.nodeType){j=window.XMLSerializer?new window.XMLSerializer().serializeToString(j):j.xml;if(!this._headers["Content-Type"]){this._object.setRequestHeader("Content-Type","application/xml")}}this._object.send(j);if(a&&!this._async){this.readyState=c.OPENED;f(this);while(this.readyState<c.DONE){this.readyState++;b(this);if(this._aborted){return}}}};c.prototype.abort=function(){if(c.onabort){c.onabort.apply(this,arguments)}if(this.readyState>c.UNSENT){this._aborted=true}this._object.abort();d(this)};c.prototype.getAllResponseHeaders=function(){return this._object.getAllResponseHeaders()};c.prototype.getResponseHeader=function(j){return this._object.getResponseHeader(j)};c.prototype.setRequestHeader=function(j,k){if(!this._headers){this._headers={}}this._headers[j]=k;return this._object.setRequestHeader(j,k)};c.prototype.addEventListener=function(m,l,k){for(var j=0,n;n=this._listeners[j];j++){if(n[0]==m&&n[1]==l&&n[2]==k){return}}this._listeners.push([m,l,k])};c.prototype.removeEventListener=function(m,l,k){for(var j=0,n;n=this._listeners[j];j++){if(n[0]==m&&n[1]==l&&n[2]==k){break}}if(n){this._listeners.splice(j,1)}};c.prototype.dispatchEvent=function(k){var l={type:k.type,target:this,currentTarget:this,eventPhase:2,bubbles:k.bubbles,cancelable:k.cancelable,timeStamp:k.timeStamp,stopPropagation:function(){},preventDefault:function(){},initEvent:function(){}};if(l.type=="readystatechange"&&this.onreadystatechange){(this.onreadystatechange.handleEvent||this.onreadystatechange).apply(this,[l])}for(var j=0,m;m=this._listeners[j];j++){if(m[0]==l.type&&!m[2]){(m[1].handleEvent||m[1]).apply(this,[l])}}};c.prototype.toString=function(){return"[object XMLHttpRequest]"};c.toString=function(){return"[XMLHttpRequest]"};function b(j){if(c.onreadystatechange){c.onreadystatechange.apply(j)}j.dispatchEvent({type:"readystatechange",bubbles:false,cancelable:false,timeStamp:new Date+0})}function g(l){var k=l.responseXML,j=l.responseText;if(h&&j&&k&&!k.documentElement&&l.getResponseHeader("Content-Type").match(/[^\/]+\/[^\+]+\+xml/)){k=new window.ActiveXObject("Microsoft.XMLDOM");k.async=false;k.validateOnParse=false;k.loadXML(j)}if(k){if((h&&k.parseError!=0)||!k.documentElement||(k.documentElement&&k.documentElement.tagName=="parsererror")){return null}}return k}function f(j){try{j.responseText=j._object.responseText}catch(k){}try{j.responseXML=g(j._object)}catch(k){}try{j.status=j._object.status}catch(k){}try{j.statusText=j._object.statusText}catch(k){}}function d(j){j._object.onreadystatechange=new window.Function}if(!window.Function.prototype.apply){window.Function.prototype.apply=function(j,k){if(!k){k=[]}j.__func=this;j.__func(k[0],k[1],k[2],k[3],k[4]);delete j.__func}}OpenLayers.Request.XMLHttpRequest=c})();OpenLayers.Tile.Image.IFrame=OpenLayers.Class(OpenLayers.Tile.Image,{initialize:function(d,a,e,b,c){OpenLayers.Tile.Image.prototype.initialize.apply(this,arguments);this.layerAlphaHack=false},destroy:function(){if(this.imgDiv!=null){OpenLayers.Event.stopObservingElement(this.imgDiv.firstChild)}OpenLayers.Tile.Image.prototype.destroy.apply(this,arguments)},clear:function(){if(this.imgDiv){var a=this.imgDiv.firstChild;OpenLayers.Event.stopObservingElement(a);this.imgDiv.removeChild(a)}},clone:function(a){if(a==null){a=new OpenLayers.Tile.Image.IFrame(this.layer,this.position,this.bounds,this.url,this.size)
}a=OpenLayers.Tile.Image.prototype.clone.apply(this,[a]);return a},renderTile:function(){if(OpenLayers.Tile.Image.prototype.renderTile.apply(this,arguments)){var a=this.createRequestForm();this.imgDiv.appendChild(a);a.submit();this.imgDiv.removeChild(a)}},initImgDiv:function(){this.imgDiv=this.createImgDiv();OpenLayers.Util.modifyDOMElement(this.imgDiv,this.id,null,this.layer.getImageSize(),"relative");this.imgDiv.className="olTileImage";this.frame.appendChild(this.imgDiv);this.layer.div.appendChild(this.frame);if(this.layer.opacity!=null){OpenLayers.Util.modifyDOMElement(this.imgDiv,null,null,null,null,null,null,this.layer.opacity)}this.imgDiv.map=this.layer.map},createImgDiv:function(){var b=document.createElement("div");if(OpenLayers.Util.getBrowserName()=="msie"){b.style.backgroundColor="#FFFFFF";b.style.filter="chroma(color=#FFFFFF)"}OpenLayers.Util.modifyDOMElement(b,null,new OpenLayers.Pixel(0,0),this.layer.getImageSize(),"absolute");var a=document.createElement("div");a.appendChild(b);return a},createIFrame:function(){var c=this.id+"_iFrame";var a;if(OpenLayers.Util.getBrowserName()=="msie"){a=document.createElement('<iframe name="'+c+'">');a.style.backgroundColor="#FFFFFF";a.style.filter="chroma(color=#FFFFFF)"}else{a=document.createElement("iframe");a.style.backgroundColor="transparent";a.name=c}a.id=c;a.scrolling="no";a.marginWidth="0px";a.marginHeight="0px";a.frameBorder="0";OpenLayers.Util.modifyDOMElement(a,c,new OpenLayers.Pixel(0,0),this.layer.getImageSize(),"absolute");var b=function(){this.show();if(this.isLoading){this.isLoading=false;this.events.triggerEvent("loadend")}};OpenLayers.Event.observe(a,"load",OpenLayers.Function.bind(b,this));return a},createRequestForm:function(){var b=document.createElement("form");b.method="POST";var f=this.layer.params._OLSALT;f=(f?f+"_":"")+this.bounds.toBBOX();b.action=OpenLayers.Util.urlAppend(this.layer.url,f);this.imgDiv.insertBefore(this.createIFrame(),this.imgDiv.firstChild);b.target=this.id+"_iFrame";var c=this.layer.getImageSize();var e=OpenLayers.Util.extend({BBOX:this.encodeBBOX?this.bounds.toBBOX():this.bounds.toArray(),WIDTH:c.w,HEIGHT:c.h},this.layer.params);for(var a in e){var d=document.createElement("input");d.type="hidden";d.name=a;d.value=e[a];b.appendChild(d)}return b},CLASS_NAME:"OpenLayers.Tile.Image.IFrame"});OpenLayers.ProxyHost="";OpenLayers.nullHandler=function(a){OpenLayers.Console.userError(OpenLayers.i18n("unhandledRequest",{statusText:a.statusText}))};OpenLayers.loadURL=function(d,g,b,e,c){if(typeof g=="string"){g=OpenLayers.Util.getParameters(g)}var f=(e)?e:OpenLayers.nullHandler;var a=(c)?c:OpenLayers.nullHandler;return OpenLayers.Request.GET({url:d,params:g,success:f,failure:a,scope:b})};OpenLayers.parseXMLString=function(c){var a=c.indexOf("<");if(a>0){c=c.substring(a)}var b=OpenLayers.Util.Try(function(){var d=new ActiveXObject("Microsoft.XMLDOM");d.loadXML(c);return d},function(){return new DOMParser().parseFromString(c,"text/xml")},function(){var d=new XMLHttpRequest();d.open("GET","data:text/xml;charset=utf-8,"+encodeURIComponent(c),false);if(d.overrideMimeType){d.overrideMimeType("text/xml")}d.send(null);return d.responseXML});return b};OpenLayers.Ajax={emptyFunction:function(){},getTransport:function(){return OpenLayers.Util.Try(function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")})||false},activeRequestCount:0};OpenLayers.Ajax.Responders={responders:[],register:function(b){for(var a=0;a<this.responders.length;a++){if(b==this.responders[a]){return}}this.responders.push(b)},unregister:function(a){OpenLayers.Util.removeItem(this.reponders,a)},dispatch:function(g,c,f){var a;for(var b=0;b<this.responders.length;b++){a=this.responders[b];if(a[g]&&typeof a[g]=="function"){try{a[g].apply(a,[c,f])}catch(d){}}}}};OpenLayers.Ajax.Responders.register({onCreate:function(){OpenLayers.Ajax.activeRequestCount++},onComplete:function(){OpenLayers.Ajax.activeRequestCount--
}});OpenLayers.Ajax.Base=OpenLayers.Class({initialize:function(a){this.options={method:"post",asynchronous:true,contentType:"application/xml",parameters:""};OpenLayers.Util.extend(this.options,a||{});this.options.method=this.options.method.toLowerCase();if(typeof this.options.parameters=="string"){this.options.parameters=OpenLayers.Util.getParameters(this.options.parameters)}}});OpenLayers.Ajax.Request=OpenLayers.Class(OpenLayers.Ajax.Base,{_complete:false,initialize:function(b,a){OpenLayers.Ajax.Base.prototype.initialize.apply(this,[a]);if(OpenLayers.ProxyHost&&OpenLayers.String.startsWith(b,"http")){b=OpenLayers.ProxyHost+encodeURIComponent(b)}this.transport=OpenLayers.Ajax.getTransport();this.request(b)},request:function(b){this.url=b;this.method=this.options.method;var d=OpenLayers.Util.extend({},this.options.parameters);if(this.method!="get"&&this.method!="post"){d._method=this.method;this.method="post"}this.parameters=d;if(d=OpenLayers.Util.getParameterString(d)){if(this.method=="get"){this.url+=((this.url.indexOf("?")>-1)?"&":"?")+d}else{if(/Konqueror|Safari|KHTML/.test(navigator.userAgent)){d+="&_="}}}try{var a=new OpenLayers.Ajax.Response(this);if(this.options.onCreate){this.options.onCreate(a)}OpenLayers.Ajax.Responders.dispatch("onCreate",this,a);this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous);if(this.options.asynchronous){window.setTimeout(OpenLayers.Function.bind(this.respondToReadyState,this,1),10)}this.transport.onreadystatechange=OpenLayers.Function.bind(this.onStateChange,this);this.setRequestHeaders();this.body=this.method=="post"?(this.options.postBody||d):null;this.transport.send(this.body);if(!this.options.asynchronous&&this.transport.overrideMimeType){this.onStateChange()}}catch(c){this.dispatchException(c)}},onStateChange:function(){var a=this.transport.readyState;if(a>1&&!((a==4)&&this._complete)){this.respondToReadyState(this.transport.readyState)}},setRequestHeaders:function(){var e={"X-Requested-With":"XMLHttpRequest",Accept:"text/javascript, text/html, application/xml, text/xml, */*",OpenLayers:true};if(this.method=="post"){e["Content-type"]=this.options.contentType+(this.options.encoding?"; charset="+this.options.encoding:"");if(this.transport.overrideMimeType&&(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]<2005){e.Connection="close"}}if(typeof this.options.requestHeaders=="object"){var c=this.options.requestHeaders;if(typeof c.push=="function"){for(var b=0,d=c.length;b<d;b+=2){e[c[b]]=c[b+1]}}else{for(var b in c){e[b]=c[b]}}}for(var a in e){this.transport.setRequestHeader(a,e[a])}},success:function(){var a=this.getStatus();return !a||(a>=200&&a<300)},getStatus:function(){try{return this.transport.status||0}catch(a){return 0}},respondToReadyState:function(a){var c=OpenLayers.Ajax.Request.Events[a];var b=new OpenLayers.Ajax.Response(this);if(c=="Complete"){try{this._complete=true;(this.options["on"+b.status]||this.options["on"+(this.success()?"Success":"Failure")]||OpenLayers.Ajax.emptyFunction)(b)}catch(d){this.dispatchException(d)}var f=b.getHeader("Content-type")}try{(this.options["on"+c]||OpenLayers.Ajax.emptyFunction)(b);OpenLayers.Ajax.Responders.dispatch("on"+c,this,b)}catch(d){this.dispatchException(d)}if(c=="Complete"){this.transport.onreadystatechange=OpenLayers.Ajax.emptyFunction}},getHeader:function(a){try{return this.transport.getResponseHeader(a)}catch(b){return null}},dispatchException:function(c){var d=this.options.onException;if(d){d(this,c);OpenLayers.Ajax.Responders.dispatch("onException",this,c)}else{var e=false;var a=OpenLayers.Ajax.Responders.responders;for(var b=0;b<a.length;b++){if(a[b].onException){e=true;break}}if(e){OpenLayers.Ajax.Responders.dispatch("onException",this,c)}else{throw c}}}});OpenLayers.Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"];OpenLayers.Ajax.Response=OpenLayers.Class({status:0,statusText:"",initialize:function(c){this.request=c;var d=this.transport=c.transport,a=this.readyState=d.readyState;
if((a>2&&!(!!(window.attachEvent&&!window.opera)))||a==4){this.status=this.getStatus();this.statusText=this.getStatusText();this.responseText=d.responseText==null?"":String(d.responseText)}if(a==4){var b=d.responseXML;this.responseXML=b===undefined?null:b}},getStatus:OpenLayers.Ajax.Request.prototype.getStatus,getStatusText:function(){try{return this.transport.statusText||""}catch(a){return""}},getHeader:OpenLayers.Ajax.Request.prototype.getHeader,getResponseHeader:function(a){return this.transport.getResponseHeader(a)}});OpenLayers.Ajax.getElementsByTagNameNS=function(b,a,c,e){var d=null;if(b.getElementsByTagNameNS){d=b.getElementsByTagNameNS(a,e)}else{d=b.getElementsByTagName(c+":"+e)}return d};OpenLayers.Ajax.serializeXMLToString=function(a){var b=new XMLSerializer();var c=b.serializeToString(a);return c};OpenLayers.Control.DragFeature=OpenLayers.Class(OpenLayers.Control,{geometryTypes:null,onStart:function(b,a){},onDrag:function(b,a){},onComplete:function(b,a){},documentDrag:false,layer:null,feature:null,dragCallbacks:{},featureCallbacks:{},lastPixel:null,initialize:function(b,a){OpenLayers.Control.prototype.initialize.apply(this,[a]);this.layer=b;this.handlers={drag:new OpenLayers.Handler.Drag(this,OpenLayers.Util.extend({down:this.downFeature,move:this.moveFeature,up:this.upFeature,out:this.cancel,done:this.doneDragging},this.dragCallbacks),{documentDrag:this.documentDrag}),feature:new OpenLayers.Handler.Feature(this,this.layer,OpenLayers.Util.extend({over:this.overFeature,out:this.outFeature},this.featureCallbacks),{geometryTypes:this.geometryTypes})}},destroy:function(){this.layer=null;OpenLayers.Control.prototype.destroy.apply(this,[])},activate:function(){return(this.handlers.feature.activate()&&OpenLayers.Control.prototype.activate.apply(this,arguments))},deactivate:function(){this.handlers.drag.deactivate();this.handlers.feature.deactivate();this.feature=null;this.dragging=false;this.lastPixel=null;OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass+"Over");return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},overFeature:function(a){if(!this.handlers.drag.dragging){this.feature=a;this.handlers.drag.activate();this.over=true;OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass+"Over")}else{if(this.feature.id==a.id){this.over=true}else{this.over=false}}},downFeature:function(a){this.lastPixel=a;this.onStart(this.feature,a)},moveFeature:function(a){var b=this.map.getResolution();this.feature.geometry.move(b*(a.x-this.lastPixel.x),b*(this.lastPixel.y-a.y));this.layer.drawFeature(this.feature);this.lastPixel=a;this.onDrag(this.feature,a)},upFeature:function(a){if(!this.over){this.handlers.drag.deactivate()}},doneDragging:function(a){this.onComplete(this.feature,a)},outFeature:function(a){if(!this.handlers.drag.dragging){this.over=false;this.handlers.drag.deactivate();OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass+"Over");this.feature=null}else{if(this.feature.id==a.id){this.over=false}}},cancel:function(){this.handlers.drag.deactivate();this.over=false},setMap:function(a){this.handlers.drag.setMap(a);this.handlers.feature.setMap(a);OpenLayers.Control.prototype.setMap.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.DragFeature"});OpenLayers.Control.DragPan=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,panned:false,interval:25,documentDrag:false,draw:function(){this.handler=new OpenLayers.Handler.Drag(this,{move:this.panMap,done:this.panMapDone},{interval:this.interval,documentDrag:this.documentDrag})},panMap:function(a){this.panned=true;this.map.pan(this.handler.last.x-a.x,this.handler.last.y-a.y,{dragging:this.handler.dragging,animate:false})},panMapDone:function(a){if(this.panned){this.panMap(a);this.panned=false}},CLASS_NAME:"OpenLayers.Control.DragPan"});OpenLayers.Control.KeyboardDefaults=OpenLayers.Class(OpenLayers.Control,{autoActivate:true,slideFactor:75,initialize:function(){OpenLayers.Control.prototype.initialize.apply(this,arguments)
},destroy:function(){if(this.handler){this.handler.destroy()}this.handler=null;OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){this.handler=new OpenLayers.Handler.Keyboard(this,{keydown:this.defaultKeyPress})},defaultKeyPress:function(a){switch(a.keyCode){case OpenLayers.Event.KEY_LEFT:this.map.pan(-this.slideFactor,0);break;case OpenLayers.Event.KEY_RIGHT:this.map.pan(this.slideFactor,0);break;case OpenLayers.Event.KEY_UP:this.map.pan(0,-this.slideFactor);break;case OpenLayers.Event.KEY_DOWN:this.map.pan(0,this.slideFactor);break;case 33:var b=this.map.getSize();this.map.pan(0,-0.75*b.h);break;case 34:var b=this.map.getSize();this.map.pan(0,0.75*b.h);break;case 35:var b=this.map.getSize();this.map.pan(0.75*b.w,0);break;case 36:var b=this.map.getSize();this.map.pan(-0.75*b.w,0);break;case 43:case 61:case 187:case 107:this.map.zoomIn();break;case 45:case 109:case 189:case 95:this.map.zoomOut();break}},CLASS_NAME:"OpenLayers.Control.KeyboardDefaults"});OpenLayers.Control.WMSGetFeatureInfo=OpenLayers.Class(OpenLayers.Control,{hover:false,drillDown:false,maxFeatures:10,clickCallback:"click",layers:null,queryVisible:false,url:null,layerUrls:null,infoFormat:"text/html",vendorParams:{},format:null,formatOptions:null,handlerOptions:null,handler:null,hoverRequest:null,EVENT_TYPES:["beforegetfeatureinfo","nogetfeatureinfo","getfeatureinfo"],initialize:function(a){this.EVENT_TYPES=OpenLayers.Control.WMSGetFeatureInfo.prototype.EVENT_TYPES.concat(OpenLayers.Control.prototype.EVENT_TYPES);a=a||{};a.handlerOptions=a.handlerOptions||{};OpenLayers.Control.prototype.initialize.apply(this,[a]);if(!this.format){this.format=new OpenLayers.Format.WMSGetFeatureInfo(a.formatOptions)}if(this.drillDown===true){this.hover=false}if(this.hover){this.handler=new OpenLayers.Handler.Hover(this,{move:this.cancelHover,pause:this.getInfoForHover},OpenLayers.Util.extend(this.handlerOptions.hover||{},{delay:250}))}else{var b={};b[this.clickCallback]=this.getInfoForClick;this.handler=new OpenLayers.Handler.Click(this,b,this.handlerOptions.click||{})}},activate:function(){if(!this.active){this.handler.activate()}return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},getInfoForClick:function(a){this.events.triggerEvent("beforegetfeatureinfo",{xy:a.xy});OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait");this.request(a.xy,{})},getInfoForHover:function(a){this.events.triggerEvent("beforegetfeatureinfo",{xy:a.xy});this.request(a.xy,{hover:true})},cancelHover:function(){if(this.hoverRequest){this.hoverRequest.abort();this.hoverRequest=null}},findLayers:function(){var e=this.layers||this.map.layers;var f=[];var d,b;for(var c=0,a=e.length;c<a;++c){d=e[c];if(d instanceof OpenLayers.Layer.WMS&&(!this.queryVisible||d.getVisibility())){b=d.url instanceof Array?d.url[0]:d.url;if(this.drillDown===false&&!this.url){this.url=b}if(this.drillDown===true||this.urlMatches(b)){f.push(d)}}}return f},urlMatches:function(b){var d=OpenLayers.Util.isEquivalentUrl(this.url,b);if(!d&&this.layerUrls){for(var c=0,a=this.layerUrls.length;c<a;++c){if(OpenLayers.Util.isEquivalentUrl(this.layerUrls[c],b)){d=true;break}}}return d},buildWMSOptions:function(a,d,b,h){var g=[],j=[];for(var e=0,f=d.length;e<f;e++){g=g.concat(d[e].params.LAYERS);j=j.concat(this.getStyleNames(d[e]))}var c=OpenLayers.Util.extend({service:"WMS",version:d[0].params.VERSION,request:"GetFeatureInfo",layers:g,query_layers:g,styles:j,bbox:this.map.getExtent().toBBOX(null,d[0].reverseAxisOrder()),feature_count:this.maxFeatures,height:this.map.getSize().h,width:this.map.getSize().w,format:h,info_format:this.infoFormat},(parseFloat(d[0].params.VERSION)>=1.3)?{crs:this.map.getProjection(),i:b.x,j:b.y}:{srs:this.map.getProjection(),x:b.x,y:b.y});OpenLayers.Util.applyDefaults(c,this.vendorParams);return{url:a,params:OpenLayers.Util.upperCaseObject(c),callback:function(i){this.handleResponse(b,i)
},scope:this}},getStyleNames:function(b){var a;if(b.params.STYLES){a=b.params.STYLES}else{if(b.params.LAYERS instanceof Array){a=new Array(b.params.LAYERS.length)}else{a=b.params.LAYERS.replace(/[^,]/g,"")}}return a},request:function(b,m){var d=this.findLayers();if(d.length==0){this.events.triggerEvent("nogetfeatureinfo");OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait");return}m=m||{};if(this.drillDown===false){var k=this.buildWMSOptions(this.url,d,b,d[0].params.FORMAT);var c=OpenLayers.Request.GET(k);if(m.hover===true){this.hoverRequest=c}}else{this._requestCount=0;this._numRequests=0;this.features=[];var j={},a;for(var e=0,h=d.length;e<h;e++){var f=d[e];var g,l=false;a=f.url instanceof Array?f.url[0]:f.url;if(a in j){j[a].push(f)}else{this._numRequests++;j[a]=[f]}}var d;for(var a in j){d=j[a];var k=this.buildWMSOptions(a,d,b,d[0].params.FORMAT);OpenLayers.Request.GET(k)}}},triggerGetFeatureInfo:function(b,c,a){this.events.triggerEvent("getfeatureinfo",{text:b.responseText,features:a,request:b,xy:c});OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait")},handleResponse:function(d,b){var c=b.responseXML;if(!c||!c.documentElement){c=b.responseText}var a=this.format.read(c);if(this.drillDown===false){this.triggerGetFeatureInfo(b,d,a)}else{this._requestCount++;this._features=(this._features||[]).concat(a);if(this._requestCount===this._numRequests){this.triggerGetFeatureInfo(b,d,this._features.concat());delete this._features;delete this._requestCount;delete this._numRequests}}},CLASS_NAME:"OpenLayers.Control.WMSGetFeatureInfo"});OpenLayers.Control.WMTSGetFeatureInfo=OpenLayers.Class(OpenLayers.Control,{hover:false,requestEncoding:"KVP",drillDown:false,maxFeatures:10,clickCallback:"click",layers:null,queryVisible:true,infoFormat:"text/html",vendorParams:{},format:null,formatOptions:null,handlerOptions:null,handler:null,hoverRequest:null,EVENT_TYPES:["beforegetfeatureinfo","getfeatureinfo","exception"],pending:0,initialize:function(a){this.EVENT_TYPES=OpenLayers.Control.WMTSGetFeatureInfo.prototype.EVENT_TYPES.concat(OpenLayers.Control.prototype.EVENT_TYPES);a=a||{};a.handlerOptions=a.handlerOptions||{};OpenLayers.Control.prototype.initialize.apply(this,[a]);if(!this.format){this.format=new OpenLayers.Format.WMSGetFeatureInfo(a.formatOptions)}if(this.drillDown===true){this.hover=false}if(this.hover){this.handler=new OpenLayers.Handler.Hover(this,{move:this.cancelHover,pause:this.getInfoForHover},OpenLayers.Util.extend(this.handlerOptions.hover||{},{delay:250}))}else{var b={};b[this.clickCallback]=this.getInfoForClick;this.handler=new OpenLayers.Handler.Click(this,b,this.handlerOptions.click||{})}},activate:function(){if(!this.active){this.handler.activate()}return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},getInfoForClick:function(a){this.request(a.xy,{})},getInfoForHover:function(a){this.request(a.xy,{hover:true})},cancelHover:function(){if(this.hoverRequest){--this.pending;if(this.pending<=0){OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait");this.pending=0}this.hoverRequest.abort();this.hoverRequest=null}},findLayers:function(){var c=this.layers||this.map.layers;var d=[];var b;for(var a=c.length-1;a>=0;--a){b=c[a];if(b instanceof OpenLayers.Layer.WMTS&&b.requestEncoding===this.requestEncoding&&(!this.queryVisible||b.getVisibility())){d.push(b);if(!this.drillDown||this.hover){break}}}return d},buildRequestOptions:function(b,c){var f=this.map.getLonLatFromPixel(c);var e=b.getURL(new OpenLayers.Bounds(f.lon,f.lat,f.lon,f.lat));var d=OpenLayers.Util.getParameters(e);var a=b.getTileInfo(f);OpenLayers.Util.extend(d,{service:"WMTS",version:b.version,request:"GetFeatureInfo",infoFormat:this.infoFormat,i:a.i,j:a.j});OpenLayers.Util.applyDefaults(d,this.vendorParams);return{url:b.url instanceof Array?b.url[0]:b.url,params:OpenLayers.Util.upperCaseObject(d),callback:function(g){this.handleResponse(c,g,b)
},scope:this}},request:function(h,j){j=j||{};var c=this.findLayers();if(c.length>0){var g,e;for(var d=0,f=c.length;d<f;d++){e=c[d];g=this.events.triggerEvent("beforegetfeatureinfo",{xy:h,layer:e});if(g!==false){++this.pending;var a=this.buildRequestOptions(e,h);var b=OpenLayers.Request.GET(a);if(j.hover===true){this.hoverRequest=b}}}if(this.pending>0){OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait")}}},handleResponse:function(g,e,b){--this.pending;if(this.pending<=0){OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait");this.pending=0}if(e.status&&(e.status<200||e.status>=300)){this.events.triggerEvent("exception",{xy:g,request:e,layer:b})}else{var f=e.responseXML;if(!f||!f.documentElement){f=e.responseText}var d,c;try{d=this.format.read(f)}catch(a){c=true;this.events.triggerEvent("exception",{xy:g,request:e,error:a,layer:b})}if(!c){this.events.triggerEvent("getfeatureinfo",{text:e.responseText,features:d,request:e,xy:g,layer:b})}}},setMap:function(a){this.handler.setMap(a);OpenLayers.Control.prototype.setMap.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.WMTSGetFeatureInfo"});OpenLayers.State={UNKNOWN:"Unknown",INSERT:"Insert",UPDATE:"Update",DELETE:"Delete"};OpenLayers.Feature.Vector=OpenLayers.Class(OpenLayers.Feature,{fid:null,geometry:null,attributes:null,bounds:null,state:null,style:null,url:null,renderIntent:"default",initialize:function(c,a,b){OpenLayers.Feature.prototype.initialize.apply(this,[null,null,a]);this.lonlat=null;this.geometry=c?c:null;this.state=null;this.attributes={};if(a){this.attributes=OpenLayers.Util.extend(this.attributes,a)}this.style=b?b:null},destroy:function(){if(this.layer){this.layer.removeFeatures(this);this.layer=null}this.geometry=null;OpenLayers.Feature.prototype.destroy.apply(this,arguments)},clone:function(){return new OpenLayers.Feature.Vector(this.geometry?this.geometry.clone():null,this.attributes,this.style)},onScreen:function(d){var c=false;if(this.layer&&this.layer.map){var a=this.layer.map.getExtent();if(d){var b=this.geometry.getBounds();c=a.intersectsBounds(b)}else{var e=a.toGeometry();c=e.intersects(this.geometry)}}return c},getVisibility:function(){return !(this.style&&this.style.display=="none"||!this.layer||this.layer&&this.layer.styleMap&&this.layer.styleMap.createSymbolizer(this,this.renderIntent).display=="none"||this.layer&&!this.layer.getVisibility())},createMarker:function(){return null},destroyMarker:function(){},createPopup:function(){return null},atPoint:function(b,d,c){var a=false;if(this.geometry){a=this.geometry.atPoint(b,d,c)}return a},destroyPopup:function(){},move:function(a){if(!this.layer||!this.geometry.move){return}var b;if(a.CLASS_NAME=="OpenLayers.LonLat"){b=this.layer.getViewPortPxFromLonLat(a)}else{b=a}var d=this.layer.getViewPortPxFromLonLat(this.geometry.getBounds().getCenterLonLat());var c=this.layer.map.getResolution();this.geometry.move(c*(b.x-d.x),c*(d.y-b.y));this.layer.drawFeature(this);return d},toState:function(a){if(a==OpenLayers.State.UPDATE){switch(this.state){case OpenLayers.State.UNKNOWN:case OpenLayers.State.DELETE:this.state=a;break;case OpenLayers.State.UPDATE:case OpenLayers.State.INSERT:break}}else{if(a==OpenLayers.State.INSERT){switch(this.state){case OpenLayers.State.UNKNOWN:break;default:this.state=a;break}}else{if(a==OpenLayers.State.DELETE){switch(this.state){case OpenLayers.State.INSERT:break;case OpenLayers.State.DELETE:break;case OpenLayers.State.UNKNOWN:case OpenLayers.State.UPDATE:this.state=a;break}}else{if(a==OpenLayers.State.UNKNOWN){this.state=a}}}}},CLASS_NAME:"OpenLayers.Feature.Vector"});OpenLayers.Feature.Vector.style={"default":{fillColor:"#ee9900",fillOpacity:0.4,hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"#ee9900",strokeOpacity:1,strokeWidth:1,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit"},select:{fillColor:"blue",fillOpacity:0.4,hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"blue",strokeOpacity:1,strokeWidth:2,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"pointer"},temporary:{fillColor:"#66cccc",fillOpacity:0.2,hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"#66cccc",strokeOpacity:1,strokeLinecap:"round",strokeWidth:2,strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit"},"delete":{display:"none"}};
OpenLayers.Feature.WFS=OpenLayers.Class(OpenLayers.Feature,{initialize:function(c,b){var a=arguments;var d=this.processXMLNode(b);a=new Array(c,d.lonlat,d);OpenLayers.Feature.prototype.initialize.apply(this,a);this.createMarker();this.layer.addMarker(this.marker)},destroy:function(){if(this.marker!=null){this.layer.removeMarker(this.marker)}OpenLayers.Feature.prototype.destroy.apply(this,arguments)},processXMLNode:function(b){var a=OpenLayers.Ajax.getElementsByTagNameNS(b,"http://www.opengis.net/gml","gml","Point");var d=OpenLayers.Util.getXmlNodeValue(OpenLayers.Ajax.getElementsByTagNameNS(a[0],"http://www.opengis.net/gml","gml","coordinates")[0]);var c=d.split(",");return{lonlat:new OpenLayers.LonLat(parseFloat(c[0]),parseFloat(c[1])),id:null}},CLASS_NAME:"OpenLayers.Feature.WFS"});OpenLayers.Format.OWSCommon.v1_0_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1,{namespaces:{ows:"http://www.opengis.net/ows/1.0",xlink:"http://www.w3.org/1999/xlink"},readers:{ows:OpenLayers.Format.OWSCommon.v1.prototype.readers.ows},writers:{ows:OpenLayers.Format.OWSCommon.v1.prototype.writers.ows},CLASS_NAME:"OpenLayers.Format.OWSCommon.v1_1_0"});OpenLayers.Format.OWSCommon.v1_1_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1,{namespaces:{ows:"http://www.opengis.net/ows/1.1",xlink:"http://www.w3.org/1999/xlink"},readers:{ows:OpenLayers.Util.applyDefaults({AllowedValues:function(a,b){b.allowedValues={};this.readChildNodes(a,b.allowedValues)},AnyValue:function(a,b){b.anyValue=true},Range:function(a,b){b.range={};this.readChildNodes(a,b.range)},MinimumValue:function(b,a){a.minValue=this.getChildValue(b)},MaximumValue:function(b,a){a.maxValue=this.getChildValue(b)},Identifier:function(a,b){b.identifier=this.getChildValue(a)},SupportedCRS:function(a,b){b.supportedCRS=this.getChildValue(a)}},OpenLayers.Format.OWSCommon.v1.prototype.readers.ows)},CLASS_NAME:"OpenLayers.Format.OWSCommon.v1_1_0"});OpenLayers.Format.OWSContext=OpenLayers.Class(OpenLayers.Format.Context,{defaultVersion:"0.3.1",getParser:function(a){var b=a||this.version||this.defaultVersion;if(b==="0.3.0"){b=this.defaultVersion}if(!this.parser||this.parser.VERSION!=b){var c=OpenLayers.Format.OWSContext["v"+b.replace(/\./g,"_")];if(!c){throw"Can't find a OWSContext parser for version "+b}this.parser=new c(this.options)}return this.parser},toContext:function(b){var a={};if(b.CLASS_NAME=="OpenLayers.Map"){a.bounds=b.getExtent();a.maxExtent=b.maxExtent;a.projection=b.projection;a.size=b.getSize();a.layers=b.layers}return a},CLASS_NAME:"OpenLayers.Format.OWSContext"});OpenLayers.Format.WFSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.WFSCapabilities,{initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);this.options=a},read:function(c){if(typeof c=="string"){c=OpenLayers.Format.XML.prototype.read.apply(this,[c])}var a={};var b=c.documentElement;this.runChildNodes(a,b);return a},runChildNodes:function(f,e){var c=e.childNodes;var b,d;for(var a=0;a<c.length;++a){b=c[a];if(b.nodeType==1){d=this["read_cap_"+b.nodeName];if(d){d.apply(this,[f,b])}}}},read_cap_FeatureTypeList:function(c,b){var a={featureTypes:[]};this.runChildNodes(a,b);c.featureTypeList=a},read_cap_FeatureType:function(a,d,b){var c={};this.runChildNodes(c,d);a.featureTypes.push(c)},read_cap_Name:function(d,b){var a=this.getChildValue(b);if(a){var c=a.split(":");d.name=c.pop();if(c.length>0){d.featureNS=this.lookupNamespaceURI(b,c[0])}}},read_cap_Title:function(b,a){var c=this.getChildValue(a);if(c){b.title=c}},read_cap_Abstract:function(c,b){var a=this.getChildValue(b);if(a){c["abstract"]=a}},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1"});OpenLayers.Format.WMC=OpenLayers.Class(OpenLayers.Format.Context,{defaultVersion:"1.1.0",getParser:function(a){var b=a||this.version||this.defaultVersion;if(!this.parser||this.parser.VERSION!=b){var c=OpenLayers.Format.WMC["v"+b.replace(/\./g,"_")];if(!c){throw"Can't find a WMC parser for version "+b}this.parser=new c(this.options)}return this.parser},layerToContext:function(a){var c=this.getParser();
var b={queryable:a.queryable,visibility:a.visibility,name:a.params.LAYERS,title:a.name,metadataURL:a.metadataURL,version:a.params.VERSION,url:a.url,maxExtent:a.maxExtent,transparent:a.params.TRANSPARENT,numZoomLevels:a.numZoomLevels,units:a.units,isBaseLayer:a.isBaseLayer,opacity:a.opacity,displayInLayerSwitcher:a.displayInLayerSwitcher,singleTile:a.singleTile,tileSize:(a.singleTile||!a.tileSize)?undefined:{width:a.tileSize.w,height:a.tileSize.h},minScale:(a.options.resolutions||a.options.scales||a.options.maxResolution||a.options.minScale)?a.minScale:undefined,maxScale:(a.options.resolutions||a.options.scales||a.options.minResolution||a.options.maxScale)?a.maxScale:undefined,formats:[{value:a.params.FORMAT,current:true}],styles:[{href:a.params.SLD,body:a.params.SLD_BODY,name:a.params.STYLES||c.defaultStyleName,title:c.defaultStyleTitle,current:true}]};return b},toContext:function(f){var d={};var e=f.layers;if(f.CLASS_NAME=="OpenLayers.Map"){d.bounds=f.getExtent();d.maxExtent=f.maxExtent;d.projection=f.projection;d.size=f.getSize()}else{OpenLayers.Util.applyDefaults(d,f);if(d.layers!=undefined){delete (d.layers)}}if(d.layersContext==undefined){d.layersContext=[]}if(e!=undefined&&e instanceof Array){for(var c=0,a=e.length;c<a;c++){var b=e[c];if(b instanceof OpenLayers.Layer.WMS){d.layersContext.push(this.layerToContext(b))}}}return d},CLASS_NAME:"OpenLayers.Format.WMC"});OpenLayers.Format.WMSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{wms:"http://www.opengis.net/wms",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"wms",initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(b){if(typeof b=="string"){b=OpenLayers.Format.XML.prototype.read.apply(this,[b])}if(b&&b.nodeType==9){b=b.documentElement}var a={};this.readNode(b,a);this.postProcessLayers(a);return a},postProcessLayers:function(b){if(b.capability){b.capability.layers=[];var e=b.capability.nestedLayers;for(var d=0,a=e.length;d<a;++d){var c=e[d];this.processLayer(b.capability,c)}}},processLayer:function(a,k,c){if(k.formats===undefined){k.formats=a.request.getmap.formats}if(c){k.styles=k.styles.concat(c.styles);var f=["queryable","cascaded","fixedWidth","fixedHeight","opaque","noSubsets","llbbox","minScale","maxScale","attribution"];var n=["srs","bbox","dimensions","authorityURLs"];var m;for(var e=0;e<f.length;e++){m=f[e];if(m in c){if(k[m]==null){k[m]=c[m]}if(k[m]==null){var h=["cascaded","fixedWidth","fixedHeight"];var b=["queryable","opaque","noSubsets"];if(OpenLayers.Util.indexOf(h,m)!=-1){k[m]=0}if(OpenLayers.Util.indexOf(b,m)!=-1){k[m]=false}}}}for(var e=0;e<n.length;e++){m=n[e];k[m]=OpenLayers.Util.extend(k[m],c[m])}}for(var g=0,l=k.nestedLayers.length;g<l;g++){var d=k.nestedLayers[g];this.processLayer(a,d,k)}if(k.name){a.layers.push(k)}},readers:{wms:{Service:function(a,b){b.service={};this.readChildNodes(a,b.service)},Name:function(a,b){b.name=this.getChildValue(a)},Title:function(a,b){b.title=this.getChildValue(a)},Abstract:function(a,b){b["abstract"]=this.getChildValue(a)},BoundingBox:function(b,c){var d={};d.bbox=[parseFloat(b.getAttribute("minx")),parseFloat(b.getAttribute("miny")),parseFloat(b.getAttribute("maxx")),parseFloat(b.getAttribute("maxy"))];var a={x:parseFloat(b.getAttribute("resx")),y:parseFloat(b.getAttribute("resy"))};if(!(isNaN(a.x)&&isNaN(a.y))){d.res=a}return d},OnlineResource:function(a,b){b.href=this.getAttributeNS(a,this.namespaces.xlink,"href")},ContactInformation:function(a,b){b.contactInformation={};this.readChildNodes(a,b.contactInformation)},ContactPersonPrimary:function(a,b){b.personPrimary={};this.readChildNodes(a,b.personPrimary)},ContactPerson:function(a,b){b.person=this.getChildValue(a)},ContactOrganization:function(a,b){b.organization=this.getChildValue(a)},ContactPosition:function(a,b){b.position=this.getChildValue(a)},ContactAddress:function(a,b){b.contactAddress={};this.readChildNodes(a,b.contactAddress)},AddressType:function(a,b){b.type=this.getChildValue(a)
},Address:function(a,b){b.address=this.getChildValue(a)},City:function(a,b){b.city=this.getChildValue(a)},StateOrProvince:function(a,b){b.stateOrProvince=this.getChildValue(a)},PostCode:function(a,b){b.postcode=this.getChildValue(a)},Country:function(a,b){b.country=this.getChildValue(a)},ContactVoiceTelephone:function(a,b){b.phone=this.getChildValue(a)},ContactFacsimileTelephone:function(a,b){b.fax=this.getChildValue(a)},ContactElectronicMailAddress:function(a,b){b.email=this.getChildValue(a)},Fees:function(b,c){var a=this.getChildValue(b);if(a&&a.toLowerCase()!="none"){c.fees=a}},AccessConstraints:function(a,b){var c=this.getChildValue(a);if(c&&c.toLowerCase()!="none"){b.accessConstraints=c}},Capability:function(a,b){b.capability={nestedLayers:[]};this.readChildNodes(a,b.capability)},Request:function(a,b){b.request={};this.readChildNodes(a,b.request)},GetCapabilities:function(a,b){b.getcapabilities={formats:[]};this.readChildNodes(a,b.getcapabilities)},Format:function(a,b){if(b.formats instanceof Array){b.formats.push(this.getChildValue(a))}else{b.format=this.getChildValue(a)}},DCPType:function(a,b){this.readChildNodes(a,b)},HTTP:function(a,b){this.readChildNodes(a,b)},Get:function(a,b){this.readChildNodes(a,b)},Post:function(a,b){this.readChildNodes(a,b)},GetMap:function(a,b){b.getmap={formats:[]};this.readChildNodes(a,b.getmap)},GetFeatureInfo:function(a,b){b.getfeatureinfo={formats:[]};this.readChildNodes(a,b.getfeatureinfo)},Exception:function(a,b){b.exception={formats:[]};this.readChildNodes(a,b.exception)},Layer:function(b,e){var k=b.getAttributeNode("queryable");var c=(k&&k.specified)?b.getAttribute("queryable"):null;k=b.getAttributeNode("cascaded");var i=(k&&k.specified)?b.getAttribute("cascaded"):null;k=b.getAttributeNode("opaque");var f=(k&&k.specified)?b.getAttribute("opaque"):null;var j=b.getAttribute("noSubsets");var a=b.getAttribute("fixedWidth");var h=b.getAttribute("fixedHeight");var g={nestedLayers:[],styles:[],srs:{},metadataURLs:[],bbox:{},dimensions:{},authorityURLs:{},identifiers:{},keywords:[],queryable:(c&&c!=="")?(c==="1"||c==="true"):null,cascaded:(i!==null)?parseInt(i):null,opaque:f?(f==="1"||f==="true"):null,noSubsets:(j!==null)?(j==="1"||j==="true"):null,fixedWidth:(a!=null)?parseInt(a):null,fixedHeight:(h!=null)?parseInt(h):null};e.nestedLayers.push(g);this.readChildNodes(b,g);if(g.name){var d=g.name.split(":");if(d.length>0){g.prefix=d[0]}}},Attribution:function(a,b){b.attribution={};this.readChildNodes(a,b.attribution)},LogoURL:function(a,b){b.logo={width:a.getAttribute("width"),height:a.getAttribute("height")};this.readChildNodes(a,b.logo)},Style:function(b,c){var a={};c.styles.push(a);this.readChildNodes(b,a)},LegendURL:function(b,c){var a={width:b.getAttribute("width"),height:b.getAttribute("height")};c.legend=a;this.readChildNodes(b,a)},MetadataURL:function(a,b){var c={type:a.getAttribute("type")};b.metadataURLs.push(c);this.readChildNodes(a,c)},DataURL:function(a,b){b.dataURL={};this.readChildNodes(a,b.dataURL)},FeatureListURL:function(a,b){b.featureListURL={};this.readChildNodes(a,b.featureListURL)},AuthorityURL:function(b,d){var a=b.getAttribute("name");var c={};this.readChildNodes(b,c);d.authorityURLs[a]=c.href},Identifier:function(a,c){var b=a.getAttribute("authority");c.identifiers[b]=this.getChildValue(a)},KeywordList:function(a,b){this.readChildNodes(a,b)},SRS:function(a,b){b.srs[this.getChildValue(a)]=true}}},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1"});OpenLayers.Format.WMSDescribeLayer.v1_1=OpenLayers.Class(OpenLayers.Format.WMSDescribeLayer,{initialize:function(a){OpenLayers.Format.WMSDescribeLayer.prototype.initialize.apply(this,[a])},read:function(d){if(typeof d=="string"){d=OpenLayers.Format.XML.prototype.read.apply(this,[d])}var j=d.documentElement;var b=j.childNodes;var f=[];var a,m;for(var e=0;e<b.length;++e){a=b[e];m=a.nodeName;if(m=="LayerDescription"){var g=a.getAttribute("name");var l="";var c="";var k="";if(a.getAttribute("owsType")){l=a.getAttribute("owsType");c=a.getAttribute("owsURL")
}else{if(a.getAttribute("wfs")!=""){l="WFS";c=a.getAttribute("wfs")}else{if(a.getAttribute("wcs")!=""){l="WCS";c=a.getAttribute("wcs")}}}var h=a.getElementsByTagName("Query");if(h.length>0){k=h[0].getAttribute("typeName");if(!k){k=h[0].getAttribute("typename")}}f.push({layerName:g,owsType:l,owsURL:c,typeName:k})}}return f},CLASS_NAME:"OpenLayers.Format.WMSDescribeLayer.v1_1"});OpenLayers.Handler.Box=OpenLayers.Class(OpenLayers.Handler,{dragHandler:null,boxDivClassName:"olHandlerBoxZoomBox",boxCharacteristics:null,initialize:function(c,b,a){OpenLayers.Handler.prototype.initialize.apply(this,arguments);var b={down:this.startBox,move:this.moveBox,out:this.removeBox,up:this.endBox};this.dragHandler=new OpenLayers.Handler.Drag(this,b,{keyMask:this.keyMask})},destroy:function(){if(this.dragHandler){this.dragHandler.destroy();this.dragHandler=null}OpenLayers.Handler.prototype.destroy.apply(this,arguments)},setMap:function(a){OpenLayers.Handler.prototype.setMap.apply(this,arguments);if(this.dragHandler){this.dragHandler.setMap(a)}},startBox:function(a){this.zoomBox=OpenLayers.Util.createDiv("zoomBox",this.dragHandler.start);this.zoomBox.className=this.boxDivClassName;this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1;this.map.viewPortDiv.appendChild(this.zoomBox);OpenLayers.Element.addClass(this.map.viewPortDiv,"olDrawBox")},moveBox:function(f){var d=this.dragHandler.start.x;var b=this.dragHandler.start.y;var c=Math.abs(d-f.x);var a=Math.abs(b-f.y);this.zoomBox.style.width=Math.max(1,c)+"px";this.zoomBox.style.height=Math.max(1,a)+"px";this.zoomBox.style.left=f.x<d?f.x+"px":d+"px";this.zoomBox.style.top=f.y<b?f.y+"px":b+"px";var e=this.getBoxCharacteristics();if(e.newBoxModel){if(f.x>d){this.zoomBox.style.width=Math.max(1,c-e.xOffset)+"px"}if(f.y>b){this.zoomBox.style.height=Math.max(1,a-e.yOffset)+"px"}}},endBox:function(b){var a;if(Math.abs(this.dragHandler.start.x-b.x)>5||Math.abs(this.dragHandler.start.y-b.y)>5){var g=this.dragHandler.start;var f=Math.min(g.y,b.y);var c=Math.max(g.y,b.y);var e=Math.min(g.x,b.x);var d=Math.max(g.x,b.x);a=new OpenLayers.Bounds(e,c,d,f)}else{a=this.dragHandler.start.clone()}this.removeBox();this.callback("done",[a])},removeBox:function(){this.map.viewPortDiv.removeChild(this.zoomBox);this.zoomBox=null;this.boxCharacteristics=null;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDrawBox")},activate:function(){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.dragHandler.activate();return true}else{return false}},deactivate:function(){if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.dragHandler.deactivate();return true}else{return false}},getBoxCharacteristics:function(){if(!this.boxCharacteristics){var a=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-left-width"))+parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-right-width"))+1;var c=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-top-width"))+parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-bottom-width"))+1;var b=OpenLayers.Util.getBrowserName()=="msie"?document.compatMode!="BackCompat":true;this.boxCharacteristics={xOffset:a,yOffset:c,newBoxModel:b}}return this.boxCharacteristics},CLASS_NAME:"OpenLayers.Handler.Box"});OpenLayers.Handler.RegularPolygon=OpenLayers.Class(OpenLayers.Handler.Drag,{sides:4,radius:null,snapAngle:null,snapToggle:"shiftKey",layerOptions:null,persist:false,irregular:false,angle:null,fixedRadius:false,feature:null,layer:null,origin:null,initialize:function(c,b,a){if(!(a&&a.layerOptions&&a.layerOptions.styleMap)){this.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style["default"],{})}OpenLayers.Handler.prototype.initialize.apply(this,[c,b,a]);this.options=(a)?a:{}},setOptions:function(a){OpenLayers.Util.extend(this.options,a);OpenLayers.Util.extend(this,a)},activate:function(){var a=false;if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){var b=OpenLayers.Util.extend({displayInLayerSwitcher:false,calculateInRange:OpenLayers.Function.True},this.layerOptions);
this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,b);this.map.addLayer(this.layer);a=true}return a},deactivate:function(){var a=false;if(OpenLayers.Handler.Drag.prototype.deactivate.apply(this,arguments)){if(this.dragging){this.cancel()}if(this.layer.map!=null){this.layer.destroy(false);if(this.feature){this.feature.destroy()}}this.layer=null;this.feature=null;a=true}return a},down:function(a){this.fixedRadius=!!(this.radius);var b=this.map.getLonLatFromPixel(a.xy);this.origin=new OpenLayers.Geometry.Point(b.lon,b.lat);if(!this.fixedRadius||this.irregular){this.radius=this.map.getResolution()}if(this.persist){this.clear()}this.feature=new OpenLayers.Feature.Vector();this.createGeometry();this.callback("create",[this.origin,this.feature]);this.layer.addFeatures([this.feature],{silent:true});this.layer.drawFeature(this.feature,this.style)},move:function(c){var f=this.map.getLonLatFromPixel(c.xy);var a=new OpenLayers.Geometry.Point(f.lon,f.lat);if(this.irregular){var g=Math.sqrt(2)*Math.abs(a.y-this.origin.y)/2;this.radius=Math.max(this.map.getResolution()/2,g)}else{if(this.fixedRadius){this.origin=a}else{this.calculateAngle(a,c);this.radius=Math.max(this.map.getResolution()/2,a.distanceTo(this.origin))}}this.modifyGeometry();if(this.irregular){var d=a.x-this.origin.x;var b=a.y-this.origin.y;var e;if(b==0){e=d/(this.radius*Math.sqrt(2))}else{e=d/b}this.feature.geometry.resize(1,this.origin,e);this.feature.geometry.move(d/2,b/2)}this.layer.drawFeature(this.feature,this.style)},up:function(a){this.finalize();if(this.start==this.last){this.callback("done",[a.xy])}},out:function(a){this.finalize()},createGeometry:function(){this.angle=Math.PI*((1/this.sides)-(1/2));if(this.snapAngle){this.angle+=this.snapAngle*(Math.PI/180)}this.feature.geometry=OpenLayers.Geometry.Polygon.createRegularPolygon(this.origin,this.radius,this.sides,this.snapAngle)},modifyGeometry:function(){var d,a;var b=this.feature.geometry.components[0];if(b.components.length!=(this.sides+1)){this.createGeometry();b=this.feature.geometry.components[0]}for(var c=0;c<this.sides;++c){a=b.components[c];d=this.angle+(c*2*Math.PI/this.sides);a.x=this.origin.x+(this.radius*Math.cos(d));a.y=this.origin.y+(this.radius*Math.sin(d));a.clearBounds()}},calculateAngle:function(a,b){var d=Math.atan2(a.y-this.origin.y,a.x-this.origin.x);if(this.snapAngle&&(this.snapToggle&&!b[this.snapToggle])){var c=(Math.PI/180)*this.snapAngle;this.angle=Math.round(d/c)*c}else{this.angle=d}},cancel:function(){this.callback("cancel",null);this.finalize()},finalize:function(){this.origin=null;this.radius=this.options.radius},clear:function(){if(this.layer){this.layer.renderer.clear();this.layer.destroyFeatures()}},callback:function(b,a){if(this.callbacks[b]){this.callbacks[b].apply(this.control,[this.feature.geometry.clone()])}if(!this.persist&&(b=="done"||b=="cancel")){this.clear()}},CLASS_NAME:"OpenLayers.Handler.RegularPolygon"});OpenLayers.Layer.EventPane=OpenLayers.Class(OpenLayers.Layer,{smoothDragPan:true,isBaseLayer:true,isFixed:true,pane:null,mapObject:null,initialize:function(b,a){OpenLayers.Layer.prototype.initialize.apply(this,arguments);if(this.pane==null){this.pane=OpenLayers.Util.createDiv(this.div.id+"_EventPane")}},destroy:function(){this.mapObject=null;this.pane=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},setMap:function(a){OpenLayers.Layer.prototype.setMap.apply(this,arguments);this.pane.style.zIndex=parseInt(this.div.style.zIndex)+1;this.pane.style.display=this.div.style.display;this.pane.style.width="100%";this.pane.style.height="100%";if(OpenLayers.Util.getBrowserName()=="msie"){this.pane.style.background="url("+OpenLayers.Util.getImagesLocation()+"blank.gif)"}if(this.isFixed){this.map.viewPortDiv.appendChild(this.pane)}else{this.map.layerContainerDiv.appendChild(this.pane)}this.loadMapObject();if(this.mapObject==null){this.loadWarningMessage()}},removeMap:function(a){if(this.pane&&this.pane.parentNode){this.pane.parentNode.removeChild(this.pane)}OpenLayers.Layer.prototype.removeMap.apply(this,arguments)
},loadWarningMessage:function(){this.div.style.backgroundColor="darkblue";var g=this.map.getSize();var a=Math.min(g.w,300);var e=Math.min(g.h,200);var b=new OpenLayers.Size(a,e);var d=new OpenLayers.Pixel(g.w/2,g.h/2);var c=d.add(-b.w/2,-b.h/2);var f=OpenLayers.Util.createDiv(this.name+"_warning",c,b,null,null,null,"auto");f.style.padding="7px";f.style.backgroundColor="yellow";f.innerHTML=this.getWarningHTML();this.div.appendChild(f)},getWarningHTML:function(){return""},display:function(a){OpenLayers.Layer.prototype.display.apply(this,arguments);this.pane.style.display=this.div.style.display},setZIndex:function(a){OpenLayers.Layer.prototype.setZIndex.apply(this,arguments);this.pane.style.zIndex=parseInt(this.div.style.zIndex)+1},moveTo:function(c,d,j){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);if(this.mapObject!=null){var e=this.map.getCenter();var g=this.map.getZoom();if(e!=null){var f=this.getMapObjectCenter();var b=this.getOLLonLatFromMapObjectLonLat(f);var h=this.getMapObjectZoom();var m=this.getOLZoomFromMapObjectZoom(h);if(!(e.equals(b))||!(g==m)){if(j&&this.dragPanMapObject&&this.smoothDragPan){var i=this.map.getViewPortPxFromLonLat(b);var k=this.map.getViewPortPxFromLonLat(e);this.dragPanMapObject(k.x-i.x,i.y-k.y)}else{var a=this.getMapObjectLonLatFromOLLonLat(e);var l=this.getMapObjectZoomFromOLZoom(g);this.setMapObjectCenter(a,l,j)}}}}},getLonLatFromViewPortPx:function(a){var b=null;if((this.mapObject!=null)&&(this.getMapObjectCenter()!=null)){var d=this.getMapObjectPixelFromOLPixel(a);var c=this.getMapObjectLonLatFromMapObjectPixel(d);b=this.getOLLonLatFromMapObjectLonLat(c)}return b},getViewPortPxFromLonLat:function(b){var a=null;if((this.mapObject!=null)&&(this.getMapObjectCenter()!=null)){var d=this.getMapObjectLonLatFromOLLonLat(b);var c=this.getMapObjectPixelFromMapObjectLonLat(d);a=this.getOLPixelFromMapObjectPixel(c)}return a},getOLLonLatFromMapObjectLonLat:function(d){var a=null;if(d!=null){var c=this.getLongitudeFromMapObjectLonLat(d);var b=this.getLatitudeFromMapObjectLonLat(d);a=new OpenLayers.LonLat(c,b)}return a},getMapObjectLonLatFromOLLonLat:function(a){var b=null;if(a!=null){b=this.getMapObjectLonLatFromLonLat(a.lon,a.lat)}return b},getOLPixelFromMapObjectPixel:function(d){var b=null;if(d!=null){var a=this.getXFromMapObjectPixel(d);var c=this.getYFromMapObjectPixel(d);b=new OpenLayers.Pixel(a,c)}return b},getMapObjectPixelFromOLPixel:function(a){var b=null;if(a!=null){b=this.getMapObjectPixelFromXY(a.x,a.y)}return b},CLASS_NAME:"OpenLayers.Layer.EventPane"});OpenLayers.Layer.FixedZoomLevels=OpenLayers.Class({initialize:function(){},initResolutions:function(){var c=new Array("minZoomLevel","maxZoomLevel","numZoomLevels");for(var b=0,a=c.length;b<a;b++){var f=c[b];this[f]=(this.options[f]!=null)?this.options[f]:this.map[f]}if((this.minZoomLevel==null)||(this.minZoomLevel<this.MIN_ZOOM_LEVEL)){this.minZoomLevel=this.MIN_ZOOM_LEVEL}var g;var e=this.MAX_ZOOM_LEVEL-this.minZoomLevel+1;if(((this.options.numZoomLevels==null)&&(this.options.maxZoomLevel!=null))||((this.numZoomLevels==null)&&(this.maxZoomLevel!=null))){g=this.maxZoomLevel-this.minZoomLevel+1}else{g=this.numZoomLevels}if(g!=null){this.numZoomLevels=Math.min(g,e)}else{this.numZoomLevels=e}this.maxZoomLevel=this.minZoomLevel+this.numZoomLevels-1;if(this.RESOLUTIONS!=null){var d=0;this.resolutions=[];for(var b=this.minZoomLevel;b<=this.maxZoomLevel;b++){this.resolutions[d++]=this.RESOLUTIONS[b]}this.maxResolution=this.resolutions[0];this.minResolution=this.resolutions[this.resolutions.length-1]}},getResolution:function(){if(this.resolutions!=null){return OpenLayers.Layer.prototype.getResolution.apply(this,arguments)}else{var a=null;var c=this.map.getSize();var b=this.getExtent();if((c!=null)&&(b!=null)){a=Math.max(b.getWidth()/c.w,b.getHeight()/c.h)}return a}},getExtent:function(){var c=null;var b=this.map.getSize();var e=new OpenLayers.Pixel(0,0);var f=this.getLonLatFromViewPortPx(e);var a=new OpenLayers.Pixel(b.w,b.h);var d=this.getLonLatFromViewPortPx(a);
if((f!=null)&&(d!=null)){c=new OpenLayers.Bounds(f.lon,d.lat,d.lon,f.lat)}return c},getZoomForResolution:function(a){if(this.resolutions!=null){return OpenLayers.Layer.prototype.getZoomForResolution.apply(this,arguments)}else{var b=OpenLayers.Layer.prototype.getExtent.apply(this,[]);return this.getZoomForExtent(b)}},getOLZoomFromMapObjectZoom:function(a){var b=null;if(a!=null){b=a-this.minZoomLevel}return b},getMapObjectZoomFromOLZoom:function(a){var b=null;if(a!=null){b=a+this.minZoomLevel}return b},CLASS_NAME:"OpenLayers.Layer.FixedZoomLevels"});OpenLayers.Layer.HTTPRequest=OpenLayers.Class(OpenLayers.Layer,{URL_HASH_FACTOR:(Math.sqrt(5)-1)/2,url:null,params:null,reproject:false,initialize:function(d,c,e,b){var a=arguments;a=[d,b];OpenLayers.Layer.prototype.initialize.apply(this,a);this.url=c;this.params=OpenLayers.Util.extend({},e)},destroy:function(){this.url=null;this.params=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(a){if(a==null){a=new OpenLayers.Layer.HTTPRequest(this.name,this.url,this.params,this.getOptions())}a=OpenLayers.Layer.prototype.clone.apply(this,[a]);return a},setUrl:function(a){this.url=a},mergeNewParams:function(b){this.params=OpenLayers.Util.extend(this.params,b);var a=this.redraw();if(this.map!=null){this.map.events.triggerEvent("changelayer",{layer:this,property:"params"})}return a},redraw:function(a){if(a){return this.mergeNewParams({_olSalt:Math.random()})}else{return OpenLayers.Layer.prototype.redraw.apply(this,[])}},selectUrl:function(e,d){var c=1;for(var b=0,a=e.length;b<a;b++){c*=e.charCodeAt(b)*this.URL_HASH_FACTOR;c-=Math.floor(c)}return d[Math.floor(c*d.length)]},getFullRequestString:function(g,d){var b=d||this.url;var f=OpenLayers.Util.extend({},this.params);f=OpenLayers.Util.extend(f,g);var e=OpenLayers.Util.getParameterString(f);if(b instanceof Array){b=this.selectUrl(e,b)}var a=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(b));for(var c in f){if(c.toUpperCase() in a){delete f[c]}}e=OpenLayers.Util.getParameterString(f);return OpenLayers.Util.urlAppend(b,e)},CLASS_NAME:"OpenLayers.Layer.HTTPRequest"});OpenLayers.Layer.Image=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:true,url:null,extent:null,size:null,tile:null,aspectRatio:null,initialize:function(c,b,e,d,a){this.url=b;this.extent=e;this.maxExtent=e;this.size=d;OpenLayers.Layer.prototype.initialize.apply(this,[c,a]);this.aspectRatio=(this.extent.getHeight()/this.size.h)/(this.extent.getWidth()/this.size.w)},destroy:function(){if(this.tile){this.removeTileMonitoringHooks(this.tile);this.tile.destroy();this.tile=null}OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(a){if(a==null){a=new OpenLayers.Layer.Image(this.name,this.url,this.extent,this.size,this.getOptions())}a=OpenLayers.Layer.prototype.clone.apply(this,[a]);return a},setMap:function(a){if(this.options.maxResolution==null){this.options.maxResolution=this.aspectRatio*this.extent.getWidth()/this.size.w}OpenLayers.Layer.prototype.setMap.apply(this,arguments)},moveTo:function(e,a,f){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var b=(this.tile==null);if(a||b){this.setTileSize();var d=new OpenLayers.LonLat(this.extent.left,this.extent.top);var c=this.map.getLayerPxFromLonLat(d);if(b){this.tile=new OpenLayers.Tile.Image(this,c,this.extent,null,this.tileSize);this.addTileMonitoringHooks(this.tile)}else{this.tile.size=this.tileSize.clone();this.tile.position=c.clone()}this.tile.draw()}},setTileSize:function(){var b=this.extent.getWidth()/this.map.getResolution();var a=this.extent.getHeight()/this.map.getResolution();this.tileSize=new OpenLayers.Size(b,a)},addTileMonitoringHooks:function(a){a.onLoadStart=function(){this.events.triggerEvent("loadstart")};a.events.register("loadstart",this,a.onLoadStart);a.onLoadEnd=function(){this.events.triggerEvent("loadend")};a.events.register("loadend",this,a.onLoadEnd);a.events.register("unload",this,a.onLoadEnd)},removeTileMonitoringHooks:function(a){a.unload();a.events.un({loadstart:a.onLoadStart,loadend:a.onLoadEnd,unload:a.onLoadEnd,scope:this})
},setUrl:function(a){this.url=a;this.tile.draw()},getURL:function(a){return this.url},CLASS_NAME:"OpenLayers.Layer.Image"});OpenLayers.Layer.Markers=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:false,markers:null,drawn:false,initialize:function(b,a){OpenLayers.Layer.prototype.initialize.apply(this,arguments);this.markers=[]},destroy:function(){this.clearMarkers();this.markers=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},setOpacity:function(b){if(b!=this.opacity){this.opacity=b;for(var c=0,a=this.markers.length;c<a;c++){this.markers[c].setOpacity(this.opacity)}}},moveTo:function(d,b,e){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);if(b||!this.drawn){for(var c=0,a=this.markers.length;c<a;c++){this.drawMarker(this.markers[c])}this.drawn=true}},addMarker:function(a){this.markers.push(a);if(this.opacity!=null){a.setOpacity(this.opacity)}if(this.map&&this.map.getExtent()){a.map=this.map;this.drawMarker(a)}},removeMarker:function(a){if(this.markers&&this.markers.length){OpenLayers.Util.removeItem(this.markers,a);a.erase()}},clearMarkers:function(){if(this.markers!=null){while(this.markers.length>0){this.removeMarker(this.markers[0])}}},drawMarker:function(a){var b=this.map.getLayerPxFromLonLat(a.lonlat);if(b==null){a.display(false)}else{if(!a.isDrawn()){var c=a.draw(b);this.div.appendChild(c)}else{if(a.icon){a.icon.moveTo(b)}}}},getDataExtent:function(){var b=null;if(this.markers&&(this.markers.length>0)){var b=new OpenLayers.Bounds();for(var d=0,a=this.markers.length;d<a;d++){var c=this.markers[d];b.extend(c.lonlat)}}return b},CLASS_NAME:"OpenLayers.Layer.Markers"});OpenLayers.Layer.SphericalMercator={getExtent:function(){var a=null;if(this.sphericalMercator){a=this.map.calculateBounds()}else{a=OpenLayers.Layer.FixedZoomLevels.prototype.getExtent.apply(this)}return a},getLonLatFromViewPortPx:function(a){return OpenLayers.Layer.prototype.getLonLatFromViewPortPx.apply(this,arguments)},getViewPortPxFromLonLat:function(a){return OpenLayers.Layer.prototype.getViewPortPxFromLonLat.apply(this,arguments)},initMercatorParameters:function(){this.RESOLUTIONS=[];var a=156543.0339;for(var b=0;b<=this.MAX_ZOOM_LEVEL;++b){this.RESOLUTIONS[b]=a/Math.pow(2,b)}this.units="m";this.projection=this.projection||"EPSG:900913"},forwardMercator:function(c,b){var a=c*20037508.34/180;var d=Math.log(Math.tan((90+b)*Math.PI/360))/(Math.PI/180);d=d*20037508.34/180;return new OpenLayers.LonLat(a,d)},inverseMercator:function(a,d){var c=(a/20037508.34)*180;var b=(d/20037508.34)*180;b=180/Math.PI*(2*Math.atan(Math.exp(b*Math.PI/180))-Math.PI/2);return new OpenLayers.LonLat(c,b)},projectForward:function(a){var b=OpenLayers.Layer.SphericalMercator.forwardMercator(a.x,a.y);a.x=b.lon;a.y=b.lat;return a},projectInverse:function(a){var b=OpenLayers.Layer.SphericalMercator.inverseMercator(a.x,a.y);a.x=b.lon;a.y=b.lat;return a}};OpenLayers.Projection.addTransform("EPSG:4326","EPSG:900913",OpenLayers.Layer.SphericalMercator.projectForward);OpenLayers.Projection.addTransform("EPSG:900913","EPSG:4326",OpenLayers.Layer.SphericalMercator.projectInverse);OpenLayers.Tile.WFS=OpenLayers.Class(OpenLayers.Tile,{features:null,url:null,request:null,initialize:function(d,a,e,b,c){OpenLayers.Tile.prototype.initialize.apply(this,arguments);this.url=b;this.features=[]},destroy:function(){OpenLayers.Tile.prototype.destroy.apply(this,arguments);this.destroyAllFeatures();this.features=null;this.url=null;if(this.request){this.request.abort();this.request=null}},clear:function(){this.destroyAllFeatures()},draw:function(){if(OpenLayers.Tile.prototype.draw.apply(this,arguments)){if(this.isLoading){this.events.triggerEvent("reload")}else{this.isLoading=true;this.events.triggerEvent("loadstart")}this.loadFeaturesForRegion(this.requestSuccess)}},loadFeaturesForRegion:function(b,a){if(this.request){this.request.abort()}this.request=OpenLayers.Request.GET({url:this.url,success:b,failure:a,scope:this})},requestSuccess:function(b){if(this.features){var d=b.responseXML;if(!d||!d.documentElement){d=b.responseText
}if(this.layer.vectorMode){this.layer.addFeatures(this.layer.formatObject.read(d))}else{var a=new OpenLayers.Format.XML();if(typeof d=="string"){d=a.read(d)}var c=a.getElementsByTagNameNS(d,"http://www.opengis.net/gml","featureMember");this.addResults(c)}}if(this.events){this.events.triggerEvent("loadend")}this.request=null},addResults:function(c){for(var b=0;b<c.length;b++){var a=new this.layer.featureClass(this.layer,c[b]);this.features.push(a)}},destroyAllFeatures:function(){while(this.features.length>0){var a=this.features.shift();a.destroy()}},CLASS_NAME:"OpenLayers.Tile.WFS"});OpenLayers.Control.DrawFeature=OpenLayers.Class(OpenLayers.Control,{layer:null,callbacks:null,EVENT_TYPES:["featureadded"],multi:false,featureAdded:function(){},handlerOptions:null,initialize:function(b,c,a){this.EVENT_TYPES=OpenLayers.Control.DrawFeature.prototype.EVENT_TYPES.concat(OpenLayers.Control.prototype.EVENT_TYPES);OpenLayers.Control.prototype.initialize.apply(this,[a]);this.callbacks=OpenLayers.Util.extend({done:this.drawFeature,modify:function(f,e){this.layer.events.triggerEvent("sketchmodified",{vertex:f,feature:e})},create:function(f,e){this.layer.events.triggerEvent("sketchstarted",{vertex:f,feature:e})}},this.callbacks);this.layer=b;this.handlerOptions=this.handlerOptions||{};if(!("multi" in this.handlerOptions)){this.handlerOptions.multi=this.multi}var d=this.layer.styleMap&&this.layer.styleMap.styles.temporary;if(d){this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{styleMap:new OpenLayers.StyleMap({"default":d})})}this.handler=new c(this,this.callbacks,this.handlerOptions)},drawFeature:function(c){var a=new OpenLayers.Feature.Vector(c);var b=this.layer.events.triggerEvent("sketchcomplete",{feature:a});if(b!==false){a.state=OpenLayers.State.INSERT;this.layer.addFeatures([a]);this.featureAdded(a);this.events.triggerEvent("featureadded",{feature:a})}},CLASS_NAME:"OpenLayers.Control.DrawFeature"});OpenLayers.Control.Measure=OpenLayers.Class(OpenLayers.Control,{EVENT_TYPES:["measure","measurepartial"],handlerOptions:null,callbacks:null,displaySystem:"metric",geodesic:false,displaySystemUnits:{geographic:["dd"],english:["mi","ft","in"],metric:["km","m"]},partialDelay:300,delayedTrigger:null,persist:false,initialize:function(b,a){this.EVENT_TYPES=OpenLayers.Control.Measure.prototype.EVENT_TYPES.concat(OpenLayers.Control.prototype.EVENT_TYPES);OpenLayers.Control.prototype.initialize.apply(this,[a]);this.callbacks=OpenLayers.Util.extend({done:this.measureComplete,point:this.measurePartial},this.callbacks);this.handlerOptions=OpenLayers.Util.extend({persist:this.persist},this.handlerOptions);this.handler=new b(this,this.callbacks,this.handlerOptions)},cancel:function(){this.handler.cancel()},updateHandler:function(b,a){var c=this.active;if(c){this.deactivate()}this.handler=new b(this,this.callbacks,a);if(c){this.activate()}},measureComplete:function(a){if(this.delayedTrigger){window.clearTimeout(this.delayedTrigger)}this.measure(a,"measure")},measurePartial:function(a,b){if(b.getLength()>0){b=b.clone();this.delayedTrigger=window.setTimeout(OpenLayers.Function.bind(function(){this.measure(b,"measurepartial")},this),this.partialDelay)}},measure:function(d,b){var c,a;if(d.CLASS_NAME.indexOf("LineString")>-1){c=this.getBestLength(d);a=1}else{c=this.getBestArea(d);a=2}this.events.triggerEvent(b,{measure:c[0],units:c[1],order:a,geometry:d})},getBestArea:function(f){var b=this.displaySystemUnits[this.displaySystem];var e,d;for(var c=0,a=b.length;c<a;++c){e=b[c];d=this.getArea(f,e);if(d>1){break}}return[d,e]},getArea:function(f,a){var b,c;if(this.geodesic){b=f.getGeodesicArea(this.map.getProjectionObject());c="m"}else{b=f.getArea();c=this.map.getUnits()}var e=OpenLayers.INCHES_PER_UNIT[a];if(e){var d=OpenLayers.INCHES_PER_UNIT[c];b*=Math.pow((d/e),2)}return b},getBestLength:function(f){var b=this.displaySystemUnits[this.displaySystem];var e,d;for(var c=0,a=b.length;c<a;++c){e=b[c];d=this.getLength(f,e);
if(d>1){break}}return[d,e]},getLength:function(f,a){var b,c;if(this.geodesic){b=f.getGeodesicLength(this.map.getProjectionObject());c="m"}else{b=f.getLength();c=this.map.getUnits()}var e=OpenLayers.INCHES_PER_UNIT[a];if(e){var d=OpenLayers.INCHES_PER_UNIT[c];b*=(d/e)}return b},CLASS_NAME:"OpenLayers.Control.Measure"});OpenLayers.Control.ZoomBox=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,out:false,alwaysZoom:false,draw:function(){this.handler=new OpenLayers.Handler.Box(this,{done:this.zoomBox},{keyMask:this.keyMask})},zoomBox:function(h){if(h instanceof OpenLayers.Bounds){var b;if(!this.out){var i=this.map.getLonLatFromPixel(new OpenLayers.Pixel(h.left,h.bottom));var m=this.map.getLonLatFromPixel(new OpenLayers.Pixel(h.right,h.top));b=new OpenLayers.Bounds(i.lon,i.lat,m.lon,m.lat)}else{var g=Math.abs(h.right-h.left);var j=Math.abs(h.top-h.bottom);var e=Math.min((this.map.size.h/j),(this.map.size.w/g));var n=this.map.getExtent();var a=this.map.getLonLatFromPixel(h.getCenterPixel());var c=a.lon-(n.getWidth()/2)*e;var f=a.lon+(n.getWidth()/2)*e;var l=a.lat-(n.getHeight()/2)*e;var d=a.lat+(n.getHeight()/2)*e;b=new OpenLayers.Bounds(c,l,f,d)}var k=this.map.getZoom();this.map.zoomToExtent(b);if(k==this.map.getZoom()&&this.alwaysZoom==true){this.map.zoomTo(k+(this.out?-1:1))}}else{if(!this.out){this.map.setCenter(this.map.getLonLatFromPixel(h),this.map.getZoom()+1)}else{this.map.setCenter(this.map.getLonLatFromPixel(h),this.map.getZoom()-1)}}},CLASS_NAME:"OpenLayers.Control.ZoomBox"});OpenLayers.Format.WFSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1,{initialize:function(a){OpenLayers.Format.WFSCapabilities.v1.prototype.initialize.apply(this,[a])},read_cap_Service:function(b,c){var a={};this.runChildNodes(a,c);b.service=a},read_cap_Fees:function(a,c){var b=this.getChildValue(c);if(b&&b.toLowerCase()!="none"){a.fees=b}},read_cap_AccessConstraints:function(a,b){var c=this.getChildValue(b);if(c&&c.toLowerCase()!="none"){a.accessConstraints=c}},read_cap_OnlineResource:function(a,c){var b=this.getChildValue(c);if(b&&b.toLowerCase()!="none"){a.onlineResource=b}},read_cap_Keywords:function(a,c){var b=this.getChildValue(c);if(b&&b.toLowerCase()!="none"){a.keywords=b.split(", ")}},read_cap_Capability:function(a,c){var b={};this.runChildNodes(b,c);a.capability=b},read_cap_Request:function(c,b){var a={};this.runChildNodes(a,b);c.request=a},read_cap_GetFeature:function(b,a){var c={href:{},formats:[]};this.runChildNodes(c,a);b.getfeature=c},read_cap_ResultFormat:function(e,d){var c=d.childNodes;var b;for(var a=0;a<c.length;a++){b=c[a];if(b.nodeType==1){e.formats.push(b.nodeName)}}},read_cap_DCPType:function(b,a){this.runChildNodes(b,a)},read_cap_HTTP:function(b,a){this.runChildNodes(b.href,a)},read_cap_Get:function(b,a){b.get=a.getAttribute("onlineResource")},read_cap_Post:function(b,a){b.post=a.getAttribute("onlineResource")},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1_0_0"});OpenLayers.Format.WFSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1,{initialize:function(a){OpenLayers.Format.WFSCapabilities.v1.prototype.initialize.apply(this,[a])},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1_1_0"});OpenLayers.Format.WKT=OpenLayers.Class(OpenLayers.Format,{initialize:function(a){this.regExes={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/};OpenLayers.Format.prototype.initialize.apply(this,[a])},read:function(f){var e,d,h;var g=this.regExes.typeStr.exec(f);if(g){d=g[1].toLowerCase();h=g[2];if(this.parse[d]){e=this.parse[d].apply(this,[h])}if(this.internalProjection&&this.externalProjection){if(e&&e.CLASS_NAME=="OpenLayers.Feature.Vector"){e.geometry.transform(this.externalProjection,this.internalProjection)}else{if(e&&d!="geometrycollection"&&typeof e=="object"){for(var c=0,a=e.length;c<a;c++){var b=e[c];b.geometry.transform(this.externalProjection,this.internalProjection)
}}}}}return e},write:function(a){var f,j,h,d,b;if(a.constructor==Array){f=a;b=true}else{f=[a];b=false}var c=[];if(b){c.push("GEOMETRYCOLLECTION(")}for(var e=0,g=f.length;e<g;++e){if(b&&e>0){c.push(",")}j=f[e].geometry;h=j.CLASS_NAME.split(".")[2].toLowerCase();if(!this.extract[h]){return null}if(this.internalProjection&&this.externalProjection){j=j.clone();j.transform(this.internalProjection,this.externalProjection)}d=this.extract[h].apply(this,[j]);c.push(h.toUpperCase()+"("+d+")")}if(b){c.push(")")}return c.join("")},extract:{point:function(a){return a.x+" "+a.y},multipoint:function(c){var d=[];for(var b=0,a=c.components.length;b<a;++b){d.push("("+this.extract.point.apply(this,[c.components[b]])+")")}return d.join(",")},linestring:function(b){var d=[];for(var c=0,a=b.components.length;c<a;++c){d.push(this.extract.point.apply(this,[b.components[c]]))}return d.join(",")},multilinestring:function(c){var d=[];for(var b=0,a=c.components.length;b<a;++b){d.push("("+this.extract.linestring.apply(this,[c.components[b]])+")")}return d.join(",")},polygon:function(c){var d=[];for(var b=0,a=c.components.length;b<a;++b){d.push("("+this.extract.linestring.apply(this,[c.components[b]])+")")}return d.join(",")},multipolygon:function(d){var c=[];for(var b=0,a=d.components.length;b<a;++b){c.push("("+this.extract.polygon.apply(this,[d.components[b]])+")")}return c.join(",")}},parse:{point:function(b){var a=OpenLayers.String.trim(b).split(this.regExes.spaces);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(a[0],a[1]))},multipoint:function(f){var b;var d=OpenLayers.String.trim(f).split(this.regExes.parenComma);var e=[];for(var c=0,a=d.length;c<a;++c){b=d[c].replace(this.regExes.trimParens,"$1");e.push(this.parse.point.apply(this,[b]).geometry)}return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPoint(e))},linestring:function(e){var c=OpenLayers.String.trim(e).split(",");var d=[];for(var b=0,a=c.length;b<a;++b){d.push(this.parse.point.apply(this,[c[b]]).geometry)}return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(d))},multilinestring:function(f){var c;var b=OpenLayers.String.trim(f).split(this.regExes.parenComma);var e=[];for(var d=0,a=b.length;d<a;++d){c=b[d].replace(this.regExes.trimParens,"$1");e.push(this.parse.linestring.apply(this,[c]).geometry)}return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiLineString(e))},polygon:function(h){var c,b,f;var g=OpenLayers.String.trim(h).split(this.regExes.parenComma);var e=[];for(var d=0,a=g.length;d<a;++d){c=g[d].replace(this.regExes.trimParens,"$1");b=this.parse.linestring.apply(this,[c]).geometry;f=new OpenLayers.Geometry.LinearRing(b.components);e.push(f)}return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon(e))},multipolygon:function(f){var d;var b=OpenLayers.String.trim(f).split(this.regExes.doubleParenComma);var e=[];for(var c=0,a=b.length;c<a;++c){d=b[c].replace(this.regExes.trimParens,"$1");e.push(this.parse.polygon.apply(this,[d]).geometry)}return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPolygon(e))},geometrycollection:function(e){e=e.replace(/,\s*([A-Za-z])/g,"|$1");var d=OpenLayers.String.trim(e).split("|");var c=[];for(var b=0,a=d.length;b<a;++b){c.push(OpenLayers.Format.WKT.prototype.read.apply(this,[d[b]]))}return c}},CLASS_NAME:"OpenLayers.Format.WKT"});OpenLayers.Format.WMC.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ol:"http://openlayers.org/context",wmc:"http://www.opengis.net/context",sld:"http://www.opengis.net/sld",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"",getNamespacePrefix:function(a){var b=null;if(a==null){b=this.namespaces[this.defaultPrefix]}else{for(b in this.namespaces){if(this.namespaces[b]==a){break}}}return b},defaultPrefix:"wmc",rootPrefix:null,defaultStyleName:"",defaultStyleTitle:"Default",initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(c){if(typeof c=="string"){c=OpenLayers.Format.XML.prototype.read.apply(this,[c])
}var a=c.documentElement;this.rootPrefix=a.prefix;var b={version:a.getAttribute("version")};this.runChildNodes(b,a);return b},runChildNodes:function(e,d){var b=d.childNodes;var a,c,g,j;for(var f=0,h=b.length;f<h;++f){a=b[f];if(a.nodeType==1){g=this.getNamespacePrefix(a.namespaceURI);j=a.nodeName.split(":").pop();c=this["read_"+g+"_"+j];if(c){c.apply(this,[e,a])}}}},read_wmc_General:function(a,b){this.runChildNodes(a,b)},read_wmc_BoundingBox:function(a,b){a.projection=b.getAttribute("SRS");a.bounds=new OpenLayers.Bounds(parseFloat(b.getAttribute("minx")),parseFloat(b.getAttribute("miny")),parseFloat(b.getAttribute("maxx")),parseFloat(b.getAttribute("maxy")))},read_wmc_LayerList:function(a,b){a.layersContext=[];this.runChildNodes(a,b)},read_wmc_Layer:function(a,b){var c={visibility:(b.getAttribute("hidden")!="1"),queryable:(b.getAttribute("queryable")=="1"),formats:[],styles:[]};this.runChildNodes(c,b);a.layersContext.push(c)},read_wmc_Extension:function(b,a){this.runChildNodes(b,a)},read_ol_units:function(b,a){b.units=this.getChildValue(a)},read_ol_maxExtent:function(c,b){var a=new OpenLayers.Bounds(b.getAttribute("minx"),b.getAttribute("miny"),b.getAttribute("maxx"),b.getAttribute("maxy"));c.maxExtent=a},read_ol_transparent:function(b,a){b.transparent=this.getChildValue(a)},read_ol_numZoomLevels:function(b,a){b.numZoomLevels=parseInt(this.getChildValue(a))},read_ol_opacity:function(b,a){b.opacity=parseFloat(this.getChildValue(a))},read_ol_singleTile:function(b,a){b.singleTile=(this.getChildValue(a)=="true")},read_ol_tileSize:function(b,a){var c={width:a.getAttribute("width"),height:a.getAttribute("height")};b.tileSize=c},read_ol_isBaseLayer:function(b,a){b.isBaseLayer=(this.getChildValue(a)=="true")},read_ol_displayInLayerSwitcher:function(b,a){b.displayInLayerSwitcher=(this.getChildValue(a)=="true")},read_wmc_Server:function(c,b){c.version=b.getAttribute("version");var d={};var a=b.getElementsByTagName("OnlineResource");if(a.length>0){this.read_wmc_OnlineResource(d,a[0])}c.url=d.href},read_wmc_FormatList:function(b,a){this.runChildNodes(b,a)},read_wmc_Format:function(b,a){var c={value:this.getChildValue(a)};if(a.getAttribute("current")=="1"){c.current=true}b.formats.push(c)},read_wmc_StyleList:function(b,a){this.runChildNodes(b,a)},read_wmc_Style:function(c,b){var a={};this.runChildNodes(a,b);if(b.getAttribute("current")=="1"){a.current=true}c.styles.push(a)},read_wmc_SLD:function(a,b){this.runChildNodes(a,b)},read_sld_StyledLayerDescriptor:function(c,b){var a=OpenLayers.Format.XML.prototype.write.apply(this,[b]);c.body=a},read_wmc_OnlineResource:function(b,a){b.href=this.getAttributeNS(a,this.namespaces.xlink,"href")},read_wmc_Name:function(c,b){var a=this.getChildValue(b);if(a){c.name=a}},read_wmc_Title:function(b,a){var c=this.getChildValue(a);if(c){b.title=c}},read_wmc_MetadataURL:function(c,b){var d={};var a=b.getElementsByTagName("OnlineResource");if(a.length>0){this.read_wmc_OnlineResource(d,a[0])}c.metadataURL=d.href},read_wmc_Abstract:function(c,b){var a=this.getChildValue(b);if(a){c["abstract"]=a}},read_wmc_LegendURL:function(c,d){var b={width:d.getAttribute("width"),height:d.getAttribute("height")};var a=d.getElementsByTagName("OnlineResource");if(a.length>0){this.read_wmc_OnlineResource(b,a[0])}c.legend=b},write:function(c,b){var a=this.createElementDefaultNS("ViewContext");this.setAttributes(a,{version:this.VERSION,id:(b&&typeof b.id=="string")?b.id:OpenLayers.Util.createUniqueID("OpenLayers_Context_")});this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);a.appendChild(this.write_wmc_General(c));a.appendChild(this.write_wmc_LayerList(c));return OpenLayers.Format.XML.prototype.write.apply(this,[a])},createElementDefaultNS:function(c,b,a){var d=this.createElementNS(this.namespaces[this.defaultPrefix],c);if(b){d.appendChild(this.createTextNode(b))}if(a){this.setAttributes(d,a)}return d},setAttributes:function(b,d){var c;for(var a in d){c=d[a].toString();if(c.match(/[A-Z]/)){this.setAttributeNS(b,null,a,c)
}else{b.setAttribute(a,c)}}},write_wmc_General:function(a){var c=this.createElementDefaultNS("General");if(a.size){c.appendChild(this.createElementDefaultNS("Window",null,{width:a.size.w,height:a.size.h}))}var b=a.bounds;c.appendChild(this.createElementDefaultNS("BoundingBox",null,{minx:b.left.toPrecision(18),miny:b.bottom.toPrecision(18),maxx:b.right.toPrecision(18),maxy:b.top.toPrecision(18),SRS:a.projection}));c.appendChild(this.createElementDefaultNS("Title",a.title));c.appendChild(this.write_ol_MapExtension(a));return c},write_ol_MapExtension:function(b){var d=this.createElementDefaultNS("Extension");var c=b.maxExtent;if(c){var a=this.createElementNS(this.namespaces.ol,"ol:maxExtent");this.setAttributes(a,{minx:c.left.toPrecision(18),miny:c.bottom.toPrecision(18),maxx:c.right.toPrecision(18),maxy:c.top.toPrecision(18)});d.appendChild(a)}return d},write_wmc_LayerList:function(c){var d=this.createElementDefaultNS("LayerList");for(var b=0,a=c.layersContext.length;b<a;++b){d.appendChild(this.write_wmc_Layer(c.layersContext[b]))}return d},write_wmc_Layer:function(a){var b=this.createElementDefaultNS("Layer",null,{queryable:a.queryable?"1":"0",hidden:a.visibility?"0":"1"});b.appendChild(this.write_wmc_Server(a));b.appendChild(this.createElementDefaultNS("Name",a.name));b.appendChild(this.createElementDefaultNS("Title",a.title));if(a.metadataURL){b.appendChild(this.write_wmc_MetadataURL(a.metadataURL))}return b},write_wmc_LayerExtension:function(b){var d=this.createElementDefaultNS("Extension");var a=b.maxExtent;var h=this.createElementNS(this.namespaces.ol,"ol:maxExtent");this.setAttributes(h,{minx:a.left.toPrecision(18),miny:a.bottom.toPrecision(18),maxx:a.right.toPrecision(18),maxy:a.top.toPrecision(18)});d.appendChild(h);if(b.tileSize&&!b.singleTile){var j=this.createElementNS(this.namespaces.ol,"ol:tileSize");this.setAttributes(j,b.tileSize);d.appendChild(j)}var g=["transparent","numZoomLevels","units","isBaseLayer","opacity","displayInLayerSwitcher","singleTile"];var c;for(var e=0,f=g.length;e<f;++e){c=this.createOLPropertyNode(b,g[e]);if(c){d.appendChild(c)}}return d},createOLPropertyNode:function(b,c){var a=null;if(b[c]!=null){a=this.createElementNS(this.namespaces.ol,"ol:"+c);a.appendChild(this.createTextNode(b[c].toString()))}return a},write_wmc_Server:function(a){var b=this.createElementDefaultNS("Server");this.setAttributes(b,{service:"OGC:WMS",version:a.version});b.appendChild(this.write_wmc_OnlineResource(a.url));return b},write_wmc_MetadataURL:function(b){var a=this.createElementDefaultNS("MetadataURL");a.appendChild(this.write_wmc_OnlineResource(b));return a},write_wmc_FormatList:function(c){var d=this.createElementDefaultNS("FormatList");for(var b=0,a=c.formats.length;b<a;b++){var e=c.formats[b];d.appendChild(this.createElementDefaultNS("Format",e.value,(e.current&&e.current==true)?{current:"1"}:null))}return d},write_wmc_StyleList:function(e){var c=this.createElementDefaultNS("StyleList");var k=e.styles;if(k&&k instanceof Array){var a;for(var d=0,f=k.length;d<f;d++){var l=k[d];var b=this.createElementDefaultNS("Style",null,(l.current&&l.current==true)?{current:"1"}:null);if(l.href){a=this.createElementDefaultNS("SLD");var g=this.write_wmc_OnlineResource(l.href);a.appendChild(g);a.appendChild(this.createElementDefaultNS("Name",l.name));if(l.title){a.appendChild(this.createElementDefaultNS("Title",l.title))}b.appendChild(a)}else{if(l.body){a=this.createElementDefaultNS("SLD");var h=OpenLayers.Format.XML.prototype.read.apply(this,[l.body]);var j=h.documentElement;if(a.ownerDocument&&a.ownerDocument.importNode){j=a.ownerDocument.importNode(j,true)}a.appendChild(j);a.appendChild(this.createElementDefaultNS("Name",l.name));if(l.title){a.appendChild(this.createElementDefaultNS("Title",l.title))}b.appendChild(a)}else{b.appendChild(this.createElementDefaultNS("Name",l.name));b.appendChild(this.createElementDefaultNS("Title",l.title));if(l["abstract"]){b.appendChild(this.createElementDefaultNS("Abstract",l["abstract"]))}}}c.appendChild(b)
}}return c},write_wmc_OnlineResource:function(a){var b=this.createElementDefaultNS("OnlineResource");this.setAttributeNS(b,this.namespaces.xlink,"xlink:type","simple");this.setAttributeNS(b,this.namespaces.xlink,"xlink:href",a);return b},CLASS_NAME:"OpenLayers.Format.WMC.v1"});OpenLayers.Format.WMSCapabilities.v1_1=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1,{readers:{wms:OpenLayers.Util.applyDefaults({WMT_MS_Capabilities:function(a,b){this.readChildNodes(a,b)},Keyword:function(a,b){if(b.keywords){b.keywords.push(this.getChildValue(a))}},DescribeLayer:function(a,b){b.describelayer={formats:[]};this.readChildNodes(a,b.describelayer)},GetLegendGraphic:function(a,b){b.getlegendgraphic={formats:[]};this.readChildNodes(a,b.getlegendgraphic)},GetStyles:function(a,b){b.getstyles={formats:[]};this.readChildNodes(a,b.getstyles)},PutStyles:function(a,b){b.putstyles={formats:[]};this.readChildNodes(a,b.putstyles)},UserDefinedSymbolization:function(a,b){var c={supportSLD:parseInt(a.getAttribute("SupportSLD"))==1,userLayer:parseInt(a.getAttribute("UserLayer"))==1,userStyle:parseInt(a.getAttribute("UserStyle"))==1,remoteWFS:parseInt(a.getAttribute("RemoteWFS"))==1};b.userSymbols=c},LatLonBoundingBox:function(a,b){b.llbbox=[parseFloat(a.getAttribute("minx")),parseFloat(a.getAttribute("miny")),parseFloat(a.getAttribute("maxx")),parseFloat(a.getAttribute("maxy"))]},BoundingBox:function(a,b){var c=OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms.BoundingBox.apply(this,[a,b]);c.srs=a.getAttribute("SRS");b.bbox[c.srs]=c},ScaleHint:function(e,f){var d=e.getAttribute("min");var a=e.getAttribute("max");var c=Math.pow(2,0.5);var b=OpenLayers.INCHES_PER_UNIT.m;f.maxScale=parseFloat(((d/c)*b*OpenLayers.DOTS_PER_INCH).toPrecision(13));f.minScale=parseFloat(((a/c)*b*OpenLayers.DOTS_PER_INCH).toPrecision(13))},Dimension:function(b,d){var a=b.getAttribute("name").toLowerCase();var c={name:a,units:b.getAttribute("units"),unitsymbol:b.getAttribute("unitSymbol")};d.dimensions[c.name]=c},Extent:function(d,e){var b=d.getAttribute("name").toLowerCase();if(b in e.dimensions){var c=e.dimensions[b];c.nearestVal=d.getAttribute("nearestValue")==="1";c.multipleVal=d.getAttribute("multipleValues")==="1";c.current=d.getAttribute("current")==="1";c["default"]=d.getAttribute("default")||"";var a=this.getChildValue(d);c.values=a.split(",")}}},OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1"});OpenLayers.Format.WMSCapabilities.v1_3=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1,{readers:{wms:OpenLayers.Util.applyDefaults({WMS_Capabilities:function(a,b){this.readChildNodes(a,b)},LayerLimit:function(a,b){b.layerLimit=parseInt(this.getChildValue(a))},MaxWidth:function(a,b){b.maxWidth=parseInt(this.getChildValue(a))},MaxHeight:function(a,b){b.maxHeight=parseInt(this.getChildValue(a))},BoundingBox:function(a,b){var c=OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms.BoundingBox.apply(this,[a,b]);c.srs=a.getAttribute("CRS");b.bbox[c.srs]=c},CRS:function(a,b){this.readers.wms.SRS.apply(this,[a,b])},EX_GeographicBoundingBox:function(a,b){b.llbbox=[];this.readChildNodes(a,b.llbbox)},westBoundLongitude:function(a,b){b[0]=this.getChildValue(a)},eastBoundLongitude:function(a,b){b[2]=this.getChildValue(a)},southBoundLatitude:function(a,b){b[1]=this.getChildValue(a)},northBoundLatitude:function(a,b){b[3]=this.getChildValue(a)},MinScaleDenominator:function(a,b){b.maxScale=parseFloat(this.getChildValue(a)).toPrecision(16)},MaxScaleDenominator:function(a,b){b.minScale=parseFloat(this.getChildValue(a)).toPrecision(16)},Dimension:function(b,d){var a=b.getAttribute("name").toLowerCase();var c={name:a,units:b.getAttribute("units"),unitsymbol:b.getAttribute("unitSymbol"),nearestVal:b.getAttribute("nearestValue")==="1",multipleVal:b.getAttribute("multipleValues")==="1","default":b.getAttribute("default")||"",current:b.getAttribute("current")==="1",values:this.getChildValue(b).split(",")};d.dimensions[c.name]=c
},Keyword:function(b,c){var a={value:this.getChildValue(b),vocabulary:b.getAttribute("vocabulary")};if(c.keywords){c.keywords.push(a)}}},OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms),sld:{UserDefinedSymbolization:function(a,b){this.readers.wms.UserDefinedSymbolization.apply(this,[a,b]);b.userSymbols.inlineFeature=parseInt(a.getAttribute("InlineFeature"))==1;b.userSymbols.remoteWCS=parseInt(a.getAttribute("RemoteWCS"))==1},DescribeLayer:function(a,b){this.readers.wms.DescribeLayer.apply(this,[a,b])},GetLegendGraphic:function(a,b){this.readers.wms.GetLegendGraphic.apply(this,[a,b])}}},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_3"});OpenLayers.Format.WMTSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1_1_0,{version:"1.0.0",namespaces:{ows:"http://www.opengis.net/ows/1.1",wmts:"http://www.opengis.net/wmts/1.0",xlink:"http://www.w3.org/1999/xlink"},yx:null,defaultPrefix:"wmts",initialize:function(b){OpenLayers.Format.XML.prototype.initialize.apply(this,[b]);this.options=b;var a=OpenLayers.Util.extend({},OpenLayers.Format.WMTSCapabilities.prototype.yx);this.yx=OpenLayers.Util.extend(a,this.yx)},read:function(b){if(typeof b=="string"){b=OpenLayers.Format.XML.prototype.read.apply(this,[b])}if(b&&b.nodeType==9){b=b.documentElement}var a={};this.readNode(b,a);a.version=this.version;return a},readers:{wmts:{Capabilities:function(a,b){this.readChildNodes(a,b)},Contents:function(a,b){b.contents={};b.contents.layers=[];b.contents.tileMatrixSets={};this.readChildNodes(a,b.contents)},Layer:function(b,c){var a={styles:[],formats:[],tileMatrixSetLinks:[]};a.layers=[];this.readChildNodes(b,a);c.layers.push(a)},Style:function(b,c){var a={};a.isDefault=(b.getAttribute("isDefault")==="true");this.readChildNodes(b,a);c.styles.push(a)},Format:function(a,b){b.formats.push(this.getChildValue(a))},TileMatrixSetLink:function(b,c){var a={};this.readChildNodes(b,a);c.tileMatrixSetLinks.push(a)},TileMatrixSet:function(b,c){if(c.layers){var a={matrixIds:[]};this.readChildNodes(b,a);c.tileMatrixSets[a.identifier]=a}else{c.tileMatrixSet=this.getChildValue(b)}},TileMatrix:function(b,c){var a={supportedCRS:c.supportedCRS};this.readChildNodes(b,a);c.matrixIds.push(a)},ScaleDenominator:function(a,b){b.scaleDenominator=parseFloat(this.getChildValue(a))},TopLeftCorner:function(d,f){var c=this.getChildValue(d);var e=c.split(" ");var a;if(f.supportedCRS){var b=f.supportedCRS.replace(/urn:ogc:def:crs:(\w+):.+:(\w+)$/,"urn:ogc:def:crs:$1::$2");a=!!this.yx[b]}if(a){f.topLeftCorner=new OpenLayers.LonLat(e[1],e[0])}else{f.topLeftCorner=new OpenLayers.LonLat(e[0],e[1])}},TileWidth:function(a,b){b.tileWidth=parseInt(this.getChildValue(a))},TileHeight:function(a,b){b.tileHeight=parseInt(this.getChildValue(a))},MatrixWidth:function(a,b){b.matrixWidth=parseInt(this.getChildValue(a))},MatrixHeight:function(a,b){b.matrixHeight=parseInt(this.getChildValue(a))},WSDL:function(a,b){b.wsdl={};b.wsdl.href=a.getAttribute("xlink:href")},ServiceMetadataURL:function(a,b){b.serviceMetadataUrl={};b.serviceMetadataUrl.href=a.getAttribute("xlink:href")}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WMTSCapabilities.v1_0_0"});OpenLayers.Layer.Boxes=OpenLayers.Class(OpenLayers.Layer.Markers,{initialize:function(b,a){OpenLayers.Layer.Markers.prototype.initialize.apply(this,arguments)},drawMarker:function(a){var d=a.bounds;var f=this.map.getLayerPxFromLonLat(new OpenLayers.LonLat(d.left,d.top));var c=this.map.getLayerPxFromLonLat(new OpenLayers.LonLat(d.right,d.bottom));if(c==null||f==null){a.display(false)}else{var e=new OpenLayers.Size(Math.max(1,c.x-f.x),Math.max(1,c.y-f.y));var b=a.draw(f,e);if(!a.drawn){this.div.appendChild(b);a.drawn=true}}},removeMarker:function(a){OpenLayers.Util.removeItem(this.markers,a);if((a.div!=null)&&(a.div.parentNode==this.div)){this.div.removeChild(a.div)}},CLASS_NAME:"OpenLayers.Layer.Boxes"});OpenLayers.Layer.GeoRSS=OpenLayers.Class(OpenLayers.Layer.Markers,{location:null,features:null,formatOptions:null,selectedFeature:null,icon:null,popupSize:null,useFeedTitle:true,initialize:function(c,a,b){OpenLayers.Layer.Markers.prototype.initialize.apply(this,[c,b]);
this.location=a;this.features=[]},destroy:function(){OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments);this.clearFeatures();this.features=null},loadRSS:function(){if(!this.loaded){this.events.triggerEvent("loadstart");OpenLayers.Request.GET({url:this.location,success:this.parseData,scope:this});this.loaded=true}},moveTo:function(c,a,b){OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments);if(this.visibility&&!this.loaded){this.loadRSS()}},parseData:function(k){var o=k.responseXML;if(!o||!o.documentElement){o=OpenLayers.Format.XML.prototype.read(k.responseText)}if(this.useFeedTitle){var a=null;try{a=o.getElementsByTagNameNS("*","title")[0].firstChild.nodeValue}catch(j){a=o.getElementsByTagName("title")[0].firstChild.nodeValue}if(a){this.setName(a)}}var s={};OpenLayers.Util.extend(s,this.formatOptions);if(this.map&&!this.projection.equals(this.map.getProjectionObject())){s.externalProjection=this.projection;s.internalProjection=this.map.getProjectionObject()}var p=new OpenLayers.Format.GeoRSS(s);var b=p.read(o);for(var g=0,h=b.length;g<h;g++){var f={};var r=b[g];if(!r.geometry){continue}var m=r.attributes.title?r.attributes.title:"Untitled";var q=r.attributes.description?r.attributes.description:"No description.";var l=r.attributes.link?r.attributes.link:"";var n=r.geometry.getBounds().getCenterLonLat();f.icon=this.icon==null?OpenLayers.Marker.defaultIcon():this.icon.clone();f.popupSize=this.popupSize?this.popupSize.clone():new OpenLayers.Size(250,120);if(m||q){f.title=m;f.description=q;var c='<div class="olLayerGeoRSSClose">[x]</div>';c+='<div class="olLayerGeoRSSTitle">';if(l){c+='<a class="link" href="'+l+'" target="_blank">'}c+=m;if(l){c+="</a>"}c+="</div>";c+='<div style="" class="olLayerGeoRSSDescription">';c+=q;c+="</div>";f.popupContentHTML=c}var r=new OpenLayers.Feature(this,n,f);this.features.push(r);var d=r.createMarker();d.events.register("click",r,this.markerClick);this.addMarker(d)}this.events.triggerEvent("loadend")},markerClick:function(c){var e=(this==this.layer.selectedFeature);this.layer.selectedFeature=(!e)?this:null;for(var d=0,a=this.layer.map.popups.length;d<a;d++){this.layer.map.removePopup(this.layer.map.popups[d])}if(!e){var b=this.createPopup();OpenLayers.Event.observe(b.div,"click",OpenLayers.Function.bind(function(){for(var g=0,f=this.layer.map.popups.length;g<f;g++){this.layer.map.removePopup(this.layer.map.popups[g])}},this));this.layer.map.addPopup(b)}OpenLayers.Event.stop(c)},clearFeatures:function(){if(this.features!=null){while(this.features.length>0){var a=this.features[0];OpenLayers.Util.removeItem(this.features,a);a.destroy()}}},CLASS_NAME:"OpenLayers.Layer.GeoRSS"});OpenLayers.Layer.Google=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:0,MAX_ZOOM_LEVEL:21,RESOLUTIONS:[1.40625,0.703125,0.3515625,0.17578125,0.087890625,0.0439453125,0.02197265625,0.010986328125,0.0054931640625,0.00274658203125,0.001373291015625,0.0006866455078125,0.00034332275390625,0.000171661376953125,0.0000858306884765625,0.00004291534423828125,0.00002145767211914062,0.00001072883605957031,0.00000536441802978515,0.00000268220901489257,0.000001341104507446289,6.705522537231445e-7],type:null,wrapDateLine:true,sphericalMercator:false,version:null,initialize:function(c,b){b=b||{};if(!b.version){b.version=typeof GMap2==="function"?"2":"3"}var a=OpenLayers.Layer.Google["v"+b.version.replace(/\./g,"_")];if(a){OpenLayers.Util.applyDefaults(b,a)}else{throw"Unsupported Google Maps API version: "+b.version}OpenLayers.Util.applyDefaults(b,a.DEFAULTS);if(b.maxExtent){b.maxExtent=b.maxExtent.clone()}OpenLayers.Layer.EventPane.prototype.initialize.apply(this,[c,b]);OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,[c,b]);if(this.sphericalMercator){OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator);this.initMercatorParameters()}},clone:function(){return new OpenLayers.Layer.Google(this.name,this.getOptions())},setVisibility:function(b){var a=this.opacity==null?1:this.opacity;
OpenLayers.Layer.EventPane.prototype.setVisibility.apply(this,arguments);this.setOpacity(a)},display:function(a){if(!this._dragging){this.setGMapVisibility(a)}OpenLayers.Layer.EventPane.prototype.display.apply(this,arguments)},moveTo:function(b,a,c){this._dragging=c;OpenLayers.Layer.EventPane.prototype.moveTo.apply(this,arguments);delete this._dragging},setOpacity:function(b){if(b!==this.opacity){if(this.map!=null){this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"})}this.opacity=b}if(this.getVisibility()){var a=this.getMapContainer();OpenLayers.Util.modifyDOMElement(a,null,null,null,null,null,null,b)}},destroy:function(){if(this.map){this.setGMapVisibility(false);var a=OpenLayers.Layer.Google.cache[this.map.id];if(a&&a.count<=1){this.removeGMapElements()}}OpenLayers.Layer.EventPane.prototype.destroy.apply(this,arguments)},removeGMapElements:function(){var d=OpenLayers.Layer.Google.cache[this.map.id];if(d){var b=this.mapObject&&this.getMapContainer();if(b&&b.parentNode){b.parentNode.removeChild(b)}var c=d.termsOfUse;if(c&&c.parentNode){c.parentNode.removeChild(c)}var a=d.poweredBy;if(a&&a.parentNode){a.parentNode.removeChild(a)}}},removeMap:function(b){if(this.visibility&&this.mapObject){this.setGMapVisibility(false)}var a=OpenLayers.Layer.Google.cache[b.id];if(a){if(a.count<=1){this.removeGMapElements();delete OpenLayers.Layer.Google.cache[b.id]}else{--a.count}}delete this.termsOfUse;delete this.poweredBy;delete this.mapObject;delete this.dragObject;OpenLayers.Layer.EventPane.prototype.removeMap.apply(this,arguments)},getOLBoundsFromMapObjectBounds:function(b){var c=null;if(b!=null){var a=b.getSouthWest();var d=b.getNorthEast();if(this.sphericalMercator){a=this.forwardMercator(a.lng(),a.lat());d=this.forwardMercator(d.lng(),d.lat())}else{a=new OpenLayers.LonLat(a.lng(),a.lat());d=new OpenLayers.LonLat(d.lng(),d.lat())}c=new OpenLayers.Bounds(a.lon,a.lat,d.lon,d.lat)}return c},getWarningHTML:function(){return OpenLayers.i18n("googleWarning")},getMapObjectCenter:function(){return this.mapObject.getCenter()},getMapObjectZoom:function(){return this.mapObject.getZoom()},getLongitudeFromMapObjectLonLat:function(a){return this.sphericalMercator?this.forwardMercator(a.lng(),a.lat()).lon:a.lng()},getLatitudeFromMapObjectLonLat:function(b){var a=this.sphericalMercator?this.forwardMercator(b.lng(),b.lat()).lat:b.lat();return a},getXFromMapObjectPixel:function(a){return a.x},getYFromMapObjectPixel:function(a){return a.y},CLASS_NAME:"OpenLayers.Layer.Google"});OpenLayers.Layer.Google.cache={};OpenLayers.Layer.Google.v2={termsOfUse:null,poweredBy:null,dragObject:null,loadMapObject:function(){if(!this.type){this.type=G_NORMAL_MAP}var g,d,a;var c=OpenLayers.Layer.Google.cache[this.map.id];if(c){g=c.mapObject;d=c.termsOfUse;a=c.poweredBy;++c.count}else{var b=this.map.viewPortDiv;var h=document.createElement("div");h.id=this.map.id+"_GMap2Container";h.style.position="absolute";h.style.width="100%";h.style.height="100%";b.appendChild(h);try{g=new GMap2(h);d=h.lastChild;b.appendChild(d);d.style.zIndex="1100";d.style.right="";d.style.bottom="";d.className="olLayerGoogleCopyright";a=h.lastChild;b.appendChild(a);a.style.zIndex="1100";a.style.right="";a.style.bottom="";a.className="olLayerGooglePoweredBy gmnoprint"}catch(f){throw (f)}OpenLayers.Layer.Google.cache[this.map.id]={mapObject:g,termsOfUse:d,poweredBy:a,count:1}}this.mapObject=g;this.termsOfUse=d;this.poweredBy=a;if(OpenLayers.Util.indexOf(this.mapObject.getMapTypes(),this.type)===-1){this.mapObject.addMapType(this.type)}if(typeof g.getDragObject=="function"){this.dragObject=g.getDragObject()}else{this.dragPanMapObject=null}if(this.isBaseLayer===false){this.setGMapVisibility(this.div.style.display!=="none")}},onMapResize:function(){if(this.visibility&&this.mapObject.isLoaded()){this.mapObject.checkResize()}else{if(!this._resized){var a=this;var b=GEvent.addListener(this.mapObject,"load",function(){GEvent.removeListener(b);delete a._resized;a.mapObject.checkResize();a.moveTo(a.map.getCenter(),a.map.getZoom())
})}this._resized=true}},setGMapVisibility:function(c){var b=OpenLayers.Layer.Google.cache[this.map.id];if(b){var a=this.mapObject.getContainer();if(c===true){this.mapObject.setMapType(this.type);a.style.display="";this.termsOfUse.style.left="";this.termsOfUse.style.display="";this.poweredBy.style.display="";b.displayed=this.id}else{if(b.displayed===this.id){delete b.displayed}if(!b.displayed){a.style.display="none";this.termsOfUse.style.display="none";this.termsOfUse.style.left="-9999px";this.poweredBy.style.display="none"}}}},getMapContainer:function(){return this.mapObject.getContainer()},getMapObjectBoundsFromOLBounds:function(c){var b=null;if(c!=null){var a=this.sphericalMercator?this.inverseMercator(c.bottom,c.left):new OpenLayers.LonLat(c.bottom,c.left);var d=this.sphericalMercator?this.inverseMercator(c.top,c.right):new OpenLayers.LonLat(c.top,c.right);b=new GLatLngBounds(new GLatLng(a.lat,a.lon),new GLatLng(d.lat,d.lon))}return b},setMapObjectCenter:function(a,b){this.mapObject.setCenter(a,b)},dragPanMapObject:function(b,a){this.dragObject.moveBy(new GSize(-b,a))},getMapObjectLonLatFromMapObjectPixel:function(a){return this.mapObject.fromContainerPixelToLatLng(a)},getMapObjectPixelFromMapObjectLonLat:function(a){return this.mapObject.fromLatLngToContainerPixel(a)},getMapObjectZoomFromMapObjectBounds:function(a){return this.mapObject.getBoundsZoomLevel(a)},getMapObjectLonLatFromLonLat:function(d,b){var c;if(this.sphericalMercator){var a=this.inverseMercator(d,b);c=new GLatLng(a.lat,a.lon)}else{c=new GLatLng(b,d)}return c},getMapObjectPixelFromXY:function(a,b){return new GPoint(a,b)}};OpenLayers.Layer.Grid=OpenLayers.Class(OpenLayers.Layer.HTTPRequest,{tileSize:null,grid:null,singleTile:false,ratio:1.5,buffer:2,numLoadingTiles:0,initialize:function(c,b,d,a){OpenLayers.Layer.HTTPRequest.prototype.initialize.apply(this,arguments);this.events.addEventType("tileloaded");this.grid=[]},destroy:function(){this.clearGrid();this.grid=null;this.tileSize=null;OpenLayers.Layer.HTTPRequest.prototype.destroy.apply(this,arguments)},clearGrid:function(){if(this.grid){for(var f=0,b=this.grid.length;f<b;f++){var e=this.grid[f];for(var c=0,a=e.length;c<a;c++){var d=e[c];this.removeTileMonitoringHooks(d);d.destroy()}}this.grid=[]}},clone:function(a){if(a==null){a=new OpenLayers.Layer.Grid(this.name,this.url,this.params,this.getOptions())}a=OpenLayers.Layer.HTTPRequest.prototype.clone.apply(this,[a]);if(this.tileSize!=null){a.tileSize=this.tileSize.clone()}a.grid=[];return a},moveTo:function(d,a,e){OpenLayers.Layer.HTTPRequest.prototype.moveTo.apply(this,arguments);d=d||this.map.getExtent();if(d!=null){var c=!this.grid.length||a;var b=this.getTilesBounds();if(this.singleTile){if(c||(!e&&!b.containsBounds(d))){this.initSingleTile(d)}}else{if(c||!b.containsBounds(d,true)){this.initGriddedTiles(d)}else{this.moveGriddedTiles(d)}}}},setTileSize:function(a){if(this.singleTile){a=this.map.getSize();a.h=parseInt(a.h*this.ratio);a.w=parseInt(a.w*this.ratio)}OpenLayers.Layer.HTTPRequest.prototype.setTileSize.apply(this,[a])},getGridBounds:function(){var a="The getGridBounds() function is deprecated. It will be removed in 3.0. Please use getTilesBounds() instead.";OpenLayers.Console.warn(a);return this.getTilesBounds()},getTilesBounds:function(){var e=null;if(this.grid.length){var a=this.grid.length-1;var d=this.grid[a][0];var b=this.grid[0].length-1;var c=this.grid[0][b];e=new OpenLayers.Bounds(d.bounds.left,d.bounds.bottom,c.bounds.right,c.bounds.top)}return e},initSingleTile:function(f){var a=f.getCenterLonLat();var h=f.getWidth()*this.ratio;var b=f.getHeight()*this.ratio;var g=new OpenLayers.Bounds(a.lon-(h/2),a.lat-(b/2),a.lon+(h/2),a.lat+(b/2));var d=new OpenLayers.LonLat(g.left,g.top);var c=this.map.getLayerPxFromLonLat(d);if(!this.grid.length){this.grid[0]=[]}var e=this.grid[0][0];if(!e){e=this.addTile(g,c);this.addTileMonitoringHooks(e);e.draw();this.grid[0][0]=e}else{e.moveTo(g,c)}this.removeExcessTiles(1,1)},calculateGridLayout:function(a,o,e){var k=e*this.tileSize.w;
var c=e*this.tileSize.h;var i=a.left-o.left;var l=Math.floor(i/k)-this.buffer;var j=i/k-l;var f=-j*this.tileSize.w;var m=o.left+l*k;var b=a.top-(o.bottom+c);var h=Math.ceil(b/c)+this.buffer;var n=h-b/c;var d=-n*this.tileSize.h;var g=o.bottom+h*c;return{tilelon:k,tilelat:c,tileoffsetlon:m,tileoffsetlat:g,tileoffsetx:f,tileoffsety:d}},initGriddedTiles:function(i){var g=this.map.getSize();var v=Math.ceil(g.h/this.tileSize.h)+Math.max(1,2*this.buffer);var z=Math.ceil(g.w/this.tileSize.w)+Math.max(1,2*this.buffer);var o=this.getMaxExtent();var r=this.map.getResolution();var q=this.calculateGridLayout(i,o,r);var f=Math.round(q.tileoffsetx);var c=Math.round(q.tileoffsety);var k=q.tileoffsetlon;var n=q.tileoffsetlat;var e=q.tilelon;var j=q.tilelat;this.origin=new OpenLayers.Pixel(f,c);var u=f;var w=k;var t=0;var a=parseInt(this.map.layerContainerDiv.style.left);var s=parseInt(this.map.layerContainerDiv.style.top);do{var h=this.grid[t++];if(!h){h=[];this.grid.push(h)}k=w;f=u;var d=0;do{var b=new OpenLayers.Bounds(k,n,k+e,n+j);var m=f;m-=a;var l=c;l-=s;var p=new OpenLayers.Pixel(m,l);var A=h[d++];if(!A){A=this.addTile(b,p);this.addTileMonitoringHooks(A);h.push(A)}else{A.moveTo(b,p,false)}k+=e;f+=this.tileSize.w}while((k<=i.right+e*this.buffer)||d<z);n-=j;c+=this.tileSize.h}while((n>=i.bottom-j*this.buffer)||t<v);this.removeExcessTiles(t,d);this.spiralTileLoad()},getMaxExtent:function(){return this.maxExtent},spiralTileLoad:function(){var b=[];var h=["right","down","left","up"];var g=0;var a=-1;var k=OpenLayers.Util.indexOf(h,"right");var l=0;while(l<h.length){var j=g;var c=a;switch(h[k]){case"right":c++;break;case"down":j++;break;case"left":c--;break;case"up":j--;break}var f=null;if((j<this.grid.length)&&(j>=0)&&(c<this.grid[0].length)&&(c>=0)){f=this.grid[j][c]}if((f!=null)&&(!f.queued)){b.unshift(f);f.queued=true;l=0;g=j;a=c}else{k=(k+1)%4;l++}}for(var d=0,e=b.length;d<e;d++){var f=b[d];f.draw();f.queued=false}},addTile:function(b,a){},addTileMonitoringHooks:function(a){a.onLoadStart=function(){if(this.numLoadingTiles==0){this.events.triggerEvent("loadstart")}this.numLoadingTiles++};a.events.register("loadstart",this,a.onLoadStart);a.onLoadEnd=function(){this.numLoadingTiles--;this.events.triggerEvent("tileloaded");if(this.numLoadingTiles==0){this.events.triggerEvent("loadend")}};a.events.register("loadend",this,a.onLoadEnd);a.events.register("unload",this,a.onLoadEnd)},removeTileMonitoringHooks:function(a){a.unload();a.events.un({loadstart:a.onLoadStart,loadend:a.onLoadEnd,unload:a.onLoadEnd,scope:this})},moveGriddedTiles:function(c){var b=this.buffer||1;while(true){var a=this.grid[0][0].position;var d=this.map.getViewPortPxFromLayerPx(a);if(d.x>-this.tileSize.w*(b-1)){this.shiftColumn(true)}else{if(d.x<-this.tileSize.w*b){this.shiftColumn(false)}else{if(d.y>-this.tileSize.h*(b-1)){this.shiftRow(true)}else{if(d.y<-this.tileSize.h*b){this.shiftRow(false)}else{break}}}}}},shiftRow:function(n){var c=(n)?0:(this.grid.length-1);var b=this.grid;var f=b[c];var e=this.map.getResolution();var h=(n)?-this.tileSize.h:this.tileSize.h;var g=e*-h;var m=(n)?b.pop():b.shift();for(var j=0,l=f.length;j<l;j++){var d=f[j];var a=d.bounds.clone();var k=d.position.clone();a.bottom=a.bottom+g;a.top=a.top+g;k.y=k.y+h;m[j].moveTo(a,k)}if(n){b.unshift(m)}else{b.push(m)}},shiftColumn:function(m){var d=(m)?-this.tileSize.w:this.tileSize.w;var c=this.map.getResolution();var k=c*d;for(var e=0,g=this.grid.length;e<g;e++){var l=this.grid[e];var j=(m)?0:(l.length-1);var b=l[j];var a=b.bounds.clone();var f=b.position.clone();a.left=a.left+k;a.right=a.right+k;f.x=f.x+d;var h=m?this.grid[e].pop():this.grid[e].shift();h.moveTo(a,f);if(m){l.unshift(h)}else{l.push(h)}}},removeExcessTiles:function(e,c){while(this.grid.length>e){var f=this.grid.pop();for(var b=0,a=f.length;b<a;b++){var d=f[b];this.removeTileMonitoringHooks(d);d.destroy()}}while(this.grid[0].length>c){for(var b=0,a=this.grid.length;b<a;b++){var f=this.grid[b];var d=f.pop();this.removeTileMonitoringHooks(d);d.destroy()
}}},onMapResize:function(){if(this.singleTile){this.clearGrid();this.setTileSize()}},getTileBounds:function(d){var c=this.maxExtent;var f=this.getResolution();var e=f*this.tileSize.w;var b=f*this.tileSize.h;var h=this.getLonLatFromViewPortPx(d);var a=c.left+(e*Math.floor((h.lon-c.left)/e));var g=c.bottom+(b*Math.floor((h.lat-c.bottom)/b));return new OpenLayers.Bounds(a,g,a+e,g+b)},CLASS_NAME:"OpenLayers.Layer.Grid"});OpenLayers.Layer.MultiMap=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:1,MAX_ZOOM_LEVEL:17,RESOLUTIONS:[9,1.40625,0.703125,0.3515625,0.17578125,0.087890625,0.0439453125,0.02197265625,0.010986328125,0.0054931640625,0.00274658203125,0.001373291015625,0.0006866455078125,0.00034332275390625,0.000171661376953125,0.0000858306884765625,0.00004291534423828125],type:null,initialize:function(b,a){OpenLayers.Layer.EventPane.prototype.initialize.apply(this,arguments);OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,arguments);if(this.sphericalMercator){OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator);this.initMercatorParameters();this.RESOLUTIONS.unshift(10)}},loadMapObject:function(){try{this.mapObject=new MultimapViewer(this.div)}catch(a){}},getWarningHTML:function(){return OpenLayers.i18n("getLayerWarning",{layerType:"MM",layerLib:"MultiMap"})},setMapObjectCenter:function(a,b){this.mapObject.goToPosition(a,b)},getMapObjectCenter:function(){return this.mapObject.getCurrentPosition()},getMapObjectZoom:function(){return this.mapObject.getZoomFactor()},getMapObjectLonLatFromMapObjectPixel:function(a){a.x=a.x-(this.map.getSize().w/2);a.y=a.y-(this.map.getSize().h/2);return this.mapObject.getMapPositionAt(a)},getMapObjectPixelFromMapObjectLonLat:function(a){return this.mapObject.geoPosToContainerPixels(a)},getLongitudeFromMapObjectLonLat:function(a){return this.sphericalMercator?this.forwardMercator(a.lon,a.lat).lon:a.lon},getLatitudeFromMapObjectLonLat:function(a){return this.sphericalMercator?this.forwardMercator(a.lon,a.lat).lat:a.lat},getMapObjectLonLatFromLonLat:function(d,c){var a;if(this.sphericalMercator){var b=this.inverseMercator(d,c);a=new MMLatLon(b.lat,b.lon)}else{a=new MMLatLon(c,d)}return a},getXFromMapObjectPixel:function(a){return a.x},getYFromMapObjectPixel:function(a){return a.y},getMapObjectPixelFromXY:function(a,b){return new MMPoint(a,b)},CLASS_NAME:"OpenLayers.Layer.MultiMap"});OpenLayers.Layer.VirtualEarth=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:1,MAX_ZOOM_LEVEL:19,RESOLUTIONS:[1.40625,0.703125,0.3515625,0.17578125,0.087890625,0.0439453125,0.02197265625,0.010986328125,0.0054931640625,0.00274658203125,0.001373291015625,0.0006866455078125,0.00034332275390625,0.000171661376953125,0.0000858306884765625,0.00004291534423828125,0.00002145767211914062,0.00001072883605957031,0.00000536441802978515],type:null,wrapDateLine:true,sphericalMercator:false,animationEnabled:true,initialize:function(b,a){OpenLayers.Layer.EventPane.prototype.initialize.apply(this,arguments);OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,arguments);if(this.sphericalMercator){OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator);this.initMercatorParameters()}},loadMapObject:function(){var a=OpenLayers.Util.createDiv(this.name);var c=this.map.getSize();a.style.width=c.w+"px";a.style.height=c.h+"px";this.div.appendChild(a);try{this.mapObject=new VEMap(this.name)}catch(b){}if(this.mapObject!=null){try{this.mapObject.LoadMap(null,null,this.type,true);this.mapObject.AttachEvent("onmousedown",OpenLayers.Function.True)}catch(b){}this.mapObject.HideDashboard();if(typeof this.mapObject.SetAnimationEnabled=="function"){this.mapObject.SetAnimationEnabled(this.animationEnabled)}}if(!this.mapObject||!this.mapObject.vemapcontrol||!this.mapObject.vemapcontrol.PanMap||(typeof this.mapObject.vemapcontrol.PanMap!="function")){this.dragPanMapObject=null}},onMapResize:function(){this.mapObject.Resize(this.map.size.w,this.map.size.h)
},getWarningHTML:function(){return OpenLayers.i18n("getLayerWarning",{layerType:"VE",layerLib:"VirtualEarth"})},setMapObjectCenter:function(a,b){this.mapObject.SetCenterAndZoom(a,b)},getMapObjectCenter:function(){return this.mapObject.GetCenter()},dragPanMapObject:function(b,a){this.mapObject.vemapcontrol.PanMap(b,-a)},getMapObjectZoom:function(){return this.mapObject.GetZoomLevel()},getMapObjectLonLatFromMapObjectPixel:function(a){return(typeof VEPixel!="undefined")?this.mapObject.PixelToLatLong(a):this.mapObject.PixelToLatLong(a.x,a.y)},getMapObjectPixelFromMapObjectLonLat:function(a){return this.mapObject.LatLongToPixel(a)},getLongitudeFromMapObjectLonLat:function(a){return this.sphericalMercator?this.forwardMercator(a.Longitude,a.Latitude).lon:a.Longitude},getLatitudeFromMapObjectLonLat:function(a){return this.sphericalMercator?this.forwardMercator(a.Longitude,a.Latitude).lat:a.Latitude},getMapObjectLonLatFromLonLat:function(d,b){var c;if(this.sphericalMercator){var a=this.inverseMercator(d,b);c=new VELatLong(a.lat,a.lon)}else{c=new VELatLong(b,d)}return c},getXFromMapObjectPixel:function(a){return a.x},getYFromMapObjectPixel:function(a){return a.y},getMapObjectPixelFromXY:function(a,b){return(typeof VEPixel!="undefined")?new VEPixel(a,b):new Msn.VE.Pixel(a,b)},CLASS_NAME:"OpenLayers.Layer.VirtualEarth"});OpenLayers.Layer.Yahoo=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:0,MAX_ZOOM_LEVEL:17,RESOLUTIONS:[1.40625,0.703125,0.3515625,0.17578125,0.087890625,0.0439453125,0.02197265625,0.010986328125,0.0054931640625,0.00274658203125,0.001373291015625,0.0006866455078125,0.00034332275390625,0.000171661376953125,0.0000858306884765625,0.00004291534423828125,0.00002145767211914062,0.00001072883605957031],type:null,wrapDateLine:true,sphericalMercator:false,initialize:function(b,a){OpenLayers.Layer.EventPane.prototype.initialize.apply(this,arguments);OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,arguments);if(this.sphericalMercator){OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator);this.initMercatorParameters()}},loadMapObject:function(){try{var a=this.getMapObjectSizeFromOLSize(this.map.getSize());this.mapObject=new YMap(this.div,this.type,a);this.mapObject.disableKeyControls();this.mapObject.disableDragMap();if(!this.mapObject.moveByXY||(typeof this.mapObject.moveByXY!="function")){this.dragPanMapObject=null}}catch(b){}},onMapResize:function(){try{var a=this.getMapObjectSizeFromOLSize(this.map.getSize());this.mapObject.resizeTo(a)}catch(b){}},setMap:function(a){OpenLayers.Layer.EventPane.prototype.setMap.apply(this,arguments);this.map.events.register("moveend",this,this.fixYahooEventPane)},fixYahooEventPane:function(){var a=OpenLayers.Util.getElement("ygddfdiv");if(a!=null){if(a.parentNode!=null){a.parentNode.removeChild(a)}this.map.events.unregister("moveend",this,this.fixYahooEventPane)}},getWarningHTML:function(){return OpenLayers.i18n("getLayerWarning",{layerType:"Yahoo",layerLib:"Yahoo"})},getOLZoomFromMapObjectZoom:function(a){var b=null;if(a!=null){b=OpenLayers.Layer.FixedZoomLevels.prototype.getOLZoomFromMapObjectZoom.apply(this,[a]);b=18-b}return b},getMapObjectZoomFromOLZoom:function(a){var b=null;if(a!=null){b=OpenLayers.Layer.FixedZoomLevels.prototype.getMapObjectZoomFromOLZoom.apply(this,[a]);b=18-b}return b},setMapObjectCenter:function(a,b){this.mapObject.drawZoomAndCenter(a,b)},getMapObjectCenter:function(){return this.mapObject.getCenterLatLon()},dragPanMapObject:function(b,a){this.mapObject.moveByXY({x:-b,y:a})},getMapObjectZoom:function(){return this.mapObject.getZoomLevel()},getMapObjectLonLatFromMapObjectPixel:function(a){return this.mapObject.convertXYLatLon(a)},getMapObjectPixelFromMapObjectLonLat:function(a){return this.mapObject.convertLatLonXY(a)},getLongitudeFromMapObjectLonLat:function(a){return this.sphericalMercator?this.forwardMercator(a.Lon,a.Lat).lon:a.Lon},getLatitudeFromMapObjectLonLat:function(a){return this.sphericalMercator?this.forwardMercator(a.Lon,a.Lat).lat:a.Lat
},getMapObjectLonLatFromLonLat:function(d,c){var a;if(this.sphericalMercator){var b=this.inverseMercator(d,c);a=new YGeoPoint(b.lat,b.lon)}else{a=new YGeoPoint(c,d)}return a},getXFromMapObjectPixel:function(a){return a.x},getYFromMapObjectPixel:function(a){return a.y},getMapObjectPixelFromXY:function(a,b){return new YCoordPoint(a,b)},getMapObjectSizeFromOLSize:function(a){return new YSize(a.w,a.h)},CLASS_NAME:"OpenLayers.Layer.Yahoo"});OpenLayers.Style=OpenLayers.Class({id:null,name:null,title:null,description:null,layerName:null,isDefault:false,rules:null,context:null,defaultStyle:null,defaultsPerSymbolizer:false,propertyStyles:null,initialize:function(b,a){OpenLayers.Util.extend(this,a);this.rules=[];if(a&&a.rules){this.addRules(a.rules)}this.setDefaultStyle(b||OpenLayers.Feature.Vector.style["default"]);this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var b=0,a=this.rules.length;b<a;b++){this.rules[b].destroy();this.rules[b]=null}this.rules=null;this.defaultStyle=null},createSymbolizer:function(k){var a=this.defaultsPerSymbolizer?{}:this.createLiterals(OpenLayers.Util.extend({},this.defaultStyle),k);var j=this.rules;var h,b;var c=[];var f=false;for(var d=0,e=j.length;d<e;d++){h=j[d];var g=h.evaluate(k);if(g){if(h instanceof OpenLayers.Rule&&h.elseFilter){c.push(h)}else{f=true;this.applySymbolizer(h,a,k)}}}if(f==false&&c.length>0){f=true;for(var d=0,e=c.length;d<e;d++){this.applySymbolizer(c[d],a,k)}}if(j.length>0&&f==false){a.display="none"}return a},applySymbolizer:function(f,d,b){var a=b.geometry?this.getSymbolizerPrefix(b.geometry):OpenLayers.Style.SYMBOLIZER_PREFIXES[0];var c=f.symbolizer[a]||f.symbolizer;if(this.defaultsPerSymbolizer===true){var e=this.defaultStyle;OpenLayers.Util.applyDefaults(c,{pointRadius:e.pointRadius});if(c.stroke===true||c.graphic===true){OpenLayers.Util.applyDefaults(c,{strokeWidth:e.strokeWidth,strokeColor:e.strokeColor,strokeOpacity:e.strokeOpacity,strokeDashstyle:e.strokeDashstyle,strokeLinecap:e.strokeLinecap})}if(c.fill===true||c.graphic===true){OpenLayers.Util.applyDefaults(c,{fillColor:e.fillColor,fillOpacity:e.fillOpacity})}if(c.graphic===true){OpenLayers.Util.applyDefaults(c,{pointRadius:this.defaultStyle.pointRadius,externalGraphic:this.defaultStyle.externalGraphic,graphicName:this.defaultStyle.graphicName,graphicOpacity:this.defaultStyle.graphicOpacity,graphicWidth:this.defaultStyle.graphicWidth,graphicHeight:this.defaultStyle.graphicHeight,graphicXOffset:this.defaultStyle.graphicXOffset,graphicYOffset:this.defaultStyle.graphicYOffset})}}return this.createLiterals(OpenLayers.Util.extend(d,c),b)},createLiterals:function(d,c){var b=OpenLayers.Util.extend({},c.attributes||c.data);OpenLayers.Util.extend(b,this.context);for(var a in this.propertyStyles){d[a]=OpenLayers.Style.createLiteral(d[a],b,c,a)}return d},findPropertyStyles:function(){var d={};var f=this.defaultStyle;this.addPropertyStyles(d,f);var h=this.rules;var e,g;for(var c=0,a=h.length;c<a;c++){e=h[c].symbolizer;for(var b in e){g=e[b];if(typeof g=="object"){this.addPropertyStyles(d,g)}else{this.addPropertyStyles(d,e);break}}}return d},addPropertyStyles:function(b,c){var d;for(var a in c){d=c[a];if(typeof d=="string"&&d.match(/\$\{\w+\}/)){b[a]=true}}return b},addRules:function(a){Array.prototype.push.apply(this.rules,a);this.propertyStyles=this.findPropertyStyles()},setDefaultStyle:function(a){this.defaultStyle=a;this.propertyStyles=this.findPropertyStyles()},getSymbolizerPrefix:function(d){var c=OpenLayers.Style.SYMBOLIZER_PREFIXES;for(var b=0,a=c.length;b<a;b++){if(d.CLASS_NAME.indexOf(c[b])!=-1){return c[b]}}},clone:function(){var b=OpenLayers.Util.extend({},this);if(this.rules){b.rules=[];for(var c=0,a=this.rules.length;c<a;++c){b.rules.push(this.rules[c].clone())}}b.context=this.context&&OpenLayers.Util.extend({},this.context);var d=OpenLayers.Util.extend({},this.defaultStyle);return new OpenLayers.Style(d,b)},CLASS_NAME:"OpenLayers.Style"});OpenLayers.Style.createLiteral=function(d,b,a,c){if(typeof d=="string"&&d.indexOf("${")!=-1){d=OpenLayers.String.format(d,b,[a,c]);
d=(isNaN(d)||!d)?d:parseFloat(d)}return d};OpenLayers.Style.SYMBOLIZER_PREFIXES=["Point","Line","Polygon","Text","Raster"];OpenLayers.Control.Navigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,documentDrag:false,zoomBox:null,zoomBoxEnabled:true,zoomWheelEnabled:true,mouseWheelOptions:null,handleRightClicks:false,zoomBoxKeyMask:OpenLayers.Handler.MOD_SHIFT,autoActivate:true,initialize:function(a){this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate();if(this.dragPan){this.dragPan.destroy()}this.dragPan=null;if(this.zoomBox){this.zoomBox.destroy()}this.zoomBox=null;OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){this.dragPan.activate();if(this.zoomWheelEnabled){this.handlers.wheel.activate()}this.handlers.click.activate();if(this.zoomBoxEnabled){this.zoomBox.activate()}return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){this.zoomBox.deactivate();this.dragPan.deactivate();this.handlers.click.deactivate();this.handlers.wheel.deactivate();return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},draw:function(){if(this.handleRightClicks){this.map.viewPortDiv.oncontextmenu=OpenLayers.Function.False}var a={dblclick:this.defaultDblClick,dblrightclick:this.defaultDblRightClick};var b={"double":true,stopDouble:true};this.handlers.click=new OpenLayers.Handler.Click(this,a,b);this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map,documentDrag:this.documentDrag},this.dragPanOptions));this.zoomBox=new OpenLayers.Control.ZoomBox({map:this.map,keyMask:this.zoomBoxKeyMask});this.dragPan.draw();this.zoomBox.draw();this.handlers.wheel=new OpenLayers.Handler.MouseWheel(this,{up:this.wheelUp,down:this.wheelDown},this.mouseWheelOptions)},defaultDblClick:function(b){var a=this.map.getLonLatFromViewPortPx(b.xy);this.map.setCenter(a,this.map.zoom+1)},defaultDblRightClick:function(b){var a=this.map.getLonLatFromViewPortPx(b.xy);this.map.setCenter(a,this.map.zoom-1)},wheelChange:function(i,c){var h=this.map.getZoom();var f=this.map.getZoom()+Math.round(c);f=Math.max(f,0);f=Math.min(f,this.map.getNumZoomLevels());if(f===h){return}var j=this.map.getSize();var e=j.w/2-i.xy.x;var d=i.xy.y-j.h/2;var g=this.map.baseLayer.getResolutionForZoom(f);var a=this.map.getLonLatFromPixel(i.xy);var b=new OpenLayers.LonLat(a.lon+e*g,a.lat+d*g);this.map.setCenter(b,f)},wheelUp:function(a,b){this.wheelChange(a,b||1)},wheelDown:function(a,b){this.wheelChange(a,b||-1)},disableZoomBox:function(){this.zoomBoxEnabled=false;this.zoomBox.deactivate()},enableZoomBox:function(){this.zoomBoxEnabled=true;if(this.active){this.zoomBox.activate()}},disableZoomWheel:function(){this.zoomWheelEnabled=false;this.handlers.wheel.deactivate()},enableZoomWheel:function(){this.zoomWheelEnabled=true;if(this.active){this.handlers.wheel.activate()}},CLASS_NAME:"OpenLayers.Control.Navigation"});OpenLayers.Filter=OpenLayers.Class({initialize:function(a){OpenLayers.Util.extend(this,a)},destroy:function(){},evaluate:function(a){return true},clone:function(){return null},CLASS_NAME:"OpenLayers.Filter"});OpenLayers.Format.WMC.v1_0_0=OpenLayers.Class(OpenLayers.Format.WMC.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/context http://schemas.opengis.net/context/1.0.0/context.xsd",initialize:function(a){OpenLayers.Format.WMC.v1.prototype.initialize.apply(this,[a])},write_wmc_Layer:function(a){var b=OpenLayers.Format.WMC.v1.prototype.write_wmc_Layer.apply(this,[a]);b.appendChild(this.write_wmc_FormatList(a));b.appendChild(this.write_wmc_StyleList(a));b.appendChild(this.write_wmc_LayerExtension(a))},CLASS_NAME:"OpenLayers.Format.WMC.v1_0_0"});OpenLayers.Format.WMC.v1_1_0=OpenLayers.Class(OpenLayers.Format.WMC.v1,{VERSION:"1.1.0",schemaLocation:"http://www.opengis.net/context http://schemas.opengis.net/context/1.1.0/context.xsd",initialize:function(a){OpenLayers.Format.WMC.v1.prototype.initialize.apply(this,[a])
},read_sld_MinScaleDenominator:function(c,b){var a=parseFloat(this.getChildValue(b));if(a>0){c.maxScale=a}},read_sld_MaxScaleDenominator:function(b,a){b.minScale=parseFloat(this.getChildValue(a))},write_wmc_Layer:function(b){var c=OpenLayers.Format.WMC.v1.prototype.write_wmc_Layer.apply(this,[b]);if(b.maxScale){var d=this.createElementNS(this.namespaces.sld,"sld:MinScaleDenominator");d.appendChild(this.createTextNode(b.maxScale.toPrecision(16)));c.appendChild(d)}if(b.minScale){var a=this.createElementNS(this.namespaces.sld,"sld:MaxScaleDenominator");a.appendChild(this.createTextNode(b.minScale.toPrecision(16)));c.appendChild(a)}c.appendChild(this.write_wmc_FormatList(b));c.appendChild(this.write_wmc_StyleList(b));c.appendChild(this.write_wmc_LayerExtension(b));return c},CLASS_NAME:"OpenLayers.Format.WMC.v1_1_0"});OpenLayers.Format.WMSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1,{version:"1.1.0",initialize:function(a){OpenLayers.Format.WMSCapabilities.v1_1.prototype.initialize.apply(this,[a])},readers:{wms:OpenLayers.Util.applyDefaults({SRS:function(e,f){var d=this.getChildValue(e);var b=d.split(/ +/);for(var c=0,a=b.length;c<a;c++){f.srs[b[c]]=true}}},OpenLayers.Format.WMSCapabilities.v1_1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_0"});OpenLayers.Format.WMSCapabilities.v1_1_1=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1,{version:"1.1.1",initialize:function(a){OpenLayers.Format.WMSCapabilities.v1_1.prototype.initialize.apply(this,[a])},readers:{wms:OpenLayers.Util.applyDefaults({SRS:function(a,b){b.srs[this.getChildValue(a)]=true}},OpenLayers.Format.WMSCapabilities.v1_1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_1"});OpenLayers.Format.WMSCapabilities.v1_3_0=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_3,{version:"1.3.0",CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_3_0"});OpenLayers.Geometry=OpenLayers.Class({id:null,parent:null,bounds:null,initialize:function(){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){this.id=null;this.bounds=null},clone:function(){return new OpenLayers.Geometry()},setBounds:function(a){if(a){this.bounds=a.clone()}},clearBounds:function(){this.bounds=null;if(this.parent){this.parent.clearBounds()}},extendBounds:function(b){var a=this.getBounds();if(!a){this.setBounds(b)}else{this.bounds.extend(b)}},getBounds:function(){if(this.bounds==null){this.calculateBounds()}return this.bounds},calculateBounds:function(){},distanceTo:function(b,a){},getVertices:function(a){},atPoint:function(e,h,f){var c=false;var d=this.getBounds();if((d!=null)&&(e!=null)){var b=(h!=null)?h:0;var a=(f!=null)?f:0;var g=new OpenLayers.Bounds(this.bounds.left-b,this.bounds.bottom-a,this.bounds.right+b,this.bounds.top+a);c=g.containsLonLat(e)}return c},getLength:function(){return 0},getArea:function(){return 0},getCentroid:function(){return null},toString:function(){return OpenLayers.Format.WKT.prototype.write(new OpenLayers.Feature.Vector(this))},CLASS_NAME:"OpenLayers.Geometry"});OpenLayers.Geometry.fromWKT=function(f){var g=arguments.callee.format;if(!g){g=new OpenLayers.Format.WKT();arguments.callee.format=g}var d;var b=g.read(f);if(b instanceof OpenLayers.Feature.Vector){d=b.geometry}else{if(b instanceof Array){var a=b.length;var e=new Array(a);for(var c=0;c<a;++c){e[c]=b[c].geometry}d=new OpenLayers.Geometry.Collection(e)}}return d};OpenLayers.Geometry.segmentsIntersect=function(a,H,b){var s=b&&b.point;var z=b&&b.tolerance;var f=false;var B=a.x1-H.x1;var F=a.y1-H.y1;var o=a.x2-a.x1;var w=a.y2-a.y1;var t=H.y2-H.y1;var l=H.x2-H.x1;var D=(t*o)-(l*w);var e=(l*F)-(t*B);var c=(o*F)-(w*B);if(D==0){if(e==0&&c==0){f=true}}else{var E=e/D;var C=c/D;if(E>=0&&E<=1&&C>=0&&C<=1){if(!s){f=true}else{var h=a.x1+(E*o);var g=a.y1+(E*w);f=new OpenLayers.Geometry.Point(h,g)}}}if(z){var r;if(f){if(s){var n=[a,H];var A,h,g;outer:for(var v=0;v<2;++v){A=n[v];for(var u=1;u<3;++u){h=A["x"+u];g=A["y"+u];r=Math.sqrt(Math.pow(h-f.x,2)+Math.pow(g-f.y,2));
if(r<z){f.x=h;f.y=g;break outer}}}}}else{var n=[a,H];var q,G,h,g,m,k;outer:for(var v=0;v<2;++v){q=n[v];G=n[(v+1)%2];for(var u=1;u<3;++u){m={x:q["x"+u],y:q["y"+u]};k=OpenLayers.Geometry.distanceToSegment(m,G);if(k.distance<z){if(s){f=new OpenLayers.Geometry.Point(m.x,m.y)}else{f=true}break outer}}}}}return f};OpenLayers.Geometry.distanceToSegment=function(k,d){var c=k.x;var j=k.y;var b=d.x1;var i=d.y1;var a=d.x2;var f=d.y2;var m=a-b;var l=f-i;var h=((m*(c-b))+(l*(j-i)))/(Math.pow(m,2)+Math.pow(l,2));var g,e;if(h<=0){g=b;e=i}else{if(h>=1){g=a;e=f}else{g=b+h*m;e=i+h*l}}return{distance:Math.sqrt(Math.pow(g-c,2)+Math.pow(e-j,2)),x:g,y:e}};OpenLayers.Layer.ArcGIS93Rest=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{format:"png"},isBaseLayer:true,initialize:function(d,c,e,b){var a=[];e=OpenLayers.Util.upperCaseObject(e);a.push(d,c,e,b);OpenLayers.Layer.Grid.prototype.initialize.apply(this,a);OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS));if(this.params.TRANSPARENT&&this.params.TRANSPARENT.toString().toLowerCase()=="true"){if((b==null)||(!b.isBaseLayer)){this.isBaseLayer=false}if(this.params.FORMAT=="jpg"){this.params.FORMAT=OpenLayers.Util.alphaHack()?"gif":"png"}}},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments)},clone:function(a){if(a==null){a=new OpenLayers.Layer.ArcGIS93Rest(this.name,this.url,this.params,this.getOptions())}a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a]);return a},getURL:function(e){e=this.adjustBounds(e);var d=this.projection.getCode().split(":");var c=d[d.length-1];var g=this.getImageSize();var h={BBOX:e.toBBOX(),SIZE:g.w+","+g.h,F:"image",BBOXSR:c,IMAGESR:c};if(this.layerDefs){var f=[];var a;for(a in this.layerDefs){if(this.layerDefs.hasOwnProperty(a)){if(this.layerDefs[a]){f.push(a);f.push(":");f.push(this.layerDefs[a]);f.push(";")}}}if(f.length>0){h.LAYERDEFS=f.join("")}}var b=this.getFullRequestString(h);return b},setLayerFilter:function(b,a){if(!this.layerDefs){this.layerDefs={}}if(a){this.layerDefs[b]=a}else{delete this.layerDefs[b]}},clearLayerFilter:function(a){if(a){delete this.layerDefs[a]}else{delete this.layerDefs}},mergeNewParams:function(c){var b=OpenLayers.Util.upperCaseObject(c);var a=[b];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,a)},addTile:function(b,a){return new OpenLayers.Tile.Image(this,a,b,null,this.tileSize)},CLASS_NAME:"OpenLayers.Layer.ArcGIS93Rest"});OpenLayers.Layer.Google.v3={DEFAULTS:{maxExtent:new OpenLayers.Bounds(-128*156543.0339,-128*156543.0339,128*156543.0339,128*156543.0339),sphericalMercator:true,maxResolution:156543.0339,units:"m",projection:"EPSG:900913"},loadMapObject:function(){if(!this.type){this.type=google.maps.MapTypeId.ROADMAP}var d;var c=OpenLayers.Layer.Google.cache[this.map.id];if(c){d=c.mapObject;++c.count}else{var b=this.map.viewPortDiv;var e=document.createElement("div");e.id=this.map.id+"_GMapContainer";e.style.position="absolute";e.style.width="100%";e.style.height="100%";b.appendChild(e);var a=this.map.getCenter();d=new google.maps.Map(e,{center:a?new google.maps.LatLng(a.lat,a.lon):new google.maps.LatLng(0,0),zoom:this.map.getZoom()||0,mapTypeId:this.type,disableDefaultUI:true,keyboardShortcuts:false,draggable:false,disableDoubleClickZoom:true,scrollwheel:false});c={mapObject:d,count:1};OpenLayers.Layer.Google.cache[this.map.id]=c;this.repositionListener=google.maps.event.addListenerOnce(d,"center_changed",OpenLayers.Function.bind(this.repositionMapElements,this))}this.mapObject=d;this.setGMapVisibility(this.visibility)},repositionMapElements:function(){google.maps.event.trigger(this.mapObject,"resize");var e=this.mapObject.getDiv().firstChild;if(!e||e.childNodes.length<3){this.repositionTimer=window.setTimeout(OpenLayers.Function.bind(this.repositionMapElements,this),250);return false}var d=OpenLayers.Layer.Google.cache[this.map.id];var b=this.map.viewPortDiv;var c=e.lastChild;b.appendChild(c);c.style.zIndex="1100";c.style.bottom="";c.className="olLayerGoogleCopyright olLayerGoogleV3";
c.style.display="";d.termsOfUse=c;var a=e.lastChild;b.appendChild(a);a.style.zIndex="1100";a.style.bottom="";a.className="olLayerGooglePoweredBy olLayerGoogleV3 gmnoprint";a.style.display="";d.poweredBy=a;this.setGMapVisibility(this.visibility)},onMapResize:function(){if(this.visibility){google.maps.event.trigger(this.mapObject,"resize")}else{if(!this._resized){var a=this;google.maps.event.addListenerOnce(this.mapObject,"tilesloaded",function(){delete a._resized;google.maps.event.trigger(a.mapObject,"resize");a.moveTo(a.map.getCenter(),a.map.getZoom())})}this._resized=true}},setGMapVisibility:function(g){var b=OpenLayers.Layer.Google.cache[this.map.id];if(b){var e=this.type;var f=this.map.layers;var d;for(var c=f.length-1;c>=0;--c){d=f[c];if(d instanceof OpenLayers.Layer.Google&&d.visibility===true&&d.inRange===true){e=d.type;g=true;break}}var a=this.mapObject.getDiv();if(g===true){this.mapObject.setMapTypeId(e);a.style.left="";if(b.termsOfUse&&b.termsOfUse.style){b.termsOfUse.style.left="";b.termsOfUse.style.display="";b.poweredBy.style.display=""}b.displayed=this.id}else{delete b.displayed;a.style.left="-9999px";if(b.termsOfUse&&b.termsOfUse.style){b.termsOfUse.style.display="none";b.termsOfUse.style.left="-9999px";b.poweredBy.style.display="none"}}}},getMapContainer:function(){return this.mapObject.getDiv()},getMapObjectBoundsFromOLBounds:function(c){var b=null;if(c!=null){var a=this.sphericalMercator?this.inverseMercator(c.bottom,c.left):new OpenLayers.LonLat(c.bottom,c.left);var d=this.sphericalMercator?this.inverseMercator(c.top,c.right):new OpenLayers.LonLat(c.top,c.right);b=new google.maps.LatLngBounds(new google.maps.LatLng(a.lat,a.lon),new google.maps.LatLng(d.lat,d.lon))}return b},getMapObjectLonLatFromMapObjectPixel:function(h){var b=this.map.getSize();var f=this.getLongitudeFromMapObjectLonLat(this.mapObject.center);var d=this.getLatitudeFromMapObjectLonLat(this.mapObject.center);var a=this.map.getResolution();var g=h.x-(b.w/2);var e=h.y-(b.h/2);var c=new OpenLayers.LonLat(f+g*a,d-e*a);if(this.wrapDateLine){c=c.wrapDateLine(this.maxExtent)}return this.getMapObjectLonLatFromLonLat(c.lon,c.lat)},getMapObjectPixelFromMapObjectLonLat:function(f){var e=this.getLongitudeFromMapObjectLonLat(f);var d=this.getLatitudeFromMapObjectLonLat(f);var b=this.map.getResolution();var c=this.map.getExtent();var a=new OpenLayers.Pixel((1/b*(e-c.left)),(1/b*(c.top-d)));return this.getMapObjectPixelFromXY(a.x,a.y)},setMapObjectCenter:function(a,b){this.mapObject.setOptions({center:a,zoom:b})},getMapObjectZoomFromMapObjectBounds:function(a){return this.mapObject.getBoundsZoomLevel(a)},getMapObjectLonLatFromLonLat:function(d,b){var c;if(this.sphericalMercator){var a=this.inverseMercator(d,b);c=new google.maps.LatLng(a.lat,a.lon)}else{c=new google.maps.LatLng(b,d)}return c},getMapObjectPixelFromXY:function(a,b){return new google.maps.Point(a,b)},destroy:function(){if(this.repositionListener){google.maps.event.removeListener(this.repositionListener)}if(this.repositionTimer){window.clearTimeout(this.repositionTimer)}OpenLayers.Layer.Google.prototype.destroy.apply(this,arguments)}};OpenLayers.Layer.KaMap=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:true,units:null,resolution:OpenLayers.DOTS_PER_INCH,DEFAULT_PARAMS:{i:"jpeg",map:""},initialize:function(d,c,e,b){var a=[];a.push(d,c,e,b);OpenLayers.Layer.Grid.prototype.initialize.apply(this,a);this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS)},getURL:function(c){c=this.adjustBounds(c);var d=this.map.getResolution();var e=Math.round((this.map.getScale()*10000))/10000;var b=Math.round(c.left/d);var a=-Math.round(c.top/d);return this.getFullRequestString({t:a,l:b,s:e})},addTile:function(c,a){var b=this.getURL(c);return new OpenLayers.Tile.Image(this,a,c,b,this.tileSize)},calculateGridLayout:function(a,o,e){var k=e*this.tileSize.w;var c=e*this.tileSize.h;var i=a.left;var l=Math.floor(i/k)-this.buffer;var j=i/k-l;var f=-j*this.tileSize.w;var m=l*k;var b=a.top;var h=Math.ceil(b/c)+this.buffer;
var n=h-b/c;var d=-(n+1)*this.tileSize.h;var g=h*c;return{tilelon:k,tilelat:c,tileoffsetlon:m,tileoffsetlat:g,tileoffsetx:f,tileoffsety:d}},clone:function(a){if(a==null){a=new OpenLayers.Layer.KaMap(this.name,this.url,this.params,this.getOptions())}a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a]);if(this.tileSize!=null){a.tileSize=this.tileSize.clone()}a.grid=[];return a},getTileBounds:function(c){var e=this.getResolution();var d=e*this.tileSize.w;var b=e*this.tileSize.h;var g=this.getLonLatFromViewPortPx(c);var a=d*Math.floor(g.lon/d);var f=b*Math.floor(g.lat/b);return new OpenLayers.Bounds(a,f,a+d,f+b)},CLASS_NAME:"OpenLayers.Layer.KaMap"});OpenLayers.Layer.MapGuide=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:true,useHttpTile:false,singleTile:false,useOverlay:false,useAsyncOverlay:true,TILE_PARAMS:{operation:"GETTILEIMAGE",version:"1.2.0"},SINGLE_TILE_PARAMS:{operation:"GETMAPIMAGE",format:"PNG",locale:"en",clip:"1",version:"1.0.0"},OVERLAY_PARAMS:{operation:"GETDYNAMICMAPOVERLAYIMAGE",format:"PNG",locale:"en",clip:"1",version:"2.0.0"},FOLDER_PARAMS:{tileColumnsPerFolder:30,tileRowsPerFolder:30,format:"png",querystring:null},defaultSize:new OpenLayers.Size(300,300),initialize:function(c,b,d,a){OpenLayers.Layer.Grid.prototype.initialize.apply(this,arguments);if(a==null||a.isBaseLayer==null){this.isBaseLayer=((this.transparent!="true")&&(this.transparent!=true))}if(a&&a.useOverlay!=null){this.useOverlay=a.useOverlay}if(this.singleTile){if(this.useOverlay){OpenLayers.Util.applyDefaults(this.params,this.OVERLAY_PARAMS);if(!this.useAsyncOverlay){this.params.version="1.0.0"}}else{OpenLayers.Util.applyDefaults(this.params,this.SINGLE_TILE_PARAMS)}}else{if(this.useHttpTile){OpenLayers.Util.applyDefaults(this.params,this.FOLDER_PARAMS)}else{OpenLayers.Util.applyDefaults(this.params,this.TILE_PARAMS)}this.setTileSize(this.defaultSize)}},clone:function(a){if(a==null){a=new OpenLayers.Layer.MapGuide(this.name,this.url,this.params,this.getOptions())}a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a]);return a},addTile:function(b,a){return new OpenLayers.Tile.Image(this,a,b,null,this.tileSize)},getURL:function(a){var d;var b=a.getCenterLonLat();var h=this.map.getSize();if(this.singleTile){var e={setdisplaydpi:OpenLayers.DOTS_PER_INCH,setdisplayheight:h.h*this.ratio,setdisplaywidth:h.w*this.ratio,setviewcenterx:b.lon,setviewcentery:b.lat,setviewscale:this.map.getScale()};if(this.useOverlay&&!this.useAsyncOverlay){var i={};i=OpenLayers.Util.extend(i,e);i.operation="GETVISIBLEMAPEXTENT";i.version="1.0.0";i.session=this.params.session;i.mapName=this.params.mapName;i.format="text/xml";d=this.getFullRequestString(i);OpenLayers.Request.GET({url:d,async:false})}d=this.getFullRequestString(e)}else{var g=this.map.getResolution();var f=Math.floor((a.left-this.maxExtent.left)/g);f=Math.round(f/this.tileSize.w);var c=Math.floor((this.maxExtent.top-a.top)/g);c=Math.round(c/this.tileSize.h);if(this.useHttpTile){d=this.getImageFilePath({tilecol:f,tilerow:c,scaleindex:this.resolutions.length-this.map.zoom-1})}else{d=this.getFullRequestString({tilecol:f,tilerow:c,scaleindex:this.resolutions.length-this.map.zoom-1})}}return d},getFullRequestString:function(f,e){var b=(e==null)?this.url:e;if(typeof b=="object"){b=b[Math.floor(Math.random()*b.length)]}var i=b;var g=OpenLayers.Util.extend({},this.params);g=OpenLayers.Util.extend(g,f);var d=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(b));for(var h in g){if(h.toUpperCase() in d){delete g[h]}}var a=OpenLayers.Util.getParameterString(g);a=a.replace(/,/g,"+");if(a!=""){var c=b.charAt(b.length-1);if((c=="&")||(c=="?")){i+=a}else{if(b.indexOf("?")==-1){i+="?"+a}else{i+="&"+a}}}return i},getImageFilePath:function(g,e){var c=(e==null)?this.url:e;if(typeof c=="object"){c=c[Math.floor(Math.random()*c.length)]}var b=c;var d="";var f="";if(g.tilerow<0){d="-"}if(g.tilerow==0){d+="0"}else{d+=Math.floor(Math.abs(g.tilerow/this.params.tileRowsPerFolder))*this.params.tileRowsPerFolder}if(g.tilecol<0){f="-"
}if(g.tilecol==0){f+="0"}else{f+=Math.floor(Math.abs(g.tilecol/this.params.tileColumnsPerFolder))*this.params.tileColumnsPerFolder}var a="/S"+Math.floor(g.scaleindex)+"/"+this.params.basemaplayergroupname+"/R"+d+"/C"+f+"/"+(g.tilerow%this.params.tileRowsPerFolder)+"_"+(g.tilecol%this.params.tileColumnsPerFolder)+"."+this.params.format;if(this.params.querystring){a+="?"+this.params.querystring}b+=a;return b},calculateGridLayout:function(a,o,e){var k=e*this.tileSize.w;var c=e*this.tileSize.h;var i=a.left-o.left;var l=Math.floor(i/k)-this.buffer;var j=i/k-l;var f=-j*this.tileSize.w;var m=o.left+l*k;var b=o.top-a.top+c;var h=Math.floor(b/c)-this.buffer;var n=h-b/c;var d=n*this.tileSize.h;var g=o.top-c*h;return{tilelon:k,tilelat:c,tileoffsetlon:m,tileoffsetlat:g,tileoffsetx:f,tileoffsety:d}},CLASS_NAME:"OpenLayers.Layer.MapGuide"});OpenLayers.Layer.MapServer=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{mode:"map",map_imagetype:"png"},initialize:function(d,c,e,b){var a=[];a.push(d,c,e,b);OpenLayers.Layer.Grid.prototype.initialize.apply(this,a);this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS);if(b==null||b.isBaseLayer==null){this.isBaseLayer=((this.params.transparent!="true")&&(this.params.transparent!=true))}},clone:function(a){if(a==null){a=new OpenLayers.Layer.MapServer(this.name,this.url,this.params,this.getOptions())}a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a]);return a},addTile:function(b,a){return new OpenLayers.Tile.Image(this,a,b,null,this.tileSize)},getURL:function(c){c=this.adjustBounds(c);var b=[c.left,c.bottom,c.right,c.top];var d=this.getImageSize();var a=this.getFullRequestString({mapext:b,imgext:b,map_size:[d.w,d.h],imgx:d.w/2,imgy:d.h/2,imgxy:[d.w,d.h]});return a},getFullRequestString:function(f,e){var b=(e==null)?this.url:e;var g=OpenLayers.Util.extend({},this.params);g=OpenLayers.Util.extend(g,f);var a=OpenLayers.Util.getParameterString(g);if(b instanceof Array){b=this.selectUrl(a,b)}var d=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(b));for(var h in g){if(h.toUpperCase() in d){delete g[h]}}a=OpenLayers.Util.getParameterString(g);var i=b;a=a.replace(/,/g,"+");if(a!=""){var c=b.charAt(b.length-1);if((c=="&")||(c=="?")){i+=a}else{if(b.indexOf("?")==-1){i+="?"+a}else{i+="&"+a}}}return i},CLASS_NAME:"OpenLayers.Layer.MapServer"});OpenLayers.Layer.TMS=OpenLayers.Class(OpenLayers.Layer.Grid,{serviceVersion:"1.0.0",isBaseLayer:true,tileOrigin:null,serverResolutions:null,zoomOffset:0,initialize:function(d,c,b){var a=[];a.push(d,c,{},b);OpenLayers.Layer.Grid.prototype.initialize.apply(this,a)},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments)},clone:function(a){if(a==null){a=new OpenLayers.Layer.TMS(this.name,this.url,this.getOptions())}a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a]);return a},getURL:function(d){d=this.adjustBounds(d);var c=this.map.getResolution();var a=Math.round((d.left-this.tileOrigin.lon)/(c*this.tileSize.w));var g=Math.round((d.bottom-this.tileOrigin.lat)/(c*this.tileSize.h));var f=this.serverResolutions!=null?OpenLayers.Util.indexOf(this.serverResolutions,c):this.map.getZoom()+this.zoomOffset;var e=this.serviceVersion+"/"+this.layername+"/"+f+"/"+a+"/"+g+"."+this.type;var b=this.url;if(b instanceof Array){b=this.selectUrl(e,b)}return b+e},addTile:function(b,a){return new OpenLayers.Tile.Image(this,a,b,null,this.tileSize)},setMap:function(a){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments);if(!this.tileOrigin){this.tileOrigin=new OpenLayers.LonLat(this.map.maxExtent.left,this.map.maxExtent.bottom)}},CLASS_NAME:"OpenLayers.Layer.TMS"});OpenLayers.Layer.TileCache=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:true,format:"image/png",serverResolutions:null,initialize:function(c,b,d,a){this.layername=d;OpenLayers.Layer.Grid.prototype.initialize.apply(this,[c,b,{},a]);this.extension=this.format.split("/")[1].toLowerCase();this.extension=(this.extension=="jpg")?"jpeg":this.extension},clone:function(a){if(a==null){a=new OpenLayers.Layer.TileCache(this.name,this.url,this.layername,this.getOptions())
}a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a]);return a},getURL:function(b){var f=this.map.getResolution();var g=this.maxExtent;var k=this.tileSize;var a=Math.round((b.left-g.left)/(f*k.w));var j=Math.round((b.bottom-g.bottom)/(f*k.h));var h=this.serverResolutions!=null?OpenLayers.Util.indexOf(this.serverResolutions,f):this.map.getZoom();function e(o,n){o=String(o);var l=[];for(var m=0;m<n;++m){l.push("0")}return l.join("").substring(0,n-o.length)+o}var d=[this.layername,e(h,2),e(parseInt(a/1000000),3),e((parseInt(a/1000)%1000),3),e((parseInt(a)%1000),3),e(parseInt(j/1000000),3),e((parseInt(j/1000)%1000),3),e((parseInt(j)%1000),3)+"."+this.extension];var i=d.join("/");var c=this.url;if(c instanceof Array){c=this.selectUrl(i,c)}c=(c.charAt(c.length-1)=="/")?c:c+"/";return c+i},addTile:function(c,a){var b=this.getURL(c);return new OpenLayers.Tile.Image(this,a,c,b,this.tileSize)},CLASS_NAME:"OpenLayers.Layer.TileCache"});OpenLayers.Layer.WMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{service:"WMS",version:"1.1.1",request:"GetMap",styles:"",exceptions:"application/vnd.ogc.se_inimage",format:"image/jpeg"},reproject:false,isBaseLayer:true,encodeBBOX:false,noMagic:false,yx:{"EPSG:4326":true},initialize:function(d,c,e,b){var a=[];e=OpenLayers.Util.upperCaseObject(e);if(parseFloat(e.VERSION)>=1.3&&!e.EXCEPTIONS){e.EXCEPTIONS="INIMAGE"}a.push(d,c,e,b);OpenLayers.Layer.Grid.prototype.initialize.apply(this,a);OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS));if(!this.noMagic&&this.params.TRANSPARENT&&this.params.TRANSPARENT.toString().toLowerCase()=="true"){if((b==null)||(!b.isBaseLayer)){this.isBaseLayer=false}if(this.params.FORMAT=="image/jpeg"){this.params.FORMAT=OpenLayers.Util.alphaHack()?"image/gif":"image/png"}}},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments)},clone:function(a){if(a==null){a=new OpenLayers.Layer.WMS(this.name,this.url,this.params,this.getOptions())}a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a]);return a},reverseAxisOrder:function(){return(parseFloat(this.params.VERSION)>=1.3&&!!this.yx[this.map.getProjectionObject().getCode()])},getURL:function(c){c=this.adjustBounds(c);var d=this.getImageSize();var e={};var b=this.reverseAxisOrder();e.BBOX=this.encodeBBOX?c.toBBOX(null,b):c.toArray(b);e.WIDTH=d.w;e.HEIGHT=d.h;var a=this.getFullRequestString(e);return a},addTile:function(b,a){return new OpenLayers.Tile.Image(this,a,b,null,this.tileSize)},mergeNewParams:function(c){var b=OpenLayers.Util.upperCaseObject(c);var a=[b];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,a)},getFullRequestString:function(d,b){var a=this.map.getProjection();var c=(a=="none")?null:a;if(parseFloat(this.params.VERSION)>=1.3){this.params.CRS=c}else{this.params.SRS=c}return OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},CLASS_NAME:"OpenLayers.Layer.WMS"});OpenLayers.Layer.WMTS=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:true,version:"1.0.0",requestEncoding:"KVP",url:null,layer:null,matrixSet:null,style:null,format:"image/jpeg",tileOrigin:null,tileFullExtent:null,formatSuffix:null,matrixIds:null,dimensions:null,params:null,zoomOffset:0,formatSuffixMap:{"image/png":"png","image/png8":"png","image/png24":"png","image/png32":"png",png:"png","image/jpeg":"jpg","image/jpg":"jpg",jpeg:"jpg",jpg:"jpg"},matrix:null,initialize:function(c){var f={url:true,layer:true,style:true,matrixSet:true};for(var g in f){if(!(g in c)){throw new Error("Missing property '"+g+"' in layer configuration.")}}c.params=OpenLayers.Util.upperCaseObject(c.params);var b=[c.name,c.url,c.params,c];OpenLayers.Layer.Grid.prototype.initialize.apply(this,b);if(!this.formatSuffix){this.formatSuffix=this.formatSuffixMap[this.format]||this.format.split("/").pop()}if(this.matrixIds){var a=this.matrixIds.length;if(a&&typeof this.matrixIds[0]==="string"){var e=this.matrixIds;this.matrixIds=new Array(a);for(var d=0;d<a;++d){this.matrixIds[d]={identifier:e[d]}
}}}},setMap:function(){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments);this.updateMatrixProperties()},updateMatrixProperties:function(){this.matrix=this.getMatrix();if(this.matrix){if(this.matrix.topLeftCorner){this.tileOrigin=this.matrix.topLeftCorner}if(this.matrix.tileWidth&&this.matrix.tileHeight){this.tileSize=new OpenLayers.Size(this.matrix.tileWidth,this.matrix.tileHeight)}if(!this.tileOrigin){this.tileOrigin=new OpenLayers.LonLat(this.maxExtent.left,this.maxExtent.top)}if(!this.tileFullExtent){this.tileFullExtent=this.maxExtent}}},moveTo:function(b,a,c){if(a||!this.matrix){this.updateMatrixProperties()}return OpenLayers.Layer.Grid.prototype.moveTo.apply(this,arguments)},clone:function(a){if(a==null){a=new OpenLayers.Layer.WMTS(this.options)}a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a]);return a},getMatrix:function(){var b;if(!this.matrixIds||this.matrixIds.length===0){b={identifier:this.map.getZoom()+this.zoomOffset}}else{if("scaleDenominator" in this.matrixIds[0]){var a=OpenLayers.METERS_PER_INCH*OpenLayers.INCHES_PER_UNIT[this.units]*this.map.getResolution()/0.00028;var e=Number.POSITIVE_INFINITY;var f;for(var c=0,d=this.matrixIds.length;c<d;++c){f=Math.abs(1-(this.matrixIds[c].scaleDenominator/a));if(f<e){e=f;b=this.matrixIds[c]}}}else{b=this.matrixIds[this.map.getZoom()+this.zoomOffset]}}return b},getTileInfo:function(f){var b=this.map.getResolution();var d=(f.lon-this.tileOrigin.lon)/(b*this.tileSize.w);var c=(this.tileOrigin.lat-f.lat)/(b*this.tileSize.h);var a=Math.floor(d);var e=Math.floor(c);return{col:a,row:e,i:Math.floor((d-a)*this.tileSize.w),j:Math.floor((c-e)*this.tileSize.h)}},getURL:function(d){d=this.adjustBounds(d);var b="";if(!this.tileFullExtent||this.tileFullExtent.intersectsBounds(d)){var a=d.getCenterLonLat();var f=this.getTileInfo(a);var h=this.matrix.identifier;if(this.requestEncoding.toUpperCase()==="REST"){var e=this.version+"/"+this.layer+"/"+this.style+"/";if(this.dimensions){for(var c=0;c<this.dimensions.length;c++){if(this.params[this.dimensions[c]]){e=e+this.params[this.dimensions[c]]+"/"}}}e=e+this.matrixSet+"/"+this.matrix.identifier+"/"+f.row+"/"+f.col+"."+this.formatSuffix;if(this.url instanceof Array){b=this.selectUrl(e,this.url)}else{b=this.url}if(!b.match(/\/$/)){b=b+"/"}b=b+e}else{if(this.requestEncoding.toUpperCase()==="KVP"){var g={SERVICE:"WMTS",REQUEST:"GetTile",VERSION:this.version,LAYER:this.layer,STYLE:this.style,TILEMATRIXSET:this.matrixSet,TILEMATRIX:this.matrix.identifier,TILEROW:f.row,TILECOL:f.col,FORMAT:this.format};b=OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,[g])}}}return b},mergeNewParams:function(a){if(this.requestEncoding.toUpperCase()==="KVP"){return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,[OpenLayers.Util.upperCaseObject(a)])}},addTile:function(b,a){return new OpenLayers.Tile.Image(this,a,b,null,this.tileSize)},CLASS_NAME:"OpenLayers.Layer.WMTS"});OpenLayers.Layer.WorldWind=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{},isBaseLayer:true,lzd:null,zoomLevels:null,initialize:function(d,c,e,g,f,b){this.lzd=e;this.zoomLevels=g;var a=[];a.push(d,c,f,b);OpenLayers.Layer.Grid.prototype.initialize.apply(this,a);this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS)},addTile:function(b,a){return new OpenLayers.Tile.Image(this,a,b,null,this.tileSize)},getZoom:function(){var b=this.map.getZoom();var a=this.map.getMaxExtent();b=b-Math.log(this.maxResolution/(this.lzd/512))/Math.log(2);return b},getURL:function(e){e=this.adjustBounds(e);var d=this.getZoom();var b=this.map.getMaxExtent();var c=this.lzd/Math.pow(2,this.getZoom());var a=Math.floor((e.left-b.left)/c);var f=Math.floor((e.bottom-b.bottom)/c);if(this.map.getResolution()<=(this.lzd/512)&&this.getZoom()<=this.zoomLevels){return this.getFullRequestString({L:d,X:a,Y:f})}else{return OpenLayers.Util.getImagesLocation()+"blank.gif"}},CLASS_NAME:"OpenLayers.Layer.WorldWind"});OpenLayers.Layer.XYZ=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:true,sphericalMercator:false,zoomOffset:0,initialize:function(d,c,b){if(b&&b.sphericalMercator||this.sphericalMercator){b=OpenLayers.Util.extend({maxExtent:new OpenLayers.Bounds(-128*156543.0339,-128*156543.0339,128*156543.0339,128*156543.0339),maxResolution:156543.0339,numZoomLevels:19,units:"m",projection:"EPSG:900913"},b)
}c=c||this.url;d=d||this.name;var a=[d,c,{},b];OpenLayers.Layer.Grid.prototype.initialize.apply(this,a)},clone:function(a){if(a==null){a=new OpenLayers.Layer.XYZ(this.name,this.url,this.getOptions())}a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a]);return a},getURL:function(e){var c=this.map.getResolution();var a=Math.round((e.left-this.maxExtent.left)/(c*this.tileSize.w));var h=Math.round((this.maxExtent.top-e.top)/(c*this.tileSize.h));var g=this.map.getZoom()+this.zoomOffset;var b=this.url;var d=""+a+h+g;if(b instanceof Array){b=this.selectUrl(d,b)}var f=OpenLayers.String.format(b,{x:a,y:h,z:g});return f},addTile:function(b,a){return new OpenLayers.Tile.Image(this,a,b,null,this.tileSize)},setMap:function(a){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments);if(!this.tileOrigin){this.tileOrigin=new OpenLayers.LonLat(this.maxExtent.left,this.maxExtent.bottom)}},CLASS_NAME:"OpenLayers.Layer.XYZ"});OpenLayers.Layer.OSM=OpenLayers.Class(OpenLayers.Layer.XYZ,{name:"OpenStreetMap",attribution:"Data CC-By-SA by <a href='http://openstreetmap.org/'>OpenStreetMap</a>",sphericalMercator:true,url:"http://tile.openstreetmap.org/${z}/${x}/${y}.png",clone:function(a){if(a==null){a=new OpenLayers.Layer.OSM(this.name,this.url,this.getOptions())}a=OpenLayers.Layer.XYZ.prototype.clone.apply(this,[a]);return a},CLASS_NAME:"OpenLayers.Layer.OSM"});OpenLayers.Layer.Zoomify=OpenLayers.Class(OpenLayers.Layer.Grid,{url:null,size:null,isBaseLayer:true,standardTileSize:256,numberOfTiers:0,tileCountUpToTier:new Array(),tierSizeInTiles:new Array(),tierImageSize:new Array(),initialize:function(d,c,e,b){this.initializeZoomify(e);var a=[];a.push(d,c,e,{},b);OpenLayers.Layer.Grid.prototype.initialize.apply(this,a)},initializeZoomify:function(c){var d=c.clone();var a=new OpenLayers.Size(Math.ceil(d.w/this.standardTileSize),Math.ceil(d.h/this.standardTileSize));this.tierSizeInTiles.push(a);this.tierImageSize.push(d);while(d.w>this.standardTileSize||d.h>this.standardTileSize){d=new OpenLayers.Size(Math.floor(d.w/2),Math.floor(d.h/2));a=new OpenLayers.Size(Math.ceil(d.w/this.standardTileSize),Math.ceil(d.h/this.standardTileSize));this.tierSizeInTiles.push(a);this.tierImageSize.push(d)}this.tierSizeInTiles.reverse();this.tierImageSize.reverse();this.numberOfTiers=this.tierSizeInTiles.length;this.tileCountUpToTier[0]=0;for(var b=1;b<this.numberOfTiers;b++){this.tileCountUpToTier.push(this.tierSizeInTiles[b-1].w*this.tierSizeInTiles[b-1].h+this.tileCountUpToTier[b-1])}},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments);this.tileCountUpToTier.length=0;this.tierSizeInTiles.length=0;this.tierImageSize.length=0},clone:function(a){if(a==null){a=new OpenLayers.Layer.Zoomify(this.name,this.url,this.size,this.options)}a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a]);return a},getURL:function(d){d=this.adjustBounds(d);var c=this.map.getResolution();var a=Math.round((d.left-this.tileOrigin.lon)/(c*this.tileSize.w));var h=Math.round((this.tileOrigin.lat-d.top)/(c*this.tileSize.h));var g=this.map.getZoom();var f=a+h*this.tierSizeInTiles[g].w+this.tileCountUpToTier[g];var e="TileGroup"+Math.floor((f)/256)+"/"+g+"-"+a+"-"+h+".jpg";var b=this.url;if(b instanceof Array){b=this.selectUrl(e,b)}return b+e},getImageSize:function(){if(arguments.length>0){bounds=this.adjustBounds(arguments[0]);var c=this.map.getResolution();var a=Math.round((bounds.left-this.tileOrigin.lon)/(c*this.tileSize.w));var f=Math.round((this.tileOrigin.lat-bounds.top)/(c*this.tileSize.h));var e=this.map.getZoom();var b=this.standardTileSize;var d=this.standardTileSize;if(a==this.tierSizeInTiles[e].w-1){var b=this.tierImageSize[e].w%this.standardTileSize}if(f==this.tierSizeInTiles[e].h-1){var d=this.tierImageSize[e].h%this.standardTileSize}return(new OpenLayers.Size(b,d))}else{return this.tileSize}},addTile:function(b,a){return new OpenLayers.Tile.Image(this,a,b,null,this.tileSize)},setMap:function(a){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments);
this.tileOrigin=new OpenLayers.LonLat(this.map.maxExtent.left,this.map.maxExtent.top)},calculateGridLayout:function(a,o,e){var k=e*this.tileSize.w;var c=e*this.tileSize.h;var i=a.left-o.left;var l=Math.floor(i/k)-this.buffer;var j=i/k-l;var f=-j*this.tileSize.w;var m=o.left+l*k;var b=o.top-a.top+c;var h=Math.floor(b/c)-this.buffer;var n=h-b/c;var d=n*this.tileSize.h;var g=o.top-c*h;return{tilelon:k,tilelat:c,tileoffsetlon:m,tileoffsetlat:g,tileoffsetx:f,tileoffsety:d}},CLASS_NAME:"OpenLayers.Layer.Zoomify"});OpenLayers.Protocol.SQL.Gears=OpenLayers.Class(OpenLayers.Protocol.SQL,{FID_PREFIX:"__gears_fid__",NULL_GEOMETRY:"__gears_null_geometry__",NULL_FEATURE_STATE:"__gears_null_feature_state__",jsonParser:null,wktParser:null,fidRegExp:null,saveFeatureState:true,typeOfFid:"string",db:null,initialize:function(a){if(!this.supported()){return}OpenLayers.Protocol.SQL.prototype.initialize.apply(this,[a]);this.jsonParser=new OpenLayers.Format.JSON();this.wktParser=new OpenLayers.Format.WKT();this.fidRegExp=new RegExp("^"+this.FID_PREFIX);this.initializeDatabase()},initializeDatabase:function(){this.db=google.gears.factory.create("beta.database");this.db.open(this.databaseName);this.db.execute("CREATE TABLE IF NOT EXISTS "+this.tableName+" (fid TEXT UNIQUE, geometry TEXT, properties TEXT,  state TEXT)")},destroy:function(){this.db.close();this.db=null;this.jsonParser=null;this.wktParser=null;OpenLayers.Protocol.SQL.prototype.destroy.apply(this)},supported:function(){return !!(window.google&&google.gears)},read:function(b){OpenLayers.Protocol.prototype.read.apply(this,arguments);b=OpenLayers.Util.applyDefaults(b,this.options);var c,d=[];var a=this.db.execute("SELECT * FROM "+this.tableName);while(a.isValidRow()){c=this.unfreezeFeature(a);if(this.evaluateFilter(c,b.filter)){if(!b.noFeatureStateReset){c.state=null}d.push(c)}a.next()}a.close();var e=new OpenLayers.Protocol.Response({code:OpenLayers.Protocol.Response.SUCCESS,requestType:"read",features:d});if(b&&b.callback){b.callback.call(b.scope,e)}return e},unfreezeFeature:function(d){var a;var b=d.fieldByName("geometry");if(b==this.NULL_GEOMETRY){a=new OpenLayers.Feature.Vector()}else{a=this.wktParser.read(b)}a.attributes=this.jsonParser.read(d.fieldByName("properties"));a.fid=this.extractFidFromField(d.fieldByName("fid"));var c=d.fieldByName("state");if(c==this.NULL_FEATURE_STATE){c=null}a.state=c;return a},extractFidFromField:function(a){if(!a.match(this.fidRegExp)&&this.typeOfFid=="number"){a=parseFloat(a)}return a},create:function(b,a){a=OpenLayers.Util.applyDefaults(a,this.options);var c=this.createOrUpdate(b);c.requestType="create";if(a&&a.callback){a.callback.call(a.scope,c)}return c},update:function(b,a){a=OpenLayers.Util.applyDefaults(a,this.options);var c=this.createOrUpdate(b);c.requestType="update";if(a&&a.callback){a.callback.call(a.scope,c)}return c},createOrUpdate:function(e){if(!(e instanceof Array)){e=[e]}var c,a=e.length,b;var d=new Array(a);for(c=0;c<a;c++){b=e[c];var f=this.freezeFeature(b);this.db.execute("REPLACE INTO "+this.tableName+" (fid, geometry, properties, state) VALUES (?, ?, ?, ?)",f);var g=b.clone();g.fid=this.extractFidFromField(f[0]);d[c]=g}return new OpenLayers.Protocol.Response({code:OpenLayers.Protocol.Response.SUCCESS,features:d,reqFeatures:e})},freezeFeature:function(b){b.fid=b.fid!=null?""+b.fid:OpenLayers.Util.createUniqueID(this.FID_PREFIX);var d=b.geometry!=null?b.geometry.toString():this.NULL_GEOMETRY;var a=this.jsonParser.write(b.attributes);var c=this.getFeatureStateForFreeze(b);return[b.fid,d,a,c]},getFeatureStateForFreeze:function(a){var b;if(!this.saveFeatureState){b=this.NULL_FEATURE_STATE}else{if(this.createdOffline(a)){b=OpenLayers.State.INSERT}else{b=a.state}}return b},"delete":function(f,c){if(!(f instanceof Array)){f=[f]}c=OpenLayers.Util.applyDefaults(c,this.options);var e,a,d;for(e=0,a=f.length;e<a;e++){d=f[e];if(this.saveFeatureState&&!this.createdOffline(d)){var b=d.clone();b.fid=d.fid;if(b.geometry){b.geometry.destroy();b.geometry=null
}b.state=d.state;this.createOrUpdate(b)}else{this.db.execute("DELETE FROM "+this.tableName+" WHERE fid = ?",[d.fid])}}var g=new OpenLayers.Protocol.Response({code:OpenLayers.Protocol.Response.SUCCESS,requestType:"delete",reqFeatures:f});if(c&&c.callback){c.callback.call(c.scope,g)}return g},createdOffline:function(a){return(typeof a.fid=="string"&&!!(a.fid.match(this.fidRegExp)))},commit:function(c,m){var b,e=[],g=0,h=0;function k(i){if(++h<g){i.last=false}this.callUserCallback(m,i)}var l,j=[],a=[],d=[];for(var f=c.length-1;f>=0;f--){l=c[f];switch(l.state){case OpenLayers.State.INSERT:j.push(l);break;case OpenLayers.State.UPDATE:a.push(l);break;case OpenLayers.State.DELETE:d.push(l);break}}if(j.length>0){g++;b=OpenLayers.Util.applyDefaults({callback:k,scope:this},m.create);e.push(this.create(j,b))}if(a.length>0){g++;b=OpenLayers.Util.applyDefaults({callback:k,scope:this},m.update);e.push(this.update(a,b))}if(d.length>0){g++;b=OpenLayers.Util.applyDefaults({callback:k,scope:this},m["delete"]);e.push(this["delete"](d,b))}return e},clear:function(){this.db.execute("DELETE FROM "+this.tableName)},callUserCallback:function(a,c){var b=a[c.requestType];if(b&&b.callback){b.callback.call(b.scope,c)}if(c.last&&a.callback){a.callback.call(a.scope)}},CLASS_NAME:"OpenLayers.Protocol.SQL.Gears"});OpenLayers.Rule=OpenLayers.Class({id:null,name:null,title:null,description:null,context:null,filter:null,elseFilter:false,symbolizer:null,symbolizers:null,minScaleDenominator:null,maxScaleDenominator:null,initialize:function(a){this.symbolizer={};OpenLayers.Util.extend(this,a);if(this.symbolizers){delete this.symbolizer}this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var a in this.symbolizer){this.symbolizer[a]=null}this.symbolizer=null;delete this.symbolizers},evaluate:function(c){var b=this.getContext(c);var a=true;if(this.minScaleDenominator||this.maxScaleDenominator){var d=c.layer.map.getScale()}if(this.minScaleDenominator){a=d>=OpenLayers.Style.createLiteral(this.minScaleDenominator,b)}if(a&&this.maxScaleDenominator){a=d<OpenLayers.Style.createLiteral(this.maxScaleDenominator,b)}if(a&&this.filter){if(this.filter.CLASS_NAME=="OpenLayers.Filter.FeatureId"){a=this.filter.evaluate(c)}else{a=this.filter.evaluate(b)}}return a},getContext:function(b){var a=this.context;if(!a){a=b.attributes||b.data}if(typeof this.context=="function"){a=this.context(b)}return a},clone:function(){var b=OpenLayers.Util.extend({},this);if(this.symbolizers){var a=this.symbolizers.length;b.symbolizers=new Array(a);for(var d=0;d<a;++d){b.symbolizers[d]=this.symbolizers[d].clone()}}else{b.symbolizer={};var f,e;for(var c in this.symbolizer){f=this.symbolizer[c];e=typeof f;if(e==="object"){b.symbolizer[c]=OpenLayers.Util.extend({},f)}else{if(e==="string"){b.symbolizer[c]=f}}}}b.filter=this.filter&&this.filter.clone();b.context=this.context&&OpenLayers.Util.extend({},this.context);return new OpenLayers.Rule(b)},CLASS_NAME:"OpenLayers.Rule"});OpenLayers.StyleMap=OpenLayers.Class({styles:null,extendDefault:true,initialize:function(c,a){this.styles={"default":new OpenLayers.Style(OpenLayers.Feature.Vector.style["default"]),select:new OpenLayers.Style(OpenLayers.Feature.Vector.style.select),temporary:new OpenLayers.Style(OpenLayers.Feature.Vector.style.temporary),"delete":new OpenLayers.Style(OpenLayers.Feature.Vector.style["delete"])};if(c instanceof OpenLayers.Style){this.styles["default"]=c;this.styles.select=c;this.styles.temporary=c;this.styles["delete"]=c}else{if(typeof c=="object"){for(var b in c){if(c[b] instanceof OpenLayers.Style){this.styles[b]=c[b]}else{if(typeof c[b]=="object"){this.styles[b]=new OpenLayers.Style(c[b])}else{this.styles["default"]=new OpenLayers.Style(c);this.styles.select=new OpenLayers.Style(c);this.styles.temporary=new OpenLayers.Style(c);this.styles["delete"]=new OpenLayers.Style(c);break}}}}}OpenLayers.Util.extend(this,a)},destroy:function(){for(var a in this.styles){this.styles[a].destroy()}this.styles=null},createSymbolizer:function(b,c){if(!b){b=new OpenLayers.Feature.Vector()
}if(!this.styles[c]){c="default"}b.renderIntent=c;var a={};if(this.extendDefault&&c!="default"){a=this.styles["default"].createSymbolizer(b)}return OpenLayers.Util.extend(a,this.styles[c].createSymbolizer(b))},addUniqueValueRules:function(b,d,f,a){var e=[];for(var c in f){e.push(new OpenLayers.Rule({symbolizer:f[c],context:a,filter:new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,property:d,value:c})}))}this.styles[b].addRules(e)},CLASS_NAME:"OpenLayers.StyleMap"});OpenLayers.Control.NavToolbar=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(a){OpenLayers.Control.Panel.prototype.initialize.apply(this,[a]);this.addControls([new OpenLayers.Control.Navigation(),new OpenLayers.Control.ZoomBox()])},draw:function(){var a=OpenLayers.Control.Panel.prototype.draw.apply(this,arguments);this.activateControl(this.controls[0]);return a},CLASS_NAME:"OpenLayers.Control.NavToolbar"});OpenLayers.Filter.Comparison=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,matchCase:true,lowerBoundary:null,upperBoundary:null,initialize:function(a){OpenLayers.Filter.prototype.initialize.apply(this,[a])},evaluate:function(c){if(c instanceof OpenLayers.Feature.Vector){c=c.attributes}var a=false;var b=c[this.property];switch(this.type){case OpenLayers.Filter.Comparison.EQUAL_TO:var e=this.value;if(!this.matchCase&&typeof b=="string"&&typeof e=="string"){a=(b.toUpperCase()==e.toUpperCase())}else{a=(b==e)}break;case OpenLayers.Filter.Comparison.NOT_EQUAL_TO:var e=this.value;if(!this.matchCase&&typeof b=="string"&&typeof e=="string"){a=(b.toUpperCase()!=e.toUpperCase())}else{a=(b!=e)}break;case OpenLayers.Filter.Comparison.LESS_THAN:a=b<this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN:a=b>this.value;break;case OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO:a=b<=this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO:a=b>=this.value;break;case OpenLayers.Filter.Comparison.BETWEEN:a=(b>=this.lowerBoundary)&&(b<=this.upperBoundary);break;case OpenLayers.Filter.Comparison.LIKE:var d=new RegExp(this.value,"gi");a=d.test(b);break}return a},value2regex:function(d,b,a){if(d=="."){var c="'.' is an unsupported wildCard character for OpenLayers.Filter.Comparison";OpenLayers.Console.error(c);return null}d=d?d:"*";b=b?b:".";a=a?a:"!";this.value=this.value.replace(new RegExp("\\"+a+"(.|$)","g"),"\\$1");this.value=this.value.replace(new RegExp("\\"+b,"g"),".");this.value=this.value.replace(new RegExp("\\"+d,"g"),".*");this.value=this.value.replace(new RegExp("\\\\.\\*","g"),"\\"+d);this.value=this.value.replace(new RegExp("\\\\\\.","g"),"\\"+b);return this.value},regex2value:function(){var a=this.value;a=a.replace(/!/g,"!!");a=a.replace(/(\\)?\\\./g,function(c,b){return b?c:"!."});a=a.replace(/(\\)?\\\*/g,function(c,b){return b?c:"!*"});a=a.replace(/\\\\/g,"\\");a=a.replace(/\.\*/g,"*");return a},clone:function(){return OpenLayers.Util.extend(new OpenLayers.Filter.Comparison(),this)},CLASS_NAME:"OpenLayers.Filter.Comparison"});OpenLayers.Filter.Comparison.EQUAL_TO="==";OpenLayers.Filter.Comparison.NOT_EQUAL_TO="!=";OpenLayers.Filter.Comparison.LESS_THAN="<";OpenLayers.Filter.Comparison.GREATER_THAN=">";OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO="<=";OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO=">=";OpenLayers.Filter.Comparison.BETWEEN="..";OpenLayers.Filter.Comparison.LIKE="~";OpenLayers.Filter.FeatureId=OpenLayers.Class(OpenLayers.Filter,{fids:null,initialize:function(a){this.fids=[];OpenLayers.Filter.prototype.initialize.apply(this,[a])},evaluate:function(c){for(var b=0,a=this.fids.length;b<a;b++){var d=c.fid||c.id;if(d==this.fids[b]){return true}}return false},clone:function(){var a=new OpenLayers.Filter.FeatureId();OpenLayers.Util.extend(a,this);a.fids=this.fids.slice();return a},CLASS_NAME:"OpenLayers.Filter.FeatureId"});OpenLayers.Filter.Logical=OpenLayers.Class(OpenLayers.Filter,{filters:null,type:null,initialize:function(a){this.filters=[];OpenLayers.Filter.prototype.initialize.apply(this,[a])
},destroy:function(){this.filters=null;OpenLayers.Filter.prototype.destroy.apply(this)},evaluate:function(c){switch(this.type){case OpenLayers.Filter.Logical.AND:for(var b=0,a=this.filters.length;b<a;b++){if(this.filters[b].evaluate(c)==false){return false}}return true;case OpenLayers.Filter.Logical.OR:for(var b=0,a=this.filters.length;b<a;b++){if(this.filters[b].evaluate(c)==true){return true}}return false;case OpenLayers.Filter.Logical.NOT:return(!this.filters[0].evaluate(c))}},clone:function(){var c=[];for(var b=0,a=this.filters.length;b<a;++b){c.push(this.filters[b].clone())}return new OpenLayers.Filter.Logical({type:this.type,filters:c})},CLASS_NAME:"OpenLayers.Filter.Logical"});OpenLayers.Filter.Logical.AND="&&";OpenLayers.Filter.Logical.OR="||";OpenLayers.Filter.Logical.NOT="!";OpenLayers.Filter.Spatial=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,distance:null,distanceUnits:null,initialize:function(a){OpenLayers.Filter.prototype.initialize.apply(this,[a])},evaluate:function(c){var a=false;switch(this.type){case OpenLayers.Filter.Spatial.BBOX:case OpenLayers.Filter.Spatial.INTERSECTS:if(c.geometry){var b=this.value;if(this.value.CLASS_NAME=="OpenLayers.Bounds"){b=this.value.toGeometry()}if(c.geometry.intersects(b)){a=true}}break;default:OpenLayers.Console.error(OpenLayers.i18n("filterEvaluateNotImplemented"));break}return a},clone:function(){var a=OpenLayers.Util.applyDefaults({value:this.value&&this.value.clone&&this.value.clone()},this);return new OpenLayers.Filter.Spatial(a)},CLASS_NAME:"OpenLayers.Filter.Spatial"});OpenLayers.Filter.Spatial.BBOX="BBOX";OpenLayers.Filter.Spatial.INTERSECTS="INTERSECTS";OpenLayers.Filter.Spatial.DWITHIN="DWITHIN";OpenLayers.Filter.Spatial.WITHIN="WITHIN";OpenLayers.Filter.Spatial.CONTAINS="CONTAINS";OpenLayers.Geometry.Collection=OpenLayers.Class(OpenLayers.Geometry,{components:null,componentTypes:null,initialize:function(a){OpenLayers.Geometry.prototype.initialize.apply(this,arguments);this.components=[];if(a!=null){this.addComponents(a)}},destroy:function(){this.components.length=0;this.components=null;OpenLayers.Geometry.prototype.destroy.apply(this,arguments)},clone:function(){var geometry=eval("new "+this.CLASS_NAME+"()");for(var i=0,len=this.components.length;i<len;i++){geometry.addComponent(this.components[i].clone())}OpenLayers.Util.applyDefaults(geometry,this);return geometry},getComponentsString:function(){var b=[];for(var c=0,a=this.components.length;c<a;c++){b.push(this.components[c].toShortString())}return b.join(",")},calculateBounds:function(){this.bounds=null;if(this.components&&this.components.length>0){this.setBounds(this.components[0].getBounds());for(var b=1,a=this.components.length;b<a;b++){this.extendBounds(this.components[b].getBounds())}}},addComponents:function(c){if(!(c instanceof Array)){c=[c]}for(var b=0,a=c.length;b<a;b++){this.addComponent(c[b])}},addComponent:function(b,a){var d=false;if(b){if(this.componentTypes==null||(OpenLayers.Util.indexOf(this.componentTypes,b.CLASS_NAME)>-1)){if(a!=null&&(a<this.components.length)){var e=this.components.slice(0,a);var c=this.components.slice(a,this.components.length);e.push(b);this.components=e.concat(c)}else{this.components.push(b)}b.parent=this;this.clearBounds();d=true}}return d},removeComponents:function(b){if(!(b instanceof Array)){b=[b]}for(var a=b.length-1;a>=0;--a){this.removeComponent(b[a])}},removeComponent:function(a){OpenLayers.Util.removeItem(this.components,a);this.clearBounds()},getLength:function(){var c=0;for(var b=0,a=this.components.length;b<a;b++){c+=this.components[b].getLength()}return c},getArea:function(){var c=0;for(var b=0,a=this.components.length;b<a;b++){c+=this.components[b].getArea()}return c},getGeodesicArea:function(b){var d=0;for(var c=0,a=this.components.length;c<a;c++){d+=this.components[c].getGeodesicArea(b)}return d},getCentroid:function(g){if(!g){return this.components.length&&this.components[0].getCentroid()}var l=this.components.length;if(!l){return false
}var b=[];var c=[];var d=0;var h=Number.MAX_VALUE;var m;for(var k=0;k<l;++k){m=this.components[k];var e=m.getArea();var f=m.getCentroid(true);if(isNaN(e)||isNaN(f.x)||isNaN(f.y)){continue}b.push(e);d+=e;h=(e<h&&e>0)?e:h;c.push(f)}l=b.length;if(d===0){for(var k=0;k<l;++k){b[k]=1}d=b.length}else{for(var k=0;k<l;++k){b[k]/=h}d/=h}var j=0,a=0,f,e;for(var k=0;k<l;++k){f=c[k];e=b[k];j+=f.x*e;a+=f.y*e}return new OpenLayers.Geometry.Point(j/d,a/d)},getGeodesicLength:function(b){var d=0;for(var c=0,a=this.components.length;c<a;c++){d+=this.components[c].getGeodesicLength(b)}return d},move:function(b,d){for(var c=0,a=this.components.length;c<a;c++){this.components[c].move(b,d)}},rotate:function(d,b){for(var c=0,a=this.components.length;c<a;++c){this.components[c].rotate(d,b)}},resize:function(d,a,c){for(var b=0;b<this.components.length;++b){this.components[b].resize(d,a,c)}return this},distanceTo:function(h,j){var c=!(j&&j.edge===false);var a=c&&j&&j.details;var k,d,b;var e=Number.POSITIVE_INFINITY;for(var f=0,g=this.components.length;f<g;++f){k=this.components[f].distanceTo(h,j);b=a?k.distance:k;if(b<e){e=b;d=k;if(e==0){break}}}return d},equals:function(d){var b=true;if(!d||!d.CLASS_NAME||(this.CLASS_NAME!=d.CLASS_NAME)){b=false}else{if(!(d.components instanceof Array)||(d.components.length!=this.components.length)){b=false}else{for(var c=0,a=this.components.length;c<a;++c){if(!this.components[c].equals(d.components[c])){b=false;break}}}}return b},transform:function(e,c){if(e&&c){for(var d=0,a=this.components.length;d<a;d++){var b=this.components[d];b.transform(e,c)}this.bounds=null}return this},intersects:function(d){var b=false;for(var c=0,a=this.components.length;c<a;++c){b=d.intersects(this.components[c]);if(b){break}}return b},getVertices:function(b){var c=[];for(var d=0,a=this.components.length;d<a;++d){Array.prototype.push.apply(c,this.components[d].getVertices(b))}return c},CLASS_NAME:"OpenLayers.Geometry.Collection"});OpenLayers.Geometry.Point=OpenLayers.Class(OpenLayers.Geometry,{x:null,y:null,initialize:function(a,b){OpenLayers.Geometry.prototype.initialize.apply(this,arguments);this.x=parseFloat(a);this.y=parseFloat(b)},clone:function(a){if(a==null){a=new OpenLayers.Geometry.Point(this.x,this.y)}OpenLayers.Util.applyDefaults(a,this);return a},calculateBounds:function(){this.bounds=new OpenLayers.Bounds(this.x,this.y,this.x,this.y)},distanceTo:function(f,j){var d=!(j&&j.edge===false);var a=d&&j&&j.details;var b,e,h,c,g,i;if(f instanceof OpenLayers.Geometry.Point){e=this.x;h=this.y;c=f.x;g=f.y;b=Math.sqrt(Math.pow(e-c,2)+Math.pow(h-g,2));i=!a?b:{x0:e,y0:h,x1:c,y1:g,distance:b}}else{i=f.distanceTo(this,j);if(a){i={x0:i.x1,y0:i.y1,x1:i.x0,y1:i.y0,distance:i.distance}}}return i},equals:function(a){var b=false;if(a!=null){b=((this.x==a.x&&this.y==a.y)||(isNaN(this.x)&&isNaN(this.y)&&isNaN(a.x)&&isNaN(a.y)))}return b},toShortString:function(){return(this.x+", "+this.y)},move:function(a,b){this.x=this.x+a;this.y=this.y+b;this.clearBounds()},rotate:function(d,b){d*=Math.PI/180;var a=this.distanceTo(b);var c=d+Math.atan2(this.y-b.y,this.x-b.x);this.x=b.x+(a*Math.cos(c));this.y=b.y+(a*Math.sin(c));this.clearBounds()},getCentroid:function(){return new OpenLayers.Geometry.Point(this.x,this.y)},resize:function(c,a,b){b=(b==undefined)?1:b;this.x=a.x+(c*b*(this.x-a.x));this.y=a.y+(c*(this.y-a.y));this.clearBounds();return this},intersects:function(b){var a=false;if(b.CLASS_NAME=="OpenLayers.Geometry.Point"){a=this.equals(b)}else{a=b.intersects(this)}return a},transform:function(b,a){if((b&&a)){OpenLayers.Projection.transform(this,b,a);this.bounds=null}return this},getVertices:function(a){return[this]},CLASS_NAME:"OpenLayers.Geometry.Point"});OpenLayers.Geometry.Rectangle=OpenLayers.Class(OpenLayers.Geometry,{x:null,y:null,width:null,height:null,initialize:function(b,d,c,a){OpenLayers.Geometry.prototype.initialize.apply(this,arguments);this.x=b;this.y=d;this.width=c;this.height=a},calculateBounds:function(){this.bounds=new OpenLayers.Bounds(this.x,this.y,this.x+this.width,this.y+this.height)
},getLength:function(){var a=(2*this.width)+(2*this.height);return a},getArea:function(){var a=this.width*this.height;return a},CLASS_NAME:"OpenLayers.Geometry.Rectangle"});OpenLayers.Geometry.Surface=OpenLayers.Class(OpenLayers.Geometry,{initialize:function(){OpenLayers.Geometry.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Geometry.Surface"});OpenLayers.Layer.KaMapCache=OpenLayers.Class(OpenLayers.Layer.KaMap,{IMAGE_EXTENSIONS:{jpeg:"jpg",gif:"gif",png:"png",png8:"png",png24:"png",dithered:"png"},DEFAULT_FORMAT:"jpeg",initialize:function(c,b,d,a){OpenLayers.Layer.KaMap.prototype.initialize.apply(this,arguments);this.extension=this.IMAGE_EXTENSIONS[this.params.i.toLowerCase()||DEFAULT_FORMAT]},getURL:function(a){a=this.adjustBounds(a);var f=this.map.getResolution();var e=Math.round((this.map.getScale()*10000))/10000;var d=Math.round(a.left/f);var c=-Math.round(a.top/f);var i=Math.floor(d/this.tileSize.w/this.params.metaTileSize.w)*this.tileSize.w*this.params.metaTileSize.w;var h=Math.floor(c/this.tileSize.h/this.params.metaTileSize.h)*this.tileSize.h*this.params.metaTileSize.h;var b=this.url;if(b instanceof Array){b=this.selectUrl(paramsString,b)}var g=[b,"/",this.params.map,"/",e,"/",this.params.g.replace(/\s/g,"_"),"/def/t",h,"/l",i,"/t",c,"l",d,".",this.extension];return g.join("")},CLASS_NAME:"OpenLayers.Layer.KaMapCache"});OpenLayers.Layer.MapServer.Untiled=OpenLayers.Class(OpenLayers.Layer.MapServer,{singleTile:true,initialize:function(c,b,e,a){OpenLayers.Layer.MapServer.prototype.initialize.apply(this,arguments);var d="The OpenLayers.Layer.MapServer.Untiled class is deprecated and will be removed in 3.0. Instead, you should use the normal OpenLayers.Layer.MapServer class, passing it the option 'singleTile' as true.";OpenLayers.Console.warn(d)},clone:function(a){if(a==null){a=new OpenLayers.Layer.MapServer.Untiled(this.name,this.url,this.params,this.getOptions())}a=OpenLayers.Layer.MapServer.prototype.clone.apply(this,[a]);return a},CLASS_NAME:"OpenLayers.Layer.MapServer.Untiled"});OpenLayers.Layer.Vector=OpenLayers.Class(OpenLayers.Layer,{EVENT_TYPES:["beforefeatureadded","beforefeaturesadded","featureadded","featuresadded","beforefeatureremoved","beforefeaturesremoved","featureremoved","featuresremoved","beforefeatureselected","featureselected","featureunselected","beforefeaturemodified","featuremodified","afterfeaturemodified","vertexmodified","sketchstarted","sketchmodified","sketchcomplete","refresh"],isBaseLayer:false,isFixed:false,isVector:true,features:null,filter:null,selectedFeatures:null,unrenderedFeatures:null,reportError:true,style:null,styleMap:null,strategies:null,protocol:null,renderers:["SVG","VML","Canvas"],renderer:null,rendererOptions:null,geometryType:null,drawn:false,initialize:function(c,b){this.EVENT_TYPES=OpenLayers.Layer.Vector.prototype.EVENT_TYPES.concat(OpenLayers.Layer.prototype.EVENT_TYPES);OpenLayers.Layer.prototype.initialize.apply(this,arguments);if(!this.renderer||!this.renderer.supported()){this.assignRenderer()}if(!this.renderer||!this.renderer.supported()){this.renderer=null;this.displayError()}if(!this.styleMap){this.styleMap=new OpenLayers.StyleMap()}this.features=[];this.selectedFeatures=[];this.unrenderedFeatures={};if(this.strategies){for(var d=0,a=this.strategies.length;d<a;d++){this.strategies[d].setLayer(this)}}},destroy:function(){if(this.strategies){var c,b,a;for(b=0,a=this.strategies.length;b<a;b++){c=this.strategies[b];if(c.autoDestroy){c.destroy()}}this.strategies=null}if(this.protocol){if(this.protocol.autoDestroy){this.protocol.destroy()}this.protocol=null}this.destroyFeatures();this.features=null;this.selectedFeatures=null;this.unrenderedFeatures=null;if(this.renderer){this.renderer.destroy()}this.renderer=null;this.geometryType=null;this.drawn=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(e){if(e==null){e=new OpenLayers.Layer.Vector(this.name,this.getOptions())}e=OpenLayers.Layer.prototype.clone.apply(this,[e]);var c=this.features;
var a=c.length;var d=new Array(a);for(var b=0;b<a;++b){d[b]=c[b].clone()}e.features=d;return e},refresh:function(a){if(this.calculateInRange()&&this.visibility){this.events.triggerEvent("refresh",a)}},assignRenderer:function(){for(var c=0,a=this.renderers.length;c<a;c++){var b=this.renderers[c];var d=(typeof b=="function")?b:OpenLayers.Renderer[b];if(d&&d.prototype.supported()){this.renderer=new d(this.div,this.rendererOptions);break}}},displayError:function(){if(this.reportError){OpenLayers.Console.userError(OpenLayers.i18n("browserNotSupported",{renderers:this.renderers.join("\n")}))}},setMap:function(a){OpenLayers.Layer.prototype.setMap.apply(this,arguments);if(!this.renderer){this.map.removeLayer(this)}else{this.renderer.map=this.map;this.renderer.setSize(this.map.getSize())}},afterAdd:function(){if(this.strategies){var c,b,a;for(b=0,a=this.strategies.length;b<a;b++){c=this.strategies[b];if(c.autoActivate){c.activate()}}}},removeMap:function(c){this.drawn=false;if(this.strategies){var d,b,a;for(b=0,a=this.strategies.length;b<a;b++){d=this.strategies[b];if(d.autoActivate){d.deactivate()}}}},onMapResize:function(){OpenLayers.Layer.prototype.onMapResize.apply(this,arguments);this.renderer.setSize(this.map.getSize())},moveTo:function(g,b,h){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var e=true;if(!h){this.renderer.root.style.visibility="hidden";this.div.style.left=-parseInt(this.map.layerContainerDiv.style.left)+"px";this.div.style.top=-parseInt(this.map.layerContainerDiv.style.top)+"px";var f=this.map.getExtent();e=this.renderer.setExtent(f,b);this.renderer.root.style.visibility="visible";if(navigator.userAgent.toLowerCase().indexOf("gecko")!=-1){this.div.scrollLeft=this.div.scrollLeft}if(!b&&e){for(var d in this.unrenderedFeatures){var c=this.unrenderedFeatures[d];this.drawFeature(c)}}}if(!this.drawn||b||!e){this.drawn=true;var c;for(var d=0,a=this.features.length;d<a;d++){this.renderer.locked=(d!==(a-1));c=this.features[d];this.drawFeature(c)}}},display:function(a){OpenLayers.Layer.prototype.display.apply(this,arguments);var b=this.div.style.display;if(b!=this.renderer.root.style.display){this.renderer.root.style.display=b}},addFeatures:function(b,k){if(!(b instanceof Array)){b=[b]}var h=!k||!k.silent;if(h){var a={features:b};var g=this.events.triggerEvent("beforefeaturesadded",a);if(g===false){return}b=a.features}var d=[];for(var c=0,f=b.length;c<f;c++){if(c!=(b.length-1)){this.renderer.locked=true}else{this.renderer.locked=false}var j=b[c];if(this.geometryType&&!(j.geometry instanceof this.geometryType)){var e=OpenLayers.i18n("componentShouldBe",{geomType:this.geometryType.prototype.CLASS_NAME});throw e}j.layer=this;if(!j.style&&this.style){j.style=OpenLayers.Util.extend({},this.style)}if(h){if(this.events.triggerEvent("beforefeatureadded",{feature:j})===false){continue}this.preFeatureInsert(j)}d.push(j);this.features.push(j);this.drawFeature(j);if(h){this.events.triggerEvent("featureadded",{feature:j});this.onFeatureInsert(j)}}if(h){this.events.triggerEvent("featuresadded",{features:d})}},removeFeatures:function(e,a){if(!e||e.length===0){return}if(e===this.features){return this.removeAllFeatures(a)}if(!(e instanceof Array)){e=[e]}if(e===this.selectedFeatures){e=e.slice()}var d=!a||!a.silent;if(d){this.events.triggerEvent("beforefeaturesremoved",{features:e})}for(var c=e.length-1;c>=0;c--){if(c!=0&&e[c-1].geometry){this.renderer.locked=true}else{this.renderer.locked=false}var b=e[c];delete this.unrenderedFeatures[b.id];if(d){this.events.triggerEvent("beforefeatureremoved",{feature:b})}this.features=OpenLayers.Util.removeItem(this.features,b);b.layer=null;if(b.geometry){this.renderer.eraseFeatures(b)}if(OpenLayers.Util.indexOf(this.selectedFeatures,b)!=-1){OpenLayers.Util.removeItem(this.selectedFeatures,b)}if(d){this.events.triggerEvent("featureremoved",{feature:b})}}if(d){this.events.triggerEvent("featuresremoved",{features:e})}},removeAllFeatures:function(a){var d=!a||!a.silent;var e=this.features;if(d){this.events.triggerEvent("beforefeaturesremoved",{features:e})
}var c;for(var b=e.length-1;b>=0;b--){c=e[b];if(d){this.events.triggerEvent("beforefeatureremoved",{feature:c})}c.layer=null;if(d){this.events.triggerEvent("featureremoved",{feature:c})}}this.renderer.clear();this.features=[];this.unrenderedFeatures={};this.selectedFeatures=[];if(d){this.events.triggerEvent("featuresremoved",{features:e})}},destroyFeatures:function(d,a){var c=(d==undefined);if(c){d=this.features}if(d){this.removeFeatures(d,a);for(var b=d.length-1;b>=0;b--){d[b].destroy()}}},drawFeature:function(a,b){if(!this.drawn){return}if(typeof b!="object"){if(!b&&a.state===OpenLayers.State.DELETE){b="delete"}var c=b||a.renderIntent;b=a.style||this.style;if(!b){b=this.styleMap.createSymbolizer(a,c)}}if(!this.renderer.drawFeature(a,b)){this.unrenderedFeatures[a.id]=a}else{delete this.unrenderedFeatures[a.id]}},eraseFeatures:function(a){this.renderer.eraseFeatures(a)},getFeatureFromEvent:function(a){if(!this.renderer){OpenLayers.Console.error(OpenLayers.i18n("getFeatureError"));return null}var b=this.renderer.getFeatureIdFromEvent(a);return this.getFeatureById(b)},getFeatureBy:function(e,d){var c=null;for(var b=0,a=this.features.length;b<a;++b){if(this.features[b][e]==d){c=this.features[b];break}}return c},getFeatureById:function(a){return this.getFeatureBy("id",a)},getFeatureByFid:function(a){return this.getFeatureBy("fid",a)},onFeatureInsert:function(a){},preFeatureInsert:function(a){},getDataExtent:function(){var b=null;var d=this.features;if(d&&(d.length>0)){b=new OpenLayers.Bounds();var e=null;for(var c=0,a=d.length;c<a;c++){e=d[c].geometry;if(e){b.extend(e.getBounds())}}}return b},CLASS_NAME:"OpenLayers.Layer.Vector"});OpenLayers.Layer.WMS.Post=OpenLayers.Class(OpenLayers.Layer.WMS,{tileClass:null,unsupportedBrowsers:["mozilla","firefox","opera"],SUPPORTED_TRANSITIONS:[],initialize:function(d,c,e,b){var a=[];a.push(d,c,e,b);OpenLayers.Layer.WMS.prototype.initialize.apply(this,a);this.tileClass=OpenLayers.Util.indexOf(this.unsupportedBrowsers,OpenLayers.Util.getBrowserName())!=-1?OpenLayers.Tile.Image:OpenLayers.Tile.Image.IFrame},addTile:function(b,a){return new this.tileClass(this,a,b,null,this.tileSize)},CLASS_NAME:"OpenLayers.Layer.WMS.Post"});OpenLayers.Layer.WMS.Untiled=OpenLayers.Class(OpenLayers.Layer.WMS,{singleTile:true,initialize:function(c,b,e,a){OpenLayers.Layer.WMS.prototype.initialize.apply(this,arguments);var d="The OpenLayers.Layer.WMS.Untiled class is deprecated and will be removed in 3.0. Instead, you should use the normal OpenLayers.Layer.WMS class, passing it the option 'singleTile' as true.";OpenLayers.Console.warn(d)},clone:function(a){if(a==null){a=new OpenLayers.Layer.WMS.Untiled(this.name,this.url,this.params,this.getOptions())}a=OpenLayers.Layer.WMS.prototype.clone.apply(this,[a]);return a},CLASS_NAME:"OpenLayers.Layer.WMS.Untiled"});OpenLayers.Strategy.Filter=OpenLayers.Class(OpenLayers.Strategy,{filter:null,cache:null,caching:false,initialize:function(a){OpenLayers.Strategy.prototype.initialize.apply(this,[a]);if(!this.filter||!(this.filter instanceof OpenLayers.Filter)){throw new Error("Filter strategy must be constructed with a filter")}},activate:function(){var a=OpenLayers.Strategy.prototype.activate.apply(this,arguments);if(a){this.cache=[];this.layer.events.on({beforefeaturesadded:this.handleAdd,beforefeaturesremoved:this.handleRemove,scope:this})}return a},deactivate:function(){this.cache=null;if(this.layer&&this.layer.events){this.layer.events.un({beforefeaturesadded:this.handleAdd,beforefeaturesremoved:this.handleRemove,scope:this})}return OpenLayers.Strategy.prototype.deactivate.apply(this,arguments)},handleAdd:function(e){if(!this.caching){var d=e.features;e.features=[];var b;for(var a=0,c=d.length;a<c;++a){b=d[a];if(this.filter.evaluate(b)){e.features.push(b)}else{this.cache.push(b)}}}},handleRemove:function(a){if(!this.caching){this.cache=[]}},setFilter:function(a){this.filter=a;var c=this.cache;this.cache=[];this.handleAdd({features:this.layer.features});if(this.cache.length>0){this.caching=true;
this.layer.removeFeatures(this.cache.slice(),{silent:true});this.caching=false}if(c.length>0){var b={features:c};this.handleAdd(b);this.caching=true;this.layer.addFeatures(b.features,{silent:true});this.caching=false}},CLASS_NAME:"OpenLayers.Strategy.Filter"});OpenLayers.Style2=OpenLayers.Class({id:null,name:null,title:null,description:null,layerName:null,isDefault:false,rules:null,initialize:function(a){OpenLayers.Util.extend(this,a);this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var b=0,a=this.rules.length;b<a;b++){this.rules[b].destroy()}delete this.rules},clone:function(){var b=OpenLayers.Util.extend({},this);if(this.rules){b.rules=[];for(var c=0,a=this.rules.length;c<a;++c){b.rules.push(this.rules[c].clone())}}return new OpenLayers.Style2(b)},CLASS_NAME:"OpenLayers.Style2"});OpenLayers.Control.GetFeature=OpenLayers.Class(OpenLayers.Control,{protocol:null,multipleKey:null,toggleKey:null,modifiers:null,multiple:false,click:true,single:true,clickout:true,toggle:false,clickTolerance:5,hover:false,box:false,maxFeatures:10,features:null,hoverFeature:null,handlerOptions:null,handlers:null,hoverResponse:null,filterType:OpenLayers.Filter.Spatial.BBOX,EVENT_TYPES:["featureselected","featuresselected","featureunselected","clickout","beforefeatureselected","beforefeaturesselected","hoverfeature","outfeature"],initialize:function(a){this.EVENT_TYPES=OpenLayers.Control.GetFeature.prototype.EVENT_TYPES.concat(OpenLayers.Control.prototype.EVENT_TYPES);a.handlerOptions=a.handlerOptions||{};OpenLayers.Control.prototype.initialize.apply(this,[a]);this.features={};this.handlers={};if(this.click){this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.selectClick},this.handlerOptions.click||{})}if(this.box){this.handlers.box=new OpenLayers.Handler.Box(this,{done:this.selectBox},OpenLayers.Util.extend(this.handlerOptions.box,{boxDivClassName:"olHandlerBoxSelectFeature"}))}if(this.hover){this.handlers.hover=new OpenLayers.Handler.Hover(this,{move:this.cancelHover,pause:this.selectHover},OpenLayers.Util.extend(this.handlerOptions.hover,{delay:250}))}},activate:function(){if(!this.active){for(var a in this.handlers){this.handlers[a].activate()}}return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){if(this.active){for(var a in this.handlers){this.handlers[a].deactivate()}}return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},selectClick:function(a){var b=this.pixelToBounds(a.xy);this.setModifiers(a);this.request(b,{single:this.single})},selectBox:function(a){var c;if(a instanceof OpenLayers.Bounds){var d=this.map.getLonLatFromPixel(new OpenLayers.Pixel(a.left,a.bottom));var b=this.map.getLonLatFromPixel(new OpenLayers.Pixel(a.right,a.top));c=new OpenLayers.Bounds(d.lon,d.lat,b.lon,b.lat)}else{if(this.click){return}c=this.pixelToBounds(a)}this.setModifiers(this.handlers.box.dragHandler.evt);this.request(c)},selectHover:function(a){var b=this.pixelToBounds(a.xy);this.request(b,{single:true,hover:true})},cancelHover:function(){if(this.hoverResponse){this.protocol.abort(this.hoverResponse);this.hoverResponse=null;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait")}},request:function(d,b){b=b||{};var c=new OpenLayers.Filter.Spatial({type:this.filterType,value:d});OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait");var a=this.protocol.read({maxFeatures:b.single==true?this.maxFeatures:undefined,filter:c,callback:function(e){if(e.success()){if(e.features.length){if(b.single==true){this.selectBestFeature(e.features,d.getCenterLonLat(),b)}else{this.select(e.features)}}else{if(b.hover){this.hoverSelect()}else{this.events.triggerEvent("clickout");if(this.clickout){this.unselectAll()}}}}OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait")},scope:this});if(b.hover==true){this.hoverResponse=a}},selectBestFeature:function(b,a,j){j=j||{};if(b.length){var g=new OpenLayers.Geometry.Point(a.lon,a.lat);var h,d,e;var f=Number.MAX_VALUE;
for(var c=0;c<b.length;++c){h=b[c];if(h.geometry){e=g.distanceTo(h.geometry,{edge:false});if(e<f){f=e;d=h;if(f==0){break}}}}if(j.hover==true){this.hoverSelect(d)}else{this.select(d||b)}}},setModifiers:function(a){this.modifiers={multiple:this.multiple||(this.multipleKey&&a[this.multipleKey]),toggle:this.toggle||(this.toggleKey&&a[this.toggleKey])}},select:function(e){if(!this.modifiers.multiple&&!this.modifiers.toggle){this.unselectAll()}if(!(e instanceof Array)){e=[e]}var b=this.events.triggerEvent("beforefeaturesselected",{features:e});if(b!==false){var f=[];var d;for(var c=0,a=e.length;c<a;++c){d=e[c];if(this.features[d.fid||d.id]){if(this.modifiers.toggle){this.unselect(this.features[d.fid||d.id])}}else{b=this.events.triggerEvent("beforefeatureselected",{feature:d});if(b!==false){this.features[d.fid||d.id]=d;f.push(d);this.events.triggerEvent("featureselected",{feature:d})}}}this.events.triggerEvent("featuresselected",{features:f})}},hoverSelect:function(a){var c=a?a.fid||a.id:null;var b=this.hoverFeature?this.hoverFeature.fid||this.hoverFeature.id:null;if(b&&b!=c){this.events.triggerEvent("outfeature",{feature:this.hoverFeature});this.hoverFeature=null}if(c&&c!=b){this.events.triggerEvent("hoverfeature",{feature:a});this.hoverFeature=a}},unselect:function(a){delete this.features[a.fid||a.id];this.events.triggerEvent("featureunselected",{feature:a})},unselectAll:function(){for(var a in this.features){this.unselect(this.features[a])}},setMap:function(b){for(var a in this.handlers){this.handlers[a].setMap(b)}OpenLayers.Control.prototype.setMap.apply(this,arguments)},pixelToBounds:function(b){var e=b.add(-this.clickTolerance/2,this.clickTolerance/2);var a=b.add(this.clickTolerance/2,-this.clickTolerance/2);var c=this.map.getLonLatFromPixel(e);var d=this.map.getLonLatFromPixel(a);return new OpenLayers.Bounds(c.lon,c.lat,d.lon,d.lat)},CLASS_NAME:"OpenLayers.Control.GetFeature"});OpenLayers.Control.Snapping=OpenLayers.Class(OpenLayers.Control,{EVENT_TYPES:["beforesnap","snap","unsnap"],DEFAULTS:{tolerance:10,node:true,edge:true,vertex:true},greedy:true,precedence:["node","vertex","edge"],resolution:null,geoToleranceCache:null,layer:null,feature:null,point:null,initialize:function(a){Array.prototype.push.apply(this.EVENT_TYPES,OpenLayers.Control.prototype.EVENT_TYPES);OpenLayers.Control.prototype.initialize.apply(this,[a]);this.options=a||{};if(this.options.layer){this.setLayer(this.options.layer)}var b=OpenLayers.Util.extend({},this.options.defaults);this.defaults=OpenLayers.Util.applyDefaults(b,this.DEFAULTS);this.setTargets(this.options.targets);if(this.targets.length===0&&this.layer){this.addTargetLayer(this.layer)}this.geoToleranceCache={}},setLayer:function(a){if(this.active){this.deactivate();this.layer=a;this.activate()}else{this.layer=a}},setTargets:function(b){this.targets=[];if(b&&b.length){var d;for(var c=0,a=b.length;c<a;++c){d=b[c];if(d instanceof OpenLayers.Layer.Vector){this.addTargetLayer(d)}else{this.addTarget(d)}}}},addTargetLayer:function(a){this.addTarget({layer:a})},addTarget:function(a){a=OpenLayers.Util.applyDefaults(a,this.defaults);a.nodeTolerance=a.nodeTolerance||a.tolerance;a.vertexTolerance=a.vertexTolerance||a.tolerance;a.edgeTolerance=a.edgeTolerance||a.tolerance;this.targets.push(a)},removeTargetLayer:function(b){var c;for(var a=this.targets.length-1;a>=0;--a){c=this.targets[a];if(c.layer===b){this.removeTarget(c)}}},removeTarget:function(a){return OpenLayers.Util.removeItem(this.targets,a)},activate:function(){var a=OpenLayers.Control.prototype.activate.call(this);if(a){if(this.layer&&this.layer.events){this.layer.events.on({sketchstarted:this.onSketchModified,sketchmodified:this.onSketchModified,vertexmodified:this.onVertexModified,scope:this})}}return a},deactivate:function(){var a=OpenLayers.Control.prototype.deactivate.call(this);if(a){if(this.layer&&this.layer.events){this.layer.events.un({sketchstarted:this.onSketchModified,sketchmodified:this.onSketchModified,vertexmodified:this.onVertexModified,scope:this})
}}this.feature=null;this.point=null;return a},onSketchModified:function(a){this.feature=a.feature;this.considerSnapping(a.vertex,a.vertex)},onVertexModified:function(a){this.feature=a.feature;var b=this.layer.map.getLonLatFromViewPortPx(a.pixel);this.considerSnapping(a.vertex,new OpenLayers.Geometry.Point(b.lon,b.lat))},considerSnapping:function(h,d){var a={rank:Number.POSITIVE_INFINITY,dist:Number.POSITIVE_INFINITY,x:null,y:null};var c=false;var j,f;for(var b=0,e=this.targets.length;b<e;++b){f=this.targets[b];j=this.testTarget(f,d);if(j){if(this.greedy){a=j;a.target=f;c=true;break}else{if((j.rank<a.rank)||(j.rank===a.rank&&j.dist<a.dist)){a=j;a.target=f;c=true}}}}if(c){var g=this.events.triggerEvent("beforesnap",{point:h,x:a.x,y:a.y,distance:a.dist,layer:a.target.layer,snapType:this.precedence[a.rank]});if(g!==false){h.x=a.x;h.y=a.y;this.point=h;this.events.triggerEvent("snap",{point:h,snapType:this.precedence[a.rank],layer:a.target.layer,distance:a.dist})}else{c=false}}if(this.point&&!c){h.x=d.x;h.y=d.y;this.point=null;this.events.triggerEvent("unsnap",{point:h})}},testTarget:function(y,f){var w={node:this.getGeoTolerance(y.nodeTolerance),vertex:this.getGeoTolerance(y.vertexTolerance),edge:this.getGeoTolerance(y.edgeTolerance)};var g=Math.max(w.node,w.vertex,w.edge);var h={rank:Number.POSITIVE_INFINITY,dist:Number.POSITIVE_INFINITY};var e=false;var c=y.layer.features;var b,a,d,x,o,p,n;var m=this.precedence.length;var l=new OpenLayers.LonLat(f.x,f.y);for(var u=0,v=c.length;u<v;++u){b=c[u];if(b!==this.feature&&!b._sketch&&b.state!==OpenLayers.State.DELETE&&(!y.filter||y.filter.evaluate(b.attributes))){if(b.atPoint(l,g,g)){for(var t=0,q=Math.min(h.rank+1,m);t<q;++t){a=this.precedence[t];if(y[a]){if(a==="edge"){o=b.geometry.distanceTo(f,{details:true});p=o.distance;if(p<=w[a]&&p<h.dist){h={rank:t,dist:p,x:o.x0,y:o.y0};e=true;break}}else{d=b.geometry.getVertices(a==="node");n=false;for(var s=0,r=d.length;s<r;++s){x=d[s];p=x.distanceTo(f);if(p<=w[a]&&(t<h.rank||(t===h.rank&&p<h.dist))){h={rank:t,dist:p,x:x.x,y:x.y};e=true;n=true}}if(n){break}}}}}}}return e?h:null},getGeoTolerance:function(a){var b=this.layer.map.getResolution();if(b!==this.resolution){this.resolution=b;this.geoToleranceCache={}}var c=this.geoToleranceCache[a];if(c===undefined){c=a*b;this.geoToleranceCache[a]=c}return c},destroy:function(){if(this.active){this.deactivate()}delete this.layer;delete this.targets;OpenLayers.Control.prototype.destroy.call(this)},CLASS_NAME:"OpenLayers.Control.Snapping"});OpenLayers.Format.Filter=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:"1.0.0",version:null,parser:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},write:function(c,b){var a=(b&&b.version)||this.version||this.defaultVersion;if(!this.parser||this.parser.VERSION!=a){var d=OpenLayers.Format.Filter["v"+a.replace(/\./g,"_")];if(!d){throw"Can't find a Filter parser for version "+a}this.parser=new d(this.options)}return this.parser.write(c)},read:function(c){if(typeof c=="string"){c=OpenLayers.Format.XML.prototype.read.apply(this,[c])}var a=this.version;if(!a){a=this.defaultVersion}if(!this.parser||this.parser.VERSION!=a){var d=OpenLayers.Format.Filter["v"+a.replace(/\./g,"_")];if(!d){throw"Can't find a Filter parser for version "+a}this.parser=new d(this.options)}var b=this.parser.read(c);return b},CLASS_NAME:"OpenLayers.Format.Filter"});OpenLayers.Format.SLD=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:"1.0.0",version:null,namedLayersAsArray:false,parser:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},write:function(d,c){var b=(c&&c.version)||this.version||this.defaultVersion;if(!this.parser||this.parser.VERSION!=b){var e=OpenLayers.Format.SLD["v"+b.replace(/\./g,"_")];if(!e){throw"Can't find a SLD parser for version "+b}this.parser=new e(this.options)}var a=this.parser.write(d);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},read:function(e,c){if(typeof e=="string"){e=OpenLayers.Format.XML.prototype.read.apply(this,[e])
}var b=e.documentElement;var a=this.version;if(!a){a=b.getAttribute("version");if(!a){a=this.defaultVersion}}if(!this.parser||this.parser.VERSION!=a){var f=OpenLayers.Format.SLD["v"+a.replace(/\./g,"_")];if(!f){throw"Can't find a SLD parser for version "+a}this.parser=new f(this.options)}var d=this.parser.read(e,c);return d},CLASS_NAME:"OpenLayers.Format.SLD"});OpenLayers.Format.Text=OpenLayers.Class(OpenLayers.Format,{defaultStyle:null,extractStyles:true,initialize:function(a){a=a||{};if(a.extractStyles!==false){a.defaultStyle={externalGraphic:OpenLayers.Util.getImagesLocation()+"marker.png",graphicWidth:21,graphicHeight:25,graphicXOffset:-10.5,graphicYOffset:-12.5}}OpenLayers.Format.prototype.initialize.apply(this,[a])},read:function(j){var a=j.split("\n");var b;var g=[];for(var t=0;t<(a.length-1);t++){var s=a[t].replace(/^\s*/,"").replace(/\s*$/,"");if(s.charAt(0)!="#"){if(!b){b=s.split("\t")}else{var l=s.split("\t");var d=new OpenLayers.Geometry.Point(0,0);var h={};var p=this.defaultStyle?OpenLayers.Util.applyDefaults({},this.defaultStyle):null;var q,r,c,n;var k=false;for(var i=0;i<l.length;i++){if(l[i]){if(b[i]=="point"){var o=l[i].split(",");d.y=parseFloat(o[0]);d.x=parseFloat(o[1]);k=true}else{if(b[i]=="lat"){d.y=parseFloat(l[i]);k=true}else{if(b[i]=="lon"){d.x=parseFloat(l[i]);k=true}else{if(b[i]=="title"){h.title=l[i]}else{if(b[i]=="image"||b[i]=="icon"&&p){p.externalGraphic=l[i]}else{if(b[i]=="iconSize"&&p){var m=l[i].split(",");p.graphicWidth=parseFloat(m[0]);p.graphicHeight=parseFloat(m[1])}else{if(b[i]=="iconOffset"&&p){var f=l[i].split(",");p.graphicXOffset=parseFloat(f[0]);p.graphicYOffset=parseFloat(f[1])}else{if(b[i]=="description"){h.description=l[i]}else{if(b[i]=="overflow"){h.overflow=l[i]}else{h[b[i]]=l[i]}}}}}}}}}}}if(k){if(this.internalProjection&&this.externalProjection){d.transform(this.externalProjection,this.internalProjection)}var e=new OpenLayers.Feature.Vector(d,h,p);g.push(e)}}}}return g},CLASS_NAME:"OpenLayers.Format.Text"});OpenLayers.Geometry.MultiPoint=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Point"],initialize:function(a){OpenLayers.Geometry.Collection.prototype.initialize.apply(this,arguments)},addPoint:function(a,b){this.addComponent(a,b)},removePoint:function(a){this.removeComponent(a)},CLASS_NAME:"OpenLayers.Geometry.MultiPoint"});OpenLayers.Handler.Point=OpenLayers.Class(OpenLayers.Handler,{point:null,layer:null,multi:false,drawing:false,mouseDown:false,lastDown:null,lastUp:null,persist:false,layerOptions:null,initialize:function(c,b,a){if(!(a&&a.layerOptions&&a.layerOptions.styleMap)){this.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style["default"],{})}OpenLayers.Handler.prototype.initialize.apply(this,arguments)},activate:function(){if(!OpenLayers.Handler.prototype.activate.apply(this,arguments)){return false}var a=OpenLayers.Util.extend({displayInLayerSwitcher:false,calculateInRange:OpenLayers.Function.True},this.layerOptions);this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,a);this.map.addLayer(this.layer);return true},createFeature:function(a){var b=this.map.getLonLatFromPixel(a);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(b.lon,b.lat));this.callback("create",[this.point.geometry,this.point]);this.point.geometry.clearBounds();this.layer.addFeatures([this.point],{silent:true})},deactivate:function(){if(!OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){return false}if(this.drawing){this.cancel()}this.destroyFeature();if(this.layer.map!=null){this.layer.destroy(false)}this.layer=null;return true},destroyFeature:function(){if(this.layer){this.layer.destroyFeatures()}this.point=null},finalize:function(b){var a=b?"cancel":"done";this.drawing=false;this.mouseDown=false;this.lastDown=null;this.lastUp=null;this.callback(a,[this.geometryClone()]);if(b||!this.persist){this.destroyFeature()}},cancel:function(){this.finalize(true)},click:function(a){OpenLayers.Event.stop(a);return false},dblclick:function(a){OpenLayers.Event.stop(a);
return false},modifyFeature:function(a){var b=this.map.getLonLatFromPixel(a);this.point.geometry.x=b.lon;this.point.geometry.y=b.lat;this.callback("modify",[this.point.geometry,this.point]);this.point.geometry.clearBounds();this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.point,this.style)},getGeometry:function(){var a=this.point&&this.point.geometry;if(a&&this.multi){a=new OpenLayers.Geometry.MultiPoint([a])}return a},geometryClone:function(){var a=this.getGeometry();return a&&a.clone()},mousedown:function(a){if(!this.checkModifiers(a)){return true}if(this.lastDown&&this.lastDown.equals(a.xy)){return true}this.drawing=true;if(this.lastDown==null){if(this.persist){this.destroyFeature()}this.createFeature(a.xy)}else{this.modifyFeature(a.xy)}this.lastDown=a.xy;return false},mousemove:function(a){if(this.drawing){this.modifyFeature(a.xy)}return true},mouseup:function(a){if(this.drawing){this.finalize();return false}else{return true}},CLASS_NAME:"OpenLayers.Handler.Point"});OpenLayers.Layer.GML=OpenLayers.Class(OpenLayers.Layer.Vector,{loaded:false,format:null,formatOptions:null,initialize:function(d,c,b){var a=[];a.push(d,b);OpenLayers.Layer.Vector.prototype.initialize.apply(this,a);this.url=c},setVisibility:function(a,b){OpenLayers.Layer.Vector.prototype.setVisibility.apply(this,arguments);if(this.visibility&&!this.loaded){this.loadGML()}},moveTo:function(c,a,b){OpenLayers.Layer.Vector.prototype.moveTo.apply(this,arguments);if(this.visibility&&!this.loaded){this.loadGML()}},loadGML:function(){if(!this.loaded){this.events.triggerEvent("loadstart");OpenLayers.Request.GET({url:this.url,success:this.requestSuccess,failure:this.requestFailure,scope:this});this.loaded=true}},setUrl:function(a){this.url=a;this.destroyFeatures();this.loaded=false;this.loadGML()},requestSuccess:function(c){var d=c.responseXML;if(!d||!d.documentElement){d=c.responseText}var a={};OpenLayers.Util.extend(a,this.formatOptions);if(this.map&&!this.projection.equals(this.map.getProjectionObject())){a.externalProjection=this.projection;a.internalProjection=this.map.getProjectionObject()}var b=this.format?new this.format(a):new OpenLayers.Format.GML(a);this.addFeatures(b.read(d));this.events.triggerEvent("loadend")},requestFailure:function(a){OpenLayers.Console.userError(OpenLayers.i18n("errorLoadingGML",{url:this.url}));this.events.triggerEvent("loadend")},CLASS_NAME:"OpenLayers.Layer.GML"});OpenLayers.Layer.PointTrack=OpenLayers.Class(OpenLayers.Layer.Vector,{dataFrom:null,initialize:function(b,a){OpenLayers.Layer.Vector.prototype.initialize.apply(this,arguments)},addNodes:function(f){if(f.length<2){OpenLayers.Console.error("At least two point features have to be added to createa line from");return}var k=new Array(f.length-1);var g,a,h;for(var c=0,e=f.length;c<e;c++){g=f[c];h=g.geometry;if(!h){var d=g.lonlat;h=new OpenLayers.Geometry.Point(d.lon,d.lat)}else{if(h.CLASS_NAME!="OpenLayers.Geometry.Point"){OpenLayers.Console.error("Only features with point geometries are supported.");return}}if(c>0){var b=(this.dataFrom!=null)?(f[c+this.dataFrom].data||f[c+this.dataFrom].attributes):null;var j=new OpenLayers.Geometry.LineString([a,h]);k[c-1]=new OpenLayers.Feature.Vector(j,b)}a=h}this.addFeatures(k)},CLASS_NAME:"OpenLayers.Layer.PointTrack"});OpenLayers.Layer.PointTrack.dataFrom={SOURCE_NODE:-1,TARGET_NODE:0};OpenLayers.Layer.Vector.RootContainer=OpenLayers.Class(OpenLayers.Layer.Vector,{displayInLayerSwitcher:false,layers:null,initialize:function(b,a){OpenLayers.Layer.Vector.prototype.initialize.apply(this,arguments)},display:function(){},getFeatureFromEvent:function(a){var d=this.layers;var c;for(var b=0;b<d.length;b++){c=d[b].getFeatureFromEvent(a);if(c){return c}}},setMap:function(a){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments);this.collectRoots();a.events.register("changelayer",this,this.handleChangeLayer)},removeMap:function(a){a.events.unregister("changelayer",this,this.handleChangeLayer);this.resetRoots();OpenLayers.Layer.Vector.prototype.removeMap.apply(this,arguments)
},collectRoots:function(){var b;for(var a=0;a<this.map.layers.length;++a){b=this.map.layers[a];if(OpenLayers.Util.indexOf(this.layers,b)!=-1){b.renderer.moveRoot(this.renderer)}}},resetRoots:function(){var b;for(var a=0;a<this.layers.length;++a){b=this.layers[a];if(this.renderer&&b.renderer.getRenderLayerId()==this.id){this.renderer.moveRoot(b.renderer)}}},handleChangeLayer:function(a){var b=a.layer;if(a.property=="order"&&OpenLayers.Util.indexOf(this.layers,b)!=-1){this.resetRoots();this.collectRoots()}},CLASS_NAME:"OpenLayers.Layer.Vector.RootContainer"});OpenLayers.Layer.WFS=OpenLayers.Class(OpenLayers.Layer.Vector,OpenLayers.Layer.Markers,{isBaseLayer:false,tile:null,ratio:2,DEFAULT_PARAMS:{service:"WFS",version:"1.0.0",request:"GetFeature"},featureClass:null,format:null,formatObject:null,formatOptions:null,vectorMode:true,encodeBBOX:false,extractAttributes:false,initialize:function(d,c,e,b){if(b==undefined){b={}}if(b.featureClass||!OpenLayers.Layer.Vector||!OpenLayers.Feature.Vector){this.vectorMode=false}e=OpenLayers.Util.upperCaseObject(e);OpenLayers.Util.extend(b,{reportError:false});var a=[];a.push(d,b);OpenLayers.Layer.Vector.prototype.initialize.apply(this,a);if(!this.renderer||!this.vectorMode){this.vectorMode=false;if(!b.featureClass){b.featureClass=OpenLayers.Feature.WFS}OpenLayers.Layer.Markers.prototype.initialize.apply(this,a)}if(this.params&&this.params.typename&&!this.options.typename){this.options.typename=this.params.typename}if(!this.options.geometry_column){this.options.geometry_column="the_geom"}this.params=OpenLayers.Util.applyDefaults(e,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS));this.url=c},destroy:function(){if(this.vectorMode){OpenLayers.Layer.Vector.prototype.destroy.apply(this,arguments)}else{OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments)}if(this.tile){this.tile.destroy()}this.tile=null;this.ratio=null;this.featureClass=null;this.format=null;if(this.formatObject&&this.formatObject.destroy){this.formatObject.destroy()}this.formatObject=null;this.formatOptions=null;this.vectorMode=null;this.encodeBBOX=null;this.extractAttributes=null},setMap:function(b){if(this.vectorMode){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments);var a={extractAttributes:this.extractAttributes};OpenLayers.Util.extend(a,this.formatOptions);if(this.map&&!this.projection.equals(this.map.getProjectionObject())){a.externalProjection=this.projection;a.internalProjection=this.map.getProjectionObject()}this.formatObject=this.format?new this.format(a):new OpenLayers.Format.GML(a)}else{OpenLayers.Layer.Markers.prototype.setMap.apply(this,arguments)}},moveTo:function(a,b,n){if(this.vectorMode){OpenLayers.Layer.Vector.prototype.moveTo.apply(this,arguments)}else{OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments)}if(n){return false}if(b){if(this.vectorMode){this.renderer.clear()}}if(this.options.minZoomLevel){OpenLayers.Console.warn(OpenLayers.i18n("minZoomLevelError"));if(this.map.getZoom()<this.options.minZoomLevel){return null}}if(a==null){a=this.map.getExtent()}var m=(this.tile==null);var g=(!m&&!this.tile.bounds.containsBounds(a));if(b||m||(!n&&g)){var c=a.getCenterLonLat();var l=a.getWidth()*this.ratio;var h=a.getHeight()*this.ratio;var j=new OpenLayers.Bounds(c.lon-(l/2),c.lat-(h/2),c.lon+(l/2),c.lat+(h/2));var o=this.map.getSize();o.w=o.w*this.ratio;o.h=o.h*this.ratio;var i=new OpenLayers.LonLat(j.left,j.top);var k=this.map.getLayerPxFromLonLat(i);var d=this.getFullRequestString();var f=null;var e=this.params.filter||this.params.FILTER;if(e){f={FILTER:e}}else{f={BBOX:this.encodeBBOX?j.toBBOX():j.toArray()}}if(this.map&&!this.projection.equals(this.map.getProjectionObject())){var p=j.clone();p.transform(this.map.getProjectionObject(),this.projection);if(!e){f.BBOX=this.encodeBBOX?p.toBBOX():p.toArray()}}d+="&"+OpenLayers.Util.getParameterString(f);if(!this.tile){this.tile=new OpenLayers.Tile.WFS(this,k,j,d,o);this.addTileMonitoringHooks(this.tile);this.tile.draw()}else{if(this.vectorMode){this.destroyFeatures();
this.renderer.clear()}else{this.clearMarkers()}this.removeTileMonitoringHooks(this.tile);this.tile.destroy();this.tile=null;this.tile=new OpenLayers.Tile.WFS(this,k,j,d,o);this.addTileMonitoringHooks(this.tile);this.tile.draw()}}},addTileMonitoringHooks:function(a){a.onLoadStart=function(){if(this==this.layer.tile){this.layer.events.triggerEvent("loadstart")}};a.events.register("loadstart",a,a.onLoadStart);a.onLoadEnd=function(){if(this==this.layer.tile){this.layer.events.triggerEvent("tileloaded");this.layer.events.triggerEvent("loadend")}};a.events.register("loadend",a,a.onLoadEnd);a.events.register("unload",a,a.onLoadEnd)},removeTileMonitoringHooks:function(a){a.unload();a.events.un({loadstart:a.onLoadStart,loadend:a.onLoadEnd,unload:a.onLoadEnd,scope:a})},onMapResize:function(){if(this.vectorMode){OpenLayers.Layer.Vector.prototype.onMapResize.apply(this,arguments)}else{OpenLayers.Layer.Markers.prototype.onMapResize.apply(this,arguments)}},display:function(){if(this.vectorMode){OpenLayers.Layer.Vector.prototype.display.apply(this,arguments)}else{OpenLayers.Layer.Markers.prototype.display.apply(this,arguments)}},mergeNewParams:function(c){var b=OpenLayers.Util.upperCaseObject(c);var a=[b];return OpenLayers.Layer.HTTPRequest.prototype.mergeNewParams.apply(this,a)},clone:function(a){if(a==null){a=new OpenLayers.Layer.WFS(this.name,this.url,this.params,this.getOptions())}if(this.vectorMode){a=OpenLayers.Layer.Vector.prototype.clone.apply(this,[a])}else{a=OpenLayers.Layer.Markers.prototype.clone.apply(this,[a])}return a},getFullRequestString:function(c,b){var a=this.projection.getCode()||this.map.getProjection();this.params.SRS=(a=="none")?null:a;return OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},commit:function(){if(!this.writer){var a={};if(this.map&&!this.projection.equals(this.map.getProjectionObject())){a.externalProjection=this.projection;a.internalProjection=this.map.getProjectionObject()}this.writer=new OpenLayers.Format.WFS(a,this)}var b=this.writer.write(this.features);OpenLayers.Request.POST({url:this.url,data:b,success:this.commitSuccess,failure:this.commitFailure,scope:this})},commitSuccess:function(c){var a=c.responseText;if(a.indexOf("SUCCESS")!=-1){this.commitReport(OpenLayers.i18n("commitSuccess",{response:a}));for(var b=0;b<this.features.length;b++){this.features[b].state=null}}else{if(a.indexOf("FAILED")!=-1||a.indexOf("Exception")!=-1){this.commitReport(OpenLayers.i18n("commitFailed",{response:a}))}}},commitFailure:function(a){},commitReport:function(b,a){OpenLayers.Console.userError(b)},refresh:function(){if(this.tile){if(this.vectorMode){this.renderer.clear();this.features.length=0}else{this.clearMarkers();this.markers.length=0}this.tile.draw()}},getDataExtent:function(){var a;if(this.vectorMode){a=OpenLayers.Layer.Vector.prototype.getDataExtent.apply(this)}else{a=OpenLayers.Layer.Markers.prototype.getDataExtent.apply(this)}return a},setOpacity:function(a){if(this.vectorMode){OpenLayers.Layer.Vector.prototype.setOpacity.apply(this,[a])}else{OpenLayers.Layer.Markers.prototype.setOpacity.apply(this,[a])}},CLASS_NAME:"OpenLayers.Layer.WFS"});OpenLayers.Protocol.HTTP=OpenLayers.Class(OpenLayers.Protocol,{url:null,headers:null,params:null,callback:null,scope:null,readWithPOST:false,wildcarded:false,initialize:function(a){a=a||{};this.params={};this.headers={};OpenLayers.Protocol.prototype.initialize.apply(this,arguments)},destroy:function(){this.params=null;this.headers=null;OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(a){OpenLayers.Protocol.prototype.read.apply(this,arguments);a=OpenLayers.Util.applyDefaults(a,this.options);a.params=OpenLayers.Util.applyDefaults(a.params,this.options.params);if(a.filter){a.params=this.filterToParams(a.filter,a.params)}var b=(a.readWithPOST!==undefined)?a.readWithPOST:this.readWithPOST;var c=new OpenLayers.Protocol.Response({requestType:"read"});if(b){c.priv=OpenLayers.Request.POST({url:a.url,callback:this.createCallback(this.handleRead,c,a),data:OpenLayers.Util.getParameterString(a.params),headers:{"Content-Type":"application/x-www-form-urlencoded"}})
}else{c.priv=OpenLayers.Request.GET({url:a.url,callback:this.createCallback(this.handleRead,c,a),params:a.params,headers:a.headers})}return c},handleRead:function(b,a){this.handleResponse(b,a)},filterToParams:function(d,g){g=g||{};var c=d.CLASS_NAME;var e=c.substring(c.lastIndexOf(".")+1);switch(e){case"Spatial":switch(d.type){case OpenLayers.Filter.Spatial.BBOX:g.bbox=d.value.toArray();break;case OpenLayers.Filter.Spatial.DWITHIN:g.tolerance=d.distance;case OpenLayers.Filter.Spatial.WITHIN:g.lon=d.value.x;g.lat=d.value.y;break;default:OpenLayers.Console.warn("Unknown spatial filter type "+d.type)}break;case"Comparison":var h=OpenLayers.Protocol.HTTP.COMP_TYPE_TO_OP_STR[d.type];if(h!==undefined){var f=d.value;if(d.type==OpenLayers.Filter.Comparison.LIKE){f=this.regex2value(f);if(this.wildcarded){f="%"+f+"%"}}g[d.property+"__"+h]=f;g.queryable=g.queryable||[];g.queryable.push(d.property)}else{OpenLayers.Console.warn("Unknown comparison filter type "+d.type)}break;case"Logical":if(d.type===OpenLayers.Filter.Logical.AND){for(var b=0,a=d.filters.length;b<a;b++){g=this.filterToParams(d.filters[b],g)}}else{OpenLayers.Console.warn("Unsupported logical filter type "+d.type)}break;default:OpenLayers.Console.warn("Unknown filter type "+e)}return g},regex2value:function(a){a=a.replace(/%/g,"\\%");a=a.replace(/\\\\\.(\*)?/g,function(c,b){return b?c:"\\\\_"});a=a.replace(/\\\\\.\*/g,"\\\\%");a=a.replace(/(\\)?\.(\*)?/g,function(c,b,d){return b||d?c:"_"});a=a.replace(/(\\)?\.\*/g,function(c,b){return b?c:"%"});a=a.replace(/\\\./g,".");a=a.replace(/(\\)?\\\*/g,function(c,b){return b?c:"*"});return a},create:function(b,a){a=OpenLayers.Util.applyDefaults(a,this.options);var c=new OpenLayers.Protocol.Response({reqFeatures:b,requestType:"create"});c.priv=OpenLayers.Request.POST({url:a.url,callback:this.createCallback(this.handleCreate,c,a),headers:a.headers,data:this.format.write(b)});return c},handleCreate:function(b,a){this.handleResponse(b,a)},update:function(c,b){b=b||{};var a=b.url||c.url||this.options.url+"/"+c.fid;b=OpenLayers.Util.applyDefaults(b,this.options);var d=new OpenLayers.Protocol.Response({reqFeatures:c,requestType:"update"});d.priv=OpenLayers.Request.PUT({url:a,callback:this.createCallback(this.handleUpdate,d,b),headers:b.headers,data:this.format.write(c)});return d},handleUpdate:function(b,a){this.handleResponse(b,a)},"delete":function(c,b){b=b||{};var a=b.url||c.url||this.options.url+"/"+c.fid;b=OpenLayers.Util.applyDefaults(b,this.options);var d=new OpenLayers.Protocol.Response({reqFeatures:c,requestType:"delete"});d.priv=OpenLayers.Request.DELETE({url:a,callback:this.createCallback(this.handleDelete,d,b),headers:b.headers});return d},handleDelete:function(b,a){this.handleResponse(b,a)},handleResponse:function(c,a){var b=c.priv;if(a.callback){if(b.status>=200&&b.status<300){if(c.requestType!="delete"){c.features=this.parseFeatures(b)}c.code=OpenLayers.Protocol.Response.SUCCESS}else{c.code=OpenLayers.Protocol.Response.FAILURE}a.callback.call(a.scope,c)}},parseFeatures:function(a){var b=a.responseXML;if(!b||!b.documentElement){b=a.responseText}if(!b||b.length<=0){return null}return this.format.read(b)},commit:function(b,q){q=OpenLayers.Util.applyDefaults(q,this.options);var d=[],m=0;var k={};k[OpenLayers.State.INSERT]=[];k[OpenLayers.State.UPDATE]=[];k[OpenLayers.State.DELETE]=[];var p,l,c=[];for(var e=0,j=b.length;e<j;++e){p=b[e];l=k[p.state];if(l){l.push(p);c.push(p)}}var g=(k[OpenLayers.State.INSERT].length>0?1:0)+k[OpenLayers.State.UPDATE].length+k[OpenLayers.State.DELETE].length;var o=true;var a=new OpenLayers.Protocol.Response({reqFeatures:c});function h(s){var r=s.features?s.features.length:0;var u=new Array(r);for(var t=0;t<r;++t){u[t]=s.features[t].fid}a.insertIds=u;n.apply(this,[s])}function n(i){this.callUserCallback(i,q);o=o&&i.success();m++;if(m>=g){if(q.callback){a.code=o?OpenLayers.Protocol.Response.SUCCESS:OpenLayers.Protocol.Response.FAILURE;q.callback.apply(q.scope,[a])}}}var f=k[OpenLayers.State.INSERT];if(f.length>0){d.push(this.create(f,OpenLayers.Util.applyDefaults({callback:h,scope:this},q.create)))
}f=k[OpenLayers.State.UPDATE];for(var e=f.length-1;e>=0;--e){d.push(this.update(f[e],OpenLayers.Util.applyDefaults({callback:n,scope:this},q.update)))}f=k[OpenLayers.State.DELETE];for(var e=f.length-1;e>=0;--e){d.push(this["delete"](f[e],OpenLayers.Util.applyDefaults({callback:n,scope:this},q["delete"])))}return d},abort:function(a){if(a){a.priv.abort()}},callUserCallback:function(c,a){var b=a[c.requestType];if(b&&b.callback){b.callback.call(b.scope,c)}},CLASS_NAME:"OpenLayers.Protocol.HTTP"});(function(){var a=OpenLayers.Protocol.HTTP.COMP_TYPE_TO_OP_STR={};a[OpenLayers.Filter.Comparison.EQUAL_TO]="eq";a[OpenLayers.Filter.Comparison.NOT_EQUAL_TO]="ne";a[OpenLayers.Filter.Comparison.LESS_THAN]="lt";a[OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO]="lte";a[OpenLayers.Filter.Comparison.GREATER_THAN]="gt";a[OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO]="gte";a[OpenLayers.Filter.Comparison.LIKE]="ilike"})();OpenLayers.Strategy.BBOX=OpenLayers.Class(OpenLayers.Strategy,{bounds:null,resolution:null,ratio:2,resFactor:null,response:null,initialize:function(a){OpenLayers.Strategy.prototype.initialize.apply(this,[a])},activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);if(a){this.layer.events.on({moveend:this.update,scope:this});this.layer.events.on({refresh:this.update,scope:this})}return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);if(a){this.layer.events.un({moveend:this.update,scope:this});this.layer.events.un({refresh:this.update,scope:this})}return a},update:function(b){var a=this.getMapBounds();if((b&&b.force)||this.invalidBounds(a)){this.calculateBounds(a);this.resolution=this.layer.map.getResolution();this.triggerRead()}},getMapBounds:function(){var a=this.layer.map.getExtent();if(!this.layer.projection.equals(this.layer.map.getProjectionObject())){a=a.clone().transform(this.layer.map.getProjectionObject(),this.layer.projection)}return a},invalidBounds:function(a){if(!a){a=this.getMapBounds()}var c=!this.bounds||!this.bounds.containsBounds(a);if(!c&&this.resFactor){var b=this.resolution/this.layer.map.getResolution();c=(b>=this.resFactor||b<=(1/this.resFactor))}return c},calculateBounds:function(b){if(!b){b=this.getMapBounds()}var a=b.getCenterLonLat();var d=b.getWidth()*this.ratio;var c=b.getHeight()*this.ratio;this.bounds=new OpenLayers.Bounds(a.lon-(d/2),a.lat-(c/2),a.lon+(d/2),a.lat+(c/2))},triggerRead:function(){if(this.response){this.layer.protocol.abort(this.response);this.layer.events.triggerEvent("loadend")}this.layer.events.triggerEvent("loadstart");this.response=this.layer.protocol.read({filter:this.createFilter(),callback:this.merge,scope:this})},createFilter:function(){var a=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,value:this.bounds,projection:this.layer.projection});if(this.layer.filter){a=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,filters:[this.layer.filter,a]})}return a},merge:function(g){this.layer.destroyFeatures();var e=g.features;if(e&&e.length>0){var f=this.layer.projection;var d=this.layer.map.getProjectionObject();if(!d.equals(f)){var c;for(var b=0,a=e.length;b<a;++b){c=e[b].geometry;if(c){c.transform(f,d)}}}this.layer.addFeatures(e)}this.response=null;this.layer.events.triggerEvent("loadend")},CLASS_NAME:"OpenLayers.Strategy.BBOX"});OpenLayers.Control.SelectFeature=OpenLayers.Class(OpenLayers.Control,{EVENT_TYPES:["beforefeaturehighlighted","featurehighlighted","featureunhighlighted"],multipleKey:null,toggleKey:null,multiple:false,clickout:true,toggle:false,hover:false,highlightOnly:false,box:false,onBeforeSelect:function(){},onSelect:function(){},onUnselect:function(){},scope:null,geometryTypes:null,layer:null,layers:null,callbacks:null,selectStyle:null,renderIntent:"select",handlers:null,initialize:function(c,a){this.EVENT_TYPES=OpenLayers.Control.SelectFeature.prototype.EVENT_TYPES.concat(OpenLayers.Control.prototype.EVENT_TYPES);OpenLayers.Control.prototype.initialize.apply(this,[a]);
if(this.scope===null){this.scope=this}this.initLayer(c);var b={click:this.clickFeature,clickout:this.clickoutFeature};if(this.hover){b.over=this.overFeature;b.out=this.outFeature}this.callbacks=OpenLayers.Util.extend(b,this.callbacks);this.handlers={feature:new OpenLayers.Handler.Feature(this,this.layer,this.callbacks,{geometryTypes:this.geometryTypes})};if(this.box){this.handlers.box=new OpenLayers.Handler.Box(this,{done:this.selectBox},{boxDivClassName:"olHandlerBoxSelectFeature"})}},initLayer:function(a){if(a instanceof Array){this.layers=a;this.layer=new OpenLayers.Layer.Vector.RootContainer(this.id+"_container",{layers:a})}else{this.layer=a}},destroy:function(){if(this.active&&this.layers){this.map.removeLayer(this.layer)}OpenLayers.Control.prototype.destroy.apply(this,arguments);if(this.layers){this.layer.destroy()}},activate:function(){if(!this.active){if(this.layers){this.map.addLayer(this.layer)}this.handlers.feature.activate();if(this.box&&this.handlers.box){this.handlers.box.activate()}}return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){if(this.active){this.handlers.feature.deactivate();if(this.handlers.box){this.handlers.box.deactivate()}if(this.layers){this.map.removeLayer(this.layer)}}return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},unselectAll:function(b){var f=this.layers||[this.layer];var e,d;for(var a=0;a<f.length;++a){e=f[a];for(var c=e.selectedFeatures.length-1;c>=0;--c){d=e.selectedFeatures[c];if(!b||b.except!=d){this.unselect(d)}}}},clickFeature:function(a){if(!this.hover){var b=(OpenLayers.Util.indexOf(a.layer.selectedFeatures,a)>-1);if(b){if(this.toggleSelect()){this.unselect(a)}else{if(!this.multipleSelect()){this.unselectAll({except:a})}}}else{if(!this.multipleSelect()){this.unselectAll({except:a})}this.select(a)}}},multipleSelect:function(){return this.multiple||(this.handlers.feature.evt&&this.handlers.feature.evt[this.multipleKey])},toggleSelect:function(){return this.toggle||(this.handlers.feature.evt&&this.handlers.feature.evt[this.toggleKey])},clickoutFeature:function(a){if(!this.hover&&this.clickout){this.unselectAll()}},overFeature:function(b){var a=b.layer;if(this.hover){if(this.highlightOnly){this.highlight(b)}else{if(OpenLayers.Util.indexOf(a.selectedFeatures,b)==-1){this.select(b)}}}},outFeature:function(a){if(this.hover){if(this.highlightOnly){if(a._lastHighlighter==this.id){if(a._prevHighlighter&&a._prevHighlighter!=this.id){delete a._lastHighlighter;var b=this.map.getControl(a._prevHighlighter);if(b){b.highlight(a)}}else{this.unhighlight(a)}}}else{this.unselect(a)}}},highlight:function(c){var b=c.layer;var a=this.events.triggerEvent("beforefeaturehighlighted",{feature:c});if(a!==false){c._prevHighlighter=c._lastHighlighter;c._lastHighlighter=this.id;var d=this.selectStyle||this.renderIntent;b.drawFeature(c,d);this.events.triggerEvent("featurehighlighted",{feature:c})}},unhighlight:function(b){var a=b.layer;b._lastHighlighter=b._prevHighlighter;delete b._prevHighlighter;a.drawFeature(b,b.style||b.layer.style||"default");this.events.triggerEvent("featureunhighlighted",{feature:b})},select:function(c){var a=this.onBeforeSelect.call(this.scope,c);var b=c.layer;if(a!==false){a=b.events.triggerEvent("beforefeatureselected",{feature:c});if(a!==false){b.selectedFeatures.push(c);this.highlight(c);if(!this.handlers.feature.lastFeature){this.handlers.feature.lastFeature=b.selectedFeatures[0]}b.events.triggerEvent("featureselected",{feature:c});this.onSelect.call(this.scope,c)}}},unselect:function(b){var a=b.layer;this.unhighlight(b);OpenLayers.Util.removeItem(a.selectedFeatures,b);a.events.triggerEvent("featureunselected",{feature:b});this.onUnselect.call(this.scope,b)},selectBox:function(e){if(e instanceof OpenLayers.Bounds){var h=this.map.getLonLatFromPixel(new OpenLayers.Pixel(e.left,e.bottom));var k=this.map.getLonLatFromPixel(new OpenLayers.Pixel(e.right,e.top));var a=new OpenLayers.Bounds(h.lon,h.lat,k.lon,k.lat);if(!this.multipleSelect()){this.unselectAll()
}var j=this.multiple;this.multiple=true;var d=this.layers||[this.layer];var f;for(var b=0;b<d.length;++b){f=d[b];for(var c=0,g=f.features.length;c<g;++c){var m=f.features[c];if(!m.getVisibility()){continue}if(this.geometryTypes==null||OpenLayers.Util.indexOf(this.geometryTypes,m.geometry.CLASS_NAME)>-1){if(a.toGeometry().intersects(m.geometry)){if(OpenLayers.Util.indexOf(f.selectedFeatures,m)==-1){this.select(m)}}}}}this.multiple=j}},setMap:function(a){this.handlers.feature.setMap(a);if(this.box){this.handlers.box.setMap(a)}OpenLayers.Control.prototype.setMap.apply(this,arguments)},setLayer:function(b){var a=this.active;this.unselectAll();this.deactivate();if(this.layers){this.layer.destroy();this.layers=null}this.initLayer(b);this.handlers.feature.layer=this.layer;if(a){this.activate()}},CLASS_NAME:"OpenLayers.Control.SelectFeature"});OpenLayers.Format.Filter.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ogc:"http://www.opengis.net/ogc",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"ogc",schemaLocation:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){var b={};this.readers.ogc.Filter.apply(this,[a,b]);return b.filter},readers:{ogc:{Filter:function(b,a){var c={fids:[],filters:[]};this.readChildNodes(b,c);if(c.fids.length>0){a.filter=new OpenLayers.Filter.FeatureId({fids:c.fids})}else{if(c.filters.length>0){a.filter=c.filters[0]}}},FeatureId:function(a,b){var c=a.getAttribute("fid");if(c){b.fids.push(c)}},And:function(b,c){var a=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND});this.readChildNodes(b,a);c.filters.push(a)},Or:function(b,c){var a=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.OR});this.readChildNodes(b,a);c.filters.push(a)},Not:function(b,c){var a=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.NOT});this.readChildNodes(b,a);c.filters.push(a)},PropertyIsLessThan:function(b,c){var a=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN});this.readChildNodes(b,a);c.filters.push(a)},PropertyIsGreaterThan:function(b,c){var a=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.GREATER_THAN});this.readChildNodes(b,a);c.filters.push(a)},PropertyIsLessThanOrEqualTo:function(b,c){var a=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO});this.readChildNodes(b,a);c.filters.push(a)},PropertyIsGreaterThanOrEqualTo:function(b,c){var a=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO});this.readChildNodes(b,a);c.filters.push(a)},PropertyIsBetween:function(b,c){var a=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.BETWEEN});this.readChildNodes(b,a);c.filters.push(a)},Literal:function(a,b){b.value=OpenLayers.String.numericIf(this.getChildValue(a))},PropertyName:function(b,a){a.property=this.getChildValue(b)},LowerBoundary:function(b,a){a.lowerBoundary=OpenLayers.String.numericIf(this.readOgcExpression(b))},UpperBoundary:function(b,a){a.upperBoundary=OpenLayers.String.numericIf(this.readOgcExpression(b))},Intersects:function(a,b){this.readSpatial(a,b,OpenLayers.Filter.Spatial.INTERSECTS)},Within:function(a,b){this.readSpatial(a,b,OpenLayers.Filter.Spatial.WITHIN)},Contains:function(a,b){this.readSpatial(a,b,OpenLayers.Filter.Spatial.CONTAINS)},DWithin:function(a,b){this.readSpatial(a,b,OpenLayers.Filter.Spatial.DWITHIN)},Distance:function(a,b){b.distance=parseInt(this.getChildValue(a));b.distanceUnits=a.getAttribute("units")}}},readSpatial:function(c,d,b){var a=new OpenLayers.Filter.Spatial({type:b});this.readChildNodes(c,a);a.value=a.components[0];delete a.components;d.filters.push(a)},readOgcExpression:function(a){var c={};this.readChildNodes(a,c);var b=c.value;if(b===undefined){b=this.getChildValue(a)}return b},write:function(a){return this.writers.ogc.Filter.apply(this,[a])},writers:{ogc:{Filter:function(c){var d=this.createElementNSPlus("ogc:Filter");
var b=c.CLASS_NAME.split(".").pop();if(b=="FeatureId"){for(var a=0;a<c.fids.length;++a){this.writeNode("FeatureId",c.fids[a],d)}}else{this.writeNode(this.getFilterType(c),c,d)}return d},FeatureId:function(a){return this.createElementNSPlus("ogc:FeatureId",{attributes:{fid:a}})},And:function(c){var d=this.createElementNSPlus("ogc:And");var b;for(var a=0;a<c.filters.length;++a){b=c.filters[a];this.writeNode(this.getFilterType(b),b,d)}return d},Or:function(c){var d=this.createElementNSPlus("ogc:Or");var b;for(var a=0;a<c.filters.length;++a){b=c.filters[a];this.writeNode(this.getFilterType(b),b,d)}return d},Not:function(b){var c=this.createElementNSPlus("ogc:Not");var a=b.filters[0];this.writeNode(this.getFilterType(a),a,c);return c},PropertyIsLessThan:function(a){var b=this.createElementNSPlus("ogc:PropertyIsLessThan");this.writeNode("PropertyName",a,b);this.writeNode("Literal",a.value,b);return b},PropertyIsGreaterThan:function(a){var b=this.createElementNSPlus("ogc:PropertyIsGreaterThan");this.writeNode("PropertyName",a,b);this.writeNode("Literal",a.value,b);return b},PropertyIsLessThanOrEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsLessThanOrEqualTo");this.writeNode("PropertyName",a,b);this.writeNode("Literal",a.value,b);return b},PropertyIsGreaterThanOrEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsGreaterThanOrEqualTo");this.writeNode("PropertyName",a,b);this.writeNode("Literal",a.value,b);return b},PropertyIsBetween:function(a){var b=this.createElementNSPlus("ogc:PropertyIsBetween");this.writeNode("PropertyName",a,b);this.writeNode("LowerBoundary",a,b);this.writeNode("UpperBoundary",a,b);return b},PropertyName:function(a){return this.createElementNSPlus("ogc:PropertyName",{value:a.property})},Literal:function(a){return this.createElementNSPlus("ogc:Literal",{value:a})},LowerBoundary:function(a){var b=this.createElementNSPlus("ogc:LowerBoundary");this.writeNode("Literal",a.lowerBoundary,b);return b},UpperBoundary:function(a){var b=this.createElementNSPlus("ogc:UpperBoundary");this.writeNode("Literal",a.upperBoundary,b);return b},INTERSECTS:function(a){return this.writeSpatial(a,"Intersects")},WITHIN:function(a){return this.writeSpatial(a,"Within")},CONTAINS:function(a){return this.writeSpatial(a,"Contains")},DWITHIN:function(a){var b=this.writeSpatial(a,"DWithin");this.writeNode("Distance",a,b);return b},Distance:function(a){return this.createElementNSPlus("ogc:Distance",{attributes:{units:a.distanceUnits},value:a.distance})}}},getFilterType:function(a){var b=this.filterMap[a.type];if(!b){throw"Filter writing not supported for rule type: "+a.type}return b},filterMap:{"&&":"And","||":"Or","!":"Not","==":"PropertyIsEqualTo","!=":"PropertyIsNotEqualTo","<":"PropertyIsLessThan",">":"PropertyIsGreaterThan","<=":"PropertyIsLessThanOrEqualTo",">=":"PropertyIsGreaterThanOrEqualTo","..":"PropertyIsBetween","~":"PropertyIsLike",BBOX:"BBOX",DWITHIN:"DWITHIN",WITHIN:"WITHIN",CONTAINS:"CONTAINS",INTERSECTS:"INTERSECTS"},CLASS_NAME:"OpenLayers.Format.Filter.v1"});OpenLayers.Geometry.Curve=OpenLayers.Class(OpenLayers.Geometry.MultiPoint,{componentTypes:["OpenLayers.Geometry.Point"],initialize:function(a){OpenLayers.Geometry.MultiPoint.prototype.initialize.apply(this,arguments)},getLength:function(){var c=0;if(this.components&&(this.components.length>1)){for(var b=1,a=this.components.length;b<a;b++){c+=this.components[b-1].distanceTo(this.components[b])}}return c},getGeodesicLength:function(b){var e=this;if(b){var c=new OpenLayers.Projection("EPSG:4326");if(!c.equals(b)){e=this.clone().transform(b,c)}}var f=0;if(e.components&&(e.components.length>1)){var h,g;for(var d=1,a=e.components.length;d<a;d++){h=e.components[d-1];g=e.components[d];f+=OpenLayers.Util.distVincenty({lon:h.x,lat:h.y},{lon:g.x,lat:g.y})}}return f*1000},CLASS_NAME:"OpenLayers.Geometry.Curve"});OpenLayers.Layer.Text=OpenLayers.Class(OpenLayers.Layer.Markers,{location:null,features:null,formatOptions:null,selectedFeature:null,initialize:function(b,a){OpenLayers.Layer.Markers.prototype.initialize.apply(this,arguments);
this.features=new Array()},destroy:function(){OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments);this.clearFeatures();this.features=null},loadText:function(){if(!this.loaded){if(this.location!=null){var a=function(b){this.events.triggerEvent("loadend")};this.events.triggerEvent("loadstart");OpenLayers.Request.GET({url:this.location,success:this.parseData,failure:a,scope:this});this.loaded=true}}},moveTo:function(c,a,b){OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments);if(this.visibility&&!this.loaded){this.loadText()}},parseData:function(k){var m=k.responseText;var o={};OpenLayers.Util.extend(o,this.formatOptions);if(this.map&&!this.projection.equals(this.map.getProjectionObject())){o.externalProjection=this.projection;o.internalProjection=this.map.getProjectionObject()}var b=new OpenLayers.Format.Text(o);var c=b.read(m);for(var g=0,h=c.length;g<h;g++){var f={};var n=c[g];var l;var j,d;l=new OpenLayers.LonLat(n.geometry.x,n.geometry.y);if(n.style.graphicWidth&&n.style.graphicHeight){j=new OpenLayers.Size(n.style.graphicWidth,n.style.graphicHeight)}if(n.style.graphicXOffset!==undefined&&n.style.graphicYOffset!==undefined){d=new OpenLayers.Pixel(n.style.graphicXOffset,n.style.graphicYOffset)}if(n.style.externalGraphic!=null){f.icon=new OpenLayers.Icon(n.style.externalGraphic,j,d)}else{f.icon=OpenLayers.Marker.defaultIcon();if(j!=null){f.icon.setSize(j)}}if((n.attributes.title!=null)&&(n.attributes.description!=null)){f.popupContentHTML="<h2>"+n.attributes.title+"</h2><p>"+n.attributes.description+"</p>"}f.overflow=n.attributes.overflow||"auto";var a=new OpenLayers.Feature(this,l,f);this.features.push(a);var e=a.createMarker();if((n.attributes.title!=null)&&(n.attributes.description!=null)){e.events.register("click",a,this.markerClick)}this.addMarker(e)}this.events.triggerEvent("loadend")},markerClick:function(b){var d=(this==this.layer.selectedFeature);this.layer.selectedFeature=(!d)?this:null;for(var c=0,a=this.layer.map.popups.length;c<a;c++){this.layer.map.removePopup(this.layer.map.popups[c])}if(!d){this.layer.map.addPopup(this.createPopup())}OpenLayers.Event.stop(b)},clearFeatures:function(){if(this.features!=null){while(this.features.length>0){var a=this.features[0];OpenLayers.Util.removeItem(this.features,a);a.destroy()}}},CLASS_NAME:"OpenLayers.Layer.Text"});OpenLayers.Control.ModifyFeature=OpenLayers.Class(OpenLayers.Control,{geometryTypes:null,clickout:true,toggle:true,standalone:false,layer:null,feature:null,vertices:null,virtualVertices:null,selectControl:null,dragControl:null,handlers:null,deleteCodes:null,virtualStyle:null,mode:null,modified:false,radiusHandle:null,dragHandle:null,onModificationStart:function(){},onModification:function(){},onModificationEnd:function(){},initialize:function(d,c){this.layer=d;this.vertices=[];this.virtualVertices=[];this.virtualStyle=OpenLayers.Util.extend({},this.layer.style||this.layer.styleMap.createSymbolizer());this.virtualStyle.fillOpacity=0.3;this.virtualStyle.strokeOpacity=0.3;this.deleteCodes=[46,68];this.mode=OpenLayers.Control.ModifyFeature.RESHAPE;OpenLayers.Control.prototype.initialize.apply(this,[c]);if(!(this.deleteCodes instanceof Array)){this.deleteCodes=[this.deleteCodes]}var f=this;var a={geometryTypes:this.geometryTypes,clickout:this.clickout,toggle:this.toggle,onBeforeSelect:this.beforeSelectFeature,onSelect:this.selectFeature,onUnselect:this.unselectFeature,scope:this};if(this.standalone===false){this.selectControl=new OpenLayers.Control.SelectFeature(d,a)}var b={geometryTypes:["OpenLayers.Geometry.Point"],snappingOptions:this.snappingOptions,onStart:function(h,g){f.dragStart.apply(f,[h,g])},onDrag:function(h,g){f.dragVertex.apply(f,[h,g])},onComplete:function(g){f.dragComplete.apply(f,[g])},featureCallbacks:{over:function(g){if(f.standalone!==true||g._sketch||f.feature===g){f.dragControl.overFeature.apply(f.dragControl,[g])}}}};this.dragControl=new OpenLayers.Control.DragFeature(d,b);var e={keydown:this.handleKeypress};this.handlers={keyboard:new OpenLayers.Handler.Keyboard(this,e)}
},destroy:function(){this.layer=null;this.standalone||this.selectControl.destroy();this.dragControl.destroy();OpenLayers.Control.prototype.destroy.apply(this,[])},activate:function(){return((this.standalone||this.selectControl.activate())&&this.handlers.keyboard.activate()&&OpenLayers.Control.prototype.activate.apply(this,arguments))},deactivate:function(){var c=false;if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){this.layer.removeFeatures(this.vertices,{silent:true});this.layer.removeFeatures(this.virtualVertices,{silent:true});this.vertices=[];this.dragControl.deactivate();var a=this.feature;var b=a&&a.geometry&&a.layer;if(this.standalone===false){if(b){this.selectControl.unselect.apply(this.selectControl,[a])}this.selectControl.deactivate()}else{if(b){this.unselectFeature(a)}}this.handlers.keyboard.deactivate();c=true}return c},beforeSelectFeature:function(a){return this.layer.events.triggerEvent("beforefeaturemodified",{feature:a})},selectFeature:function(a){this.feature=a;this.modified=false;this.resetVertices();this.dragControl.activate();this.onModificationStart(this.feature)},unselectFeature:function(a){this.layer.removeFeatures(this.vertices,{silent:true});this.vertices=[];this.layer.destroyFeatures(this.virtualVertices,{silent:true});this.virtualVertices=[];if(this.dragHandle){this.layer.destroyFeatures([this.dragHandle],{silent:true});delete this.dragHandle}if(this.radiusHandle){this.layer.destroyFeatures([this.radiusHandle],{silent:true});delete this.radiusHandle}this.feature=null;this.dragControl.deactivate();this.onModificationEnd(a);this.layer.events.triggerEvent("afterfeaturemodified",{feature:a,modified:this.modified});this.modified=false},dragStart:function(b,a){if(b!=this.feature&&!b.geometry.parent&&b!=this.dragHandle&&b!=this.radiusHandle){if(this.standalone===false&&this.feature){this.selectControl.clickFeature.apply(this.selectControl,[this.feature])}if(this.geometryTypes==null||OpenLayers.Util.indexOf(this.geometryTypes,b.geometry.CLASS_NAME)!=-1){this.standalone||this.selectControl.clickFeature.apply(this.selectControl,[b]);this.dragControl.overFeature.apply(this.dragControl,[b]);this.dragControl.lastPixel=a;this.dragControl.handlers.drag.started=true;this.dragControl.handlers.drag.start=a;this.dragControl.handlers.drag.last=a}}},dragVertex:function(b,a){this.modified=true;if(this.feature.geometry.CLASS_NAME=="OpenLayers.Geometry.Point"){if(this.feature!=b){this.feature=b}this.layer.events.triggerEvent("vertexmodified",{vertex:b.geometry,feature:this.feature,pixel:a})}else{if(b._index){b.geometry.parent.addComponent(b.geometry,b._index);delete b._index;OpenLayers.Util.removeItem(this.virtualVertices,b);this.vertices.push(b)}else{if(b==this.dragHandle){this.layer.removeFeatures(this.vertices,{silent:true});this.vertices=[];if(this.radiusHandle){this.layer.destroyFeatures([this.radiusHandle],{silent:true});this.radiusHandle=null}}else{if(b!==this.radiusHandle){this.layer.events.triggerEvent("vertexmodified",{vertex:b.geometry,feature:this.feature,pixel:a})}}}if(this.virtualVertices.length>0){this.layer.destroyFeatures(this.virtualVertices,{silent:true});this.virtualVertices=[]}this.layer.drawFeature(this.feature,this.standalone?undefined:this.selectControl.renderIntent)}this.layer.drawFeature(b)},dragComplete:function(a){this.resetVertices();this.setFeatureState();this.onModification(this.feature);this.layer.events.triggerEvent("featuremodified",{feature:this.feature})},setFeatureState:function(){if(this.feature.state!=OpenLayers.State.INSERT&&this.feature.state!=OpenLayers.State.DELETE){this.feature.state=OpenLayers.State.UPDATE}},resetVertices:function(){if(this.dragControl.feature){this.dragControl.outFeature(this.dragControl.feature)}if(this.vertices.length>0){this.layer.removeFeatures(this.vertices,{silent:true});this.vertices=[]}if(this.virtualVertices.length>0){this.layer.removeFeatures(this.virtualVertices,{silent:true});this.virtualVertices=[]}if(this.dragHandle){this.layer.destroyFeatures([this.dragHandle],{silent:true});
this.dragHandle=null}if(this.radiusHandle){this.layer.destroyFeatures([this.radiusHandle],{silent:true});this.radiusHandle=null}if(this.feature&&this.feature.geometry.CLASS_NAME!="OpenLayers.Geometry.Point"){if((this.mode&OpenLayers.Control.ModifyFeature.DRAG)){this.collectDragHandle()}if((this.mode&(OpenLayers.Control.ModifyFeature.ROTATE|OpenLayers.Control.ModifyFeature.RESIZE))){this.collectRadiusHandle()}if(this.mode&OpenLayers.Control.ModifyFeature.RESHAPE){if(!(this.mode&OpenLayers.Control.ModifyFeature.RESIZE)){this.collectVertices()}}}},handleKeypress:function(a){var b=a.keyCode;if(this.feature&&OpenLayers.Util.indexOf(this.deleteCodes,b)!=-1){var c=this.dragControl.feature;if(c&&OpenLayers.Util.indexOf(this.vertices,c)!=-1&&!this.dragControl.handlers.drag.dragging&&c.geometry.parent){c.geometry.parent.removeComponent(c.geometry);this.layer.drawFeature(this.feature,this.standalone?undefined:this.selectControl.renderIntent);this.resetVertices();this.setFeatureState();this.onModification(this.feature);this.layer.events.triggerEvent("featuremodified",{feature:this.feature})}}},collectVertices:function(){this.vertices=[];this.virtualVertices=[];var a=this;function b(h){var d,e,j,f;if(h.CLASS_NAME=="OpenLayers.Geometry.Point"){e=new OpenLayers.Feature.Vector(h);e._sketch=true;a.vertices.push(e)}else{var c=h.components.length;if(h.CLASS_NAME=="OpenLayers.Geometry.LinearRing"){c-=1}for(d=0;d<c;++d){j=h.components[d];if(j.CLASS_NAME=="OpenLayers.Geometry.Point"){e=new OpenLayers.Feature.Vector(j);e._sketch=true;a.vertices.push(e)}else{b(j)}}if(h.CLASS_NAME!="OpenLayers.Geometry.MultiPoint"){for(d=0,f=h.components.length;d<f-1;++d){var m=h.components[d];var n=h.components[d+1];if(m.CLASS_NAME=="OpenLayers.Geometry.Point"&&n.CLASS_NAME=="OpenLayers.Geometry.Point"){var k=(m.x+n.x)/2;var g=(m.y+n.y)/2;var l=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(k,g),null,a.virtualStyle);l.geometry.parent=h;l._index=d+1;l._sketch=true;a.virtualVertices.push(l)}}}}}b.call(this,this.feature.geometry);this.layer.addFeatures(this.virtualVertices,{silent:true});this.layer.addFeatures(this.vertices,{silent:true})},collectDragHandle:function(){var d=this.feature.geometry;var a=d.getBounds().getCenterLonLat();var c=new OpenLayers.Geometry.Point(a.lon,a.lat);var b=new OpenLayers.Feature.Vector(c);c.move=function(e,f){OpenLayers.Geometry.Point.prototype.move.call(this,e,f);d.move(e,f)};b._sketch=true;this.dragHandle=b;this.layer.addFeatures([this.dragHandle],{silent:true})},collectRadiusHandle:function(){var h=this.feature.geometry;var a=h.getBounds();var b=a.getCenterLonLat();var i=new OpenLayers.Geometry.Point(b.lon,b.lat);var g=new OpenLayers.Geometry.Point(a.right,a.bottom);var f=new OpenLayers.Feature.Vector(g);var c=(this.mode&OpenLayers.Control.ModifyFeature.RESIZE);var e=(this.mode&OpenLayers.Control.ModifyFeature.RESHAPE);var d=(this.mode&OpenLayers.Control.ModifyFeature.ROTATE);g.move=function(t,s){OpenLayers.Geometry.Point.prototype.move.call(this,t,s);var u=this.x-i.x;var p=this.y-i.y;var v=u-t;var q=p-s;if(d){var k=Math.atan2(q,v);var j=Math.atan2(p,u);var n=j-k;n*=180/Math.PI;h.rotate(n,i)}if(c){var m,r;if(e){m=p/q;r=(u/v)/m}else{var o=Math.sqrt((v*v)+(q*q));var l=Math.sqrt((u*u)+(p*p));m=l/o}h.resize(m,i,r)}};f._sketch=true;this.radiusHandle=f;this.layer.addFeatures([this.radiusHandle],{silent:true})},setMap:function(a){this.standalone||this.selectControl.setMap(a);this.dragControl.setMap(a);OpenLayers.Control.prototype.setMap.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.ModifyFeature"});OpenLayers.Control.ModifyFeature.RESHAPE=1;OpenLayers.Control.ModifyFeature.RESIZE=2;OpenLayers.Control.ModifyFeature.ROTATE=4;OpenLayers.Control.ModifyFeature.DRAG=8;OpenLayers.Geometry.LineString=OpenLayers.Class(OpenLayers.Geometry.Curve,{initialize:function(a){OpenLayers.Geometry.Curve.prototype.initialize.apply(this,arguments)},removeComponent:function(a){if(this.components&&(this.components.length>2)){OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments)
}},intersects:function(m){var c=false;var l=m.CLASS_NAME;if(l=="OpenLayers.Geometry.LineString"||l=="OpenLayers.Geometry.LinearRing"||l=="OpenLayers.Geometry.Point"){var p=this.getSortedSegments();var n;if(l=="OpenLayers.Geometry.Point"){n=[{x1:m.x,y1:m.y,x2:m.x,y2:m.y}]}else{n=m.getSortedSegments()}var s,g,e,a,r,q,d,b;outer:for(var h=0,k=p.length;h<k;++h){s=p[h];g=s.x1;e=s.x2;a=s.y1;r=s.y2;inner:for(var f=0,o=n.length;f<o;++f){q=n[f];if(q.x1>e){break}if(q.x2<g){continue}d=q.y1;b=q.y2;if(Math.min(d,b)>Math.max(a,r)){continue}if(Math.max(d,b)<Math.min(a,r)){continue}if(OpenLayers.Geometry.segmentsIntersect(s,q)){c=true;break outer}}}}else{c=m.intersects(this)}return c},getSortedSegments:function(){var a=this.components.length-1;var b=new Array(a),e,d;for(var c=0;c<a;++c){e=this.components[c];d=this.components[c+1];if(e.x<d.x){b[c]={x1:e.x,y1:e.y,x2:d.x,y2:d.y}}else{b[c]={x1:d.x,y1:d.y,x2:e.x,y2:e.y}}}function f(h,g){return h.x1-g.x1}return b.sort(f)},splitWithSegment:function(r,b){var c=!(b&&b.edge===false);var o=b&&b.tolerance;var a=[];var t=this.getVertices();var n=[];var v=[];var h=false;var e,d,l;var j,q,u;var f={point:true,tolerance:o};var g=null;for(var m=0,k=t.length-2;m<=k;++m){e=t[m];n.push(e.clone());d=t[m+1];u={x1:e.x,y1:e.y,x2:d.x,y2:d.y};l=OpenLayers.Geometry.segmentsIntersect(r,u,f);if(l instanceof OpenLayers.Geometry.Point){if((l.x===r.x1&&l.y===r.y1)||(l.x===r.x2&&l.y===r.y2)||l.equals(e)||l.equals(d)){q=true}else{q=false}if(q||c){if(!l.equals(v[v.length-1])){v.push(l.clone())}if(m===0){if(l.equals(e)){continue}}if(l.equals(d)){continue}h=true;if(!l.equals(e)){n.push(l)}a.push(new OpenLayers.Geometry.LineString(n));n=[l.clone()]}}}if(h){n.push(d.clone());a.push(new OpenLayers.Geometry.LineString(n))}if(v.length>0){var p=r.x1<r.x2?1:-1;var s=r.y1<r.y2?1:-1;g={lines:a,points:v.sort(function(w,i){return(p*w.x-p*i.x)||(s*w.y-s*i.y)})}}return g},split:function(x,b){var n=null;var d=b&&b.mutual;var l,e,m,c;if(x instanceof OpenLayers.Geometry.LineString){var w=this.getVertices();var g,f,v,h,a,p;var s=[];m=[];for(var t=0,o=w.length-2;t<=o;++t){g=w[t];f=w[t+1];v={x1:g.x,y1:g.y,x2:f.x,y2:f.y};c=c||[x];if(d){s.push(g.clone())}for(var r=0;r<c.length;++r){h=c[r].splitWithSegment(v,b);if(h){a=h.lines;if(a.length>0){a.unshift(r,1);Array.prototype.splice.apply(c,a);r+=a.length-2}if(d){for(var q=0,u=h.points.length;q<u;++q){p=h.points[q];if(!p.equals(g)){s.push(p);m.push(new OpenLayers.Geometry.LineString(s));if(p.equals(f)){s=[]}else{s=[p.clone()]}}}}}}}if(d&&m.length>0&&s.length>0){s.push(f.clone());m.push(new OpenLayers.Geometry.LineString(s))}}else{n=x.splitWith(this,b)}if(c&&c.length>1){e=true}else{c=[]}if(m&&m.length>1){l=true}else{m=[]}if(e||l){if(d){n=[m,c]}else{n=c}}return n},splitWith:function(b,a){return b.split(this,a)},getVertices:function(a){var b;if(a===true){b=[this.components[0],this.components[this.components.length-1]]}else{if(a===false){b=this.components.slice(1,this.components.length-1)}else{b=this.components.slice()}}return b},distanceTo:function(h,g){var k=!(g&&g.edge===false);var B=k&&g&&g.details;var q,e={};var t=Number.POSITIVE_INFINITY;if(h instanceof OpenLayers.Geometry.Point){var r=this.getSortedSegments();var p=h.x;var o=h.y;var z;for(var v=0,w=r.length;v<w;++v){z=r[v];q=OpenLayers.Geometry.distanceToSegment(h,z);if(q.distance<t){t=q.distance;e=q;if(t===0){break}}else{if(z.x2>p&&((o>z.y1&&o<z.y2)||(o<z.y1&&o>z.y2))){break}}}if(B){e={distance:e.distance,x0:e.x,y0:e.y,x1:p,y1:o}}else{e=e.distance}}else{if(h instanceof OpenLayers.Geometry.LineString){var d=this.getSortedSegments();var c=h.getSortedSegments();var b,a,n,A,f;var m=c.length;var l={point:true};outer:for(var v=0,w=d.length;v<w;++v){b=d[v];A=b.x1;f=b.y1;for(var u=0;u<m;++u){a=c[u];n=OpenLayers.Geometry.segmentsIntersect(b,a,l);if(n){t=0;e={distance:0,x0:n.x,y0:n.y,x1:n.x,y1:n.y};break outer}else{q=OpenLayers.Geometry.distanceToSegment({x:A,y:f},a);if(q.distance<t){t=q.distance;e={distance:t,x0:A,y0:f,x1:q.x,y1:q.y}}}}}if(!B){e=e.distance}if(t!==0){if(b){q=h.distanceTo(new OpenLayers.Geometry.Point(b.x2,b.y2),g);
var s=B?q.distance:q;if(s<t){if(B){e={distance:t,x0:q.x1,y0:q.y1,x1:q.x0,y1:q.y0}}else{e=s}}}}}else{e=h.distanceTo(this,g);if(B){e={distance:e.distance,x0:e.x1,y0:e.y1,x1:e.x0,y1:e.y0}}}}return e},CLASS_NAME:"OpenLayers.Geometry.LineString"});OpenLayers.Control.TransformFeature=OpenLayers.Class(OpenLayers.Control,{EVENT_TYPES:["beforesetfeature","setfeature","beforetransform","transform","transformcomplete"],geometryTypes:null,layer:null,preserveAspectRatio:false,rotate:true,feature:null,renderIntent:"temporary",rotationHandleSymbolizer:null,box:null,center:null,scale:1,ratio:1,rotation:0,handles:null,rotationHandles:null,dragControl:null,initialize:function(b,a){this.EVENT_TYPES=OpenLayers.Control.TransformFeature.prototype.EVENT_TYPES.concat(OpenLayers.Control.prototype.EVENT_TYPES);OpenLayers.Control.prototype.initialize.apply(this,[a]);this.layer=b;if(!this.rotationHandleSymbolizer){this.rotationHandleSymbolizer={stroke:false,pointRadius:10,fillOpacity:0,cursor:"pointer"}}this.createBox();this.createControl()},activate:function(){var a=false;if(OpenLayers.Control.prototype.activate.apply(this,arguments)){this.dragControl.activate();this.layer.addFeatures([this.box]);this.rotate&&this.layer.addFeatures(this.rotationHandles);this.layer.addFeatures(this.handles);a=true}return a},deactivate:function(){var a=false;if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){this.layer.removeFeatures(this.handles);this.rotate&&this.layer.removeFeatures(this.rotationHandles);this.layer.removeFeatures([this.box]);this.dragControl.deactivate();a=true}return a},setMap:function(a){this.dragControl.setMap(a);OpenLayers.Control.prototype.setMap.apply(this,arguments)},setFeature:function(j,c){c=OpenLayers.Util.applyDefaults(c,{rotation:0,scale:1,ratio:1});var i={feature:j};var e=this.rotation;var a=this.center;OpenLayers.Util.extend(this,c);if(this.events.triggerEvent("beforesetfeature",i)===false){return}this.feature=j;this.activate();this._setfeature=true;var b=this.feature.geometry.getBounds();this.box.move(b.getCenterLonLat());this.box.geometry.rotate(-e,a);this._angle=0;var f;if(this.rotation){var g=j.geometry.clone();g.rotate(-this.rotation,this.center);var d=new OpenLayers.Feature.Vector(g.getBounds().toGeometry());d.geometry.rotate(this.rotation,this.center);this.box.geometry.rotate(this.rotation,this.center);this.box.move(d.geometry.getBounds().getCenterLonLat());var h=d.geometry.components[0].components[0];f=h.getBounds().getCenterLonLat()}else{f=new OpenLayers.LonLat(b.left,b.bottom)}this.handles[0].move(f);delete this._setfeature;this.events.triggerEvent("setfeature",i)},createBox:function(){var e=this;this.center=new OpenLayers.Geometry.Point(0,0);var f=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([new OpenLayers.Geometry.Point(-1,-1),new OpenLayers.Geometry.Point(0,-1),new OpenLayers.Geometry.Point(1,-1),new OpenLayers.Geometry.Point(1,0),new OpenLayers.Geometry.Point(1,1),new OpenLayers.Geometry.Point(0,1),new OpenLayers.Geometry.Point(-1,1),new OpenLayers.Geometry.Point(-1,0),new OpenLayers.Geometry.Point(-1,-1)]),null,typeof this.renderIntent=="string"?null:this.renderIntent);f.geometry.move=function(i,o){e._moving=true;OpenLayers.Geometry.LineString.prototype.move.apply(this,arguments);e.center.move(i,o);delete e._moving};var a=function(i,o){OpenLayers.Geometry.Point.prototype.move.apply(this,arguments);this._rotationHandle&&this._rotationHandle.geometry.move(i,o);this._handle.geometry.move(i,o)};var n=function(p,i,o){OpenLayers.Geometry.Point.prototype.resize.apply(this,arguments);this._rotationHandle&&this._rotationHandle.geometry.resize(p,i,o);this._handle.geometry.resize(p,i,o)};var l=function(o,i){OpenLayers.Geometry.Point.prototype.rotate.apply(this,arguments);this._rotationHandle&&this._rotationHandle.geometry.rotate(o,i);this._handle.geometry.rotate(o,i)};var h=function(A,w){var F=this.x,C=this.y;OpenLayers.Geometry.Point.prototype.move.call(this,A,w);if(e._moving){return}var D=e.dragControl.handlers.drag.evt;
var i=!e._setfeature&&e.preserveAspectRatio;var r=!i&&!(D&&D.shiftKey);var z=new OpenLayers.Geometry.Point(F,C);var u=e.center;this.rotate(-e.rotation,u);z.rotate(-e.rotation,u);var B=this.x-u.x;var s=this.y-u.y;var E=B-(this.x-z.x);var t=s-(this.y-z.y);this.x=F;this.y=C;var p,v=1;if(r){p=Math.abs(t)<0.00001?1:s/t;v=(Math.abs(E)<0.00001?1:(B/E))/p}else{var q=Math.sqrt((E*E)+(t*t));var o=Math.sqrt((B*B)+(s*s));p=o/q}e._moving=true;e.box.geometry.rotate(-e.rotation,u);delete e._moving;e.box.geometry.resize(p,u,v);e.box.geometry.rotate(e.rotation,u);e.transformFeature({scale:p,ratio:v})};var c=function(v,t){var D=this.x,A=this.y;OpenLayers.Geometry.Point.prototype.move.call(this,v,t);if(e._moving){return}var B=e.dragControl.handlers.drag.evt;var u=(B&&B.shiftKey)?45:1;var s=e.center;var z=this.x-s.x;var q=this.y-s.y;var C=z-v;var r=q-t;this.x=D;this.y=A;var o=Math.atan2(r,C);var i=Math.atan2(q,z);var p=i-o;p*=180/Math.PI;e._angle=(e._angle+p)%360;var w=e.rotation%u;if(Math.abs(e._angle)>=u||w!==0){p=Math.round(e._angle/u)*u-w;e._angle=0;e.box.geometry.rotate(p,s);e.transformFeature({rotation:p})}};var m=new Array(8);var j=new Array(4);var k,g,b;for(var d=0;d<8;++d){k=f.geometry.components[d];g=new OpenLayers.Feature.Vector(k.clone(),null,typeof this.renderIntent=="string"?null:this.renderIntent);if(d%2==0){b=new OpenLayers.Feature.Vector(k.clone(),null,typeof this.rotationHandleSymbolizer=="string"?null:this.rotationHandleSymbolizer);b.geometry.move=c;k._rotationHandle=b;j[d/2]=b}k.move=a;k.resize=n;k.rotate=l;g.geometry.move=h;k._handle=g;m[d]=g}this.box=f;this.rotationHandles=j;this.handles=m},createControl:function(){var a=this;this.dragControl=new OpenLayers.Control.DragFeature(this.layer,{documentDrag:true,moveFeature:function(b){if(this.feature===a.feature){this.feature=a.box}OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},onDrag:function(c,b){if(c===a.box){a.transformFeature({center:a.center});a.drawHandles()}},onStart:function(e,c){var b=!a.geometryTypes||OpenLayers.Util.indexOf(a.geometryTypes,e.geometry.CLASS_NAME)!==-1;var d=OpenLayers.Util.indexOf(a.handles,e);d+=OpenLayers.Util.indexOf(a.rotationHandles,e);if(e!==a.feature&&e!==a.box&&d==-2&&b){a.setFeature(e)}},onComplete:function(c,b){a.events.triggerEvent("transformcomplete",{feature:a.feature})}})},drawHandles:function(){var b=this.layer;for(var a=0;a<8;++a){if(this.rotate&&a%2===0){b.drawFeature(this.rotationHandles[a/2],this.rotationHandleSymbolizer)}b.drawFeature(this.handles[a],this.renderIntent)}},transformFeature:function(e){if(!this._setfeature){this.scale*=(e.scale||1);this.ratio*=(e.ratio||1);var b=this.rotation;this.rotation=(this.rotation+(e.rotation||0))%360;if(this.events.triggerEvent("beforetransform",e)!==false){var d=this.feature;var c=d.geometry;var a=this.center;c.rotate(-b,a);if(e.scale||e.ratio){c.resize(e.scale,a,e.ratio)}else{if(e.center){d.move(e.center.getBounds().getCenterLonLat())}}c.rotate(this.rotation,a);this.layer.drawFeature(d);d.toState(OpenLayers.State.UPDATE);this.events.triggerEvent("transform",e)}}this.layer.drawFeature(this.box,this.renderIntent);this.drawHandles()},destroy:function(){var b;for(var a=0;a<8;++a){b=this.box.geometry.components[a];b._handle.destroy();b._handle=null;b._rotationHandle&&b._rotationHandle.destroy();b._rotationHandle=null}this.box.destroy();this.box=null;this.layer=null;this.dragControl.destroy();OpenLayers.Control.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.TransformFeature"});OpenLayers.Format.GPX=OpenLayers.Class(OpenLayers.Format.XML,{extractWaypoints:true,extractTracks:true,extractRoutes:true,extractAttributes:true,initialize:function(a){this.externalProjection=new OpenLayers.Projection("EPSG:4326");OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(x){if(typeof x=="string"){x=OpenLayers.Format.XML.prototype.read.apply(this,[x])}var c=[];if(this.extractTracks){var t=x.getElementsByTagName("trk");for(var s=0,u=t.length;s<u;
s++){var n={};if(this.extractAttributes){n=this.parseAttributes(t[s])}var h=this.getElementsByTagNameNS(t[s],t[s].namespaceURI,"trkseg");for(var r=0,f=h.length;r<f;r++){var m=this.extractSegment(h[r],"trkpt");c.push(new OpenLayers.Feature.Vector(m,n))}}}if(this.extractRoutes){var a=x.getElementsByTagName("rte");for(var q=0,p=a.length;q<p;q++){var n={};if(this.extractAttributes){n=this.parseAttributes(a[q])}var w=this.extractSegment(a[q],"rtept");c.push(new OpenLayers.Feature.Vector(w,n))}}if(this.extractWaypoints){var b=x.getElementsByTagName("wpt");for(var o=0,u=b.length;o<u;o++){var n={};if(this.extractAttributes){n=this.parseAttributes(b[o])}var e=new OpenLayers.Geometry.Point(b[o].getAttribute("lon"),b[o].getAttribute("lat"));c.push(new OpenLayers.Feature.Vector(e,n))}}if(this.internalProjection&&this.externalProjection){for(var v=0,d=c.length;v<d;v++){c[v].geometry.transform(this.externalProjection,this.internalProjection)}}return c},extractSegment:function(e,f){var d=this.getElementsByTagNameNS(e,e.namespaceURI,f);var b=[];for(var c=0,a=d.length;c<a;c++){b.push(new OpenLayers.Geometry.Point(d[c].getAttribute("lon"),d[c].getAttribute("lat")))}return new OpenLayers.Geometry.LineString(b)},parseAttributes:function(b){var a={};var d=b.firstChild;while(d){if(d.nodeType==1){var c=d.firstChild;if(c.nodeType==3||c.nodeType==4){name=(d.prefix)?d.nodeName.split(":")[1]:d.nodeName;if(name!="trkseg"&&name!="rtept"){a[name]=c.nodeValue}}}d=d.nextSibling}return a},CLASS_NAME:"OpenLayers.Format.GPX"});OpenLayers.Geometry.LinearRing=OpenLayers.Class(OpenLayers.Geometry.LineString,{componentTypes:["OpenLayers.Geometry.Point"],initialize:function(a){OpenLayers.Geometry.LineString.prototype.initialize.apply(this,arguments)},addComponent:function(a,b){var c=false;var d=this.components.pop();if(b!=null||!a.equals(d)){c=OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,arguments)}var e=this.components[0];OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[e]);return c},removeComponent:function(a){if(this.components.length>4){this.components.pop();OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments);var b=this.components[0];OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[b])}},move:function(b,d){for(var c=0,a=this.components.length;c<a-1;c++){this.components[c].move(b,d)}},rotate:function(d,b){for(var c=0,a=this.components.length;c<a-1;++c){this.components[c].rotate(d,b)}},resize:function(e,b,d){for(var c=0,a=this.components.length;c<a-1;++c){this.components[c].resize(e,b,d)}return this},transform:function(e,c){if(e&&c){for(var d=0,a=this.components.length;d<a-1;d++){var b=this.components[d];b.transform(e,c)}this.bounds=null}return this},getCentroid:function(){if(this.components&&(this.components.length>2)){var h=0;var g=0;for(var e=0;e<this.components.length-1;e++){var d=this.components[e];var k=this.components[e+1];h+=(d.x+k.x)*(d.x*k.y-k.x*d.y);g+=(d.y+k.y)*(d.x*k.y-k.x*d.y)}var f=-1*this.getArea();var a=h/(6*f);var j=g/(6*f);return new OpenLayers.Geometry.Point(a,j)}else{return null}},getArea:function(){var g=0;if(this.components&&(this.components.length>2)){var f=0;for(var e=0,d=this.components.length;e<d-1;e++){var a=this.components[e];var h=this.components[e+1];f+=(a.x+h.x)*(h.y-a.y)}g=-f/2}return g},getGeodesicArea:function(b){var d=this;if(b){var c=new OpenLayers.Projection("EPSG:4326");if(!c.equals(b)){d=this.clone().transform(b,c)}}var f=0;var a=d.components&&d.components.length;if(a>2){var h,g;for(var e=0;e<a-1;e++){h=d.components[e];g=d.components[e+1];f+=OpenLayers.Util.rad(g.x-h.x)*(2+Math.sin(OpenLayers.Util.rad(h.y))+Math.sin(OpenLayers.Util.rad(g.y)))}f=f*6378137*6378137/2}return f},containsPoint:function(m){var s=OpenLayers.Number.limitSigDigs;var l=14;var k=s(m.x,l);var j=s(m.y,l);function r(w,t,v,i,u){return(((t-i)*w)+((i*v)-(t*u)))/(v-u)}var a=this.components.length-1;var g,f,q,d,o,b,e,c;var h=0;for(var n=0;n<a;++n){g=this.components[n];q=s(g.x,l);d=s(g.y,l);
f=this.components[n+1];o=s(f.x,l);b=s(f.y,l);if(d==b){if(j==d){if(q<=o&&(k>=q&&k<=o)||q>=o&&(k<=q&&k>=o)){h=-1;break}}continue}e=s(r(j,q,d,o,b),l);if(e==k){if(d<b&&(j>=d&&j<=b)||d>b&&(j<=d&&j>=b)){h=-1;break}}if(e<=k){continue}if(q!=o&&(e<Math.min(q,o)||e>Math.max(q,o))){continue}if(d<b&&(j>=d&&j<b)||d>b&&(j<d&&j>=b)){++h}}var p=(h==-1)?1:!!(h&1);return p},intersects:function(d){var b=false;if(d.CLASS_NAME=="OpenLayers.Geometry.Point"){b=this.containsPoint(d)}else{if(d.CLASS_NAME=="OpenLayers.Geometry.LineString"){b=d.intersects(this)}else{if(d.CLASS_NAME=="OpenLayers.Geometry.LinearRing"){b=OpenLayers.Geometry.LineString.prototype.intersects.apply(this,[d])}else{for(var c=0,a=d.components.length;c<a;++c){b=d.components[c].intersects(this);if(b){break}}}}}return b},getVertices:function(a){return(a===true)?[]:this.components.slice(0,this.components.length-1)},CLASS_NAME:"OpenLayers.Geometry.LinearRing"});OpenLayers.Geometry.MultiLineString=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LineString"],initialize:function(a){OpenLayers.Geometry.Collection.prototype.initialize.apply(this,arguments)},split:function(n,s){var g=null;var r=s&&s.mutual;var o,a,q,m,b;var e=[];var p=[n];for(var f=0,h=this.components.length;f<h;++f){a=this.components[f];m=false;for(var d=0;d<p.length;++d){o=a.split(p[d],s);if(o){if(r){q=o[0];for(var c=0,l=q.length;c<l;++c){if(c===0&&e.length){e[e.length-1].addComponent(q[c])}else{e.push(new OpenLayers.Geometry.MultiLineString([q[c]]))}}m=true;o=o[1]}if(o.length){o.unshift(d,1);Array.prototype.splice.apply(p,o);break}}}if(!m){if(e.length){e[e.length-1].addComponent(a.clone())}else{e=[new OpenLayers.Geometry.MultiLineString(a.clone())]}}}if(e&&e.length>1){m=true}else{e=[]}if(p&&p.length>1){b=true}else{p=[]}if(m||b){if(r){g=[e,p]}else{g=p}}return g},splitWith:function(n,s){var g=null;var r=s&&s.mutual;var o,c,q,m,a,e,p;if(n instanceof OpenLayers.Geometry.LineString){p=[];e=[n];for(var f=0,h=this.components.length;f<h;++f){a=false;c=this.components[f];for(var d=0;d<e.length;++d){o=e[d].split(c,s);if(o){if(r){q=o[0];if(q.length){q.unshift(d,1);Array.prototype.splice.apply(e,q);d+=q.length-2}o=o[1];if(o.length===0){o=[c.clone()]}}for(var b=0,l=o.length;b<l;++b){if(b===0&&p.length){p[p.length-1].addComponent(o[b])}else{p.push(new OpenLayers.Geometry.MultiLineString([o[b]]))}}a=true}}if(!a){if(p.length){p[p.length-1].addComponent(c.clone())}else{p=[new OpenLayers.Geometry.MultiLineString([c.clone()])]}}}}else{g=n.split(this)}if(e&&e.length>1){m=true}else{e=[]}if(p&&p.length>1){a=true}else{p=[]}if(m||a){if(r){g=[e,p]}else{g=p}}return g},CLASS_NAME:"OpenLayers.Geometry.MultiLineString"});OpenLayers.Handler.Path=OpenLayers.Class(OpenLayers.Handler.Point,{line:null,freehand:false,freehandToggle:"shiftKey",initialize:function(c,b,a){OpenLayers.Handler.Point.prototype.initialize.apply(this,arguments)},createFeature:function(a){var b=this.control.map.getLonLatFromPixel(a);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(b.lon,b.lat));this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([this.point.geometry]));this.callback("create",[this.point.geometry,this.getSketch()]);this.point.geometry.clearBounds();this.layer.addFeatures([this.line,this.point],{silent:true})},destroyFeature:function(){OpenLayers.Handler.Point.prototype.destroyFeature.apply(this);this.line=null},removePoint:function(){if(this.point){this.layer.removeFeatures([this.point])}},addPoint:function(a){this.layer.removeFeatures([this.point]);var b=this.control.map.getLonLatFromPixel(a);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(b.lon,b.lat));this.line.geometry.addComponent(this.point.geometry,this.line.geometry.components.length);this.callback("point",[this.point.geometry,this.getGeometry()]);this.callback("modify",[this.point.geometry,this.getSketch()]);this.drawFeature()},freehandMode:function(a){return(this.freehandToggle&&a[this.freehandToggle])?!this.freehand:this.freehand
},modifyFeature:function(a){var b=this.control.map.getLonLatFromPixel(a);this.point.geometry.x=b.lon;this.point.geometry.y=b.lat;this.callback("modify",[this.point.geometry,this.getSketch()]);this.point.geometry.clearBounds();this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.line,this.style);this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.line},getGeometry:function(){var a=this.line&&this.line.geometry;if(a&&this.multi){a=new OpenLayers.Geometry.MultiLineString([a])}return a},mousedown:function(a){if(this.lastDown&&this.lastDown.equals(a.xy)){return false}if(this.lastDown==null){if(this.persist){this.destroyFeature()}this.createFeature(a.xy)}else{if((this.lastUp==null)||!this.lastUp.equals(a.xy)){this.addPoint(a.xy)}}this.mouseDown=true;this.lastDown=a.xy;this.drawing=true;return false},mousemove:function(a){if(this.drawing){if(this.mouseDown&&this.freehandMode(a)){this.addPoint(a.xy)}else{this.modifyFeature(a.xy)}}return true},mouseup:function(a){this.mouseDown=false;if(this.drawing){if(this.freehandMode(a)){this.removePoint();this.finalize()}else{if(this.lastUp==null){this.addPoint(a.xy)}this.lastUp=a.xy}return false}return true},dblclick:function(a){if(!this.freehandMode(a)){var b=this.line.geometry.components.length-1;this.line.geometry.removeComponent(this.line.geometry.components[b]);this.removePoint();this.finalize()}return false},CLASS_NAME:"OpenLayers.Handler.Path"});OpenLayers.Control.Split=OpenLayers.Class(OpenLayers.Control,{EVENT_TYPES:["beforesplit","split","aftersplit"],layer:null,source:null,sourceOptions:null,tolerance:null,edge:true,deferDelete:false,mutual:true,targetFilter:null,sourceFilter:null,handler:null,initialize:function(a){Array.prototype.push.apply(this.EVENT_TYPES,OpenLayers.Control.prototype.EVENT_TYPES);OpenLayers.Control.prototype.initialize.apply(this,[a]);this.options=a||{};if(this.options.source){this.setSource(this.options.source)}},setSource:function(a){if(this.active){this.deactivate();if(this.handler){this.handler.destroy();delete this.handler}this.source=a;this.activate()}else{this.source=a}},activate:function(){var a=OpenLayers.Control.prototype.activate.call(this);if(a){if(!this.source){if(!this.handler){this.handler=new OpenLayers.Handler.Path(this,{done:function(b){this.onSketchComplete({feature:new OpenLayers.Feature.Vector(b)})}},{layerOptions:this.sourceOptions})}this.handler.activate()}else{if(this.source.events){this.source.events.on({sketchcomplete:this.onSketchComplete,afterfeaturemodified:this.afterFeatureModified,scope:this})}}}return a},deactivate:function(){var a=OpenLayers.Control.prototype.deactivate.call(this);if(a){if(this.source&&this.source.events){this.layer.events.un({sketchcomplete:this.onSketchComplete,afterfeaturemodified:this.afterFeatureModified,scope:this})}}return a},onSketchComplete:function(a){this.feature=null;return !this.considerSplit(a.feature)},afterFeatureModified:function(b){if(b.modified){var a=b.feature;if(a.geometry instanceof OpenLayers.Geometry.LineString||a.geometry instanceof OpenLayers.Geometry.MultiLineString){this.feature=b.feature;this.considerSplit(b.feature)}}},removeByGeometry:function(c,d){for(var b=0,a=c.length;b<a;++b){if(c[b].geometry===d){c.splice(b,1);break}}},isEligible:function(a){return(a.state!==OpenLayers.State.DELETE)&&(a.geometry instanceof OpenLayers.Geometry.LineString||a.geometry instanceof OpenLayers.Geometry.MultiLineString)&&(this.feature!==a)&&(!this.targetFilter||this.targetFilter.evaluate(a.attributes))},considerSplit:function(c){var h=false;var f=false;if(!this.sourceFilter||this.sourceFilter.evaluate(c.attributes)){var g=this.layer&&this.layer.features||[];var y,p,a;var m=[],x=[];var d=(this.layer===this.source)&&this.mutual;var b={edge:this.edge,tolerance:this.tolerance,mutual:d};var l=[c.geometry];var o,e;var r,q;for(var v=0,w=g.length;v<w;++v){o=g[v];if(this.isEligible(o)){e=[o.geometry];for(var u=0;u<l.length;++u){r=l[u];for(var s=0;s<e.length;++s){y=e[s];
if(r.getBounds().intersectsBounds(y.getBounds())){p=r.split(y,b);if(p){a=this.events.triggerEvent("beforesplit",{source:c,target:o});if(a!==false){if(d){q=p[0];if(q.length>1){q.unshift(u,1);Array.prototype.splice.apply(l,q);u+=q.length-3}p=p[1]}if(p.length>1){p.unshift(s,1);Array.prototype.splice.apply(e,p);s+=p.length-3}}}}}}if(e&&e.length>1){this.geomsToFeatures(o,e);this.events.triggerEvent("split",{original:o,features:e});Array.prototype.push.apply(m,e);x.push(o);f=true}}}if(l&&l.length>1){this.geomsToFeatures(c,l);this.events.triggerEvent("split",{original:c,features:l});Array.prototype.push.apply(m,l);x.push(c);h=true}if(h||f){if(this.deferDelete){var n,t=[];for(var v=0,w=x.length;v<w;++v){n=x[v];if(n.state===OpenLayers.State.INSERT){t.push(n)}else{n.state=OpenLayers.State.DELETE;this.layer.drawFeature(n)}}this.layer.destroyFeatures(t,{silent:true});for(var v=0,w=m.length;v<w;++v){m[v].state=OpenLayers.State.INSERT}}else{this.layer.destroyFeatures(x,{silent:true})}this.layer.addFeatures(m,{silent:true});this.events.triggerEvent("aftersplit",{source:c,features:m})}}return h},geomsToFeatures:function(c,d){var f=c.clone();delete f.geometry;var e;for(var b=0,a=d.length;b<a;++b){e=f.clone();e.geometry=d[b];e.state=OpenLayers.State.INSERT;d[b]=e}},destroy:function(){if(this.active){this.deactivate()}OpenLayers.Control.prototype.destroy.call(this)},CLASS_NAME:"OpenLayers.Control.Split"});OpenLayers.Geometry.Polygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LinearRing"],initialize:function(a){OpenLayers.Geometry.Collection.prototype.initialize.apply(this,arguments)},getArea:function(){var c=0;if(this.components&&(this.components.length>0)){c+=Math.abs(this.components[0].getArea());for(var b=1,a=this.components.length;b<a;b++){c-=Math.abs(this.components[b].getArea())}}return c},getGeodesicArea:function(b){var d=0;if(this.components&&(this.components.length>0)){d+=Math.abs(this.components[0].getGeodesicArea(b));for(var c=1,a=this.components.length;c<a;c++){d-=Math.abs(this.components[c].getGeodesicArea(b))}}return d},containsPoint:function(a){var e=this.components.length;var c=false;if(e>0){c=this.components[0].containsPoint(a);if(c!==1){if(c&&e>1){var d;for(var b=1;b<e;++b){d=this.components[b].containsPoint(a);if(d){if(d===1){c=1}else{c=false}break}}}}}return c},intersects:function(e){var b=false;var d,a;if(e.CLASS_NAME=="OpenLayers.Geometry.Point"){b=this.containsPoint(e)}else{if(e.CLASS_NAME=="OpenLayers.Geometry.LineString"||e.CLASS_NAME=="OpenLayers.Geometry.LinearRing"){for(d=0,a=this.components.length;d<a;++d){b=e.intersects(this.components[d]);if(b){break}}if(!b){for(d=0,a=e.components.length;d<a;++d){b=this.containsPoint(e.components[d]);if(b){break}}}}else{for(d=0,a=e.components.length;d<a;++d){b=this.intersects(e.components[d]);if(b){break}}}}if(!b&&e.CLASS_NAME=="OpenLayers.Geometry.Polygon"){var c=this.components[0];for(d=0,a=c.components.length;d<a;++d){b=e.containsPoint(c.components[d]);if(b){break}}}return b},distanceTo:function(d,b){var c=!(b&&b.edge===false);var a;if(!c&&this.intersects(d)){a=0}else{a=OpenLayers.Geometry.Collection.prototype.distanceTo.apply(this,[d,b])}return a},CLASS_NAME:"OpenLayers.Geometry.Polygon"});OpenLayers.Geometry.Polygon.createRegularPolygon=function(j,f,b,l){var c=Math.PI*((1/b)-(1/2));if(l){c+=(l/180)*Math.PI}var a,h,g;var k=[];for(var e=0;e<b;++e){a=c+(e*2*Math.PI/b);h=j.x+(f*Math.cos(a));g=j.y+(f*Math.sin(a));k.push(new OpenLayers.Geometry.Point(h,g))}var d=new OpenLayers.Geometry.LinearRing(k);return new OpenLayers.Geometry.Polygon([d])};OpenLayers.Format.GeoRSS=OpenLayers.Class(OpenLayers.Format.XML,{rssns:"http://backend.userland.com/rss2",featureNS:"http://mapserver.gis.umn.edu/mapserver",georssns:"http://www.georss.org/georss",geons:"http://www.w3.org/2003/01/geo/wgs84_pos#",featureTitle:"Untitled",featureDescription:"No Description",gmlParser:null,xy:false,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])
},createGeometryFromItem:function(n){var m=this.getElementsByTagNameNS(n,this.georssns,"point");var g=this.getElementsByTagNameNS(n,this.geons,"lat");var a=this.getElementsByTagNameNS(n,this.geons,"long");var p=this.getElementsByTagNameNS(n,this.georssns,"line");var k=this.getElementsByTagNameNS(n,this.georssns,"polygon");var c=this.getElementsByTagNameNS(n,this.georssns,"where");var d=this.getElementsByTagNameNS(n,this.georssns,"box");if(m.length>0||(g.length>0&&a.length>0)){var l;if(m.length>0){l=OpenLayers.String.trim(m[0].firstChild.nodeValue).split(/\s+/);if(l.length!=2){l=OpenLayers.String.trim(m[0].firstChild.nodeValue).split(/\s*,\s*/)}}else{l=[parseFloat(g[0].firstChild.nodeValue),parseFloat(a[0].firstChild.nodeValue)]}var h=new OpenLayers.Geometry.Point(parseFloat(l[1]),parseFloat(l[0]))}else{if(p.length>0){var j=OpenLayers.String.trim(this.concatChildValues(p[0])).split(/\s+/);var e=[];var m;for(var b=0,f=j.length;b<f;b+=2){m=new OpenLayers.Geometry.Point(parseFloat(j[b+1]),parseFloat(j[b]));e.push(m)}h=new OpenLayers.Geometry.LineString(e)}else{if(k.length>0){var j=OpenLayers.String.trim(this.concatChildValues(k[0])).split(/\s+/);var e=[];var m;for(var b=0,f=j.length;b<f;b+=2){m=new OpenLayers.Geometry.Point(parseFloat(j[b+1]),parseFloat(j[b]));e.push(m)}h=new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(e)])}else{if(c.length>0){if(!this.gmlParser){this.gmlParser=new OpenLayers.Format.GML({xy:this.xy})}var o=this.gmlParser.parseFeature(c[0]);h=o.geometry}else{if(d.length>0){var j=OpenLayers.String.trim(d[0].firstChild.nodeValue).split(/\s+/);var e=[];var m;if(j.length>3){m=new OpenLayers.Geometry.Point(parseFloat(j[1]),parseFloat(j[0]));e.push(m);m=new OpenLayers.Geometry.Point(parseFloat(j[1]),parseFloat(j[2]));e.push(m);m=new OpenLayers.Geometry.Point(parseFloat(j[3]),parseFloat(j[2]));e.push(m);m=new OpenLayers.Geometry.Point(parseFloat(j[3]),parseFloat(j[0]));e.push(m);m=new OpenLayers.Geometry.Point(parseFloat(j[1]),parseFloat(j[0]));e.push(m)}h=new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(e)])}}}}}if(h&&this.internalProjection&&this.externalProjection){h.transform(this.externalProjection,this.internalProjection)}return h},createFeatureFromItem:function(i){var d=this.createGeometryFromItem(i);var g=this.getChildValue(i,"*","title",this.featureTitle);var h=this.getChildValue(i,"*","description",this.getChildValue(i,"*","content",this.getChildValue(i,"*","summary",this.featureDescription)));var f=this.getChildValue(i,"*","link");if(!f){try{f=this.getElementsByTagNameNS(i,"*","link")[0].getAttribute("href")}catch(c){f=null}}var a=this.getChildValue(i,"*","id",null);var b={title:g,description:h,link:f};var j=new OpenLayers.Feature.Vector(d,b);j.fid=a;return j},getChildValue:function(d,b,c,f){var e;var a=this.getElementsByTagNameNS(d,b,c);if(a&&a[0]&&a[0].firstChild&&a[0].firstChild.nodeValue){e=a[0].firstChild.nodeValue}else{e=(f==undefined)?"":f}return e},read:function(e){if(typeof e=="string"){e=OpenLayers.Format.XML.prototype.read.apply(this,[e])}var a=null;a=this.getElementsByTagNameNS(e,"*","item");if(a.length==0){a=this.getElementsByTagNameNS(e,"*","entry")}var c=a.length;var d=new Array(c);for(var b=0;b<c;b++){d[b]=this.createFeatureFromItem(a[b])}return d},write:function(c){var d;if(c instanceof Array){d=this.createElementNS(this.rssns,"rss");for(var b=0,a=c.length;b<a;b++){d.appendChild(this.createFeatureXML(c[b]))}}else{d=this.createFeatureXML(c)}return OpenLayers.Format.XML.prototype.write.apply(this,[d])},createFeatureXML:function(j){var f=this.buildGeometryNode(j.geometry);var a=this.createElementNS(this.rssns,"item");var d=this.createElementNS(this.rssns,"title");d.appendChild(this.createTextNode(j.attributes.title?j.attributes.title:""));var b=this.createElementNS(this.rssns,"description");b.appendChild(this.createTextNode(j.attributes.description?j.attributes.description:""));a.appendChild(d);a.appendChild(b);if(j.attributes.link){var h=this.createElementNS(this.rssns,"link");
h.appendChild(this.createTextNode(j.attributes.link));a.appendChild(h)}for(var i in j.attributes){if(i=="link"||i=="title"||i=="description"){continue}var g=this.createTextNode(j.attributes[i]);var e=i;if(i.search(":")!=-1){e=i.split(":")[1]}var c=this.createElementNS(this.featureNS,"feature:"+e);c.appendChild(g);a.appendChild(c)}a.appendChild(f);return a},buildGeometryNode:function(b){if(this.internalProjection&&this.externalProjection){b=b.clone();b.transform(this.internalProjection,this.externalProjection)}var a;if(b.CLASS_NAME=="OpenLayers.Geometry.Polygon"){a=this.createElementNS(this.georssns,"georss:polygon");a.appendChild(this.buildCoordinatesNode(b.components[0]))}else{if(b.CLASS_NAME=="OpenLayers.Geometry.LineString"){a=this.createElementNS(this.georssns,"georss:line");a.appendChild(this.buildCoordinatesNode(b))}else{if(b.CLASS_NAME=="OpenLayers.Geometry.Point"){a=this.createElementNS(this.georssns,"georss:point");a.appendChild(this.buildCoordinatesNode(b))}else{throw"Couldn't parse "+b.CLASS_NAME}}}return a},buildCoordinatesNode:function(f){var c=null;if(f.components){c=f.components}var e;if(c){var b=c.length;var d=new Array(b);for(var a=0;a<b;a++){d[a]=c[a].y+" "+c[a].x}e=d.join(" ")}else{e=f.y+" "+f.x}return this.createTextNode(e)},CLASS_NAME:"OpenLayers.Format.GeoRSS"});OpenLayers.Format.KML=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{kml:"http://www.opengis.net/kml/2.2",gx:"http://www.google.com/kml/ext/2.2"},kmlns:"http://earth.google.com/kml/2.0",placemarksDesc:"No description available",foldersName:"OpenLayers export",foldersDesc:"Exported on "+new Date(),extractAttributes:true,extractStyles:false,extractTracks:false,trackAttributes:null,internalns:null,features:null,styles:null,styleBaseUrl:"",fetched:null,maxDepth:0,initialize:function(a){this.regExes={trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g),kmlColor:(/(\w{2})(\w{2})(\w{2})(\w{2})/),kmlIconPalette:(/root:\/\/icons\/palette-(\d+)(\.\w+)/),straightBracket:(/\$\[(.*?)\]/g)};this.externalProjection=new OpenLayers.Projection("EPSG:4326");OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(b){this.features=[];this.styles={};this.fetched={};var a={depth:0,styleBaseUrl:this.styleBaseUrl};return this.parseData(b,a)},parseData:function(g,c){if(typeof g=="string"){g=OpenLayers.Format.XML.prototype.read.apply(this,[g])}var e=["Link","NetworkLink","Style","StyleMap","Placemark"];for(var d=0,a=e.length;d<a;++d){var f=e[d];var b=this.getElementsByTagNameNS(g,"*",f);if(b.length==0){continue}switch(f.toLowerCase()){case"link":case"networklink":this.parseLinks(b,c);break;case"style":if(this.extractStyles){this.parseStyles(b,c)}break;case"stylemap":if(this.extractStyles){this.parseStyleMaps(b,c)}break;case"placemark":this.parseFeatures(b,c);break}}return this.features},parseLinks:function(c,d){if(d.depth>=this.maxDepth){return false}var g=OpenLayers.Util.extend({},d);g.depth++;for(var e=0,a=c.length;e<a;e++){var b=this.parseProperty(c[e],"*","href");if(b&&!this.fetched[b]){this.fetched[b]=true;var f=this.fetchLink(b);if(f){this.parseData(f,g)}}}},fetchLink:function(a){var b=OpenLayers.Request.GET({url:a,async:false});if(b){return b.responseText}},parseStyles:function(b,c){for(var e=0,a=b.length;e<a;e++){var f=this.parseStyle(b[e]);if(f){var d=(c.styleBaseUrl||"")+"#"+f.id;this.styles[d]=f}}},parseKmlColor:function(b){var a=null;if(b){var c=b.match(this.regExes.kmlColor);if(c){a={color:"#"+c[4]+c[3]+c[2],opacity:parseInt(c[1],16)/255}}}return a},parseStyle:function(z){var H={};var q=["LineStyle","PolyStyle","IconStyle","BalloonStyle","LabelStyle"];var e,K,g,d;for(var E=0,G=q.length;E<G;++E){e=q[E];styleTypeNode=this.getElementsByTagNameNS(z,"*",e)[0];if(!styleTypeNode){continue}switch(e.toLowerCase()){case"linestyle":var c=this.parseProperty(styleTypeNode,"*","color");var B=this.parseKmlColor(c);if(B){H.strokeColor=B.color;H.strokeOpacity=B.opacity}var v=this.parseProperty(styleTypeNode,"*","width");if(v){H.strokeWidth=v
}break;case"polystyle":var c=this.parseProperty(styleTypeNode,"*","color");var B=this.parseKmlColor(c);if(B){H.fillOpacity=B.opacity;H.fillColor=B.color}var C=this.parseProperty(styleTypeNode,"*","fill");if(C=="0"){H.fillColor="none"}var j=this.parseProperty(styleTypeNode,"*","outline");if(j=="0"){H.strokeWidth="0"}break;case"iconstyle":var M=parseFloat(this.parseProperty(styleTypeNode,"*","scale")||1);var v=32*M;var t=32*M;var L=this.getElementsByTagNameNS(styleTypeNode,"*","Icon")[0];if(L){var D=this.parseProperty(L,"*","href");if(D){var p=this.parseProperty(L,"*","w");var F=this.parseProperty(L,"*","h");var f="http://maps.google.com/mapfiles/kml";if(OpenLayers.String.startsWith(D,f)&&!p&&!F){p=64;F=64;M=M/2}p=p||F;F=F||p;if(p){v=parseInt(p)*M}if(F){t=parseInt(F)*M}var b=D.match(this.regExes.kmlIconPalette);if(b){var I=b[1];var s=b[2];var o=this.parseProperty(L,"*","x");var n=this.parseProperty(L,"*","y");var m=o?o/32:0;var l=n?(7-n/32):7;var k=l*8+m;D="http://maps.google.com/mapfiles/kml/pal"+I+"/icon"+k+s}H.graphicOpacity=1;H.externalGraphic=D}}var r=this.getElementsByTagNameNS(styleTypeNode,"*","hotSpot")[0];if(r){var o=parseFloat(r.getAttribute("x"));var n=parseFloat(r.getAttribute("y"));var A=r.getAttribute("xunits");if(A=="pixels"){H.graphicXOffset=-o*M}else{if(A=="insetPixels"){H.graphicXOffset=-v+(o*M)}else{if(A=="fraction"){H.graphicXOffset=-v*o}}}var J=r.getAttribute("yunits");if(J=="pixels"){H.graphicYOffset=-t+(n*M)+1}else{if(J=="insetPixels"){H.graphicYOffset=-(n*M)+1}else{if(J=="fraction"){H.graphicYOffset=-t*(1-n)+1}}}}H.graphicWidth=v;H.graphicHeight=t;break;case"balloonstyle":var a=OpenLayers.Util.getXmlNodeValue(styleTypeNode);if(a){H.balloonStyle=a.replace(this.regExes.straightBracket,"${$1}")}break;case"labelstyle":var c=this.parseProperty(styleTypeNode,"*","color");var B=this.parseKmlColor(c);if(B){H.fontColor=B.color;H.fontOpacity=B.opacity}break;default:}}if(!H.strokeColor&&H.fillColor){H.strokeColor=H.fillColor}var u=z.getAttribute("id");if(u&&H){H.id=u}return H},parseStyleMaps:function(a,n){for(var g=0,h=a.length;g<h;g++){var d=a[g];var c=this.getElementsByTagNameNS(d,"*","Pair");var b=d.getAttribute("id");for(var f=0,m=c.length;f<m;f++){var e=c[f];var l=this.parseProperty(e,"*","key");var k=this.parseProperty(e,"*","styleUrl");if(k&&l=="normal"){this.styles[(n.styleBaseUrl||"")+"#"+b]=this.styles[(n.styleBaseUrl||"")+k]}if(k&&l=="highlight"){}}}},parseFeatures:function(b,m){var f=[];for(var g=0,h=b.length;g<h;g++){var c=b[g];var l=this.parseFeature.apply(this,[c]);if(l){if(this.extractStyles&&l.attributes&&l.attributes.styleUrl){l.style=this.getStyle(l.attributes.styleUrl,m)}if(this.extractStyles){var k=this.getElementsByTagNameNS(c,"*","Style")[0];if(k){var e=this.parseStyle(k);if(e){l.style=OpenLayers.Util.extend(l.style,e)}}}if(this.extractTracks){var j=this.getElementsByTagNameNS(c,this.namespaces.gx,"Track");if(j&&j.length>0){var d=j[0];var a={features:[],feature:l};this.readNode(d,a);if(a.features.length>0){f.push.apply(f,a.features)}}}else{f.push(l)}}else{throw"Bad Placemark: "+g}}this.features=this.features.concat(f)},readers:{kml:{when:function(b,a){a.whens.push(OpenLayers.Date.parse(this.getChildValue(b)))},_trackPointAttribute:function(c,a){var b=c.nodeName.split(":").pop();a.attributes[b].push(this.getChildValue(c))}},gx:{Track:function(c,b){var e={whens:[],points:[],angles:[]};if(this.trackAttributes){var a;e.attributes={};for(var f=0,m=this.trackAttributes.length;f<m;++f){a=this.trackAttributes[f];e.attributes[a]=[];if(!(a in this.readers.kml)){this.readers.kml[a]=this.readers.kml._trackPointAttribute}}}this.readChildNodes(c,e);if(e.whens.length!==e.points.length){throw new Error("gx:Track with unequal number of when ("+e.whens.length+") and gx:coord ("+e.points.length+") elements.")}var k=e.angles.length>0;if(k&&e.whens.length!==e.angles.length){throw new Error("gx:Track with unequal number of when ("+e.whens.length+") and gx:angles ("+e.angles.length+") elements.")}var n,l,h;for(var f=0,m=e.whens.length;
f<m;++f){n=b.feature.clone();n.fid=b.feature.fid||b.feature.id;l=e.points[f];n.geometry=l;if("z" in l){n.attributes.altitude=l.z}if(this.internalProjection&&this.externalProjection){n.geometry.transform(this.externalProjection,this.internalProjection)}if(this.trackAttributes){for(var d=0,g=this.trackAttributes.length;d<g;++d){n.attributes[a]=e.attributes[this.trackAttributes[d]][f]}}n.attributes.when=e.whens[f];n.attributes.trackId=b.feature.id;if(k){h=e.angles[f];n.attributes.heading=parseFloat(h[0]);n.attributes.tilt=parseFloat(h[1]);n.attributes.roll=parseFloat(h[2])}b.features.push(n)}},coord:function(c,b){var e=this.getChildValue(c);var d=e.replace(this.regExes.trimSpace,"").split(/\s+/);var a=new OpenLayers.Geometry.Point(d[0],d[1]);if(d.length>2){a.z=parseFloat(d[2])}b.points.push(a)},angles:function(b,a){var d=this.getChildValue(b);var c=d.replace(this.regExes.trimSpace,"").split(/\s+/);a.angles.push(c)}}},parseFeature:function(b){var c=["MultiGeometry","Polygon","LineString","Point"];var j,e,k,a;for(var g=0,h=c.length;g<h;++g){j=c[g];this.internalns=b.namespaceURI?b.namespaceURI:this.kmlns;e=this.getElementsByTagNameNS(b,this.internalns,j);if(e.length>0){var a=this.parseGeometry[j.toLowerCase()];if(a){k=a.apply(this,[e[0]]);if(this.internalProjection&&this.externalProjection){k.transform(this.externalProjection,this.internalProjection)}}else{OpenLayers.Console.error(OpenLayers.i18n("unsupportedGeometryType",{geomType:j}))}break}}var f;if(this.extractAttributes){f=this.parseAttributes(b)}var l=new OpenLayers.Feature.Vector(k,f);var d=b.getAttribute("id")||b.getAttribute("name");if(d!=null){l.fid=d}return l},getStyle:function(b,a){var c=OpenLayers.Util.removeTail(b);var f=OpenLayers.Util.extend({},a);f.depth++;f.styleBaseUrl=c;if(!this.styles[b]&&!OpenLayers.String.startsWith(b,"#")&&f.depth<=this.maxDepth&&!this.fetched[c]){var e=this.fetchLink(c);if(e){this.parseData(e,f)}}var d=OpenLayers.Util.extend({},this.styles[b]);return d},parseGeometry:{point:function(d){var c=this.getElementsByTagNameNS(d,this.internalns,"coordinates");var e=[];if(c.length>0){var b=c[0].firstChild.nodeValue;b=b.replace(this.regExes.removeSpace,"");e=b.split(",")}var a=null;if(e.length>1){if(e.length==2){e[2]=null}a=new OpenLayers.Geometry.Point(e[0],e[1],e[2])}else{throw"Bad coordinate string: "+b}return a},linestring:function(c,e){var d=this.getElementsByTagNameNS(c,this.internalns,"coordinates");var l=null;if(d.length>0){var b=this.getChildValue(d[0]);b=b.replace(this.regExes.trimSpace,"");b=b.replace(this.regExes.trimComma,",");var a=b.split(this.regExes.splitSpace);var h=a.length;var k=new Array(h);var j,g;for(var f=0;f<h;++f){j=a[f].split(",");g=j.length;if(g>1){if(j.length==2){j[2]=null}k[f]=new OpenLayers.Geometry.Point(j[0],j[1],j[2])}else{throw"Bad LineString point coordinates: "+a[f]}}if(h){if(e){l=new OpenLayers.Geometry.LinearRing(k)}else{l=new OpenLayers.Geometry.LineString(k)}}else{throw"Bad LineString coordinates: "+b}}return l},polygon:function(f){var c=this.getElementsByTagNameNS(f,this.internalns,"LinearRing");var g=c.length;var e=new Array(g);if(g>0){var b;for(var d=0,a=c.length;d<a;++d){b=this.parseGeometry.linestring.apply(this,[c[d],true]);if(b){e[d]=b}else{throw"Bad LinearRing geometry: "+d}}}return new OpenLayers.Geometry.Polygon(e)},multigeometry:function(e){var h,g;var f=[];var c=e.childNodes;for(var b=0,a=c.length;b<a;++b){h=c[b];if(h.nodeType==1){var d=(h.prefix)?h.nodeName.split(":")[1]:h.nodeName;var g=this.parseGeometry[d.toLowerCase()];if(g){f.push(g.apply(this,[h]))}}}return new OpenLayers.Geometry.Collection(f)}},parseAttributes:function(d){var f={};var h=d.getElementsByTagName("ExtendedData");if(h.length){f=this.parseExtendedData(h[0])}var b,n,m;var c=d.childNodes;for(var j=0,k=c.length;j<k;++j){b=c[j];if(b.nodeType==1){n=b.childNodes;if(n.length>=1&&n.length<=3){var m;switch(n.length){case 1:m=n[0];break;case 2:var g=n[0];var e=n[1];m=(g.nodeType==3||g.nodeType==4)?g:e;break;case 3:default:m=n[1];break}if(m.nodeType==3||m.nodeType==4){var a=(b.prefix)?b.nodeName.split(":")[1]:b.nodeName;
var l=OpenLayers.Util.getXmlNodeValue(m);if(l){l=l.replace(this.regExes.trimSpace,"");f[a]=l}}}}}return f},parseExtendedData:function(b){var d={};var f,h,e,k;var c=b.getElementsByTagName("Data");for(f=0,h=c.length;f<h;f++){e=c[f];k=e.getAttribute("name");var g={};var l=e.getElementsByTagName("value");if(l.length){g.value=this.getChildValue(l[0])}var a=e.getElementsByTagName("displayName");if(a.length){g.displayName=this.getChildValue(a[0])}d[k]=g}var j=b.getElementsByTagName("SimpleData");for(f=0,h=j.length;f<h;f++){var g={};e=j[f];k=e.getAttribute("name");g.value=this.getChildValue(e);g.displayName=k;d[k]=g}return d},parseProperty:function(c,d,b){var f;var a=this.getElementsByTagNameNS(c,d,b);try{f=OpenLayers.Util.getXmlNodeValue(a[0])}catch(g){f=null}return f},write:function(d){if(!(d instanceof Array)){d=[d]}var b=this.createElementNS(this.kmlns,"kml");var e=this.createFolderXML();for(var c=0,a=d.length;c<a;++c){e.appendChild(this.createPlacemarkXML(d[c]))}b.appendChild(e);return OpenLayers.Format.XML.prototype.write.apply(this,[b])},createFolderXML:function(){var c=this.createElementNS(this.kmlns,"Folder");if(this.foldersName){var e=this.createElementNS(this.kmlns,"name");var d=this.createTextNode(this.foldersName);e.appendChild(d);c.appendChild(e)}if(this.foldersDesc){var a=this.createElementNS(this.kmlns,"description");var b=this.createTextNode(this.foldersDesc);a.appendChild(b);c.appendChild(a)}return c},createPlacemarkXML:function(e){var g=this.createElementNS(this.kmlns,"name");var c=e.style&&e.style.label?e.style.label:e.attributes.name||e.id;g.appendChild(this.createTextNode(c));var d=this.createElementNS(this.kmlns,"description");var f=e.attributes.description||this.placemarksDesc;d.appendChild(this.createTextNode(f));var b=this.createElementNS(this.kmlns,"Placemark");if(e.fid!=null){b.setAttribute("id",e.fid)}b.appendChild(g);b.appendChild(d);var a=this.buildGeometryNode(e.geometry);b.appendChild(a);return b},buildGeometryNode:function(e){if(this.internalProjection&&this.externalProjection){e=e.clone();e.transform(this.internalProjection,this.externalProjection)}var c=e.CLASS_NAME;var b=c.substring(c.lastIndexOf(".")+1);var a=this.buildGeometry[b.toLowerCase()];var d=null;if(a){d=a.apply(this,[e])}return d},buildGeometry:{point:function(b){var a=this.createElementNS(this.kmlns,"Point");a.appendChild(this.buildCoordinatesNode(b));return a},multipoint:function(a){return this.buildGeometry.collection.apply(this,[a])},linestring:function(b){var a=this.createElementNS(this.kmlns,"LineString");a.appendChild(this.buildCoordinatesNode(b));return a},multilinestring:function(a){return this.buildGeometry.collection.apply(this,[a])},linearring:function(b){var a=this.createElementNS(this.kmlns,"LinearRing");a.appendChild(this.buildCoordinatesNode(b));return a},polygon:function(h){var b=this.createElementNS(this.kmlns,"Polygon");var g=h.components;var e,f,d;for(var c=0,a=g.length;c<a;++c){d=(c==0)?"outerBoundaryIs":"innerBoundaryIs";e=this.createElementNS(this.kmlns,d);f=this.buildGeometry.linearring.apply(this,[g[c]]);e.appendChild(f);b.appendChild(e)}return b},multipolygon:function(a){return this.buildGeometry.collection.apply(this,[a])},collection:function(d){var b=this.createElementNS(this.kmlns,"MultiGeometry");var e;for(var c=0,a=d.components.length;c<a;++c){e=this.buildGeometryNode.apply(this,[d.components[c]]);if(e){b.appendChild(e)}}return b}},buildCoordinatesNode:function(e){var a=this.createElementNS(this.kmlns,"coordinates");var j;var h=e.components;if(h){var g;var f=h.length;var c=new Array(f);for(var d=0;d<f;++d){g=h[d];c[d]=g.x+","+g.y}j=c.join(" ")}else{j=e.x+","+e.y}var b=this.createTextNode(j);a.appendChild(b);return a},CLASS_NAME:"OpenLayers.Format.KML"});OpenLayers.Format.OSM=OpenLayers.Class(OpenLayers.Format.XML,{checkTags:false,interestingTagsExclude:null,areaTags:null,initialize:function(a){var d={interestingTagsExclude:["source","source_ref","source:ref","history","attribution","created_by"],areaTags:["area","building","leisure","tourism","ruins","historic","landuse","military","natural","sport"]};
d=OpenLayers.Util.extend(d,a);var e={};for(var b=0;b<d.interestingTagsExclude.length;b++){e[d.interestingTagsExclude[b]]=true}d.interestingTagsExclude=e;var c={};for(var b=0;b<d.areaTags.length;b++){c[d.areaTags[b]]=true}d.areaTags=c;this.externalProjection=new OpenLayers.Projection("EPSG:4326");OpenLayers.Format.XML.prototype.initialize.apply(this,[d])},read:function(n){if(typeof n=="string"){n=OpenLayers.Format.XML.prototype.read.apply(this,[n])}var b=this.getNodes(n);var o=this.getWays(n);var g=new Array(o.length);for(var f=0;f<o.length;f++){var l=new Array(o[f].nodes.length);var a=this.isWayArea(o[f])?1:0;for(var e=0;e<o[f].nodes.length;e++){var c=b[o[f].nodes[e]];var m=new OpenLayers.Geometry.Point(c.lon,c.lat);m.osm_id=parseInt(o[f].nodes[e]);l[e]=m;c.used=true}var k=null;if(a){k=new OpenLayers.Geometry.Polygon(new OpenLayers.Geometry.LinearRing(l))}else{k=new OpenLayers.Geometry.LineString(l)}if(this.internalProjection&&this.externalProjection){k.transform(this.externalProjection,this.internalProjection)}var h=new OpenLayers.Feature.Vector(k,o[f].tags);h.osm_id=parseInt(o[f].id);h.fid="way."+h.osm_id;g[f]=h}for(var d in b){var c=b[d];if(!c.used||this.checkTags){var q=null;if(this.checkTags){var p=this.getTags(c.node,true);if(c.used&&!p[1]){continue}q=p[0]}else{q=this.getTags(c.node)}var h=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(c.lon,c.lat),q);if(this.internalProjection&&this.externalProjection){h.geometry.transform(this.externalProjection,this.internalProjection)}h.osm_id=parseInt(d);h.fid="node."+h.osm_id;g.push(h)}c.node=null}return g},getNodes:function(e){var d=e.getElementsByTagName("node");var a={};for(var b=0;b<d.length;b++){var c=d[b];var f=c.getAttribute("id");a[f]={lat:c.getAttribute("lat"),lon:c.getAttribute("lon"),node:c}}return a},getWays:function(g){var f=g.getElementsByTagName("way");var h=[];for(var d=0;d<f.length;d++){var b=f[d];var c={id:b.getAttribute("id")};c.tags=this.getTags(b);var e=b.getElementsByTagName("nd");c.nodes=new Array(e.length);for(var a=0;a<e.length;a++){c.nodes[a]=e[a].getAttribute("ref")}h.push(c)}return h},getTags:function(e,g){var a=e.getElementsByTagName("tag");var c={};var f=false;for(var b=0;b<a.length;b++){var d=a[b].getAttribute("k");c[d]=a[b].getAttribute("v");if(g){if(!this.interestingTagsExclude[d]){f=true}}}return g?[c,f]:c},isWayArea:function(b){var a=false;var d=false;if(b.nodes[0]==b.nodes[b.nodes.length-1]){a=true}if(this.checkTags){for(var c in b.tags){if(this.areaTags[c]){d=true;break}}}return a&&(this.checkTags?d:true)},write:function(d){if(!(d instanceof Array)){d=[d]}this.osm_id=1;this.created_nodes={};var e=this.createElementNS(null,"osm");e.setAttribute("version","0.5");e.setAttribute("generator","OpenLayers "+OpenLayers.VERSION_NUMBER);for(var c=d.length-1;c>=0;c--){var a=this.createFeatureNodes(d[c]);for(var b=0;b<a.length;b++){e.appendChild(a[b])}}return OpenLayers.Format.XML.prototype.write.apply(this,[e])},createFeatureNodes:function(c){var b=[];var e=c.geometry.CLASS_NAME;var d=e.substring(e.lastIndexOf(".")+1);d=d.toLowerCase();var a=this.createXML[d];if(a){b=a.apply(this,[c])}return b},createXML:{point:function(a){var e=null;var c=a.geometry?a.geometry:a;var d=false;if(a.osm_id){e=a.osm_id;if(this.created_nodes[e]){d=true}}else{e=-this.osm_id;this.osm_id++}if(d){b=this.created_nodes[e]}else{var b=this.createElementNS(null,"node")}this.created_nodes[e]=b;b.setAttribute("id",e);b.setAttribute("lon",c.x);b.setAttribute("lat",c.y);if(a.attributes){this.serializeTags(a,b)}this.setState(a,b);return d?[]:[b]},linestring:function(d){var a=[];var h=d.geometry;if(d.osm_id){id=d.osm_id}else{id=-this.osm_id;this.osm_id++}var b=this.createElementNS(null,"way");b.setAttribute("id",id);for(var c=0;c<h.components.length;c++){var f=this.createXML.point.apply(this,[h.components[c]]);if(f.length){f=f[0];var e=f.getAttribute("id");a.push(f)}else{e=h.components[c].osm_id;f=this.created_nodes[e]}this.setState(d,f);var g=this.createElementNS(null,"nd");g.setAttribute("ref",e);
b.appendChild(g)}this.serializeTags(d,b);a.push(b);return a},polygon:function(b){var a=OpenLayers.Util.extend({area:"yes"},b.attributes);var c=new OpenLayers.Feature.Vector(b.geometry.components[0],a);c.osm_id=b.osm_id;return this.createXML.linestring.apply(this,[c])}},serializeTags:function(c,d){for(var b in c.attributes){var a=this.createElementNS(null,"tag");a.setAttribute("k",b);a.setAttribute("v",c.attributes[b]);d.appendChild(a)}},setState:function(a,b){if(a.state){var c=null;switch(a.state){case OpenLayers.State.UPDATE:c="modify";case OpenLayers.State.DELETE:c="delete"}if(c){b.setAttribute("action",c)}}},CLASS_NAME:"OpenLayers.Format.OSM"});OpenLayers.Geometry.MultiPolygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Polygon"],initialize:function(a){OpenLayers.Geometry.Collection.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Geometry.MultiPolygon"});OpenLayers.Handler.Polygon=OpenLayers.Class(OpenLayers.Handler.Path,{polygon:null,initialize:function(c,b,a){OpenLayers.Handler.Path.prototype.initialize.apply(this,arguments)},createFeature:function(a){var b=this.control.map.getLonLatFromPixel(a);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(b.lon,b.lat));this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LinearRing([this.point.geometry]));this.polygon=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon([this.line.geometry]));this.callback("create",[this.point.geometry,this.getSketch()]);this.point.geometry.clearBounds();this.layer.addFeatures([this.polygon,this.point],{silent:true})},destroyFeature:function(){OpenLayers.Handler.Path.prototype.destroyFeature.apply(this);this.polygon=null},drawFeature:function(){this.layer.drawFeature(this.polygon,this.style);this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.polygon},getGeometry:function(){var a=this.polygon&&this.polygon.geometry;if(a&&this.multi){a=new OpenLayers.Geometry.MultiPolygon([a])}return a},dblclick:function(a){if(!this.freehandMode(a)){var b=this.line.geometry.components.length-2;this.line.geometry.removeComponent(this.line.geometry.components[b]);this.removePoint();this.finalize()}return false},CLASS_NAME:"OpenLayers.Handler.Polygon"});OpenLayers.Control.EditingToolbar=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(c,b){OpenLayers.Control.Panel.prototype.initialize.apply(this,[b]);this.addControls([new OpenLayers.Control.Navigation()]);var a=[new OpenLayers.Control.DrawFeature(c,OpenLayers.Handler.Point,{displayClass:"olControlDrawFeaturePoint"}),new OpenLayers.Control.DrawFeature(c,OpenLayers.Handler.Path,{displayClass:"olControlDrawFeaturePath"}),new OpenLayers.Control.DrawFeature(c,OpenLayers.Handler.Polygon,{displayClass:"olControlDrawFeaturePolygon"})];this.addControls(a)},draw:function(){var a=OpenLayers.Control.Panel.prototype.draw.apply(this,arguments);this.activateControl(this.controls[0]);return a},CLASS_NAME:"OpenLayers.Control.EditingToolbar"});OpenLayers.Control.SLDSelect=OpenLayers.Class(OpenLayers.Control,{EVENT_TYPES:["selected"],clearOnDeactivate:false,layers:null,callbacks:null,selectionSymbolizer:{Polygon:{fillColor:"#FF0000",stroke:false},Line:{strokeColor:"#FF0000",strokeWidth:2},Point:{graphicName:"square",fillColor:"#FF0000",pointRadius:5}},layerOptions:null,handlerOptions:null,sketchStyle:null,wfsCache:{},layerCache:{},initialize:function(b,a){this.EVENT_TYPES=OpenLayers.Control.SLDSelect.prototype.EVENT_TYPES.concat(OpenLayers.Control.prototype.EVENT_TYPES);OpenLayers.Control.prototype.initialize.apply(this,[a]);this.callbacks=OpenLayers.Util.extend({done:this.select,click:this.select},this.callbacks);this.handlerOptions=this.handlerOptions||{};this.layerOptions=OpenLayers.Util.applyDefaults(this.layerOptions,{displayInLayerSwitcher:false});if(this.sketchStyle){this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{styleMap:new OpenLayers.StyleMap({"default":this.sketchStyle})})
}this.handler=new b(this,this.callbacks,this.handlerOptions)},destroy:function(){for(var a in this.layerCache){delete this.layerCache[a]}for(var a in this.wfsCache){delete this.wfsCache[a]}OpenLayers.Control.prototype.destroy.apply(this,arguments)},coupleLayerVisiblity:function(a){this.setVisibility(a.object.getVisibility())},createSelectionLayer:function(b){var a;if(!this.layerCache[b.id]){a=new OpenLayers.Layer.WMS.Post(b.name,b.url,b.params,OpenLayers.Util.applyDefaults(this.layerOptions,b.getOptions()));this.layerCache[b.id]=a;if(this.layerOptions.displayInLayerSwitcher===false){b.events.on({visibilitychanged:this.coupleLayerVisiblity,scope:a})}this.map.addLayer(a)}else{a=this.layerCache[b.id]}return a},createSLD:function(f,d,g){var a={version:"1.0.0",namedLayers:{}};var j=[f.params.LAYERS].join(",").split(",");for(var e=0,h=j.length;e<h;e++){var b=j[e];a.namedLayers[b]={name:b,userStyles:[]};var l=this.selectionSymbolizer;var k=g[e];if(k.type.indexOf("Polygon")>=0){l={Polygon:this.selectionSymbolizer.Polygon}}else{if(k.type.indexOf("LineString")>=0){l={Line:this.selectionSymbolizer.Line}}else{if(k.type.indexOf("Point")>=0){l={Point:this.selectionSymbolizer.Point}}}}var c=d[e];a.namedLayers[b].userStyles.push({name:"default",rules:[new OpenLayers.Rule({symbolizer:l,filter:c,maxScaleDenominator:f.options.minScale})]})}return new OpenLayers.Format.SLD().write(a)},parseDescribeLayer:function(c){var g=new OpenLayers.Format.WMSDescribeLayer();var h=c.responseXML;if(!h||!h.documentElement){h=c.responseText}var b=g.read(h);var f=[];var a=null;for(var d=0,e=b.length;d<e;d++){if(b[d].owsType=="WFS"){f.push(b[d].typeName);a=b[d].owsURL}}var j={url:a,params:{SERVICE:"WFS",TYPENAME:f.toString(),REQUEST:"DescribeFeatureType",VERSION:"1.0.0"},callback:function(k){var m=new OpenLayers.Format.WFSDescribeFeatureType();var l=k.responseXML;if(!l||!l.documentElement){l=k.responseText}var i=m.read(l);this.control.wfsCache[this.layer.id]=i;this.control._queue&&this.control.applySelection()},scope:this};OpenLayers.Request.GET(j)},getGeometryAttributes:function(d){var m=[];var a=this.wfsCache[d.id];for(var c=0,e=a.featureTypes.length;c<e;c++){var h=a.featureTypes[c];var f=h.properties;for(var b=0,l=f.length;b<l;b++){var k=f[b];var g=k.type;if((g.indexOf("LineString")>=0)||(g.indexOf("GeometryAssociationType")>=0)||(g.indexOf("GeometryPropertyType")>=0)||(g.indexOf("Point")>=0)||(g.indexOf("Polygon")>=0)){m.push(k)}}}return m},activate:function(){var b=OpenLayers.Control.prototype.activate.call(this);if(b){for(var e=0,a=this.layers.length;e<a;e++){var d=this.layers[e];if(d&&!this.wfsCache[d.id]){var c={url:d.url,params:{SERVICE:"WMS",VERSION:d.params.VERSION,LAYERS:d.params.LAYERS,REQUEST:"DescribeLayer"},callback:this.parseDescribeLayer,scope:{layer:d,control:this}};OpenLayers.Request.GET(c)}}}return b},deactivate:function(){var f=OpenLayers.Control.prototype.deactivate.call(this);if(f){for(var e=0,a=this.layers.length;e<a;e++){var d=this.layers[e];if(d&&this.clearOnDeactivate===true){var c=this.layerCache;var b=c[d.id];if(b){d.events.un({visibilitychanged:this.coupleLayerVisiblity,scope:b});b.destroy();delete c[d.id]}}}}return f},setLayers:function(a){if(this.active){this.deactivate();this.layers=a;this.activate()}else{this.layers=a}},createFilter:function(a,c){var b=null;if(this.handler instanceof OpenLayers.Handler.RegularPolygon){if(this.handler.irregular===true){b=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,property:a.name,value:c.getBounds()})}else{b=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:a.name,value:c})}}else{if(this.handler instanceof OpenLayers.Handler.Polygon){b=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:a.name,value:c})}else{if(this.handler instanceof OpenLayers.Handler.Path){if(a.type.indexOf("Point")>=0){b=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.DWITHIN,property:a.name,distance:this.map.getExtent().getWidth()*0.01,distanceUnits:this.map.getUnits(),value:c})
}else{b=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:a.name,value:c})}}else{if(this.handler instanceof OpenLayers.Handler.Click){if(a.type.indexOf("Polygon")>=0){b=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:a.name,value:c})}else{b=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.DWITHIN,property:a.name,distance:this.map.getExtent().getWidth()*0.01,distanceUnits:this.map.getUnits(),value:c})}}}}}return b},select:function(a){this._queue=function(){for(var g=0,l=this.layers.length;g<l;g++){var h=this.layers[g];var k=this.getGeometryAttributes(h);var d=[];for(var f=0,n=k.length;f<n;f++){var o=k[f];if(o!==null){if(!(a instanceof OpenLayers.Geometry)){var m=this.map.getLonLatFromPixel(a.xy);a=new OpenLayers.Geometry.Point(m.lon,m.lat)}var c=this.createFilter(o,a);if(c!==null){d.push(c)}}}var e=this.createSelectionLayer(h);var b=this.createSLD(h,d,k);this.events.triggerEvent("selected",{layer:h,filters:d});e.mergeNewParams({SLD_BODY:b});delete this._queue}};this.applySelection()},applySelection:function(){var c=true;for(var b=0,a=this.layers.length;b<a;b++){if(!this.wfsCache[this.layers[b].id]){c=false;break}}c&&this._queue.call(this)},CLASS_NAME:"OpenLayers.Control.SLDSelect"});OpenLayers.Format.ArcXML=OpenLayers.Class(OpenLayers.Format.XML,{fontStyleKeys:["antialiasing","blockout","font","fontcolor","fontsize","fontstyle","glowing","interval","outline","printmode","shadow","transparency"],request:null,response:null,initialize:function(a){this.request=new OpenLayers.Format.ArcXML.Request();this.response=new OpenLayers.Format.ArcXML.Response();if(a){if(a.requesttype=="feature"){this.request.get_image=null;var c=this.request.get_feature.query;this.addCoordSys(c.featurecoordsys,a.featureCoordSys);this.addCoordSys(c.filtercoordsys,a.filterCoordSys);if(a.polygon){c.isspatial=true;c.spatialfilter.polygon=a.polygon}else{if(a.envelope){c.isspatial=true;c.spatialfilter.envelope={minx:0,miny:0,maxx:0,maxy:0};this.parseEnvelope(c.spatialfilter.envelope,a.envelope)}}}else{if(a.requesttype=="image"){this.request.get_feature=null;var b=this.request.get_image.properties;this.parseEnvelope(b.envelope,a.envelope);this.addLayers(b.layerlist,a.layers);this.addImageSize(b.imagesize,a.tileSize);this.addCoordSys(b.featurecoordsys,a.featureCoordSys);this.addCoordSys(b.filtercoordsys,a.filterCoordSys)}else{this.request=null}}}OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},parseEnvelope:function(b,a){if(a&&a.length==4){b.minx=a[0];b.miny=a[1];b.maxx=a[2];b.maxy=a[3]}},addLayers:function(d,c){for(var b=0,a=c.length;b<a;b++){d.push(c[b])}},addImageSize:function(b,a){if(a!==null){b.width=a.w;b.height=a.h;b.printwidth=a.w;b.printheight=a.h}},addCoordSys:function(a,b){if(typeof b=="string"){a.id=parseInt(b);a.string=b}else{if(typeof b=="object"&&b.proj!==null){a.id=b.proj.srsProjNumber;a.string=b.proj.srsCode}else{a=b}}},iserror:function(c){var a=null;if(!c){a=(this.response.error!=="")}else{c=OpenLayers.Format.XML.prototype.read.apply(this,[c]);var b=c.documentElement.getElementsByTagName("ERROR");a=(b!==null&&b.length>0)}return a},read:function(f){if(typeof f=="string"){f=OpenLayers.Format.XML.prototype.read.apply(this,[f])}var a=null;if(f&&f.documentElement){if(f.documentElement.nodeName=="ARCXML"){a=f.documentElement}else{a=f.documentElement.getElementsByTagName("ARCXML")[0]}}if(!a||a.firstChild.nodeName==="parsererror"){var c,e;try{c=f.firstChild.nodeValue;e=f.firstChild.childNodes[1].firstChild.nodeValue}catch(d){}throw {message:"Error parsing the ArcXML request",error:c,source:e}}var b=this.parseResponse(a);return b},write:function(c){if(!c){c=this.request}var q=this.createElementNS("","ARCXML");q.setAttribute("version","1.1");var h=this.createElementNS("","REQUEST");if(c.get_image!=null){var k=this.createElementNS("","GET_IMAGE");h.appendChild(k);var j=this.createElementNS("","PROPERTIES");k.appendChild(j);var b=c.get_image.properties;if(b.featurecoordsys!=null){var o=this.createElementNS("","FEATURECOORDSYS");
j.appendChild(o);if(b.featurecoordsys.id===0){o.setAttribute("string",b.featurecoordsys.string)}else{o.setAttribute("id",b.featurecoordsys.id)}}if(b.filtercoordsys!=null){var m=this.createElementNS("","FILTERCOORDSYS");j.appendChild(m);if(b.filtercoordsys.id===0){m.setAttribute("string",b.filtercoordsys.string)}else{m.setAttribute("id",b.filtercoordsys.id)}}if(b.envelope!=null){var u=this.createElementNS("","ENVELOPE");j.appendChild(u);u.setAttribute("minx",b.envelope.minx);u.setAttribute("miny",b.envelope.miny);u.setAttribute("maxx",b.envelope.maxx);u.setAttribute("maxy",b.envelope.maxy)}var s=this.createElementNS("","IMAGESIZE");j.appendChild(s);s.setAttribute("height",b.imagesize.height);s.setAttribute("width",b.imagesize.width);if(b.imagesize.height!=b.imagesize.printheight||b.imagesize.width!=b.imagesize.printwidth){s.setAttribute("printheight",b.imagesize.printheight);s.setArrtibute("printwidth",b.imagesize.printwidth)}if(b.background!=null){var a=this.createElementNS("","BACKGROUND");j.appendChild(a);a.setAttribute("color",b.background.color.r+","+b.background.color.g+","+b.background.color.b);if(b.background.transcolor!==null){a.setAttribute("transcolor",b.background.transcolor.r+","+b.background.transcolor.g+","+b.background.transcolor.b)}}if(b.layerlist!=null&&b.layerlist.length>0){var g=this.createElementNS("","LAYERLIST");j.appendChild(g);for(var p=0;p<b.layerlist.length;p++){var n=this.createElementNS("","LAYERDEF");g.appendChild(n);n.setAttribute("id",b.layerlist[p].id);n.setAttribute("visible",b.layerlist[p].visible);if(typeof b.layerlist[p].query=="object"){var f=b.layerlist[p].query;if(f.where.length<0){continue}var x=null;if(typeof f.spatialfilter=="boolean"&&f.spatialfilter){x=this.createElementNS("","SPATIALQUERY")}else{x=this.createElementNS("","QUERY")}x.setAttribute("where",f.where);if(typeof f.accuracy=="number"&&f.accuracy>0){x.setAttribute("accuracy",f.accuracy)}if(typeof f.featurelimit=="number"&&f.featurelimit<2000){x.setAttribute("featurelimit",f.featurelimit)}if(typeof f.subfields=="string"&&f.subfields!="#ALL#"){x.setAttribute("subfields",f.subfields)}if(typeof f.joinexpression=="string"&&f.joinexpression.length>0){x.setAttribute("joinexpression",f.joinexpression)}if(typeof f.jointables=="string"&&f.jointables.length>0){x.setAttribute("jointables",f.jointables)}n.appendChild(x)}if(typeof b.layerlist[p].renderer=="object"){this.addRenderer(n,b.layerlist[p].renderer)}}}}else{if(c.get_feature!=null){var k=this.createElementNS("","GET_FEATURES");k.setAttribute("outputmode","newxml");k.setAttribute("checkesc","true");if(c.get_feature.geometry){k.setAttribute("geometry",c.get_feature.geometry)}else{k.setAttribute("geometry","false")}if(c.get_feature.compact){k.setAttribute("compact",c.get_feature.compact)}if(c.get_feature.featurelimit=="number"){k.setAttribute("featurelimit",c.get_feature.featurelimit)}k.setAttribute("globalenvelope","true");h.appendChild(k);if(c.get_feature.layer!=null&&c.get_feature.layer.length>0){var v=this.createElementNS("","LAYER");v.setAttribute("id",c.get_feature.layer);k.appendChild(v)}var r=c.get_feature.query;if(r!=null){var t=null;if(r.isspatial){t=this.createElementNS("","SPATIALQUERY")}else{t=this.createElementNS("","QUERY")}k.appendChild(t);if(typeof r.accuracy=="number"){t.setAttribute("accuracy",r.accuracy)}if(r.featurecoordsys!=null){var e=this.createElementNS("","FEATURECOORDSYS");if(r.featurecoordsys.id==0){e.setAttribute("string",r.featurecoordsys.string)}else{e.setAttribute("id",r.featurecoordsys.id)}t.appendChild(e)}if(r.filtercoordsys!=null){var d=this.createElementNS("","FILTERCOORDSYS");if(r.filtercoordsys.id===0){d.setAttribute("string",r.filtercoordsys.string)}else{d.setAttribute("id",r.filtercoordsys.id)}t.appendChild(d)}if(r.buffer>0){var l=this.createElementNS("","BUFFER");l.setAttribute("distance",r.buffer);t.appendChild(l)}if(r.isspatial){var i=this.createElementNS("","SPATIALFILTER");i.setAttribute("relation",r.spatialfilter.relation);t.appendChild(i);
if(r.spatialfilter.envelope){var w=this.createElementNS("","ENVELOPE");w.setAttribute("minx",r.spatialfilter.envelope.minx);w.setAttribute("miny",r.spatialfilter.envelope.miny);w.setAttribute("maxx",r.spatialfilter.envelope.maxx);w.setAttribute("maxy",r.spatialfilter.envelope.maxy);i.appendChild(w)}else{if(typeof r.spatialfilter.polygon=="object"){i.appendChild(this.writePolygonGeometry(r.spatialfilter.polygon))}}}if(r.where!=null&&r.where.length>0){t.setAttribute("where",r.where)}}}}q.appendChild(h);return OpenLayers.Format.XML.prototype.write.apply(this,[q])},addGroupRenderer:function(b,a){var e=this.createElementNS("","GROUPRENDERER");b.appendChild(e);for(var c=0;c<a.length;c++){var d=a[c];this.addRenderer(e,d)}},addRenderer:function(c,b){if(b instanceof Array){this.addGroupRenderer(c,b)}else{var a=this.createElementNS("",b.type.toUpperCase()+"RENDERER");c.appendChild(a);if(a.tagName=="VALUEMAPRENDERER"){this.addValueMapRenderer(a,b)}else{if(a.tagName=="VALUEMAPLABELRENDERER"){this.addValueMapLabelRenderer(a,b)}else{if(a.tagName=="SIMPLELABELRENDERER"){this.addSimpleLabelRenderer(a,b)}else{if(a.tagName=="SCALEDEPENDENTRENDERER"){this.addScaleDependentRenderer(a,b)}}}}}},addScaleDependentRenderer:function(a,b){if(typeof b.lower=="string"||typeof b.lower=="number"){a.setAttribute("lower",b.lower)}if(typeof b.upper=="string"||typeof b.upper=="number"){a.setAttribute("upper",b.upper)}this.addRenderer(a,b.renderer)},addValueMapLabelRenderer:function(h,g){h.setAttribute("lookupfield",g.lookupfield);h.setAttribute("labelfield",g.labelfield);if(typeof g.exacts=="object"){for(var a=0,k=g.exacts.length;a<k;a++){var e=g.exacts[a];var d=this.createElementNS("","EXACT");if(typeof e.value=="string"){d.setAttribute("value",e.value)}if(typeof e.label=="string"){d.setAttribute("label",e.label)}if(typeof e.method=="string"){d.setAttribute("method",e.method)}h.appendChild(d);if(typeof e.symbol=="object"){var b=null;if(e.symbol.type=="text"){b=this.createElementNS("","TEXTSYMBOL")}if(b!=null){var l=this.fontStyleKeys;for(var c=0,f=l.length;c<f;c++){var j=l[c];if(e.symbol[j]){b.setAttribute(j,e.symbol[j])}}d.appendChild(b)}}}}},addValueMapRenderer:function(j,i){j.setAttribute("lookupfield",i.lookupfield);if(typeof i.ranges=="object"){for(var a=0,b=i.ranges.length;a<b;a++){var g=i.ranges[a];var e=this.createElementNS("","RANGE");e.setAttribute("lower",g.lower);e.setAttribute("upper",g.upper);j.appendChild(e);if(typeof g.symbol=="object"){var d=null;if(g.symbol.type=="simplepolygon"){d=this.createElementNS("","SIMPLEPOLYGONSYMBOL")}if(d!=null){if(typeof g.symbol.boundarycolor=="string"){d.setAttribute("boundarycolor",g.symbol.boundarycolor)}if(typeof g.symbol.fillcolor=="string"){d.setAttribute("fillcolor",g.symbol.fillcolor)}if(typeof g.symbol.filltransparency=="number"){d.setAttribute("filltransparency",g.symbol.filltransparency)}e.appendChild(d)}}}}else{if(typeof i.exacts=="object"){for(var c=0,k=i.exacts.length;c<k;c++){var h=i.exacts[c];var f=this.createElementNS("","EXACT");if(typeof h.value=="string"){f.setAttribute("value",h.value)}if(typeof h.label=="string"){f.setAttribute("label",h.label)}if(typeof h.method=="string"){f.setAttribute("method",h.method)}j.appendChild(f);if(typeof h.symbol=="object"){var d=null;if(h.symbol.type=="simplemarker"){d=this.createElementNS("","SIMPLEMARKERSYMBOL")}if(d!=null){if(typeof h.symbol.antialiasing=="string"){d.setAttribute("antialiasing",h.symbol.antialiasing)}if(typeof h.symbol.color=="string"){d.setAttribute("color",h.symbol.color)}if(typeof h.symbol.outline=="string"){d.setAttribute("outline",h.symbol.outline)}if(typeof h.symbol.overlap=="string"){d.setAttribute("overlap",h.symbol.overlap)}if(typeof h.symbol.shadow=="string"){d.setAttribute("shadow",h.symbol.shadow)}if(typeof h.symbol.transparency=="number"){d.setAttribute("transparency",h.symbol.transparency)}if(typeof h.symbol.usecentroid=="string"){d.setAttribute("usecentroid",h.symbol.usecentroid)}if(typeof h.symbol.width=="number"){d.setAttribute("width",h.symbol.width)
}f.appendChild(d)}}}}}},addSimpleLabelRenderer:function(f,h){f.setAttribute("field",h.field);var e=["featureweight","howmanylabels","labelbufferratio","labelpriorities","labelweight","linelabelposition","rotationalangles"];for(var d=0,a=e.length;d<a;d++){var c=e[d];if(h[c]){f.setAttribute(c,h[c])}}if(h.symbol.type=="text"){var g=h.symbol;var b=this.createElementNS("","TEXTSYMBOL");f.appendChild(b);var e=this.fontStyleKeys;for(var d=0,a=e.length;d<a;d++){var c=e[d];if(g[c]){b.setAttribute(c,h[c])}}}},writePolygonGeometry:function(g){if(!(g instanceof OpenLayers.Geometry.Polygon)){throw {message:"Cannot write polygon geometry to ArcXML with an "+g.CLASS_NAME+" object.",geometry:g}}var b=this.createElementNS("","POLYGON");for(var e=0,c=g.components.length;e<c;e++){var a=g.components[e];var i=this.createElementNS("","RING");for(var d=0,j=a.components.length;d<j;d++){var h=a.components[d];var f=this.createElementNS("","POINT");f.setAttribute("x",h.x);f.setAttribute("y",h.y);i.appendChild(f)}b.appendChild(i)}return b},parseResponse:function(z){if(typeof z=="string"){var n=new OpenLayers.Format.XML();z=n.read(z)}var a=new OpenLayers.Format.ArcXML.Response();var A=z.getElementsByTagName("ERROR");if(A!=null&&A.length>0){a.error=this.getChildValue(A,"Unknown error.")}else{var r=z.getElementsByTagName("RESPONSE");if(r==null||r.length==0){a.error="No RESPONSE tag found in ArcXML response.";return a}var q=r[0].firstChild.nodeName;if(q=="#text"){q=r[0].firstChild.nextSibling.nodeName}if(q=="IMAGE"){var c=z.getElementsByTagName("ENVELOPE");var w=z.getElementsByTagName("OUTPUT");if(c==null||c.length==0){a.error="No ENVELOPE tag found in ArcXML response."}else{if(w==null||w.length==0){a.error="No OUTPUT tag found in ArcXML response."}else{var u=this.parseAttributes(c[0]);var v=this.parseAttributes(w[0]);if(typeof v.type=="string"){a.image={envelope:u,output:{type:v.type,data:this.getChildValue(w[0])}}}else{a.image={envelope:u,output:v}}}}}else{if(q=="FEATURES"){var i=r[0].getElementsByTagName("FEATURES");var p=i[0].getElementsByTagName("FEATURECOUNT");a.features.featurecount=p[0].getAttribute("count");if(a.features.featurecount>0){var d=i[0].getElementsByTagName("ENVELOPE");a.features.envelope=this.parseAttributes(d[0],typeof(0));var x=i[0].getElementsByTagName("FEATURE");for(var m=0;m<x.length;m++){var h=new OpenLayers.Feature.Vector();var s=x[m].getElementsByTagName("FIELD");for(var f=0;f<s.length;f++){var g=s[f].getAttribute("name");var k=s[f].getAttribute("value");h.attributes[g]=k}var t=x[m].getElementsByTagName("POLYGON");if(t.length>0){var j=t[0].getElementsByTagName("RING");var e=[];for(var o=0;o<j.length;o++){var y=[];y.push(this.parsePointGeometry(j[o]));var l=j[o].getElementsByTagName("HOLE");for(var b=0;b<l.length;b++){y.push(this.parsePointGeometry(l[b]))}l=null;e.push(new OpenLayers.Geometry.Polygon(y));y=null}j=null;if(e.length==1){h.geometry=e[0]}else{h.geometry=new OpenLayers.Geometry.MultiPolygon(e)}}a.features.feature.push(h)}}}else{a.error="Unidentified response type."}}}return a},parseAttributes:function(d,c){var b={};for(var a=0;a<d.attributes.length;a++){if(c=="number"){b[d.attributes[a].nodeName]=parseFloat(d.attributes[a].nodeValue)}else{b[d.attributes[a].nodeName]=d.attributes[a].nodeValue}}return b},parsePointGeometry:function(d){var b=[];var e=d.getElementsByTagName("COORDS");if(e.length>0){var f=this.getChildValue(e[0]);f=f.split(/;/);for(var h=0;h<f.length;h++){var g=f[h].split(/ /);b.push(new OpenLayers.Geometry.Point(parseFloat(g[0]),parseFloat(g[1])))}e=null}else{var a=d.getElementsByTagName("POINT");if(a.length>0){for(var c=0;c<a.length;c++){b.push(new OpenLayers.Geometry.Point(parseFloat(a[c].getAttribute("x")),parseFloat(a[c].getAttribute("y"))))}}a=null}return new OpenLayers.Geometry.LinearRing(b)},CLASS_NAME:"OpenLayers.Format.ArcXML"});OpenLayers.Format.ArcXML.Request=OpenLayers.Class({initialize:function(b){var a={get_image:{properties:{background:null,draw:true,envelope:{minx:0,miny:0,maxx:0,maxy:0},featurecoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},filtercoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},imagesize:{height:0,width:0,dpi:96,printheight:0,printwidth:0,scalesymbols:false},layerlist:[],output:{baseurl:"",legendbaseurl:"",legendname:"",legendpath:"",legendurl:"",name:"",path:"",type:"jpg",url:""}}},get_feature:{layer:"",query:{isspatial:false,featurecoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},filtercoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},buffer:0,where:"",spatialfilter:{relation:"envelope_intersection",envelope:null}}},environment:{separators:{cs:" ",ts:";"}},layer:[],workspaces:[]};
return OpenLayers.Util.extend(this,a)},CLASS_NAME:"OpenLayers.Format.ArcXML.Request"});OpenLayers.Format.ArcXML.Response=OpenLayers.Class({initialize:function(b){var a={image:{envelope:null,output:""},features:{featurecount:0,envelope:null,feature:[]},error:""};return OpenLayers.Util.extend(this,a)},CLASS_NAME:"OpenLayers.Format.ArcXML.Response"});OpenLayers.Format.GML=OpenLayers.Class(OpenLayers.Format.XML,{featureNS:"http://mapserver.gis.umn.edu/mapserver",featurePrefix:"feature",featureName:"featureMember",layerName:"features",geometryName:"geometry",collectionName:"FeatureCollection",gmlns:"http://www.opengis.net/gml",extractAttributes:true,xy:true,initialize:function(a){this.regExes={trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)};OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(d){if(typeof d=="string"){d=OpenLayers.Format.XML.prototype.read.apply(this,[d])}var e=this.getElementsByTagNameNS(d.documentElement,this.gmlns,this.featureName);var c=[];for(var b=0;b<e.length;b++){var a=this.parseFeature(e[b]);if(a){c.push(a)}}return c},parseFeature:function(d){var e=["MultiPolygon","Polygon","MultiLineString","LineString","MultiPoint","Point","Envelope"];var p,h,q,c;for(var l=0;l<e.length;++l){p=e[l];h=this.getElementsByTagNameNS(d,this.gmlns,p);if(h.length>0){c=this.parseGeometry[p.toLowerCase()];if(c){q=c.apply(this,[h[0]]);if(this.internalProjection&&this.externalProjection){q.transform(this.externalProjection,this.internalProjection)}}else{OpenLayers.Console.error(OpenLayers.i18n("unsupportedGeometryType",{geomType:p}))}break}}var b;var k=this.getElementsByTagNameNS(d,this.gmlns,"Box");for(l=0;l<k.length;++l){var o=k[l];var n=this.parseGeometry.box.apply(this,[o]);var m=o.parentNode;var g=m.localName||m.nodeName.split(":").pop();if(g==="boundedBy"){b=n}else{q=n.toGeometry()}}var j;if(this.extractAttributes){j=this.parseAttributes(d)}var r=new OpenLayers.Feature.Vector(q,j);r.bounds=b;r.gml={featureType:d.firstChild.nodeName.split(":")[1],featureNS:d.firstChild.namespaceURI,featureNSPrefix:d.firstChild.prefix};var a=d.firstChild;var f;while(a){if(a.nodeType==1){f=a.getAttribute("fid")||a.getAttribute("id");if(f){break}}a=a.nextSibling}r.fid=f;return r},parseGeometry:{point:function(d){var b,a;var e=[];var b=this.getElementsByTagNameNS(d,this.gmlns,"pos");if(b.length>0){a=b[0].firstChild.nodeValue;a=a.replace(this.regExes.trimSpace,"");e=a.split(this.regExes.splitSpace)}if(e.length==0){b=this.getElementsByTagNameNS(d,this.gmlns,"coordinates");if(b.length>0){a=b[0].firstChild.nodeValue;a=a.replace(this.regExes.removeSpace,"");e=a.split(",")}}if(e.length==0){b=this.getElementsByTagNameNS(d,this.gmlns,"coord");if(b.length>0){var f=this.getElementsByTagNameNS(b[0],this.gmlns,"X");var c=this.getElementsByTagNameNS(b[0],this.gmlns,"Y");if(f.length>0&&c.length>0){e=[f[0].firstChild.nodeValue,c[0].firstChild.nodeValue]}}}if(e.length==2){e[2]=null}if(this.xy){return new OpenLayers.Geometry.Point(e[0],e[1],e[2])}else{return new OpenLayers.Geometry.Point(e[1],e[0],e[2])}},multipoint:function(e){var b=this.getElementsByTagNameNS(e,this.gmlns,"Point");var d=[];if(b.length>0){var a;for(var c=0;c<b.length;++c){a=this.parseGeometry.point.apply(this,[b[c]]);if(a){d.push(a)}}}return new OpenLayers.Geometry.MultiPoint(d)},linestring:function(c,e){var d,b;var n=[];var o=[];d=this.getElementsByTagNameNS(c,this.gmlns,"posList");if(d.length>0){b=this.getChildValue(d[0]);b=b.replace(this.regExes.trimSpace,"");n=b.split(this.regExes.splitSpace);var h=parseInt(d[0].getAttribute("dimension"));var f,m,l,k;for(var g=0;g<n.length/h;++g){f=g*h;m=n[f];l=n[f+1];k=(h==2)?null:n[f+2];if(this.xy){o.push(new OpenLayers.Geometry.Point(m,l,k))}else{o.push(new OpenLayers.Geometry.Point(l,m,k))}}}if(n.length==0){d=this.getElementsByTagNameNS(c,this.gmlns,"coordinates");if(d.length>0){b=this.getChildValue(d[0]);b=b.replace(this.regExes.trimSpace,"");b=b.replace(this.regExes.trimComma,",");var a=b.split(this.regExes.splitSpace);
for(var g=0;g<a.length;++g){n=a[g].split(",");if(n.length==2){n[2]=null}if(this.xy){o.push(new OpenLayers.Geometry.Point(n[0],n[1],n[2]))}else{o.push(new OpenLayers.Geometry.Point(n[1],n[0],n[2]))}}}}var p=null;if(o.length!=0){if(e){p=new OpenLayers.Geometry.LinearRing(o)}else{p=new OpenLayers.Geometry.LineString(o)}}return p},multilinestring:function(e){var b=this.getElementsByTagNameNS(e,this.gmlns,"LineString");var d=[];if(b.length>0){var a;for(var c=0;c<b.length;++c){a=this.parseGeometry.linestring.apply(this,[b[c]]);if(a){d.push(a)}}}return new OpenLayers.Geometry.MultiLineString(d)},polygon:function(e){var b=this.getElementsByTagNameNS(e,this.gmlns,"LinearRing");var d=[];if(b.length>0){var a;for(var c=0;c<b.length;++c){a=this.parseGeometry.linestring.apply(this,[b[c],true]);if(a){d.push(a)}}}return new OpenLayers.Geometry.Polygon(d)},multipolygon:function(e){var a=this.getElementsByTagNameNS(e,this.gmlns,"Polygon");var d=[];if(a.length>0){var c;for(var b=0;b<a.length;++b){c=this.parseGeometry.polygon.apply(this,[a[b]]);if(c){d.push(c)}}}return new OpenLayers.Geometry.MultiPolygon(d)},envelope:function(b){var e=[];var a;var f;var j=this.getElementsByTagNameNS(b,this.gmlns,"lowerCorner");if(j.length>0){var h=[];if(j.length>0){a=j[0].firstChild.nodeValue;a=a.replace(this.regExes.trimSpace,"");h=a.split(this.regExes.splitSpace)}if(h.length==2){h[2]=null}if(this.xy){var d=new OpenLayers.Geometry.Point(h[0],h[1],h[2])}else{var d=new OpenLayers.Geometry.Point(h[1],h[0],h[2])}}var g=this.getElementsByTagNameNS(b,this.gmlns,"upperCorner");if(g.length>0){var h=[];if(g.length>0){a=g[0].firstChild.nodeValue;a=a.replace(this.regExes.trimSpace,"");h=a.split(this.regExes.splitSpace)}if(h.length==2){h[2]=null}if(this.xy){var i=new OpenLayers.Geometry.Point(h[0],h[1],h[2])}else{var i=new OpenLayers.Geometry.Point(h[1],h[0],h[2])}}if(d&&i){e.push(new OpenLayers.Geometry.Point(d.x,d.y));e.push(new OpenLayers.Geometry.Point(i.x,d.y));e.push(new OpenLayers.Geometry.Point(i.x,i.y));e.push(new OpenLayers.Geometry.Point(d.x,i.y));e.push(new OpenLayers.Geometry.Point(d.x,d.y));var c=new OpenLayers.Geometry.LinearRing(e);f=new OpenLayers.Geometry.Polygon([c])}return f},box:function(e){var c=this.getElementsByTagNameNS(e,this.gmlns,"coordinates");var b;var f,a=null,d=null;if(c.length>0){b=c[0].firstChild.nodeValue;f=b.split(" ");if(f.length==2){a=f[0].split(",");d=f[1].split(",")}}if(a!==null&&d!==null){return new OpenLayers.Bounds(parseFloat(a[0]),parseFloat(a[1]),parseFloat(d[0]),parseFloat(d[1]))}}},parseAttributes:function(e){var f={};var a=e.firstChild;var d,g,c,k,j,b,h;while(a){if(a.nodeType==1){d=a.childNodes;for(g=0;g<d.length;++g){c=d[g];if(c.nodeType==1){k=c.childNodes;if(k.length==1){j=k[0];if(j.nodeType==3||j.nodeType==4){b=(c.prefix)?c.nodeName.split(":")[1]:c.nodeName;h=j.nodeValue.replace(this.regExes.trimSpace,"");f[b]=h}}else{f[c.nodeName.split(":").pop()]=null}}}break}a=a.nextSibling}return f},write:function(c){if(!(c instanceof Array)){c=[c]}var b=this.createElementNS("http://www.opengis.net/wfs","wfs:"+this.collectionName);for(var a=0;a<c.length;a++){b.appendChild(this.createFeatureXML(c[a]))}return OpenLayers.Format.XML.prototype.write.apply(this,[b])},createFeatureXML:function(j){var h=j.geometry;var e=this.buildGeometryNode(h);var i=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.geometryName);i.appendChild(e);var a=this.createElementNS(this.gmlns,"gml:"+this.featureName);var k=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.layerName);var c=j.fid||j.id;k.setAttribute("fid",c);k.appendChild(i);for(var g in j.attributes){var f=this.createTextNode(j.attributes[g]);var d=g.substring(g.lastIndexOf(":")+1);var b=this.createElementNS(this.featureNS,this.featurePrefix+":"+d);b.appendChild(f);k.appendChild(b)}a.appendChild(k);return a},buildGeometryNode:function(d){if(this.externalProjection&&this.internalProjection){d=d.clone();d.transform(this.internalProjection,this.externalProjection)}var c=d.CLASS_NAME;
var b=c.substring(c.lastIndexOf(".")+1);var a=this.buildGeometry[b.toLowerCase()];return a.apply(this,[d])},buildGeometry:{point:function(b){var a=this.createElementNS(this.gmlns,"gml:Point");a.appendChild(this.buildCoordinatesNode(b));return a},multipoint:function(f){var d=this.createElementNS(this.gmlns,"gml:MultiPoint");var c=f.components;var b,e;for(var a=0;a<c.length;a++){b=this.createElementNS(this.gmlns,"gml:pointMember");e=this.buildGeometry.point.apply(this,[c[a]]);b.appendChild(e);d.appendChild(b)}return d},linestring:function(b){var a=this.createElementNS(this.gmlns,"gml:LineString");a.appendChild(this.buildCoordinatesNode(b));return a},multilinestring:function(f){var d=this.createElementNS(this.gmlns,"gml:MultiLineString");var a=f.components;var c,e;for(var b=0;b<a.length;++b){c=this.createElementNS(this.gmlns,"gml:lineStringMember");e=this.buildGeometry.linestring.apply(this,[a[b]]);c.appendChild(e);d.appendChild(c)}return d},linearring:function(b){var a=this.createElementNS(this.gmlns,"gml:LinearRing");a.appendChild(this.buildCoordinatesNode(b));return a},polygon:function(g){var d=this.createElementNS(this.gmlns,"gml:Polygon");var f=g.components;var c,e,b;for(var a=0;a<f.length;++a){b=(a==0)?"outerBoundaryIs":"innerBoundaryIs";c=this.createElementNS(this.gmlns,"gml:"+b);e=this.buildGeometry.linearring.apply(this,[f[a]]);c.appendChild(e);d.appendChild(c)}return d},multipolygon:function(f){var d=this.createElementNS(this.gmlns,"gml:MultiPolygon");var a=f.components;var e,b;for(var c=0;c<a.length;++c){e=this.createElementNS(this.gmlns,"gml:polygonMember");b=this.buildGeometry.polygon.apply(this,[a[c]]);e.appendChild(b);d.appendChild(e)}return d},bounds:function(b){var a=this.createElementNS(this.gmlns,"gml:Box");a.appendChild(this.buildCoordinatesNode(b));return a}},buildCoordinatesNode:function(f){var a=this.createElementNS(this.gmlns,"gml:coordinates");a.setAttribute("decimal",".");a.setAttribute("cs",",");a.setAttribute("ts"," ");var e=[];if(f instanceof OpenLayers.Bounds){e.push(f.left+","+f.bottom);e.push(f.right+","+f.top)}else{var c=(f.components)?f.components:[f];for(var b=0;b<c.length;b++){e.push(c[b].x+","+c[b].y)}}var d=this.createTextNode(e.join(" "));a.appendChild(d);return a},CLASS_NAME:"OpenLayers.Format.GML"});OpenLayers.Format.GeoJSON=OpenLayers.Class(OpenLayers.Format.JSON,{ignoreExtraDims:false,initialize:function(a){OpenLayers.Format.JSON.prototype.initialize.apply(this,[a])},read:function(j,g,a){g=(g)?g:"FeatureCollection";var d=null;var c=null;if(typeof j=="string"){c=OpenLayers.Format.JSON.prototype.read.apply(this,[j,a])}else{c=j}if(!c){OpenLayers.Console.error("Bad JSON: "+j)}else{if(typeof(c.type)!="string"){OpenLayers.Console.error("Bad GeoJSON - no type: "+j)}else{if(this.isValidType(c,g)){switch(g){case"Geometry":try{d=this.parseGeometry(c)}catch(b){OpenLayers.Console.error(b)}break;case"Feature":try{d=this.parseFeature(c);d.type="Feature"}catch(b){OpenLayers.Console.error(b)}break;case"FeatureCollection":d=[];switch(c.type){case"Feature":try{d.push(this.parseFeature(c))}catch(b){d=null;OpenLayers.Console.error(b)}break;case"FeatureCollection":for(var e=0,f=c.features.length;e<f;++e){try{d.push(this.parseFeature(c.features[e]))}catch(b){d=null;OpenLayers.Console.error(b)}}break;default:try{var h=this.parseGeometry(c);d.push(new OpenLayers.Feature.Vector(h))}catch(b){d=null;OpenLayers.Console.error(b)}}break}}}}return d},isValidType:function(c,a){var b=false;switch(a){case"Geometry":if(OpenLayers.Util.indexOf(["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","Box","GeometryCollection"],c.type)==-1){OpenLayers.Console.error("Unsupported geometry type: "+c.type)}else{b=true}break;case"FeatureCollection":b=true;break;default:if(c.type==a){b=true}else{OpenLayers.Console.error("Cannot convert types from "+c.type+" to "+a)}}return b},parseFeature:function(d){var b,f,a,e;a=(d.properties)?d.properties:{};e=(d.geometry&&d.geometry.bbox)||d.bbox;try{f=this.parseGeometry(d.geometry)
}catch(c){throw c}b=new OpenLayers.Feature.Vector(f,a);if(e){b.bounds=OpenLayers.Bounds.fromArray(e)}if(d.id){b.fid=d.id}return b},parseGeometry:function(e){if(e==null){return null}var g,f=false;if(e.type=="GeometryCollection"){if(!(e.geometries instanceof Array)){throw"GeometryCollection must have geometries array: "+e}var b=e.geometries.length;var d=new Array(b);for(var a=0;a<b;++a){d[a]=this.parseGeometry.apply(this,[e.geometries[a]])}g=new OpenLayers.Geometry.Collection(d);f=true}else{if(!(e.coordinates instanceof Array)){throw"Geometry must have coordinates array: "+e}if(!this.parseCoords[e.type.toLowerCase()]){throw"Unsupported geometry type: "+e.type}try{g=this.parseCoords[e.type.toLowerCase()].apply(this,[e.coordinates])}catch(c){throw c}}if(this.internalProjection&&this.externalProjection&&!f){g.transform(this.externalProjection,this.internalProjection)}return g},parseCoords:{point:function(a){if(this.ignoreExtraDims==false&&a.length!=2){throw"Only 2D points are supported: "+a}return new OpenLayers.Geometry.Point(a[0],a[1])},multipoint:function(f){var c=[];var e=null;for(var b=0,a=f.length;b<a;++b){try{e=this.parseCoords.point.apply(this,[f[b]])}catch(d){throw d}c.push(e)}return new OpenLayers.Geometry.MultiPoint(c)},linestring:function(f){var c=[];var e=null;for(var b=0,a=f.length;b<a;++b){try{e=this.parseCoords.point.apply(this,[f[b]])}catch(d){throw d}c.push(e)}return new OpenLayers.Geometry.LineString(c)},multilinestring:function(f){var c=[];var b=null;for(var d=0,a=f.length;d<a;++d){try{b=this.parseCoords.linestring.apply(this,[f[d]])}catch(e){throw e}c.push(b)}return new OpenLayers.Geometry.MultiLineString(c)},polygon:function(g){var f=[];var e,b;for(var c=0,a=g.length;c<a;++c){try{b=this.parseCoords.linestring.apply(this,[g[c]])}catch(d){throw d}e=new OpenLayers.Geometry.LinearRing(b.components);f.push(e)}return new OpenLayers.Geometry.Polygon(f)},multipolygon:function(f){var b=[];var e=null;for(var c=0,a=f.length;c<a;++c){try{e=this.parseCoords.polygon.apply(this,[f[c]])}catch(d){throw d}b.push(e)}return new OpenLayers.Geometry.MultiPolygon(b)},box:function(a){if(a.length!=2){throw"GeoJSON box coordinates must have 2 elements"}return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(a[0][0],a[0][1]),new OpenLayers.Geometry.Point(a[1][0],a[0][1]),new OpenLayers.Geometry.Point(a[1][0],a[1][1]),new OpenLayers.Geometry.Point(a[0][0],a[1][1]),new OpenLayers.Geometry.Point(a[0][0],a[0][1])])])}},write:function(e,d){var a={type:null};if(e instanceof Array){a.type="FeatureCollection";var g=e.length;a.features=new Array(g);for(var c=0;c<g;++c){var b=e[c];if(!b instanceof OpenLayers.Feature.Vector){var f="FeatureCollection only supports collections of features: "+b;throw f}a.features[c]=this.extract.feature.apply(this,[b])}}else{if(e.CLASS_NAME.indexOf("OpenLayers.Geometry")==0){a=this.extract.geometry.apply(this,[e])}else{if(e instanceof OpenLayers.Feature.Vector){a=this.extract.feature.apply(this,[e]);if(e.layer&&e.layer.projection){a.crs=this.createCRSObject(e)}}}}return OpenLayers.Format.JSON.prototype.write.apply(this,[a,d])},createCRSObject:function(b){var c=b.layer.projection.toString();var a={};if(c.match(/epsg:/i)){var d=parseInt(c.substring(c.indexOf(":")+1));if(d==4326){a={type:"OGC",properties:{urn:"urn:ogc:def:crs:OGC:1.3:CRS84"}}}else{a={type:"EPSG",properties:{code:d}}}}return a},extract:{feature:function(b){var a=this.extract.geometry.apply(this,[b.geometry]);return{type:"Feature",id:b.fid==null?b.id:b.fid,properties:b.attributes,geometry:a}},geometry:function(d){if(d==null){return null}if(this.internalProjection&&this.externalProjection){d=d.clone();d.transform(this.internalProjection,this.externalProjection)}var a=d.CLASS_NAME.split(".")[2];var c=this.extract[a.toLowerCase()].apply(this,[d]);var b;if(a=="Collection"){b={type:"GeometryCollection",geometries:c}}else{b={type:a,coordinates:c}}return b},point:function(a){return[a.x,a.y]},multipoint:function(c){var d=[];
for(var b=0,a=c.components.length;b<a;++b){d.push(this.extract.point.apply(this,[c.components[b]]))}return d},linestring:function(b){var d=[];for(var c=0,a=b.components.length;c<a;++c){d.push(this.extract.point.apply(this,[b.components[c]]))}return d},multilinestring:function(c){var d=[];for(var b=0,a=c.components.length;b<a;++b){d.push(this.extract.linestring.apply(this,[c.components[b]]))}return d},polygon:function(c){var d=[];for(var b=0,a=c.components.length;b<a;++b){d.push(this.extract.linestring.apply(this,[c.components[b]]))}return d},multipolygon:function(d){var c=[];for(var b=0,a=d.components.length;b<a;++b){c.push(this.extract.polygon.apply(this,[d.components[b]]))}return c},collection:function(c){var a=c.components.length;var d=new Array(a);for(var b=0;b<a;++b){d[b]=this.extract.geometry.apply(this,[c.components[b]])}return d}},CLASS_NAME:"OpenLayers.Format.GeoJSON"});OpenLayers.Format.ArcXML.Features=OpenLayers.Class(OpenLayers.Format.XML,{initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(c){var b=new OpenLayers.Format.ArcXML();var a=b.read(c);return a.features.feature}});if(!OpenLayers.Format.GML){OpenLayers.Format.GML={}}OpenLayers.Format.GML.Base=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",wfs:"http://www.opengis.net/wfs"},defaultPrefix:"gml",schemaLocation:null,featureType:null,featureNS:null,geometryName:"geometry",extractAttributes:true,srsName:null,xy:true,geometryTypes:null,singleFeatureType:null,regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);this.setGeometryTypes();if(a&&a.featureNS){this.setNamespace("feature",a.featureNS)}this.singleFeatureType=!a||(typeof a.featureType==="string")},read:function(e){if(typeof e=="string"){e=OpenLayers.Format.XML.prototype.read.apply(this,[e])}if(e&&e.nodeType==9){e=e.documentElement}var c=[];this.readNode(e,{features:c});if(c.length==0){var d=this.getElementsByTagNameNS(e,this.namespaces.gml,"featureMember");if(d.length){for(var b=0,a=d.length;b<a;++b){this.readNode(d[b],{features:c})}}else{var d=this.getElementsByTagNameNS(e,this.namespaces.gml,"featureMembers");if(d.length){this.readNode(d[0],{features:c})}}}return c},readers:{gml:{featureMember:function(a,b){this.readChildNodes(a,b)},featureMembers:function(a,b){this.readChildNodes(a,b)},name:function(a,b){b.name=this.getChildValue(a)},boundedBy:function(b,c){var a={};this.readChildNodes(b,a);if(a.components&&a.components.length>0){c.bounds=a.components[0]}},Point:function(b,a){var c={points:[]};this.readChildNodes(b,c);if(!a.components){a.components=[]}a.components.push(c.points[0])},coordinates:function(e,g){var h=this.getChildValue(e).replace(this.regExes.trimSpace,"");h=h.replace(this.regExes.trimComma,",");var a=h.split(this.regExes.splitSpace);var f;var d=a.length;var c=new Array(d);for(var b=0;b<d;++b){f=a[b].split(",");if(this.xy){c[b]=new OpenLayers.Geometry.Point(f[0],f[1],f[2])}else{c[b]=new OpenLayers.Geometry.Point(f[1],f[0],f[2])}}g.points=c},coord:function(a,b){var c={};this.readChildNodes(a,c);if(!b.points){b.points=[]}b.points.push(new OpenLayers.Geometry.Point(c.x,c.y,c.z))},X:function(a,b){b.x=this.getChildValue(a)},Y:function(a,b){b.y=this.getChildValue(a)},Z:function(a,b){b.z=this.getChildValue(a)},MultiPoint:function(b,a){var c={components:[]};this.readChildNodes(b,c);a.components=[new OpenLayers.Geometry.MultiPoint(c.components)]},pointMember:function(a,b){this.readChildNodes(a,b)},LineString:function(b,a){var c={};this.readChildNodes(b,c);if(!a.components){a.components=[]}a.components.push(new OpenLayers.Geometry.LineString(c.points))},MultiLineString:function(b,a){var c={components:[]};this.readChildNodes(b,c);a.components=[new OpenLayers.Geometry.MultiLineString(c.components)]},lineStringMember:function(a,b){this.readChildNodes(a,b)
},Polygon:function(b,a){var c={outer:null,inner:[]};this.readChildNodes(b,c);c.inner.unshift(c.outer);if(!a.components){a.components=[]}a.components.push(new OpenLayers.Geometry.Polygon(c.inner))},LinearRing:function(b,c){var a={};this.readChildNodes(b,a);c.components=[new OpenLayers.Geometry.LinearRing(a.points)]},MultiPolygon:function(b,a){var c={components:[]};this.readChildNodes(b,c);a.components=[new OpenLayers.Geometry.MultiPolygon(c.components)]},polygonMember:function(a,b){this.readChildNodes(a,b)},GeometryCollection:function(b,a){var c={components:[]};this.readChildNodes(b,c);a.components=[new OpenLayers.Geometry.Collection(c.components)]},geometryMember:function(a,b){this.readChildNodes(a,b)}},feature:{"*":function(c,d){var a;var b=c.localName||c.nodeName.split(":").pop();if(d.features){if(!this.singleFeatureType&&(OpenLayers.Util.indexOf(this.featureType,b)!==-1)){a="_typeName"}else{if(b===this.featureType){a="_typeName"}}}else{if(c.childNodes.length==0||(c.childNodes.length==1&&c.firstChild.nodeType==3)){if(this.extractAttributes){a="_attribute"}}else{a="_geometry"}}if(a){this.readers.feature[a].apply(this,[c,d])}},_typeName:function(c,d){var a={components:[],attributes:{}};this.readChildNodes(c,a);if(a.name){a.attributes.name=a.name}var b=new OpenLayers.Feature.Vector(a.components[0],a.attributes);if(!this.singleFeatureType){b.type=c.nodeName.split(":").pop();b.namespace=c.namespaceURI}var e=c.getAttribute("fid")||this.getAttributeNS(c,this.namespaces.gml,"id");if(e){b.fid=e}if(this.internalProjection&&this.externalProjection&&b.geometry){b.geometry.transform(this.externalProjection,this.internalProjection)}if(a.bounds){b.bounds=a.bounds}d.features.push(b)},_geometry:function(a,b){this.readChildNodes(a,b)},_attribute:function(b,d){var a=b.localName||b.nodeName.split(":").pop();var c=this.getChildValue(b);d.attributes[a]=c}},wfs:{FeatureCollection:function(a,b){this.readChildNodes(a,b)}}},write:function(c){var b;if(c instanceof Array){b="featureMembers"}else{b="featureMember"}var a=this.writeNode("gml:"+b,c);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{gml:{featureMember:function(a){var b=this.createElementNSPlus("gml:featureMember");this.writeNode("feature:_typeName",a,b);return b},MultiPoint:function(c){var b=this.createElementNSPlus("gml:MultiPoint");for(var a=0;a<c.components.length;++a){this.writeNode("pointMember",c.components[a],b)}return b},pointMember:function(b){var a=this.createElementNSPlus("gml:pointMember");this.writeNode("Point",b,a);return a},MultiLineString:function(c){var b=this.createElementNSPlus("gml:MultiLineString");for(var a=0;a<c.components.length;++a){this.writeNode("lineStringMember",c.components[a],b)}return b},lineStringMember:function(b){var a=this.createElementNSPlus("gml:lineStringMember");this.writeNode("LineString",b,a);return a},MultiPolygon:function(c){var b=this.createElementNSPlus("gml:MultiPolygon");for(var a=0;a<c.components.length;++a){this.writeNode("polygonMember",c.components[a],b)}return b},polygonMember:function(b){var a=this.createElementNSPlus("gml:polygonMember");this.writeNode("Polygon",b,a);return a},GeometryCollection:function(d){var c=this.createElementNSPlus("gml:GeometryCollection");for(var b=0,a=d.components.length;b<a;++b){this.writeNode("geometryMember",d.components[b],c)}return c},geometryMember:function(b){var a=this.createElementNSPlus("gml:geometryMember");var c=this.writeNode("feature:_geometry",b);a.appendChild(c.firstChild);return a}},feature:{_typeName:function(b){var c=this.createElementNSPlus("feature:"+this.featureType,{attributes:{fid:b.fid}});if(b.geometry){this.writeNode("feature:_geometry",b.geometry,c)}for(var a in b.attributes){var d=b.attributes[a];if(d!=null){this.writeNode("feature:_attribute",{name:a,value:d},c)}}return c},_geometry:function(c){if(this.externalProjection&&this.internalProjection){c=c.clone().transform(this.internalProjection,this.externalProjection)
}var b=this.createElementNSPlus("feature:"+this.geometryName);var a=this.geometryTypes[c.CLASS_NAME];var d=this.writeNode("gml:"+a,c,b);if(this.srsName){d.setAttribute("srsName",this.srsName)}return b},_attribute:function(a){return this.createElementNSPlus("feature:"+a.name,{value:a.value})}},wfs:{FeatureCollection:function(c){var d=this.createElementNSPlus("wfs:FeatureCollection");for(var b=0,a=c.length;b<a;++b){this.writeNode("gml:featureMember",c[b],d)}return d}}},setGeometryTypes:function(){this.geometryTypes={"OpenLayers.Geometry.Point":"Point","OpenLayers.Geometry.MultiPoint":"MultiPoint","OpenLayers.Geometry.LineString":"LineString","OpenLayers.Geometry.MultiLineString":"MultiLineString","OpenLayers.Geometry.Polygon":"Polygon","OpenLayers.Geometry.MultiPolygon":"MultiPolygon","OpenLayers.Geometry.Collection":"GeometryCollection"}},CLASS_NAME:"OpenLayers.Format.GML.Base"});OpenLayers.Format.WFS=OpenLayers.Class(OpenLayers.Format.GML,{layer:null,wfsns:"http://www.opengis.net/wfs",ogcns:"http://www.opengis.net/ogc",initialize:function(a,b){OpenLayers.Format.GML.prototype.initialize.apply(this,[a]);this.layer=b;if(this.layer.featureNS){this.featureNS=this.layer.featureNS}if(this.layer.options.geometry_column){this.geometryName=this.layer.options.geometry_column}if(this.layer.options.typename){this.featureName=this.layer.options.typename}},write:function(b){var c=this.createElementNS(this.wfsns,"wfs:Transaction");c.setAttribute("version","1.0.0");c.setAttribute("service","WFS");for(var a=0;a<b.length;a++){switch(b[a].state){case OpenLayers.State.INSERT:c.appendChild(this.insert(b[a]));break;case OpenLayers.State.UPDATE:c.appendChild(this.update(b[a]));break;case OpenLayers.State.DELETE:c.appendChild(this.remove(b[a]));break}}return OpenLayers.Format.XML.prototype.write.apply(this,[c])},createFeatureXML:function(f){var c=this.buildGeometryNode(f.geometry);var g=this.createElementNS(this.featureNS,"feature:"+this.geometryName);g.appendChild(c);var b=this.createElementNS(this.featureNS,"feature:"+this.featureName);b.appendChild(g);for(var a in f.attributes){var h=this.createTextNode(f.attributes[a]);var d=a;if(a.search(":")!=-1){d=a.split(":")[1]}var e=this.createElementNS(this.featureNS,"feature:"+d);e.appendChild(h);b.appendChild(e)}return b},insert:function(b){var a=this.createElementNS(this.wfsns,"wfs:Insert");a.appendChild(this.createFeatureXML(b));return a},update:function(j){if(!j.fid){OpenLayers.Console.userError(OpenLayers.i18n("noFID"))}var f=this.createElementNS(this.wfsns,"wfs:Update");f.setAttribute("typeName",this.featurePrefix+":"+this.featureName);f.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);var h=this.createElementNS(this.wfsns,"wfs:Property");var a=this.createElementNS(this.wfsns,"wfs:Name");var c=this.createTextNode(this.geometryName);a.appendChild(c);h.appendChild(a);var i=this.createElementNS(this.wfsns,"wfs:Value");var d=this.buildGeometryNode(j.geometry);if(j.layer){d.setAttribute("srsName",j.layer.projection.getCode())}i.appendChild(d);h.appendChild(i);f.appendChild(h);for(var e in j.attributes){h=this.createElementNS(this.wfsns,"wfs:Property");a=this.createElementNS(this.wfsns,"wfs:Name");a.appendChild(this.createTextNode(e));h.appendChild(a);i=this.createElementNS(this.wfsns,"wfs:Value");i.appendChild(this.createTextNode(j.attributes[e]));h.appendChild(i);f.appendChild(h)}var g=this.createElementNS(this.ogcns,"ogc:Filter");var b=this.createElementNS(this.ogcns,"ogc:FeatureId");b.setAttribute("fid",j.fid);g.appendChild(b);f.appendChild(g);return f},remove:function(b){if(!b.fid){OpenLayers.Console.userError(OpenLayers.i18n("noFID"));return false}var a=this.createElementNS(this.wfsns,"wfs:Delete");a.setAttribute("typeName",this.featurePrefix+":"+this.featureName);a.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);var c=this.createElementNS(this.ogcns,"ogc:Filter");var d=this.createElementNS(this.ogcns,"ogc:FeatureId");d.setAttribute("fid",b.fid);c.appendChild(d);a.appendChild(c);return a
},destroy:function(){this.layer=null},CLASS_NAME:"OpenLayers.Format.WFS"});OpenLayers.Layer.ArcIMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{ClientVersion:"9.2",ServiceName:""},tileSize:null,featureCoordSys:"4326",filterCoordSys:"4326",layers:null,async:true,name:"ArcIMS",isBaseLayer:true,DEFAULT_OPTIONS:{tileSize:new OpenLayers.Size(512,512),featureCoordSys:"4326",filterCoordSys:"4326",layers:null,isBaseLayer:true,async:true,name:"ArcIMS"},initialize:function(c,b,a){this.tileSize=new OpenLayers.Size(512,512);this.params=OpenLayers.Util.applyDefaults({ServiceName:a.serviceName},this.DEFAULT_PARAMS);this.options=OpenLayers.Util.applyDefaults(a,this.DEFAULT_OPTIONS);OpenLayers.Layer.Grid.prototype.initialize.apply(this,[c,b,this.params,a]);if(this.transparent){if(!this.isBaseLayer){this.isBaseLayer=false}if(this.format=="image/jpeg"){this.format=OpenLayers.Util.alphaHack()?"image/gif":"image/png"}}if(this.options.layers===null){this.options.layers=[]}},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments)},getURL:function(d){var a="";d=this.adjustBounds(d);var c=new OpenLayers.Format.ArcXML(OpenLayers.Util.extend(this.options,{requesttype:"image",envelope:d.toArray(),tileSize:this.tileSize}));var b=new OpenLayers.Request.POST({url:this.getFullRequestString(),data:c.write(),async:false});if(b!=null){var f=b.responseXML;if(!f||!f.documentElement){f=b.responseText}var e=new OpenLayers.Format.ArcXML();var g=e.read(f);a=this.getUrlOrImage(g.image.output)}return a},getURLasync:function(c,a,e,d){c=this.adjustBounds(c);var b=new OpenLayers.Format.ArcXML(OpenLayers.Util.extend(this.options,{requesttype:"image",envelope:c.toArray(),tileSize:this.tileSize}));OpenLayers.Request.POST({url:this.getFullRequestString(),async:true,data:b.write(),callback:function(f){var h=f.responseXML;if(!h||!h.documentElement){h=f.responseText}var g=new OpenLayers.Format.ArcXML();var i=g.read(h);a[e]=this.getUrlOrImage(i.image.output);d.apply(a)},scope:this})},getUrlOrImage:function(a){var b="";if(a.url){b=a.url}else{if(a.data){b="data:image/"+a.type+";base64,"+a.data}}return b},setLayerQuery:function(c,a){for(var b=0;b<this.options.layers.length;b++){if(c==this.options.layers[b].id){this.options.layers[b].query=a;return}}this.options.layers.push({id:c,visible:true,query:a})},getFeatureInfo:function(h,f,k){var b=k.buffer||1;var i=k.callback||function(){};var j=k.scope||window;var a={};OpenLayers.Util.extend(a,this.options);a.requesttype="feature";if(h instanceof OpenLayers.LonLat){a.polygon=null;a.envelope=[h.lon-b,h.lat-b,h.lon+b,h.lat+b]}else{if(h instanceof OpenLayers.Geometry.Polygon){a.envelope=null;a.polygon=h}}var e=new OpenLayers.Format.ArcXML(a);OpenLayers.Util.extend(e.request.get_feature,k);e.request.get_feature.layer=f.id;if(typeof f.query.accuracy=="number"){e.request.get_feature.query.accuracy=f.query.accuracy}else{var g=this.map.getCenter();var d=this.map.getViewPortPxFromLonLat(g);d.x++;var c=this.map.getLonLatFromPixel(d);e.request.get_feature.query.accuracy=c.lon-g.lon}e.request.get_feature.query.where=f.query.where;e.request.get_feature.query.spatialfilter.relation="area_intersection";OpenLayers.Request.POST({url:this.getFullRequestString({CustomService:"Query"}),data:e.write(),callback:function(m){var l=e.parseResponse(m.responseText);if(!e.iserror()){i.call(j,l.features)}else{i.call(j,null)}}})},clone:function(a){if(a==null){a=new OpenLayers.Layer.ArcIMS(this.name,this.url,this.getOptions())}a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a]);return a},addTile:function(b,a){return new OpenLayers.Tile.Image(this,a,b,null,this.tileSize)},CLASS_NAME:"OpenLayers.Layer.ArcIMS"});OpenLayers.Format.GML.v2=OpenLayers.Class(OpenLayers.Format.GML.Base,{schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/2.1.2/feature.xsd",initialize:function(a){OpenLayers.Format.GML.Base.prototype.initialize.apply(this,[a])},readers:{gml:OpenLayers.Util.applyDefaults({outerBoundaryIs:function(b,a){var c={};
this.readChildNodes(b,c);a.outer=c.components[0]},innerBoundaryIs:function(b,a){var c={};this.readChildNodes(b,c);a.inner.push(c.components[0])},Box:function(d,b){var e={};this.readChildNodes(d,e);if(!b.components){b.components=[]}var c=e.points[0];var a=e.points[1];b.components.push(new OpenLayers.Bounds(c.x,c.y,a.x,a.y))}},OpenLayers.Format.GML.Base.prototype.readers.gml),feature:OpenLayers.Format.GML.Base.prototype.readers.feature,wfs:OpenLayers.Format.GML.Base.prototype.readers.wfs},write:function(c){var b;if(c instanceof Array){b="wfs:FeatureCollection"}else{b="gml:featureMember"}var a=this.writeNode(b,c);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{gml:OpenLayers.Util.applyDefaults({Point:function(b){var a=this.createElementNSPlus("gml:Point");this.writeNode("coordinates",[b],a);return a},coordinates:function(d){var c=d.length;var e=new Array(c);var a;for(var b=0;b<c;++b){a=d[b];if(this.xy){e[b]=a.x+","+a.y}else{e[b]=a.y+","+a.x}if(a.z!=undefined){e[b]+=","+a.z}}return this.createElementNSPlus("gml:coordinates",{attributes:{decimal:".",cs:",",ts:" "},value:(c==1)?e[0]:e.join(" ")})},LineString:function(b){var a=this.createElementNSPlus("gml:LineString");this.writeNode("coordinates",b.components,a);return a},Polygon:function(c){var b=this.createElementNSPlus("gml:Polygon");this.writeNode("outerBoundaryIs",c.components[0],b);for(var a=1;a<c.components.length;++a){this.writeNode("innerBoundaryIs",c.components[a],b)}return b},outerBoundaryIs:function(a){var b=this.createElementNSPlus("gml:outerBoundaryIs");this.writeNode("LinearRing",a,b);return b},innerBoundaryIs:function(a){var b=this.createElementNSPlus("gml:innerBoundaryIs");this.writeNode("LinearRing",a,b);return b},LinearRing:function(a){var b=this.createElementNSPlus("gml:LinearRing");this.writeNode("coordinates",a.components,b);return b},Box:function(b){var a=this.createElementNSPlus("gml:Box");this.writeNode("coordinates",[{x:b.left,y:b.bottom},{x:b.right,y:b.top}],a);if(this.srsName){a.setAttribute("srsName",this.srsName)}return a}},OpenLayers.Format.GML.Base.prototype.writers.gml),feature:OpenLayers.Format.GML.Base.prototype.writers.feature,wfs:OpenLayers.Format.GML.Base.prototype.writers.wfs},CLASS_NAME:"OpenLayers.Format.GML.v2"});OpenLayers.Format.GML.v3=OpenLayers.Class(OpenLayers.Format.GML.Base,{schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",curve:false,multiCurve:true,surface:false,multiSurface:true,initialize:function(a){OpenLayers.Format.GML.Base.prototype.initialize.apply(this,[a])},readers:{gml:OpenLayers.Util.applyDefaults({featureMembers:function(a,b){this.readChildNodes(a,b)},Curve:function(b,a){var c={points:[]};this.readChildNodes(b,c);if(!a.components){a.components=[]}a.components.push(new OpenLayers.Geometry.LineString(c.points))},segments:function(a,b){this.readChildNodes(a,b)},LineStringSegment:function(b,a){var c={};this.readChildNodes(b,c);if(c.points){Array.prototype.push.apply(a.points,c.points)}},pos:function(b,d){var e=this.getChildValue(b).replace(this.regExes.trimSpace,"");var c=e.split(this.regExes.splitSpace);var a;if(this.xy){a=new OpenLayers.Geometry.Point(c[0],c[1],c[2])}else{a=new OpenLayers.Geometry.Point(c[1],c[0],c[2])}d.points=[a]},posList:function(a,d){var h=this.getChildValue(a).replace(this.regExes.trimSpace,"");var m=h.split(this.regExes.splitSpace);var e=parseInt(a.getAttribute("dimension"))||2;var b,n,l,g;var k=m.length/e;var o=new Array(k);for(var c=0,f=m.length;c<f;c+=e){n=m[c];l=m[c+1];g=(e==2)?undefined:m[c+2];if(this.xy){o[c/e]=new OpenLayers.Geometry.Point(n,l,g)}else{o[c/e]=new OpenLayers.Geometry.Point(l,n,g)}}d.points=o},Surface:function(a,b){this.readChildNodes(a,b)},patches:function(a,b){this.readChildNodes(a,b)},PolygonPatch:function(a,b){this.readers.gml.Polygon.apply(this,[a,b])},exterior:function(b,a){var c={};this.readChildNodes(b,c);
a.outer=c.components[0]},interior:function(b,a){var c={};this.readChildNodes(b,c);a.inner.push(c.components[0])},MultiCurve:function(b,a){var c={components:[]};this.readChildNodes(b,c);if(c.components.length>0){a.components=[new OpenLayers.Geometry.MultiLineString(c.components)]}},curveMember:function(a,b){this.readChildNodes(a,b)},MultiSurface:function(b,a){var c={components:[]};this.readChildNodes(b,c);if(c.components.length>0){a.components=[new OpenLayers.Geometry.MultiPolygon(c.components)]}},surfaceMember:function(a,b){this.readChildNodes(a,b)},surfaceMembers:function(a,b){this.readChildNodes(a,b)},pointMembers:function(a,b){this.readChildNodes(a,b)},lineStringMembers:function(a,b){this.readChildNodes(a,b)},polygonMembers:function(a,b){this.readChildNodes(a,b)},geometryMembers:function(a,b){this.readChildNodes(a,b)},Envelope:function(d,b){var e={points:new Array(2)};this.readChildNodes(d,e);if(!b.components){b.components=[]}var c=e.points[0];var a=e.points[1];b.components.push(new OpenLayers.Bounds(c.x,c.y,a.x,a.y))},lowerCorner:function(b,a){var c={};this.readers.gml.pos.apply(this,[b,c]);a.points[0]=c.points[0]},upperCorner:function(b,a){var c={};this.readers.gml.pos.apply(this,[b,c]);a.points[1]=c.points[0]}},OpenLayers.Format.GML.Base.prototype.readers.gml),feature:OpenLayers.Format.GML.Base.prototype.readers.feature,wfs:OpenLayers.Format.GML.Base.prototype.readers.wfs},write:function(c){var b;if(c instanceof Array){b="featureMembers"}else{b="featureMember"}var a=this.writeNode("gml:"+b,c);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{gml:OpenLayers.Util.applyDefaults({featureMembers:function(c){var d=this.createElementNSPlus("gml:featureMembers");for(var b=0,a=c.length;b<a;++b){this.writeNode("feature:_typeName",c[b],d)}return d},Point:function(b){var a=this.createElementNSPlus("gml:Point");this.writeNode("pos",b,a);return a},pos:function(a){var b=(this.xy)?(a.x+" "+a.y):(a.y+" "+a.x);return this.createElementNSPlus("gml:pos",{value:b})},LineString:function(b){var a=this.createElementNSPlus("gml:LineString");this.writeNode("posList",b.components,a);return a},Curve:function(b){var a=this.createElementNSPlus("gml:Curve");this.writeNode("segments",b,a);return a},segments:function(b){var a=this.createElementNSPlus("gml:segments");this.writeNode("LineStringSegment",b,a);return a},LineStringSegment:function(b){var a=this.createElementNSPlus("gml:LineStringSegment");this.writeNode("posList",b.components,a);return a},posList:function(d){var b=d.length;var e=new Array(b);var a;for(var c=0;c<b;++c){a=d[c];if(this.xy){e[c]=a.x+" "+a.y}else{e[c]=a.y+" "+a.x}}return this.createElementNSPlus("gml:posList",{value:e.join(" ")})},Surface:function(b){var a=this.createElementNSPlus("gml:Surface");this.writeNode("patches",b,a);return a},patches:function(b){var a=this.createElementNSPlus("gml:patches");this.writeNode("PolygonPatch",b,a);return a},PolygonPatch:function(d){var c=this.createElementNSPlus("gml:PolygonPatch",{attributes:{interpolation:"planar"}});this.writeNode("exterior",d.components[0],c);for(var b=1,a=d.components.length;b<a;++b){this.writeNode("interior",d.components[b],c)}return c},Polygon:function(d){var c=this.createElementNSPlus("gml:Polygon");this.writeNode("exterior",d.components[0],c);for(var b=1,a=d.components.length;b<a;++b){this.writeNode("interior",d.components[b],c)}return c},exterior:function(a){var b=this.createElementNSPlus("gml:exterior");this.writeNode("LinearRing",a,b);return b},interior:function(a){var b=this.createElementNSPlus("gml:interior");this.writeNode("LinearRing",a,b);return b},LinearRing:function(a){var b=this.createElementNSPlus("gml:LinearRing");this.writeNode("posList",a.components,b);return b},MultiCurve:function(d){var c=this.createElementNSPlus("gml:MultiCurve");for(var b=0,a=d.components.length;b<a;++b){this.writeNode("curveMember",d.components[b],c)}return c},curveMember:function(b){var a=this.createElementNSPlus("gml:curveMember");
if(this.curve){this.writeNode("Curve",b,a)}else{this.writeNode("LineString",b,a)}return a},MultiSurface:function(d){var c=this.createElementNSPlus("gml:MultiSurface");for(var b=0,a=d.components.length;b<a;++b){this.writeNode("surfaceMember",d.components[b],c)}return c},surfaceMember:function(a){var b=this.createElementNSPlus("gml:surfaceMember");if(this.surface){this.writeNode("Surface",a,b)}else{this.writeNode("Polygon",a,b)}return b},Envelope:function(b){var a=this.createElementNSPlus("gml:Envelope");this.writeNode("lowerCorner",b,a);this.writeNode("upperCorner",b,a);if(this.srsName){a.setAttribute("srsName",this.srsName)}return a},lowerCorner:function(a){var b=(this.xy)?(a.left+" "+a.bottom):(a.bottom+" "+a.left);return this.createElementNSPlus("gml:lowerCorner",{value:b})},upperCorner:function(a){var b=(this.xy)?(a.right+" "+a.top):(a.top+" "+a.right);return this.createElementNSPlus("gml:upperCorner",{value:b})}},OpenLayers.Format.GML.Base.prototype.writers.gml),feature:OpenLayers.Format.GML.Base.prototype.writers.feature,wfs:OpenLayers.Format.GML.Base.prototype.writers.wfs},setGeometryTypes:function(){this.geometryTypes={"OpenLayers.Geometry.Point":"Point","OpenLayers.Geometry.MultiPoint":"MultiPoint","OpenLayers.Geometry.LineString":(this.curve===true)?"Curve":"LineString","OpenLayers.Geometry.MultiLineString":(this.multiCurve===false)?"MultiLineString":"MultiCurve","OpenLayers.Geometry.Polygon":(this.surface===true)?"Surface":"Polygon","OpenLayers.Geometry.MultiPolygon":(this.multiSurface===false)?"MultiPolygon":"MultiSurface","OpenLayers.Geometry.Collection":"GeometryCollection"}},CLASS_NAME:"OpenLayers.Format.GML.v3"});OpenLayers.Format.Atom=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{atom:"http://www.w3.org/2005/Atom",georss:"http://www.georss.org/georss"},feedTitle:"untitled",defaultEntryTitle:"untitled",gmlParser:null,xy:false,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){if(typeof a=="string"){a=OpenLayers.Format.XML.prototype.read.apply(this,[a])}return this.parseFeatures(a)},write:function(c){var d;if(c instanceof Array){d=this.createElementNSPlus("atom:feed");d.appendChild(this.createElementNSPlus("atom:title",{value:this.feedTitle}));for(var a=0,b=c.length;a<b;a++){d.appendChild(this.buildEntryNode(c[a]))}}else{d=this.buildEntryNode(c)}return OpenLayers.Format.XML.prototype.write.apply(this,[d])},buildContentNode:function(b){var a=this.createElementNSPlus("atom:content",{attributes:{type:b.type||null}});if(b.src){a.setAttribute("src",b.src)}else{if(b.type=="text"||b.type==null){a.appendChild(this.createTextNode(b.value))}else{if(b.type=="html"){if(typeof b.value!="string"){throw"HTML content must be in form of an escaped string"}a.appendChild(this.createTextNode(b.value))}else{if(b.type=="xhtml"){a.appendChild(b.value)}else{if(b.type=="xhtml"||b.type.match(/(\+|\/)xml$/)){a.appendChild(b.value)}else{a.appendChild(this.createTextNode(b.value))}}}}}return a},buildEntryNode:function(n){var c=n.attributes;var j=c.atom||{};var k=this.createElementNSPlus("atom:entry");if(j.authors){var h=j.authors instanceof Array?j.authors:[j.authors];for(var d=0,m=h.length;d<m;d++){k.appendChild(this.buildPersonConstructNode("author",h[d]))}}if(j.categories){var e=j.categories instanceof Array?j.categories:[j.categories];var a;for(var d=0,m=e.length;d<m;d++){a=e[d];k.appendChild(this.createElementNSPlus("atom:category",{attributes:{term:a.term,scheme:a.scheme||null,label:a.label||null}}))}}if(j.content){k.appendChild(this.buildContentNode(j.content))}if(j.contributors){var f=j.contributors instanceof Array?j.contributors:[j.contributors];for(var d=0,m=f.length;d<m;d++){k.appendChild(this.buildPersonConstructNode("contributor",f[d]))}}if(n.fid){k.appendChild(this.createElementNSPlus("atom:id",{value:n.fid}))}if(j.links){var l=j.links instanceof Array?j.links:[j.links];var g;for(var d=0,m=l.length;d<m;d++){g=l[d];k.appendChild(this.createElementNSPlus("atom:link",{attributes:{href:g.href,rel:g.rel||null,type:g.type||null,hreflang:g.hreflang||null,title:g.title||null,length:g.length||null}}))
}}if(j.published){k.appendChild(this.createElementNSPlus("atom:published",{value:j.published}))}if(j.rights){k.appendChild(this.createElementNSPlus("atom:rights",{value:j.rights}))}if(j.summary||c.description){k.appendChild(this.createElementNSPlus("atom:summary",{value:j.summary||c.description}))}k.appendChild(this.createElementNSPlus("atom:title",{value:j.title||c.title||this.defaultEntryTitle}));if(j.updated){k.appendChild(this.createElementNSPlus("atom:updated",{value:j.updated}))}if(n.geometry){var b=this.createElementNSPlus("georss:where");b.appendChild(this.buildGeometryNode(n.geometry));k.appendChild(b)}return k},initGmlParser:function(){this.gmlParser=new OpenLayers.Format.GML.v3({xy:this.xy,featureNS:"http://example.com#feature",internalProjection:this.internalProjection,externalProjection:this.externalProjection})},buildGeometryNode:function(b){if(!this.gmlParser){this.initGmlParser()}var a=this.gmlParser.writeNode("feature:_geometry",b);return a.firstChild},buildPersonConstructNode:function(b,f){var d=["uri","email"];var a=this.createElementNSPlus("atom:"+b);a.appendChild(this.createElementNSPlus("atom:name",{value:f.name}));for(var c=0,e=d.length;c<e;c++){if(f[d[c]]){a.appendChild(this.createElementNSPlus("atom:"+d[c],{value:f[d[c]]}))}}return a},getFirstChildValue:function(d,b,c,f){var e;var a=this.getElementsByTagNameNS(d,b,c);if(a&&a.length>0){e=this.getChildValue(a[0],f)}else{e=f}return e},parseFeature:function(d){var m={};var n=null;var a=null;var k=null;var b=this.namespaces.atom;this.parsePersonConstructs(d,"author",m);a=this.getElementsByTagNameNS(d,b,"category");if(a.length>0){m.categories=[]}for(var g=0,o=a.length;g<o;g++){n={};n.term=a[g].getAttribute("term");k=a[g].getAttribute("scheme");if(k){n.scheme=k}k=a[g].getAttribute("label");if(k){n.label=k}m.categories.push(n)}a=this.getElementsByTagNameNS(d,b,"content");if(a.length>0){n={};k=a[0].getAttribute("type");if(k){n.type=k}k=a[0].getAttribute("src");if(k){n.src=k}else{if(n.type=="text"||n.type=="html"||n.type==null){n.value=this.getFirstChildValue(d,b,"content",null)}else{if(n.type=="xhtml"||n.type.match(/(\+|\/)xml$/)){n.value=this.getChildEl(a[0])}else{n.value=this.getFirstChildValue(d,b,"content",null)}}m.content=n}}this.parsePersonConstructs(d,"contributor",m);m.id=this.getFirstChildValue(d,b,"id",null);a=this.getElementsByTagNameNS(d,b,"link");if(a.length>0){m.links=new Array(a.length)}var c=["rel","type","hreflang","title","length"];for(var g=0,o=a.length;g<o;g++){n={};n.href=a[g].getAttribute("href");for(var e=0,h=c.length;e<h;e++){k=a[g].getAttribute(c[e]);if(k){n[c[e]]=k}}m.links[g]=n}n=this.getFirstChildValue(d,b,"published",null);if(n){m.published=n}n=this.getFirstChildValue(d,b,"rights",null);if(n){m.rights=n}n=this.getFirstChildValue(d,b,"summary",null);if(n){m.summary=n}m.title=this.getFirstChildValue(d,b,"title",null);m.updated=this.getFirstChildValue(d,b,"updated",null);var f={title:m.title,description:m.summary,atom:m};var l=this.parseLocations(d)[0];var p=new OpenLayers.Feature.Vector(l,f);p.fid=m.id;return p},parseFeatures:function(e){var d=[];var a=this.getElementsByTagNameNS(e,this.namespaces.atom,"entry");if(a.length==0){a=[e]}for(var b=0,c=a.length;b<c;b++){d.push(this.parseFeature(a[b]))}return d},parseLocations:function(c){var a=this.namespaces.georss;var k={components:[]};var f=this.getElementsByTagNameNS(c,a,"where");if(f&&f.length>0){if(!this.gmlParser){this.initGmlParser()}for(var e=0,q=f.length;e<q;e++){this.gmlParser.readChildNodes(f[e],k)}}var h=k.components;var n=this.getElementsByTagNameNS(c,a,"point");if(n&&n.length>0){for(var e=0,q=n.length;e<q;e++){var s=OpenLayers.String.trim(n[e].firstChild.nodeValue).split(/\s+/);if(s.length!=2){s=OpenLayers.String.trim(n[e].firstChild.nodeValue).split(/\s*,\s*/)}h.push(new OpenLayers.Geometry.Point(parseFloat(s[1]),parseFloat(s[0])))}}var r=this.getElementsByTagNameNS(c,a,"line");if(r&&r.length>0){var m;var b;var o;for(var e=0,q=r.length;e<q;e++){m=OpenLayers.String.trim(r[e].firstChild.nodeValue).split(/\s+/);
o=[];for(var d=0,g=m.length;d<g;d+=2){b=new OpenLayers.Geometry.Point(parseFloat(m[d+1]),parseFloat(m[d]));o.push(b)}h.push(new OpenLayers.Geometry.LineString(o))}}var l=this.getElementsByTagNameNS(c,a,"polygon");if(l&&l.length>0){var m;var b;var o;for(var e=0,q=l.length;e<q;e++){m=OpenLayers.String.trim(l[e].firstChild.nodeValue).split(/\s+/);o=[];for(var d=0,g=m.length;d<g;d+=2){b=new OpenLayers.Geometry.Point(parseFloat(m[d+1]),parseFloat(m[d]));o.push(b)}h.push(new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(h)]))}}if(this.internalProjection&&this.externalProjection){for(var e=0,q=h.length;e<q;e++){if(h[e]){h[e].transform(this.externalProjection,this.internalProjection)}}}return h},parsePersonConstructs:function(d,a,g){var m=[];var c=this.namespaces.atom;var b=this.getElementsByTagNameNS(d,c,a);var e=["uri","email"];for(var h=0,o=b.length;h<o;h++){var n={};n.name=this.getFirstChildValue(b[h],c,"name",null);for(var f=0,k=e.length;f<k;f++){var l=this.getFirstChildValue(b[h],c,e[f],null);if(l){n[e[f]]=l}}m.push(n)}if(m.length>0){g[a+"s"]=m}},CLASS_NAME:"OpenLayers.Format.Atom"});OpenLayers.Format.Filter.v1_0_0=OpenLayers.Class(OpenLayers.Format.GML.v2,OpenLayers.Format.Filter.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/ogc/filter/1.0.0/filter.xsd",initialize:function(a){OpenLayers.Format.GML.v2.prototype.initialize.apply(this,[a])},readers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(b,c){var a=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO});this.readChildNodes(b,a);c.filters.push(a)},PropertyIsNotEqualTo:function(b,c){var a=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.NOT_EQUAL_TO});this.readChildNodes(b,a);c.filters.push(a)},PropertyIsLike:function(d,e){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LIKE});this.readChildNodes(d,c);var f=d.getAttribute("wildCard");var b=d.getAttribute("singleChar");var a=d.getAttribute("escape");c.value2regex(f,b,a);e.filters.push(c)}},OpenLayers.Format.Filter.v1.prototype.readers.ogc),gml:OpenLayers.Format.GML.v2.prototype.readers.gml,feature:OpenLayers.Format.GML.v2.prototype.readers.feature},writers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsEqualTo");this.writeNode("PropertyName",a,b);this.writeNode("Literal",a.value,b);return b},PropertyIsNotEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsNotEqualTo");this.writeNode("PropertyName",a,b);this.writeNode("Literal",a.value,b);return b},PropertyIsLike:function(a){var b=this.createElementNSPlus("ogc:PropertyIsLike",{attributes:{wildCard:"*",singleChar:".",escape:"!"}});this.writeNode("PropertyName",a,b);this.writeNode("Literal",a.regex2value(),b);return b},BBOX:function(a){var c=this.createElementNSPlus("ogc:BBOX");this.writeNode("PropertyName",a,c);var b=this.writeNode("gml:Box",a.value,c);if(a.projection){b.setAttribute("srsName",a.projection)}return c}},OpenLayers.Format.Filter.v1.prototype.writers.ogc),gml:OpenLayers.Format.GML.v2.prototype.writers.gml,feature:OpenLayers.Format.GML.v2.prototype.writers.feature},writeSpatial:function(b,a){var c=this.createElementNSPlus("ogc:"+a);this.writeNode("PropertyName",b,c);var d;if(b.value instanceof OpenLayers.Geometry){d=this.writeNode("feature:_geometry",b.value).firstChild}else{d=this.writeNode("gml:Box",b.value)}if(b.projection){d.setAttribute("srsName",b.projection)}c.appendChild(d);return c},CLASS_NAME:"OpenLayers.Format.Filter.v1_0_0"});OpenLayers.Format.Filter.v1_1_0=OpenLayers.Class(OpenLayers.Format.GML.v3,OpenLayers.Format.Filter.v1,{VERSION:"1.1.0",schemaLocation:"http://www.opengis.net/ogc/filter/1.1.0/filter.xsd",initialize:function(a){OpenLayers.Format.GML.v3.prototype.initialize.apply(this,[a])},readers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(b,d){var c=b.getAttribute("matchCase");var a=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,matchCase:!(c==="false"||c==="0")});
this.readChildNodes(b,a);d.filters.push(a)},PropertyIsNotEqualTo:function(b,d){var c=b.getAttribute("matchCase");var a=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.NOT_EQUAL_TO,matchCase:!(c==="false"||c==="0")});this.readChildNodes(b,a);d.filters.push(a)},PropertyIsLike:function(d,e){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LIKE});this.readChildNodes(d,c);var f=d.getAttribute("wildCard");var b=d.getAttribute("singleChar");var a=d.getAttribute("escapeChar");c.value2regex(f,b,a);e.filters.push(c)}},OpenLayers.Format.Filter.v1.prototype.readers.ogc),gml:OpenLayers.Format.GML.v3.prototype.readers.gml,feature:OpenLayers.Format.GML.v3.prototype.readers.feature},writers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsEqualTo",{attributes:{matchCase:a.matchCase}});this.writeNode("PropertyName",a,b);this.writeNode("Literal",a.value,b);return b},PropertyIsNotEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsNotEqualTo",{attributes:{matchCase:a.matchCase}});this.writeNode("PropertyName",a,b);this.writeNode("Literal",a.value,b);return b},PropertyIsLike:function(a){var b=this.createElementNSPlus("ogc:PropertyIsLike",{attributes:{wildCard:"*",singleChar:".",escapeChar:"!"}});this.writeNode("PropertyName",a,b);this.writeNode("Literal",a.regex2value(),b);return b},BBOX:function(a){var c=this.createElementNSPlus("ogc:BBOX");this.writeNode("PropertyName",a,c);var b=this.writeNode("gml:Envelope",a.value);if(a.projection){b.setAttribute("srsName",a.projection)}c.appendChild(b);return c}},OpenLayers.Format.Filter.v1.prototype.writers.ogc),gml:OpenLayers.Format.GML.v3.prototype.writers.gml,feature:OpenLayers.Format.GML.v3.prototype.writers.feature},writeSpatial:function(b,a){var c=this.createElementNSPlus("ogc:"+a);this.writeNode("PropertyName",b,c);var d;if(b.value instanceof OpenLayers.Geometry){d=this.writeNode("feature:_geometry",b.value).firstChild}else{d=this.writeNode("gml:Envelope",b.value)}if(b.projection){d.setAttribute("srsName",b.projection)}c.appendChild(d);return c},CLASS_NAME:"OpenLayers.Format.Filter.v1_1_0"});OpenLayers.Format.SOSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.SOSCapabilities,{namespaces:{ows:"http://www.opengis.net/ows/1.1",sos:"http://www.opengis.net/sos/1.0",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink"},regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);this.options=a},read:function(b){if(typeof b=="string"){b=OpenLayers.Format.XML.prototype.read.apply(this,[b])}if(b&&b.nodeType==9){b=b.documentElement}var a={};this.readNode(b,a);return a},readers:{gml:OpenLayers.Util.applyDefaults({name:function(a,b){b.name=this.getChildValue(a)},TimePeriod:function(a,b){b.timePeriod={};this.readChildNodes(a,b.timePeriod)},beginPosition:function(b,a){a.beginPosition=this.getChildValue(b)},endPosition:function(b,a){a.endPosition=this.getChildValue(b)}},OpenLayers.Format.GML.v3.prototype.readers.gml),sos:{Capabilities:function(a,b){this.readChildNodes(a,b)},Contents:function(a,b){b.contents={};this.readChildNodes(a,b.contents)},ObservationOfferingList:function(b,a){a.offeringList={};this.readChildNodes(b,a.offeringList)},ObservationOffering:function(b,a){var c=this.getAttributeNS(b,this.namespaces.gml,"id");a[c]={procedures:[],observedProperties:[],featureOfInterestIds:[],responseFormats:[],resultModels:[],responseModes:[]};this.readChildNodes(b,a[c])},time:function(a,b){b.time={};this.readChildNodes(a,b.time)},procedure:function(a,b){b.procedures.push(this.getAttributeNS(a,this.namespaces.xlink,"href"))},observedProperty:function(a,b){b.observedProperties.push(this.getAttributeNS(a,this.namespaces.xlink,"href"))},featureOfInterest:function(a,b){b.featureOfInterestIds.push(this.getAttributeNS(a,this.namespaces.xlink,"href"))},responseFormat:function(a,b){b.responseFormats.push(this.getChildValue(a))
},resultModel:function(a,b){b.resultModels.push(this.getChildValue(a))},responseMode:function(a,b){b.responseModes.push(this.getChildValue(a))}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.SOSCapabilities.v1_0_0"});OpenLayers.Format.SOSGetFeatureOfInterest=OpenLayers.Class(OpenLayers.Format.XML,{VERSION:"1.0.0",namespaces:{sos:"http://www.opengis.net/sos/1.0",gml:"http://www.opengis.net/gml",sa:"http://www.opengis.net/sampling/1.0",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"http://www.opengis.net/sos/1.0 http://schemas.opengis.net/sos/1.0.0/sosAll.xsd",defaultPrefix:"sos",regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(f){if(typeof f=="string"){f=OpenLayers.Format.XML.prototype.read.apply(this,[f])}if(f&&f.nodeType==9){f=f.documentElement}var g={features:[]};this.readNode(f,g);var e=[];for(var d=0,a=g.features.length;d<a;d++){var b=g.features[d];if(this.internalProjection&&this.externalProjection&&b.components[0]){b.components[0].transform(this.externalProjection,this.internalProjection)}var c=new OpenLayers.Feature.Vector(b.components[0],b.attributes);e.push(c)}return e},readers:{sa:{SamplingPoint:function(b,c){if(!c.attributes){var a={attributes:{}};c.features.push(a);c=a}c.attributes.id=this.getAttributeNS(b,this.namespaces.gml,"id");this.readChildNodes(b,c)},position:function(a,b){this.readChildNodes(a,b)}},gml:OpenLayers.Util.applyDefaults({FeatureCollection:function(a,b){this.readChildNodes(a,b)},featureMember:function(b,c){var a={attributes:{}};c.features.push(a);this.readChildNodes(b,a)},name:function(a,b){b.attributes.name=this.getChildValue(a)},pos:function(a,b){if(!this.externalProjection){this.externalProjection=new OpenLayers.Projection(a.getAttribute("srsName"))}OpenLayers.Format.GML.v3.prototype.readers.gml.pos.apply(this,[a,b])}},OpenLayers.Format.GML.v3.prototype.readers.gml)},writers:{sos:{GetFeatureOfInterest:function(b){var d=this.createElementNSPlus("GetFeatureOfInterest",{attributes:{version:this.VERSION,service:"SOS","xsi:schemaLocation":this.schemaLocation}});for(var c=0,a=b.fois.length;c<a;c++){this.writeNode("FeatureOfInterestId",{foi:b.fois[c]},d)}return d},FeatureOfInterestId:function(a){var b=this.createElementNSPlus("FeatureOfInterestId",{value:a.foi});return b}}},CLASS_NAME:"OpenLayers.Format.SOSGetFeatureOfInterest"});OpenLayers.Format.SOSGetObservation=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ows:"http://www.opengis.net/ows",gml:"http://www.opengis.net/gml",sos:"http://www.opengis.net/sos/1.0",ogc:"http://www.opengis.net/ogc",om:"http://www.opengis.net/om/1.0",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/sos/1.0 http://schemas.opengis.net/sos/1.0.0/sosGetObservation.xsd",defaultPrefix:"sos",initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){if(typeof a=="string"){a=OpenLayers.Format.XML.prototype.read.apply(this,[a])}if(a&&a.nodeType==9){a=a.documentElement}var b={measurements:[]};this.readNode(a,b);return b},write:function(a){var b=this.writeNode("sos:GetObservation",a);b.setAttribute("xmlns:om",this.namespaces.om);this.setAttributeNS(b,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[b])},readers:{om:{ObservationCollection:function(a,b){b.id=this.getAttributeNS(a,this.namespaces.gml,"id");this.readChildNodes(a,b)},member:function(a,b){this.readChildNodes(a,b)},Measurement:function(b,c){var a={};c.measurements.push(a);this.readChildNodes(b,a)},samplingTime:function(b,a){var c={};a.samplingTime=c;this.readChildNodes(b,c)},observedProperty:function(b,a){a.observedProperty=this.getAttributeNS(b,this.namespaces.xlink,"href");
this.readChildNodes(b,a)},procedure:function(b,a){a.procedure=this.getAttributeNS(b,this.namespaces.xlink,"href");this.readChildNodes(b,a)},result:function(c,b){var a={};b.result=a;if(this.getChildValue(c)!==""){a.value=this.getChildValue(c);a.uom=c.getAttribute("uom")}else{this.readChildNodes(c,a)}}},gml:OpenLayers.Util.applyDefaults({TimeInstant:function(a,b){var c={};b.timeInstant=c;this.readChildNodes(a,c)},timePosition:function(a,b){b.timePosition=this.getChildValue(a)}},OpenLayers.Format.GML.v3.prototype.readers.gml)},writers:{sos:{GetObservation:function(a){var b=this.createElementNSPlus("GetObservation",{attributes:{version:this.VERSION,service:"SOS"}});this.writeNode("offering",a,b);this.writeNode("eventTime",a,b);this.writeNode("procedure",a,b);this.writeNode("observedProperty",a,b);this.writeNode("responseFormat",a,b);this.writeNode("resultModel",a,b);this.writeNode("responseMode",a,b);return b},responseFormat:function(a){return this.createElementNSPlus("responseFormat",{value:a.responseFormat})},procedure:function(a){return this.createElementNSPlus("procedure",{value:a.procedure})},offering:function(a){return this.createElementNSPlus("offering",{value:a.offering})},observedProperty:function(a){return this.createElementNSPlus("observedProperty",{value:a.observedProperty})},eventTime:function(a){var b=this.createElementNSPlus("eventTime");if(a.eventTime==="latest"){this.writeNode("ogc:TM_Equals",a,b)}return b},resultModel:function(a){return this.createElementNSPlus("resultModel",{value:a.resultModel})},responseMode:function(a){return this.createElementNSPlus("responseMode",{value:a.responseMode})}},ogc:{TM_Equals:function(a){var b=this.createElementNSPlus("ogc:TM_Equals");this.writeNode("ogc:PropertyName",{property:"urn:ogc:data:time:iso8601"},b);if(a.eventTime==="latest"){this.writeNode("gml:TimeInstant",{value:"latest"},b)}return b},PropertyName:function(a){return this.createElementNSPlus("ogc:PropertyName",{value:a.property})}},gml:{TimeInstant:function(a){var b=this.createElementNSPlus("gml:TimeInstant");this.writeNode("gml:timePosition",a,b);return b},timePosition:function(a){var b=this.createElementNSPlus("gml:timePosition",{value:a.value});return b}}},CLASS_NAME:"OpenLayers.Format.SOSGetObservation"});OpenLayers.Format.CSWGetRecords.v2_0_2=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",csw:"http://www.opengis.net/cat/csw/2.0.2",dc:"http://purl.org/dc/elements/1.1/",dct:"http://purl.org/dc/terms/",ows:"http://www.opengis.net/ows"},defaultPrefix:"csw",version:"2.0.2",schemaLocation:"http://www.opengis.net/cat/csw/2.0.2 http://schemas.opengis.net/csw/2.0.2/CSW-discovery.xsd",requestId:null,resultType:null,outputFormat:null,outputSchema:null,startPosition:null,maxRecords:null,DistributedSearch:null,ResponseHandler:null,Query:null,regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){if(typeof a=="string"){a=OpenLayers.Format.XML.prototype.read.apply(this,[a])}if(a&&a.nodeType==9){a=a.documentElement}var b={};this.readNode(a,b);return b},readers:{csw:{GetRecordsResponse:function(b,c){c.records=[];this.readChildNodes(b,c);var a=this.getAttributeNS(b,"","version");if(a!=""){c.version=a}},RequestId:function(a,b){b.RequestId=this.getChildValue(a)},SearchStatus:function(a,c){c.SearchStatus={};var b=this.getAttributeNS(a,"","timestamp");if(b!=""){c.SearchStatus.timestamp=b}},SearchResults:function(d,e){this.readChildNodes(d,e);var b=d.attributes;var f={};for(var c=0,a=b.length;c<a;++c){if((b[c].name=="numberOfRecordsMatched")||(b[c].name=="numberOfRecordsReturned")||(b[c].name=="nextRecord")){f[b[c].name]=parseInt(b[c].nodeValue)}else{f[b[c].name]=b[c].nodeValue}}e.SearchResults=f},SummaryRecord:function(b,c){var a={type:"SummaryRecord"};this.readChildNodes(b,a);c.records.push(a)},BriefRecord:function(b,c){var a={type:"BriefRecord"};
this.readChildNodes(b,a);c.records.push(a)},DCMIRecord:function(b,c){var a={type:"DCMIRecord"};this.readChildNodes(b,a);c.records.push(a)},Record:function(b,c){var a={type:"Record"};this.readChildNodes(b,a);c.records.push(a)}},dc:{"*":function(f,g){var d=f.localName||f.nodeName.split(":").pop();if(!(g[d] instanceof Array)){g[d]=new Array()}var c={};var b=f.attributes;for(var e=0,a=b.length;e<a;++e){c[b[e].name]=b[e].nodeValue}c.value=this.getChildValue(f);g[d].push(c)}},dct:{"*":function(b,c){var a=b.localName||b.nodeName.split(":").pop();if(!(c[a] instanceof Array)){c[a]=new Array()}c[a].push(this.getChildValue(b))}},ows:OpenLayers.Util.applyDefaults({BoundingBox:function(a,b){if(b.bounds){b.BoundingBox=[{crs:b.projection,value:[b.bounds.left,b.bounds.bottom,b.bounds.right,b.bounds.top]}];delete b.projection;delete b.bounds}OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows["BoundingBox"].apply(this,arguments)}},OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows)},write:function(a){var b=this.writeNode("csw:GetRecords",a);return OpenLayers.Format.XML.prototype.write.apply(this,[b])},writers:{csw:{GetRecords:function(b){if(!b){b={}}var e=this.createElementNSPlus("csw:GetRecords",{attributes:{service:"CSW",version:this.version,requestId:b.requestId||this.requestId,resultType:b.resultType||this.resultType,outputFormat:b.outputFormat||this.outputFormat,outputSchema:b.outputSchema||this.outputSchema,startPosition:b.startPosition||this.startPosition,maxRecords:b.maxRecords||this.maxRecords}});if(b.DistributedSearch||this.DistributedSearch){this.writeNode("csw:DistributedSearch",b.DistributedSearch||this.DistributedSearch,e)}var d=b.ResponseHandler||this.ResponseHandler;if(d instanceof Array&&d.length>0){for(var c=0,a=d.length;c<a;c++){this.writeNode("csw:ResponseHandler",d[c],e)}}this.writeNode("Query",b.Query||this.Query,e);return e},DistributedSearch:function(a){var b=this.createElementNSPlus("csw:DistributedSearch",{attributes:{hopCount:a.hopCount}});return b},ResponseHandler:function(a){var b=this.createElementNSPlus("csw:ResponseHandler",{value:a.value});return b},Query:function(b){if(!b){b={}}var e=this.createElementNSPlus("csw:Query",{attributes:{typeNames:b.typeNames||"csw:Record"}});var d=b.ElementName;if(d instanceof Array&&d.length>0){for(var c=0,a=d.length;c<a;c++){this.writeNode("csw:ElementName",d[c],e)}}else{this.writeNode("csw:ElementSetName",b.ElementSetName||{value:"summary"},e)}if(b.Constraint){this.writeNode("csw:Constraint",b.Constraint,e)}return e},ElementName:function(a){var b=this.createElementNSPlus("csw:ElementName",{value:a.value});return b},ElementSetName:function(a){var b=this.createElementNSPlus("csw:ElementSetName",{attributes:{typeNames:a.typeNames},value:a.value});return b},Constraint:function(a){var b=this.createElementNSPlus("csw:Constraint",{attributes:{version:a.version}});if(a.Filter){var c=new OpenLayers.Format.Filter({version:a.version});b.appendChild(c.write(a.Filter))}else{if(a.CqlText){var d=this.createElementNSPlus("CqlText",{value:a.CqlText.value});b.appendChild(d)}}return b}}},CLASS_NAME:"OpenLayers.Format.CSWGetRecords.v2_0_2"});OpenLayers.Format.SLD.v1=OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0,{namespaces:{sld:"http://www.opengis.net/sld",ogc:"http://www.opengis.net/ogc",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"sld",schemaLocation:null,multipleSymbolizers:false,featureTypeCounter:null,defaultSymbolizer:{fillColor:"#808080",fillOpacity:1,strokeColor:"#000000",strokeOpacity:1,strokeWidth:1,strokeDashstyle:"solid",pointRadius:3,graphicName:"square"},initialize:function(a){OpenLayers.Format.Filter.v1_0_0.prototype.initialize.apply(this,[a])},read:function(c,a){a=OpenLayers.Util.applyDefaults(a,this.options);var b={namedLayers:a.namedLayersAsArray===true?[]:{}};this.readChildNodes(c,b);return b},readers:OpenLayers.Util.applyDefaults({sld:{StyledLayerDescriptor:function(a,b){b.version=a.getAttribute("version");
this.readChildNodes(a,b)},Name:function(a,b){b.name=this.getChildValue(a)},Title:function(a,b){b.title=this.getChildValue(a)},Abstract:function(a,b){b.description=this.getChildValue(a)},NamedLayer:function(d,e){var c={userStyles:[],namedStyles:[]};this.readChildNodes(d,c);for(var b=0,a=c.userStyles.length;b<a;++b){c.userStyles[b].layerName=c.name}if(e.namedLayers instanceof Array){e.namedLayers.push(c)}else{e.namedLayers[c.name]=c}},NamedStyle:function(b,a){a.namedStyles.push(this.getChildName(b.firstChild))},UserStyle:function(c,a){var d={defaultsPerSymbolizer:true,rules:[]};this.featureTypeCounter=-1;this.readChildNodes(c,d);var b;if(this.multipleSymbolizers){delete d.defaultsPerSymbolizer;b=new OpenLayers.Style2(d)}else{b=new OpenLayers.Style(this.defaultSymbolizer,d)}a.userStyles.push(b)},IsDefault:function(b,a){if(this.getChildValue(b)=="1"){a.isDefault=true}},FeatureTypeStyle:function(b,a){++this.featureTypeCounter;var c={rules:this.multipleSymbolizers?a.rules:[]};this.readChildNodes(b,c);if(!this.multipleSymbolizers){a.rules=c.rules}},Rule:function(b,d){var a;if(this.multipleSymbolizers){a={symbolizers:[]}}var c=new OpenLayers.Rule(a);this.readChildNodes(b,c);d.rules.push(c)},ElseFilter:function(a,b){b.elseFilter=true},MinScaleDenominator:function(a,b){b.minScaleDenominator=parseFloat(this.getChildValue(a))},MaxScaleDenominator:function(a,b){b.maxScaleDenominator=parseFloat(this.getChildValue(a))},TextSymbolizer:function(b,c){var a={};this.readChildNodes(b,a);if(this.multipleSymbolizers){a.zIndex=this.featureTypeCounter;c.symbolizers.push(new OpenLayers.Symbolizer.Text(a))}else{c.symbolizer.Text=OpenLayers.Util.applyDefaults(a,c.symbolizer.Text)}},Label:function(b,a){var d={};this.readChildNodes(b,d);if(d.property){a.label="${"+d.property+"}"}else{var c=this.readOgcExpression(b);if(c){a.label=c}}},Font:function(b,a){this.readChildNodes(b,a)},Halo:function(b,a){var c={};this.readChildNodes(b,c);a.haloRadius=c.haloRadius;a.haloColor=c.fillColor;a.haloOpacity=c.fillOpacity},Radius:function(c,b){var a=this.readOgcExpression(c);if(a!=null){b.haloRadius=a}},RasterSymbolizer:function(b,c){var a={};this.readChildNodes(b,a);if(this.multipleSymbolizers){a.zIndex=this.featureTypeCounter;c.symbolizers.push(new OpenLayers.Symbolizer.Raster(a))}else{c.symbolizer.Raster=OpenLayers.Util.applyDefaults(a,c.symbolizer.Raster)}},Geometry:function(a,b){b.geometry={};this.readChildNodes(a,b.geometry)},ColorMap:function(b,a){a.colorMap=[];this.readChildNodes(b,a.colorMap)},ColorMapEntry:function(b,a){var c=b.getAttribute("quantity");var d=b.getAttribute("opacity");a.push({color:b.getAttribute("color"),quantity:c!==null?parseFloat(c):undefined,label:b.getAttribute("label")||undefined,opacity:d!==null?parseFloat(d):undefined})},LineSymbolizer:function(b,c){var a={};this.readChildNodes(b,a);if(this.multipleSymbolizers){a.zIndex=this.featureTypeCounter;c.symbolizers.push(new OpenLayers.Symbolizer.Line(a))}else{c.symbolizer.Line=OpenLayers.Util.applyDefaults(a,c.symbolizer.Line)}},PolygonSymbolizer:function(b,c){var a={fill:false,stroke:false};if(!this.multipleSymbolizers){a=c.symbolizer.Polygon||a}this.readChildNodes(b,a);if(this.multipleSymbolizers){a.zIndex=this.featureTypeCounter;c.symbolizers.push(new OpenLayers.Symbolizer.Polygon(a))}else{c.symbolizer.Polygon=a}},PointSymbolizer:function(b,c){var a={fill:false,stroke:false,graphic:false};if(!this.multipleSymbolizers){a=c.symbolizer.Point||a}this.readChildNodes(b,a);if(this.multipleSymbolizers){a.zIndex=this.featureTypeCounter;c.symbolizers.push(new OpenLayers.Symbolizer.Point(a))}else{c.symbolizer.Point=a}},Stroke:function(b,a){a.stroke=true;this.readChildNodes(b,a)},Fill:function(b,a){a.fill=true;this.readChildNodes(b,a)},CssParameter:function(c,b){var a=c.getAttribute("name");var e=this.cssMap[a];if(e){var d=this.readOgcExpression(c);if(d){b[e]=d}}},Graphic:function(e,d){d.graphic=true;var h={};this.readChildNodes(e,h);var c=["stroke","strokeColor","strokeWidth","strokeOpacity","strokeLinecap","fill","fillColor","fillOpacity","graphicName","rotation","graphicFormat"];
var g,f;for(var b=0,a=c.length;b<a;++b){g=c[b];f=h[g];if(f!=undefined){d[g]=f}}if(h.opacity!=undefined){d.graphicOpacity=h.opacity}if(h.size!=undefined){d.pointRadius=h.size/2}if(h.href!=undefined){d.externalGraphic=h.href}if(h.rotation!=undefined){d.rotation=h.rotation}},ExternalGraphic:function(a,b){this.readChildNodes(a,b)},Mark:function(a,b){this.readChildNodes(a,b)},WellKnownName:function(a,b){b.graphicName=this.getChildValue(a)},Opacity:function(b,c){var a=this.readOgcExpression(b);if(a){c.opacity=a}},Size:function(b,c){var a=this.readOgcExpression(b);if(a){c.size=a}},Rotation:function(b,c){var a=this.readOgcExpression(b);if(a){c.rotation=a}},OnlineResource:function(a,b){b.href=this.getAttributeNS(a,this.namespaces.xlink,"href")},Format:function(a,b){b.graphicFormat=this.getChildValue(a)}}},OpenLayers.Format.Filter.v1_0_0.prototype.readers),cssMap:{stroke:"strokeColor","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","stroke-linecap":"strokeLinecap","stroke-dasharray":"strokeDashstyle",fill:"fillColor","fill-opacity":"fillOpacity","font-family":"fontFamily","font-size":"fontSize","font-weight":"fontWeight","font-style":"fontStyle"},getCssProperty:function(a){var b=null;for(var c in this.cssMap){if(this.cssMap[c]==a){b=c;break}}return b},getGraphicFormat:function(a){var d,c;for(var b in this.graphicFormats){if(this.graphicFormats[b].test(a)){d=b;break}}return d||this.defautlGraphicFormat},defaultGraphicFormat:"image/png",graphicFormats:{"image/jpeg":/\.jpe?g$/i,"image/gif":/\.gif$/i,"image/png":/\.png$/i},write:function(a){return this.writers.sld.StyledLayerDescriptor.apply(this,[a])},writers:OpenLayers.Util.applyDefaults({sld:{StyledLayerDescriptor:function(e){var b=this.createElementNSPlus("sld:StyledLayerDescriptor",{attributes:{version:this.VERSION,"xsi:schemaLocation":this.schemaLocation}});b.setAttribute("xmlns:ogc",this.namespaces.ogc);b.setAttribute("xmlns:gml",this.namespaces.gml);if(e.name){this.writeNode("Name",e.name,b)}if(e.title){this.writeNode("Title",e.title,b)}if(e.description){this.writeNode("Abstract",e.description,b)}if(e.namedLayers instanceof Array){for(var d=0,a=e.namedLayers.length;d<a;++d){this.writeNode("NamedLayer",e.namedLayers[d],b)}}else{for(var c in e.namedLayers){this.writeNode("NamedLayer",e.namedLayers[c],b)}}return b},Name:function(a){return this.createElementNSPlus("sld:Name",{value:a})},Title:function(a){return this.createElementNSPlus("sld:Title",{value:a})},Abstract:function(a){return this.createElementNSPlus("sld:Abstract",{value:a})},NamedLayer:function(c){var d=this.createElementNSPlus("sld:NamedLayer");this.writeNode("Name",c.name,d);if(c.namedStyles){for(var b=0,a=c.namedStyles.length;b<a;++b){this.writeNode("NamedStyle",c.namedStyles[b],d)}}if(c.userStyles){for(var b=0,a=c.userStyles.length;b<a;++b){this.writeNode("UserStyle",c.userStyles[b],d)}}return d},NamedStyle:function(a){var b=this.createElementNSPlus("sld:NamedStyle");this.writeNode("Name",a,b);return b},UserStyle:function(b){var d=this.createElementNSPlus("sld:UserStyle");if(b.name){this.writeNode("Name",b.name,d)}if(b.title){this.writeNode("Title",b.title,d)}if(b.description){this.writeNode("Abstract",b.description,d)}if(b.isDefault){this.writeNode("IsDefault",b.isDefault,d)}if(this.multipleSymbolizers&&b.rules){var m={0:[]};var c=[0];var l,a,p,k,h;for(var f=0,o=b.rules.length;f<o;++f){l=b.rules[f];if(l.symbolizers){a={};for(var e=0,g=l.symbolizers.length;e<g;++e){p=l.symbolizers[e];k=p.zIndex;if(!(k in a)){h=l.clone();h.symbolizers=[];a[k]=h}a[k].symbolizers.push(p.clone())}for(k in a){if(!(k in m)){c.push(k);m[k]=[]}m[k].push(a[k])}}else{m[0].push(l.clone())}}c.sort();var n;for(var f=0,o=c.length;f<o;++f){n=m[c[f]];if(n.length>0){h=b.clone();h.rules=m[c[f]];this.writeNode("FeatureTypeStyle",h,d)}}}else{this.writeNode("FeatureTypeStyle",b,d)}return d},IsDefault:function(a){return this.createElementNSPlus("sld:IsDefault",{value:(a)?"1":"0"})},FeatureTypeStyle:function(c){var d=this.createElementNSPlus("sld:FeatureTypeStyle");
for(var b=0,a=c.rules.length;b<a;++b){this.writeNode("Rule",c.rules[b],d)}return d},Rule:function(h){var g=this.createElementNSPlus("sld:Rule");if(h.name){this.writeNode("Name",h.name,g)}if(h.title){this.writeNode("Title",h.title,g)}if(h.description){this.writeNode("Abstract",h.description,g)}if(h.elseFilter){this.writeNode("ElseFilter",null,g)}else{if(h.filter){this.writeNode("ogc:Filter",h.filter,g)}}if(h.minScaleDenominator!=undefined){this.writeNode("MinScaleDenominator",h.minScaleDenominator,g)}if(h.maxScaleDenominator!=undefined){this.writeNode("MaxScaleDenominator",h.maxScaleDenominator,g)}var f,e;if(this.multipleSymbolizers&&h.symbolizers){var e;for(var c=0,d=h.symbolizers.length;c<d;++c){e=h.symbolizers[c];f=e.CLASS_NAME.split(".").pop();this.writeNode(f+"Symbolizer",e,g)}}else{var b=OpenLayers.Style.SYMBOLIZER_PREFIXES;for(var c=0,a=b.length;c<a;++c){f=b[c];e=h.symbolizer[f];if(e){this.writeNode(f+"Symbolizer",e,g)}}}return g},ElseFilter:function(){return this.createElementNSPlus("sld:ElseFilter")},MinScaleDenominator:function(a){return this.createElementNSPlus("sld:MinScaleDenominator",{value:a})},MaxScaleDenominator:function(a){return this.createElementNSPlus("sld:MaxScaleDenominator",{value:a})},LineSymbolizer:function(a){var b=this.createElementNSPlus("sld:LineSymbolizer");this.writeNode("Stroke",a,b);return b},Stroke:function(a){var b=this.createElementNSPlus("sld:Stroke");if(a.strokeColor!=undefined){this.writeNode("CssParameter",{symbolizer:a,key:"strokeColor"},b)}if(a.strokeOpacity!=undefined){this.writeNode("CssParameter",{symbolizer:a,key:"strokeOpacity"},b)}if(a.strokeWidth!=undefined){this.writeNode("CssParameter",{symbolizer:a,key:"strokeWidth"},b)}if(a.strokeDashstyle!=undefined&&a.strokeDashstyle!=="solid"){this.writeNode("CssParameter",{symbolizer:a,key:"strokeDashstyle"},b)}if(a.strokeLinecap!=undefined){this.writeNode("CssParameter",{symbolizer:a,key:"strokeLinecap"},b)}return b},CssParameter:function(a){return this.createElementNSPlus("sld:CssParameter",{attributes:{name:this.getCssProperty(a.key)},value:a.symbolizer[a.key]})},TextSymbolizer:function(a){var b=this.createElementNSPlus("sld:TextSymbolizer");if(a.label!=null){this.writeNode("Label",a.label,b)}if(a.fontFamily!=null||a.fontSize!=null||a.fontWeight!=null||a.fontStyle!=null){this.writeNode("Font",a,b)}if(a.haloRadius!=null||a.haloColor!=null||a.haloOpacity!=null){this.writeNode("Halo",a,b)}if(a.fillColor!=null||a.fillOpacity!=null){this.writeNode("Fill",a,b)}return b},Font:function(a){var b=this.createElementNSPlus("sld:Font");if(a.fontFamily){this.writeNode("CssParameter",{symbolizer:a,key:"fontFamily"},b)}if(a.fontSize){this.writeNode("CssParameter",{symbolizer:a,key:"fontSize"},b)}if(a.fontWeight){this.writeNode("CssParameter",{symbolizer:a,key:"fontWeight"},b)}if(a.fontStyle){this.writeNode("CssParameter",{symbolizer:a,key:"fontStyle"},b)}return b},Label:function(b){var f=this.createElementNSPlus("sld:Label");var g=b.split("${");f.appendChild(this.createTextNode(g[0]));var e,d;for(var c=1,a=g.length;c<a;c++){e=g[c];d=e.indexOf("}");if(d>0){this.writeNode("ogc:PropertyName",{property:e.substring(0,d)},f);f.appendChild(this.createTextNode(e.substring(++d)))}else{f.appendChild(this.createTextNode("${"+e))}}return f},Halo:function(a){var b=this.createElementNSPlus("sld:Halo");if(a.haloRadius){this.writeNode("Radius",a.haloRadius,b)}if(a.haloColor||a.haloOpacity){this.writeNode("Fill",{fillColor:a.haloColor,fillOpacity:a.haloOpacity},b)}return b},Radius:function(a){return this.createElementNSPlus("sld:Radius",{value:a})},RasterSymbolizer:function(a){var b=this.createElementNSPlus("sld:RasterSymbolizer");if(a.geometry){this.writeNode("Geometry",a.geometry,b)}if(a.opacity){this.writeNode("Opacity",a.opacity,b)}if(a.colorMap){this.writeNode("ColorMap",a.colorMap,b)}return b},Geometry:function(b){var a=this.createElementNSPlus("sld:Geometry");if(b.property){this.writeNode("ogc:PropertyName",b,a)}return a},ColorMap:function(b){var d=this.createElementNSPlus("sld:ColorMap");
for(var c=0,a=b.length;c<a;++c){this.writeNode("ColorMapEntry",b[c],d)}return d},ColorMapEntry:function(c){var d=this.createElementNSPlus("sld:ColorMapEntry");var b=c;d.setAttribute("color",b.color);b.opacity!==undefined&&d.setAttribute("opacity",parseFloat(b.opacity));b.quantity!==undefined&&d.setAttribute("quantity",parseFloat(b.quantity));b.label!==undefined&&d.setAttribute("label",b.label);return d},PolygonSymbolizer:function(a){var b=this.createElementNSPlus("sld:PolygonSymbolizer");if(a.fill!==false){this.writeNode("Fill",a,b)}if(a.stroke!==false){this.writeNode("Stroke",a,b)}return b},Fill:function(a){var b=this.createElementNSPlus("sld:Fill");if(a.fillColor){this.writeNode("CssParameter",{symbolizer:a,key:"fillColor"},b)}if(a.fillOpacity!=null){this.writeNode("CssParameter",{symbolizer:a,key:"fillOpacity"},b)}return b},PointSymbolizer:function(a){var b=this.createElementNSPlus("sld:PointSymbolizer");this.writeNode("Graphic",a,b);return b},Graphic:function(a){var b=this.createElementNSPlus("sld:Graphic");if(a.externalGraphic!=undefined){this.writeNode("ExternalGraphic",a,b)}else{this.writeNode("Mark",a,b)}if(a.graphicOpacity!=undefined){this.writeNode("Opacity",a.graphicOpacity,b)}if(a.pointRadius!=undefined){this.writeNode("Size",a.pointRadius*2,b)}if(a.rotation!=undefined){this.writeNode("Rotation",a.rotation,b)}return b},ExternalGraphic:function(a){var b=this.createElementNSPlus("sld:ExternalGraphic");this.writeNode("OnlineResource",a.externalGraphic,b);var c=a.graphicFormat||this.getGraphicFormat(a.externalGraphic);this.writeNode("Format",c,b);return b},Mark:function(a){var b=this.createElementNSPlus("sld:Mark");if(a.graphicName){this.writeNode("WellKnownName",a.graphicName,b)}if(a.fill!==false){this.writeNode("Fill",a,b)}if(a.stroke!==false){this.writeNode("Stroke",a,b)}return b},WellKnownName:function(a){return this.createElementNSPlus("sld:WellKnownName",{value:a})},Opacity:function(a){return this.createElementNSPlus("sld:Opacity",{value:a})},Size:function(a){return this.createElementNSPlus("sld:Size",{value:a})},Rotation:function(a){return this.createElementNSPlus("sld:Rotation",{value:a})},OnlineResource:function(a){return this.createElementNSPlus("sld:OnlineResource",{attributes:{"xlink:type":"simple","xlink:href":a}})},Format:function(a){return this.createElementNSPlus("sld:Format",{value:a})}}},OpenLayers.Format.Filter.v1_0_0.prototype.writers),CLASS_NAME:"OpenLayers.Format.SLD.v1"});OpenLayers.Format.WFST.v1_0_0=OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0,OpenLayers.Format.WFST.v1,{version:"1.0.0",srsNameInQuery:false,schemaLocations:{wfs:"http://schemas.opengis.net/wfs/1.0.0/WFS-transaction.xsd"},initialize:function(a){OpenLayers.Format.Filter.v1_0_0.prototype.initialize.apply(this,[a]);OpenLayers.Format.WFST.v1.prototype.initialize.apply(this,[a])},readers:{wfs:OpenLayers.Util.applyDefaults({WFS_TransactionResponse:function(a,b){b.insertIds=[];b.success=false;this.readChildNodes(a,b)},InsertResult:function(b,a){var c={fids:[]};this.readChildNodes(b,c);a.insertIds.push(c.fids[0])},TransactionResult:function(a,b){this.readChildNodes(a,b)},Status:function(a,b){this.readChildNodes(a,b)},SUCCESS:function(a,b){b.success=true}},OpenLayers.Format.WFST.v1.prototype.readers.wfs),gml:OpenLayers.Format.GML.v2.prototype.readers.gml,feature:OpenLayers.Format.GML.v2.prototype.readers.feature,ogc:OpenLayers.Format.Filter.v1_0_0.prototype.readers.ogc},writers:{wfs:OpenLayers.Util.applyDefaults({Query:function(b){b=OpenLayers.Util.extend({featureNS:this.featureNS,featurePrefix:this.featurePrefix,featureType:this.featureType,srsName:this.srsName,srsNameInQuery:this.srsNameInQuery},b);var d=this.createElementNSPlus("wfs:Query",{attributes:{typeName:(b.featureNS?b.featurePrefix+":":"")+b.featureType}});if(b.srsNameInQuery&&b.srsName){d.setAttribute("srsName",b.srsName)}if(b.featureNS){d.setAttribute("xmlns:"+b.featurePrefix,b.featureNS)}if(b.propertyNames){for(var c=0,a=b.propertyNames.length;c<a;c++){this.writeNode("ogc:PropertyName",{property:b.propertyNames[c]},d)
}}if(b.filter){this.setFilterProperty(b.filter);this.writeNode("ogc:Filter",b.filter,d)}return d}},OpenLayers.Format.WFST.v1.prototype.writers.wfs),gml:OpenLayers.Format.GML.v2.prototype.writers.gml,feature:OpenLayers.Format.GML.v2.prototype.writers.feature,ogc:OpenLayers.Format.Filter.v1_0_0.prototype.writers.ogc},CLASS_NAME:"OpenLayers.Format.WFST.v1_0_0"});OpenLayers.Format.WFST.v1_1_0=OpenLayers.Class(OpenLayers.Format.Filter.v1_1_0,OpenLayers.Format.WFST.v1,{version:"1.1.0",schemaLocations:{wfs:"http://schemas.opengis.net/wfs/1.1.0/wfs.xsd"},initialize:function(a){OpenLayers.Format.Filter.v1_1_0.prototype.initialize.apply(this,[a]);OpenLayers.Format.WFST.v1.prototype.initialize.apply(this,[a])},readers:{wfs:OpenLayers.Util.applyDefaults({FeatureCollection:function(a,b){b.numberOfFeatures=parseInt(a.getAttribute("numberOfFeatures"));OpenLayers.Format.WFST.v1.prototype.readers.wfs["FeatureCollection"].apply(this,arguments)},TransactionResponse:function(a,b){b.insertIds=[];b.success=false;this.readChildNodes(a,b)},TransactionSummary:function(a,b){b.success=true},InsertResults:function(a,b){this.readChildNodes(a,b)},Feature:function(b,a){var c={fids:[]};this.readChildNodes(b,c);a.insertIds.push(c.fids[0])}},OpenLayers.Format.WFST.v1.prototype.readers.wfs),gml:OpenLayers.Format.GML.v3.prototype.readers.gml,feature:OpenLayers.Format.GML.v3.prototype.readers.feature,ogc:OpenLayers.Format.Filter.v1_1_0.prototype.readers.ogc},writers:{wfs:OpenLayers.Util.applyDefaults({GetFeature:function(a){var b=OpenLayers.Format.WFST.v1.prototype.writers.wfs["GetFeature"].apply(this,arguments);a&&a.resultType&&this.setAttributes(b,{resultType:a.resultType});return b},Query:function(b){b=OpenLayers.Util.extend({featureNS:this.featureNS,featurePrefix:this.featurePrefix,featureType:this.featureType,srsName:this.srsName},b);var d=this.createElementNSPlus("wfs:Query",{attributes:{typeName:(b.featureNS?b.featurePrefix+":":"")+b.featureType,srsName:b.srsName}});if(b.featureNS){d.setAttribute("xmlns:"+b.featurePrefix,b.featureNS)}if(b.propertyNames){for(var c=0,a=b.propertyNames.length;c<a;c++){this.writeNode("wfs:PropertyName",{property:b.propertyNames[c]},d)}}if(b.filter){this.setFilterProperty(b.filter);this.writeNode("ogc:Filter",b.filter,d)}return d},PropertyName:function(a){return this.createElementNSPlus("wfs:PropertyName",{value:a.property})}},OpenLayers.Format.WFST.v1.prototype.writers.wfs),gml:OpenLayers.Format.GML.v3.prototype.writers.gml,feature:OpenLayers.Format.GML.v3.prototype.writers.feature,ogc:OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc},CLASS_NAME:"OpenLayers.Format.WFST.v1_1_0"});OpenLayers.Protocol.SOS.v1_0_0=OpenLayers.Class(OpenLayers.Protocol,{fois:null,formatOptions:null,initialize:function(a){OpenLayers.Protocol.prototype.initialize.apply(this,[a]);if(!a.format){this.format=new OpenLayers.Format.SOSGetFeatureOfInterest(this.formatOptions)}},destroy:function(){if(this.options&&!this.options.format){this.format.destroy()}this.format=null;OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(b){b=OpenLayers.Util.extend({},b);OpenLayers.Util.applyDefaults(b,this.options||{});var a=new OpenLayers.Protocol.Response({requestType:"read"});var d=this.format;var c=OpenLayers.Format.XML.prototype.write.apply(d,[d.writeNode("sos:GetFeatureOfInterest",{fois:this.fois})]);a.priv=OpenLayers.Request.POST({url:b.url,callback:this.createCallback(this.handleRead,a,b),data:c});return a},handleRead:function(a,b){if(b.callback){var c=a.priv;if(c.status>=200&&c.status<300){a.features=this.parseFeatures(c);a.code=OpenLayers.Protocol.Response.SUCCESS}else{a.code=OpenLayers.Protocol.Response.FAILURE}b.callback.call(b.scope,a)}},parseFeatures:function(a){var b=a.responseXML;if(!b||!b.documentElement){b=a.responseText}if(!b||b.length<=0){return null}return this.format.read(b)},CLASS_NAME:"OpenLayers.Protocol.SOS.v1_0_0"});OpenLayers.Format.SLD.v1_0_0=OpenLayers.Class(OpenLayers.Format.SLD.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/sld http://schemas.opengis.net/sld/1.0.0/StyledLayerDescriptor.xsd",initialize:function(a){OpenLayers.Format.SLD.v1.prototype.initialize.apply(this,[a])
},CLASS_NAME:"OpenLayers.Format.SLD.v1_0_0"});OpenLayers.Protocol.WFS.v1_0_0=OpenLayers.Class(OpenLayers.Protocol.WFS.v1,{version:"1.0.0",CLASS_NAME:"OpenLayers.Protocol.WFS.v1_0_0"});OpenLayers.Protocol.WFS.v1_1_0=OpenLayers.Class(OpenLayers.Protocol.WFS.v1,{version:"1.1.0",CLASS_NAME:"OpenLayers.Protocol.WFS.v1_1_0"});OpenLayers.Format.OWSContext.v0_3_1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{owc:"http://www.opengis.net/ows-context",gml:"http://www.opengis.net/gml",kml:"http://www.opengis.net/kml/2.2",ogc:"http://www.opengis.net/ogc",ows:"http://www.opengis.net/ows",sld:"http://www.opengis.net/sld",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},VERSION:"0.3.1",schemaLocation:"http://www.opengis.net/ows-context http://www.ogcnetwork.net/schemas/owc/0.3.1/owsContext.xsd",defaultPrefix:"owc",extractAttributes:true,xy:true,regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},featureNS:"http://mapserver.gis.umn.edu/mapserver",featureType:"vector",geometryName:"geometry",nestingLayerLookup:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);OpenLayers.Format.GML.v2.prototype.setGeometryTypes.call(this)},setNestingPath:function(b){if(b.layersContext){for(var c=0,a=b.layersContext.length;c<a;c++){var f=b.layersContext[c];var d=[];var e=b.title||"";if(b.metadata&&b.metadata.nestingPath){d=b.metadata.nestingPath.slice()}if(e!=""){d.push(e)}f.metadata.nestingPath=d;if(f.layersContext){this.setNestingPath(f)}}}},decomposeNestingPath:function(c){var b=[];if(c instanceof Array){while(c.length>0){b.push(c.slice());c.pop()}b.reverse()}return b},read:function(b){if(typeof b=="string"){b=OpenLayers.Format.XML.prototype.read.apply(this,[b])}if(b&&b.nodeType==9){b=b.documentElement}var a={};this.readNode(b,a);this.setNestingPath({layersContext:a.layersContext});var c=[];this.processLayer(c,a);delete a.layersContext;a.layersContext=c;return a},processLayer:function(b,e){if(e.layersContext){for(var d=0,a=e.layersContext.length;d<a;d++){var c=e.layersContext[d];b.push(c);if(c.layersContext){this.processLayer(b,c)}}}},write:function(d,c){var b="OWSContext";this.nestingLayerLookup={};c=c||{};OpenLayers.Util.applyDefaults(c,d);var a=this.writeNode(b,c);this.nestingLayerLookup=null;this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},readers:{kml:{Document:function(a,b){b.features=new OpenLayers.Format.KML({kmlns:this.namespaces.kml,extractStyles:true}).read(a)}},owc:{OWSContext:function(a,b){this.readChildNodes(a,b)},General:function(a,b){this.readChildNodes(a,b)},ResourceList:function(a,b){this.readChildNodes(a,b)},Layer:function(a,c){var b={metadata:{},visibility:(a.getAttribute("hidden")!="1"),queryable:(a.getAttribute("queryable")=="1"),opacity:((a.getAttribute("opacity")!=null)?parseFloat(a.getAttribute("opacity")):null),name:a.getAttribute("name"),categoryLayer:(a.getAttribute("name")==null),formats:[],styles:[]};if(!c.layersContext){c.layersContext=[]}c.layersContext.push(b);this.readChildNodes(a,b)},InlineGeometry:function(b,d){d.features=[];var c=this.getElementsByTagNameNS(b,this.namespaces.gml,"featureMember");var a;if(c.length>=1){a=c[0]}if(a&&a.firstChild){var e=(a.firstChild.nextSibling)?a.firstChild.nextSibling:a.firstChild;this.setNamespace("feature",e.namespaceURI);this.featureType=e.localName||e.nodeName.split(":").pop();this.readChildNodes(b,d)}},Server:function(a,b){if((!b.service&&!b.version)||(b.service!=OpenLayers.Format.Context.serviceTypes.WMS)){b.service=a.getAttribute("service");b.version=a.getAttribute("version");this.readChildNodes(a,b)}},Name:function(a,b){b.name=this.getChildValue(a);this.readChildNodes(a,b)},Title:function(a,b){b.title=this.getChildValue(a);this.readChildNodes(a,b)},StyleList:function(a,b){this.readChildNodes(a,b.styles)},Style:function(b,c){var a={};c.push(a);this.readChildNodes(b,a)
},LegendURL:function(b,c){var a={};c.legend=a;this.readChildNodes(b,a)},OnlineResource:function(a,b){b.url=this.getAttributeNS(a,this.namespaces.xlink,"href");this.readChildNodes(a,b)}},ows:OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows,gml:OpenLayers.Format.GML.v2.prototype.readers.gml,sld:OpenLayers.Format.SLD.v1_0_0.prototype.readers.sld,feature:OpenLayers.Format.GML.v2.prototype.readers.feature},writers:{owc:{OWSContext:function(a){var b=this.createElementNSPlus("OWSContext",{attributes:{version:this.VERSION,id:a.id||OpenLayers.Util.createUniqueID("OpenLayers_OWSContext_")}});this.writeNode("General",a,b);this.writeNode("ResourceList",a,b);return b},General:function(a){var b=this.createElementNSPlus("General");this.writeNode("ows:BoundingBox",a,b);this.writeNode("ows:Title",a.title||"OpenLayers OWSContext",b);return b},ResourceList:function(c){var f=this.createElementNSPlus("ResourceList");for(var e=0,b=c.layers.length;e<b;e++){var d=c.layers[e];var a=this.decomposeNestingPath(d.metadata.nestingPath);this.writeNode("_Layer",{layer:d,subPaths:a},f)}return f},Server:function(a){var b=this.createElementNSPlus("Server",{attributes:{version:a.version,service:a.service}});this.writeNode("OnlineResource",a,b);return b},OnlineResource:function(a){var b=this.createElementNSPlus("OnlineResource",{attributes:{"xlink:href":a.url}});return b},InlineGeometry:function(c){var d=this.createElementNSPlus("InlineGeometry");this.writeNode("gml:boundedBy",c.getDataExtent(),d);for(var b=0,a=c.features.length;b<a;b++){this.writeNode("gml:featureMember",c.features[b],d)}return d},StyleList:function(d){var c=this.createElementNSPlus("StyleList");for(var b=0,a=d.length;b<a;b++){this.writeNode("Style",d[b],c)}return c},Style:function(a){var b=this.createElementNSPlus("Style");this.writeNode("Name",a,b);this.writeNode("Title",a,b);this.writeNode("LegendURL",a,b);return b},Name:function(b){var a=this.createElementNSPlus("Name",{value:b.name});return a},Title:function(b){var a=this.createElementNSPlus("Title",{value:b.title});return a},LegendURL:function(a){var b=this.createElementNSPlus("LegendURL");this.writeNode("OnlineResource",a.legend,b);return b},_WMS:function(a){var b=this.createElementNSPlus("Layer",{attributes:{name:a.params.LAYERS,queryable:a.queryable?"1":"0",hidden:a.visibility?"0":"1",opacity:a.opacity?a.opacity:null}});this.writeNode("ows:Title",a.name,b);this.writeNode("ows:OutputFormat",a.params.FORMAT,b);this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.WMS,version:a.params.VERSION,url:a.url},b);if(a.metadata.styles&&a.metadata.styles.length>0){this.writeNode("StyleList",a.metadata.styles,b)}return b},_Layer:function(b){var c,g,d,f;c=b.layer;g=b.subPaths;d=null;f=null;if(g.length>0){var e=g[0].join("/");var a=e.lastIndexOf("/");d=this.nestingLayerLookup[e];f=(a>0)?e.substring(a+1,e.length):e;if(!d){d=this.createElementNSPlus("Layer");this.writeNode("ows:Title",f,d);this.nestingLayerLookup[e]=d}b.subPaths.shift();this.writeNode("_Layer",b,d);return d}else{if(c instanceof OpenLayers.Layer.WMS){d=this.writeNode("_WMS",c)}else{if(c instanceof OpenLayers.Layer.Vector){if(c.protocol instanceof OpenLayers.Protocol.WFS.v1){d=this.writeNode("_WFS",c)}else{if(c.protocol instanceof OpenLayers.Protocol.HTTP){if(c.protocol.format instanceof OpenLayers.Format.GML){c.protocol.format.version="2.1.2";d=this.writeNode("_GML",c)}else{if(c.protocol.format instanceof OpenLayers.Format.KML){c.protocol.format.version="2.2";d=this.writeNode("_KML",c)}}}else{this.setNamespace("feature",this.featureNS);d=this.writeNode("_InlineGeometry",c)}}}}if(c.options.maxScale){this.writeNode("sld:MinScaleDenominator",c.options.maxScale,d)}if(c.options.minScale){this.writeNode("sld:MaxScaleDenominator",c.options.minScale,d)}this.nestingLayerLookup[c.name]=d;return d}},_WFS:function(a){var b=this.createElementNSPlus("Layer",{attributes:{name:a.protocol.featurePrefix+":"+a.protocol.featureType,hidden:a.visibility?"0":"1"}});this.writeNode("ows:Title",a.name,b);
this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.WFS,version:a.protocol.version,url:a.protocol.url},b);return b},_InlineGeometry:function(a){var b=this.createElementNSPlus("Layer",{attributes:{name:this.featureType,hidden:a.visibility?"0":"1"}});this.writeNode("ows:Title",a.name,b);this.writeNode("InlineGeometry",a,b);return b},_GML:function(a){var b=this.createElementNSPlus("Layer");this.writeNode("ows:Title",a.name,b);this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.GML,url:a.protocol.url,version:a.protocol.format.version},b);return b},_KML:function(a){var b=this.createElementNSPlus("Layer");this.writeNode("ows:Title",a.name,b);this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.KML,version:a.protocol.format.version,url:a.protocol.url},b);return b}},gml:OpenLayers.Util.applyDefaults({boundedBy:function(b){var a=this.createElementNSPlus("gml:boundedBy");this.writeNode("gml:Box",b,a);return a}},OpenLayers.Format.GML.v2.prototype.writers.gml),ows:OpenLayers.Format.OWSCommon.v1_0_0.prototype.writers.ows,sld:OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld,feature:OpenLayers.Format.GML.v2.prototype.writers.feature},CLASS_NAME:"OpenLayers.Format.OWSContext.v0_3_1"});Ext.namespace("GeoExt");GeoExt.LayerLegend=Ext.extend(Ext.Container,{layerRecord:null,showTitle:true,legendTitle:null,labelCls:null,layerStore:null,initComponent:function(){GeoExt.LayerLegend.superclass.initComponent.call(this);this.autoEl={};this.add({xtype:"label",text:this.getLayerTitle(this.layerRecord),cls:"x-form-item x-form-item-label"+(this.labelCls?" "+this.labelCls:"")});if(this.layerRecord&&this.layerRecord.store){this.layerStore=this.layerRecord.store;this.layerStore.on("update",this.onStoreUpdate,this)}},onStoreUpdate:function(c,a,b){if(a===this.layerRecord&&this.items.getCount()>0){var d=a.getLayer();this.setVisible(d.getVisibility()&&d.calculateInRange()&&d.displayInLayerSwitcher&&!a.get("hideInLegend"));this.update()}},update:function(){var a=this.getLayerTitle(this.layerRecord);if(this.items.get(0).text!==a){this.items.get(0).setText(a)}},getLayerTitle:function(a){var b=this.legendTitle||"";if(this.showTitle&&!b){if(a&&!a.get("hideTitle")){b=a.get("title")||a.get("name")||a.getLayer().name||""}}return b},beforeDestroy:function(){this.layerStore&&this.layerStore.un("update",this.onStoreUpdate,this);GeoExt.LayerLegend.superclass.beforeDestroy.apply(this,arguments)}});GeoExt.LayerLegend.getTypes=function(b,a){var d=(a||[]).concat();var c=[];for(var e in GeoExt.LayerLegend.types){if(GeoExt.LayerLegend.types[e].supports(b)){d.indexOf(e)==-1&&c.push(e)}else{d.remove(e)}}return d.concat(c)};GeoExt.LayerLegend.supports=function(a){};GeoExt.LayerLegend.types={};Ext.namespace("GeoExt");GeoExt.VectorLegend=Ext.extend(GeoExt.LayerLegend,{layerRecord:null,layer:null,rules:null,symbolType:null,untitledPrefix:"Untitled ",clickableSymbol:false,clickableTitle:false,selectOnClick:false,enableDD:false,bodyBorder:false,feature:null,selectedRule:null,currentScaleDenominator:null,initComponent:function(){GeoExt.VectorLegend.superclass.initComponent.call(this);if(this.layerRecord){this.layer=this.layerRecord.getLayer();if(this.layer.map){this.currentScaleDenominator=this.layer.map.getScale();this.layer.map.events.on({zoomend:this.onMapZoom,scope:this})}}if(!this.symbolType){if(this.feature){this.symbolType=this.symbolTypeFromFeature(this.feature)}else{if(this.layer){if(this.layer.features.length>0){var a=this.layer.features[0].clone();a.attributes={};this.feature=a;this.symbolType=this.symbolTypeFromFeature(this.feature)}else{this.layer.events.on({featuresadded:this.onFeaturesAdded,scope:this})}}}}if(this.layer&&this.feature&&!this.rules){this.setRules()}this.rulesContainer=new Ext.Container({autoEl:{}});this.add(this.rulesContainer);this.addEvents("titleclick","symbolclick","ruleclick","ruleselected","ruleunselected","rulemoved");this.update()},onMapZoom:function(){this.setCurrentScaleDenominator(this.layer.map.getScale())},symbolTypeFromFeature:function(b){var a=b.geometry.CLASS_NAME.match(/Point|Line|Polygon/);return(a&&a[0])||"Point"},onFeaturesAdded:function(){this.layer.events.un({featuresadded:this.onFeaturesAdded,scope:this});var a=this.layer.features[0].clone();a.attributes={};this.feature=a;this.symbolType=this.symbolTypeFromFeature(this.feature);if(!this.rules){this.setRules()}this.update()},setRules:function(){var a=this.layer.styleMap&&this.layer.styleMap.styles["default"];if(!a){a=new OpenLayers.Style()}if(a.rules.length===0){this.rules=[new OpenLayers.Rule({symbolizer:a.createSymbolizer(this.feature)})]}else{this.rules=a.rules}},setCurrentScaleDenominator:function(a){if(a!==this.currentScaleDenominator){this.currentScaleDenominator=a;this.update()}},getRuleEntry:function(a){return this.rulesContainer.items.get(this.rules.indexOf(a))},addRuleEntry:function(a,b){this.rulesContainer.add(this.createRuleEntry(a));if(!b){this.doLayout()}},removeRuleEntry:function(a,c){var b=this.getRuleEntry(a);if(b){this.rulesContainer.remove(b);if(!c){this.doLayout()}}},selectRuleEntry:function(b){var a=b!=this.selectedRule;if(this.selectedRule){this.unselect()}if(a){var c=this.getRuleEntry(b);c.body.addClass("x-grid3-row-selected");this.selectedRule=b;
this.fireEvent("ruleselected",this,b)}},unselect:function(){this.rulesContainer.items.each(function(b,a){if(this.rules[a]==this.selectedRule){b.body.removeClass("x-grid3-row-selected");this.selectedRule=null;this.fireEvent("ruleunselected",this,this.rules[a])}},this)},createRuleEntry:function(b){var a=true;if(this.currentScaleDenominator!=null){if(b.minScaleDenominator){a=a&&(this.currentScaleDenominator>=b.minScaleDenominator)}if(b.maxScaleDenominator){a=a&&(this.currentScaleDenominator<b.maxScaleDenominator)}}return{xtype:"panel",layout:"column",border:false,hidden:!a,bodyStyle:this.selectOnClick?{cursor:"pointer"}:undefined,defaults:{border:false},items:[this.createRuleRenderer(b),this.createRuleTitle(b)],listeners:{render:function(c){this.selectOnClick&&c.getEl().on({click:function(d){this.selectRuleEntry(b)},scope:this});if(this.enableDD==true){this.addDD(c)}},scope:this}}},createRuleRenderer:function(k){var f=[this.symbolType,"Point","Line","Polygon"];var h,e;var l=k.symbolizers;if(!l){var n=k.symbolizer;for(var c=0,g=f.length;c<g;++c){h=f[c];if(n[h]){n=n[h];e=true;break}}l=[n]}else{var a;outer:for(var c=0,m=f.length;c<m;++c){h=f[c];a=OpenLayers.Symbolizer[h];if(a){for(var b=0,d=l.length;b<d;++b){if(l[b] instanceof a){e=true;break outer}}}}}return{xtype:"gx_renderer",symbolType:e?h:this.symbolType,symbolizers:l,style:this.clickableSymbol?{cursor:"pointer"}:undefined,listeners:{click:function(){if(this.clickableSymbol){this.fireEvent("symbolclick",this,k);this.fireEvent("ruleclick",this,k)}},scope:this}}},createRuleTitle:function(a){return{cls:"x-form-item",style:"padding: 0.2em 0.5em 0;",bodyStyle:Ext.applyIf({background:"transparent"},this.clickableTitle?{cursor:"pointer"}:undefined),html:this.getRuleTitle(a),listeners:{render:function(b){this.clickableTitle&&b.getEl().on({click:function(){this.fireEvent("titleclick",this,a);this.fireEvent("ruleclick",this,a)},scope:this})},scope:this}}},addDD:function(b){var c=b.ownerCt;var a=this;new Ext.dd.DragSource(b.getEl(),{ddGroup:c.id,onDragOut:function(g,d){var f=Ext.getCmp(d);f.removeClass("gx-ruledrag-insert-above");f.removeClass("gx-ruledrag-insert-below");return Ext.dd.DragZone.prototype.onDragOut.apply(this,arguments)},onDragEnter:function(j,g){var i=Ext.getCmp(g);var f;var d=c.items.indexOf(b);var h=c.items.indexOf(i);if(d>h){f="gx-ruledrag-insert-above"}else{if(d<h){f="gx-ruledrag-insert-below"}}f&&i.addClass(f);return Ext.dd.DragZone.prototype.onDragEnter.apply(this,arguments)},onDragDrop:function(f,d){a.moveRule(c.items.indexOf(b),c.items.indexOf(Ext.getCmp(d)));return Ext.dd.DragZone.prototype.onDragDrop.apply(this,arguments)},getDragData:function(g){var f=g.getTarget(".x-column-inner");if(f){var h=f.cloneNode(true);h.id=Ext.id();return{sourceEl:f,repairXY:Ext.fly(f).getXY(),ddel:h}}}});new Ext.dd.DropTarget(b.getEl(),{ddGroup:c.id,notifyDrop:function(){return true}})},update:function(){GeoExt.VectorLegend.superclass.update.apply(this,arguments);if(this.symbolType&&this.rules){if(this.rulesContainer.items){var a;for(var b=this.rulesContainer.items.length-1;b>=0;--b){a=this.rulesContainer.getComponent(b);this.rulesContainer.remove(a,true)}}for(var b=0,c=this.rules.length;b<c;++b){this.addRuleEntry(this.rules[b],true)}this.doLayout();if(this.selectedRule){this.getRuleEntry(this.selectedRule).body.addClass("x-grid3-row-selected")}}},updateRuleEntry:function(a){var b=this.getRuleEntry(a);if(b){b.removeAll();b.add(this.createRuleRenderer(a));b.add(this.createRuleTitle(a));b.doLayout()}},moveRule:function(a,b){var c=this.rules[a];this.rules.splice(a,1);this.rules.splice(b,0,c);this.update();this.fireEvent("rulemoved",this,c)},getRuleTitle:function(a){var b=a.title||a.name||"";if(!b&&this.untitledPrefix){b=this.untitledPrefix+(this.rules.indexOf(a)+1)}return b},beforeDestroy:function(){if(this.layer){if(this.layer.events){this.layer.events.un({featuresadded:this.onFeaturesAdded,scope:this})}if(this.layer.map&&this.layer.map.events){this.layer.map.events.un({zoomend:this.onMapZoom,scope:this})
}}delete this.layer;delete this.rules;GeoExt.VectorLegend.superclass.beforeDestroy.apply(this,arguments)}});GeoExt.VectorLegend.supports=function(a){return a.getLayer() instanceof OpenLayers.Layer.Vector};GeoExt.LayerLegend.types.gx_vectorlegend=GeoExt.VectorLegend;Ext.reg("gx_vectorlegend",GeoExt.VectorLegend);Ext.namespace("GeoExt.tree");GeoExt.tree.LayerContainer=Ext.extend(Ext.tree.AsyncTreeNode,{constructor:function(a){a=Ext.applyIf(a||{},{text:"Layers"});this.loader=a.loader instanceof GeoExt.tree.LayerLoader?a.loader:new GeoExt.tree.LayerLoader(Ext.applyIf(a.loader||{},{store:a.layerStore}));GeoExt.tree.LayerContainer.superclass.constructor.call(this,a)},recordIndexToNodeIndex:function(c){var b=this.loader.store;var e=b.getCount();var a=this.childNodes.length;var f=-1;for(var d=e-1;d>=0;--d){if(this.loader.filter(b.getAt(d))===true){++f;if(c===d||f>a-1){break}}}return f},destroy:function(){delete this.layerStore;GeoExt.tree.LayerContainer.superclass.destroy.apply(this,arguments)}});Ext.tree.TreePanel.nodeTypes.gx_layercontainer=GeoExt.tree.LayerContainer;Ext.namespace("GeoExt.tree");GeoExt.tree.BaseLayerContainer=Ext.extend(GeoExt.tree.LayerContainer,{constructor:function(a){a=Ext.applyIf(a||{},{text:"Base Layer",loader:{}});a.loader=Ext.applyIf(a.loader,{baseAttrs:Ext.applyIf(a.loader.baseAttrs||{},{iconCls:"gx-tree-baselayer-icon",checkedGroup:"baselayer"}),filter:function(b){var c=b.getLayer();return c.displayInLayerSwitcher===true&&c.isBaseLayer===true}});GeoExt.tree.BaseLayerContainer.superclass.constructor.call(this,a)}});Ext.tree.TreePanel.nodeTypes.gx_baselayercontainer=GeoExt.tree.BaseLayerContainer;Ext.namespace("GeoExt.plugins");GeoExt.plugins.PrintExtent=Ext.extend(Ext.util.Observable,{initialConfig:null,printProvider:null,map:null,layer:null,control:null,pages:null,page:null,constructor:function(a){a=a||{};Ext.apply(this,a);this.initialConfig=a;if(!this.printProvider){this.printProvider=this.pages[0].printProvider}if(!this.pages){this.pages=[]}this.addEvents("selectpage");GeoExt.plugins.PrintExtent.superclass.constructor.apply(this,arguments)},print:function(a){this.printProvider.print(this.map,this.pages,a)},init:function(c){this.map=c.map;c.on("destroy",this.onMapPanelDestroy,this);if(!this.layer){this.layer=new OpenLayers.Layer.Vector(null,{displayInLayerSwitcher:false})}this.createControl();for(var b=0,a=this.pages.length;b<a;++b){this.addPage(this.pages[b])}this.show()},addPage:function(a){a=a||new GeoExt.data.PrintPage({printProvider:this.printProvider});if(this.pages.indexOf(a)===-1){this.pages.push(a)}this.layer.addFeatures([a.feature]);a.on("change",this.onPageChange,this);this.page=a;var b=this.map;if(b.getCenter()){this.fitPage()}else{b.events.register("moveend",this,function(){b.events.unregister("moveend",this,arguments.callee);this.fitPage()})}return a},removePage:function(a){this.pages.remove(a);if(a.feature.layer){this.layer.removeFeatures([a.feature])}a.un("change",this.onPageChange,this)},selectPage:function(a){this.control.active&&this.control.setFeature(a.feature)},show:function(){this.map.addLayer(this.layer);this.map.addControl(this.control);this.control.activate();if(this.page&&this.map.getCenter()){this.updateBox()}},hide:function(){var c=this.map;var b=this.control;if(b&&b.events){b.deactivate();if(c&&c.events&&b.map){c.removeControl(b)}}var a=this.layer;if(!this.initialConfig.layer&&c&&c.events&&a&&a.map){c.removeLayer(a)}},onMapPanelDestroy:function(){var e=this.map;for(var a=this.pages.length-1,c=a;c>=0;c--){this.removePage(this.pages[c])}this.hide();var d=this.control;if(e&&e.events&&d&&d.events){d.destroy()}var b=this.layer;if(!this.initialConfig.layer&&e&&e.events&&b&&b.events){b.destroy()}delete this.layer;delete this.control;delete this.page;this.map=null},createControl:function(){this.control=new OpenLayers.Control.TransformFeature(this.layer,{preserveAspectRatio:true,eventListeners:{beforesetfeature:function(c){for(var b=0,a=this.pages.length;b<a;++b){if(this.pages[b].feature===c.feature){this.page=this.pages[b];
c.object.rotation=-this.pages[b].rotation;break}}},setfeature:function(c){for(var b=0,a=this.pages.length;b<a;++b){if(this.pages[b].feature===c.feature){this.fireEvent("selectpage",this.pages[b]);break}}},beforetransform:function(g){this._updating=true;var f=this.page;if(g.rotation){if(this.printProvider.layout.get("rotation")){f.setRotation(-g.object.rotation)}else{g.object.setFeature(f.feature)}}else{if(g.center){f.setCenter(OpenLayers.LonLat.fromString(g.center.toShortString()))}else{f.fit(g.object.box,{mode:"closest"});var h=this.printProvider.scales.getAt(0);var i=this.printProvider.scales.getAt(this.printProvider.scales.getCount()-1);var b=g.object.box.geometry.getBounds();var a=f.feature.geometry.getBounds();var d=f.scale===h&&b.containsBounds(a);var c=f.scale===i&&a.containsBounds(b);if(d===true||c===true){this.updateBox()}}}delete this._updating;return false},transformcomplete:this.updateBox,scope:this}})},fitPage:function(){if(this.page){this.page.fit(this.map,{mode:"screen"})}},updateBox:function(){var a=this.page;this.control.active&&this.control.setFeature(a.feature,{rotation:-a.rotation})},onPageChange:function(b,a){if(!this._updating){this.control.active&&this.control.setFeature(b.feature,{rotation:-b.rotation})}}});Ext.preg("gx_printextent",GeoExt.plugins.PrintExtent);Ext.namespace("GeoExt");GeoExt.SliderTip=Ext.extend(Ext.slider.Tip,{hover:true,minWidth:10,offsets:[0,-10],dragging:false,init:function(a){GeoExt.SliderTip.superclass.init.apply(this,arguments);if(this.hover){a.on("render",this.registerThumbListeners,this)}this.slider=a},registerThumbListeners:function(){var a,d;for(var b=0,c=this.slider.thumbs.length;b<c;++b){a=this.slider.thumbs[b];d=a.tracker.el;(function(e,f){f.on({mouseover:function(g){this.onSlide(this.slider,g,e);this.dragging=false},mouseout:function(){if(!this.dragging){this.hide.apply(this,arguments)}},scope:this})}).apply(this,[a,d])}},onSlide:function(b,c,a){this.dragging=true;return GeoExt.SliderTip.superclass.onSlide.apply(this,arguments)}});Ext.namespace("GeoExt");GeoExt.ZoomSlider=Ext.extend(Ext.Slider,{map:null,baseCls:"gx-zoomslider",aggressive:false,updating:false,initComponent:function(){GeoExt.ZoomSlider.superclass.initComponent.call(this);if(this.map){if(this.map instanceof GeoExt.MapPanel){this.map=this.map.map}this.bind(this.map)}if(this.aggressive===true){this.on("change",this.changeHandler,this)}else{this.on("changecomplete",this.changeHandler,this)}this.on("beforedestroy",this.unbind,this)},onRender:function(){GeoExt.ZoomSlider.superclass.onRender.apply(this,arguments);this.el.addClass(this.baseCls)},afterRender:function(){Ext.Slider.superclass.afterRender.apply(this,arguments);this.update()},addToMapPanel:function(a){this.on({render:function(){var b=this.getEl();b.setStyle({position:"absolute",zIndex:a.map.Z_INDEX_BASE.Control});b.on({mousedown:this.stopMouseEvents,click:this.stopMouseEvents})},afterrender:function(){this.bind(a.map)},scope:this})},stopMouseEvents:function(a){a.stopEvent()},removeFromMapPanel:function(a){var b=this.getEl();b.un("mousedown",this.stopMouseEvents,this);b.un("click",this.stopMouseEvents,this);this.unbind()},bind:function(a){this.map=a;this.map.events.on({zoomend:this.update,changebaselayer:this.initZoomValues,scope:this});if(this.map.baseLayer){this.initZoomValues();this.update()}},unbind:function(){if(this.map){this.map.events.un({zoomend:this.update,changebaselayer:this.initZoomValues,scope:this})}},initZoomValues:function(){var a=this.map.baseLayer;if(this.initialConfig.minValue===undefined){this.minValue=a.minZoomLevel||0}if(this.initialConfig.maxValue===undefined){this.maxValue=a.minZoomLevel==null?a.numZoomLevels-1:a.maxZoomLevel}},getZoom:function(){return this.getValue()},getScale:function(){return OpenLayers.Util.getScaleFromResolution(this.map.getResolutionForZoom(this.getValue()),this.map.getUnits())},getResolution:function(){return this.map.getResolutionForZoom(this.getValue())},changeHandler:function(){if(this.map&&!this.updating){this.map.zoomTo(this.getValue())
}},update:function(){if(this.rendered&&this.map){this.updating=true;this.setValue(this.map.getZoom());this.updating=false}}});Ext.reg("gx_zoomslider",GeoExt.ZoomSlider);Ext.namespace("GeoExt.tree");GeoExt.tree.WMSCapabilitiesLoader=function(a){Ext.apply(this,a);GeoExt.tree.WMSCapabilitiesLoader.superclass.constructor.call(this)};Ext.extend(GeoExt.tree.WMSCapabilitiesLoader,Ext.tree.TreeLoader,{url:null,layerOptions:null,layerParams:null,requestMethod:"GET",getParams:function(a){return{service:"WMS",request:"GetCapabilities"}},processResponse:function(b,d,e,c){var a=new OpenLayers.Format.WMSCapabilities().read(b.responseXML||b.responseText);this.processLayer(a.capability,a.capability.request.getmap.href,d);if(typeof e=="function"){e.apply(c||d,[d])}},createWMSLayer:function(b,a){if(b.name){return new OpenLayers.Layer.WMS(b.title,a,OpenLayers.Util.extend({formats:b.formats[0],layers:b.name},this.layerParams),OpenLayers.Util.extend({minScale:b.minScale,queryable:b.queryable,maxScale:b.maxScale,metadata:b},this.layerOptions))}else{return null}},processLayer:function(b,a,c){Ext.each(b.nestedLayers,function(d){var e=this.createNode({text:d.title||d.name,nodeType:"node",layer:this.createWMSLayer(d,a),leaf:(d.nestedLayers.length===0)});if(e){c.appendChild(e)}if(d.nestedLayers){this.processLayer(d,a,e)}},this)}});Ext.namespace("GeoExt.data");GeoExt.data.WMSCapabilitiesReader=function(a,b){a=a||{};if(!a.format){a.format=new OpenLayers.Format.WMSCapabilities()}if(typeof b!=="function"){b=GeoExt.data.LayerRecord.create(b||a.fields||[{name:"name",type:"string"},{name:"title",type:"string"},{name:"abstract",type:"string"},{name:"queryable",type:"boolean"},{name:"opaque",type:"boolean"},{name:"noSubsets",type:"boolean"},{name:"cascaded",type:"int"},{name:"fixedWidth",type:"int"},{name:"fixedHeight",type:"int"},{name:"minScale",type:"float"},{name:"maxScale",type:"float"},{name:"prefix",type:"string"},{name:"formats"},{name:"styles"},{name:"srs"},{name:"dimensions"},{name:"bbox"},{name:"llbbox"},{name:"attribution"},{name:"keywords"},{name:"identifiers"},{name:"authorityURLs"},{name:"metadataURLs"}])}GeoExt.data.WMSCapabilitiesReader.superclass.constructor.call(this,a,b)};Ext.extend(GeoExt.data.WMSCapabilitiesReader,Ext.data.DataReader,{attributionCls:"gx-attribution",read:function(a){var b=a.responseXML;if(!b||!b.documentElement){b=a.responseText}return this.readRecords(b)},serviceExceptionFormat:function(a){if(OpenLayers.Util.indexOf(a,"application/vnd.ogc.se_inimage")>-1){return"application/vnd.ogc.se_inimage"}if(OpenLayers.Util.indexOf(a,"application/vnd.ogc.se_xml")>-1){return"application/vnd.ogc.se_xml"}return a[0]},imageFormat:function(b){var a=b.formats;if(b.opaque&&OpenLayers.Util.indexOf(a,"image/jpeg")>-1){return"image/jpeg"}if(OpenLayers.Util.indexOf(a,"image/png")>-1){return"image/png"}if(OpenLayers.Util.indexOf(a,"image/png; mode=24bit")>-1){return"image/png; mode=24bit"}if(OpenLayers.Util.indexOf(a,"image/gif")>-1){return"image/gif"}return a[0]},imageTransparent:function(a){return a.opaque==undefined||!a.opaque},readRecords:function(u){if(typeof u==="string"||u.nodeType){u=this.meta.format.read(u)}var e=u.version;var c=u.capability||{};var f=c.request&&c.request.getmap&&c.request.getmap.href;var h=c.layers;var g=c.exception?c.exception.formats:[];var p=this.serviceExceptionFormat(g);var o=[];if(f&&h){var l=this.recordType.prototype.fields;var t,b,d,s,a,k;for(var n=0,r=h.length;n<r;n++){t=h[n];if(t.name){b={};for(var m=0,q=l.length;m<q;m++){a=l.items[m];k=t[a.mapping||a.name]||a.defaultValue;k=a.convert(k);b[a.name]=k}d={attribution:t.attribution?this.attributionMarkup(t.attribution):undefined,minScale:t.minScale,maxScale:t.maxScale};if(this.meta.layerOptions){Ext.apply(d,this.meta.layerOptions)}s={layers:t.name,exceptions:p,format:this.imageFormat(t),transparent:this.imageTransparent(t),version:e};if(this.meta.layerParams){Ext.apply(s,this.meta.layerParams)}b.layer=new OpenLayers.Layer.WMS(t.title||t.name,f,s,d);o.push(new this.recordType(b,b.layer.id))
}}}return{totalRecords:o.length,success:true,records:o}},attributionMarkup:function(a){var b=[];if(a.logo){b.push("<img class='"+this.attributionCls+"-image' src='"+a.logo.href+"' />")}if(a.title){b.push("<span class='"+this.attributionCls+"-title'>"+a.title+"</span>")}if(a.href){for(var c=0;c<b.length;c++){b[c]="<a class='"+this.attributionCls+"-link' href="+a.href+">"+b[c]+"</a>"}}return b.join(" ")}});Ext.namespace("GeoExt.data");GeoExt.data.LayerStoreMixin=function(){return{map:null,reader:null,constructor:function(b){b=b||{};b.reader=b.reader||new GeoExt.data.LayerReader({},b.fields);delete b.fields;var c=b.map instanceof GeoExt.MapPanel?b.map.map:b.map;delete b.map;if(b.layers){b.data=b.layers}delete b.layers;var a={initDir:b.initDir};delete b.initDir;arguments.callee.superclass.constructor.call(this,b);if(c){this.bind(c,a)}},bind:function(d,a){if(this.map){return}this.map=d;a=a||{};var b=a.initDir;if(a.initDir==undefined){b=GeoExt.data.LayerStore.MAP_TO_STORE|GeoExt.data.LayerStore.STORE_TO_MAP}var c=d.layers.slice(0);if(b&GeoExt.data.LayerStore.STORE_TO_MAP){this.each(function(e){this.map.addLayer(e.getLayer())},this)}if(b&GeoExt.data.LayerStore.MAP_TO_STORE){this.loadData(c,true)}d.events.on({changelayer:this.onChangeLayer,addlayer:this.onAddLayer,removelayer:this.onRemoveLayer,scope:this});this.on({load:this.onLoad,clear:this.onClear,add:this.onAdd,remove:this.onRemove,update:this.onUpdate,scope:this});this.data.on({replace:this.onReplace,scope:this})},unbind:function(){if(this.map){this.map.events.un({changelayer:this.onChangeLayer,addlayer:this.onAddLayer,removelayer:this.onRemoveLayer,scope:this});this.un("load",this.onLoad,this);this.un("clear",this.onClear,this);this.un("add",this.onAdd,this);this.un("remove",this.onRemove,this);this.data.un("replace",this.onReplace,this);this.map=null}},onChangeLayer:function(b){var e=b.layer;var c=this.findBy(function(f,g){return f.getLayer()===e});if(c>-1){var a=this.getAt(c);if(b.property==="order"){if(!this._adding&&!this._removing){var d=this.map.getLayerIndex(e);if(d!==c){this._removing=true;this.remove(a);delete this._removing;this._adding=true;this.insert(d,[a]);delete this._adding}}}else{if(b.property==="name"){a.set("title",e.name)}else{this.fireEvent("update",this,a,Ext.data.Record.EDIT)}}}},onAddLayer:function(a){if(!this._adding){var b=a.layer;this._adding=true;this.loadData([b],true);delete this._adding}},onRemoveLayer:function(a){if(this.map.unloadDestroy){if(!this._removing){var b=a.layer;this._removing=true;this.remove(this.getById(b.id));delete this._removing}}else{this.unbind()}},onLoad:function(c,b,e){if(!Ext.isArray(b)){b=[b]}if(e&&!e.add){this._removing=true;for(var f=this.map.layers.length-1;f>=0;f--){this.map.removeLayer(this.map.layers[f])}delete this._removing;var a=b.length;if(a>0){var g=new Array(a);for(var d=0;d<a;d++){g[d]=b[d].getLayer()}this._adding=true;this.map.addLayers(g);delete this._adding}}},onClear:function(a){this._removing=true;for(var b=this.map.layers.length-1;b>=0;b--){this.map.removeLayer(this.map.layers[b])}delete this._removing},onAdd:function(b,a,c){if(!this._adding){this._adding=true;var e;for(var d=a.length-1;d>=0;--d){e=a[d].getLayer();this.map.addLayer(e);if(c!==this.map.layers.length-1){this.map.setLayerIndex(e,c)}}delete this._adding}},onRemove:function(b,a,c){if(!this._removing){var d=a.getLayer();if(this.map.getLayer(d.id)!=null){this._removing=true;this.removeMapLayer(a);delete this._removing}}},onUpdate:function(c,a,b){if(b===Ext.data.Record.EDIT){if(a.modified&&a.modified.title){var d=a.getLayer();var e=a.get("title");if(e!==d.name){d.setName(e)}}}},removeMapLayer:function(a){this.map.removeLayer(a.getLayer())},onReplace:function(c,a,b){this.removeMapLayer(a)},getByLayer:function(b){var a=this.findBy(function(c){return c.getLayer()===b});if(a>-1){return this.getAt(a)}},destroy:function(){this.unbind();GeoExt.data.LayerStore.superclass.destroy.call(this)}}};GeoExt.data.LayerStore=Ext.extend(Ext.data.Store,new GeoExt.data.LayerStoreMixin);
GeoExt.data.LayerStore.MAP_TO_STORE=1;GeoExt.data.LayerStore.STORE_TO_MAP=2;Ext.namespace("GeoExt.tree");GeoExt.tree.LayerLoader=function(a){Ext.apply(this,a);this.addEvents("beforeload","load");GeoExt.tree.LayerLoader.superclass.constructor.call(this)};Ext.extend(GeoExt.tree.LayerLoader,Ext.util.Observable,{store:null,filter:function(a){return a.getLayer().displayInLayerSwitcher==true},baseAttrs:null,uiProviders:null,load:function(a,b){if(this.fireEvent("beforeload",this,a)){this.removeStoreHandlers();while(a.firstChild){a.removeChild(a.firstChild)}if(!this.uiProviders){this.uiProviders=a.getOwnerTree().getLoader().uiProviders}if(!this.store){this.store=GeoExt.MapPanel.guess().layers}this.store.each(function(c){this.addLayerNode(a,c)},this);this.addStoreHandlers(a);if(typeof b=="function"){b()}this.fireEvent("load",this,a)}},onStoreAdd:function(b,a,c,e){if(!this._reordering){var f=e.recordIndexToNodeIndex(c+a.length-1);for(var d=0;d<a.length;++d){this.addLayerNode(e,a[d],f)}}},onStoreRemove:function(b,a,c,d){if(!this._reordering){this.removeLayerNode(d,a)}},addLayerNode:function(d,a,b){b=b||0;if(this.filter(a)===true){var e=this.createNode({nodeType:"gx_layer",layer:a.getLayer(),layerStore:this.store});var c=d.item(b);if(c){d.insertBefore(e,c)}else{d.appendChild(e)}e.on("move",this.onChildMove,this)}},removeLayerNode:function(b,a){if(this.filter(a)===true){var c=b.findChildBy(function(d){return d.layer==a.getLayer()});if(c){c.un("move",this.onChildMove,this);c.remove();b.reload()}}},onChildMove:function(j,b,h,i,f){this._reordering=true;var e=this.store.getByLayer(b.layer);if(i instanceof GeoExt.tree.LayerContainer&&this.store===i.loader.store){i.loader._reordering=true;this.store.remove(e);var a;if(i.childNodes.length>1){var g=(f===0)?f+1:f-1;a=this.store.findBy(function(k){return i.childNodes[g].layer===k.getLayer()});f===0&&a++}else{if(h.parentNode===i.parentNode){var c=i;do{c=c.previousSibling}while(c&&!(c instanceof GeoExt.tree.LayerContainer&&c.lastChild));if(c){a=this.store.findBy(function(k){return c.lastChild.layer===k.getLayer()})}else{var d=i;do{d=d.nextSibling}while(d&&!(d instanceof GeoExt.tree.LayerContainer&&d.firstChild));if(d){a=this.store.findBy(function(k){return d.firstChild.layer===k.getLayer()})}a++}}}if(a!==undefined){this.store.insert(a,[e]);window.setTimeout(function(){i.reload();h.reload()})}else{this.store.insert(oldRecordIndex,[e])}delete i.loader._reordering}delete this._reordering},addStoreHandlers:function(b){if(!this._storeHandlers){this._storeHandlers={add:this.onStoreAdd.createDelegate(this,[b],true),remove:this.onStoreRemove.createDelegate(this,[b],true)};for(var a in this._storeHandlers){this.store.on(a,this._storeHandlers[a],this)}}},removeStoreHandlers:function(){if(this._storeHandlers){for(var a in this._storeHandlers){this.store.un(a,this._storeHandlers[a],this)}delete this._storeHandlers}},createNode:function(attr){if(this.baseAttrs){Ext.apply(attr,this.baseAttrs)}if(typeof attr.uiProvider=="string"){attr.uiProvider=this.uiProviders[attr.uiProvider]||eval(attr.uiProvider)}attr.nodeType=attr.nodeType||"gx_layer";return new Ext.tree.TreePanel.nodeTypes[attr.nodeType](attr)},destroy:function(){this.removeStoreHandlers()}});Ext.namespace("GeoExt.plugins");GeoExt.plugins.PrintProviderField=Ext.extend(Ext.util.Observable,{target:null,constructor:function(a){this.initialConfig=a;Ext.apply(this,a);GeoExt.plugins.PrintProviderField.superclass.constructor.apply(this,arguments)},init:function(b){this.target=b;var a={scope:this,render:this.onRender,beforedestroy:this.onBeforeDestroy};a[b instanceof Ext.form.ComboBox?"select":"valid"]=this.onFieldChange;b.on(a)},onRender:function(a){var b=this.printProvider||a.ownerCt.printProvider;if(a.store===b.layouts){a.setValue(b.layout.get(a.displayField));b.on({layoutchange:this.onProviderChange,scope:this})}else{if(a.store===b.dpis){a.setValue(b.dpi.get(a.displayField));b.on({dpichange:this.onProviderChange,scope:this})}else{if(a.initialConfig.value===undefined){a.setValue(b.customParams[a.name])
}}}},onFieldChange:function(c,a){var d=this.printProvider||c.ownerCt.printProvider;var b=c.getValue();this._updating=true;if(a){switch(c.store){case d.layouts:d.setLayout(a);break;case d.dpis:d.setDpi(a)}}else{d.customParams[c.name]=b}delete this._updating},onProviderChange:function(b,a){if(!this._updating){this.target.setValue(a.get(this.target.displayField))}},onBeforeDestroy:function(){this.target.un("beforedestroy",this.onBeforeDestroy,this);this.target.un("render",this.onRender,this);this.target.un("select",this.onFieldChange,this);this.target.un("valid",this.onFieldChange,this);this.printProvider.un("layoutchange",this.onProviderChange,this);this.printProvider.un("dpichange",this.onProviderChange,this)}});Ext.preg("gx_printproviderfield",GeoExt.plugins.PrintProviderField);Ext.namespace("GeoExt","GeoExt.data");GeoExt.data.LayerReader=function(a,b){a=a||{};if(!(b instanceof Function)){b=GeoExt.data.LayerRecord.create(b||a.fields||{})}GeoExt.data.LayerReader.superclass.constructor.call(this,a,b)};Ext.extend(GeoExt.data.LayerReader,Ext.data.DataReader,{totalRecords:null,readRecords:function(f){var a=[];if(f){var c=this.recordType,k=c.prototype.fields;var g,d,e,b,h,n,l,m;for(g=0,d=f.length;g<d;g++){h=f[g];n={};for(e=0,b=k.length;e<b;e++){l=k.items[e];m=h[l.mapping||l.name]||l.defaultValue;m=l.convert(m);n[l.name]=m}n.layer=h;a[a.length]=new c(n,h.id)}}return{records:a,totalRecords:this.totalRecords!=null?this.totalRecords:a.length}}});Ext.namespace("GeoExt.data");GeoExt.data.WMSDescribeLayerStore=function(a){a=a||{};GeoExt.data.WMSDescribeLayerStore.superclass.constructor.call(this,Ext.apply(a,{proxy:a.proxy||(!a.data?new Ext.data.HttpProxy({url:a.url,disableCaching:false,method:"GET"}):undefined),reader:new GeoExt.data.WMSDescribeLayerReader(a,a.fields)}))};Ext.extend(GeoExt.data.WMSDescribeLayerStore,Ext.data.Store);Ext.namespace("GeoExt.form");GeoExt.form.BasicForm=Ext.extend(Ext.form.BasicForm,{protocol:null,prevResponse:null,autoAbort:true,doAction:function(b,a){if(b=="search"){a=Ext.applyIf(a||{},{protocol:this.protocol,abortPrevious:this.autoAbort});b=new GeoExt.form.SearchAction(this,a)}return GeoExt.form.BasicForm.superclass.doAction.call(this,b,a)},search:function(a){return this.doAction("search",a)}});Ext.namespace("GeoExt.tree");GeoExt.tree.LayerParamLoader=function(a){Ext.apply(this,a);this.addEvents("beforeload","load");GeoExt.tree.LayerParamLoader.superclass.constructor.call(this)};Ext.extend(GeoExt.tree.LayerParamLoader,Ext.util.Observable,{param:null,delimiter:",",load:function(b,d){if(this.fireEvent("beforeload",this,b)){while(b.firstChild){b.removeChild(b.firstChild)}var c=(b.layer instanceof OpenLayers.Layer.HTTPRequest)&&b.layer.params[this.param];if(c){var a=(c instanceof Array)?c.slice():c.split(this.delimiter);Ext.each(a,function(g,e,f){this.addParamNode(g,f,b)},this)}if(typeof d=="function"){d()}this.fireEvent("load",this,b)}},addParamNode:function(a,b,d){var e=this.createNode({layer:d.layer,param:this.param,item:a,allItems:b,delimiter:this.delimiter});var c=d.item(0);if(c){d.insertBefore(e,c)}else{d.appendChild(e)}},createNode:function(attr){if(this.baseAttrs){Ext.apply(attr,this.baseAttrs)}if(typeof attr.uiProvider=="string"){attr.uiProvider=this.uiProviders[attr.uiProvider]||eval(attr.uiProvider)}attr.nodeType=attr.nodeType||"gx_layerparam";return new Ext.tree.TreePanel.nodeTypes[attr.nodeType](attr)}});Ext.namespace("GeoExt.grid");GeoExt.grid.FeatureSelectionModelMixin=function(){return{autoActivateControl:true,layerFromStore:true,selectControl:null,bound:false,superclass:null,constructor:function(a){a=a||{};if(a.selectControl instanceof OpenLayers.Control.SelectFeature){if(!a.singleSelect){var b=a.selectControl;a.singleSelect=!(b.multiple||!!b.multipleKey)}}else{if(a.layer instanceof OpenLayers.Layer.Vector){this.selectControl=this.createSelectControl(a.layer,a.selectControl);delete a.layer;delete a.selectControl}}this.superclass=arguments.callee.superclass;this.superclass.constructor.call(this,a)
},initEvents:function(){this.superclass.initEvents.call(this);if(this.layerFromStore){var a=this.grid.getStore()&&this.grid.getStore().layer;if(a&&!(this.selectControl instanceof OpenLayers.Control.SelectFeature)){this.selectControl=this.createSelectControl(a,this.selectControl)}}if(this.selectControl){this.bind(this.selectControl)}},createSelectControl:function(b,a){a=a||{};var d=a.singleSelect!==undefined?a.singleSelect:this.singleSelect;a=OpenLayers.Util.extend({toggle:true,multipleKey:d?null:(Ext.isMac?"metaKey":"ctrlKey")},a);var c=new OpenLayers.Control.SelectFeature(b,a);b.map.addControl(c);return c},bind:function(e,b){if(!this.bound){b=b||{};this.selectControl=e;if(e instanceof OpenLayers.Layer.Vector){this.selectControl=this.createSelectControl(e,b.controlConfig)}if(this.autoActivateControl){this.selectControl.activate()}var d=this.getLayers();for(var c=0,a=d.length;c<a;c++){d[c].events.on({featureselected:this.featureSelected,featureunselected:this.featureUnselected,scope:this})}this.on("rowselect",this.rowSelected,this);this.on("rowdeselect",this.rowDeselected,this);this.bound=true}return this.selectControl},unbind:function(){var c=this.selectControl;if(this.bound){var d=this.getLayers();for(var b=0,a=d.length;b<a;b++){d[b].events.un({featureselected:this.featureSelected,featureunselected:this.featureUnselected,scope:this})}this.un("rowselect",this.rowSelected,this);this.un("rowdeselect",this.rowDeselected,this);if(this.autoActivateControl){c.deactivate()}this.selectControl=null;this.bound=false}return c},featureSelected:function(a){if(!this._selecting){var b=this.grid.store;var c=b.findBy(function(d,e){return d.getFeature()==a.feature});if(c!=-1&&!this.isSelected(c)){this._selecting=true;this.selectRow(c,!this.singleSelect);this._selecting=false;this.grid.getView().focusRow(c)}}},featureUnselected:function(a){if(!this._selecting){var b=this.grid.store;var c=b.findBy(function(d,e){return d.getFeature()==a.feature});if(c!=-1&&this.isSelected(c)){this._selecting=true;this.deselectRow(c);this._selecting=false;this.grid.getView().focusRow(c)}}},rowSelected:function(c,g,b){var e=b.getFeature();if(!this._selecting&&e){var f=this.getLayers();for(var d=0,a=f.length;d<a;d++){if(f[d].selectedFeatures.indexOf(e)==-1){this._selecting=true;this.selectControl.select(e);this._selecting=false;break}}}},rowDeselected:function(c,g,b){var e=b.getFeature();if(!this._selecting&&e){var f=this.getLayers();for(var d=0,a=f.length;d<a;d++){if(f[d].selectedFeatures.indexOf(e)!=-1){this._selecting=true;this.selectControl.unselect(e);this._selecting=false;break}}}},getLayers:function(){return this.selectControl.layers||[this.selectControl.layer]}}};GeoExt.grid.FeatureSelectionModel=Ext.extend(Ext.grid.RowSelectionModel,new GeoExt.grid.FeatureSelectionModelMixin);Ext.namespace("GeoExt","GeoExt.data");GeoExt.data.FeatureReader=function(a,b){a=a||{};if(!(b instanceof Function)){b=GeoExt.data.FeatureRecord.create(b||a.fields||{})}GeoExt.data.FeatureReader.superclass.constructor.call(this,a,b)};Ext.extend(GeoExt.data.FeatureReader,Ext.data.DataReader,{totalRecords:null,read:function(a){return this.readRecords(a.features)},readRecords:function(b){var c=[];if(b){var f=this.recordType,l=f.prototype.fields;var k,g,h,d,q,p,n,o;for(k=0,g=b.length;k<g;k++){q=b[k];p={};if(q.attributes){for(h=0,d=l.length;h<d;h++){n=l.items[h];if(/[\[\.]/.test(n.mapping)){try{o=new Function("obj","return obj."+n.mapping)(q.attributes)}catch(m){o=n.defaultValue}}else{o=q.attributes[n.mapping||n.name]||n.defaultValue}if(n.convert){o=n.convert(o)}p[n.name]=o}}p.feature=q;p.state=q.state;p.fid=q.fid;var a=(q.state===OpenLayers.State.INSERT)?undefined:q.id;c[c.length]=new f(p,a)}}return{records:c,totalRecords:this.totalRecords!=null?this.totalRecords:c.length}}});Ext.namespace("GeoExt");GeoExt.WMSLegend=Ext.extend(GeoExt.LayerLegend,{defaultStyleIsFirst:true,useScaleParameter:true,baseParams:null,initComponent:function(){GeoExt.WMSLegend.superclass.initComponent.call(this);var a=this.layerRecord.getLayer();
this._noMap=!a.map;a.events.register("moveend",this,this.onLayerMoveend);this.update()},onLayerMoveend:function(a){if((a.zoomChanged===true&&this.useScaleParameter===true)||this._noMap){delete this._noMap;this.update()}},getLegendUrl:function(g,h){var e=this.layerRecord;var a;var k=e&&e.get("styles");var f=e.getLayer();h=h||[f.params.LAYERS].join(",").split(",");var j=f.params.STYLES&&[f.params.STYLES].join(",").split(",");var i=h.indexOf(g);var b=j&&j[i];if(k&&k.length>0){if(b){Ext.each(k,function(l){a=(l.name==b&&l.legend)&&l.legend.href;return !a})}else{if(this.defaultStyleIsFirst===true&&!j&&!f.params.SLD&&!f.params.SLD_BODY){a=k[0].legend&&k[0].legend.href}}}if(!a){a=f.getFullRequestString({REQUEST:"GetLegendGraphic",WIDTH:null,HEIGHT:null,EXCEPTIONS:"application/vnd.ogc.se_xml",LAYER:g,LAYERS:null,STYLE:(b!=="")?b:null,STYLES:null,SRS:null,FORMAT:null})}if(this.useScaleParameter===true&&a.toLowerCase().indexOf("request=getlegendgraphic")!=-1){var c=f.map.getScale();a=Ext.urlAppend(a,"SCALE="+c)}var d=this.baseParams||{};Ext.applyIf(d,{FORMAT:"image/gif"});if(a.indexOf("?")>0){a=Ext.urlEncode(d,a)}return a},update:function(){var d=this.layerRecord.getLayer();if(!(d&&d.map)){return}GeoExt.WMSLegend.superclass.update.apply(this,arguments);var h,b,c,a;h=[d.params.LAYERS].join(",").split(",");var e=[];var g=this.items.get(0);this.items.each(function(i){c=h.indexOf(i.itemId);if(c<0&&i!=g){e.push(i)}else{if(i!==g){b=h[c];var j=this.getLegendUrl(b,h);if(!OpenLayers.Util.isEquivalentUrl(j,i.url)){i.setUrl(j)}}}},this);for(c=0,a=e.length;c<a;c++){var f=e[c];this.remove(f);f.destroy()}for(c=0,a=h.length;c<a;c++){b=h[c];if(!this.items||!this.getComponent(b)){this.add({xtype:"gx_legendimage",url:this.getLegendUrl(b,h),itemId:b})}}this.doLayout()},beforeDestroy:function(){if(this.useScaleParameter===true){var a=this.layerRecord.getLayer();a&&a.events&&a.events.unregister("moveend",this,this.onLayerMoveend)}GeoExt.WMSLegend.superclass.beforeDestroy.apply(this,arguments)}});GeoExt.WMSLegend.supports=function(a){return a.getLayer() instanceof OpenLayers.Layer.WMS};GeoExt.LayerLegend.types.gx_wmslegend=GeoExt.WMSLegend;Ext.reg("gx_wmslegend",GeoExt.WMSLegend);Ext.namespace("GeoExt.data");GeoExt.data.WMSDescribeLayerReader=function(a,b){a=a||{};if(!a.format){a.format=new OpenLayers.Format.WMSDescribeLayer()}if(!(typeof b==="function")){b=Ext.data.Record.create(b||a.fields||[{name:"owsType",type:"string"},{name:"owsURL",type:"string"},{name:"typeName",type:"string"}])}GeoExt.data.WMSDescribeLayerReader.superclass.constructor.call(this,a,b)};Ext.extend(GeoExt.data.WMSDescribeLayerReader,Ext.data.DataReader,{read:function(a){var b=a.responseXML;if(!b||!b.documentElement){b=a.responseText}return this.readRecords(b)},readRecords:function(e){if(typeof e==="string"||e.nodeType){e=this.meta.format.read(e)}var b=[],d;for(var c=0,a=e.length;c<a;c++){d=e[c];if(d){b.push(new this.recordType(d))}}return{totalRecords:b.length,success:true,records:b}}});Ext.namespace("GeoExt.form");GeoExt.form.SearchAction=Ext.extend(Ext.form.Action,{type:"search",response:null,constructor:function(b,a){GeoExt.form.SearchAction.superclass.constructor.call(this,b,a)},run:function(){var b=this.options;var a=GeoExt.form.toFilter(this.form,b.logicalOp,b.wildcard);if(b.clientValidation===false||this.form.isValid()){if(b.abortPrevious&&this.form.prevResponse){b.protocol.abort(this.form.prevResponse)}this.form.prevResponse=b.protocol.read(Ext.applyIf({filter:a,callback:this.handleResponse,scope:this},b))}else{if(b.clientValidation!==false){this.failureType=Ext.form.Action.CLIENT_INVALID;this.form.afterAction(this,false)}}},handleResponse:function(a){this.form.prevResponse=null;this.response=a;if(a.success()){this.form.afterAction(this,true)}else{this.form.afterAction(this,false)}var b=this.options;if(b.callback){b.callback.call(b.scope,a)}}});Ext.namespace("GeoExt.data");GeoExt.data.FeatureRecord=Ext.data.Record.create([{name:"feature"},{name:"state"},{name:"fid"}]);GeoExt.data.FeatureRecord.prototype.getFeature=function(){return this.get("feature")
};GeoExt.data.FeatureRecord.prototype.setFeature=function(a){if(a!==this.data.feature){this.dirty=true;if(!this.modified){this.modified={}}if(this.modified.feature===undefined){this.modified.feature=this.data.feature}this.data.feature=a;if(!this.editing){this.afterEdit()}}};GeoExt.data.FeatureRecord.create=function(e){var c=Ext.extend(GeoExt.data.FeatureRecord,{});var d=c.prototype;d.fields=new Ext.util.MixedCollection(false,function(f){return f.name});GeoExt.data.FeatureRecord.prototype.fields.each(function(g){d.fields.add(g)});if(e){for(var b=0,a=e.length;b<a;b++){d.fields.add(new Ext.data.Field(e[b]))}}c.getField=function(f){return d.fields.get(f)};return c};Ext.namespace("GeoExt.data");GeoExt.data.PrintPage=Ext.extend(Ext.util.Observable,{printProvider:null,feature:null,center:null,scale:null,rotation:0,customParams:null,constructor:function(a){this.initialConfig=a;Ext.apply(this,a);if(!this.customParams){this.customParams={}}this.addEvents("change");GeoExt.data.PrintPage.superclass.constructor.apply(this,arguments);this.feature=new OpenLayers.Feature.Vector(OpenLayers.Geometry.fromWKT("POLYGON((-1 -1,1 -1,1 1,-1 1,-1 -1))"));if(this.printProvider.capabilities){this.setScale(this.printProvider.scales.getAt(0))}else{this.printProvider.on({loadcapabilities:function(){this.setScale(this.printProvider.scales.getAt(0))},scope:this,single:true})}this.printProvider.on({layoutchange:this.onLayoutChange,scope:this})},getPrintExtent:function(a){a=a instanceof GeoExt.MapPanel?a.map:a;return this.calculatePageBounds(this.scale,a.getUnits())},setScale:function(e,a){var d=this.calculatePageBounds(e,a);var c=d.toGeometry();var b=this.rotation;if(b!=0){c.rotate(-b,c.getCentroid())}this.updateFeature(c,{scale:e})},setCenter:function(a){var d=this.feature.geometry;var e=d.getBounds().getCenterLonLat();var c=a.lon-e.lon;var b=a.lat-e.lat;d.move(c,b);this.updateFeature(d,{center:a})},setRotation:function(b,c){if(c||this.printProvider.layout.get("rotation")===true){var a=this.feature.geometry;a.rotate(this.rotation-b,a.getCentroid());this.updateFeature(a,{rotation:b})}},fit:function(h,j){j=j||{};var b=h,i;if(h instanceof GeoExt.MapPanel){b=h.map}else{if(h instanceof OpenLayers.Feature.Vector){b=h.layer.map;i=h.geometry.getBounds()}}if(!i){i=b.getExtent();if(!i){return}}this._updating=true;var a=i.getCenterLonLat();this.setCenter(a);var g=b.getUnits();var d=this.printProvider.scales.getAt(0);var c=Number.POSITIVE_INFINITY;var e=i.getWidth();var f=i.getHeight();this.printProvider.scales.each(function(n){var l=this.calculatePageBounds(n,g);if(j.mode=="closest"){var m=Math.abs(l.getWidth()-e)+Math.abs(l.getHeight()-f);if(m<c){c=m;d=n}}else{var k=j.mode=="screen"?!i.containsBounds(l):l.containsBounds(i);if(k||(j.mode=="screen"&&!k)){d=n}return k}},this);this.setScale(d,g);delete this._updating;this.updateFeature(this.feature.geometry,{center:a,scale:d})},updateFeature:function(e,b){var d=this.feature;var a=d.geometry!==e;e.id=d.geometry.id;d.geometry=e;if(!this._updating){for(var c in b){if(b[c]===this[c]){delete b[c]}else{this[c]=b[c];a=true}}Ext.apply(this,b);d.layer&&d.layer.drawFeature(d);a&&this.fireEvent("change",this,b)}},calculatePageBounds:function(b,g){var k=b.get("value");var e=this.feature;var i=this.feature.geometry;var a=i.getBounds().getCenterLonLat();var l=this.printProvider.layout.get("size");var g=g||(e.layer&&e.layer.map&&e.layer.map.getUnits())||"dd";var d=OpenLayers.INCHES_PER_UNIT[g];var j=l.width/72/d*k/2;var c=l.height/72/d*k/2;return new OpenLayers.Bounds(a.lon-j,a.lat-c,a.lon+j,a.lat+c)},onLayoutChange:function(){if(this.printProvider.layout.get("rotation")===false){this.setRotation(0,true)}this.scale&&this.setScale(this.scale)},destroy:function(){this.printProvider.un("layoutchange",this.onLayoutChange,this)}});Ext.namespace("GeoExt.data");GeoExt.data.LayerRecord=Ext.data.Record.create([{name:"layer"},{name:"title",type:"string",mapping:"name"}]);GeoExt.data.LayerRecord.prototype.getLayer=function(){return this.get("layer")
};GeoExt.data.LayerRecord.prototype.setLayer=function(a){if(a!==this.data.layer){this.dirty=true;if(!this.modified){this.modified={}}if(this.modified.layer===undefined){this.modified.layer=this.data.layer}this.data.layer=a;if(!this.editing){this.afterEdit()}}};GeoExt.data.LayerRecord.prototype.clone=function(b){var a=this.getLayer()&&this.getLayer().clone();return new this.constructor(Ext.applyIf({layer:a},this.data),b||a.id)};GeoExt.data.LayerRecord.create=function(e){var c=Ext.extend(GeoExt.data.LayerRecord,{});var d=c.prototype;d.fields=new Ext.util.MixedCollection(false,function(f){return f.name});GeoExt.data.LayerRecord.prototype.fields.each(function(g){d.fields.add(g)});if(e){for(var b=0,a=e.length;b<a;b++){d.fields.add(new Ext.data.Field(e[b]))}}c.getField=function(f){return d.fields.get(f)};return c};Ext.namespace("GeoExt");GeoExt.FeatureRenderer=Ext.extend(Ext.BoxComponent,{feature:undefined,symbolizers:[OpenLayers.Feature.Vector.style["default"]],symbolType:"Polygon",resolution:1,minWidth:20,minHeight:20,renderers:["SVG","VML","Canvas"],rendererOptions:null,pointFeature:undefined,lineFeature:undefined,polygonFeature:undefined,renderer:null,initComponent:function(){GeoExt.FeatureRenderer.superclass.initComponent.apply(this,arguments);Ext.applyIf(this,{pointFeature:new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(0,0)),lineFeature:new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([new OpenLayers.Geometry.Point(-8,-3),new OpenLayers.Geometry.Point(-3,3),new OpenLayers.Geometry.Point(3,-3),new OpenLayers.Geometry.Point(8,3)])),polygonFeature:new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(-8,-4),new OpenLayers.Geometry.Point(-6,-6),new OpenLayers.Geometry.Point(6,-6),new OpenLayers.Geometry.Point(8,-4),new OpenLayers.Geometry.Point(8,4),new OpenLayers.Geometry.Point(6,6),new OpenLayers.Geometry.Point(-6,6),new OpenLayers.Geometry.Point(-8,4)])]))});if(!this.feature){this.setFeature(null,{draw:false})}this.addEvents("click")},initCustomEvents:function(){this.clearCustomEvents();this.el.on("click",this.onClick,this)},clearCustomEvents:function(){if(this.el&&this.el.removeAllListeners){this.el.removeAllListeners()}},onClick:function(){this.fireEvent("click",this)},onRender:function(b,a){if(!this.el){this.el=document.createElement("div");this.el.id=this.getId()}if(!this.renderer||!this.renderer.supported()){this.assignRenderer()}this.renderer.map={getResolution:(function(){return this.resolution}).createDelegate(this)};GeoExt.FeatureRenderer.superclass.onRender.apply(this,arguments);this.drawFeature()},afterRender:function(){GeoExt.FeatureRenderer.superclass.afterRender.apply(this,arguments);this.initCustomEvents()},onResize:function(a,b){this.setRendererDimensions();GeoExt.FeatureRenderer.superclass.onResize.apply(this,arguments)},setRendererDimensions:function(){var h=this.feature.geometry.getBounds();var j=h.getWidth();var g=h.getHeight();var e=this.initialConfig.resolution;if(!e){e=Math.max(j/this.width||0,g/this.height||0)||1}this.resolution=e;var c=Math.max(this.width||this.minWidth,j/e);var i=Math.max(this.height||this.minHeight,g/e);var b=h.getCenterPixel();var f=c*e/2;var d=i*e/2;var a=new OpenLayers.Bounds(b.x-f,b.y-d,b.x+f,b.y+d);this.renderer.setSize(new OpenLayers.Size(Math.round(c),Math.round(i)));this.renderer.setExtent(a,true)},assignRenderer:function(){for(var b=0,a=this.renderers.length;b<a;++b){var c=OpenLayers.Renderer[this.renderers[b]];if(c&&c.prototype.supported()){this.renderer=new c(this.el,this.rendererOptions);break}}},setSymbolizers:function(b,a){this.symbolizers=b;if(!a||a.draw){this.drawFeature()}},setSymbolType:function(b,a){this.symbolType=b;this.setFeature(null,a)},setFeature:function(b,a){this.feature=b||this[this.symbolType.toLowerCase()+"Feature"];if(!a||a.draw){this.drawFeature()}},drawFeature:function(){this.renderer.clear();this.setRendererDimensions();var c=OpenLayers.Symbolizer;var g=c&&c.Text;
var f,e,b;for(var d=0,a=this.symbolizers.length;d<a;++d){f=this.symbolizers[d];e=this.feature;if(!g||!(f instanceof g)){if(c&&(f instanceof c)){f=f.clone();if(!this.initialConfig.feature){b=f.CLASS_NAME.split(".").pop().toLowerCase();e=this[b+"Feature"]}}else{f=Ext.apply({},f)}this.renderer.drawFeature(e.clone(),f)}}},update:function(a){a=a||{};if(a.feature){this.setFeature(a.feature,{draw:false})}else{if(a.symbolType){this.setSymbolType(a.symbolType,{draw:false})}}if(a.symbolizers){this.setSymbolizers(a.symbolizers,{draw:false})}this.drawFeature()},beforeDestroy:function(){this.clearCustomEvents();if(this.renderer){this.renderer.destroy()}}});Ext.reg("gx_renderer",GeoExt.FeatureRenderer);Ext.namespace("GeoExt");GeoExt.Popup=Ext.extend(Ext.Window,{anchored:true,map:null,panIn:true,unpinnable:true,location:null,animCollapse:false,draggable:false,shadow:false,popupCls:"gx-popup",ancCls:null,initComponent:function(){if(this.map instanceof GeoExt.MapPanel){this.map=this.map.map}if(!this.map&&this.location instanceof OpenLayers.Feature.Vector&&this.location.layer){this.map=this.location.layer.map}if(this.location instanceof OpenLayers.Feature.Vector){this.location=this.location.geometry}if(this.location instanceof OpenLayers.Geometry){if(typeof this.location.getCentroid=="function"){this.location=this.location.getCentroid()}this.location=this.location.getBounds().getCenterLonLat()}else{if(this.location instanceof OpenLayers.Pixel){this.location=this.map.getLonLatFromViewPortPx(this.location)}}if(this.anchored){this.addAnchorEvents()}this.baseCls=this.popupCls+" "+this.baseCls;this.elements+=",anc";GeoExt.Popup.superclass.initComponent.call(this)},onRender:function(b,a){GeoExt.Popup.superclass.onRender.call(this,b,a);this.ancCls=this.popupCls+"-anc";this.createElement("anc",this.el.dom)},initTools:function(){if(this.unpinnable){this.addTool({id:"unpin",handler:this.unanchorPopup.createDelegate(this,[])})}GeoExt.Popup.superclass.initTools.call(this)},show:function(){GeoExt.Popup.superclass.show.apply(this,arguments);if(this.anchored){this.position();if(this.panIn&&!this._mapMove){this.panIntoView()}}},maximize:function(){if(!this.maximized&&this.anc){this.unanchorPopup()}GeoExt.Popup.superclass.maximize.apply(this,arguments)},setSize:function(a,c){if(this.anc){var b=this.anc.getSize();if(typeof a=="object"){c=a.height-b.height;a=a.width}else{if(!isNaN(c)){c=c-b.height}}}GeoExt.Popup.superclass.setSize.call(this,a,c)},position:function(){if(this._mapMove===true){var f=this.map.getExtent().containsLonLat(this.location);if(f!==this.isVisible()){this.setVisible(f)}}if(this.isVisible()){var c=this.map.getViewPortPxFromLonLat(this.location);var e=Ext.fly(this.map.div).getBox();var d=this.anc;var b=d.getLeft(true)+d.getWidth()/2;var a=this.el.getHeight();this.setPosition(c.x+e.x-b,c.y+e.y-a)}},unanchorPopup:function(){this.removeAnchorEvents();this.draggable=true;this.header.addClass("x-window-draggable");this.dd=new Ext.Window.DD(this);this.anc.remove();this.anc=null;this.tools.unpin.hide()},panIntoView:function(){var h=Ext.fly(this.map.div).getBox();var e=this.getPosition(true);e[0]-=h.x;e[1]-=h.y;var a=[h.width,h.height];var g=this.getSize();var d=[e[0],e[1]];var f=this.map.paddingForPopups;if(e[0]<f.left){d[0]=f.left}else{if(e[0]+g.width>a[0]-f.right){d[0]=a[0]-f.right-g.width}}if(e[1]<f.top){d[1]=f.top}else{if(e[1]+g.height>a[1]-f.bottom){d[1]=a[1]-f.bottom-g.height}}var c=e[0]-d[0];var b=e[1]-d[1];this.map.pan(c,b)},onMapMove:function(){this._mapMove=true;this.position();delete this._mapMove},addAnchorEvents:function(){this.map.events.on({move:this.onMapMove,scope:this});this.on({resize:this.position,collapse:this.position,expand:this.position,scope:this})},removeAnchorEvents:function(){this.map.events.un({move:this.onMapMove,scope:this});this.un("resize",this.position,this);this.un("collapse",this.position,this);this.un("expand",this.position,this)},beforeDestroy:function(){if(this.anchored){this.removeAnchorEvents()}GeoExt.Popup.superclass.beforeDestroy.call(this)
}});Ext.reg("gx_popup",GeoExt.Popup);Ext.namespace("GeoExt.data");GeoExt.data.AttributeStoreMixin=function(){return{constructor:function(a){a=a||{};arguments.callee.superclass.constructor.call(this,Ext.apply(a,{proxy:a.proxy||(!a.data?new Ext.data.HttpProxy({url:a.url,disableCaching:false,method:"GET"}):undefined),reader:new GeoExt.data.AttributeReader(a,a.fields||["name","type","restriction"])}));if(this.feature){this.bind()}},bind:function(){this.on({update:this.onUpdate,load:this.onLoad,add:this.onAdd,scope:this});var a=[];this.each(function(b){a.push(b)});this.updateFeature(a)},onUpdate:function(c,a,b){this.updateFeature([a])},onLoad:function(b,a,c){if(!c||c.add!==true){this.updateFeature(a)}},onAdd:function(b,a,c){this.updateFeature(a)},updateFeature:function(d){var k=this.feature,g=k.layer;var e,h,f,c,j,a,b;for(e=0,h=d.length;e<h;e++){f=d[e];c=f.get("name");j=f.get("value");a=k.attributes[c];if(a!==j){b=true}}if(b&&g&&g.events&&g.events.triggerEvent("beforefeaturemodified",{feature:k})!==false){for(e=0,h=d.length;e<h;e++){f=d[e];c=f.get("name");j=f.get("value");k.attributes[c]=j}g.events.triggerEvent("featuremodified",{feature:k});g.drawFeature(k)}}}};GeoExt.data.AttributeStore=Ext.extend(Ext.data.Store,GeoExt.data.AttributeStoreMixin());Ext.namespace("GeoExt.form");GeoExt.form.FormPanel=Ext.extend(Ext.form.FormPanel,{protocol:null,createForm:function(){delete this.initialConfig.listeners;return new GeoExt.form.BasicForm(null,this.initialConfig)},search:function(a){this.getForm().search(a)}});Ext.reg("gx_formpanel",GeoExt.form.FormPanel);Ext.namespace("GeoExt.data");GeoExt.data.WMCReader=function(a,b){a=a||{};if(!a.format){a.format=new OpenLayers.Format.WMC()}if(!(typeof b==="function")){b=GeoExt.data.LayerRecord.create(b||a.fields||[{name:"abstract",type:"string"},{name:"metadataURL",type:"string"},{name:"queryable",type:"boolean"},{name:"formats"},{name:"styles"}])}GeoExt.data.WMCReader.superclass.constructor.call(this,a,b)};Ext.extend(GeoExt.data.WMCReader,Ext.data.DataReader,{read:function(a){var b=a.responseXML;if(!b||!b.documentElement){b=a.responseText}return this.readRecords(b)},readRecords:function(f){var m=this.meta.format;if(typeof f==="string"||f.nodeType){f=m.read(f)}var p=f?f.layersContext:undefined;var a=[];if(p){var c=this.recordType,h=c.prototype.fields;var g,d,e,b,l,o,k,n;for(g=0,d=p.length;g<d;g++){l=p[g];o={};for(e=0,b=h.length;e<b;e++){k=h.items[e];n=l[k.mapping||k.name]||k.defaultValue;n=k.convert(n);o[k.name]=n}o.layer=m.getLayerFromContext(l);a.push(new this.recordType(o,o.layer.id))}}return{totalRecords:a.length,success:true,records:a}}});Ext.namespace("GeoExt.tree");GeoExt.tree.OverlayLayerContainer=Ext.extend(GeoExt.tree.LayerContainer,{constructor:function(a){a=Ext.applyIf(a||{},{text:"Overlays"});a.loader=Ext.applyIf(a.loader||{},{filter:function(b){var c=b.getLayer();return c.displayInLayerSwitcher===true&&c.isBaseLayer===false}});GeoExt.tree.OverlayLayerContainer.superclass.constructor.call(this,a)}});Ext.tree.TreePanel.nodeTypes.gx_overlaylayercontainer=GeoExt.tree.OverlayLayerContainer;Ext.namespace("GeoExt.data");GeoExt.data.WFSCapabilitiesReader=function(a,b){a=a||{};if(!a.format){a.format=new OpenLayers.Format.WFSCapabilities()}if(!(typeof b==="function")){b=GeoExt.data.LayerRecord.create(b||a.fields||[{name:"name",type:"string"},{name:"title",type:"string"},{name:"namespace",type:"string",mapping:"featureNS"},{name:"abstract",type:"string"}])}GeoExt.data.WFSCapabilitiesReader.superclass.constructor.call(this,a,b)};Ext.extend(GeoExt.data.WFSCapabilitiesReader,Ext.data.DataReader,{read:function(a){var b=a.responseXML;if(!b||!b.documentElement){b=a.responseText}return this.readRecords(b)},readRecords:function(h){if(typeof h==="string"||h.nodeType){h=this.meta.format.read(h)}var a=h.featureTypeList.featureTypes;var m=this.recordType.prototype.fields;var n,q,p,r,f,l,q;var o,s;var k={url:h.capability.request.getfeature.href.post};var b=[];for(var g=0,d=a.length;g<d;g++){n=a[g];if(n.name){q={};
for(var e=0,c=m.length;e<c;e++){p=m.items[e];r=n[p.mapping||p.name]||p.defaultValue;r=p.convert(r);q[p.name]=r}s={featureType:n.name,featureNS:n.featureNS};if(this.meta.protocolOptions){Ext.apply(s,this.meta.protocolOptions,k)}else{Ext.apply(s,{},k)}o={protocol:new OpenLayers.Protocol.WFS(s),strategies:[new OpenLayers.Strategy.Fixed()]};if(this.meta.layerOptions){Ext.apply(o,this.meta.layerOptions)}q.layer=new OpenLayers.Layer.Vector(n.title||n.name,o);b.push(new this.recordType(q,q.layer.id))}}return{totalRecords:b.length,success:true,records:b}}});Ext.namespace("GeoExt");GeoExt.LegendPanel=Ext.extend(Ext.Panel,{dynamic:true,layerStore:null,preferredTypes:null,filter:function(a){return true},initComponent:function(){GeoExt.LegendPanel.superclass.initComponent.call(this)},onRender:function(){GeoExt.LegendPanel.superclass.onRender.apply(this,arguments);if(!this.layerStore){this.layerStore=GeoExt.MapPanel.guess().layers}this.layerStore.each(function(a){this.addLegend(a)},this);if(this.dynamic){this.layerStore.on({add:this.onStoreAdd,remove:this.onStoreRemove,clear:this.onStoreClear,scope:this})}},recordIndexToPanelIndex:function(h){var j=this.layerStore;var g=j.getCount();var c=-1;var a=this.items?this.items.length:0;var d,e;for(var b=g-1;b>=0;--b){d=j.getAt(b);e=d.getLayer();var f=GeoExt.LayerLegend.getTypes(d);if(e.displayInLayerSwitcher&&f.length>0&&(j.getAt(b).get("hideInLegend")!==true)){++c;if(h===b||c>a-1){break}}}return c},getIdForLayer:function(a){return this.id+"-"+a.id},onStoreAdd:function(c,b,d){var f=this.recordIndexToPanelIndex(d+b.length-1);for(var e=0,a=b.length;e<a;e++){this.addLegend(b[e],f)}this.doLayout()},onStoreRemove:function(b,a,c){this.removeLegend(a)},removeLegend:function(a){if(this.items){var b=this.getComponent(this.getIdForLayer(a.getLayer()));if(b){this.remove(b,true);this.doLayout()}}},onStoreClear:function(a){this.removeAllLegends()},removeAllLegends:function(){this.removeAll(true);this.doLayout()},addLegend:function(a,b){if(this.filter(a)===true){var d=a.getLayer();b=b||0;var e;var c=GeoExt.LayerLegend.getTypes(a,this.preferredTypes);if(d.displayInLayerSwitcher&&!a.get("hideInLegend")&&c.length>0){this.insert(b,{xtype:c[0],id:this.getIdForLayer(d),layerRecord:a,hidden:!((!d.map&&d.visibility)||(d.getVisibility()&&d.calculateInRange()))})}}},onDestroy:function(){if(this.layerStore){this.layerStore.un("add",this.onStoreAdd,this);this.layerStore.un("remove",this.onStoreRemove,this);this.layerStore.un("clear",this.onStoreClear,this)}GeoExt.LegendPanel.superclass.onDestroy.apply(this,arguments)}});Ext.reg("gx_legendpanel",GeoExt.LegendPanel);Ext.namespace("GeoExt.form");GeoExt.form.toFilter=function(b,d,e){if(b instanceof Ext.form.FormPanel){b=b.getForm()}var c=[],h=b.getValues(false);for(var a in h){var i=a.split("__");var g=h[a],f;if(i.length>1&&(f=GeoExt.form.toFilter.FILTER_MAP[i[1]])!==undefined){a=i[0]}else{f=OpenLayers.Filter.Comparison.EQUAL_TO}if(f===OpenLayers.Filter.Comparison.LIKE){switch(e){case GeoExt.form.ENDS_WITH:g=".*"+g;break;case GeoExt.form.STARTS_WITH:g+=".*";break;case GeoExt.form.CONTAINS:g=".*"+g+".*";break;default:break}}c.push(new OpenLayers.Filter.Comparison({type:f,value:g,property:a}))}return new OpenLayers.Filter.Logical({type:d||OpenLayers.Filter.Logical.AND,filters:c})};GeoExt.form.toFilter.FILTER_MAP={eq:OpenLayers.Filter.Comparison.EQUAL_TO,ne:OpenLayers.Filter.Comparison.NOT_EQUAL_TO,lt:OpenLayers.Filter.Comparison.LESS_THAN,le:OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO,gt:OpenLayers.Filter.Comparison.GREATER_THAN,ge:OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO,like:OpenLayers.Filter.Comparison.LIKE};GeoExt.form.ENDS_WITH=1;GeoExt.form.STARTS_WITH=2;GeoExt.form.CONTAINS=3;GeoExt.form.recordToField=function(f){var h=f.get("type");if(typeof h==="object"&&h.xtype){return h}var j;var b=f.get("name");var k=f.get("label");var e=f.get("restriction")||{};if(k==null){k=b}h=h.split(":").pop();var a=GeoExt.form.recordToField.REGEXES;if(h.match(a.text)){var c=e.maxLength!==undefined?parseFloat(e.maxLength):undefined;
var d=e.minLength!==undefined?parseFloat(e.minLength):undefined;j={xtype:"textfield",name:b,fieldLabel:k,maxLength:c,minLength:d}}else{if(h.match(a.number)){var g=e.maxInclusive!==undefined?parseFloat(e.maxInclusive):undefined;var i=e.minInclusive!==undefined?parseFloat(e.minInclusive):undefined;j={xtype:"numberfield",name:b,fieldLabel:k,maxValue:g,minValue:i}}else{if(h.match(a["boolean"])){j={xtype:"checkbox",name:b,boxLabel:k}}else{if(h.match(a.date)){j={xtype:"datefield",fieldLabel:k,name:b}}}}}return j};GeoExt.form.recordToField.REGEXES={text:new RegExp("^(text|string)$","i"),number:new RegExp("^(number|float|decimal|double|int|long|integer|short)$","i"),"boolean":new RegExp("^(boolean)$","i"),date:new RegExp("^(dateTime)$","i")};Ext.namespace("GeoExt.plugins");GeoExt.plugins.PrintPageField=Ext.extend(Ext.util.Observable,{printPage:null,target:null,constructor:function(a){this.initialConfig=a;Ext.apply(this,a);GeoExt.plugins.PrintPageField.superclass.constructor.apply(this,arguments)},init:function(c){this.target=c;var b={beforedestroy:this.onBeforeDestroy,scope:this};var a=c instanceof Ext.form.ComboBox?"select":c instanceof Ext.form.Checkbox?"check":"valid";b[a]=this.onFieldChange;c.on(b);this.printPage.on({change:this.onPageChange,scope:this});this.printPage.printProvider.on({layoutchange:this.onLayoutChange,scope:this});this.setValue(this.printPage)},onFieldChange:function(c,a){var d=this.printPage.printProvider;var b=c.getValue();this._updating=true;if(c.store===d.scales||c.name==="scale"){this.printPage.setScale(a)}else{if(c.name=="rotation"){!isNaN(b)&&this.printPage.setRotation(b)}else{this.printPage.customParams[c.name]=b}}delete this._updating},onPageChange:function(a){if(!this._updating){this.setValue(a)}},onLayoutChange:function(c,b){var a=this.target;a.name=="rotation"&&a.setDisabled(!b.get("rotation"))},setValue:function(a){var b=this.target;b.suspendEvents();if(b.store===a.printProvider.scales||b.name==="scale"){if(a.scale){b.setValue(a.scale.get(b.displayField))}}else{if(b.name=="rotation"){b.setValue(a.rotation)}}b.resumeEvents()},onBeforeDestroy:function(){this.target.un("beforedestroy",this.onBeforeDestroy,this);this.target.un("select",this.onFieldChange,this);this.target.un("valid",this.onFieldChange,this);this.printPage.un("change",this.onPageChange,this);this.printPage.printProvider.un("layoutchange",this.onLayoutChange,this)}});Ext.preg("gx_printpagefield",GeoExt.plugins.PrintPageField);Ext.namespace("GeoExt.tree");GeoExt.tree.LayerNodeUI=Ext.extend(Ext.tree.TreeNodeUI,{constructor:function(a){GeoExt.tree.LayerNodeUI.superclass.constructor.apply(this,arguments)},render:function(d){var c=this.node.attributes;if(c.checked===undefined){c.checked=this.node.layer.getVisibility()}GeoExt.tree.LayerNodeUI.superclass.render.apply(this,arguments);var b=this.checkbox;if(c.checkedGroup){var e=Ext.DomHelper.insertAfter(b,['<input type="radio" name="',c.checkedGroup,'_checkbox" class="',b.className,b.checked?'" checked="checked"':"",'"></input>'].join(""));e.defaultChecked=b.defaultChecked;Ext.get(b).remove();this.checkbox=e}this.enforceOneVisible()},onClick:function(a){if(a.getTarget(".x-tree-node-cb",1)){this.toggleCheck(this.isChecked())}else{GeoExt.tree.LayerNodeUI.superclass.onClick.apply(this,arguments)}},toggleCheck:function(a){a=(a===undefined?!this.isChecked():a);GeoExt.tree.LayerNodeUI.superclass.toggleCheck.call(this,a);this.enforceOneVisible()},enforceOneVisible:function(){var b=this.node.attributes;var e=b.checkedGroup;if(e&&e!=="gx_baselayer"){var d=this.node.layer;var a=this.node.getOwnerTree().getChecked();var c=0;Ext.each(a,function(g){var f=g.layer;if(!g.hidden&&g.attributes.checkedGroup===e){c++;if(f!=d&&b.checked){f.setVisibility(false)}}});if(c===0&&b.checked==false){d.setVisibility(true)}}},appendDDGhost:function(c){var b=this.elNode.cloneNode(true);var a=Ext.DomQuery.select("input[type='radio']",b);Ext.each(a,function(d){d.name=d.name+"_clone"});c.appendChild(b)}});GeoExt.tree.LayerNode=Ext.extend(Ext.tree.AsyncTreeNode,{layer:null,layerStore:null,constructor:function(a){a.leaf=a.leaf||!(a.children||a.loader);
if(!a.iconCls&&!a.children){a.iconCls="gx-tree-layer-icon"}if(a.loader&&!(a.loader instanceof Ext.tree.TreeLoader)){a.loader=new GeoExt.tree.LayerParamLoader(a.loader)}this.defaultUI=this.defaultUI||GeoExt.tree.LayerNodeUI;Ext.apply(this,{layer:a.layer,layerStore:a.layerStore});if(a.text){this.fixedText=true}GeoExt.tree.LayerNode.superclass.constructor.apply(this,arguments)},render:function(a){var c=this.layer instanceof OpenLayers.Layer&&this.layer;if(!c){if(!this.layerStore||this.layerStore=="auto"){this.layerStore=GeoExt.MapPanel.guess().layers}var b=this.layerStore.findBy(function(e){return e.get("title")==this.layer},this);if(b!=-1){c=this.layerStore.getAt(b).getLayer()}}if(!this.rendered||!c){var d=this.getUI();if(c){this.layer=c;if(c.isBaseLayer){this.draggable=false;Ext.applyIf(this.attributes,{checkedGroup:"gx_baselayer"})}if(!this.text){this.text=c.name}d.show();this.addVisibilityEventHandlers()}else{d.hide()}if(this.layerStore instanceof GeoExt.data.LayerStore){this.addStoreEventHandlers(c)}}GeoExt.tree.LayerNode.superclass.render.apply(this,arguments)},addVisibilityEventHandlers:function(){this.layer.events.on({visibilitychanged:this.onLayerVisibilityChanged,scope:this});this.on({checkchange:this.onCheckChange,scope:this})},onLayerVisibilityChanged:function(){if(!this._visibilityChanging){this.getUI().toggleCheck(this.layer.getVisibility())}},onCheckChange:function(c,b){if(b!=this.layer.getVisibility()){this._visibilityChanging=true;var a=this.layer;if(b&&a.isBaseLayer&&a.map){a.map.setBaseLayer(a)}else{a.setVisibility(b)}delete this._visibilityChanging}},addStoreEventHandlers:function(){this.layerStore.on({add:this.onStoreAdd,remove:this.onStoreRemove,update:this.onStoreUpdate,scope:this})},onStoreAdd:function(c,b,d){var a;for(var e=0;e<b.length;++e){a=b[e].getLayer();if(this.layer==a){this.getUI().show();break}else{if(this.layer==a.name){this.render();break}}}},onStoreRemove:function(b,a,c){if(this.layer==a.getLayer()){this.getUI().hide()}},onStoreUpdate:function(c,a,b){var d=a.getLayer();if(!this.fixedText&&(this.layer==d&&this.text!==d.name)){this.setText(d.name)}},destroy:function(){var b=this.layer;if(b instanceof OpenLayers.Layer){b.events.un({visibilitychanged:this.onLayerVisibilityChanged,scope:this})}delete this.layer;var a=this.layerStore;if(a){a.un("add",this.onStoreAdd,this);a.un("remove",this.onStoreRemove,this);a.un("update",this.onStoreUpdate,this)}delete this.layerStore;this.un("checkchange",this.onCheckChange,this);GeoExt.tree.LayerNode.superclass.destroy.apply(this,arguments)}});Ext.tree.TreePanel.nodeTypes.gx_layer=GeoExt.tree.LayerNode;Ext.namespace("GeoExt.tree");GeoExt.tree.LayerParamNode=Ext.extend(Ext.tree.TreeNode,{layer:null,param:null,item:null,delimiter:null,allItems:null,constructor:function(a){var b=a||{};b.iconCls=b.iconCls||"gx-tree-layerparam-icon";b.text=b.text||b.item;this.param=b.param;this.item=b.item;this.delimiter=b.delimiter||",";this.allItems=b.allItems;GeoExt.tree.LayerParamNode.superclass.constructor.apply(this,arguments);this.getLayer();if(this.layer){if(!this.allItems){this.allItems=this.getItemsFromLayer()}if(this.attributes.checked==null){this.attributes.checked=this.layer.getVisibility()&&this.getItemsFromLayer().indexOf(this.item)>=0}else{this.onCheckChange(this,this.attributes.checked)}this.layer.events.on({visibilitychanged:this.onLayerVisibilityChanged,scope:this});this.on({checkchange:this.onCheckChange,scope:this})}},getLayer:function(){if(!this.layer){var c=this.attributes.layer;if(typeof c=="string"){var a=this.attributes.layerStore||GeoExt.MapPanel.guess().layers;var b=a.findBy(function(d){return d.get("title")==c});c=b!=-1?a.getAt(b).getLayer():null}this.layer=c}return this.layer},getItemsFromLayer:function(){var a=this.layer.params[this.param];return a instanceof Array?a:(a?a.split(this.delimiter):[])},createParams:function(a){var b={};b[this.param]=this.layer.params[this.param] instanceof Array?a:a.join(this.delimiter);return b},onLayerVisibilityChanged:function(){if(this.getItemsFromLayer().length===0){this.layer.mergeNewParams(this.createParams(this.allItems))
}var a=this.layer.getVisibility();if(a&&this.getItemsFromLayer().indexOf(this.item)!==-1){this.getUI().toggleCheck(true)}if(!a){this.layer.mergeNewParams(this.createParams([]));this.getUI().toggleCheck(false)}},onCheckChange:function(e,d){var c=this.layer;var b=[];var a=this.getItemsFromLayer();if(d===true&&c.getVisibility()===false&&a.length===this.allItems.length){a=[]}Ext.each(this.allItems,function(g){if((g!==this.item&&a.indexOf(g)!==-1)||(d===true&&g===this.item)){b.push(g)}},this);var f=(b.length>0);f&&c.mergeNewParams(this.createParams(b));if(f!==c.getVisibility()){c.setVisibility(f)}(!f)&&c.mergeNewParams(this.createParams([]))},destroy:function(){var a=this.layer;if(a instanceof OpenLayers.Layer){a.events.un({visibilitychanged:this.onLayerVisibilityChanged,scope:this})}delete this.layer;this.un("checkchange",this.onCheckChange,this);GeoExt.tree.LayerParamNode.superclass.destroy.apply(this,arguments)}});Ext.tree.TreePanel.nodeTypes.gx_layerparam=GeoExt.tree.LayerParamNode;Ext.namespace("GeoExt");GeoExt.UrlLegend=Ext.extend(GeoExt.LayerLegend,{initComponent:function(){GeoExt.UrlLegend.superclass.initComponent.call(this);this.add(new GeoExt.LegendImage({url:this.layerRecord.get("legendURL")}))},update:function(){GeoExt.UrlLegend.superclass.update.apply(this,arguments);this.items.get(1).setUrl(this.layerRecord.get("legendURL"))}});GeoExt.UrlLegend.supports=function(a){return a.get("legendURL")!=null};GeoExt.LayerLegend.types.gx_urllegend=GeoExt.UrlLegend;Ext.reg("gx_urllegend",GeoExt.UrlLegend);Ext.namespace("GeoExt.state");GeoExt.state.PermalinkProvider=function(b){GeoExt.state.PermalinkProvider.superclass.constructor.apply(this,arguments);b=b||{};var a=b.url;delete b.url;Ext.apply(this,b);this.state=this.readURL(a)};Ext.extend(GeoExt.state.PermalinkProvider,Ext.state.Provider,{encodeType:true,readURL:function(b){var d={};var e=OpenLayers.Util.getParameters(b);var a,c,f;for(a in e){if(e.hasOwnProperty(a)){c=a.split("_");if(c.length>1){f=c[0];d[f]=d[f]||{};d[f][c.slice(1).join("_")]=this.encodeType?this.decodeValue(e[a]):e[a]}}}return d},getLink:function(d){d=d||document.location.href;var f={};var g,a,c=this.state;for(g in c){if(c.hasOwnProperty(g)){for(a in c[g]){f[g+"_"+a]=this.encodeType?unescape(this.encodeValue(c[g][a])):c[g][a]}}}OpenLayers.Util.applyDefaults(f,OpenLayers.Util.getParameters(d));var e=OpenLayers.Util.getParameterString(f);var b=d.indexOf("?");if(b>0){d=d.substring(0,b)}return Ext.urlAppend(d,e)}});Ext.namespace("GeoExt");GeoExt.LegendImage=Ext.extend(Ext.BoxComponent,{url:null,defaultImgSrc:null,imgCls:null,initComponent:function(){GeoExt.LegendImage.superclass.initComponent.call(this);if(this.defaultImgSrc===null){this.defaultImgSrc=Ext.BLANK_IMAGE_URL}this.autoEl={tag:"img","class":(this.imgCls?this.imgCls:""),src:this.defaultImgSrc}},setUrl:function(a){this.url=a;var b=this.getEl();if(b){b.un("error",this.onImageLoadError,this);b.on("error",this.onImageLoadError,this,{single:true});b.dom.src=a}},onRender:function(b,a){GeoExt.LegendImage.superclass.onRender.call(this,b,a);if(this.url){this.setUrl(this.url)}},onDestroy:function(){var a=this.getEl();if(a){a.un("error",this.onImageLoadError,this)}GeoExt.LegendImage.superclass.onDestroy.apply(this,arguments)},onImageLoadError:function(){this.getEl().dom.src=this.defaultImgSrc}});Ext.reg("gx_legendimage",GeoExt.LegendImage);Ext.namespace("GeoExt");GeoExt.LayerOpacitySlider=Ext.extend(Ext.Slider,{layer:null,complementaryLayer:null,delay:5,changeVisibilityDelay:5,aggressive:false,changeVisibility:false,value:null,inverse:false,constructor:function(a){if(a.layer){this.layer=this.getLayer(a.layer);this.bind();this.complementaryLayer=this.getLayer(a.complementaryLayer);if(a.inverse!==undefined){this.inverse=a.inverse}a.value=(a.value!==undefined)?a.value:this.getOpacityValue(this.layer);delete a.layer;delete a.complementaryLayer}GeoExt.LayerOpacitySlider.superclass.constructor.call(this,a)},bind:function(){if(this.layer&&this.layer.map){this.layer.map.events.on({changelayer:this.update,scope:this})
}},unbind:function(){if(this.layer&&this.layer.map){this.layer.map.events.un({changelayer:this.update,scope:this})}},update:function(a){if(a.property==="opacity"&&a.layer==this.layer){this.setValue(this.getOpacityValue(this.layer))}},setLayer:function(a){this.unbind();this.layer=this.getLayer(a);this.setValue(this.getOpacityValue(a));this.bind()},getOpacityValue:function(a){var b;if(a&&a.opacity!==null){b=parseInt(a.opacity*(this.maxValue-this.minValue))}else{b=this.maxValue}if(this.inverse===true){b=(this.maxValue-this.minValue)-b}return b},getLayer:function(a){if(a instanceof OpenLayers.Layer){return a}else{if(a instanceof GeoExt.data.LayerRecord){return a.getLayer()}}},initComponent:function(){GeoExt.LayerOpacitySlider.superclass.initComponent.call(this);if(this.changeVisibility&&this.layer&&(this.layer.opacity==0||(this.inverse===false&&this.value==this.minValue)||(this.inverse===true&&this.value==this.maxValue))){this.layer.setVisibility(false)}if(this.complementaryLayer&&((this.layer&&this.layer.opacity==1)||(this.inverse===false&&this.value==this.maxValue)||(this.inverse===true&&this.value==this.minValue))){this.complementaryLayer.setVisibility(false)}if(this.aggressive===true){this.on("change",this.changeLayerOpacity,this,{buffer:this.delay})}else{this.on("changecomplete",this.changeLayerOpacity,this)}if(this.changeVisibility===true){this.on("change",this.changeLayerVisibility,this,{buffer:this.changeVisibilityDelay})}if(this.complementaryLayer){this.on("change",this.changeComplementaryLayerVisibility,this,{buffer:this.changeVisibilityDelay})}this.on("beforedestroy",this.unbind,this)},changeLayerOpacity:function(a,b){if(this.layer){b=b/(this.maxValue-this.minValue);if(this.inverse===true){b=1-b}this.layer.setOpacity(b)}},changeLayerVisibility:function(b,c){var a=this.layer.getVisibility();if((this.inverse===false&&c==this.minValue)||(this.inverse===true&&c==this.maxValue)&&a===true){this.layer.setVisibility(false)}else{if((this.inverse===false&&c>this.minValue)||(this.inverse===true&&c<this.maxValue)&&a==false){this.layer.setVisibility(true)}}},changeComplementaryLayerVisibility:function(b,c){var a=this.complementaryLayer.getVisibility();if((this.inverse===false&&c==this.maxValue)||(this.inverse===true&&c==this.minValue)&&a===true){this.complementaryLayer.setVisibility(false)}else{if((this.inverse===false&&c<this.maxValue)||(this.inverse===true&&c>this.minValue)&&a==false){this.complementaryLayer.setVisibility(true)}}},addToMapPanel:function(a){this.on({render:function(){var b=this.getEl();b.setStyle({position:"absolute",zIndex:a.map.Z_INDEX_BASE.Control});b.on({mousedown:this.stopMouseEvents,click:this.stopMouseEvents})},scope:this})},removeFromMapPanel:function(a){var b=this.getEl();b.un({mousedown:this.stopMouseEvents,click:this.stopMouseEvents,scope:this});this.unbind()},stopMouseEvents:function(a){a.stopEvent()}});Ext.reg("gx_opacityslider",GeoExt.LayerOpacitySlider);Ext.namespace("GeoExt.data");GeoExt.data.AttributeReader=function(a,b){a=a||{};if(!a.format){a.format=new OpenLayers.Format.WFSDescribeFeatureType()}GeoExt.data.AttributeReader.superclass.constructor.call(this,a,b||a.fields);if(a.feature){this.recordType.prototype.fields.add(new Ext.data.Field("value"))}};Ext.extend(GeoExt.data.AttributeReader,Ext.data.DataReader,{read:function(a){var b=a.responseXML;if(!b||!b.documentElement){b=a.responseText}return this.readRecords(b)},readRecords:function(h){var e;if(h instanceof Array){e=h}else{e=this.meta.format.read(h).featureTypes[0].properties}var r=this.meta.feature;var c=this.recordType;var l=c.prototype.fields;var f=l.length;var n,q,a,k,o,p,b=[];for(var g=0,m=e.length;g<m;++g){o=false;n=e[g];q={};for(var d=0;d<f;++d){a=l.items[d].name;p=n[a];if(this.ignoreAttribute(a,p)){o=true;break}q[a]=p}if(r){p=r.attributes[q.name];if(p!==undefined){if(this.ignoreAttribute("value",p)){o=true}else{q.value=p}}}if(!o){b[b.length]=new c(q)}}return{success:true,records:b,totalRecords:b.length}},ignoreAttribute:function(a,c){var d=false;
if(this.meta.ignore&&this.meta.ignore[a]){var b=this.meta.ignore[a];if(typeof b=="string"){d=(b===c)}else{if(b instanceof Array){d=(b.indexOf(c)>-1)}else{if(b instanceof RegExp){d=(b.test(c))}}}}return d}});Ext.namespace("GeoExt.plugins");GeoExt.plugins.TreeNodeComponent=Ext.extend(Ext.util.Observable,{constructor:function(a){Ext.apply(this.initialConfig,Ext.apply({},a));Ext.apply(this,a);GeoExt.plugins.TreeNodeComponent.superclass.constructor.apply(this,arguments)},init:function(a){a.on({rendernode:this.onRenderNode,scope:this})},onRenderNode:function(d){var e=d.rendered;var a=d.attributes;var c=a.component||this.component;if(!e&&c){var b=Ext.DomHelper.append(d.ui.elNode,[{tag:"div"}]);if(typeof c=="function"){c=c(d,b)}else{if(typeof c=="object"&&typeof c.fn=="function"){c=c.fn.apply(c.scope,[d,b])}}if(typeof c=="object"&&typeof c.xtype=="string"){c=Ext.ComponentMgr.create(c)}if(c instanceof Ext.Component){c.render(b);d.component=c}}},destroy:function(){tree.un("rendernode",this.onRenderNode,this)}});Ext.preg&&Ext.preg("gx_treenodecomponent",GeoExt.plugins.TreeNodeComponent);Ext.namespace("GeoExt");GeoExt.ZoomSliderTip=Ext.extend(GeoExt.SliderTip,{template:"<div>Zoom Level: {zoom}</div><div>Resolution: {resolution}</div><div>Scale: 1 : {scale}</div>",compiledTemplate:null,init:function(a){this.compiledTemplate=new Ext.Template(this.template);GeoExt.ZoomSliderTip.superclass.init.call(this,a)},getText:function(a){var b={zoom:a.value,resolution:this.slider.getResolution(),scale:Math.round(this.slider.getScale())};return this.compiledTemplate.apply(b)}});Ext.namespace("GeoExt.data");GeoExt.data.PrintProvider=Ext.extend(Ext.util.Observable,{url:null,capabilities:null,method:"POST",customParams:null,scales:null,dpis:null,layouts:null,dpi:null,layout:null,constructor:function(a){this.initialConfig=a;Ext.apply(this,a);if(!this.customParams){this.customParams={}}this.addEvents("loadcapabilities","layoutchange","dpichange","beforeprint","print","printexception","beforeencodelayer","encodelayer");GeoExt.data.PrintProvider.superclass.constructor.apply(this,arguments);this.scales=new Ext.data.JsonStore({root:"scales",sortInfo:{field:"value",direction:"DESC"},fields:["name",{name:"value",type:"float"}]});this.dpis=new Ext.data.JsonStore({root:"dpis",fields:["name",{name:"value",type:"float"}]});this.layouts=new Ext.data.JsonStore({root:"layouts",fields:["name",{name:"size",mapping:"map"},{name:"rotation",type:"boolean"}]});if(a.capabilities){this.loadStores()}else{if(this.url.split("/").pop()){this.url+="/"}this.initialConfig.autoLoad&&this.loadCapabilities()}},setLayout:function(a){this.layout=a;this.fireEvent("layoutchange",this,a)},setDpi:function(a){this.dpi=a;this.fireEvent("dpichange",this,a)},print:function(c,d,l){if(c instanceof GeoExt.MapPanel){c=c.map}d=d instanceof Array?d:[d];l=l||{};if(this.fireEvent("beforeprint",this,c,d,l)===false){return}var g=Ext.apply({units:c.getUnits(),srs:c.baseLayer.projection.getCode(),layout:this.layout.get("name"),dpi:this.dpi.get("value")},this.customParams);var k=d[0].feature.layer;var j=[];Ext.each(c.layers,function(n){if(n!==k&&n.getVisibility()===true){var m=this.encodeLayer(n);m&&j.push(m)}},this);g.layers=j;var f=[];Ext.each(d,function(m){f.push(Ext.apply({center:[m.center.lon,m.center.lat],scale:m.scale.get("value"),rotation:m.rotation},m.customParams))},this);g.pages=f;if(l.overview){var i=[];Ext.each(l.overview.layers,function(n){var m=this.encodeLayer(n);m&&i.push(m)},this);g.overviewLayers=i}if(l.legend){var h=l.legend;var e=h.rendered;if(!e){h=h.cloneConfig({renderTo:document.body,hidden:true})}var b=[];h.items.each(function(m){if(!m.hidden){var n=this.encoders.legends[m.getXType()];b=b.concat(n.call(this,m))}},this);if(!e){h.destroy()}g.legends=b}if(this.method==="GET"){var a=Ext.urlAppend(this.capabilities.printURL,"spec="+encodeURIComponent(Ext.encode(g)));window.open(a);this.fireEvent("print",this,a)}else{Ext.Ajax.request({url:this.capabilities.createURL,jsonData:g,success:function(m){var n=Ext.decode(m.responseText).getURL+(Ext.isIE?"?inline=true":"");
if(Ext.isOpera||Ext.isIE){window.open(n)}else{window.location.href=n}this.fireEvent("print",this,n)},failure:function(m){this.fireEvent("printexception",this,m)},params:this.initialConfig.baseParams,scope:this})}},loadCapabilities:function(){if(!this.url){return}var a=this.url+"info.json";Ext.Ajax.request({url:a,method:"GET",disableCaching:false,success:function(b){this.capabilities=Ext.decode(b.responseText);this.loadStores()},params:this.initialConfig.baseParams,scope:this})},loadStores:function(){this.scales.loadData(this.capabilities);this.dpis.loadData(this.capabilities);this.layouts.loadData(this.capabilities);this.setLayout(this.layouts.getAt(0));this.setDpi(this.dpis.getAt(0));this.fireEvent("loadcapabilities",this,this.capabilities)},encodeLayer:function(a){var b;for(var d in this.encoders.layers){if(OpenLayers.Layer[d]&&a instanceof OpenLayers.Layer[d]){if(this.fireEvent("beforeencodelayer",this,a)===false){return}b=this.encoders.layers[d].call(this,a);this.fireEvent("encodelayer",this,a,b);break}}return(b&&b.type)?b:null},getAbsoluteUrl:function(c){var b;if(Ext.isIE){b=document.createElement("<a href='"+c+"'/>");b.style.display="none";document.body.appendChild(b);b.href=b.href;document.body.removeChild(b)}else{b=document.createElement("a");b.href=c}return b.href},encoders:{layers:{WMS:function(b){var a=this.encoders.layers.HTTPRequest.call(this,b);Ext.apply(a,{type:"WMS",layers:[b.params.LAYERS].join(",").split(","),format:b.params.FORMAT,styles:[b.params.STYLES].join(",").split(",")});var d;for(var c in b.params){d=c.toLowerCase();if(!b.DEFAULT_PARAMS[d]&&"layers,styles,width,height,srs".indexOf(d)==-1){if(!a.customParams){a.customParams={}}a.customParams[c]=b.params[c]}}return a},OSM:function(b){var a=this.encoders.layers.TileCache.call(this,b);return Ext.apply(a,{type:"OSM",baseURL:a.baseURL.substr(0,a.baseURL.indexOf("$")),extension:"png"})},TMS:function(b){var a=this.encoders.layers.TileCache.call(this,b);return Ext.apply(a,{type:"TMS",format:b.type})},TileCache:function(b){var a=this.encoders.layers.HTTPRequest.call(this,b);return Ext.apply(a,{type:"TileCache",layer:b.layername,maxExtent:b.maxExtent.toArray(),tileSize:[b.tileSize.w,b.tileSize.h],extension:b.extension,resolutions:b.serverResolutions||b.resolutions})},KaMapCache:function(b){var a=this.encoders.layers.KaMap.call(this,b);return Ext.apply(a,{type:"KaMapCache",group:b.params.g,metaTileWidth:b.params.metaTileSize["w"],metaTileHeight:b.params.metaTileSize["h"]})},KaMap:function(b){var a=this.encoders.layers.HTTPRequest.call(this,b);return Ext.apply(a,{type:"KaMap",map:b.params.map,extension:b.params.i,group:b.params.g||"",maxExtent:b.maxExtent.toArray(),tileSize:[b.tileSize.w,b.tileSize.h],resolutions:b.serverResolutions||b.resolutions})},HTTPRequest:function(a){return{baseURL:this.getAbsoluteUrl(a.url instanceof Array?a.url[0]:a.url),opacity:(a.opacity!=null)?a.opacity:1,singleTile:a.singleTile}},Image:function(a){return{type:"Image",baseURL:this.getAbsoluteUrl(a.getURL(a.extent)),opacity:(a.opacity!=null)?a.opacity:1,extent:a.extent.toArray(),pixelSize:[a.size.w,a.size.h],name:a.name}},Vector:function(m){if(!m.features.length){return}var l=[];var o={};var c=m.features;var p=new OpenLayers.Format.GeoJSON();var d=new OpenLayers.Format.JSON();var b=1;var j={};var q,a,h,k,e;for(var g=0,n=c.length;g<n;++g){q=c[g];a=q.style||m.style||m.styleMap.createSymbolizer(q,q.renderIntent);h=d.write(a);k=j[h];if(k){e=k}else{j[h]=e=b++;if(a.externalGraphic){o[e]=Ext.applyIf({externalGraphic:this.getAbsoluteUrl(a.externalGraphic)},a)}else{o[e]=a}}var f=p.extract.feature.call(p,q);f.properties=OpenLayers.Util.extend({_gx_style:e},f.properties);l.push(f)}return{type:"Vector",styles:o,styleProperty:"_gx_style",geoJson:{type:"FeatureCollection",features:l},name:m.name,opacity:(m.opacity!=null)?m.opacity:1}}},legends:{gx_wmslegend:function(e){var b=this.encoders.legends.base.call(this,e);var d=[];for(var c=1,a=e.items.getCount();c<a;++c){d.push(this.getAbsoluteUrl(e.items.get(c).url))
}b[0].classes[0]={name:"",icons:d};return b},gx_urllegend:function(b){var a=this.encoders.legends.base.call(this,b);a[0].classes.push({name:"",icon:this.getAbsoluteUrl(b.items.get(1).url)});return a},base:function(a){return[{name:a.items.get(0).text,classes:[]}]}}}});Ext.namespace("GeoExt");GeoExt.MapPanel=Ext.extend(Ext.Panel,{map:null,layers:null,center:null,zoom:null,prettyStateKeys:false,extent:null,stateEvents:["aftermapmove","afterlayervisibilitychange","afterlayeropacitychange"],initComponent:function(){if(!(this.map instanceof OpenLayers.Map)){this.map=new OpenLayers.Map(Ext.applyIf(this.map||{},{allOverlays:true}))}var a=this.layers;if(!a||a instanceof Array){this.layers=new GeoExt.data.LayerStore({layers:a,map:this.map.layers.length>0?this.map:null})}if(typeof this.center=="string"){this.center=OpenLayers.LonLat.fromString(this.center)}else{if(this.center instanceof Array){this.center=new OpenLayers.LonLat(this.center[0],this.center[1])}}if(typeof this.extent=="string"){this.extent=OpenLayers.Bounds.fromString(this.extent)}else{if(this.extent instanceof Array){this.extent=OpenLayers.Bounds.fromArray(this.extent)}}GeoExt.MapPanel.superclass.initComponent.call(this);this.addEvents("aftermapmove","afterlayervisibilitychange","afterlayeropacitychange");this.map.events.on({moveend:this.onMoveend,changelayer:this.onLayerchange,scope:this})},onMoveend:function(){this.fireEvent("aftermapmove")},onLayerchange:function(a){if(a.property){if(a.property==="visibility"){this.fireEvent("afterlayervisibilitychange")}else{if(a.property==="opacity"){this.fireEvent("afterlayeropacitychange")}}}},applyState:function(g){this.center=new OpenLayers.LonLat(g.x,g.y);this.zoom=g.zoom;var f,c,e,b,a,d;var h=this.map.layers;for(f=0,c=h.length;f<c;f++){e=h[f];b=this.prettyStateKeys?e.name:e.id;a=g["visibility_"+b];if(a!==undefined){a=(/^true$/i).test(a);if(e.isBaseLayer){if(a){this.map.setBaseLayer(e)}}else{e.setVisibility(a)}}d=g["opacity_"+b];if(d!==undefined){e.setOpacity(d)}}},getState:function(){var f;if(!this.map){return}var a=this.map.getCenter();f={x:a.lon,y:a.lat,zoom:this.map.getZoom()};var e,c,d,b,g=this.map.layers;for(e=0,c=g.length;e<c;e++){d=g[e];b=this.prettyStateKeys?d.name:d.id;f["visibility_"+b]=d.getVisibility();f["opacity_"+b]=d.opacity==null?1:d.opacity}return f},updateMapSize:function(){if(this.map){this.map.updateSize()}},renderMap:function(){var a=this.map;a.render(this.body.dom);this.layers.bind(a);if(a.layers.length>0){if(this.center||this.zoom!=null){a.setCenter(this.center,this.zoom)}else{if(this.extent){a.zoomToExtent(this.extent)}else{a.zoomToMaxExtent()}}}},afterRender:function(){GeoExt.MapPanel.superclass.afterRender.apply(this,arguments);if(!this.ownerCt){this.renderMap()}else{this.ownerCt.on("move",this.updateMapSize,this);this.ownerCt.on({afterlayout:{fn:this.renderMap,scope:this,single:true}})}},onResize:function(){GeoExt.MapPanel.superclass.onResize.apply(this,arguments);this.updateMapSize()},onBeforeAdd:function(a){if(typeof a.addToMapPanel==="function"){a.addToMapPanel(this)}GeoExt.MapPanel.superclass.onBeforeAdd.apply(this,arguments)},remove:function(b,a){if(typeof b.removeFromMapPanel==="function"){b.removeFromMapPanel(this)}GeoExt.MapPanel.superclass.remove.apply(this,arguments)},beforeDestroy:function(){if(this.ownerCt){this.ownerCt.un("move",this.updateMapSize,this)}if(this.map&&this.map.events){this.map.events.un({moveend:this.onMoveend,changelayer:this.onLayerchange,scope:this})}if(!this.initialConfig.map||!(this.initialConfig.map instanceof OpenLayers.Map)){if(this.map&&this.map.destroy){this.map.destroy()}}delete this.map;GeoExt.MapPanel.superclass.beforeDestroy.apply(this,arguments)}});GeoExt.MapPanel.guess=function(){return Ext.ComponentMgr.all.find(function(a){return a instanceof GeoExt.MapPanel})};Ext.reg("gx_mappanel",GeoExt.MapPanel);Ext.namespace("GeoExt");GeoExt.PrintMapPanel=Ext.extend(GeoExt.MapPanel,{sourceMap:null,printProvider:null,printPage:null,previewScales:null,center:null,zoom:null,extent:null,currentZoom:null,initComponent:function(){if(this.sourceMap instanceof GeoExt.MapPanel){this.sourceMap=this.sourceMap.map
}if(!this.map){this.map={}}Ext.applyIf(this.map,{projection:this.sourceMap.getProjection(),maxExtent:this.sourceMap.getMaxExtent(),maxResolution:this.sourceMap.getMaxResolution(),units:this.sourceMap.getUnits()});if(!(this.printProvider instanceof GeoExt.data.PrintProvider)){this.printProvider=new GeoExt.data.PrintProvider(this.printProvider)}this.printPage=new GeoExt.data.PrintPage({printProvider:this.printProvider});this.previewScales=new Ext.data.Store();this.previewScales.add(this.printProvider.scales.getRange());this.layers=[];var a;Ext.each(this.sourceMap.layers,function(b){var c=b.clone();b.getVisibility()===true&&this.layers.push(c)},this);this.extent=this.sourceMap.getExtent();GeoExt.PrintMapPanel.superclass.initComponent.call(this);this.printProvider.on("layoutchange",this.syncSize,this);this.printPage.on("change",this.fitZoom,this);this.map.events.register("moveend",this,this.updatePage)},afterRender:function(){GeoExt.PrintMapPanel.superclass.afterRender.apply(this,arguments);this.syncSize();if(this.initialConfig.limitScales===true){if(!this.ownerCt){this.calculatePreviewScales()}else{this.ownerCt.on({afterlayout:{fn:this.calculatePreviewScales,scope:this,single:true}})}this.on("resize",this.calculatePreviewScales,this)}},adjustSize:function(f,b){var g=this.printProvider.layout.get("size");var e=g.width/g.height;var d=this.ownerCt;var c=(d&&d.autoWidth)?0:(f||this.initialConfig.width);var a=(d&&d.autoHeight)?0:(b||this.initialConfig.height);if(c){b=c/e;if(a&&b>a){b=a;f=b*e}else{f=c}}else{if(a){f=a*e;b=a}}return{width:f,height:b}},fitZoom:function(){if(!this._updating&&this.printPage.scale){this._updating=true;var a=this.printPage.getPrintExtent(this.map);this.currentZoom=this.map.getZoomForExtent(a);this.map.zoomToExtent(a);delete this._updating}},updatePage:function(){if(!this._updating){var a=this.map.getZoom();this._updating=true;if(a===this.currentZoom){this.printPage.setCenter(this.map.getCenter())}else{this.printPage.fit(this.map)}delete this._updating;this.currentZoom=a}},calculatePreviewScales:function(){this.previewScales.removeAll();this.printPage.suspendEvents();var e=this.printPage.scale;var h=this.map.getSize();var g={};var a=[];this.printProvider.scales.each(function(n){this.printPage.setScale(n);var k=this.printPage.getPrintExtent(this.map);var l=this.map.getZoomForExtent(k);var i=Math.max(k.getWidth()/h.w,k.getHeight()/h.h);var j=this.map.getResolutionForZoom(l);var m=Math.abs(i-j);if(!(l in g)||g[l].diff>m){g[l]={rec:n,diff:m};a.indexOf(l)==-1&&a.push(l)}},this);for(var b=0,c=a.length;b<c;++b){this.previewScales.add(g[a[b]].rec)}e&&this.printPage.setScale(e);this.printPage.resumeEvents();if(e&&this.previewScales.getCount()>0){var f=this.previewScales.getAt(0);var d=this.previewScales.getAt(this.previewScales.getCount()-1);if(e.get("value")<d.get("value")){this.printPage.setScale(d)}else{if(e.get("value")>f.get("value")){this.printPage.setScale(f)}}}this.fitZoom()},print:function(a){this.printProvider.print(this.map,[this.printPage],a)},beforeDestroy:function(){this.map.events.unregister("moveend",this,this.updatePage);this.printPage.un("change",this.fitZoom,this);this.printProvider.un("layoutchange",this.syncSize,this);GeoExt.PrintMapPanel.superclass.beforeDestroy.apply(this,arguments)}});Ext.reg("gx_printmappanel",GeoExt.PrintMapPanel);Ext.namespace("GeoExt.data");GeoExt.data.ScaleStore=Ext.extend(Ext.data.Store,{map:null,constructor:function(a){var b=(a.map instanceof GeoExt.MapPanel?a.map.map:a.map);delete a.map;a=Ext.applyIf(a,{reader:new Ext.data.JsonReader({},["level","resolution","scale"])});GeoExt.data.ScaleStore.superclass.constructor.call(this,a);if(b){this.bind(b)}},bind:function(b,a){this.map=(b instanceof GeoExt.MapPanel?b.map:b);this.map.events.register("changebaselayer",this,this.populateFromMap);if(this.map.baseLayer){this.populateFromMap()}else{this.map.events.register("addlayer",this,this.populateOnAdd)}},unbind:function(){if(this.map){this.map.events.unregister("addlayer",this,this.populateOnAdd);
this.map.events.unregister("changebaselayer",this,this.populateFromMap);delete this.map}},populateOnAdd:function(a){if(a.layer.isBaseLayer){this.populateFromMap();this.map.events.unregister("addlayer",this,this.populateOnAdd)}},populateFromMap:function(){var c=[];var a=this.map.baseLayer.resolutions;var b=this.map.baseLayer.units;for(var e=a.length-1;e>=0;e--){var d=a[e];c.push({level:e,resolution:d,scale:OpenLayers.Util.getScaleFromResolution(d,b)})}this.loadData(c)},destroy:function(){this.unbind();GeoExt.data.ScaleStore.superclass.destroy.apply(this,arguments)}});Ext.namespace("GeoExt.data");GeoExt.data.FeatureStoreMixin=function(){return{layer:null,reader:null,featureFilter:null,constructor:function(b){b=b||{};b.reader=b.reader||new GeoExt.data.FeatureReader({},b.fields);var c=b.layer;delete b.layer;if(b.features){b.data=b.features}delete b.features;var a={initDir:b.initDir};delete b.initDir;arguments.callee.superclass.constructor.call(this,b);if(c){this.bind(c,a)}},bind:function(d,b){if(this.layer){return}this.layer=d;b=b||{};var f=b.initDir;if(b.initDir==undefined){f=GeoExt.data.FeatureStore.LAYER_TO_STORE|GeoExt.data.FeatureStore.STORE_TO_LAYER}var e=d.features.slice(0);if(f&GeoExt.data.FeatureStore.STORE_TO_LAYER){var a=this.getRange();for(var c=a.length-1;c>=0;c--){this.layer.addFeatures([a[c].getFeature()])}}if(f&GeoExt.data.FeatureStore.LAYER_TO_STORE){this.loadData(e,true)}d.events.on({featuresadded:this.onFeaturesAdded,featuresremoved:this.onFeaturesRemoved,featuremodified:this.onFeatureModified,scope:this});this.on({load:this.onLoad,clear:this.onClear,add:this.onAdd,remove:this.onRemove,update:this.onUpdate,scope:this})},unbind:function(){if(this.layer){this.layer.events.un({featuresadded:this.onFeaturesAdded,featuresremoved:this.onFeaturesRemoved,featuremodified:this.onFeatureModified,scope:this});this.un("load",this.onLoad,this);this.un("clear",this.onClear,this);this.un("add",this.onAdd,this);this.un("remove",this.onRemove,this);this.un("update",this.onUpdate,this);this.layer=null}},getRecordFromFeature:function(c){var a=null;if(c.state!==OpenLayers.State.INSERT){a=this.getById(c.id)}else{var b=this.findBy(function(d){return d.getFeature()===c});if(b>-1){a=this.getAt(b)}}return a},onFeaturesAdded:function(b){if(!this._adding){var f=b.features,e=f;if(this.featureFilter){e=[];var d,a,c;for(var d=0,a=f.length;d<a;d++){c=f[d];if(this.featureFilter.evaluate(c)!==false){e.push(c)}}}this._adding=true;this.loadData(e,true);delete this._adding}},onFeaturesRemoved:function(b){if(!this._removing){var e=b.features,d,a,c;for(c=e.length-1;c>=0;c--){d=e[c];a=this.getRecordFromFeature(d);if(a!==undefined){this._removing=true;this.remove(a);delete this._removing}}}},onFeatureModified:function(h){if(!this._updating){var j=h.feature;var c=this.getRecordFromFeature(j);if(c!==undefined){c.beginEdit();var a=j.attributes;if(a){var d=this.recordType.prototype.fields;for(var b=0,e=d.length;b<e;b++){var f=d.items[b];var g=f.mapping||f.name;if(g in a){c.set(f.name,f.convert(a[g]))}}}c.set("state",j.state);c.set("fid",j.fid);c.setFeature(j);this._updating=true;c.endEdit();delete this._updating}}},addFeaturesToLayer:function(b){var c,a,d;d=new Array((a=b.length));for(c=0;c<a;c++){d[c]=b[c].getFeature()}if(d.length>0){this._adding=true;this.layer.addFeatures(d);delete this._adding}},onLoad:function(b,a,c){if(!c||c.add!==true){this._removing=true;this.layer.removeFeatures(this.layer.features);delete this._removing;this.addFeaturesToLayer(a)}},onClear:function(a){this._removing=true;this.layer.removeFeatures(this.layer.features);delete this._removing},onAdd:function(b,a,c){if(!this._adding){this.addFeaturesToLayer(a)}},onRemove:function(b,a,c){if(!this._removing){var d=a.getFeature();if(this.layer.getFeatureById(d.id)!=null){this._removing=true;this.layer.removeFeatures([a.getFeature()]);delete this._removing}}},onUpdate:function(e,b,d){if(!this._updating){var g=new GeoExt.data.FeatureRecord().fields;var f=b.getFeature();if(b.fields){var a=this.layer.events.triggerEvent("beforefeaturemodified",{feature:f});
if(a!==false){var c=f.attributes;b.fields.each(function(i){var h=i.mapping||i.name;if(!g.containsKey(h)){c[h]=b.get(i.name)}});this._updating=true;this.layer.events.triggerEvent("featuremodified",{feature:f});delete this._updating;if(this.layer.getFeatureById(f.id)!=null){this.layer.drawFeature(f)}}}}}}};GeoExt.data.FeatureStore=Ext.extend(Ext.data.Store,new GeoExt.data.FeatureStoreMixin);GeoExt.data.FeatureStore.LAYER_TO_STORE=1;GeoExt.data.FeatureStore.STORE_TO_LAYER=2;Ext.namespace("GeoExt.data");GeoExt.data.WFSCapabilitiesStore=function(a){a=a||{};GeoExt.data.WFSCapabilitiesStore.superclass.constructor.call(this,Ext.apply(a,{proxy:a.proxy||(!a.data?new Ext.data.HttpProxy({url:a.url,disableCaching:false,method:"GET"}):undefined),reader:new GeoExt.data.WFSCapabilitiesReader(a,a.fields)}))};Ext.extend(GeoExt.data.WFSCapabilitiesStore,Ext.data.Store);Ext.namespace("GeoExt.plugins");GeoExt.plugins.AttributeForm=function(a){Ext.apply(this,a)};GeoExt.plugins.AttributeForm.prototype={attributeStore:null,formPanel:null,init:function(a){this.formPanel=a;if(this.attributeStore instanceof Ext.data.Store){this.fillForm();this.bind(this.attributeStore)}a.on("destroy",this.onFormDestroy,this)},bind:function(a){this.unbind();a.on({load:this.onLoad,scope:this});this.attributeStore=a},unbind:function(){if(this.attributeStore){this.attributeStore.un("load",this.onLoad,this)}},onLoad:function(){if(this.formPanel.items){this.formPanel.removeAll()}this.fillForm()},fillForm:function(){this.attributeStore.each(function(a){var b=GeoExt.form.recordToField(a);if(b){this.formPanel.add(b)}},this);this.formPanel.doLayout()},onFormDestroy:function(){this.unbind()}};Ext.preg("gx_attributeform",GeoExt.plugins.AttributeForm);Ext.namespace("GeoExt","GeoExt.data");GeoExt.data.ProtocolProxy=function(a){Ext.apply(this,a);GeoExt.data.ProtocolProxy.superclass.constructor.apply(this,arguments)};Ext.extend(GeoExt.data.ProtocolProxy,Ext.data.DataProxy,{protocol:null,abortPrevious:true,setParamsAsOptions:false,response:null,load:function(g,c,h,e,b){if(this.fireEvent("beforeload",this,g)!==false){var f={params:g||{},request:{callback:h,scope:e,arg:b},reader:c};var a=OpenLayers.Function.bind(this.loadResponse,this,f);if(this.abortPrevious){this.abortRequest()}var d={params:g,callback:a,scope:this};Ext.applyIf(d,b);if(this.setParamsAsOptions===true){Ext.applyIf(d,d.params);delete d.params}this.response=this.protocol.read(d)}else{h.call(e||this,null,b,false)}},abortRequest:function(){if(this.response){this.protocol.abort(this.response);this.response=null}},loadResponse:function(c,b){if(b.success()){var a=c.reader.read(b);this.fireEvent("load",this,c,c.request.arg);c.request.callback.call(c.request.scope,a,c.request.arg,true)}else{this.fireEvent("loadexception",this,c,b);c.request.callback.call(c.request.scope,null,c.request.arg,false)}}});Ext.namespace("GeoExt");GeoExt.Action=Ext.extend(Ext.Action,{control:null,map:null,uScope:null,uHandler:null,uToggleHandler:null,uCheckHandler:null,constructor:function(a){this.uScope=a.scope;this.uHandler=a.handler;this.uToggleHandler=a.toggleHandler;this.uCheckHandler=a.checkHandler;a.scope=this;a.handler=this.pHandler;a.toggleHandler=this.pToggleHandler;a.checkHandler=this.pCheckHandler;var b=this.control=a.control;delete a.control;if(b){if(a.map){a.map.addControl(b);delete a.map}if((a.pressed||a.checked)&&b.map){b.activate()}b.events.on({activate:this.onCtrlActivate,deactivate:this.onCtrlDeactivate,scope:this})}arguments.callee.superclass.constructor.call(this,a)},pHandler:function(a){var b=this.control;if(b&&b.type==OpenLayers.Control.TYPE_BUTTON){b.trigger()}if(this.uHandler){this.uHandler.apply(this.uScope,arguments)}},pToggleHandler:function(a,b){this.changeControlState(b);if(this.uToggleHandler){this.uToggleHandler.apply(this.uScope,arguments)}},pCheckHandler:function(a,b){this.changeControlState(b);if(this.uCheckHandler){this.uCheckHandler.apply(this.uScope,arguments)}},changeControlState:function(a){if(a){if(!this._activating){this._activating=true;
this.control.activate();this._activating=false}}else{if(!this._deactivating){this._deactivating=true;this.control.deactivate();this._deactivating=false}}},onCtrlActivate:function(){var a=this.control;if(a.type==OpenLayers.Control.TYPE_BUTTON){this.enable()}else{this.safeCallEach("toggle",[true]);this.safeCallEach("setChecked",[true])}},onCtrlDeactivate:function(){var a=this.control;if(a.type==OpenLayers.Control.TYPE_BUTTON){this.disable()}else{this.safeCallEach("toggle",[false]);this.safeCallEach("setChecked",[false])}},safeCallEach:function(e,b){var d=this.items;for(var c=0,a=d.length;c<a;c++){if(d[c][e]){d[c].rendered?d[c][e].apply(d[c],b):d[c].on({render:d[c][e].createDelegate(d[c],b),single:true})}}}});Ext.namespace("GeoExt.tree");GeoExt.tree.TreeNodeUIEventMixin=function(){return{constructor:function(a){a.addEvents("rendernode","rawclicknode");this.superclass=arguments.callee.superclass;this.superclass.constructor.apply(this,arguments)},render:function(a){if(!this.rendered){this.superclass.render.apply(this,arguments);this.fireEvent("rendernode",this.node)}},onClick:function(a){if(this.fireEvent("rawclicknode",this.node,a)!==false){this.superclass.onClick.apply(this,arguments)}}}};Ext.namespace("GeoExt.plugins");GeoExt.plugins.TreeNodeRadioButton=Ext.extend(Ext.util.Observable,{constructor:function(a){Ext.apply(this.initialConfig,Ext.apply({},a));Ext.apply(this,a);this.addEvents("radiochange");GeoExt.plugins.TreeNodeRadioButton.superclass.constructor.apply(this,arguments)},init:function(a){a.on({rendernode:this.onRenderNode,rawclicknode:this.onRawClickNode,beforedestroy:this.onBeforeDestroy,scope:this})},onRenderNode:function(c){var b=c.attributes;if(b.radioGroup&&!b.radio){b.radio=Ext.DomHelper.insertBefore(c.ui.anchor,['<input type="radio" class="gx-tree-radio" name="',b.radioGroup,'_radio"></input>'].join(""))}},onRawClickNode:function(b,c){var a=c.getTarget(".gx-tree-radio",1);if(a){a.defaultChecked=a.checked;this.fireEvent("radiochange",b);return false}},onBeforeDestroy:function(a){a.un("rendernode",this.onRenderNode,this);a.un("rawclicknode",this.onRenderNode,this);a.un("beforedestroy",this.onBeforeDestroy,this)}});Ext.preg("gx_treenoderadiobutton",GeoExt.plugins.TreeNodeRadioButton);Ext.namespace("GeoExt.data");GeoExt.data.WMSCapabilitiesStore=function(a){a=a||{};GeoExt.data.WMSCapabilitiesStore.superclass.constructor.call(this,Ext.apply(a,{proxy:a.proxy||(!a.data?new Ext.data.HttpProxy({url:a.url,disableCaching:false,method:"GET"}):undefined),reader:new GeoExt.data.WMSCapabilitiesReader(a,a.fields)}))};Ext.extend(GeoExt.data.WMSCapabilitiesStore,Ext.data.Store);Ext.namespace("GeoExt");GeoExt.LayerOpacitySliderTip=Ext.extend(GeoExt.SliderTip,{template:"<div>{opacity}%</div>",compiledTemplate:null,init:function(a){this.compiledTemplate=new Ext.Template(this.template);GeoExt.LayerOpacitySliderTip.superclass.init.call(this,a)},getText:function(a){var b={opacity:a.value};return this.compiledTemplate.apply(b)}});GeoExt.version="1.0";OpenLayers.Filter.ComparisonEx=OpenLayers.Class(OpenLayers.Filter.Comparison,{initialize:function(a){OpenLayers.Filter.Comparison.prototype.initialize.apply(this,[a])},getAttribute:function(d,f,a){var c=f[0];if(typeOfEx(d[c])=="object"){var e=f.slice(1,f.length);this.getAttribute(d[c],e,a)}else{if(typeOfEx(d[c])=="array"){var e=f.slice(1,f.length);for(var b=0;b<d[c].length;b++){this.getAttribute(d[c][b],e,a)}}else{a.push(d[c])}}},evaluate:function(e){if(e instanceof OpenLayers.Feature.Vector){e=e.attributes}var a=false;var g=this.property.split(".");var c=[];this.getAttribute(e,g,c);for(var d=0;d<c.length;d++){var b=c[d];switch(this.type){case OpenLayers.Filter.Comparison.EQUAL_TO:var h=this.value;if(!this.matchCase&&typeof b=="string"&&typeof h=="string"){a=(b.toUpperCase()==h.toUpperCase())}else{a=(b==h)}break;case OpenLayers.Filter.Comparison.NOT_EQUAL_TO:var h=this.value;if(!this.matchCase&&typeof b=="string"&&typeof h=="string"){a=(b.toUpperCase()!=h.toUpperCase())}else{a=(b!=h)}break;case OpenLayers.Filter.Comparison.LESS_THAN:a=b<this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN:a=b>this.value;break;case OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO:a=b<=this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO:a=b>=this.value;break;case OpenLayers.Filter.Comparison.BETWEEN:a=(b>=this.lowerBoundary)&&(b<=this.upperBoundary);break;case OpenLayers.Filter.Comparison.LIKE:var f=new RegExp(this.value,"gi");a=f.test(b);break}if(a==true){break}}return a}});Ext.namespace("GeoExt.tree");GeoExt.tree.TreeNodeUIEventMixinExtended=function(){return{constructor:function(a){a.addEvents("rendernode","rawclicknode","rawslidenode");this.superclass=arguments.callee.superclass;this.superclass.constructor.apply(this,arguments)},render:function(a){if(!this.rendered){this.superclass.render.apply(this,arguments);this.fireEvent("rendernode",this.node)}},onClick:function(a){if(this.fireEvent("rawclicknode",this.node,a)!==false){if(this.fireEvent("rawlayerinfoclick",this.node,a)!==false){this.superclass.onClick.apply(this,arguments)}}},onSliderChange:function(b,c,a){if(this.fireEvent("rawslidenode",this.node,b,c)!==false){}}}};Ext.namespace("GeoExt.tree");GeoExt.tree.LayerOpacitySliderPlugin=Ext.extend(Ext.util.Observable,{constructor:function(a){Ext.apply(this.initialConfig,Ext.apply({},a));Ext.apply(this,a);this.addEvents("opacityslide");GeoExt.tree.LayerOpacitySliderPlugin.superclass.constructor.apply(this,arguments)},init:function(a){a.on({rendernode:this.onRenderNode,rawslidenode:this.onRawSlideNode,scope:this})},onRenderNode:function(g){var b=g.attributes;var d=g.layer;if(b.slider){this.indentMarkup=g.parentNode?g.parentNode.ui.getChildIndent():"";var c=g.id+"-tree-slider-";c=Ext.id(null,c);buf=["<br/>","<table><tr>","<td>",'<span class="x-tree-node-indent">',this.indentMarkup,"</span>","</td><td>",'<span class="x-tree-node-indent">',this.indentMarkup,"</span>","</td><td>","<a id=",c,"></a>","</td>","</tr></table>"];Ext.DomHelper.insertAfter(g.ui.anchor,buf.join(""));var e=100;var f=new Ext.Slider({minValue:0,maxValue:100,value:e,width:100,aggressive:true,plugins:new GeoExt.LayerOpacitySliderTip()});Ext.override(Ext.Slider,{getRatio:function(){var a=this.innerEl.getComputedWidth();var h=this.maxValue-this.minValue;return h==0?a:(a/h)}});f.on("change",g.ui.onSliderChange,g.ui);f.render(c)}},onRawSlideNode:function(b,a,c){b.layer.setOpacity(c/100);this.fireEvent("opacityslide",b,c);return(false)}});Ext.preg&&Ext.preg("gx_layeropacitysliderplugin",GeoExt.tree.LayerOpacitySliderPlugin);Ext.namespace("GeoExt.tree");GeoExt.tree.RadioButtonPlugin=Ext.extend(Ext.util.Observable,{constructor:function(a){Ext.apply(this.initialConfig,Ext.apply({},a));Ext.apply(this,a);this.addEvents("radiochange");GeoExt.tree.RadioButtonPlugin.superclass.constructor.apply(this,arguments)},init:function(a){a.on({rendernode:this.onRenderNode,rawclicknode:this.onRawClickNode,scope:this})},onRenderNode:function(c){var b=c.attributes;if(b.radioGroup&&!b.radio){b.radio=Ext.DomHelper.insertBefore(c.ui.anchor,['<input type="radio" class="gx-tree-radio" name="',b.radioGroup,'_radio"></input>'].join(""))}},onRawClickNode:function(b,c){var a=c.getTarget(".gx-tree-radio",1);if(a){a.defaultChecked=a.checked;this.fireEvent("radiochange",b);return false}}});Ext.preg&&Ext.preg("gx_radiobuttonplugin",GeoExt.tree.RadioButtonPlugin);Ext.namespace("GeoExt.tree");GeoExt.tree.LayerInfoPlugin=Ext.extend(Ext.util.Observable,{constructor:function(a){Ext.apply(this.initialConfig,Ext.apply({},a));Ext.apply(this,a);this.addEvents("layerinfoclick");GeoExt.tree.LayerInfoPlugin.superclass.constructor.apply(this,arguments)},init:function(a){a.on({rendernode:this.onRenderNode,rawlayerinfoclick:this.onRawLayerInfoClick,scope:this})},onRenderNode:function(e){var b=e.attributes;var d=e.layer;if(b.layerinfo){var c=['<input type="button" class="gx-layer-info"></input>'];Ext.DomHelper.insertBefore(e.ui.anchor,c.join(""))}},onRawLayerInfoClick:function(b,c){var a=c.getTarget(".gx-layer-info",1);if(a){this.fireEvent("layerinfoclick",b);return(false)}return(true)}});Ext.preg&&Ext.preg("gx_layerinfoplugin",GeoExt.tree.LayerInfoPlugin);HighchartsAdapter={each:Ext.each,map:function(b,e){var d=[];if(b){for(var c=0,a=b.length;c<a;c++){d[c]=e.call(b[c],b[c],c,b)}}return d},grep:function(b,f,a){var c=[];for(var d=0,e=b.length;d<e;d++){if(!a!=!f(b[d],d)){c.push(b[d])}}return c},merge:function(){var a=arguments;var b=function(){var h=arguments[0]||{},f=1,g=arguments.length,c=false,e;if(typeof h==="boolean"){c=h;h=arguments[1]||{};f=2}if(typeof h!=="object"&&!Ext.isFunction(h)){h={}}if(g==f){h=this;--f}for(;f<g;f++){if((e=arguments[f])!=null){for(var d in e){var j=h[d],k=e[d];if(h===k){continue}if(c&&k&&typeof k==="object"&&!k.nodeType){h[d]=b(c,j||(k.length!=null?[]:{}),k)}else{if(k!==undefined){h[d]=k}}}}}return h};return b(true,null,a[0],a[1],a[2],a[3])},hyphenate:function(a){return a.replace(/([A-Z])/g,function(d,c){return"-"+c.toLowerCase()})},addEvent:function(b,c,a){var d=Ext.get(b);if(d){d.addListener(c,a)}else{if(!b.addListener){Ext.apply(b,new Ext.util.Observable())}b.addListener(c,a)}},fireEvent:function(c,d,b,a){var e={type:d,target:c};Ext.apply(e,b);if(c.fireEvent){c.fireEvent(d,e)}if(a){a(e)}},removeEvent:function(b,c,a){if(b.removeListener&&b.purgeListeners){if(c&&a){b.removeListener(c,a)}else{b.purgeListeners()}}else{var d=Ext.get(b);if(d){if(c&&a){d.removeListener(c,a)}else{d.purgeAllListeners()}}}},stop:function(a){},animate:function(b,e,a){var c=b;var d=b.attr;if(d){c=Ext.get(b.element)}if(a){if(a.duration==undefined||a.duration==0){a.duration=1}else{a.duration=a.duration/1000}}else{a={}}if(e.width!==undefined){if(d){if(Ext.isIE){b.attr("width",e.width)}else{b.element.setAttributeNS(null,"width",e.width)}}else{c.setWidth(e.width)}}else{if(e.height!==undefined){if(d){if(Ext.isIE){b.attr("height",e.height);if(e.y){b.attr("y",e.y)}}else{b.element.setAttributeNS(null,"height",e.height);if(e.y){b.element.setAttributeNS(null,"y",e.y)}}}else{c.setHeight(e.height)}}else{if(e.left!==undefined){if(d){if(Ext.isIE){b.attr("left",e.left)}else{b.element.setAttributeNS(null,"left",e.left)}}else{c.setLeft(e.left)}}else{if(e.top){if(d){if(Ext.isIE){b.attr("top",e.top)}else{b.element.setAttributeNS(null,"top",e.top)}}else{c.setTop(e.top)}}else{if(e.translateX&&e.translateY){if(d){if(Ext.isIE){b.attr("transform","translate("+e.translateX+","+e.translateY+" )")}else{b.element.setAttributeNS(null,"transform","translate("+e.translateX+","+e.translateY+" )")}}}}}}}if(e.opacity!==undefined){if(!d){c.setOpacity(parseInt(e.opacity),{duration:a.duration,callback:a.complete})}}if(a.complete!=undefined){a.complete()}},getAjax:function(a,b){Ext.Ajax.request({url:a,success:function(c){b(c.responseText)}})}};(function(){var G=document,aB=window,U=Math,s=U.round,P=U.floor,a7=U.ceil,aL=U.max,ab=U.min,a5=U.abs,aR=U.cos,B=U.sin,e=navigator.userAgent,aY=/msie/i.test(e)&&!aB.opera,ax=/AppleWebKit/.test(e),c=aB.SVGAngle||G.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),Q,O,ap={},N=0,I=1,C,aG,az,ay,am="div",aX="absolute",k="relative",ar="hidden",y="highcharts-",ak="visible",ai="px",ag="none",at="M",au="L",aD="rgba(192,192,192,"+(c?0.000001:0.002)+")",V="",R="hover",t="select",aT,H,aM,ah,a1,aN,aj,aF,E,aQ,F,x,d=aB.HighchartsAdapter,A=d||{},a6=A.each,l=A.grep,q=A.map,v=A.merge,aU=A.hyphenate,aa=A.addEvent,ac=A.removeEvent,aJ=A.fireEvent,ae=A.animate,aO=A.stop,an=A.getAjax,a2={};function av(M,L){if(!M){M={}}for(var a9 in L){M[a9]=L[a9]}return M}function i(L){return L!==ay&&L!==null}function Z(a9,bc,bb){var M,ba="setAttribute",L;if(typeof bc=="string"){if(i(bb)){a9[ba](bc,bb)}else{if(a9&&a9.getAttribute){L=a9.getAttribute(bc)}}}else{if(i(bc)&&typeof bc=="object"){for(M in bc){a9[ba](M,bc[M])}}}return L}function ad(L){if(!L||L.constructor!=Array){L=[L]}return L}function b(){var M=arguments,a9,L;for(a9=0;a9<M.length;a9++){L=M[a9];if(i(L)){return L}}}function aV(a9){var M="",L;for(L in a9){M+=aU(L)+":"+a9[L]+";"}return M}function aw(L,M){if(aY){if(M&&M.opacity!==ay){M.filter="alpha(opacity="+(M.opacity*100)+")"}}av(L.style,M)}function aq(L,bc,bb,ba,a9){var M=G.createElement(L);if(bc){av(M,bc)}if(a9){aw(M,{padding:0,border:ag,margin:0})}if(bb){aw(M,bb)}if(ba){ba.appendChild(M)}return M}if(!d&&aB.jQuery){var K=jQuery;a6=function(M,ba){for(var a9=0,L=M.length;a9<L;a9++){if(ba.call(M[a9],M[a9],a9,M)===false){return a9}}};l=K.grep;q=function(M,bb){var ba=[];for(var a9=0,L=M.length;a9<L;a9++){ba[a9]=bb.call(M[a9],M[a9],a9,M)}return ba};v=function(){var L=arguments;return K.extend(true,null,L[0],L[1],L[2],L[3])};aU=function(L){return L.replace(/([A-Z])/g,function(a9,M){return"-"+M.toLowerCase()})};aa=function(M,a9,L){K(M).bind(a9,L)};ac=function(a9,L,M){var ba=G.removeEventListener?"removeEventListener":"detachEvent";if(G[ba]&&!a9[ba]){a9[ba]=function(){}}K(a9).unbind(L,M)};aJ=function(ba,a9,M,L){var bc=K.Event(a9),bb="detached"+a9;av(bc,M);if(ba[a9]){ba[bb]=ba[a9];ba[a9]=null}K(ba).trigger(bc);if(ba[bb]){ba[a9]=ba[bb];ba[bb]=null}if(L&&!bc.isDefaultPrevented()){L(bc)}};ae=function(a9,ba,L){var M=K(a9);M.stop();M.animate(ba,L)};aO=function(L){K(L).stop()};an=function(L,M){K.get(L,null,M)};K.extend(K.easing,{easeOutQuad:function(M,a9,L,bb,ba){return -bb*(a9/=ba)*(a9-2)+L}});var aP=jQuery.fx.step._default,aW=jQuery.fx.prototype.cur;K.fx.step._default=function(M){var L=M.elem;if(L.attr){L.attr(M.prop,M.now)}else{aP.apply(this,arguments)}};K.fx.prototype.cur=function(){var M=this.elem,L;if(M.attr){L=M.attr(this.prop)}else{L=aW.apply(this,arguments)}return L}}else{if(!d&&aB.MooTools){a6=$each;q=function(L,M){return L.map(M)};l=function(L,M){return L.filter(M)};v=$merge;aU=function(L){return L.hyphenate()};aa=function(a9,M,L){if(typeof M=="string"){if(M=="unload"){M="beforeunload"}if(!a9.addEvent){if(a9.nodeName){a9=$(a9)}else{av(a9,new Events())}}a9.addEvent(M,L)}};ac=function(a9,M,L){if(M){if(M=="unload"){M="beforeunload"}a9.removeEvent(M,L)}};aJ=function(a9,ba,M,L){ba=new Event({type:ba,target:a9});ba=av(ba,M);ba.preventDefault=function(){L=null};if(a9.fireEvent){a9.fireEvent(ba.type,ba)}if(L){L(ba)}};ae=function(a9,bb,L){var ba=a9.attr,M;if(ba&&!a9.setStyle){a9.setStyle=a9.getStyle=a9.attr;a9.$family=a9.uid=true}aO(a9);M=new Fx.Morph(ba?a9:$(a9),av(L,{transition:Fx.Transitions.Quad.easeInOut}));M.start(bb);a9.fx=M};aO=function(L){if(L.fx){L.fx.cancel()}};an=function(L,M){(new Request({url:L,method:"get",onSuccess:M})).send()}}}function aC(){var L=aG.global.useUTC;aT=L?Date.UTC:function(bb,bc,a9,M,ba,bd){return new Date(bb,bc,b(a9,1),b(M,0),b(ba,0),b(bd,0)).getTime()};H=L?"getUTCMinutes":"getMinutes";aM=L?"getUTCHours":"getHours";ah=L?"getUTCDay":"getDay";a1=L?"getUTCDate":"getDate";aN=L?"getUTCMonth":"getMonth";aj=L?"getUTCFullYear":"getFullYear";
aF=L?"setUTCMinutes":"setMinutes";E=L?"setUTCHours":"setHours";aQ=L?"setUTCDate":"setDate";F=L?"setUTCMonth":"setMonth";x=L?"setUTCFullYear":"setFullYear"}function aA(L){aG=v(aG,L);aC();return aG}function D(){return aG}function T(L){if(!C){C=aq(am)}if(L){C.appendChild(L)}C.innerHTML=""}var X={enabled:true,align:"center",x:0,y:15,style:{color:"#666",fontSize:"11px"}};aG={colors:["#4572A7","#AA4643","#89A54E","#80699B","#3D96AE","#DB843D","#92A8CD","#A47D7C","#B5CA92"],symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],decimalPoint:".",resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:","},global:{useUTC:true},chart:{margin:[50,50,90,80],borderColor:"#4572A7",borderRadius:5,defaultSeriesType:"line",ignoreHiddenSeries:true,style:{fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Verdana, Arial, Helvetica, sans-serif',fontSize:"12px"},backgroundColor:"#FFFFFF",plotBorderColor:"#C0C0C0"},title:{text:"Chart title",x:0,y:20,align:"center",style:{color:"#3E576F",fontSize:"16px"}},subtitle:{text:"",x:0,y:40,align:"center",style:{color:"#6D869F"}},plotOptions:{line:{allowPointSelect:false,showCheckbox:false,animation:true,events:{},lineWidth:2,shadow:true,marker:{enabled:true,lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:v(X,{enabled:false,y:-6,formatter:function(){return this.y}}),showInLegend:true,states:{hover:{lineWidth:3,marker:{}},select:{marker:{}}},stickyTracking:true}},labels:{style:{position:aX,color:"#3E576F"}},legend:{enabled:true,align:"center",layout:"horizontal",labelFormatter:function(){return this.name},borderWidth:1,borderColor:"#909090",borderRadius:5,shadow:false,style:{padding:"5px"},itemStyle:{cursor:"pointer",color:"#3E576F"},itemHoverStyle:{cursor:"pointer",color:"#000000"},itemHiddenStyle:{color:"#C0C0C0"},itemCheckboxStyle:{position:aX,width:"13px",height:"13px"},symbolWidth:16,symbolPadding:5,verticalAlign:"bottom",x:15,y:-15},loading:{hideDuration:100,labelStyle:{fontWeight:"bold",position:k,top:"1em"},showDuration:100,style:{position:aX,backgroundColor:"white",opacity:0.5,textAlign:"center"}},tooltip:{enabled:true,formatter:function(){var ba=this,M=ba.series,a9=M.xAxis,L=ba.x;return"<b>"+(ba.point.name||M.name)+"</b><br/>"+(i(L)?"X value: "+(a9&&a9.options.type=="datetime"?az(null,L):L)+"<br/>":"")+"Y value: "+ba.y},backgroundColor:"rgba(255, 255, 255, .85)",borderWidth:2,borderRadius:5,shadow:true,snap:10,style:{color:"#333333",fontSize:"12px",padding:"5px",whiteSpace:"nowrap"}},toolbar:{itemStyle:{color:"#4572A7",cursor:"pointer"}},credits:{enabled:true,text:"Highcharts.com",href:"http://www.highcharts.com",style:{cursor:"pointer",color:"#909090",fontSize:"10px"}}};var al={dateTimeLabelFormats:{second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b '%y",year:"%Y"},endOnTick:false,gridLineColor:"#C0C0C0",labels:X,lineColor:"#C0D0E0",lineWidth:1,max:null,min:null,minPadding:0.01,maxPadding:0.01,maxZoom:null,minorGridLineColor:"#E0E0E0",minorGridLineWidth:1,minorTickColor:"#A0A0A0",minorTickLength:2,minorTickPosition:"outside",minorTickWidth:1,showFirstLabel:true,showLastLabel:false,startOfWeek:1,startOnTick:false,tickColor:"#C0D0E0",tickLength:5,tickmarkPlacement:"between",tickPixelInterval:100,tickPosition:"outside",tickWidth:1,title:{align:"middle",margin:35,style:{color:"#6D869F",fontWeight:"bold"}},type:"linear"},aS=v(al,{endOnTick:true,gridLineWidth:1,tickPixelInterval:72,showLastLabel:true,labels:{align:"right",x:-8,y:3},lineWidth:0,maxPadding:0.05,minPadding:0.05,startOnTick:true,tickWidth:0,title:{margin:40,rotation:270,text:"Y-values"}}),af={labels:{align:"right",x:-8,y:3},title:{rotation:270}},z={labels:{align:"left",x:8,y:3},title:{rotation:90}},a0={labels:{align:"center",x:0,y:14},title:{rotation:0}},r=v(a0,{labels:{y:-5}});
var a8=aG.plotOptions,a3=a8.line;a8.spline=v(a3);a8.scatter=v(a3,{lineWidth:0,states:{hover:{lineWidth:0}}});a8.area=v(a3,{});a8.areaspline=v(a8.area);a8.column=v(a3,{borderColor:"#FFFFFF",borderWidth:1,borderRadius:0,groupPadding:0.2,marker:null,pointPadding:0.1,minPointLength:0,states:{hover:{brightness:0.1,shadow:false},select:{color:"#C0C0C0",borderColor:"#000000",shadow:false}}});a8.bar=v(a8.column,{dataLabels:{align:"left",x:5,y:0}});a8.pie=v(a3,{borderColor:"#FFFFFF",borderWidth:1,center:["50%","50%"],colorByPoint:true,legendType:"point",marker:null,size:"90%",slicedOffset:10,states:{hover:{brightness:0.1,shadow:false}}});aC();function aK(a9,L){var M=function(){};M.prototype=new a9();av(M.prototype,L);return M}var u=function(M){var bb=[],L;function bd(be){if((L=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/.exec(be))){bb=[parseInt(L[1],10),parseInt(L[2],10),parseInt(L[3],10),parseFloat(L[4],10)]}else{if((L=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(be))){bb=[parseInt(L[1],16),parseInt(L[2],16),parseInt(L[3],16),1]}}}function ba(bf){var be;if(bb&&!isNaN(bb[0])){if(bf=="rgb"){be="rgb("+bb[0]+","+bb[1]+","+bb[2]+")"}else{if(bf=="a"){be=bb[3]}else{be="rgba("+bb.join(",")+")"}}}else{be=M}return be}function bc(bf){if(typeof bf=="number"&&bf!==0){for(var be=0;be<3;be++){bb[be]+=parseInt(bf*255,10);if(bb[be]<0){bb[be]=0}if(bb[be]>255){bb[be]=255}}}return this}function a9(be){bb[3]=be;return this}bd(M);return{get:ba,brighten:bc,setOpacity:a9}};function h(ba,a9,bg,bf){var L=aG.lang,M=ba,be=isNaN(a9=a5(a9))?2:a9,bd=bg===undefined?L.decimalPoint:bg,bh=bf===undefined?L.thousandsSep:bf,bi=M<0?"-":"",bc=parseInt(M=a5(+M||0).toFixed(be),10)+"",bb=(bb=bc.length)>3?bb%3:0;return bi+(bb?bc.substr(0,bb)+bh:"")+bc.substr(bb).replace(/(\d{3})(?=\d)/g,"$1"+bh)+(be?bd+a5(M-bc).toFixed(be).slice(2):"")}az=function(bi,bd,bb){function M(bm){return bm.toString().replace(/^([0-9])$/,"0$1")}if(!i(bd)||isNaN(bd)){return"Invalid date"}bi=b(bi,"%Y-%m-%d %H:%M:%S");var a9=new Date(bd*I),bh=a9[aM](),be=a9[ah](),bk=a9[a1](),bc=a9[aN](),bl=a9[aj](),L=aG.lang,bg=L.weekdays,bf=L.months,ba={a:bg[be].substr(0,3),A:bg[be],d:M(bk),e:bk,b:bf[bc].substr(0,3),B:bf[bc],m:M(bc+1),y:bl.toString().substr(2,2),Y:bl,H:M(bh),I:M((bh%12)||12),l:(bh%12)||12,M:M(a9[H]()),p:bh<12?"AM":"PM",P:bh<12?"am":"pm",S:M(a9.getSeconds())};for(var bj in ba){bi=bi.replace("%"+bj,ba[bj])}return bb?bi.substr(0,1).toUpperCase()+bi.substr(1):bi};function p(L){var M={x:L.offsetLeft,y:L.offsetTop};while(L.offsetParent){L=L.offsetParent;M.x+=L.offsetLeft;M.y+=L.offsetTop;if(L!=G.body&&L!=G.documentElement){M.x-=L.scrollLeft;M.y-=L.scrollTop}}return M}function g(){}g.prototype={init:function(L,M){this.element=G.createElementNS("http://www.w3.org/2000/svg",M);this.renderer=L},animate:function(M,L){ae(this,M,L)},attr:function(ba,M){var bj,bi,bb,L,bc=this.element,bh=bc.nodeName,bf=this.renderer,bg,a9=this.shadows,be,bd=this;if(typeof ba=="string"&&i(M)){bj=ba;ba={};ba[bj]=M}if(typeof ba=="string"){bj=ba;if(bh=="circle"){bj={x:"cx",y:"cy"}[bj]||bj}else{if(bj=="strokeWidth"){bj="stroke-width"}}bd=parseFloat(Z(bc,bj)||this[bj]||0)}else{for(bj in ba){bi=ba[bj];if(bj=="d"){if(bi&&bi.join){bi=bi.join(" ")}if(/(NaN|  |^$)/.test(bi)){bi="M 0 0"}}else{if(bj=="x"&&bh=="text"){for(bb=0;bb<bc.childNodes.length;bb++){L=bc.childNodes[bb];if(Z(L,"x")==Z(bc,"x")){Z(L,"x",bi)}}}else{if(bj=="fill"){bi=bf.color(bi,bc,bj)}else{if(bh=="circle"){bj={x:"cx",y:"cy"}[bj]||bj}else{if(bj=="translateX"||bj=="translateY"){this[bj]=bi;this.updateTransform();bg=true}else{if(bj=="stroke"){bi=bf.color(bi,bc,bj)}else{if(bj=="isTracker"){this[bj]=bi}}}}}}}if(bj=="strokeWidth"){bj="stroke-width"}if(ax&&bj=="stroke-width"&&bi===0){bi=0.000001}if(this.symbolName&&/^(x|y|r|start|end|innerR)/.test(bj)){if(!be){this.symbolAttr(ba);be=true}bg=true}if(a9&&/^(width|height|visibility|x|y|d)$/.test(bj)){bb=a9.length;while(bb--){Z(a9[bb],bj,bi)}}if(bj=="text"){bf.buildText(bc,bi)}else{if(!bg){Z(bc,bj,bi)
}}}}return bd},symbolAttr:function(L){var M=this;M.x=b(L.x,M.x);M.y=parseFloat(b(L.y,M.y));M.r=b(L.r,M.r);M.start=b(L.start,M.start);M.end=b(L.end,M.end);M.width=b(L.width,M.width);M.height=parseFloat(b(L.height,M.height));M.innerR=b(L.innerR,M.innerR);M.attr({d:M.renderer.symbols[M.symbolName](M.x,M.y,M.r,{start:M.start,end:M.end,width:M.width,height:M.height,innerR:M.innerR})})},clip:function(L){return this.attr("clip-path","url("+this.renderer.url+"#"+L.id+")")},css:function(M){var L=this;if(M&&M.color){M.fill=M.color}M=av(L.styles,M);L.attr({style:aV(M)});L.styles=M;return L},on:function(L,M){this.element["on"+L]=M;return this},translate:function(L,a9){var M=this;M.translateX=L;M.translateY=a9;M.updateTransform();return M},invert:function(){var L=this;L.inverted=true;L.updateTransform();return L},updateTransform:function(){var bb=this,ba=bb.translateX||0,a9=bb.translateY||0,L=bb.inverted,M=[];if(L){ba+=bb.attr("width");a9+=bb.attr("height")}if(ba||a9){M.push("translate("+ba+","+a9+")")}if(L){M.push("rotate(90) scale(-1,1)")}if(M.length){Z(bb.element,"transform",M.join(" "))}},toFront:function(){var L=this.element;L.parentNode.appendChild(L);return this},getBBox:function(){return this.element.getBBox()},show:function(){return this.attr({visibility:ak})},hide:function(){return this.attr({visibility:ar})},add:function(be){var bc=this.renderer,bb=be||bc,ba=bb.element||bc.box,bg=ba.childNodes,a9=this.element,bd=Z(a9,"zIndex"),bf,L,M;this.parentInverted=be&&be.inverted;if(bd){bb.handleZ=true;bd=parseInt(bd,10)}if(bb.handleZ){for(M=0;M<bg.length;M++){bf=bg[M];L=Z(bf,"zIndex");if(bf!=a9&&(parseInt(L,10)>bd||(!i(bd)&&i(L)))){ba.insertBefore(a9,bf);return this}}}ba.appendChild(a9);return this},destroy:function(){var bb=this,a9=bb.element,ba=bb.shadows,L=a9.parentNode,M;a9.onclick=a9.onmouseout=a9.onmouseover=a9.onmousemove=null;aO(bb);if(L){L.removeChild(a9)}if(ba){a6(ba,function(bc){L=bc.parentNode;if(L){L.removeChild(bc)}})}for(M in bb){delete bb[M]}return null},empty:function(){var M=this.element,a9=M.childNodes,L=a9.length;while(L--){M.removeChild(a9[L])}},shadow:function(L){var bb=[],ba,bc,a9=this.element,M=this.parentInverted?"(-1,-1)":"(1,1)";if(L){for(ba=1;ba<=3;ba++){bc=a9.cloneNode(0);Z(bc,{isShadow:"true",stroke:"rgb(0, 0, 0)","stroke-opacity":0.05*ba,"stroke-width":7-2*ba,transform:"translate"+M,fill:ag});a9.parentNode.insertBefore(bc,a9);bb.push(bc)}this.shadows=bb}return this}};var m=function(){this.init.apply(this,arguments)};m.prototype={init:function(M,a9,L){var ba=G.createElementNS("http://www.w3.org/2000/svg","svg"),bb=location;Z(ba,{width:a9,height:L,xmlns:"http://www.w3.org/2000/svg",version:"1.1"});M.appendChild(ba);this.Element=g;this.box=ba;this.url=aY?"":bb.href.replace(/#.*?$/,"");this.defs=this.createElement("defs").add()},createElement:function(M){var L=new this.Element();L.init(this,M);return L},buildText:function(be,bd){var M=bd.toString().replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">').replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(/<br[^>]?>/g),bc=be.childNodes,L=/style="([^"]+)"/,ba=/href="([^"]+)"/,bb=Z(be,"x"),a9=bc.length;while(a9--){be.removeChild(bc[a9])}a6(M,function(bf,bi){var bh,bg=0;bf=bf.replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||");bh=bf.split("|||");a6(bh,function(bk){if(bk!==""||bh.length==1){var bj={},bl=G.createElementNS("http://www.w3.org/2000/svg","tspan");if(L.test(bk)){Z(bl,"style",bk.match(L)[1].replace(/(;| |^)color([ :])/,"$1fill$2"))}if(ba.test(bk)){Z(bl,"onclick",'location.href="'+bk.match(ba)[1]+'"');aw(bl,{cursor:"pointer"})}bk=bk.replace(/<(.|\n)*?>/g,"");bl.appendChild(G.createTextNode(bk||" "));if(!bg){bj.x=bb}else{bj.dx=3}if(bi&&!bg){bj.dy=16}Z(bl,bj);be.appendChild(bl);bg++}})})},crispLine:function(M,L){if(M[1]==M[4]){M[1]=M[4]=s(M[1])+(L%2/2)}if(M[2]==M[5]){M[2]=M[5]=s(M[2])+(L%2/2)}return M},path:function(L){return this.createElement("path").attr({d:L,fill:ag})
},circle:function(M,ba,a9){var L=typeof M=="object"?M:{x:M,y:ba,r:a9};return this.createElement("circle").attr(L)},arc:function(L,bc,ba,a9,bb,M){if(typeof L=="object"){bc=L.y;ba=L.r;a9=L.innerR;bb=L.start;M=L.end;L=L.x}return this.symbol("arc",L||0,bc||0,ba||0,{innerR:a9||0,start:bb||0,end:M||0})},rect:function(a9,be,ba,M,bc,bd){if(arguments.length>1){var bb=(bd||0)%2/2;a9=s(a9||0)+bb;be=s(be||0)+bb;ba=s((ba||0)-2*bb);M=s((M||0)-2*bb)}var L=typeof a9=="object"?a9:{x:a9,y:be,width:aL(ba,0),height:aL(M,0)};return this.createElement("rect").attr(av(L,{rx:bc||L.r,ry:bc||L.r,fill:ag}))},g:function(L){return this.createElement("g").attr(i(L)&&{"class":y+L})},image:function(bb,M,bc,ba,L){var a9=this.createElement("image").attr({x:M,y:bc,width:ba,height:L,preserveAspectRatio:ag});a9.element.setAttributeNS("http://www.w3.org/1999/xlink","href",bb);return a9},symbol:function(M,be,bc,bb,bg){var ba,L=this.symbols[M],bf=L&&L(be,bc,bb,bg),a9=/^url\((.*?)\)$/,bd;if(bf){ba=this.path(bf);av(ba,{symbolName:M,x:be,y:bc,r:bb});if(bg){av(ba,bg)}}else{if(a9.test(M)){bd=M.match(a9)[1];ba=this.image(bd).attr({visibility:ar});aq("img",{onload:function(){var bh=this,bi=ap[bh.src]||[bh.width,bh.height];ba.attr({x:s(be-bi[0]/2)+ai,y:s(bc-bi[1]/2)+ai,width:bi[0],height:bi[1],visibility:"inherit"})},src:bd})}else{ba=this.circle(be,bc,bb)}}return ba},symbols:{square:function(a9,ba,M){var L=0.707*M;return[at,a9-L,ba-L,au,a9+L,ba-L,a9+L,ba+L,a9-L,ba+L,"Z"]},triangle:function(M,a9,L){return[at,M,a9-1.33*L,au,M+L,a9+0.67*L,M-L,a9+0.67*L,"Z"]},"triangle-down":function(M,a9,L){return[at,M,a9+1.33*L,au,M-L,a9-0.67*L,M+L,a9-0.67*L,"Z"]},diamond:function(M,a9,L){return[at,M,a9-L,au,M+L,a9,M,a9+L,M-L,a9,"Z"]},arc:function(bh,bg,be,bj){var bc=Math.PI,a9=bj.start,ba=bj.end-0.000001,bf=bj.innerR,bd=aR(a9),L=B(a9),M=aR(ba),bi=B(ba),bb=bj.end-a9<bc?0:1;return[at,bh+be*bd,bg+be*L,"A",be,be,0,bb,1,bh+be*M,bg+be*bi,au,bh+bf*M,bg+bf*bi,"A",bf,bf,0,bb,0,bh+bf*bd,bg+bf*L,"Z"]}},clipRect:function(M,bd,a9,L){var bc,bb=y+N++,ba=this.createElement("clipPath").attr({id:bb}).add(this.defs);bc=this.rect(M,bd,a9,L,0).add(ba);bc.id=bb;return bc},color:function(bc,bb,M){var bi,ba=/^rgba/;if(bc&&bc.linearGradient){var bg=this,bd="linearGradient",bh=bc[bd],a9=y+N++,L,bf,be;L=bg.createElement(bd).attr({id:a9,gradientUnits:"userSpaceOnUse",x1:bh[0],y1:bh[1],x2:bh[2],y2:bh[3]}).add(bg.defs);a6(bc.stops,function(bj){if(ba.test(bj[1])){bi=u(bj[1]);bf=bi.get("rgb");be=bi.get("a")}else{bf=bj[1];be=1}bg.createElement("stop").attr({offset:bj[0],"stop-color":bf,"stop-opacity":be}).add(L)});return"url("+this.url+"#"+a9+")"}else{if(ba.test(bc)){bi=u(bc);Z(bb,M+"-opacity",bi.get("a"));return bi.get("rgb")}else{return bc}}},text:function(bc,be,bd,M,bg,ba){M=M||{};ba=ba||"left";bg=bg||0;var L,a9,bf=M.color||"#000000",bb=aG.chart.style;be=s(b(be,0));bd=s(b(bd,0));av(M,{fontFamily:M.fontFamily||bb.fontFamily,fontSize:M.fontSize||bb.fontSize});a9=aV(M);L={x:be,y:bd,text:bc,fill:bf,style:a9.replace(/"/g,"'")};if(bg||ba!="left"){L=av(L,{"text-anchor":{left:"start",center:"middle",right:"end"}[ba],transform:"rotate("+bg+" "+be+" "+bd+")"})}return this.createElement("text").attr(L)}};var a4;if(!c){var aI=aK(g,{init:function(a9,ba){var L=["<",ba,' filled="f" stroked="f"'],M=["position: ",aX,";"];if(ba=="shape"||ba==am){M.push("left:0;top:0;width:10px;height:10px")}L.push(' style="',M.join(""),'"/>');if(ba){L=ba==am||ba=="span"||ba=="img"?L.join(""):a9.prepVML(L);this.element=aq(L)}this.renderer=a9},add:function(bb){var be=this,bd=be.renderer,a9=be.element,bc=bd.box,M=bb&&bb.inverted,ba,L=bb?bb.element||bb:bc;if(M){ba=L.style;aw(a9,{flip:"x",left:parseInt(ba.width,10)-10,top:parseInt(ba.height,10)-10,rotation:-90})}L.appendChild(a9);return be},attr:function(bb,L){var bm,bl,bc,bd=this.element,M=bd.style,bk=bd.nodeName,bi=this.renderer,ba=this.symbolName,bh,a9=this.shadows,be=G.documentMode,bj,bf=this;if(typeof bb=="string"&&i(L)){bm=bb;bb={};bb[bm]=L}if(typeof bb=="string"){bm=bb;if(bm=="strokeWidth"||bm=="stroke-width"){bf=bd.strokeweight
}else{bf=b(this[bm],parseInt(M[{x:"left",y:"top"}[bm]||bm],10))}}else{for(bm in bb){bl=bb[bm];bj=false;if(ba&&/^(x|y|r|start|end|width|height|innerR)/.test(bm)){if(!bh){this.symbolAttr(bb);bh=true}bj=true}else{if(bm=="d"){bc=bl.length;var bg=[];while(bc--){if(typeof bl[bc]=="number"){bg[bc]=s(bl[bc]*10)-5}else{if(bl[bc]=="Z"){bg[bc]="x"}else{bg[bc]=bl[bc]}}}bl=bg.join(" ")||"x";bd.path=bl;if(a9){bc=a9.length;while(bc--){a9[bc].path=bl}}bj=true}else{if(bm=="zIndex"||bm=="visibility"){M[bm]=bl;if(be==8&&bm=="visibility"&&bk=="DIV"){a6(bd.childNodes,function(bn){aw(bn,{visibility:bl})})}bj=true}else{if(/^(width|height)$/.test(bm)){M[bm]=bl;if(this.updateClipping){this.updateClipping()}bj=true}else{if(/^(x|y)$/.test(bm)){if(bm=="y"&&bd.tagName=="SPAN"&&bd.lineHeight){bl-=bd.lineHeight}M[{x:"left",y:"top"}[bm]]=bl}else{if(bm=="class"){bd.className=bl}else{if(bm=="stroke"){bl=bi.color(bl,bd,bm);bm="strokecolor"}else{if(bm=="stroke-width"||bm=="strokeWidth"){bd.stroked=bl?true:false;bm="strokeweight";if(typeof bl=="number"){bl+=ai}}else{if(bm=="fill"){if(bk=="SPAN"){M.color=bl}else{bd.filled=bl!=ag?true:false;bl=bi.color(bl,bd,bm);bm="fillcolor"}}else{if(bm=="translateX"||bm=="translateY"){this[bm]=L;this.updateTransform();bj=true}}}}}}}}}}if(a9&&bm=="visibility"){bc=a9.length;while(bc--){a9[bc].style[bm]=bl}}if(bm=="text"){bd.innerHTML=bl}else{if(!bj){if(be==8){bd[bm]=bl}else{Z(bd,bm,bl)}}}}}return bf},clip:function(M){var ba=this,a9=M.members,L=a9.length;a9.push(ba);ba.destroyClip=function(){a9.splice(L,1)};return ba.css(M.getCSS(ba.inverted))},css:function(L){var M=this;aw(M.element,L);return M},destroy:function(){var L=this;if(L.destroyClip){L.destroyClip()}g.prototype.destroy.apply(this)},empty:function(){var M=this.element,ba=M.childNodes,L=ba.length,a9;while(L--){a9=ba[L];a9.parentNode.removeChild(a9)}},getBBox:function(){var a9=this.element,M,ba=a9.offsetWidth,L=a9.parentNode;if(!ba){G.body.appendChild(a9)}M={x:a9.offsetLeft,y:a9.offsetTop,width:a9.offsetWidth,height:a9.offsetHeight};if(!ba){if(L){L.appendChild(a9)}else{G.body.removeChild(a9)}}return M},on:function(L,M){this.element["on"+L]=function(){var a9=aB.event;a9.target=a9.srcElement;M(a9)};return this},updateTransform:function(){var a9=this,M=a9.translateX||0,L=a9.translateY||0;if(M||L){a9.css({left:M,top:L})}},shadow:function(bd){var M=[],a9,ba=this.element,bb=this.renderer,bc,L=ba.style,be,bf=ba.path;if(""+ba.path==""){bf="x"}if(bd){for(a9=1;a9<=3;a9++){be=['<shape isShadow="true" strokeweight="',(7-2*a9),'" filled="false" path="',bf,'" coordsize="100,100" style="',ba.style.cssText,'" />'];bc=aq(bb.prepVML(be),null,{left:parseInt(L.left,10)+1,top:parseInt(L.top,10)+1});be=['<stroke color="black" opacity="',(0.05*a9),'"/>'];aq(bb.prepVML(be),null,null,bc);ba.parentNode.insertBefore(bc,ba);M.push(bc)}this.shadows=M}return this}});a4=function(){this.init.apply(this,arguments)};a4.prototype=v(m.prototype,{isIE8:e.indexOf("MSIE 8.0")>-1,init:function(M,a9,L){this.width=a9;this.height=L;this.box=aq(am,null,{width:a9+ai,height:L+ai},M);this.Element=aI;if(!G.namespaces.hcv){G.namespaces.add("hcv","urn:schemas-microsoft-com:vml");G.createStyleSheet().cssText="hcv\\:fill, hcv\\:path, hcv\\:textpath, hcv\\:shape, hcv\\:stroke, hcv\\:line { behavior:url(#default#VML); display: inline-block; } "}},clipRect:function(M,bb,ba,L){var a9=this.createElement();return av(a9,{members:[],element:{style:{left:M,top:bb,width:ba,height:L}},getCSS:function(be){var bd=a9.element.style,bi=bd.top,bh=bd.left,bg=bh+bd.width,bc=bi+bd.height,bf={clip:"rect("+(be?bh:bi)+"px,"+(be?bc:bg)+"px,"+(be?bg:bc)+"px,"+(be?bi:bh)+"px)"};if(!be&&G.documentMode==8){av(bf,{width:bg+ai,height:bc+ai})}return bf},updateClipping:function(){a6(a9.members,function(bc){bc.css(a9.getCSS(bc.inverted))})}})},color:function(bb,a9,L){var bi,M=/^rgba/,bk;if(bb&&bb.linearGradient){var bf,be,bh=bb.linearGradient,ba,bj,bd,bg,bc;a6(bb.stops,function(bm,bl){if(M.test(bm[1])){bi=u(bm[1]);bf=bi.get("rgb");be=bi.get("a")}else{bf=bm[1];
be=1}if(!bl){bj=bf;bd=be}else{bg=bf;bc=be}});ba=90-U.atan((bh[3]-bh[1])/(bh[2]-bh[0]))*180/U.PI;bk=["<",L,' colors="0% ',bj,",100% ",bg,'" angle="',ba,'" opacity="',bc,'" o:opacity2="',bd,'" type="gradient" focus="100%" />'];aq(this.prepVML(bk),null,null,a9)}else{if(M.test(bb)){bi=u(bb);bk=["<",L,' opacity="',bi.get("a"),'"/>'];aq(this.prepVML(bk),null,null,a9);return bi.get("rgb")}else{return bb}}},prepVML:function(L){var a9="display:inline-block;behavior:url(#default#VML);",bc=this.isIE8;try{L=L.join("")}catch(bb){var ba="",M=0;for(M;M<L.length;M++){ba+=L[M]}L=ba}if(bc){L=L.replace("/>",' xmlns="urn:schemas-microsoft-com:vml" />');if(L.indexOf('style="')==-1){L=L.replace("/>",' style="'+a9+'" />')}else{L=L.replace('style="','style="'+a9)}}else{L=L.replace("<","<hcv:")}return L},text:function(bj,be,bd,bn,bk,bl){bn=bn||{};bl=bl||"left";bk=bk||0;var bg,bp,br,a9=s(parseInt(bn.fontSize||12,10)*1.2),bf=aG.chart.style;be=s(be);bd=s(bd);av(bn,{color:bn.color||"#000000",whiteSpace:"nowrap",fontFamily:bn.fontFamily||bf.fontFamily,fontSize:bn.fontSize||bf.fontSize});if(!bk){bg=this.createElement("span").attr({x:be,y:bd-a9,text:bj});bp=bg.element;bp.lineHeight=a9;aw(bp,bn);if(bl!="left"){br=bg.getBBox().width;aw(bp,{left:(be-br/{right:1,center:2}[bl])+ai})}}else{var bs=(bk||0)*U.PI*2/360,bc=aR(bs),bh=B(bs),ba=10,bi=a9*0.3,bb=bl=="left",bq=bl=="right",bo=bb?be:be-ba*bc,bm=bq?be:be+ba*bc,M=bb?bd:bd-ba*bh,L=bq?bd:bd+ba*bh;bo+=bi*bh;bm+=bi*bh;M-=bi*bc;L-=bi*bc;if(a5(bo-bm)<0.1){bo+=0.1}if(a5(M-L)<0.1){M+=0.1}bg=this.createElement("line").attr({from:bo+", "+M,to:bm+", "+L});bp=bg.element;aq("hcv:fill",{on:true,color:bn.color},null,bp);aq("hcv:path",{textpathok:true},null,bp);aq('<hcv:textpath style="v-text-align:'+bl+";"+aV(bn).replace(/"/g,"'")+'" on="true" string="'+bj.toString().replace(/<br[^>]?>/g,"\n")+'">',null,null,bp)}return bg},path:function(L){return this.createElement("shape").attr({coordsize:"100 100",d:L})},circle:function(L,a9,M){return this.path(this.symbols.circle(L,a9,M))},g:function(L){var a9,M;if(L){M={className:y+L,"class":y+L}}a9=this.createElement(am).attr(M);return a9},image:function(ba,M,bb,a9,L){return this.createElement("img").attr({src:ba}).css({left:M,top:bb,width:a9,height:L})},rect:function(M,bd,a9,L,bb,bc){if(arguments.length>1){var ba=(bc||0)%2/2;M=s(M||0)+ba;bd=s(bd||0)+ba;a9=s((a9||0)-2*ba);L=s((L||0)-2*ba)}if(typeof M=="object"){bd=M.y;a9=M.width;L=M.height;bb=M.r;M=M.x}return this.symbol("rect",M||0,bd||0,bb||0,{width:a9||0,height:L||0})},symbol:function(ba,M,bc,L){var bb,a9=/^url\((.*?)\)$/;if(a9.test(ba)){bb=this.createElement("img").attr({onload:function(){var bd=this,be=[bd.width,bd.height];aw(bd,{left:s(M-be[0]/2),top:s(bc-be[1]/2)})},src:ba.match(a9)[1]})}else{bb=m.prototype.symbol.apply(this,arguments)}return bb},symbols:{arc:function(bg,bf,bd,bi){var ba=bi.start,M=bi.end,bb=M-ba==2*Math.PI?M-0.001:M,bc=aR(ba),L=B(ba),a9=aR(bb),bh=B(bb),be=bi.innerR;if(M-ba===0){return["x"]}return["wa",bg-bd,bf-bd,bg+bd,bf+bd,bg+bd*bc,bf+bd*L,bg+bd*a9,bf+bd*bh,"at",bg-be,bf-be,bg+be,bf+be,bg+be*a9,bf+be*bh,bg+be*bc,bf+be*L,"x","e"]},circle:function(L,a9,M){return["wa",L-M,a9-M,L+M,a9+M,L+M,a9,L+M,a9,"e"]},rect:function(be,bd,bc,a9){var bb=a9.width,L=a9.height,ba=be+bb,M=bd+L;bc=ab(bc,bb,L);return[at,be+bc,bd,au,ba-bc,bd,"wa",ba-2*bc,bd,ba,bd+2*bc,ba-bc,bd,ba,bd+bc,au,ba,M-bc,"wa",ba-2*bc,M-2*bc,ba,M,ba,M-bc,ba-bc,M,au,be+bc,M,"wa",be,M-2*bc,be+2*bc,M,be+bc,M,be,M-bc,au,be,bd+bc,"wa",be,bd,be+2*bc,bd+2*bc,be,bd+bc,be+bc,bd,"x","e"]}}})}var aE=c?m:a4;function aZ(bz,bP){al=v(al,aG.xAxis);aS=v(aS,aG.yAxis);aG.xAxis=aG.yAxis=null;bz=v(aG,bz);var bA=bz.chart,by=bA.margin,bf=typeof by=="number"?[by,by,by,by]:by,bc=b(bA.marginTop,bf[0]),b6=b(bA.marginRight,bf[1]),bG=b(bA.marginBottom,bf[2]),bD=b(bA.marginLeft,bf[3]),bp,bV,bI,b5,bv,b1,b4=this,bu=bA.events,bx,a9,b3,bJ,L,b0,bj,bU,ba,bN,bM,bL,bl,bQ,bS,b2=bA.showAxes,bT=[],bo,bi=[],bb,bK,bh,bH,bY,bw;function bt(c1,cr){var cY=cr.isX,cw=cr.opposite,cf=bb?!cY:cY,cW={bar:{},column:{},area:{},areaspline:{},line:{}};
cr=v(cY?al:aS,cf?(cw?r:a0):(cw?z:af),cr);var cm=this,cB=cr.type=="datetime",cN=cr.offset||0,c6=cY?"x":"y",cF=cf?ba:bU,cz,cx=cf?bD:bG,cq,cX,b7,cA,cU,c2,cl,co=null,c3=null,cS=cr.minPadding,ce=cr.maxPadding,cM=i(cr.linkedTo),cC,c4,cE,cu=cr.events,ch,cs=cr.plotBands||[],cK=cr.plotLines||[],b9,cR,cL,c5,ck,cO,cG=cr.labels.formatter||function(){var c7=this.value;return cO?az(cO,c7):c7},cn=cr.categories||(cY&&c1.columnCount),c0=cr.reversed,cH=(cn&&cr.tickmarkPlacement=="between")?0.5:0;function cV(){var c7=[],c8;b7=cA=null;cU=[];a6(bi,function(db){c8=false;a6(["xAxis","yAxis"],function(dc){if(db.isCartesian&&(dc=="xAxis"&&cY||dc=="yAxis"&&!cY)&&((db.options[dc]==cr.index)||(db.options[dc]===ay&&cr.index===0))){db[dc]=cm;cU.push(db);c8=true}});if(!db.visible&&bA.ignoreHiddenSeries){c8=false}if(c8){var da,c9;if(!cY){da=db.options.stacking;cE=da=="percent";if(da){c9=c7[db.type]||[];c7[db.type]=c9}if(cE){b7=0;cA=99}}if(db.isCartesian){a6(db.data,function(dc,de){var dg=dc.x,df=dc.y;if(b7===null){b7=cA=dc[c6]}if(cY){if(dg>cA){cA=dg}else{if(dg<b7){b7=dg}}}else{if(i(df)){if(da){c9[dg]=c9[dg]?c9[dg]+df:df}var dd=c9?c9[dg]:df;if(!cE){if(dd>cA){cA=dd}else{if(dd<b7){b7=dd}}}if(da){cW[db.type][dg]={total:dd,cum:dd}}}}});if(/(area|column|bar)/.test(db.type)&&!cY){if(b7>=0){b7=0;cC=true}else{if(cA<0){cA=0;c4=true}}}}}})}function ca(dc,da,c9){var c8=1,c7=0,db;if(c9){c8*=-1;c7=cF}if(c0){c8*=-1;c7-=c8*cF}if(c3===ay){db=null}else{if(da){if(c0){dc=cF-dc}db=dc/cz+c3}else{db=c8*(dc-c3)*cz+c7}}return db}function cI(de,da,c8){if(c8){var c9,dd,c7,dc,db=ca(de),df;c9=c7=db+cx;dd=dc=b1-db-cx;if(cf){dd=bc;dc=b1-bG;if(c9<bD||c9>bD+ba){df=true}}else{c9=bD;c7=bv-b6;if(dd<bc||dd>bc+bU){df=true}}if(!df){bK.path(bK.crispLine([at,c9,dd,au,c7,dc],c8)).attr({stroke:da,"stroke-width":c8}).add(cX)}}}function cp(da,c9,c7){da=aL(da,c3);c9=ab(c9,co);var c8=(c9-da)*cz;cI(da+(c9-da)/2,c7,c8)}function cg(di,dc,db,c9,df,c7,de){var da,dj,c8,dh,dg,dd=cr.labels;if(dc=="inside"){df=-df}if(cw){df=-df}da=c8=ca(di+cH)+cx;dj=dh=b1-ca(di+cH)-cx;if(cf){dj=b1-bG-(cw?bU:0)+cN;dh=dj+df}else{da=bD+(cw?ba:0)+cN;c8=da-df}if(c9){bK.path(bK.crispLine([at,da,dj,au,c8,dh],c9)).attr({stroke:db,"stroke-width":c9}).add(cq)}if(c7&&dd.enabled){dg=cG.call({index:de,isFirst:di==c5[0],isLast:di==c5[c5.length-1],dateTimeLabelFormat:cO,value:(cn&&cn[di]?cn[di]:di)});if(dg||dg===0){da=da+dd.x-(cH&&cf?cH*cz*(c0?-1:1):0);dj=dj+dd.y-(cH&&!cf?cH*cz*(c0?1:-1):0);bK.text(dg,da,dj,dd.style,dd.rotation,dd.align).add(cq)}}}function cT(c7,da){var c9;cL=da?1:U.pow(10,P(U.log(c7)/U.LN10));c9=c7/cL;if(!da){da=[1,2,2.5,5,10];if(cr.allowDecimals===false){if(cL==1){da=[1,2,5,10]}else{if(cL<=0.1){da=[1/cL]}}}}for(var c8=0;c8<da.length;c8++){c7=da[c8];if(c9<=(da[c8]+(da[c8+1]||da[c8]))/2){break}}c7*=cL;return c7}function cZ(){c5=[];var dl,de=aG.global.useUTC,dh=1000/I,db=60000/I,c7=3600000/I,dg=24*3600000/I,df=7*24*3600000/I,dp=30*24*3600000/I,dc=31556952000/I,dj=[["second",dh,[1,2,5,10,15,30]],["minute",db,[1,2,5,10,15,30]],["hour",c7,[1,2,3,4,6,8,12]],["day",dg,[1,2]],["week",df,[1,2]],["month",dp,[1,2,3,4,6]],["year",dc,null]],dd=dj[6],dq=dd[1],c8=dd[2];for(dl=0;dl<dj.length;dl++){dd=dj[dl];dq=dd[1];c8=dd[2];if(dj[dl+1]){var dk=(dq*c8[c8.length-1]+dj[dl+1][1])/2;if(b9<=dk){break}}}if(dq==dc&&b9<5*dq){c8=[1,2,5]}var dn=cT(b9/dq,c8),dr,da=new Date(c3*I);da.setMilliseconds(0);if(dq>=dh){da.setSeconds(dq>=db?0:dn*P(da.getSeconds()/dn))}if(dq>=db){da[aF](dq>=c7?0:dn*P(da[H]()/dn))}if(dq>=c7){da[E](dq>=dg?0:dn*P(da[aM]()/dn))}if(dq>=dg){da[aQ](dq>=dp?1:dn*P(da[a1]()/dn))}if(dq>=dp){da[F](dq>=dc?0:dn*P(da[aN]()/dn));dr=da[aj]()}if(dq>=dc){dr-=dr%dn;da[x](dr)}if(dq==df){da[aQ](da[a1]()-da[ah]()+cr.startOfWeek)}dl=1;dr=da[aj]();var c9=da.getTime()/I,dm=da[aN](),di=da[a1]();while(c9<co&&dl<ba){c5.push(c9);if(dq==dc){c9=aT(dr+dl*dn,0)/I}else{if(dq==dp){c9=aT(dr,dm+dl*dn)/I}else{if(!de&&(dq==dg||dq==df)){c9=aT(dr,dm,di+dl*dn*(dq==dg?1:7))}else{c9+=dq*dn}}}dl++}c5.push(c9);cO=cr.dateTimeLabelFormats[dd[0]]}function cy(c7){var c8=(cL<1?s(1/cL):1)*10;
return s(c7*c8)/c8}function cQ(){var c8,c9=P(c3/b9)*b9,c7=a7(co/b9)*b9;c5=[];c8=cy(c9);while(c8<=c7){c5.push(c8);c8=cy(c8+b9)}if(cn){c3-=0.5;co+=0.5}}function cj(){if(cB){cZ()}else{cQ()}var c8=c5[0],c7=c5[c5.length-1];if(cr.startOnTick){c3=c8}else{if(c3>c8){c5.shift()}}if(cr.endOnTick){co=c7}else{if(co<c7){c5.pop()}}}function cc(){if(!cB&&!cn){var c8=ck,c7=c5.length;ck=bo[c6];if(c7<ck){while(c5.length<ck){c5.push(cy(c5[c5.length-1]+b9))}cz*=(c7-1)/(ck-1)}if(i(c8)&&ck!=c8){cm.isDirty=true}}}function cv(){var c7,dc,c9,df=c3,c8=co,dd=cr.maxZoom,de;cV();c3=b(c2,cr.min,b7);co=b(cl,cr.max,cA);if(cM){var da=c1[cY?"xAxis":"yAxis"][cr.linkedTo],db=da.getExtremes();c3=b(db.min,db.dataMin);co=b(db.max,db.dataMax)}if(co-c3<dd){de=(dd-co+c3)/2;c3=aL(c3-de,b(cr.min,c3-de));co=ab(c3+dd,b(cr.max,c3+dd))}if(!cn&&!cE&&!cM&&i(c3)&&i(co)){c7=(co-c3)||1;if(!i(cr.min)&&!i(c2)&&cS&&(b7<0||!cC)){c3-=c7*cS}if(!i(cr.max)&&!i(cl)&&ce&&(cA>0||!c4)){co+=c7*ce}}if(cn||c3==co){b9=1}else{b9=b(cr.tickInterval,(co-c3)*cr.tickPixelInterval/cF)}if(!cB&&!i(cr.tickInterval)){b9=cT(b9)}cR=cr.minorTickInterval==="auto"&&b9?b9/5:cr.minorTickInterval;cj();cz=cF/((co-c3)||1);if(!bo){bo={x:0,y:0}}if(!cB&&c5.length>bo[c6]){bo[c6]=c5.length}if(!cY){for(dc in cW){for(c9 in cW[dc]){cW[dc][c9].cum=cW[dc][c9].total}}}if(!cm.isDirty){cm.isDirty=(c3!=df||co!=c8)}}function cJ(c8,c7,c9){c9=b(c9,true);aJ(cm,"setExtremes",{min:c8,max:c7},function(){if(cn){if(c8<0){c8=0}if(c7>cn.length-1){c7=cn.length-1}}c2=c8;cl=c7;if(c9){c1.redraw()}})}function ci(){return{min:c3,max:co,dataMin:b7,dataMax:cA}}function cb(c7){if(c3>c7){c7=c3}else{if(co<c7){c7=co}}return ca(c7,0,1)}function cP(c8){var c7=c8.width,c9=c7?cK:cs;c9.push(c8);if(c7){cI(c8.value,c8.color,c8.width)}else{cp(c8.from,c8.to,c8.color)}}function cD(){var dh=cr.title,df=cr.alternateGridColor,c9=cr.minorTickWidth,de=cr.lineWidth,c7,dg,db,di=cU.length&&i(c3)&&i(co);if(!cq){cq=bK.g("axis").attr({zIndex:7}).add();cX=bK.g("grid").attr({zIndex:1}).add()}else{cq.empty();cX.empty()}if(di||cM){if(df){a6(c5,function(dk,dj){if(dj%2===0&&dk<co){cp(dk,c5[dj+1]!==ay?c5[dj+1]:co,df)}})}a6(cs,function(dj){cp(dj.from,dj.to,dj.color)});if(cR&&!cn){for(var dd=c3;dd<=co;dd+=cR){cI(dd,cr.minorGridLineColor,cr.minorGridLineWidth);if(c9){cg(dd,cr.minorTickPosition,cr.minorTickColor,c9,cr.minorTickLength)}}}a6(c5,function(dk,dj){db=dk+cH;cI(db,cr.gridLineColor,cr.gridLineWidth);cg(dk,cr.tickPosition,cr.tickColor,cr.tickWidth,cr.tickLength,!((dk==c3&&!cr.showFirstLabel)||(dk==co&&!cr.showLastLabel)),dj)});a6(cK,function(dj){cI(dj.value,dj.color,dj.width)})}if(!cm.hasRenderedLine&&de){c7=bD+(cw?ba:0)+cN;dg=b1-bG-(cw?bU:0)+cN;bK.path(bK.crispLine([at,cf?bD:c7,cf?dg:bc,au,cf?bv-b6:c7,cf?dg:b1-bG],de)).attr({stroke:cr.lineColor,"stroke-width":de,zIndex:7}).add();cm.hasRenderedLine=true}if(!cm.hasRenderedTitle&&!cm.axisTitle&&dh&&dh.text){var dc=cf?bD:bc;var c8={low:dc+(cf?0:cF),middle:dc+cF/2,high:dc+(cf?cF:0)}[dh.align];var da=(cf?bc+bU:bD)+(cf?1:-1)*(cw?-1:1)*dh.margin-(aY?parseInt(dh.style.fontSize||12,10)/3:0);cm.axisTitle=bK.text(dh.text,(cf?c8:da+(cw?ba:0)+cN)+(dh.x||0),(cf?da-(cw?bU:0)+cN:c8)+(dh.y||0),dh.style,dh.rotation||0,{low:"left",middle:"center",high:"right"}[dh.align]).attr({zIndex:7}).add();cm.hasRenderedTitle=true}cm.isDirty=false}function b8(c7){a6([cs,cK],function(c9){for(var c8=0;c8<c9.length;c8++){if(c9[c8].id==c7){c9.splice(c8,1);break}}});cD()}function cd(){if(bL.resetTracker){bL.resetTracker()}cD();a6(cU,function(c7){c7.isDirty=true})}function ct(c7,c8){cm.categories=cn=c7;a6(cU,function(c9){c9.translate();c9.setTooltipPoints(true)});cm.isDirty=true;if(b(c8,true)){cd()}}if(bb&&cY&&c0===ay){c0=true}if(!cw){cN*=-1}if(cf){cN*=-1}av(cm,{addPlotBand:cP,addPlotLine:cP,adjustTickAmount:cc,categories:cn,getExtremes:ci,getThreshold:cb,isXAxis:cY,options:cr,render:cD,setExtremes:cJ,setScale:cv,setCategories:ct,translate:ca,redraw:cd,removePlotBand:b8,removePlotLine:b8,reversed:c0,stacks:cW});for(ch in cu){aa(cm,ch,cu[ch])}cv()}function bq(b8){var b9={};
function ca(cf,ce,cd,cc){if(!b9[cf]){var cb=bK.text(ce,bD+ba-20,bc+30,bz.toolbar.itemStyle,0,"right").on("click",cc).attr({zIndex:20}).add();b9[cf]=cb}}function b7(cb){T(b9[cb].element);b9[cb]=null}return{add:ca,remove:b7}}function bC(cn){var cm,b7=cn.borderWidth,b8=cn.style,ck=parseInt(b8.padding,10),ci=b7+ck,cc=true,ce,ch,ca=0,b9=0;b8.padding=0;var cl=bK.g("tooltip").attr({zIndex:8}).add(),cd=bK.rect(ci,ci,0,0,cn.borderRadius,b7).attr({fill:cn.backgroundColor,"stroke-width":b7}).add(cl).shadow(cn.shadow),cj=bK.text("",ck+ci,parseInt(b8.fontSize,10)+ck+ci).attr({zIndex:1}).css(b8).add(cl);function cb(cp,co){ca=cc?cp:(2*ca+cp)/3;b9=cc?co:(b9+co)/2;cl.translate(ca,b9);if(a5(cp-ca)>1||a5(co-b9)>1){bh=function(){cb(cp,co)}}else{bh=null}}function cf(){cc=true;cl.hide()}function cg(cu){var cq=cu.series,co=cn.borderColor||cu.color||cq.color||"#606060",cs,cr,cy,cx,ct,cw,cv=cu.tooltipText,cp=cu.tooltipPos;cm=cq;cs=s(cp?cp[0]:(bb?ba-cu.plotY:cu.plotX));cr=s(cp?cp[1]:(bb?bU-cu.plotX:cu.plotY));ct=b3(cs,cr);if(cv===false||!ct){cf()}else{if(cc){cl.show();cc=false}cj.attr({text:cv});cw=cj.getBBox();ce=cw.width;ch=cw.height;cd.attr({width:ce+2*ck,height:ch+2*ck,stroke:co});cy=cs-ce+bD-25;cx=cr-ch+bc+10;if(cy<7){cy=7;cx-=20}if(cx<5){cx=5}else{if(cx+ch>b1){cx=b1-ch-5}}cb(s(cy-ci),s(cx-ci))}}return{refresh:cg,hide:cf}}function bR(cj,b9){var co,cn,cl,b7,ci=bA.zoomType,ch=/x/.test(ci),cg=/y/.test(ci),cm=ch&&!bb||cg&&bb,b8=cg&&!bb||ch&&bb;function cc(cp){cp=cp||aB.event;if(!cp.target){cp.target=cp.srcElement}if(cp.type!="mousemove"||aB.opera){bS=p(bI)}if(aY){cp.chartX=cp.x;cp.chartY=cp.y}else{if(cp.layerX===ay){cp.chartX=cp.pageX-bS.x;cp.chartY=cp.pageY-bS.y}else{cp.chartX=cp.layerX;cp.chartY=cp.layerY}}return cp}function cb(cp){var cq={xAxis:[],yAxis:[]};a6(bT,function(cs,cr){var cv=cs.translate,cu=cs.isXAxis,ct=bb?!cu:cu;cq[cu?"xAxis":"yAxis"].push({axis:cs,value:cv(ct?cp.chartX-bD:bU-cp.chartY+bc,true)})});return cq}function ca(cs){var cp,cq=cj.hoverPoint,cr=cj.hoverSeries;if(cr&&cr.tracker){cp=cr.tooltipPoints[bb?cs.chartY:cs.chartX-bD];if(cp&&cp!=cq){cp.onMouseOver()}}}function cf(){var cq=cj.hoverSeries,cp=cj.hoverPoint;if(cp){cp.onMouseOut()}if(cq){cq.onMouseOut()}if(bJ){bJ.hide()}}function ce(){if(b7){var cr={xAxis:[],yAxis:[]},cp=b7.getBBox(),cs=cp.x-bD,cq=cp.y-bc;if(cl){a6(bT,function(cv,cu){var cz=cv.translate,cy=cv.isXAxis,cx=bb?!cy:cy,ct=cz(cx?cs:bU-cq-cp.height,true),cw=cz(cx?cs+cp.width:bU-cq,true);cr[cy?"xAxis":"yAxis"].push({axis:cv,min:ab(ct,cw),max:aL(ct,cw)})});aJ(cj,"selection",cr,bY)}b7=b7.destroy()}cj.mouseIsDown=L=cl=false}function cd(){var cp=true;bI.onmousedown=function(cq){cq=cc(cq);if(cq.preventDefault){cq.preventDefault()}cj.mouseIsDown=L=true;co=cq.chartX;cn=cq.chartY;if(b2&&(ch||cg)){if(!b7){b7=bK.rect(bD,bc,cm?1:ba,b8?1:bU,0).attr({fill:"rgba(69,114,167,0.25)",zIndex:7}).add()}}};bI.onmousemove=function(cu){cu=cc(cu);cu.returnValue=false;var cq=cu.chartX,cv=cu.chartY,cs=!b3(cq-bD,cv-bc);if(L){cl=Math.sqrt(Math.pow(co-cq,2)+Math.pow(cn-cv,2))>10;if(cm){var ct=cq-co;b7.attr({width:a5(ct),x:(ct>0?0:ct)+co})}if(b8){var cr=cv-cn;b7.attr({height:a5(cr),y:(cr>0?0:cr)+cn})}}else{if(!cs){ca(cu)}}if(cs&&!cp){cf();ce()}cp=cs;return false};bI.onmouseup=function(cq){ce()};bI.onclick=function(ct){var cr=cj.hoverPoint;ct=cc(ct);ct.cancelBubble=true;if(!cl){if(cr&&Z(ct.target,"isTracker")){var cs=cr.plotX,cq=cr.plotY;av(cr,{pageX:bS.x+bD+(bb?ba-cq:cs),pageY:bS.y+bc+(bb?bU-cs:cq)});aJ(cj.hoverSeries||cr.series,"click",av(ct,{point:cr}));cr.firePointEvent("click",ct)}else{av(ct,cb(ct));if(b3(ct.chartX-bD,ct.chartY-bc)){aJ(cj,"click",ct)}}}cl=false}}function ck(){cj.trackerGroup=bl=bK.g("tracker");if(bb){bl.attr({width:cj.plotWidth,height:cj.plotHeight}).invert()}bl.attr({zIndex:9}).translate(bD,bc).add()}ck();if(b9.enabled){cj.tooltip=bJ=bC(b9)}cd();bH=setInterval(function(){if(bh){bh()}},32);av(this,{zoomX:ch,zoomY:cg,resetTracker:cf})}var bm=function(ct){var cd=ct.options.legend;if(!cd.enabled){return}var cA=cd.layout=="horizontal",cB=cd.symbolWidth,b7=cd.symbolPadding,cs=[],cz=cd.style,ch=cd.itemStyle,ci=cd.itemHoverStyle,ca=cd.itemHiddenStyle,cr=parseInt(cz.padding,10),cC=20,b8=cd.lineHeight||16,cl=18,cx=4+cr+cB+b7,cb,b9,cu,cn,cq=cd.borderWidth,cj=cd.backgroundColor,ce,cv,cp=cd.width,ck,cg,cm=ct.series,cw=cd.reversed;
function cD(cI,cL){var cE=cI.legendItem,cJ=cI.legendLine,cK=cI.legendSymbol,cG=ca.color,cH=cL?cd.itemStyle.color:cG,cF=cL?cI.color:cG;if(cE){cE.css({color:cH})}if(cJ){cJ.attr({stroke:cF})}if(cK){cK.attr({stroke:cF,fill:cF})}}function cy(cG,cJ,cF){var cE=cG.legendItem,cI=cG.legendLine,cK=cG.legendSymbol,cH=cG.checkbox;if(cE){cE.attr({x:cJ,y:cF})}if(cI){cI.translate(cJ,cF-4)}if(cK){cK.translate(cJ,cF)}if(cH){cH.x=cJ;cH.y=cF}}function cf(cF){var cE=cs.length,cG=cF.checkbox;while(cE--){if(cs[cE]==cF){cs.splice(cE,1);break}}a6(["legendItem","legendLine","legendSymbol"],function(cH){if(cF[cH]){cF[cH].destroy()}});if(cG){T(cF.checkbox)}}function co(cH){var cG,cI,cK,cJ,cE=cH.legendItem,cF=cH.series||cH;if(!cE){cJ=/^(bar|pie|area|column)$/.test(cF.type);cH.legendItem=cE=bK.text(cd.labelFormatter.call(cH),0,0).css(cH.visible?ch:ca).on("mouseover",function(){cH.setState(R);cE.css(ci)}).on("mouseout",function(){cE.css(cH.visible?ch:ca);cH.setState()}).on("click",function(cM){var cN="legendItemClick",cL=function(){cH.setVisible()};if(cH.firePointEvent){cH.firePointEvent(cN,null,cL)}else{aJ(cH,cN,null,cL)}}).attr({zIndex:2}).add(ce);if(!cJ&&cH.options&&cH.options.lineWidth){cH.legendLine=bK.path([at,-cB-b7,0,au,-b7,0]).attr({"stroke-width":cH.options.lineWidth,zIndex:2}).add(ce)}if(cJ){cK=bK.rect(-cB-b7,-11,cB,12,2).attr({"stroke-width":0,zIndex:3}).add(ce)}else{if(cH.options&&cH.options.marker&&cH.options.marker.enabled){cK=bK.symbol(cH.symbol,-cB/2-b7,-4,cH.options.marker.radius).attr(cH.pointAttr[V]).attr({zIndex:3}).add(ce)}}cH.legendSymbol=cK;cD(cH,cH.visible);if(cH.options&&cH.options.showCheckbox){cH.checkbox=aq("input",{type:"checkbox",checked:cH.selected,defaultChecked:cH.selected},cd.itemCheckboxStyle,bI);aa(cH.checkbox,"click",function(cL){var cM=cL.target;aJ(cH,"checkboxClick",{checked:cM.checked},function(){cH.select()})})}}cy(cH,cb,b9);cG=cE.getBBox();cu=b9;cH.legendItemWidth=cI=cd.itemWidth||cB+b7+cG.width+cC;if(cA){cb+=cI;cv=cp||aL(cb-cx,cv);if(cb-cx+cI>(cp||(bv-2*cr-cx))){cb=cx;b9+=b8}}else{b9+=b8;cv=cp||aL(cI,cv)}cs.push(cH)}function cc(){cb=cx;b9=cl;cv=0;cu=0;if(!ce){ce=bK.g("legend").attr({zIndex:7}).add()}if(cw){cm.reverse()}a6(cm,function(cJ){if(!cJ.options.showInLegend){return}var cI=(cJ.options.legendType=="point")?cJ.data:[cJ];a6(cI,co)});if(cw){cm.reverse()}ck=cp||cv;cg=cu-cl+b8;if(cq||cj){ck+=2*cr;cg+=2*cr;if(!cn){cn=bK.rect(0,0,ck,cg,cd.borderRadius,cq||0).attr({stroke:cd.borderColor,"stroke-width":cq||0,fill:cj||ag}).add(ce).shadow(cd.shadow)}else{cn.attr({height:cg,width:ck})}}var cF=["left","right","top","bottom"],cH,cE=4;while(cE--){cH=cF[cE];if(cz[cH]&&cz[cH]!="auto"){cd[cE<2?"align":"verticalAlign"]=cH;cd[cE<2?"x":"y"]=parseInt(cz[cH],10)*(cE%2?-1:1)}}var cG=a9(av({width:ck,height:cg},cd));ce.translate(cG.x,cG.y);a6(cs,function(cI){var cJ=cI.checkbox;if(cJ){aw(cJ,{left:(cG.x+cI.legendItemWidth+cJ.x-40)+ai,top:(cG.y+cJ.y-11)+ai})}})}cc();return{colorizeItem:cD,destroyItem:cf,renderLegend:cc}};function bX(b7){var b8=b7.type||bA.defaultSeriesType,cb=a2[b8],b9,ca=b4.hasRendered;if(ca){if(bb&&b8=="column"){cb=a2.bar}else{if(!bb&&b8=="bar"){cb=a2.column}}}b9=new cb();b9.init(b4,b7);if(!ca&&b9.inverted){bb=true}if(b9.isCartesian){b2=b9.isCartesian}bi.push(b9);return b9}function M(b7,b9){var b8;b9=b(b9,true);aJ(b4,"addSeries",{options:b7},function(){b8=bX(b7);b8.isDirty=true;b4.isDirty=true;if(b9){b4.redraw()}});return b8}b3=function(b7,ca){var b9=0,b8=0;return b7>=b9&&b7<=b9+ba&&ca>=b8&&ca<=b8+bU};function be(){if(bA.alignTicks!==false){a6(bT,function(b7){b7.adjustTickAmount()})}}function bd(){var b9=b4.isDirty,b8,b7=bi.length,ca=b7,cb;while(ca--){cb=bi[ca];if(cb.isDirty&&cb.options.stacking){b8=true;break}}if(b8){ca=b7;while(ca--){cb=bi[ca];if(cb.options.stacking){cb.isDirty=true}}}a6(bi,function(cc){if(cc.isDirty){cc.cleanData();cc.getSegments();if(cc.options.legendType=="point"){b9=true}}});bo=null;if(b2){a6(bT,function(cc){cc.setScale()});be();a6(bT,function(cc){if(cc.isDirty){cc.redraw()}})}a6(bi,function(cc){if(cc.isDirty&&cc.visible){cc.redraw()
}});if(b9&&bQ.renderLegend){bQ.renderLegend();b4.isDirty=false}if(bL&&bL.resetTracker){bL.resetTracker()}aJ(b4,"redraw")}function br(b8){var b7=bz.loading;if(!b0){b0=aq(am,{className:"highcharts-loading"},av(b7.style,{left:bD+ai,top:bc+ai,width:ba+ai,height:bU+ai,zIndex:10,display:ag}),bI);aq("span",null,b7.labelStyle,b0)}if(!bj){aw(b0,{opacity:0,display:""});b0.getElementsByTagName("span")[0].innerHTML=b8||bz.lang.loading;ae(b0,{opacity:b7.style.opacity},{duration:b7.showDuration});bj=true}}function bB(){ae(b0,{opacity:0},{duration:bz.loading.hideDuration,complete:function(){aw(b0,{display:ag})}});bj=false}function bZ(ca){var b8,b7,b9;for(b8=0;b8<bT.length;b8++){if(bT[b8].options.id==ca){return bT[b8]}}for(b8=0;b8<bi.length;b8++){if(bi[b8].options.id==ca){return bi[b8]}}for(b8=0;b8<bi.length;b8++){b9=bi[b8].data;for(b7=0;b7<b9.length;b7++){if(b9[b7].id==ca){return b9[b7]}}}return null}function bn(){var b7=bz.xAxis||{},b9=bz.yAxis||{},b8;b7=ad(b7);a6(b7,function(cb,ca){cb.index=ca;cb.isX=true});b9=ad(b9);a6(b9,function(cb,ca){cb.index=ca});bT=b7.concat(b9);b4.xAxis=[];b4.yAxis=[];bT=q(bT,function(ca){b8=new bt(b4,ca);b4[b8.isXAxis?"xAxis":"yAxis"].push(b8);return b8});be()}function bg(){var b7=[];a6(bi,function(b8){b7=b7.concat(l(b8.data,function(b9){return b9.selected}))});return b7}function bF(){return l(bi,function(b7){return b7.selected})}bw=function(){aJ(b4,"selection",{resetSelection:true},bY);b4.toolbar.remove("zoom")};bY=function(b7){var b8=aG.lang;b4.toolbar.add("zoom",b8.resetZoom,b8.resetZoomTitle,bw);if(!b7||b7.resetSelection){a6(bT,function(b9){b9.setExtremes(null,null,false)})}else{a6(b7.xAxis.concat(b7.yAxis),function(b9){var ca=b9.axis;if(b4.tracker[ca.isXAxis?"zoomX":"zoomY"]){ca.setExtremes(b9.min,b9.max,false)}})}bd()};function bk(){var cb=bz.title,ca=cb.align,b9=bz.subtitle,b8=b9.align,b7={left:0,center:bv/2,right:bv};if(cb&&cb.text){bK.text(cb.text,b7[ca]+cb.x,cb.y,cb.style,0,ca).attr({"class":"highcharts-title"}).add()}if(b9&&b9.text){bK.text(b9.text,b7[b8]+b9.x,b9.y,b9.style,0,b8).attr({"class":"highcharts-subtitle"}).add()}}a9=function(b7){var cc=b7.align,cb=b7.verticalAlign,ca=b7.x||0,b9=b7.y||0,b8={x:ca||0,y:b9||0};if(/^(right|center)$/.test(cc)){b8.x=(bv-b7.width)/{right:1,center:2}[cc]+ca}if(/^(bottom|middle)$/.test(cb)){b8.y=(b1-b7.height)/{bottom:1,middle:2}[cb]+b9}return b8};function bO(){bp=bA.renderTo;b5=y+N++;if(typeof bp=="string"){bp=G.getElementById(bp)}bp.innerHTML="";if(!bp.offsetWidth){bV=bp.cloneNode(0);aw(bV,{position:aX,top:"-9999px",display:""});G.body.appendChild(bV)}var b7=(bV||bp).offsetHeight;b4.chartWidth=bv=bA.width||(bV||bp).offsetWidth||600;b4.chartHeight=b1=bA.height||(b7>bc+bG?b7:0)||400;b4.plotWidth=ba=bv-bD-b6;b4.plotHeight=bU=b1-bc-bG;b4.plotLeft=bD;b4.plotTop=bc;b4.container=bI=aq(am,{className:"highcharts-container"+(bA.className?" "+bA.className:""),id:b5},av({position:k,overflow:ar,width:bv+ai,height:b1+ai,textAlign:"left"},bA.style),bV||bp);b4.renderer=bK=bA.renderer=="SVG"?new m(bI,bv,b1):new aE(bI,bv,b1)}function bE(){var b7,cd=bz.labels,cb=bz.credits,ca=bA.borderWidth||0,b8=bA.backgroundColor,b9=bA.plotBackgroundColor,cc=bA.plotBackgroundImage;b7=2*ca+(bA.shadow?8:0);if(ca||b8){bK.rect(b7/2,b7/2,bv-b7,b1-b7,bA.borderRadius,ca).attr({stroke:bA.borderColor,"stroke-width":ca,fill:b8||ag}).add().shadow(bA.shadow)}if(b9){bK.rect(bD,bc,ba,bU,0).attr({fill:b9}).add().shadow(bA.plotShadow)}if(cc){bK.image(cc,bD,bc,ba,bU).add()}if(bA.plotBorderWidth){bK.rect(bD,bc,ba,bU,0,bA.plotBorderWidth).attr({stroke:bA.plotBorderColor,"stroke-width":bA.plotBorderWidth,zIndex:4}).add()}if(b2){a6(bT,function(ce){ce.render()})}bk();if(cd.items){a6(cd.items,function(){var cf=av(cd.style,this.style),ce=parseInt(cf.left,10)+bD,cg=parseInt(cf.top,10)+bc+12;delete cf.left;delete cf.top;bK.text(this.html,ce,cg,cf).attr({zIndex:2}).add()})}a6(bi,function(ce){ce.render()});bQ=b4.legend=new bm(b4);if(!b4.toolbar){b4.toolbar=bq(b4)}if(cb.enabled&&!b4.credits){bK.text(cb.text,bv-10,b1-5,cb.style,0,"right").on("click",function(){location.href=cb.href
}).attr({zIndex:8}).add()}b4.hasRendered=true;if(bV){bp.appendChild(bI);T(bV)}}function bW(){var b7=bi.length;ac(aB,"unload",bW);ac(b4);a6(bT,function(b8){ac(b8)});while(b7--){bi[b7].destroy()}bI.onmousedown=bI.onmousemove=bI.onmouseup=bI.onclick=null;bI.parentNode.removeChild(bI);bI=null;clearInterval(bH);for(b7 in b4){delete b4[b7]}}function bs(){var b7="onreadystatechange";if(!c&&G.readyState!="complete"){G.attachEvent(b7,function(){G.detachEvent(b7,arguments.callee);bs()});return}bO();a6(bz.series||[],function(b8){bX(b8)});b4.inverted=bb=b(bb,bz.chart.inverted);b4.plotSizeX=bN=bb?bU:ba;b4.plotSizeY=bM=bb?ba:bU;b4.tracker=bL=new bR(b4,bz.tooltip);bn();a6(bi,function(b8){b8.translate();b8.setTooltipPoints()});b4.render=bE;bE();aJ(b4,"load");bP&&bP(b4)}Q=0;O=0;aa(aB,"unload",bW);if(bu){for(bx in bu){aa(b4,bx,bu[bx])}}b4.options=bz;b4.series=bi;b4.addSeries=M;b4.destroy=bW;b4.get=bZ;b4.getAlignment=a9;b4.getSelectedPoints=bg;b4.getSelectedSeries=bF;b4.hideLoading=bB;b4.isInsidePlot=b3;b4.redraw=bd;b4.showLoading=br;bs()}var f=function(){};f.prototype={init:function(a9,M){var L=this,ba;L.series=a9;L.applyOptions(M);L.pointAttr={};if(a9.options.colorByPoint){ba=a9.chart.options.colors;if(!L.options){L.options={}}L.color=L.options.color=L.color||ba[Q++];if(Q>=ba.length){Q=0}}return L},applyOptions:function(M){var L=this,a9=L.series;L.config=M;if(typeof M=="number"||M===null){L.y=M}else{if(typeof M=="object"&&typeof M.length!="number"){av(L,M);L.options=M}else{if(typeof M[0]=="string"){L.name=M[0];L.y=M[1]}else{if(typeof M[0]=="number"){L.x=M[0];L.y=M[1]}}}}if(L.x===ay){L.x=a9.autoIncrement()}},destroy:function(){var L=this,M;if(L==L.series.chart.hoverPoint){L.onMouseOut()}ac(L);a6(["dataLabel","graphic","tracker","group"],function(a9){if(L[a9]){L[a9].destroy()}});if(L.legendItem){L.series.chart.legend.destroyItem(L)}for(M in L){L[M]=null}},select:function(bb,M){var L=this,a9=L.series,ba=a9.chart;L.selected=bb=b(bb,!L.selected);L.firePointEvent(bb?"select":"unselect");L.setState(bb&&t);if(!M){a6(ba.getSelectedPoints(),function(bc){if(bc.selected&&bc!=L){bc.selected=false;bc.setState(V);bc.firePointEvent("unselect")}})}},onMouseOver:function(){var L=this,a9=L.series.chart,ba=a9.tooltip,M=a9.hoverPoint;if(M&&M!=L){M.onMouseOut()}L.firePointEvent("mouseOver");if(ba){ba.refresh(L)}L.setState(R);a9.hoverPoint=L},onMouseOut:function(){var L=this;L.firePointEvent("mouseOut");L.setState(V);L.series.chart.hoverPoint=null},update:function(M,ba){var L=this,a9=L.series;ba=b(ba,true);L.firePointEvent("update",{options:M},function(){L.applyOptions(M);a9.isDirty=true;if(ba){a9.chart.redraw()}})},remove:function(bc){var L=this,a9=L.series,ba=a9.chart,bb=a9.data,M=bb.length;bc=b(bc,true);L.firePointEvent("remove",null,function(){while(M--){if(bb[M]==L){bb.splice(M,1);break}}L.destroy();a9.isDirty=true;if(bc){ba.redraw()}})},firePointEvent:function(bc,ba,M){var L=this,bb=this.series,a9=bb.options;if(a9.point.events[bc]||(L.options&&L.options.events&&L.options.events[bc])){this.importEvents()}if(bc=="click"&&a9.allowPointSelect){M=function(bd){L.select(null,bd.ctrlKey||bd.metaKey||bd.shiftKey)}}aJ(this,bc,ba,M)},importEvents:function(){if(!this.hasImportedEvents){var L=this,M=v(L.series.options.point,L.options),ba=M.events,a9;L.events=ba;for(a9 in ba){aa(L,a9,ba[a9])}this.hasImportedEvents=true}},setState:function(M){var bf=this,bc=bf.series,bg=bc.options.states,a9=bc.options.marker,bb=a9&&!a9.enabled,ba=a9&&a9.states[M],bd=ba&&ba.enabled===false,be=bc.chart,L=bf.pointAttr;if(!M){M=V}if((bf.selected&&M!=t)||(bg[M]&&bg[M].enabled===false)||(M&&(bd||bb&&!ba.enabled))){return}if(M&&!bf.graphic){if(!bc.stateMarkerGraphic){bc.stateMarkerGraphic=be.renderer.circle(0,0,L[M].r).attr(L[M]).add(bc.group)}bc.stateMarkerGraphic.translate(bf.plotX,bf.plotY)}else{if(bf.graphic){bf.graphic.attr(L[M])}}},setTooltipText:function(){var L=this;L.tooltipText=L.series.chart.options.tooltip.formatter.call({series:L.series,point:L,x:L.category,y:L.y,percentage:L.percentage,total:L.total||L.stackTotal})
}};var ao=function(){};ao.prototype={isCartesian:true,type:"line",pointClass:f,pointAttrToOptions:{stroke:"lineColor","stroke-width":"lineWidth",fill:"fillColor",r:"radius"},init:function(bc,M){var bb=this,ba,a9,L=bc.series.length;bb.chart=bc;M=bb.setOptions(M);av(bb,{index:L,options:M,name:M.name||"Series "+(L+1),state:V,pointAttr:{},visible:M.visible!==false,selected:M.selected===true});a9=M.events;for(ba in a9){aa(bb,ba,a9[ba])}bb.getColor();bb.getSymbol();bb.setData(M.data,false)},autoIncrement:function(){var M=this,L=M.options,a9=M.xIncrement;a9=b(a9,L.pointStart,0);M.pointInterval=b(M.pointInterval,L.pointInterval,1);M.xIncrement=a9+M.pointInterval;return a9},cleanData:function(){var M=this,a9=M.data,L;a9.sort(function(bb,ba){return(bb.x-ba.x)});for(L=a9.length-1;L>=0;L--){if(a9[L-1]){if(a9[L-1].x==a9[L].x){a9.splice(L-1,1)}}}},getSegments:function(){var L=-1,M=[],a9=this.data;a6(a9,function(ba,bb){if(ba.y===null){if(bb>L+1){M.push(a9.slice(L+1,bb))}L=bb}else{if(bb==a9.length-1){M.push(a9.slice(L+1,bb+1))}}});this.segments=M},setOptions:function(a9){var L=this.chart.options.plotOptions,M=v(L[this.type],L.series,a9);return M},getColor:function(){var L=this.chart.options.colors;this.color=this.options.color||L[Q++]||"#0000ff";if(Q>=L.length){Q=0}},getSymbol:function(){var L=this.chart.options.symbols,M=this.options.marker.symbol||L[O++];this.symbol=M;if(O>=L.length){O=0}},addPoint:function(a9,bc,M){var ba=this,bb=ba.data,L=(new ba.pointClass()).init(ba,a9);bc=b(bc,true);bb.push(L);if(M){bb[0].remove(false)}ba.isDirty=true;if(bc){ba.chart.redraw()}},setData:function(ba,bc){var M=this,bb=M.data,a9=M.initialColor,L=bb&&bb.length||0;M.xIncrement=null;if(i(a9)){Q=a9}ba=q(ad(ba||[]),function(bd){return(new M.pointClass()).init(M,bd)});while(L--){bb[L].destroy()}M.data=ba;M.cleanData();M.getSegments();M.isDirty=true;if(b(bc,true)){M.chart.redraw()}},remove:function(a9){var L=this,M=L.chart;a9=b(a9,true);if(!L.isRemoving){L.isRemoving=true;aJ(L,"remove",null,function(){L.destroy();M.isDirty=true;if(a9){M.redraw()}})}L.isRemoving=false},translate:function(){var bb=this,bf=bb.chart,be=bb.options.stacking,bd=bb.xAxis.categories,L=bb.yAxis,bi=L.stacks[bb.type],ba=bb.data,bc=ba.length;while(bc--){var bj=ba[bc],M=bj.x,bh=bj.y,bg,bk,a9;bj.plotX=bb.xAxis.translate(M);if(be&&bb.visible&&bi[M]){bk=bi[M];a9=bk.total;bk.cum=bg=bk.cum-bh;bh=bg+bh;if(be=="percent"){bg=a9?bg*100/a9:0;bh=a9?bh*100/a9:0}bj.percentage=a9?bj.y*100/a9:0;bj.stackTotal=a9;bj.yBottom=L.translate(bg,0,1)}if(bh!==null){bj.plotY=L.translate(bh,0,1)}bj.clientX=bf.inverted?bf.plotHeight-bj.plotX:bj.plotX;bj.category=bd&&bd[bj.x]!==ay?bd[bj.x]:bj.x}},setTooltipPoints:function(ba){var bc=this,bd=bc.chart,M=bd.inverted,bb=[],bf=(M?bd.plotTop:bd.plotLeft)+bd.plotSizeX,be,a9,L=[];if(ba){bc.tooltipPoints=null}a6(bc.segments,function(bg){bb=bb.concat(bg)});if(bc.xAxis&&bc.xAxis.reversed){bb=bb.reverse()}a6(bb,function(bg,bh){if(!bc.tooltipPoints){bg.setTooltipText()}be=bb[bh-1]?bb[bh-1].high+1:0;a9=bg.high=bb[bh+1]?(P((bg.plotX+(bb[bh+1]?bb[bh+1].plotX:bf))/2)):bf;while(be<=a9){L[M?bf-be++:be++]=bg}});bc.tooltipPoints=L},onMouseOver:function(){var M=this,a9=M.chart,L=a9.hoverSeries,ba=M.stateMarkerGraphic;if(a9.mouseIsDown){return}if(ba){ba.show()}if(L&&L!=M){L.onMouseOut()}if(M.options.events.mouseOver){aJ(M,"mouseOver")}if(M.tracker){M.tracker.toFront()}M.setState(R);a9.hoverSeries=M},onMouseOut:function(){var a9=this,M=a9.options,ba=a9.chart,bb=ba.tooltip,L=ba.hoverPoint;if(L){L.onMouseOut()}if(a9&&M.events.mouseOut){aJ(a9,"mouseOut")}if(bb&&!M.stickyTracking){bb.hide()}a9.setState();ba.hoverSeries=null},animate:function(ba){var M=this,a9=M.chart,L=M.clipRect;if(ba){if(!L.isAnimating){L.attr("width",0);L.isAnimating=true}}else{L.animate({width:a9.plotSizeX},{complete:function(){L.isAnimating=false},duration:1000});this.animate=null}},drawPoints:function(){var bb=this,L,ba=bb.data,be=bb.chart,M,bg,bc,bf,bd,a9;if(bb.options.marker.enabled){bc=ba.length;while(bc--){bf=ba[bc];M=bf.plotX;
bg=bf.plotY;a9=bf.graphic;if(bg!==ay){L=bf.pointAttr[bf.selected?t:V];bd=L.r;if(a9){a9.attr({x:M,y:bg,r:bd})}else{bf.graphic=be.renderer.symbol(b(bf.marker&&bf.marker.symbol,bb.symbol),M,bg,bd).attr(L).add(bb.group)}}}}},convertAttribs:function(a9,M,be,bd){var bb=this.pointAttrToOptions,L,ba,bc={};a9=a9||{};M=M||{};be=be||{};bd=bd||{};for(L in bb){ba=bb[L];bc[L]=b(a9[ba],M[L],be[L],bd[L])}return bc},getAttribs:function(){var bf=this,a9=bf.options.marker||bf.options,bl=a9.states,M=bl[R],bg,bh={},ba=bf.color,be=bf.data,bd,bj,bc=[],L,bb=bf.pointAttrToOptions,bi;if(bf.options.marker){bh={stroke:ba,fill:ba};M.radius=M.radius||a9.radius+2;M.lineWidth=M.lineWidth||a9.lineWidth+1}else{bh={fill:ba};M.color=M.color||u(M.color||ba).brighten(M.brightness).get()}bc[V]=bf.convertAttribs(a9,bh);a6([R,t],function(bm){bc[bm]=bf.convertAttribs(bl[bm],bc[V])});bf.pointAttr=bc;bd=be.length;while(bd--){bj=be[bd];a9=(bj.options&&bj.options.marker)||bj.options;if(a9&&a9.enabled===false){a9.radius=0}bi=false;if(bj.options){for(var bk in bb){if(i(a9[bb[bk]])){bi=true}}}if(bi){L=[];bl=a9.states||{};bg=bl[R]=bl[R]||{};if(!bf.options.marker){bg.color=u(bg.color||bj.options.color).brighten(bg.brightness||M.brightness).get()}L[V]=bf.convertAttribs(a9,bc[V]);L[R]=bf.convertAttribs(bl[R],bc[R],L[V]);L[t]=bf.convertAttribs(bl[t],bc[t],L[V])}else{L=bc}bj.pointAttr=L}},destroy:function(){var M=this,a9=M.chart,ba=a9.series,L=M.clipRect,bb;ac(M);if(M.legendItem){M.chart.legend.destroyItem(M)}a6(M.data,function(bc){bc.destroy()});a6(["area","graph","dataLabelsGroup","group","tracker"],function(bc){if(M[bc]){M[bc].destroy()}});if(L&&L!=M.chart.clipRect){L.destroy()}if(a9.hoverSeries==M){a9.hoverSeries=null}a6(ba,function(bc,bd){if(bc==M){ba.splice(bd,1)}});for(bb in M){delete M[bb]}},drawDataLabels:function(){if(this.options.dataLabels.enabled){var bb=this,bh,bg,ba=bb.data,bi=bb.options.dataLabels,bf,bd=bb.dataLabelsGroup,be=bb.chart,L=be.inverted,a9=bb.type,M,bc;if(!bd){bd=bb.dataLabelsGroup=be.renderer.g(y+"data-labels").attr({visibility:bb.visible?ak:ar,zIndex:4}).translate(be.plotLeft,be.plotTop).add()}M=bi.color;if(M=="auto"){M=null}bi.style.color=b(M,bb.color);a6(ba,function(bj){var bl=b(bj.barX,bj.plotX),bk=bj.plotY,bn=bj.tooltipPos,bm=bj.dataLabel;if(bm){bj.dataLabel=bm.destroy()}bf=bi.formatter.call({x:bj.x,y:bj.y,series:bb,point:bj,percentage:bj.percentage,total:bj.total||bj.stackTotal});bh=(L?be.plotWidth-bk:bl)+bi.x;bg=(L?be.plotHeight-bl:bk)+bi.y;if(bn){bh=bn[0]+bi.x;bg=bn[1]+bi.y}bc=bi.align;if(a9=="column"){bh+={center:bj.barW/2,right:bj.barW}[bc]||0}if(bf){bj.dataLabel=be.renderer.text(bf,bh,bg,bi.style,bi.rotation,bc).attr({zIndex:1,visibility:bj.visible===false?ar:"inherit"}).add(bd)}if(bb.drawConnector){bb.drawConnector(bj)}})}},drawGraph:function(L){var bg=this,bn=bg.options,bj=bg.chart,bm=bg.graph,be=[],M,a9=bg.area,bk=bg.group,bc=bn.lineColor||bg.color,bh=bn.lineWidth,ba,bi=bj.renderer,bl=bg.yAxis.getThreshold(bn.threshold||0),bb=/^area/.test(bg.type),bf=[],bd=[];a6(bg.segments,function(bq){if(bq.length>1){ba=[];a6(bq,function(bs,bt){if(bt<2){ba.push([at,au][bt])}if(bt&&bn.step){var bu=bq[bt-1];ba.push(bs.plotX,bu.plotY)}ba.push(bs.plotX,bs.plotY)});be=be.concat(ba);if(bb){var br=[],bp,bo=ba.length;for(bp=0;bp<bo;bp++){br.push(ba[bp])}if(bn.stacking&&bg.type!="areaspline"){for(bp=bq.length-1;bp>=0;bp--){br.push(bq[bp].plotX,bq[bp].yBottom)}}else{br.push(bq[bq.length-1].plotX,bl,bq[0].plotX,bl,"z")}bd=bd.concat(br)}}else{bf.push(bq[0])}});bg.graphPath=be;bg.singlePoints=bf;if(bb){M=b(bn.fillColor,u(bg.color).setOpacity(bn.fillOpacity||0.75).get());if(a9){a9.attr({d:bd})}else{bg.area=bg.chart.renderer.path(bd).attr({fill:M}).add(bg.group)}}if(bm){bm.attr({d:be})}else{if(bh){bg.graph=bi.path(be).attr({stroke:bc,"stroke-width":bh+ai}).add(bk).shadow(bn.shadow)}}},render:function(){var M=this,a9=M.chart,bb,L=M.options.animation&&M.animate,ba=a9.renderer;if(!M.clipRect){M.clipRect=!a9.hasRendered&&a9.clipRect?a9.clipRect:ba.clipRect(0,0,a9.plotSizeX,a9.plotSizeY);
if(!a9.clipRect){a9.clipRect=M.clipRect}}if(!M.group){bb=M.group=ba.g("series");if(a9.inverted){bb.attr({width:a9.plotWidth,height:a9.plotHeight}).invert()}bb.clip(M.clipRect).attr({visibility:M.visible?ak:ar,zIndex:3}).translate(a9.plotLeft,a9.plotTop).add()}M.drawDataLabels();if(L){M.animate(true)}M.getAttribs();if(M.drawGraph){M.drawGraph()}M.drawPoints();if(M.options.enableMouseTracking!==false){M.drawTracker()}if(L){M.animate()}M.isDirty=false},redraw:function(){var L=this;L.translate();L.setTooltipPoints(true);L.render()},setState:function(bb){var a9=this,M=a9.options,ba=a9.graph,bc=M.states,bd=a9.stateMarkerGraphic,L=M.lineWidth;bb=bb||V;if(a9.state!=bb){a9.state=bb;if(bc[bb]&&bc[bb].enabled===false){return}if(bb){L=bc[bb].lineWidth||L}else{if(bd){bd.hide()}}if(ba){ba.animate({"stroke-width":L},bb?0:500)}}},setVisible:function(M,bi){var bb=this,bf=bb.chart,be=bb.legendItem,bg=bb.group,bk=bb.tracker,bd=bb.dataLabelsGroup,L,ba,a9=bb.data,bh,bj=bf.options.chart.ignoreHiddenSeries,bc=bb.visible;bb.visible=M=M===ay?!bc:M;L=M?"show":"hide";if(M){bb.isDirty=bj}if(bg){bg[L]()}if(bk){bk[L]()}else{ba=a9.length;while(ba--){bh=a9[ba];if(bh.tracker){bh.tracker[L]()}}}if(bd){bd[L]()}if(be){bf.legend.colorizeItem(bb,M)}if(bj){if(bb.options.stacking){a6(bf.series,function(bl){if(bl.options.stacking&&bl.visible){bl.isDirty=true}})}}if(bi!==false){bf.redraw()}aJ(bb,L)},show:function(){this.setVisible(true)},hide:function(){this.setVisible(false)},select:function(M){var L=this;L.selected=M=(M===ay)?!L.selected:M;if(L.checkbox){L.checkbox.checked=M}aJ(L,M?"select":"unselect")},drawTracker:function(){var bc=this,bh=bc.options,L=bc.graphPath,be=bc.chart,M=be.options.tooltip.snap,bf=bc.tracker,bg=bh.cursor,bd=bg&&{cursor:bg},bb=bc.singlePoints,a9,ba;for(ba=0;ba<bb.length;ba++){a9=bb[ba];L.push(at,a9.plotX-3,a9.plotY,au,a9.plotX+3,a9.plotY)}if(bf){bf.attr({d:L})}else{bc.tracker=be.renderer.path(L).attr({isTracker:true,stroke:aD,fill:ag,"stroke-width":bh.lineWidth+2*M,"stroke-linecap":"round",visibility:bc.visible?ak:ar,zIndex:1}).on("mouseover",function(){if(be.hoverSeries!=bc){bc.onMouseOver()}}).on("mouseout",function(){if(!bh.stickyTracking){bc.onMouseOut()}}).css(bd).add(be.trackerGroup)}}};var J=aK(ao);a2.line=J;var o=aK(ao,{type:"area"});a2.area=o;function n(ba){var bg=[];var be=[];var bb;for(bb=0;bb<ba.length;bb++){bg[bb]=ba[bb].plotX;be[bb]=ba[bb].plotY}this.xdata=bg;this.ydata=be;var bd=[];this.y2=[];var M=be.length;this.n=M;this.y2[0]=0;this.y2[M-1]=0;bd[0]=0;for(bb=1;bb<M-1;bb++){var bc=(bg[bb+1]-bg[bb-1]);var bf=(bg[bb]-bg[bb-1])/bc;var L=bf*this.y2[bb-1]+2;this.y2[bb]=(bf-1)/L;bd[bb]=(be[bb+1]-be[bb])/(bg[bb+1]-bg[bb])-(be[bb]-be[bb-1])/(bg[bb]-bg[bb-1]);bd[bb]=(6*bd[bb]/(bg[bb+1]-bg[bb-1])-bf*bd[bb-1])/L}for(var a9=M-2;a9>=0;a9--){this.y2[a9]=this.y2[a9]*this.y2[a9+1]+bd[a9]}}n.prototype={get:function(M){if(!M){M=50}var bd=this.n;var ba=(this.xdata[bd-1]-this.xdata[0])/(M-1);var bc=[];var a9=[];bc[0]=this.xdata[0];a9[0]=this.ydata[0];var bb=[{plotX:bc[0],plotY:a9[0]}];for(var L=1;L<M;L++){bc[L]=bc[0]+L*ba;a9[L]=this.interpolate(bc[L]);bb[L]={plotX:bc[L],plotY:a9[L]}}return bb},interpolate:function(bb){var bd=this.n-1;var a9=0;while(bd-a9>1){var M=(bd+a9)/2;if(this.xdata[P(M)]>bb){bd=M}else{a9=M}}var L=P(bd),bf=P(a9);var ba=this.xdata[L]-this.xdata[bf];var be=(this.xdata[L]-bb)/ba;var bc=(bb-this.xdata[bf])/ba;return be*this.ydata[bf]+bc*this.ydata[L]+((be*be*be-be)*this.y2[bf]+(bc*bc*bc-bc)*this.y2[L])*(ba*ba)/6}};var w=aK(ao,{type:"spline",drawGraph:function(a9){var M=this,L=M.segments;M.splinedata=M.getSplineData();M.segments=M.splinedata;ao.prototype.drawGraph.apply(M,arguments);M.segments=L},getSplineData:function(){var a9=this,ba=a9.chart,bb=[],L=ba.plotSizeX,M;a6(a9.segments,function(bf){if(a9.xAxis.reversed){bf=bf.reverse()}var bc=[],be,bd;a6(bf,function(bg,bh){be=bf[bh+2]||bf[bh+1]||bg;bd=bf[bh-2]||bf[bh-1]||bg;if(be.plotX>=0&&bd.plotX<=L){bc.push(bg)}});if(bc.length>1){M=s(aL(L,bc[bc.length-1].clientX-bc[0].clientX)/3)}bb.push(bf.length>1?M?(new n(bc)).get(M):[]:bf)
});return bb}});a2.spline=w;var a=aK(w,{type:"areaspline"});a2.areaspline=a;var aH=aK(ao,{type:"column",pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color",r:"borderRadius"},init:function(){ao.prototype.init.apply(this,arguments);var L=this,M=L.chart;if(M.hasRendered){a6(M.series,function(a9){if(a9.type==L.type){a9.isDirty=true}})}},translate:function(){var bf=this,bi=bf.chart,bo=0,L=bf.xAxis.reversed,bk=bf.xAxis.categories,be;ao.prototype.translate.apply(bf);a6(bi.series,function(br){if(br.type==bf.type){if(!br.options.stacking){br.columnIndex=bo++}else{if(!i(be)){be=bo++}br.columnIndex=be}}});var M=bf.options,bq=bf.data,a9=bf.closestPoints,ba=a5(bq[1]?bq[a9].plotX-bq[a9-1].plotX:bi.plotSizeX/(bk?bk.length:1)),bm=ba*M.groupPadding,bg=ba-2*bm,bl=bg/bo,bj=M.pointWidth,bd=i(bj)?(bl-bj)/2:bl*M.pointPadding,bb=b(bj,bl-2*bd),bp=(L?bo-bf.columnIndex:bf.columnIndex)||0,bn=bd+(bm+bp*bl-(ba/2))*(L?-1:1),bh=bf.yAxis.getThreshold(M.threshold||0),bc=M.minPointLength;a6(bq,function(br){var bt=br.plotY,bw=br.plotX+bn,bv=a7(ab(bt,bh)),bx=bb,bs=a7(a5((br.yBottom||bh)-bt)),bu;if(a5(bs)<(bc||5)){if(bc){bs=bc;bv=bh-(bt<=bh?bc:0)}bu=bv-3}av(br,{barX:bw,barY:bv,barW:bx,barH:bs});br.shapeType="rect";br.shapeArgs={x:bw,y:bv,width:bx,height:bs,r:M.borderRadius};br.trackerArgs=i(bu)&&v(br.shapeArgs,{height:6,y:bu})})},getSymbol:function(){},drawGraph:function(){},drawPoints:function(){var a9=this,L=a9.options,ba=a9.chart.renderer,bb,M;a6(a9.data,function(bc){if(i(bc.plotY)){bb=bc.graphic;M=bc.shapeArgs;if(bb){bb.attr(M)}else{bc.graphic=ba[bc.shapeType](M).attr(bc.pointAttr[bc.selected?t:V]).add(a9.group).shadow(L.shadow)}}})},drawTracker:function(){var M=this,bc=M.chart,bb=bc.renderer,L,bd,ba=+new Date(),be=M.options.cursor,a9=be&&{cursor:be},bf;a6(M.data,function(bg){bd=bg.tracker;L=bg.trackerArgs||bg.shapeArgs;if(bd){bd.attr(L)}else{bg.tracker=bb[bg.shapeType](L).attr({isTracker:ba,fill:aD,visibility:M.visible?ak:ar,zIndex:1}).on("mouseover",function(bh){bf=bh.relatedTarget||bh.fromElement;if(bc.hoverSeries!=M&&Z(bf,"isTracker")!=ba){M.onMouseOver()}bg.onMouseOver()}).on("mouseout",function(bh){if(!M.options.stickyTracking){bf=bh.relatedTarget||bh.toElement;if(Z(bf,"isTracker")!=ba){M.onMouseOut()}}}).css(a9).add(bc.trackerGroup)}})},cleanData:function(){var ba=this,bb=ba.data,L,a9,bc,M;ao.prototype.cleanData.apply(ba);for(M=bb.length-1;M>=0;M--){if(bb[M-1]){L=bb[M].x-bb[M-1].x;if(a9===ay||L<a9){a9=L;bc=M}}}ba.closestPoints=bc},animate:function(a9){var L=this,M=L.data;if(!a9){a6(M,function(ba){var bb=ba.graphic;if(bb){bb.attr({height:0,y:L.yAxis.translate(0,0,1)});bb.animate({height:ba.barH,y:ba.barY},{duration:1000})}});L.animate=null}},remove:function(){var L=this,M=L.chart;if(M.hasRendered){a6(M.series,function(a9){if(a9.type==L.type){a9.isDirty=true}})}ao.prototype.remove.apply(L,arguments)}});a2.column=aH;var Y=aK(aH,{type:"bar",init:function(L){L.inverted=this.inverted=true;aH.prototype.init.apply(this,arguments)}});a2.bar=Y;var S=aK(ao,{type:"scatter",translate:function(){var L=this;ao.prototype.translate.apply(L);a6(L.data,function(M){M.shapeType="circle";M.shapeArgs={x:M.plotX,y:M.plotY,r:L.chart.options.tooltip.snap}})},drawTracker:function(){var M=this,a9=M.options.cursor,L=a9&&{cursor:a9},ba;a6(M.data,function(bb){ba=bb.graphic;if(ba){ba.attr({isTracker:true}).on("mouseover",function(bc){M.onMouseOver();bb.onMouseOver()}).on("mouseout",function(bc){if(!M.options.stickyTracking){M.onMouseOut()}}).css(L)}})},cleanData:function(){}});a2.scatter=S;var W=aK(f,{init:function(){f.prototype.init.apply(this,arguments);var L=this,M;av(L,{visible:L.visible!==false,name:b(L.name,"Slice")});M=function(){L.slice()};aa(L,"select",M);aa(L,"unselect",M);return L},setVisible:function(a9){var L=this,M=L.series.chart,ba;L.visible=a9=a9===ay?!L.visible:a9;ba=a9?"show":"hide";L.group[ba]();if(L.tracker){L.tracker[ba]()}if(L.dataLabel){L.dataLabel[ba]()}if(L.legendItem){M.legend.colorizeItem(L,a9)}},slice:function(a9,bc){var L=this,ba=L.series,bb=ba.chart,M=L.slicedTranslation;
bc=b(bc,true);a9=L.sliced=i(a9)?a9:!L.sliced;L.group.animate({translateX:(a9?M[0]:bb.plotLeft),translateY:(a9?M[1]:bb.plotTop)},100)}});var j=aK(ao,{type:"pie",isCartesian:false,pointClass:W,pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color"},getColor:function(){this.initialColor=Q},translate:function(){var bk=0,be=this,bm=-0.25,bn=be.options,bb=bn.slicedOffset,bf=bn.center,bg=be.chart,bj=bg.plotWidth,bi=bg.plotHeight,a9,bc,ba,bd=be.data,L=2*U.PI,bl,bh=ab(bj,bi),M;bf.push(bn.size,bn.innerSize||0);bf=q(bf,function(bp,bo){M=/%$/.test(bp);return M?[bj,bi,bh,bh][bo]*parseInt(bp,10)/100:bp});a6(bd,function(bo){bk+=bo.y});a6(bd,function(bo){bl=bk?bo.y/bk:0;a9=bm*L;bm+=bl;bc=bm*L;bo.shapeType="arc";bo.shapeArgs={x:bf[0],y:bf[1],r:bf[2]/2,innerR:bf[3]/2,start:a9,end:bc};ba=(bc+a9)/2;bo.slicedTranslation=q([aR(ba)*bb+bg.plotLeft,B(ba)*bb+bg.plotTop],s);bo.tooltipPos=[bf[0]+aR(ba)*bf[2]*0.35,bf[1]+B(ba)*bf[2]*0.35];bo.percentage=bl*100;bo.total=bk});this.setTooltipPoints()},render:function(){var L=this;L.getAttribs();this.drawPoints();if(L.options.enableMouseTracking!==false){L.drawTracker()}this.drawDataLabels();L.isDirty=false},drawPoints:function(){var M=this,a9=M.chart,ba=a9.renderer,bc,bb,L;a6(M.data,function(bd){bb=bd.graphic;L=bd.shapeArgs;if(!bd.group){bc=bd.sliced?bd.slicedTranslation:[a9.plotLeft,a9.plotTop];bd.group=ba.g("point").attr({zIndex:3}).add().translate(bc[0],bc[1])}if(bb){bb.attr(L)}else{bd.graphic=ba.arc(L).attr(bd.pointAttr[V]).add(bd.group)}if(bd.visible===false){bd.setVisible(false)}})},drawTracker:aH.prototype.drawTracker,getSymbol:function(){}});a2.pie=j;aB.Highcharts={Chart:aZ,dateFormat:az,getOptions:D,numberFormat:h,Point:f,Renderer:aE,seriesTypes:a2,setOptions:aA,Series:ao,addEvent:aa,createElement:aq,discardElement:T,css:aw,each:a6,extend:av,map:q,merge:v,pick:b,extendClass:aK}})();Ext.ux.HighChart=Ext.extend(Ext.BoxComponent,{defaultSerieType:null,resizable:true,updateDelay:0,loadMask:false,addSeries:function(e,a){a=(a==null)?true:false;var j=new Array(),h=new Array(),b,g;for(var d=0;d<e.length;d++){var f=e[d];if(!f.serieCls){if(f.type!=null||this.defaultSerieType!=null){b=Ext.ux.HighChart.Series.get(f.type!=null?f.type:this.defaultSerieType)}else{b=Ext.ux.HighChart.Serie}g=new b(f)}else{g=f}h.push(g.config);j.push(g)}if(this.chart){if(!a){this.removeAllSeries();this.series=j;this.chartConfig.series=h}else{this.chartConfig.series=this.chartConfig.series?this.chartConfig.series.concat(h):h;this.series=this.series?this.series.concat(j):j}for(var d=0;d<h.length;d++){this.chart.addSeries(h[d],true)}this.refresh()}else{if(a){this.chartConfig.series=this.chartConfig.series?this.chartConfig.series.concat(h):h;this.series=this.series?this.series.concat(j):j}else{this.chartConfig.series=h;this.series=j}}},removeSerie:function(b,a){a=a||true;if(this.chart){this.chart.series[b].remove(a);this.chartConfig.series.splice(b,1)}this.series.splice(b,1)},removeAllSeries:function(){var b=this.series.length;for(var a=0;a<b;a++){this.removeSerie(0)}},setTitle:function(a){if(this.chartConfig.title){this.chartConfig.title.text=a}else{this.chartConfig.title={text:a}}if(this.chart&&this.chart.container){this.draw()}},setSubTitle:function(a){if(this.chartConfig.subtitle){this.chartConfig.subtitle.text=a}else{this.chartConfig.subtitle={text:a}}if(this.chart&&this.chart.container){this.draw()}},initComponent:function(){if(this.store){this.store=Ext.StoreMgr.lookup(this.store)}Ext.ux.HighChart.superclass.initComponent.call(this)},initEvents:function(){if(this.loadMask){this.loadMask=new Ext.LoadMask(this.el,Ext.apply({store:this.store},this.loadMask))}},afterRender:function(){if(this.store){this.bindStore(this.store,true)}Ext.ux.HighChart.superclass.afterRender.call(this);this.bindComponent(true);Ext.applyIf(this.chartConfig.chart,{renderTo:this.el.dom});Ext.applyIf(this.chartConfig,{xAxis:[{}]});if(this.xField&&this.store){this.updatexAxisData()}if(this.series){this.addSeries(this.series,false)}else{this.series=[]}this.initEvents();this.update(500)},onMove:function(){},draw:function(){if(this.chart&&this.rendered){if(this.resizable){for(var a=0;a<this.series.length;a++){this.series[a].visible=this.chart.series[a].visible}this.chart.destroy();delete this.chart;this.chart=new Highcharts.Chart(this.chartConfig)}}else{if(this.rendered){this.chart=new Highcharts.Chart(this.chartConfig)}}for(a=0;a<this.series.length;a++){if(!this.series[a].visible){this.chart.series[a].hide()}}this.refresh()},onContainerResize:function(){this.draw()},updatexAxisData:function(){var c=[],a=this.store.data.items;if(this.xField&&this.store){for(var b=0;b<a.length;b++){c.push(a[b].data[this.xField])}if(this.chart){this.chart.xAxis[0].setCategories(c,true)}else{this.chartConfig.xAxis[0].categories=c}}},bindComponent:function(c){var b=function(d){if(d.ownerCt){return b(d.ownerCt)}else{return d}};var a=b(this);if(c){a.on("move",this.onMove,this);if(this.ownerCt){this.ownerCt.on("render",this.update,this)}}else{if(this.ownerCt){this.ownerCt.un("render",this.update,this)}a.un("move",this.onMove,this)}},bindStore:function(a,b){if(!b&&this.store){if(a!==this.store&&this.store.autoDestroy){this.store.destroy()}else{this.store.un("datachanged",this.onDataChange,this);this.store.un("load",this.onLoad,this);this.store.un("add",this.onAdd,this);this.store.un("remove",this.onRemove,this);this.store.un("update",this.onUpdate,this);this.store.un("clear",this.onClear,this)}}if(a){a=Ext.StoreMgr.lookup(a);a.on({scope:this,load:this.onLoad,datachanged:this.onDataChange,add:this.onAdd,remove:this.onRemove,update:this.onUpdate,clear:this.onClear})}this.store=a;if(a&&!b){this.refresh()}},refresh:function(){if(this.store&&this.chart){var b=new Array(),a=this.chart.series.length,c;for(c=0;c<a;c++){b.push(new Array())}var f=this.store.data.items;var g=[];for(var h=0;h<f.length;h++){var d=f[h];
if(this.xField){g.push(d.data[this.xField])}for(c=0;c<a;c++){var e=this.series[c],j;if((e.type=="pie"&&e.useTotals)){if(h==0){e.clear()}j=e.getData(d,h)}else{j=e.getData(d,h);b[c].push(j)}}}for(c=0;c<a;c++){if(this.series[c].useTotals){this.chart.series[c].setData(this.series[c].getTotals())}else{if(b[c].length>0){this.chart.series[c].setData(b[c],(c==(a-1)))}}}if(this.xField){this.updatexAxisData()}}},refreshRow:function(b){var c=this.store.indexOf(b);if(this.chart){for(var d=0;d<this.chart.series.length;d++){var e=this.chart.series[d];var a=this.series[d].getData(b,c);if(this.series[d].type=="pie"&&this.series[d].useTotals){this.series[d].update(b);this.chart.series[d].setData(this.series[d].getTotals())}else{e.data[c].update(a)}}if(this.xField){this.updatexAxisData()}}},update:function(a){var b=a||this.updateDelay;if(!this.updateTask){this.updateTask=new Ext.util.DelayedTask(this.draw,this)}this.updateTask.delay(b)},onDataChange:function(){this.refresh()},onClear:function(){this.refresh()},onUpdate:function(b,a){this.refreshRow(a)},onAdd:function(a,b,f){var k=false,g=[];for(var c=0;c<b.length;c++){var d=b[c];if(c==b.length-1){k=true}if(this.xField){g.push(d.data[this.xField])}for(var h=0;h<this.chart.series.length;h++){var e=this.chart.series[h],l=this.series[h];var j=l.getData(d,f+c);if(!(l.type=="pie"&&l.useTotals)){e.addPoint(j,k)}}}if(this.xField){this.chart.xAxis[0].setCategories(g,true)}},onResize:function(){Ext.ux.HighChart.superclass.onResize.call(this);this.update()},onRemove:function(f,a,b,e){for(var c=0;c<this.series.length;c++){var d=this.series[c];if(d.type=="pie"&&d.useTotals){d.removeData(a,b);this.chart.series[c].setData(d.getTotals())}else{this.chart.series[c].data[b].remove(true)}}Ext.each(this.chart.series,function(g){g.data[b].remove(true)});if(this.xField){this.updatexAxisData()}},onLoad:function(){this.refresh()},destroy:function(){delete this.series;if(this.chart){this.chart.destroy();delete this.chart}this.bindStore(null);this.bindComponent(null);Ext.ux.HighChart.superclass.destroy.call(this)}});Ext.reg("highchart",Ext.ux.HighChart);Ext.ux.HighChart.Series=function(){var b=new Array(),a=new Array();return{reg:function(d,c){b.push(c);a.push(d)},get:function(c){return b[a.indexOf(c)]}}}();Ext.ux.HighChart.Serie=function(a){a.type=this.type;if(!a.data){a.data=[]}Ext.apply(this,a);this.config=a};Ext.ux.HighChart.Serie.prototype={type:null,xField:null,yField:null,visible:true,clear:Ext.emptyFn,getData:function(b,c){var d=this.yField||this.dataIndex,e=this.xField,a={data:b.data,y:b.data[d]};if(e){a.x=b.data[e]}return a},serieCls:true};Ext.ux.HighChart.SplineSerie=Ext.extend(Ext.ux.HighChart.Serie,{type:"spline"});Ext.ux.HighChart.Series.reg("spline",Ext.ux.HighChart.SplineSerie);Ext.ux.HighChart.ColumnSerie=Ext.extend(Ext.ux.HighChart.Serie,{type:"column"});Ext.ux.HighChart.Series.reg("column",Ext.ux.HighChart.ColumnSerie);Ext.ux.HighChart.BarSerie=Ext.extend(Ext.ux.HighChart.Serie,{type:"bar"});Ext.ux.HighChart.Series.reg("bar",Ext.ux.HighChart.BarSerie);Ext.ux.HighChart.LineSerie=Ext.extend(Ext.ux.HighChart.Serie,{type:"line"});Ext.ux.HighChart.Series.reg("line",Ext.ux.HighChart.LineSerie);Ext.ux.HighChart.AreaSerie=Ext.extend(Ext.ux.HighChart.Serie,{type:"area"});Ext.ux.HighChart.Series.reg("area",Ext.ux.HighChart.AreaSerie);Ext.ux.HighChart.AreaSplineSerie=Ext.extend(Ext.ux.HighChart.Serie,{type:"areaspline"});Ext.ux.HighChart.Series.reg("areaspline",Ext.ux.HighChart.AreaSplineSerie);Ext.ux.HighChart.ScatterSerie=Ext.extend(Ext.ux.HighChart.Serie,{type:"scatter"});Ext.ux.HighChart.Series.reg("scatter",Ext.ux.HighChart.ScatterSerie);Ext.ux.HighChart.PieSerie=Ext.extend(Ext.ux.HighChart.Serie,{type:"pie",categorieField:null,dataField:null,useTotals:false,columns:[],constructor:function(a){Ext.ux.HighChart.PieSerie.superclass.constructor.apply(this,arguments);if(this.useTotals){this.columnData={};var c=this.columns.length;for(var b=0;b<c;b++){this.columnData[this.columns[b]]=100/c}}},addData:function(a){for(var b=0;
b<this.columns.length;b++){var d=this.columns[b];this.columnData[d]=this.columnData[d]+a.data[d]}},update:function(a){for(var b=0;b<this.columns.length;b++){var d=this.columns[b];if(a.modified[d]){this.columnData[d]=this.columnData[d]+a.data[d]-a.modified[d]}}},removeData:function(a,b){for(var d=0;d<this.columns.length;d++){var e=this.columns[d];this.columnData[e]=this.columnData[e]-a.data[e]}},clear:function(){for(var a=0;a<this.columns.length;a++){var b=this.columns[a];this.columnData[b]=0}},getData:function(a,b){if(this.useTotals){this.addData(a);return[]}return[a.data[this.categorieField],a.data[this.dataField]]},getTotals:function(){var b=new Array();for(var d=0;d<this.columns.length;d++){var e=this.columns[d];b.push([e,this.columnData[e]])}return b}});Ext.ux.HighChart.Series.reg("pie",Ext.ux.HighChart.PieSerie);(function(){var table={};window.unitConverter=function(value,unit){this.value=value;if(unit){this.currentUnit=unit}};unitConverter.prototype.as=function(targetUnit){this.targetUnit=targetUnit;return this};unitConverter.prototype.is=function(currentUnit){this.currentUnit=currentUnit;return this};unitConverter.prototype.val=function(){var val;var target;var current;var flipMultiplier=false;var curUnit=escape(this.currentUnit);var tarUnit=escape(this.targetUnit);if(table[this.targetUnit]!=undefined){current=table[tarUnit];target=current[curUnit];current=current[tarUnit]}else{current=table[curUnit];target=current[tarUnit];current=current[curUnit];flipMultiplier=true}if(target.conversionFunc==undefined){if(flipMultiplier){val=this.value*(target.multiplier/current.multiplier)}else{val=this.value*(current.multiplier/target.multiplier)}}else{var func=target.conversionFunc.replace("{value}",this.value);val=eval(func)}return(val)};unitConverter.prototype.toString=function(){return this.val()+" "+this.targetUnit};unitConverter.prototype.debug=function(){return this.value+" "+this.currentUnit+" is "+this.val()+" "+this.targetUnit};unitConverter.addUnit=function(baseUnit,actualUnit,multiplier){var toUnits;if(table[baseUnit]==undefined){table[baseUnit]={}}toUnits=table[baseUnit];if(typeof(multiplier)=="number"){toUnits[actualUnit]={multiplier:multiplier}}else{if(typeof(multiplier)=="string"){toUnits[actualUnit]={conversionFunc:multiplier}}}table[baseUnit]=toUnits};var prefixes=["Y","Z","E","P","T","G","M","k","h","da","","d","c","m","u","n","p","f","a","z","y"];var factors=[24,21,18,15,12,9,6,3,2,1,0,-1,-2,-3,-6,-9,-12,-15,-18,-21,-24];var units=["m"];for(var j=0;j<units.length;j++){var base=units[j];for(var i=0;i<prefixes.length;i++){unitConverter.addUnit(base,prefixes[i]+base,Math.pow(10,factors[i]))}}unitConverter.addUnit("celsius","celsius",1);unitConverter.addUnit("celsius","fahrenheit","{value}*9/5+32");unitConverter.addUnit("celsius","%B0F","{value}*9/5+32");unitConverter.addUnit("mb","mb",1);unitConverter.addUnit("mb","inches mercury",0.0295);unitConverter.addUnit("m_s-1","m_s-1",1);unitConverter.addUnit("m_s-1","cm_s-1",0.01);unitConverter.addUnit("mm_s-1","mm_s-1",0.1);unitConverter.addUnit("mm_s-1","cm_s-1",0.1);unitConverter.addUnit("m_s-1","knots",1.9438444925);unitConverter.addUnit("m_s-1","mph",2.2369362921);unitConverter.addUnit("cm_s-1","mph",0.022369362921);unitConverter.addUnit("mm","inch",0.039);unitConverter.addUnit("m","ft",3.28);window.$unitConversion=function(value,unit){var unitConversion=new window.unitConverter(value,unit);return unitConversion}})();function typeOfEx(b){var a=typeof b;if(a==="object"){if(b){if(typeof b.length==="number"&&!(b.propertyIsEnumerable("length"))&&typeof b.splice==="function"){a="array"}}else{a="null"}}return a}var Base=function(){};Base.extend=function(b,e){var f=Base.prototype.extend;Base._prototyping=true;var d=new this;f.call(d,b);d.base=function(){};delete Base._prototyping;var c=d.constructor;var a=d.constructor=function(){if(!Base._prototyping){if(this._constructing||this.constructor==a){this._constructing=true;c.apply(this,arguments);delete this._constructing}else{if(arguments[0]!=null){return(arguments[0].extend||f).call(arguments[0],d)}}}};a.ancestor=this;a.extend=this.extend;a.forEach=this.forEach;a.implement=this.implement;a.prototype=d;a.toString=this.toString;a.valueOf=function(g){return(g=="object")?a:c.valueOf()};f.call(a,e);if(typeof a.init=="function"){a.init()}return a};Base.prototype={extend:function(b,h){if(arguments.length>1){var e=this[b];if(e&&(typeof h=="function")&&(!e.valueOf||e.valueOf()!=h.valueOf())&&/\bbase\b/.test(h)){var a=h.valueOf();h=function(){var k=this.base||Base.prototype.base;this.base=e;var i=a.apply(this,arguments);this.base=k;return i};h.valueOf=function(i){return(i=="object")?h:a};h.toString=Base.toString}this[b]=h}else{if(b){var g=Base.prototype.extend;if(!Base._prototyping&&typeof this!="function"){g=this.extend||g}var d={toSource:null};var f=["constructor","toString","valueOf"];var c=Base._prototyping?0:1;while(j=f[c++]){if(b[j]!=d[j]){g.call(this,j,b[j])}}for(var j in b){if(!d[j]){g.call(this,j,b[j])}}}}return this}};Base=Base.extend({constructor:function(){this.extend(arguments[0])}},{ancestor:Object,version:"1.1",forEach:function(a,d,c){for(var b in a){if(this.prototype[b]===undefined){d.call(c,a[b],b,a)}}},implement:function(){for(var a=0;a<arguments.length;a++){if(typeof arguments[a]=="function"){arguments[a](this.prototype)}else{this.prototype.extend(arguments[a])}}return this},toString:function(){return String(this.valueOf())}});googleAnalytics=Base.extend({trackerId:"",tracker:null,constructor:function(a){this.trackerId=a},getTracker:function(){try{this.tracker=_gat._getTracker(this.trackerId);return(this.tracker)}catch(a){if(console!==undefined){console.exception(a)}}return(null)},trackEvent:function(d,e,a,c){try{this.tracker._trackEvent(d,e,a,c);return(true)}catch(b){if(console!==undefined){console.exception(b)}}return(false)},recordOutboundLink:function(b,a,c){this.trackEvent(a,c);setTimeout('document.location = "'+b.href+'"',100)},trackPageView:function(){try{this.tracker._trackPageview();this.tracker._setVar("<? echo $var_uservar ?>")}catch(a){if(console!==undefined){console.exception(a)}}}});Ext.namespace("rcoosmapping");GeoExt.Popup.prototype.getState=function(){return null};rcoosmapping.lookupTable=Ext.extend(Ext.data.Record,{obsTypes:null,uomTypes:null,organization:null,dataUrl:null,iconUrls:null,platformTypes:null,constructor:function(a){if(a.data.lookups.obs_type!==undefined){this.obsType=a.data.lookups.obs_type}if(a.data.lookups.uom_type!==undefined){this.uomTypes=a.data.lookups.uom_type}if(a.data.lookups.organization!==undefined){this.organization=a.data.lookups.organization}if(a.data.lookups.data_url!==undefined){this.dataUrl=a.data.lookups.data_url}if(a.data.lookups.icon_urls!==undefined){this.iconUrls=a.data.lookups.icon_urls}if(a.data.lookups.type_list!==undefined){this.platformTypes=a.data.lookups.type_list}rcoosmapping.lookupTable.superclass.constructor.call(this,a)},getDisplayIconURL:function(b){var a;if(this.iconUrls.icons[b]!==undefined){a=this.iconUrls.icons[b]}return(a)},getObsName:function(a){var b;if(this.obsType[a]!==undefined){b=this.obsType[a].standard_name}return(b)},getObsDisplayName:function(a){var b;if(this.obsType[a]!==undefined){b=this.obsType[a].display}return(b)},getObsID:function(b){for(var a in this.obsType){if(this.obsType[a].display==b||this.obsType[a].standard_name==b){return(a)}}return(undefined)},getUOMName:function(c,b){var a;if(this.uomTypes[c]!==undefined){if(b){a=this.uomTypes[c].imperial}else{a=this.uomTypes[c].display}if(a===undefined||a.length===0){a=this.uomTypes[c].display}}return(a)},getNativeUOMName:function(b){var a;if(this.uomTypes[b]!==undefined){a=this.uomTypes[b].standard_name}return(a)},getImperialUOMName:function(c){var b;for(var a in this.uomTypes){if(this.uomTypes[a].standard_name==c){b=this.uomTypes[a].imperial;break}}return(b)},getOrganizationName:function(a){var b;if(this.organization[a]!==undefined){b=this.organization[a].short_name}return(b)},getOrganizationID:function(b){for(var a in this.organization){if(this.organization[a].short_name==b){return(a)}}return(undefined)},getOrganizationURL:function(a){var b;if(this.organization[a]!==undefined){b=this.organization[a].url}return(b)},getDataURL:function(b){var a;if(this.dataUrl[b]!==undefined){a=this.dataUrl[b].url}return(a)},getDataURLType:function(b){var a;if(this.dataUrl[b]!==undefined){a=this.dataUrl[b].type}return(a)},getDataURLTooltip:function(a){var b;if(this.dataUrl[a]!==undefined){b=this.dataUrl[a].tip}return(b)},getPlatformTypeName:function(b){var a;if(this.platformTypes[b]!==undefined){a=this.platformTypes[b].type_name}return(a)}});rcoosmapping.observationsObj=Ext.extend(Ext.data.JsonStore,{lookupTable:null,constructor:function(a){if(a===undefined){a={}}a.autoDestroy=true;a.root="features";a.idProperty=function(c){var b=c.properties.obsType+":"+c.properties.sorder+":"+c.properties.uomType;return(b)};this.lookupTable=a.lookupTable;a.fields=[{name:"type",mapping:"type"},{name:"geometryType",mapping:"geometry.type"},{name:"geometryCoords",mapping:"geometry.coordinates"},{name:"obsType",mapping:"properties.obsType"},{name:"uomType",mapping:"properties.uomType"},{name:"times",mapping:"properties.time"},{name:"values",mapping:"properties.value"},{name:"sorder",mapping:"properties.sorder"},{name:"qc_levels",mapping:"properties.qc_level"}];rcoosmapping.observationsObj.superclass.constructor.call(this,a)},getValues:function(g,f){var b;var h=this.getById(g);if(h!==undefined){b=h.get("values");var e;for(e=0;e<b.length;e++){if(b[e].length){b[e]=Number(b[e]);if(f){var d=h.get("uomType");var a=this.lookupTable.getImperialUOMName(d);if(a!==undefined&&a.length){var c=this.convertValue(b[e],d,a);if(c){b[e]=c}}}}}}return(b)},getLatestValue:function(e,d){var f;var g=this.getById(e);if(g!==undefined){values=g.get("values");f=Number(values[values.length-1]);if(d){var c=g.get("uomType");var a=this.lookupTable.getImperialUOMName(c);if(a!==undefined&&a.length){var b=this.convertValue(f,c,a);if(b){f=b}}}}return(f)},getLatestQCLevel:function(b){var c;var d=this.getById(b);if(d!==undefined){var a=d.get("qc_levels");if(a!==null){c=Number(a[a.length-1])
}}return(c)},getQCLevels:function(c){var a;var d=this.getById(c);if(d!==undefined){a=d.get("qc_levels");if(a!==null){var b;for(b=0;b<a.length;b++){a[b]=Number(a[b])}}}return(a)},convertValue:function(d,c,a){var b=window.$unitConversion(d,c).as(a).val();return(b)},getTimes:function(a){var c;var b=this.getById(a);if(b!==undefined){c=b.get("times")}return(c)},getLatestTime:function(a){var b=this.getTimes(a);if(b!==undefined){return(b[b.length-1])}return(undefined)},getObsTimeSeries:function(e,c){var d=[];var f=this.getTimes(e);var a=this.getValues(e,c);if(f!==undefined&&a!==undefined){var b;for(b=0;b<f.length;b++){d[b]=[f[b],Number(a[b])]}}return(d)}});rcoosmapping.timeSeriesGraph=Ext.extend(Ext.ux.HighChart,{initComponent:function(){rcoosmapping.timeSeriesGraph.superclass.initComponent.call(this)},addTimeSeries:function(k,a,l,b,c){if(this.chart===undefined){this.chart=new Highcharts.Chart(this.chartConfig)}var j=[];var h;for(h=0;h<l.length;h++){var e=l[h][0];var f=e.replace(" ","T");f=Date.parseDate(e,"c");j[h]=f.format("Y-m-d<br/>H:i:s")}this.chart.xAxis[0].setCategories(j);var g=[{type:"line",name:k,data:l}];this.addSeries(g,true);var d=this.chart.yAxis[0];d.options.title.text=k+"("+a+")";d.axisTitle.destroy();d.axisTitle=null;d.hasRenderedTitle=false;d.redraw()}});rcoosmapping.insitu=Ext.extend(Ext.Panel,{feature:null,obsStore:null,selectControl:null,googAnalytics:null,initComponent:function(){this.id="Observations";this.title="Observations";this.layout="border";var c=this.buildHeaderPanel(this.feature);var b=this.buildToolbar();this.bbar=[b];var a=new Ext.Panel({id:"dataPanel",region:"center",width:500,height:100,margins:"1 1 1 1",layout:"border"});this.buildDataPanels(a,this.feature);this.items=[c,a];rcoosmapping.insitu.superclass.initComponent.call(this)},destroy:function(){if(this.obsStore!==null){this.obsStore.removeAll()}var b=this.findById("dataPanel");if(b!==null){var c=b.findById("currentObs");if(c!==null){c.store.removeAll()}}var a=this.feature.get("feature");this.selectControl.unselect(a)},buildToolbar:function(){var c=this.feature.get("lookupTable");var b=this.feature.get("links");var d=[];var a;for(a in b){d.push({id:a,type:"button",tooltip:c.getDataURLTooltip(b[a].urlId),tooltipType:"title",icon:c.getDisplayIconURL(b[a].iconId),listeners:{click:function(g,j){var h=this.feature.get("lookupTable");var e=this.feature.get("links");var f=h.getDataURL(e[g.id].urlId)+e[g.id].id;window.open(f);if(this.googAnalytics!==null){this.googAnalytics.trackEvent("Interactive Map Platforms",g.id,this.feature.get("staID"))}},scope:this}})}return(d)},setObsData:function(x){var k=false;if(x!==undefined){k=true;if(this.obsStore!==null){this.obsStore.removeAll()}var t=this.feature.get("lookupTable");this.obsStore=new rcoosmapping.observationsObj({data:x,lookupTable:t});var e=this.findById("dataPanel");if(e!==null){var w=e.findById("currentObs");if(w!==null){var c=w.getStore();c.remove();var l=null;var z=[];var h=this.feature.get("staObs");if(h.length){var s;for(s=0;s<h.length;s++){var q=h[s];var y=t.getObsName(q.Properties.obsTypeDesc);var p=t.getObsDisplayName(q.Properties.obsTypeDesc);if(p===undefined||(p.length===0)){p=y}var d=t.getNativeUOMName(q.Properties.uomID,true);var v=q.Properties.sorder;var A=y+":"+v+":"+d;var o=this.obsStore.getLatestValue(A,true);if(o!==undefined){o=o.toFixed(2)}else{o=""}var n=this.obsStore.getLatestQCLevel(A);var m=t.getUOMName(q.Properties.uomID,true);var j=Ext.data.Record.create([{name:"obsName",mapping:"obsName"},{name:"obsDisplayName",mapping:"obsDisplayName"},{name:"value",mapping:"value",type:"float"},{name:"uomName",mapping:"uomName"},{name:"dbUomName",mapping:"dbUomName"},{name:"sorder",mapping:"sorder"},{name:"qcLevel",mapping:"qcLevel"}]);var u=new j({obsName:y,obsDisplayName:p,value:o,uomName:m,dbUomName:d,sorder:v,qcLevel:n});c.add(u);if(l===null){var g=this.obsStore.getLatestTime(A);if(g!==undefined){l=g.replace(" ","T");l=Date.parseDate(l,"c");var f=e.findById("currentObsTime");if(f!==null){f.update({loading:false,time:l})
}var b=e.findById("obsGraphPanel");if(b!==null){var r=this.obsStore.getObsTimeSeries(A,true);b.addTimeSeries(p,m,r,false)}}}}}else{k=false}w.selectRange(0,0,false)}}}if(k===false){var e=this.findById("dataPanel");if(e!==null){var f=e.findById("currentObsTime");if(f!==null){var a={loading:false,time:null};f.update(a)}}}},buildHeaderPanel:function(b){var a=new Ext.XTemplate("<div>",'<table width="100%" class="layoutAssistant"><tbody>','<tr><td class="default"><p class="markerHead"><a target="_blank" href="{[values.get("staURL")]}">Station {[values.get("staID")]}</a></p></td></tr>',"</tbody></table>",'<div class="area markerVSpace"><table width="100%" class="layoutAssistant"><tbody>','<tr><td class="default"><p class="region"><b>Location: </b>{[values.get("staDesc")]}</p></td><td style="padding-left: 8px;" class="default aright"><p class="latLon aright"><b>Lat:</b> {[values.get("lat")]} <b>Lon:</b> {[values.get("lon")]}</p></td></tr></tbody></table>','<p class="provider"><b>Provider:</b> <a target="_blank" href="{[values.get("lookupTable").getOrganizationURL(values.get("orgName"))]}" class="iwa">{[values.get("lookupTable").getOrganizationName(values.get("orgName"))]}</a><b>Data Source:</b> {[values.get("lookupTable").getOrganizationName(values.get("orgName"))]}</p>','<tpl if="this.checkStatus(values)"><table width="100%" class="layoutAssistant">','<tbody><tr><td class="default"><p class="platformIssue"><b>Issue:</b> {[values.get("status")["begin_date"]]} {[values.get("status")["reason"]]}<p></td></tr></tbody></table></tpl>',"</div>","</div>",{checkStatus:function(e){var d=e.get("status");if(d===null){return(false)}return(true)}});var c={region:"north",layout:"fit",margins:"1 1 1 1",width:500,height:"auto",tpl:a,data:b,listeners:{render:function(d){d.tpl.overwrite(this.body,this.data)}}};return(c)},buildDataPanels:function(b,f){var a=null;var c=null;var e=null;if(b!==null){a=new Ext.XTemplate('<div class="markerMeasurements">','<table class="layoutAssistant chart" align="left"><tbody>','<tpl for=".">','<tr class="chartButton thumb-wrap"><td class="chartButtonL"><b>{obsDisplayName}</b></td><td class="chartButtonM">{value}</td><td class="chartButtonR">{uomName}</td></tr>',"</tpl>","</tbody></table>","</div>");var d=new Ext.data.Store();var e=new Ext.DataView({id:"currentObs",cls:"area obs-panel-body",region:"center",layout:"fit",emptyText:"Loading data",store:d,data:f,width:250,height:200,margins:"1 1 1 1",tpl:a,autoScroll:true,singleSelect:true,overClass:"x-view-over",itemSelector:"tr.thumb-wrap",listeners:{click:this.obsClicked}});c=new Ext.XTemplate('<div style="padding: 2px;" class="updateInfo">','<table align="center" class="layoutAssistant"><tbody>',"<tr>",'<tpl if="values.loading"><td class="default vcenter"><div id="loading-mask"></div><div id="loading"><div class="loading-indicator"><b>Loading...</b></div></div></td></tpl>','<tpl if="values.loading == false">','<td class="default vcenter"><img width="18" height="18" border="0" src={[this.getDataAgeIcon(values.time)]} style="margin-right: 5px;"></td>','<td class="default vcenter"><p style="padding: 0px;" class="updateInfo"><b><span class="updateInfo">Data Updated: </span></b><span class="updateInfo">{[this.getTimeString(values.time)]}</span></p></td></tr>',"</tbody></table>","</tpl>","</div>",{getDataAgeIcon:function(l){var k="./resources/images/data_age/";if(l!==null){var j=new Date();var n=j.getElapsed(l);var m=3600000;if(n<=m){k+="icon_0-1.png"}else{if((n>m)&&(n<=(2*m))){k+="icon_1-2.png"}else{if((n>(2*m))&&(n<(3*m))){k+="icon_2-3.png"}else{if((n>(3*m))&&(n<(4*m))){k+="icon_3-4.png"}else{if((n>(4*m))&&(n<(12*m))){k+="icon_10-11.png"}else{k+="icon_12+.png"}}}}}}else{k+="icon_no_data.png"}return(k)},getTimeString:function(k){var j="No Data Available";if(k!==null){j=k.format("Y-m-d H:i:s")}return(j)}});var h=new Ext.Panel({id:"currentObsTime",bodyCssClass:"area",region:"north",layout:"fit",margins:"1 1 1 1",width:500,height:25,html:"",tpl:c,listeners:{render:function(j){var k=null;
if(this.data===undefined){k={loading:true}}j.tpl.overwrite(this.body,k)}}});var g=new rcoosmapping.timeSeriesGraph({id:"obsGraphPanel",region:"east",layout:"fit",width:250,height:200,chartConfig:{chart:{defaultSeriesType:"line",backgroundColor:"#FFFFFF",margin:[10,30,40,60]},plotOptions:{line:{color:"#000000",lineWidth:1,marker:{radius:2}}},title:{text:"Observation Graph",style:{color:"#000000",fontSize:"11px"}},subtitle:{text:"",style:{color:"#000000",fontSize:"8px"}},tooltip:{formatter:function(){var k=this.point.name;updateTime=k.replace(" ","T");updateTime=Date.parseDate(updateTime,"c");updateTime=updateTime.format("m-d H:i:s");var j="Date: "+updateTime+"<br>Value: "+this.y.toFixed(2);return j}},legend:{enabled:false},xAxis:[{endOnTick:true,maxPadding:0,minPadding:0,showLastLabel:true,labels:{align:"center",style:{font:"10px tahoma,arial,helvetica,sans-serif",color:"#000000"},formatter:function(){if(this.isFirst||this.isLast){return(this.value)}}}}],yAxis:[{maxPadding:0,minPadding:0,title:{text:" ",style:{font:"10px tahoma,arial,helvetica,sans-serif",color:"#000000"}},labels:{style:{font:"10px tahoma,arial,helvetica,sans-serif",color:"#000000"}}}]}});b.add(h);b.add(e);b.add(g)}return(b)},obsClicked:function(j,e,a,f){var b=j.ownerCt;if(b!==null){var k=b.ownerCt;if(k!==null){var c=j.store.getAt(e);if(c!==null){var g=c.get("obsName");var m=c.get("dbUomName");var d=c.get("sorder");var h=b.findById("obsGraphPanel");if(h!==null){var l=g+":"+d+":"+m;var n=k.obsStore.getObsTimeSeries(l,true);h.addTimeSeries(c.get("obsDisplayName"),c.get("uomName"),n,false)}}}}}});rcoosmapping.popup=Ext.extend(GeoExt.Popup,{feature:null,selectControl:null,googAnalytics:null,initComponent:function(){this.listeners={afterrender:this.afterrender};rcoosmapping.popup.superclass.initComponent.call(this)},afterrender:function(){var b=new Ext.TabPanel({resizeTabs:true,width:this.getInnerWidth(),height:this.getInnerHeight(),id:"tabPanel",activeTab:0});this.add(b);var a=new rcoosmapping.insitu({itemId:"insituPanel",feature:this.feature,selectControl:this.selectControl,googAnalytics:this.googAnalytics});b.add(a)},setObsData:function(d){var c=this.findById("tabPanel");if(c!==null){for(var a=0;a<c.items.length;a++){var b=c.items.get(a);if(b.setObsData!==undefined){b.setObsData(d)}}}}});rcoosmapping.featureFilterPanel=Ext.extend(Ext.FormPanel,{layers:[],lookupTable:null,initComponent:function(){this.listeners={checkboxgroupchange:this.checkBoxChange};rcoosmapping.featureFilterPanel.superclass.initComponent.call(this)},addFilterGroup:function(a,d,c){var b=new Ext.form.FieldSet({id:d+"filterSet",title:c,autoHeight:true,autoWidth:true,layout:"fit",collapsed:false,collapsible:true,bubbleEvents:["checkboxgroupchange"],listeners:{check:function(f,e){this.fireEvent("checkboxgroupchange",this.title,f,e)}},items:{id:d+"FilterGroup",xtype:"checkboxgroup",autoHeight:true,autoWidth:true,vertical:true,columns:2,items:a,bubbleEvents:["check"]}});b.addEvents("checkboxgroupchange");this.add(b)},checkBoxChange:function(k,j,a){if(this.lookupTable!==null){var c;var h;var e=this.layers[0].strategies[0];var f=e.filter;var d=null;if(k=="Organizations"){c=this.lookupTable.getOrganizationID(j.boxLabel);h="orgName";d=f.filters[0]}else{if(k=="Observations"){c=this.lookupTable.getObsID(j.boxLabel);h="staObs.Properties.obsTypeDesc";d=f.filters[1]}}if(a){var b=new OpenLayers.Filter.ComparisonEx({type:OpenLayers.Filter.Comparison.EQUAL_TO,property:h,value:c});d.filters.push(b)}else{for(var g=0;g<d.filters.length;g++){if(d.filters[g].value==c){d.filters.splice(g,1);break}}}if(f.filters[0].filters.length===0&&f.filters[1].filters.length===0){f.type=OpenLayers.Filter.Logical.OR}else{f.type=OpenLayers.Filter.Logical.AND}if(f.filters[0].filters.length===0){f.filters[0].type=OpenLayers.Filter.Logical.AND}else{f.filters[0].type=OpenLayers.Filter.Logical.OR}if(f.filters[1].filters.length===0){f.filters[1].type=OpenLayers.Filter.Logical.AND}else{f.filters[1].type=OpenLayers.Filter.Logical.OR}e.setFilter(e.filter)
}},addObservationGroup:function(b){var c=[];for(var a=0;a<b.length;a++){c.push({boxLabel:b[a],checked:false,name:"obs-cb-"+a,bubbleEvents:["check"]})}this.addFilterGroup(c,"obs","Observations")},addProvidersGroup:function(c){var a=[];for(var b=0;b<c.length;b++){a.push({boxLabel:c[b],checked:false,name:"org-cb-"+b,bubbleEvents:["check"]})}this.addFilterGroup(a,"orgs","Organizations")}});rcoosmapping.platformVectorLayer=Ext.extend(OpenLayers.Layer.Vector,{featureStore:null,lookupTable:null,selectControl:null,hoverControl:null,hoverTimeout:undefined,nfoPopup:undefined,mapObj:null,googAnalytics:null,featuresUrl:null,layerActive:null,parentPanel:null,constructor:function(b,a){if(a.lookups!==undefined){this.lookupTable=a.lookups}this.mapObj=a.map;this.googAnalytics=a.googAnalytics;if(a.layerOptions.featuresUrl!==undefined){this.featuresUrl=a.layerOptions.featuresUrl}this.layerActive=a.layerOptions.active;this.parentPanel=a.parentPanel;rcoosmapping.platformVectorLayer.superclass.constructor.call(this,b,a.layerOptions.options);if(a.platforms!==undefined){this.createFeatureStore(a.platforms);this.createSelectFeature(this.mapObj,this.layerActive)}if(this.mapObj!==undefined){this.mapObj.addLayer(this)}},createFilters:function(){var c=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.OR,filters:[]});var b=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.OR,filters:[]});var a=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,filters:[c,b]});var d=new OpenLayers.Strategy.Filter({filter:a});d.setLayer(this);return([d])},createFilterPanel:function(){var f="westPanel-"+this.parentPanel.title;var e=this.parentPanel.findById(f);if(e!==null){var b=new rcoosmapping.featureFilterPanel({id:"filterPanel",title:"Filters",border:false,header:true,draggable:false,autoScroll:true,overflow:"auto",lookupTable:this.lookupTable,layers:[this]});var a=[];for(var d in this.lookupTable.organization){a.push(this.lookupTable.organization[d].short_name)}b.addProvidersGroup(a);a=[];for(var c in this.lookupTable.obsType){a.push(this.lookupTable.obsType[c].display)}b.addObservationGroup(a);e.insert(0,b);e.doLayout()}},getFeaturesData:function(a){url=this.featuresUrl;if(a!==undefined){url=a}Ext.Ajax.request({autoAbort:true,url:url,scope:this,scriptTag:true,callbackName:"json_callback",success:this.queryFeaturesSuccess,failure:function(b,c){alert("Failed to retrieve the platform data, cannot display platforms.");return}})},queryFeaturesSuccess:function(a,c){var d=Ext.util.JSON.decode(a.responseText);if(d.lookups!==undefined){var g={lookups:d.lookups};this.lookupTable=new rcoosmapping.lookupTable({root:"lookups",data:g});if(d.layers!==undefined){var f;for(f in d.layers){if(f=="vector"){var b;for(b in d.layers[f]){if(b=="insitu"){var e=d.layers[f][b].features;this.createFeatureStore(e);this.createSelectFeature(this.mapObj,this.layerActive);var h=this.createFilters();this.strategies=h;this.createFilterPanel()}}}}}}},createFeatureStore:function(a){var b=this.createFeatures(a);this.featureStore=new GeoExt.data.FeatureStore({autoLoad:true,reader:new GeoExt.data.FeatureReader({},[{name:"orgName",type:"integer"},{name:"staDataFile",type:"string"},{name:"staID",type:"string"},{name:"staDesc",type:"string"},{name:"staTypeImage",type:"integer"},{name:"staTypeId",type:"integer"},{name:"staURL",type:"string"},{name:"lat",type:"string"},{name:"lon",type:"string"},{name:"status",defaultValue:null},{name:"links"},{name:"staObs"},{name:"lookupTable"},{name:"obsDataObj"}]),data:b,layer:this,initDir:GeoExt.data.FeatureStore.STORE_TO_LAYER})},createFeatures:function(e){var c=[];for(i=0;i<e.length;i++){var h=e[i];var g=this.mapObj.projection.projCode;var f=g;if(this.mapObj.displayProjection!==undefined){f=this.mapObj.displayProjection.projCode}var b=rcoosmapping.utils.reprojectPoint(this.mapObj.displayProjection,g,h.geometry.coordinates[0],h.geometry.coordinates[1]);h.properties.lookupTable=this.lookupTable;h.properties.obsDataObj=null;h.properties.lon=h.geometry.coordinates[0];
h.properties.lat=h.geometry.coordinates[1];h.geometry.coordinates[0]=b.lon;h.geometry.coordinates[1]=b.lat;var d=new OpenLayers.Format.GeoJSON();var j=d.read(h);if(j.length){var a=this.lookupTable.getDisplayIconURL(h.properties.staTypeImage);if(a!==undefined){j[0].style={externalGraphic:a,graphicWidth:18,graphicHeight:18,graphicZIndex:1}}c[i]=j[0]}}return(c)},createSelectFeature:function(b,a){this.selectControl=new OpenLayers.Control.SelectFeature([this],{id:"insituclick",onSelect:this.onFeatureSelect,parentObj:this,scope:this,toggle:true});this.hoverControl=new OpenLayers.Control.SelectFeature([this],{id:"insituhover",hover:true,highlightOnly:true,renderIntent:"temporary",scope:this,eventListeners:{beforefeaturehighlighted:function(c){},featurehighlighted:function(e){var l=e.feature;l.style.cursor="pointer";if(this.toolTip!==undefined){this.toolTip.destroy();this.toolTip=undefined}var d=l.attributes.staID;var h="<table><tbody><tr><td>"+d+" (Click platform for details)</td></tr>";var j=l.geometry.getBounds().getCenterLonLat();var c=this.mapObj.getViewPortPxFromLonLat(j);var f=Ext.fly(this.mapObj.div).getBox();var k=this.featureStore.getRecordFromFeature(l);var g=k.get("status");if(g!==null){h+='<tr><td><p class="platformIssue"><b>Technical Issue with Buoy</b></p></td></tr>'}h+="</tbody></table>";this.toolTip=new Ext.ToolTip({id:"ToolTip",html:h,width:"auto",autoWidth:true,hideDelay:5000});this.toolTip.showAt([c.x+f.x+10,c.y+f.y-15]);if(this.hoverTimeout!==undefined){clearTimeout(this.hoverTimeout);this.hoverTimeout=undefined}thisObj=this;this.hoverTimeout=setTimeout(function(){thisObj.hoverData(thisObj,e)},500)},featureunhighlighted:function(d){if(this.hoverTimeout!==undefined){clearTimeout(this.hoverTimeout);this.hoverTimeout=undefined}if(this.toolTip!==undefined){this.toolTip.destroy();this.toolTip=undefined}var c=d.feature;delete c.style.cursor},scope:this}});this.hoverControl.handlers.feature.stopClick=false;this.hoverControl.handlers.feature.stopDown=false;b.addControl(this.hoverControl);b.addControl(this.selectControl);if(a){this.hoverControl.activate();this.selectControl.activate()}},hoverData:function(c,d){var b=d.feature;var e=c.lookupTable.getDataURL(b.attributes.staDataURL);var a=e+b.attributes.staDataFile;Ext.Ajax.request({autoAbort:true,url:a,scope:this,scriptTag:true,callbackName:"json_callback",extraParams:{feature:c.featureStore.getRecordFromFeature(b)},success:function(g,j){if(c.toolTip!==null){var o=null;var f=null;if(g.responseText){try{o=Ext.util.JSON.decode(g.responseText);var A=new rcoosmapping.observationsObj({data:{features:o.features},lookupTable:c.lookupTable});var s=null;var q=j.extraParams.feature.get("staObs");var k=j.extraParams.feature.get("staID");var p="<table><tbody><tr><td>"+k+" (Click platform for details)</td></tr>";var l;var r="";var C="";var w=j.extraParams.feature.get("status");if(w!==null){p+='<tr><td><p class="platformIssue"><b>Issue:</b> '+w.begin_date+" "+w.reason+"</p></td></tr>"}else{if(q.length){for(var z=0;z<q.length;z++){var y=q[z];var D=c.lookupTable.getObsName(y.Properties.obsTypeDesc);var x=c.lookupTable.getObsDisplayName(y.Properties.obsTypeDesc);if(x===undefined||(x.length===0)){x=D}var h=c.lookupTable.getNativeUOMName(y.Properties.uomID,true);var B=y.Properties.sorder;var E=D+":"+B+":"+h;var v=A.getLatestValue(E,true);if(v!==undefined){v=v.toFixed(2)}else{v=""}var u=A.getLatestQCLevel(E);var t=c.lookupTable.getUOMName(y.Properties.uomID,true);if(l==undefined){l=A.getLatestTime(E);if(l!==undefined){var n=l.replace(" ","T");n=Date.parseDate(n,"c");n=n.format("Y-m-d H:i:s");r="<tr><td>Data Time</td><td>"+n+"</td><tr>"}}C+="<tr><td>"+x+"</td><td>"+v+"</td><td>"+t+"</td></tr>"}}}p+=r;p+=C;p+="</tbody></table>";c.toolTip.body.update(p);c.toolTip.syncSize()}catch(m){}if(c.googAnalytics!==undefined){c.googAnalytics.trackEvent("Interactive Map Platforms","Hover",k)}}}}})},onFeatureSelect:function(c){this.clearPopup();var a=this.featureStore.getRecordFromFeature(c);if(a!==undefined){this.nfoPopup=new rcoosmapping.popup({id:"FeaturePopup",map:this.mapObj,title:"Feature Information",autoScroll:true,location:c.geometry.getBounds().getCenterLonLat(),panIn:true,width:500,height:350,collapsible:true,anchored:true,feature:a,selectControl:this.selectControl,googAnalytics:this.googAnalytics});
this.nfoPopup.show();var d=this.lookupTable.getDataURL(c.attributes.staDataURL);var b=d+c.attributes.staDataFile;Ext.Ajax.request({autoAbort:true,url:b,scriptTag:true,callbackName:"json_callback",scope:this,extraParams:{feature:a},success:function(e,g){var h;var j;var l;if(e.responseText){try{h=Ext.util.JSON.decode(e.responseText);l={features:h.features}}catch(k){h=undefined;j=undefined}if(this.nfoPopup!==undefined){try{this.nfoPopup.setObsData(l)}catch(f){if(console!==undefined){console.exception(f)}}}}},failure:function(e,g){try{this.nfoPopup.setObsData(undefined)}catch(f){if(console!==undefined){console.exception(f)}}}});if(this.googAnalytics!==undefined){this.googAnalytics.trackEvent("Interactive Map Platforms","Click",a.get("staID"))}}},onFeatureUnselect:function(b){var a=0},clearPopup:function(){if(this.hoverTimeout!==undefined){clearTimeout(this.hoverTimeout);this.hoverTimeout=undefined}if(this.toolTip!==undefined){this.toolTip.destroy();this.toolTip=undefined}if(this.nfoPopup!==undefined){this.nfoPopup.close();this.nfoPopup=undefined}},enableToolTips:function(a){if(a){if(this.hoverControl!==undefined){this.hoverControl.activate();this.selectControl.activate()}}else{if(this.hoverControl!==undefined){this.hoverControl.deactivate();this.selectControl.deactivate()}}}});OpenLayers.Layer.WMSEx=OpenLayers.Class(OpenLayers.Layer.WMS,{alwaysRefresh:false,initialize:function(c,b,d,a){this.alwaysRefresh=a.alwaysRefresh;this.eventListeners={loadstart:this.loadStart};OpenLayers.Layer.WMS.prototype.initialize.apply(this,arguments)},loadStart:function(b,a){if(this.alwaysRefresh){this.mergeNewParams({random:Math.random()})}}});rcoosmapping.kmlLayer=Ext.extend(OpenLayers.Layer.Vector,{popup:undefined,mapObj:undefined,googAnalytics:undefined,constructor:function(b,a){if(a.strategies!=undefined&&a.strategies.toUpperCase()=="FIXED"){a.strategies=[new OpenLayers.Strategy.Fixed()]}if(a.protocol!=undefined){a.protocol=new OpenLayers.Protocol.HTTP({url:a.protocol.url,format:new OpenLayers.Format.KML({extractStyles:a.protocol.format.extractStyles,extractAttributes:a.protocol.format.extractAttributes,maxDepth:a.protocol.format.maxDepth})})}if(a.projection!=undefined){a.projection=new OpenLayers.Projection(a.projection)}rcoosmapping.kmlLayer.superclass.constructor.call(this,b,a);if(a.map!=undefined&&a.QUERYABLE!=undefined&&a.QUERYABLE){this.createSelectFeature(a.map)}},setGoogleAnalytics:function(a){this.googAnalytics=a},createSelectFeature:function(a){this.mapObj=a;var b=new OpenLayers.Control.SelectFeature([this],{onSelect:this.kmlClick,scope:this});this.mapObj.addControl(b)},clearPopup:function(){if(this.popup!=undefined){this.popup.close();this.popup=undefined}},buildContent:function(a){return(a.attributes.description)},kmlClick:function(a){this.clearPopup();var b=this.buildContent(a);this.popup=new GeoExt.Popup({id:"kmlPopup",map:this.mapObj,title:"Information",autoScroll:true,location:a,width:375,height:200,collapsible:true,anchored:true,html:b});this.popup.show();if(this.googAnalytics!=undefined){this.googAnalytics.trackEvent("KML Feature","Click")}}});rcoosmapping.earthNCCharts=OpenLayers.Class(OpenLayers.Layer.XYZ,{constructor:function(c,b,a){rcoosmapping.earthNCCharts.superclass.constructor.call(this,c,configParams.layerOptions.options)},getURL:function(a){var d=this.map.getResolution();var e=this.map.getZoom()+this.map.baseLayer.minZoomLevel;var g=Math.round((a.left-this.maxExtent.left)/(d*this.tileSize.w));var f=Math.round((this.maxExtent.top-a.top)/(d*this.tileSize.h));var c=1<<e;f=c-f-1;var b=this.url;var j=""+g+f+e;if(b instanceof Array){b=this.selectUrl(j,b)}var h=OpenLayers.String.format(b,{x:g,y:f,z:e});return(h)}});OpenLayers.Layer.ArcGISCache=OpenLayers.Class(OpenLayers.Layer.XYZ,{url:null,tileOrigin:null,tileSize:new OpenLayers.Size(256,256),useArcGISServer:true,type:"png",useScales:false,overrideDPI:false,initialize:function(b,c,l){OpenLayers.Layer.XYZ.prototype.initialize.apply(this,arguments);if(this.resolutions){this.serverResolutions=this.resolutions;
this.maxExtent=this.getMaxExtentForResolution(this.resolutions[0])}if(this.layerInfo){var e=this.layerInfo;var g=new OpenLayers.Bounds(e.fullExtent.xmin,e.fullExtent.ymin,e.fullExtent.xmax,e.fullExtent.ymax);this.projection="EPSG:"+e.spatialReference.wkid;this.sphericalMercator=(e.spatialReference.wkid==102100);this.units=(e.units=="esriFeet")?"ft":"m";if(!!e.tileInfo){this.tileSize=new OpenLayers.Size(e.tileInfo.width||e.tileInfo.cols,e.tileInfo.height||e.tileInfo.rows);this.tileOrigin=new OpenLayers.LonLat(e.tileInfo.origin.x,e.tileInfo.origin.y);var a=new OpenLayers.Geometry.Point(g.left,g.top);var j=new OpenLayers.Geometry.Point(g.right,g.bottom);if(this.useScales){this.scales=[]}else{this.resolutions=[]}this.lods=[];for(var k in e.tileInfo.lods){var h=e.tileInfo.lods[k];if(this.useScales){this.scales.push(h.scale)}else{this.resolutions.push(h.resolution)}var d=this.getContainingTileCoords(a,h.resolution);h.startTileCol=d.x;h.startTileRow=d.y;var f=this.getContainingTileCoords(j,h.resolution);h.endTileCol=f.x;h.endTileRow=f.y;this.lods.push(h)}this.maxExtent=this.calculateMaxExtentWithLOD(this.lods[0]);this.serverResolutions=this.resolutions;if(this.overrideDPI&&e.tileInfo.dpi){OpenLayers.DOTS_PER_INCH=e.tileInfo.dpi}}}},getContainingTileCoords:function(a,b){return new OpenLayers.Pixel(Math.max(Math.floor((a.x-this.tileOrigin.lon)/(this.tileSize.w*b)),0),Math.max(Math.floor((this.tileOrigin.lat-a.y)/(this.tileSize.h*b)),0))},calculateMaxExtentWithLOD:function(f){var c=(f.endTileCol-f.startTileCol)+1;var b=(f.endTileRow-f.startTileRow)+1;var a=this.tileOrigin.lon+(f.startTileCol*this.tileSize.w*f.resolution);var e=a+(c*this.tileSize.w*f.resolution);var d=this.tileOrigin.lat-(f.startTileRow*this.tileSize.h*f.resolution);var g=d-(b*this.tileSize.h*f.resolution);return new OpenLayers.Bounds(a,g,e,d)},calculateMaxExtentWithExtent:function(e,d){var c=new OpenLayers.Geometry.Point(e.left,e.top);var b=new OpenLayers.Geometry.Point(e.right,e.bottom);var g=this.getContainingTileCoords(c,d);var a=this.getContainingTileCoords(b,d);var f={resolution:d,startTileCol:g.x,startTileRow:g.y,endTileCol:a.x,endTileRow:a.y};return this.calculateMaxExtentWithLOD(f)},getUpperLeftTileCoord:function(b){var a=new OpenLayers.Geometry.Point(this.maxExtent.left,this.maxExtent.top);return this.getContainingTileCoords(a,b)},getLowerRightTileCoord:function(b){var a=new OpenLayers.Geometry.Point(this.maxExtent.right,this.maxExtent.bottom);return this.getContainingTileCoords(a,b)},getMaxExtentForResolution:function(g){var c=this.getUpperLeftTileCoord(g);var f=this.getLowerRightTileCoord(g);var h=(f.x-c.x)+1;var j=(f.y-c.y)+1;var e=this.tileOrigin.lon+(c.x*this.tileSize.w*g);var b=e+(h*this.tileSize.w*g);var a=this.tileOrigin.lat-(c.y*this.tileSize.h*g);var d=a-(j*this.tileSize.h*g);return new OpenLayers.Bounds(e,d,b,a)},clone:function(a){if(a==null){a=new OpenLayers.Layer.ArcGISCache(this.name,this.url,this.options)}return OpenLayers.Layer.XYZ.prototype.clone.apply(this,[a])},getMaxExtent:function(){var a=this.map.getResolution();return this.maxExtent=this.getMaxExtentForResolution(a)},getTileOrigin:function(){var a=this.getMaxExtent();return new OpenLayers.LonLat(a.left,a.bottom)},getURL:function(a){var j=this.getResolution();var f=(this.tileOrigin.lon+(j*this.tileSize.w/2));var e=(this.tileOrigin.lat-(j*this.tileSize.h/2));var b=a.getCenterLonLat();var n={x:b.lon,y:b.lat};var m=(Math.round(Math.abs((b.lon-f)/(j*this.tileSize.w))));var l=(Math.round(Math.abs((e-b.lat)/(j*this.tileSize.h))));var k=this.map.getZoom();if(this.lods){var h=this.lods[this.map.getZoom()];k=h.level;if((m<h.startTileCol||m>h.endTileCol)||(l<h.startTileRow||l>h.endTileRow)){return null}}else{var d=this.getUpperLeftTileCoord(j);var g=this.getLowerRightTileCoord(j);if((m<d.x||m>=g.x)||(l<d.y||l>=g.y)){return null}}var c=this.url;var o=""+m+l+k;if(c instanceof Array){c=this.selectUrl(o,c)}if(this.useArcGISServer){c=c+"/tile/${z}/${y}/${x}"}else{m="C"+this.zeroPad(m,8,16);l="R"+this.zeroPad(l,8,16);
k="L"+this.zeroPad(k,2,16);c=c+"/${z}/${y}/${x}."+this.type}c=OpenLayers.String.format(c,{x:m,y:l,z:k});return c},zeroPad:function(b,a,c){var d=b.toString(c||10);while(d.length<a){d="0"+d}return d},CLASS_NAME:"OpenLayers.Layer.ArcGISCache"});rcoosmapping.utils={reprojectPoint:function(d,c,b,g){var f=new OpenLayers.Projection(d);var e=new OpenLayers.Projection(c);var a=new OpenLayers.LonLat(b,g);a.transform(f,e);return(a)}};GeoExt.tree.layerLoaderExtended=Ext.extend(GeoExt.tree.LayerLoader,{defaultGFILayer:"",createNode:function(a){this.baseAttrs.cls="layer-tree-node";if(this.baseAttrs.radioGroup!=undefined){if(a.layer.options.QUERYABLE!=undefined&&a.layer.options.QUERYABLE==false){delete this.baseAttrs.radioGroup}}if(this.baseAttrs.slider!=undefined){if(a.layer.options.opacitySlider!=undefined&&a.layer.options.opacitySlider==false){delete this.baseAttrs.slider}}var b=GeoExt.tree.layerLoaderExtended.superclass.createNode.apply(this,arguments);b.layer.events.on({loadstart:this.loadStart,scope:b});b.layer.events.on({loadend:this.loadEnd,scope:b});b.layer.events.on({loadcancel:this.loadCancel,scope:b});return b},loadStart:function(a,b){this.setIcon("./resources/images/default/grid/loading.gif")},loadEnd:function(a,b){this.setIcon("./resources/images/default/tree/leaf.gif")},loadCancel:function(a,b){this.setIcon("./resources/images/default/tree/leaf.gif")}});rcoosmapping.olMap=Ext.extend(Ext.Panel,{olMap:undefined,dataLayerTree:undefined,tileCacheURL:"",mapservURL:"",mapFile:"",ImageType:"image/png",TileCacheMod:"",nfoPopup:undefined,layerStore:undefined,initGFISelect:false,helpWindow:undefined,mapLegendURL:"",googAnalytics:undefined,lookupTable:null,insituPlatforms:null,mapInited:false,constructor:function(a){this.toolbarItems=[];this.obsInfoControls=[];rcoosmapping.olMap.superclass.constructor.call(this,a)},createPanel:function(a){this.layout="border";this.title=a;this.hideMode="offsets";this.autoScroll=true;this.draggable=false;this.add({id:"westPanel-"+a,region:"west",title:" ",split:true,width:200,minSize:175,maxSize:400,collapsible:true,margins:"0 0 0 5",layout:"accordion",layoutConfig:{animate:true},deferredRender:false,items:[this.dataLayerTree]});this.add({id:"mapPanel-"+a,region:"center",title:"Map",layout:"fit",frame:false,border:true,margins:"5 5 0 0",deferredRender:false,items:[{xtype:"gx_mappanel",map:this.olMap,layers:this.layerStore,zoom:13,border:false,tbar:this.toolbarItems,id:a+"OLMap"}]});this.add({id:"legendPanel-"+a,region:"east",title:"Map Legend",width:200,collapsible:true,margins:"0 0 0 5",autoScroll:true,deferredRender:false,items:[{bodyCssClass:"east-panel-body",title:"",height:"auto",autoLoad:{url:this.mapLegendURL,scripts:false},border:true,autoScroll:true}]})},createToolbar:function(b){var a=function(c){c.push(" ");c.push("-");c.push(" ")};action=new GeoExt.Action({control:new OpenLayers.Control.ZoomToMaxExtent(),map:this.olMap,iconCls:"zoomfull",toggleGroup:b,tooltip:"Zoom to full extent"});this.toolbarItems.push(action);a(this.toolbarItems);action=new GeoExt.Action({control:new OpenLayers.Control.ZoomBox(),tooltip:"Zoom in: click in the olMap or use the left mouse button and drag to create a rectangle",map:this.olMap,iconCls:"zoomin",toggleGroup:b});this.toolbarItems.push(action);action=new GeoExt.Action({control:new OpenLayers.Control.ZoomBox({out:true}),tooltip:"Zoom out: click in the olMap or use the left mouse button and drag to create a rectangle",map:this.olMap,iconCls:"zoomout",toggleGroup:b});this.toolbarItems.push(action);action=new GeoExt.Action({control:new OpenLayers.Control.DragPan({isDefault:false}),tooltip:"Pan olMap: keep the left mouse button pressed and drag the olMap",map:this.olMap,iconCls:"pan",toggleGroup:b});this.toolbarItems.push(action);a(this.toolbarItems);action=new GeoExt.Action({control:new OpenLayers.Control.WMSGetFeatureInfo({isDefault:true}),tooltip:"For layers with querying ability, this issues a request for the data",map:this.olMap,iconCls:"info",toggleGroup:b});this.toolbarItems.push(action);
a(this.toolbarItems);action=new Ext.Action({tooltip:"General Map Help",handler:function(){if(this.helpWindow!=undefined){this.helpWindow.close()}this.helpWindow=new Ext.Window({title:"Help",autoScroll:true,height:500,width:"auto",autoLoad:{url:"./help.html",scripts:false},border:true});this.helpWindow.show()},iconCls:"help",toggleGroup:b,scope:this});this.toolbarItems.push(action)},createMap:function(d){var c=navigator.appName;var b=navigator.appVersion;var a=b.substring(22,25);if(c=="Microsoft Internet Explorer"&&a=="6.0"){this.ImageType="image/png1";this.TileCacheMod="ie6"}this.olMap=new OpenLayers.Map(d)},createLayer:function(e,c,b,g,a,f){var d=null;if(e=="OpenLayers.Layer.WMS"){var d=new OpenLayers.Layer.WMS(c,b,g,a);if(f){this.obsInfoControls.push({click:new OpenLayers.Control.WMSGetFeatureInfo({layers:[d],queryVisible:true,maxFeatures:1,vendorParams:{map:d.params.MAP}})})}}if(e=="OpenLayers.Layer.WMSEx"){d=new OpenLayers.Layer.WMSEx(c,b,g,a);if(f!=undefined&&f){this.obsInfoControls.push({click:new OpenLayers.Control.WMSGetFeatureInfo({layers:[d],queryVisible:true,maxFeatures:1,vendorParams:{map:d.params.MAP}})})}}else{if(e=="OpenLayers.Layer.Google"){d=new OpenLayers.Layer.Google(c,a)}else{if(e=="OpenLayers.Layer.XYZ"){d=new OpenLayers.Layer.XYZ(c,b,a)}else{if(e=="rcoosmapping.earthNCCharts"){d=new rcoosmapping.earthNCCharts(c,b,a)}else{if(e=="OpenLayers.Layer.Vector"){d=new OpenLayers.Layer.Vector(c,a)}else{if(e=="OpenLayers.Layer.ArcGISCache"){d=new OpenLayers.Layer.ArcGISCache(c,b,a)}}}}}}return(d)},addWMSLayer:function(c,b,f,a,e){var d=new OpenLayers.Layer.WMS(c,b,f,a);this.olMap.addLayer(d);if(e){this.obsInfoControls.push({click:new OpenLayers.Control.WMSGetFeatureInfo({url:b,layers:[d],queryVisible:true,maxFeatures:1})})}return(d)},addGoogleLayer:function(b,a){var c=new OpenLayers.Layer.Google(b,a);this.olMap.addLayer(c);return(c)},createLayers:function(a){this.addLayers(a);this.buildGFIControls();this.layerStore=new GeoExt.data.LayerStore({map:this.olMap,layers:this.olMap.layers,initDir:GeoExt.data.LayerStore.MAP_TO_STORE})},addLayers:function(h){if(h!==undefined){var a=h.layers;var j=a.length;for(var e=0;e<j;e++){var c=a[e];for(var g in c.children){if(g!==undefined){var k=c.children[g];var b;if(k.url!==undefined){b=k.url}var d;if(k.params!==undefined){d=k.params}var l;if(k.options!==undefined){l=k.options}if(k.type=="OpenLayers.Layer.Google"){if(l.type=="G_PHYSICAL_MAP"){l.type=G_PHYSICAL_MAP}else{if(l.type=="G_HYBRID_MAP"){l.type=G_HYBRID_MAP}}}var f=this.createLayer(k.type,g,b,d,l,k.EnableGetFeatureInfo);if(f!==null){this.olMap.addLayer(f)}else{if(k.type=="rcoosmapping.platformVectorLayer"){f=new rcoosmapping.platformVectorLayer(g,{layerOptions:k,map:this.olMap,googAnalytics:this.googAnalytics,parentPanel:this});f.getFeaturesData()}}if(k.zIndexDelta!=undefined){this.olMap.raiseLayer(f,k.zIndexDelta)}}}}}},createLayerTree:function(b){var c=Ext.extend(GeoExt.tree.LayerNodeUI,new GeoExt.tree.TreeNodeUIEventMixinExtended());var a=new Ext.tree.AsyncTreeNode({expanded:true});this.dataLayerTree=new Ext.tree.TreePanel({bodyCssClass:"west-panel-body",title:b,border:false,header:true,draggable:false,autoScroll:true,loader:new Ext.tree.TreeLoader({applyLoader:false,uiProviders:{layernodeui:c}}),root:a,plugins:[new GeoExt.tree.RadioButtonPlugin({listeners:{scope:this,radiochange:function(k){var h=this.olMap;var d=h.controls.length;for(var g=0;g<d;g++){var l=h.controls[g];if(l.layers!=undefined){var e=l.layers.length;for(var f=0;f<e;f++){if(k.layer.name==l.layers[f].name){l.activate()}else{l.deactivate()}}}}}}}),new GeoExt.tree.LayerOpacitySliderPlugin({listeners:{opacityslide:function(d,e){}}}),new GeoExt.tree.LayerInfoPlugin({listeners:{layerinfoclick:function(d,e){window.open(d.layer.attributionLink)}}})],rootVisible:false,lines:false})},populateLayerTree:function(d,c){this.displayLayerInGroup=function(e){var f=e.get("layer");if(f.displayInLayerSwitcher){if(f.options.GROUP==this.baseAttrs.group){if(f.options.QUERYABLE!=undefined&&f.options.QUERYABLE){this.baseAttrs.radioGroup="radioGroup";
this.baseAttrs.uiProvider="layernodeui"}if(f.options.opacitySlider!=undefined&&f.options.opacitySlider){this.baseAttrs.slider="layeropacityslider";this.baseAttrs.uiProvider="layernodeui"}if(f.options.attributionLink!=undefined&&f.options.attributionLink){this.baseAttrs.layerinfo="layerinfoclick";this.baseAttrs.uiProvider="layernodeui"}return(true)}}return(false)};this.displayInBaseLayer=function(e){var f=e.get("layer");if(f.displayInLayerSwitcher){if(f.isBaseLayer){return(true)}}return(false)};this.buildTreeNodes=function(m,e,k){emptyGroupName="";var o=[];g={id:"Base Layer",cls:"layer-tree-node",nodeType:"gx_baselayercontainer",expanded:true,loader:new GeoExt.tree.layerLoaderExtended({baseAttrs:{},filter:this.displayInBaseLayer,store:this.layerStore})};o.push(g);for(var n=0;n<m.length;n++){var p=m[n];if(p.displayInLayerSwitcher==false||p.isBaseLayer){continue}if(p.options.GROUP==undefined){layerGroup=emptyGroupName}var f=false;var q=o.length;var r=-1;for(var l=0;l<q;l++){if(o[l].text==p.options.GROUP){f=true;break}}if(!f){var h=true;if(k){for(var l=0;l<k.length;l++){if(k[l].folder==p.options.GROUP){if(k[l].expanded!=undefined&&k[l].expanded==false){h=false}break}}}var g;g={id:p.options.GROUP,cls:"layer-tree-node",text:p.options.GROUP,nodeType:"gx_layercontainer",expanded:h,loader:new GeoExt.tree.layerLoaderExtended({defaultGFILayer:"Real Time Observations",baseAttrs:{group:p.options.GROUP},filter:this.displayLayerInGroup,store:this.layerStore})};o.push(g)}}return(o)};var b=this.buildTreeNodes(d,name,c);var a=new Ext.tree.AsyncTreeNode({expanded:true,children:b});this.dataLayerTree.setRootNode(a);return(this.dataLayerTree)},addLayerToTreeNode:function(a){if(a.options!=undefined&&a.options.GROUP!=undefined){var b=this.dataLayerTree.getNodeById(a.options.GROUP);if(b==undefined){}else{}}},setInitialGFINode:function(f,c){var a=this.dataLayerTree.getRootNode();var b=a.findChild("text",f);if(b!=null){for(var d=0;d<b.childNodes.length;d++){if(b.childNodes[d].text==c){var e=b.childNodes[d].getUI();e.node.attributes.radio.checked=true;break}}}},launchInfoPopup:function(c,a,b){this.clearPopup();var d=a.getLonLatFromPixel(c.xy);this.nfoPopup=new GeoExt.Popup({id:"FeaturePopup",map:a,title:"Feature Information",autoScroll:true,location:d,html:c.text,width:300,height:"auto",collapsible:true,anchored:true,ctCls:b});this.nfoPopup.show()},obsInfoClick:function(a){this.launchInfoPopup(a,this.olMap,"featurePopupBox")},clearPopup:function(){if(this.nfoPopup!==undefined){this.nfoPopup.close();this.nfoPopup=undefined}},buildGFIControls:function(){var a=this.obsInfoControls.length;for(var c=0;c<a;c++){var b=this.obsInfoControls[c].click;b.events.register("getfeatureinfo",this,this.obsInfoClick);this.olMap.addControl(b);b.activate()}},getJsonData:function(c,a,d){var b=OpenLayers.ProxyHost+c;Ext.Ajax.request({url:b,success:a,failure:d,scope:this})},configAjaxQuery:function(a,b){var c=Ext.util.JSON.decode(a.responseText)},setLegendURL:function(a){this.mapLegendURL=a},setCenter:function(a,c){for(var b in this.olMap.controls){var d=this.olMap.controls[b];if(d.CLASS_NAME=="OpenLayers.Control.ArgParser"){if(d.center==null||c){this.olMap.setCenter(a)}break}}},setAnalytics:function(a){this.googAnalytics=a},mapInitialized:function(a){this.mapInited=a},init:function(g,f,d,a){this.dataServerIP=g;this.tileCacheURL="http://"+d+"/tilecache/tilecache.py?";this.mapservURL="http://"+f+"/cgi-bin/mapserv?";this.secooraMapFile="/home/xeniaprod/mapping/secoora/SecooraObs.map";this.generalMapFile="/home/xeniaprod/mapping/common/general.map";this.ImageType="image/png";this.TileCacheMod="";this.mapLegendURL="legend.html";if(a.googAnalytics!=undefined){this.setAnalytics(a.googAnalytics)}OpenLayers.ProxyHost=a.proxyHost;var h=a.mapConfig;var c=rcoosmapping.utils.reprojectPoint(h.displayProjection,h.projection,h.mapExtents.lowerLeft.lon,h.mapExtents.lowerLeft.lat);var e=rcoosmapping.utils.reprojectPoint(h.displayProjection,h.projection,h.mapExtents.upperRight.lon,h.mapExtents.upperRight.lat);
var b={maxExtent:new OpenLayers.Bounds(c.lon,c.lat,e.lon,e.lat),numZoomLevels:h.numZoomLevels,maxResolution:h.maxResolution,resolutions:h.resolutions,projection:new OpenLayers.Projection(h.projection),displayProjection:new OpenLayers.Projection(h.displayProjection),units:h.units,controls:[new OpenLayers.Control.Navigation({zoomWheelEnabled:true,autoActivate:true}),new OpenLayers.Control.MousePosition({numdigits:2}),new OpenLayers.Control.PanZoomBar(),new OpenLayers.Control.Permalink("permalink"),new OpenLayers.Control.ScaleLine()]};this.createMap(b);this.olMap.id=a.layerTreeName;this.createToolbar(a.toolbarGroupName);this.createLayers(h);this.createLayerTree(a.layerTreeName);this.populateLayerTree(this.olMap.layers,h.layers);this.dataLayerTree.addListener("checkchange",this.treeNodeCheckChange,this)}});Ext.BLANK_IMAGE_URL="./resources/images/default/s.gif";Ext.namespace("rcoosmapping");GeoExt.Popup.prototype.getState=function(){return null};Ext.override(Ext.data.Connection,{request:function(e){if(this.fireEvent("beforerequest",this,e)!==false){var c=e.params;if(typeof c=="function"){c=c.call(e.scope||window,e)}if(typeof c=="object"){c=Ext.urlEncode(c)}if(this.extraParams){var h=Ext.urlEncode(this.extraParams);c=c?(c+"&"+h):h}var b=e.url||this.url;if(typeof b=="function"){b=b.call(e.scope||window,e)}if(e.form){var d=Ext.getDom(e.form);b=b||d.action;var j=d.getAttribute("enctype");if(e.isUpload||(j&&j.toLowerCase()=="multipart/form-data")){return this.doFormUpload(e,c,b)}var i=Ext.lib.Ajax.serializeForm(d);c=c?(c+"&"+i):i}var k=e.headers;if(this.defaultHeaders){k=Ext.apply(k||{},this.defaultHeaders);if(!e.headers){e.headers=k}}var g={success:this.handleResponse,failure:this.handleFailure,scope:this,argument:{options:e},timeout:this.timeout};var a=e.method||this.method||(c?"POST":"GET");if(a=="GET"&&(this.disableCaching&&e.disableCaching!==false)||e.disableCaching===true){b+=(b.indexOf("?")!=-1?"&":"?")+"_dc="+(new Date().getTime())}if(typeof e.autoAbort=="boolean"){if(e.autoAbort){this.abort()}}else{if(this.autoAbort!==false){this.abort()}}if((a=="GET"&&c)||e.xmlData||e.jsonData){b+=(b.indexOf("?")!=-1?"&":"?")+c;c=""}if(e.scriptTag){this.transId=this.scriptRequest(a,b,g,c,e)}else{this.transId=Ext.lib.Ajax.request(a,b,g,c,e)}return this.transId}else{Ext.callback(e.callback,e.scope,[e,null,null]);return null}},scriptRequest:function(a,c,e,f,i){var b=++Ext.data.ScriptTagProxy.TRANS_ID;var h={id:b,cb:i.callbackName||"stcCallback"+b,scriptId:"stcScript"+b,options:i};if(f!==undefined){c+=(c.indexOf("?")!=-1?"&":"?")+f+String.format("&{0}={1}",i.callbackParam||"callback",h.cb)}else{c+=(c.indexOf("?")!=-1?"":"?")+String.format("&{0}={1}",i.callbackParam||"callback",h.cb)}var d=this;window[h.cb]=function(j){d.handleScriptResponse(j,h)};h.timeoutId=this.handleScriptFailure.defer(e.timeout,this,[h]);var g=document.createElement("script");g.setAttribute("src",c);g.setAttribute("type","text/javascript");g.setAttribute("id",h.scriptId);document.getElementsByTagName("head")[0].appendChild(g);return h},handleScriptResponse:function(d,b){this.transId=false;this.destroyScriptTrans(b,true);var a=b.options;var c;if(typeof d=="string"){if(window.ActiveXObject){c=new ActiveXObject("Microsoft.XMLDOM");c.async="false";c.loadXML(d)}else{c=new DOMParser().parseFromString(d,"text/xml")}}response={responseObject:d,responseText:(typeof d=="object")?Ext.util.JSON.encode(d):String(d),responseXML:c,argument:a.argument};this.fireEvent("requestcomplete",this,response,a);Ext.callback(a.success,a.scope,[response,a]);Ext.callback(a.callback,a.scope,[a,true,response])},handleScriptFailure:function(b){this.trans=false;this.destroyScriptTrans(b,false);var a=b.options;response={argument:a.argument};this.fireEvent("requestexception",this,response,a,new Error("Timeout"));Ext.callback(a.failure,a.scope,[response,a]);Ext.callback(a.callback,a.scope,[a,false,response])},destroyScriptTrans:function(b,a){document.getElementsByTagName("head")[0].removeChild(document.getElementById(b.scriptId));clearTimeout(b.timeoutId);if(a){window[b.cb]=undefined;try{delete window[b.cb]}catch(c){}}else{window[b.cb]=function(){window[b.cb]=undefined;try{delete window[b.cb]}catch(d){}}}}});rcoosmapping.secooraOLMap=Ext.extend(rcoosmapping.olMap,{hfradarPlatforms:null,insituPlatforms:null,constructor:function(a){rcoosmapping.secooraOLMap.superclass.constructor.call(this,a)},addLayers:function(b){rcoosmapping.secooraOLMap.superclass.addLayers.call(this,b);var f;for(f=0;f<this.olMap.layers.length;f++){if(this.olMap.layers[f].name=="Real Time Observations"){this.insituPlatforms=this.olMap.layers[f]}}if(b!==undefined){var g=b.layers;var a=g.length;for(var f=0;f<a;f++){var h=g[f];for(var d in h.children){if(d!==undefined){var e=undefined;var c=h.children[d];if(c.type=="rcoosmapping.kmlLayer"){c.options.map=this.olMap;
e=new rcoosmapping.kmlLayer(d,c.options);e.setGoogleAnalytics(this.googAnalytics)}else{if(c.type=="rcoosmapping.kmlHurricaneTrackLayer"){c.options.map=this.olMap;e=new rcoosmapping.kmlHurricaneTrackLayer(d,c.options);e.setGoogleAnalytics(this.googAnalytics)}}if(e!=undefined){this.olMap.addLayer(e)}}}}}},getJsonData:function(c,b,d,e,a,f){Ext.Ajax.request({url:c,scriptTag:b,callbackName:d,success:e,failure:a,scope:this,extraParams:f})},ajaxQueryFail:function(a,b){if(b.extraParams!==undefined&&b.extraParams.errorMsg!==undefined){alert(b.extraParams.errorMsg)}else{alert("Failed to retrieve requested data.")}return},queryJSONLayerSuccess:function(a,c){var e=Ext.util.JSON.decode(a.responseText);var d=0;if(e.lookups!==undefined){var h={lookups:e.lookups};this.lookupTable=new rcoosmapping.lookupTable({root:"lookups",data:h});if(e.layers!==undefined){var g;for(g in e.layers){if(g=="vector"){var b;for(b in e.layers[g]){if(b=="insitu"){var f=e.layers[g][b].features;this.insituPlatforms=new rcoosmapping.platformVectorLayer("Real Time Observations",{platforms:f,lookups:this.lookupTable,layerName:"Real Time Observations",layerOptions:{GROUP:"InSitu",visibility:true,QUERYABLE:true},map:this.olMap,layerZOrder:1,layerActive:true,googAnalytics:this.googAnalytics});this.addLayerToTreeNode(this.insituPlatforms)}}}}this.createFilterPanel()}else{alert("Layers are not present in the JSON configuration object.");return}}else{alert("Lookups are not present in the JSON configuration object.");return}},treeNodeCheckChange:function(c,b){if(this.googAnalytics!==undefined&&b){if(this.mapInited===true){this.googAnalytics.trackEvent("Interactive Map Layers","Click",c.layer.name)}}if(c.layer.name=="Real Time Observations"&&b==false){var a=0}},createToolbar:function(b){var a=function(c){c.push(" ");c.push("-");c.push(" ")};action=new GeoExt.Action({control:new OpenLayers.Control.ZoomToMaxExtent(),map:this.olMap,iconCls:"zoomfull",group:b,enableToggle:true,tooltip:"Zoom to full extent of the map.",tooltipType:"title"});this.toolbarItems.push(action);a(this.toolbarItems);action=new GeoExt.Action({control:new OpenLayers.Control.ZoomBox(),toggleHandler:function(c,d){if(this.insituPlatforms!==null){if(d){this.insituPlatforms.enableToolTips(false)}else{this.insituPlatforms.enableToolTips(true)}}},scope:this,map:this.olMap,iconCls:"zoomin",toggleGroup:b,enableToggle:true,tooltip:"Zoom in: click in the olMap or use the left mouse button and drag to create a rectangle",tooltipType:"title"});this.toolbarItems.push(action);action=new GeoExt.Action({control:new OpenLayers.Control.ZoomBox({out:true}),toggleHandler:function(c,d){if(this.insituPlatforms!==null){if(d){this.insituPlatforms.enableToolTips(false)}else{this.insituPlatforms.enableToolTips(true)}}},scope:this,map:this.olMap,iconCls:"zoomout",toggleGroup:b,enableToggle:true,tooltip:"Zoom out: click in the olMap or use the left mouse button and drag to create a rectangle",tooltipType:"title"});this.toolbarItems.push(action);action=new GeoExt.Action({control:new OpenLayers.Control.DragPan({isDefault:false}),map:this.olMap,iconCls:"pan",toggleGroup:b,enableToggle:true,tooltip:"Pan olMap: keep the left mouse button pressed and drag the olMap",tooltipType:"title"});this.toolbarItems.push(action);a(this.toolbarItems);action=new Ext.Action({handler:function(){if(this.insituPlatforms!==null){this.focus()}},scope:this,iconCls:"info",toggleGroup:b,enableToggle:true,tooltip:"For layers with querying ability, this issues a request for the data",tooltipType:"title"});this.toolbarItems.push(action);a(this.toolbarItems);action=new Ext.Action({tooltip:"General Map Help",handler:function(){window.open("./maphelp.html")},iconCls:"help",scope:this,tooltip:"Launch the help window",tooltipType:"title"});this.toolbarItems.push(action)},init:function(d,c,b,a){rcoosmapping.secooraOLMap.superclass.init.call(this,d,c,b,a)}});rcoosmapping.app=function(){this.viewport;this.mapTabs;this.dataServerIP;this.mapservIP;this.tilecacheIP;this.googAnalytics;
return{processConfig:function(c,k){var f=Ext.util.JSON.decode(c.responseText);this.googAnalytics=new googleAnalytics(f.googleAnalyticsKey);if(this.googAnalytics.getTracker()!==null){this.googAnalytics.trackPageView()}var b=f.tabs;var e=b.length;var d;var h=[];for(d=0;d<e;d++){var g=b[d];var a=new rcoosmapping.secooraOLMap();a.setAnalytics(this.googAnalytics);g.googAnalytics=this.googAnalytics;g.proxyHost=f.serverSettings.proxyHost;a.init(this.dataServerIP,this.mapservIP,this.tilecacheIP,g);a.createPanel(g.name);h.push(a);if(d==0){var j=rcoosmapping.utils.reprojectPoint(g.mapConfig.displayProjection,g.mapConfig.projection,g.mapConfig.mapExtents.centerMapOn.lon,g.mapConfig.mapExtents.centerMapOn.lat);a.setCenter(j)}a.mapInitialized(true)}this.mapTabs=new Ext.TabPanel({region:"center",activeTab:0,deferredRender:true,items:h});this.viewport=new Ext.Viewport({cls:"map-panel",layout:"border",items:[new Ext.BoxComponent({region:"north",el:"header",style:"background-color: #FFFFFF;"}),{region:"center",layout:"border",items:[this.mapTabs]}]});this.mapTabs.on({tabchange:function(m,o){var n;for(n=0;n<m.items.length;n++){var l=m.items.get(n);l.clearPopup()}}})},init:function(d,c,b,e){this.dataServerIP=d;this.mapservIP=c;this.tilecacheIP=b;var a=e;Ext.Ajax.request({url:a,scriptTag:true,callbackName:"map_config_callback",success:this.processConfig,failure:function(f,g){alert("Unable to retrieve the configuration data to setup the map. Cannot continue.");return},scope:this})}}}();